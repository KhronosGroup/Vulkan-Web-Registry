<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>vkGetQueryPoolResults</title><link rel="stylesheet" type="text/css" href="vkman.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /></head><body><div xml:lang="en" class="refentry" lang="en"><a id="id-1"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>vkGetQueryPoolResults — Copy results of queries in a query pool to a host memory region.</p></div><div class="refsect1"><a id="_c_specification"></a><h2>C Specification</h2><p>To retrieve status and results for a set of queries, call:</p><pre class="programlisting">VkResult vkGetQueryPoolResults(
    VkDevice                                    device,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery,
    uint32_t                                    queryCount,
    size_t                                      dataSize,
    void*                                       pData,
    VkDeviceSize                                stride,
    VkQueryResultFlags                          flags);</pre></div><div class="refsect1"><a id="_parameters"></a><h2>Parameters</h2><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>device</code></em> is the logical device that owns the query pool.
</li><li class="listitem">
<em class="parameter"><code>queryPool</code></em> is the query pool managing the queries containing the
    desired results.
</li><li class="listitem">
<em class="parameter"><code>firstQuery</code></em> is the initial query index.
</li><li class="listitem">
<em class="parameter"><code>queryCount</code></em> is the number of queries. <em class="parameter"><code>firstQuery</code></em> and
    <em class="parameter"><code>queryCount</code></em> together define a range of queries.
</li><li class="listitem">
<em class="parameter"><code>dataSize</code></em> is the size in bytes of the buffer pointed to by
    <em class="parameter"><code>pData</code></em>.
</li><li class="listitem">
<em class="parameter"><code>pData</code></em> is a pointer to a user-allocated buffer
    where the results will be written
</li><li class="listitem">
<em class="parameter"><code>stride</code></em> is the stride in bytes between results for individual
    queries within <em class="parameter"><code>pData</code></em>.
</li><li class="listitem"><p class="simpara">
<em class="parameter"><code>flags</code></em> is a bitmask of <code class="code"><a class="link" href="#">VkQueryResultFlagBits</a></code> specifying how
    and when results are returned. Bits which <span class="normative">can</span> be set include:
</p><pre class="programlisting">typedef enum VkQueryResultFlagBits {
    VK_QUERY_RESULT_64_BIT = 0x00000001,
    VK_QUERY_RESULT_WAIT_BIT = 0x00000002,
    VK_QUERY_RESULT_WITH_AVAILABILITY_BIT = 0x00000004,
    VK_QUERY_RESULT_PARTIAL_BIT = 0x00000008,
} VkQueryResultFlagBits;</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="code">VK_QUERY_RESULT_64_BIT</code> indicates the results will be written as an
     array of 64-bit unsigned integer values. If this bit is not set, the
     results will be written as an array of 32-bit unsigned integer values.
</li><li class="listitem">
<code class="code">VK_QUERY_RESULT_WAIT_BIT</code> indicates that Vulkan will wait for
     each query’s status to become available before retrieving its results.
</li><li class="listitem">
<code class="code">VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> indicates that the
     availability status accompanies the results.
</li><li class="listitem">
<code class="code">VK_QUERY_RESULT_PARTIAL_BIT</code> indicates that returning partial
     results is acceptable.
</li></ul></div></li></ul></div></div><div class="refsect1"><a id="_description"></a><h2>Description</h2><p>If no bits are set in <em class="parameter"><code>flags</code></em>, and all requested queries are
in the available state, results are written as an array of
32-bit unsigned integer values. The behavior when not all queries
are available, is described <a class="link" href="#queries-wait-bit-not-set">below</a>.</p><p>If <code class="code">VK_QUERY_RESULT_64_BIT</code> is not set and the result overflows a
32-bit value, the value <span class="normative">may</span> either wrap or saturate. Similarly, if
<code class="code">VK_QUERY_RESULT_64_BIT</code> is set and the result overflows a 64-bit
value, the value <span class="normative">may</span> either wrap or saturate.</p><p>If <code class="code">VK_QUERY_RESULT_WAIT_BIT</code> is set, Vulkan will wait for each
query to be in the available state before retrieving the numerical
results for that query. In this case, <span class="strong"><strong><code class="code">vkGetQueryPoolResults</code></strong></span> is
guaranteed to succeed and return <code class="code">VK_SUCCESS</code> if the queries
become available in a finite time (i.e. if they have been issued and not
reset). If queries will never finish (e.g. due to being reset but not
issued), then <span class="strong"><strong><code class="code">vkGetQueryPoolResults</code></strong></span> <span class="normative">may</span> not return in finite time.</p><p><a id="queries-wait-bit-not-set"></a>If <code class="code">VK_QUERY_RESULT_WAIT_BIT</code> and <code class="code">VK_QUERY_RESULT_PARTIAL_BIT</code>
are both not set then no result values are written to <em class="parameter"><code>pData</code></em> for
queries that are in the unavailable state at the time of the call,
and <span class="strong"><strong><code class="code">vkGetQueryPoolResults</code></strong></span> returns <code class="code">VK_NOT_READY</code>.
However, availability state is still written to <em class="parameter"><code>pData</code></em> for those
queries if <code class="code">VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Applications <span class="normative">must</span> take care to ensure that use of the
<code class="code">VK_QUERY_RESULT_WAIT_BIT</code> bit has the desired effect.</p><p>For example, if a query has been used previously and a command buffer
records the commands <span class="strong"><strong><code class="code">vkCmdResetQueryPool</code></strong></span>, <span class="strong"><strong><code class="code">vkCmdBeginQuery</code></strong></span>, and
<span class="strong"><strong><code class="code">vkCmdEndQuery</code></strong></span> for that query, then the query will remain
in the available state until the <span class="strong"><strong><code class="code">vkCmdResetQueryPool</code></strong></span> command
executes on a queue. Applications <span class="normative">can</span> use fences or events to ensure that
an query has already been reset before checking for its results or
availability status. Otherwise, a stale value could be returned from a
previous use of the query.</p><p>The above also applies when <code class="code">VK_QUERY_RESULT_WAIT_BIT</code> is used in
combination with <code class="code">VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>. In this
case, the returned availability status <span class="normative">may</span> reflect the result of a
previous use of the query unless the <span class="strong"><strong><code class="code">vkCmdResetQueryPool</code></strong></span> command
has been executed since the last use of the query.</p></td></tr></table></div><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Applications <span class="normative">can</span> double-buffer query pool usage, with a pool per
frame, and reset queries at the end of the frame in which they
are read.</p></td></tr></table></div><p>If <code class="code">VK_QUERY_RESULT_PARTIAL_BIT</code> is set, <code class="code">VK_QUERY_RESULT_WAIT_BIT</code>
is not set, and the query’s status is unavailable, an intermediate
result value between zero and the final result value is written to
<em class="parameter"><code>pData</code></em> for that query.</p><p><code class="code">VK_QUERY_RESULT_PARTIAL_BIT</code> <span class="normative">must not</span> be used if the pool’s
<em class="parameter"><code>queryType</code></em> is <code class="code">VK_QUERY_TYPE_TIMESTAMP</code>.</p><p>If <code class="code">VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set, the final integer
value written for each query is non-zero if the query’s status was
available or zero if the status was unavailable. When
<code class="code">VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is used, implementations <span class="normative">must</span>
guarantee that if they return a non-zero availability value then the
numerical results <span class="normative">must</span> be valid, assuming the results are not reset by a
subsequent command.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png" /></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Satisfying this guarantee <span class="normative">may</span> require careful ordering by the application,
e.g. to read the availability status before reading the results.</p></td></tr></table></div></div><div class="refsect1"><a id="_valid_usage"></a><h2>Valid Usage</h2><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<em class="parameter"><code>device</code></em> <span class="normative">must</span> be a valid <code class="code">VkDevice</code> handle
</li><li class="listitem">
<em class="parameter"><code>queryPool</code></em> <span class="normative">must</span> be a valid <code class="code">VkQueryPool</code> handle
</li><li class="listitem">
<em class="parameter"><code>pData</code></em> <span class="normative">must</span> be a pointer to an array of <em class="parameter"><code>dataSize</code></em> bytes
</li><li class="listitem">
<em class="parameter"><code>flags</code></em> <span class="normative">must</span> be a valid combination of <code class="code"><a class="link" href="#">VkQueryResultFlagBits</a></code> values
</li><li class="listitem">
<em class="parameter"><code>dataSize</code></em> <span class="normative">must</span> be greater than <code class="literal">0</code>
</li><li class="listitem">
<em class="parameter"><code>queryPool</code></em> <span class="normative">must</span> have been created, allocated or retrieved from <em class="parameter"><code>device</code></em>
</li><li class="listitem">
Each of <em class="parameter"><code>device</code></em> and <em class="parameter"><code>queryPool</code></em> <span class="normative">must</span> have been created, allocated or retrieved from the same <code class="code">VkPhysicalDevice</code>
</li><li class="listitem">
<em class="parameter"><code>firstQuery</code></em> <span class="normative">must</span> be less than the number of queries in <em class="parameter"><code>queryPool</code></em>
</li><li class="listitem">
If <code class="code">VK_QUERY_RESULT_64_BIT</code> is not set in <em class="parameter"><code>flags</code></em> then <em class="parameter"><code>pData</code></em> and <em class="parameter"><code>stride</code></em> <span class="normative">must</span> be multiples of <code class="literal">4</code>
</li><li class="listitem">
If <code class="code">VK_QUERY_RESULT_64_BIT</code> is set in <em class="parameter"><code>flags</code></em> then <em class="parameter"><code>pData</code></em> and <em class="parameter"><code>stride</code></em> <span class="normative">must</span> be multiples of <code class="literal">8</code>
</li><li class="listitem">
The sum of <em class="parameter"><code>firstQuery</code></em> and <em class="parameter"><code>queryCount</code></em> <span class="normative">must</span> be less than or equal to the number of queries in <em class="parameter"><code>queryPool</code></em>
</li><li class="listitem">
<em class="parameter"><code>dataSize</code></em> <span class="normative">must</span> be large enough to contain the result of each query, as described <a class="link" href="#">here</a>
</li><li class="listitem">
If the <em class="parameter"><code>queryType</code></em> used to create <em class="parameter"><code>queryPool</code></em> was <code class="code">VK_QUERY_TYPE_TIMESTAMP</code>, <em class="parameter"><code>flags</code></em> <span class="normative">must not</span> contain <code class="code">VK_QUERY_RESULT_PARTIAL_BIT</code>
</li></ul></div></div><div class="refsect1"><a id="_return_codes"></a><h2>Return Codes</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term">
On success, this command returns
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code">VK_SUCCESS</code>
</li><li class="listitem">
<code class="code">VK_NOT_READY</code>
</li></ul></div></dd><dt><span class="term">
On failure, this command returns
</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="code">VK_ERROR_OUT_OF_HOST_MEMORY</code>
</li><li class="listitem">
<code class="code">VK_ERROR_OUT_OF_DEVICE_MEMORY</code>
</li><li class="listitem">
<code class="code">VK_ERROR_DEVICE_LOST</code>
</li></ul></div></dd></dl></div></div><div class="refsect1"><a id="_see_also"></a><h2>See Also</h2><p><code class="code"><a class="link" href="#">VkDevice</a></code>, basetypes:VkDeviceSize, <code class="code"><a class="link" href="#">VkQueryPool</a></code>, <code class="code"><a class="link" href="#">VkQueryResultFlags</a></code></p></div><div class="refsect1"><a id="_document_notes"></a><h2>Document Notes</h2><p>For more information, see the Vulkan Specification at URL</p><p><a class="ulink" href="https://www.khronos.org/registry/vulkan/specs/1.0/xhtml/vkspec.html#vkGetQueryPoolResults" target="_top">https://www.khronos.org/registry/vulkan/specs/1.0/xhtml/vkspec.html#vkGetQueryPoolResults</a></p><p>This page is extracted from the Vulkan Specification.
Fixes and changes should be made to the Specification,not directly.</p></div><div class="refsect1"><a id="_copyright"></a><h2>Copyright</h2><p>Copyright (c) 2014-2016 Khronos Group. This work is licensed under a
<a class="ulink" href="http://creativecommons.org/licenses/by/4.0/" target="_top">Creative Commons
Attribution 4.0 International License</a>.</p></div></div></body></html>