<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="The Khronos Vulkan Working Group">
<title>Vulkan&#174; 1.0.86 - A Specification</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fff; color: #222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: black; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #0068b0; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Noto, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Noto, sans-serif; font-weight: normal; font-style: normal; color: black; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #4d4d4d; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #264357; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Noto, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #ddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #ddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #5e93b8; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #5e93b8; }

blockquote, blockquote p { line-height: 1.6; color: #333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #ddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: #fff; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: #eee; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f8; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; background-color: transparent; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.6; color: #264357; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #5e93b8; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #ddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Noto, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: black; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #fff; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #ddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 0 solid #ddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: black; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: black; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Noto, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddd; color: #5e93b8; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: black; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px hidden #666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eee; background-color: #264357; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: black; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #5e93b8; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #5e93b8; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: #eee; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.375em -0.75em; }

ul.inline > li { margin-left: 0.75em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px #fff; -webkit-box-shadow: 0 0 0 1px #ddd; box-shadow: 0 0 0 1px #ddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #29475c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #ddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<link rel="stylesheet" href="../katex/katex.min.css">
<script src="../katex/katex.min.js"></script>
<script src="../katex/contrib/auto-render.min.js"></script>
    <!-- Use KaTeX to render math once document is loaded, see
         https://github.com/Khan/KaTeX/tree/master/contrib/auto-render -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(
            document.body,
            {
                delimiters: [
                    { left: "$$", right: "$$", display: true},
                    { left: "\\[", right: "\\]", display: true},
                    { left: "$", right: "$", display: false},
                    { left: "\\(", right: "\\)", display: false}
                ]
            }
        );
    });
</script></head>
<body class="book toc2 toc-left" style="max-width: 100;">
<div id="header">
<h1>Vulkan<sup>&#174;</sup> 1.0.86 - A Specification </h1>
<div class="details">
<span id="author" class="author">The Khronos Vulkan Working Group</span><br>
<span id="revnumber">version 1.0.86,</span>
<span id="revdate">2018-09-29 11:15:19Z</span>
<br><span id="revremark">from git branch: github-master commit: 7ea62a02a910ba4dfe0dfa2c7ef464f731d1453c</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#introduction-conventions">1.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="#fundamentals">2. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="#fundamentals-host-environment">2.1. Host and Device Environment</a></li>
<li><a href="#fundamentals-execmodel">2.2. Execution Model</a></li>
<li><a href="#fundamentals-objectmodel-overview">2.3. Object Model</a></li>
<li><a href="#fundamentals-abi">2.4. Application Binary Interface</a></li>
<li><a href="#fundamentals-commandsyntax">2.5. Command Syntax and Duration</a></li>
<li><a href="#fundamentals-threadingbehavior">2.6. Threading Behavior</a></li>
<li><a href="#fundamentals-errors">2.7. Errors</a></li>
<li><a href="#fundamentals-numerics">2.8. Numeric Representation and Computation</a></li>
<li><a href="#fundamentals-fixedconv">2.9. Fixed-Point Data Conversions</a></li>
<li><a href="#fundamentals-versionnum">2.10. API Version Numbers and Semantics</a></li>
<li><a href="#fundamentals-common-objects">2.11. Common Object Types</a></li>
</ul>
</li>
<li><a href="#initialization">3. Initialization</a>
<ul class="sectlevel2">
<li><a href="#initialization-functionpointers">3.1. Command Function Pointers</a></li>
<li><a href="#initialization-instances">3.2. Instances</a></li>
</ul>
</li>
<li><a href="#devsandqueues">4. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="#devsandqueues-physical-device-enumeration">4.1. Physical Devices</a></li>
<li><a href="#devsandqueues-devices">4.2. Devices</a></li>
<li><a href="#devsandqueues-queues">4.3. Queues</a></li>
</ul>
</li>
<li><a href="#commandbuffers">5. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="#commandbuffers-lifecycle">5.1. Command Buffer Lifecycle</a></li>
<li><a href="#commandbuffers-pools">5.2. Command Pools</a></li>
<li><a href="#commandbuffer-allocation">5.3. Command Buffer Allocation and Management</a></li>
<li><a href="#commandbuffers-recording">5.4. Command Buffer Recording</a></li>
<li><a href="#commandbuffers-submission">5.5. Command Buffer Submission</a></li>
<li><a href="#commandbuffers-submission-progress">5.6. Queue Forward Progress</a></li>
<li><a href="#commandbuffers-secondary">5.7. Secondary Command Buffer Execution</a></li>
</ul>
</li>
<li><a href="#synchronization">6. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="#synchronization-dependencies">6.1. Execution and Memory Dependencies</a></li>
<li><a href="#synchronization-implicit">6.2. Implicit Synchronization Guarantees</a></li>
<li><a href="#synchronization-fences">6.3. Fences</a></li>
<li><a href="#synchronization-semaphores">6.4. Semaphores</a></li>
<li><a href="#synchronization-events">6.5. Events</a></li>
<li><a href="#synchronization-pipeline-barriers">6.6. Pipeline Barriers</a></li>
<li><a href="#synchronization-memory-barriers">6.7. Memory Barriers</a></li>
<li><a href="#synchronization-wait-idle">6.8. Wait Idle Operations</a></li>
<li><a href="#synchronization-submission-host-writes">6.9. Host Write Ordering Guarantees</a></li>
</ul>
</li>
<li><a href="#renderpass">7. Render Pass</a>
<ul class="sectlevel2">
<li><a href="#renderpass-creation">7.1. Render Pass Creation</a></li>
<li><a href="#renderpass-compatibility">7.2. Render Pass Compatibility</a></li>
<li><a href="#_framebuffers">7.3. Framebuffers</a></li>
<li><a href="#renderpass-commands">7.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="#shaders">8. Shaders</a>
<ul class="sectlevel2">
<li><a href="#shader-modules">8.1. Shader Modules</a></li>
<li><a href="#shaders-execution">8.2. Shader Execution</a></li>
<li><a href="#shaders-execution-memory-ordering">8.3. Shader Memory Access Ordering</a></li>
<li><a href="#shaders-inputs">8.4. Shader Inputs and Outputs</a></li>
<li><a href="#shaders-vertex">8.5. Vertex Shaders</a></li>
<li><a href="#shaders-tessellation-control">8.6. Tessellation Control Shaders</a></li>
<li><a href="#shaders-tessellation-evaluation">8.7. Tessellation Evaluation Shaders</a></li>
<li><a href="#shaders-geometry">8.8. Geometry Shaders</a></li>
<li><a href="#shaders-fragment">8.9. Fragment Shaders</a></li>
<li><a href="#shaders-compute">8.10. Compute Shaders</a></li>
<li><a href="#shaders-interpolation-decorations">8.11. Interpolation Decorations</a></li>
<li><a href="#shaders-staticuse">8.12. Static Use</a></li>
<li><a href="#shaders-invocationgroups">8.13. Invocation and Derivative Groups</a></li>
</ul>
</li>
<li><a href="#pipelines">9. Pipelines</a>
<ul class="sectlevel2">
<li><a href="#pipelines-compute">9.1. Compute Pipelines</a></li>
<li><a href="#pipelines-graphics">9.2. Graphics Pipelines</a></li>
<li><a href="#pipelines-destruction">9.3. Pipeline destruction</a></li>
<li><a href="#pipelines-multiple">9.4. Multiple Pipeline Creation</a></li>
<li><a href="#pipelines-pipeline-derivatives">9.5. Pipeline Derivatives</a></li>
<li><a href="#pipelines-cache">9.6. Pipeline Cache</a></li>
<li><a href="#pipelines-specialization-constants">9.7. Specialization Constants</a></li>
<li><a href="#pipelines-binding">9.8. Pipeline Binding</a></li>
<li><a href="#pipelines-dynamic-state">9.9. Dynamic State</a></li>
</ul>
</li>
<li><a href="#memory">10. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="#memory-host">10.1. Host Memory</a></li>
<li><a href="#memory-device">10.2. Device Memory</a></li>
</ul>
</li>
<li><a href="#resources">11. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="#resources-buffers">11.1. Buffers</a></li>
<li><a href="#resources-buffer-views">11.2. Buffer Views</a></li>
<li><a href="#resources-images">11.3. Images</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p>Copyright 2014-2018 The Khronos Group Inc.</p>
</div>
<div class="paragraph">
<p>This Specification is protected by copyright laws and contains material
proprietary to Khronos. Except as described by these terms, it or any
components may not be reproduced, republished, distributed, transmitted,
displayed, broadcast or otherwise exploited in any manner without the
express prior written permission of Khronos.
Khronos grants a conditional copyright license to use and reproduce the
unmodified Specification for any purpose, without fee or royalty, EXCEPT no
licenses to any patent, trademark or other intellectual property rights are
granted under these terms.</p>
</div>
<div class="paragraph">
<p>Khronos makes no, and expressly disclaims any, representations or
warranties, express or implied, regarding this Specification, including,
without limitation: merchantability, fitness for a particular purpose,
non-infringement of any intellectual property, correctness, accuracy,
completeness, timeliness, and reliability.
Under no circumstances will Khronos, or any of its Promoters, Contributors
or Members, or their respective partners, officers, directors, employees,
agents or representatives be liable for any damages, whether direct,
indirect, special or consequential damages for lost revenues, lost profits,
or otherwise, arising from or in connection with these materials.</p>
</div>
<div class="paragraph">
<p>This Specification has been created under the Khronos Intellectual Property
Rights Policy, which is Attachment A of the Khronos Group Membership
Agreement available at www.khronos.org/files/member_agreement.pdf, and which
defines the terms 'Scope', 'Compliant Portion', and 'Necessary Patent Claims'.
Parties desiring to implement the Specification and make use of Khronos trademarks
in relation to that implementation, and receive reciprocal patent license protection
under the Khronos Intellectual Property Rights Policy must become Adopters and
confirm the implementation as conformant under the process defined by Khronos for
this Specification; see <a href="https://www.khronos.org/adopters" class="bare">https://www.khronos.org/adopters</a>.</p>
</div>
<div class="paragraph">
<p>This Specification contains substantially unmodified functionality from, and is a
successor to, Khronos specifications including OpenGL, OpenGL ES and OpenCL.</p>
</div>
<div class="paragraph">
<p>Some parts of this Specification are purely informative and so are EXCLUDED from
the Scope of this Specification. The <a href="#introduction-conventions">Document Conventions</a> section of the
<a href="#introduction">Introduction</a> defines how these parts of the Specification are identified.</p>
</div>
<div class="paragraph">
<p>Where this Specification uses <a href="#introduction-technical-terminology">technical
terminology</a>, defined in the <a href="#glossary">[glossary]</a> or otherwise, that refer to
enabling technologies that are not expressly set forth in this
Specification, those enabling technologies are EXCLUDED from the Scope of
this Specification.
For clarity, enabling technologies not disclosed with particularity in this
Specification (e.g. semiconductor manufacturing technology, hardware
architecture, processor architecture or microarchitecture, memory
architecture, compiler technology, object oriented technology, basic
operating system technology, compression technology, algorithms, and so on)
are NOT to be considered expressly set forth; only those application program
interfaces and data structures disclosed with particularity are included in
the Scope of this Specification.</p>
</div>
<div class="paragraph">
<p>For purposes of the Khronos Intellectual Property Rights Policy as it relates
to the definition of Necessary Patent Claims, all recommended or optional
features, behaviors and functionality set forth in this Specification, if
implemented, are considered to be included as Compliant Portions.</p>
</div>
<div class="paragraph">
<p>Where this Specification includes <a href="#introduction-normative-references">normative references to external documents</a>, only the specifically
identified sections of those external documents are INCLUDED in the Scope of
this Specification. If not created by Khronos, those external documents may
contain contributions from non-members of Khronos not covered by the Khronos
Intellectual Property Rights Policy.</p>
</div>
<div class="paragraph">
<p>Vulkan is a registered trademark, and Khronos is a trademark of The Khronos
Group Inc. ASTC is a trademark of ARM Holdings PLC; OpenCL is a trademark of
Apple Inc.; and OpenGL is a registered trademark of Silicon Graphics International,
all used under license by Khronos. All other product names, trademarks, and/or
company names are used solely for identification and belong to their respective owners.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document, referred to as the &#8220;Vulkan Specification&#8221; or just the
&#8220;Specification&#8221; hereafter, describes the Vulkan Application Programming
Interface (API).
Vulkan is a <a href="http://www.open-std.org/jtc1/sc22/wg14/www/standards">C99</a> API
designed for explicit control of low-level graphics and compute
functionality.</p>
</div>
<div class="paragraph">
<p>The canonical version of the Specification is available in the official
<a href="http://www.khronos.org/registry/vulkan/">Vulkan Registry</a>
(<a href="http://www.khronos.org/registry/vulkan/" class="bare">http://www.khronos.org/registry/vulkan/</a>).
The source files used to generate the Vulkan specification are stored in the
<a href="https://github.com/KhronosGroup/Vulkan-Docs">Vulkan Documentation Repository</a>
(<a href="https://github.com/KhronosGroup/Vulkan-Docs" class="bare">https://github.com/KhronosGroup/Vulkan-Docs</a>).
The source repository additionally has a public issue tracker and allows the
submission of pull requests that improve the specification.</p>
</div>
<div class="sect2">
<h3 id="introduction-conventions">1.1. Document Conventions</h3>
<div class="paragraph">
<p>The Vulkan specification is intended for use by both implementors of the API
and application developers seeking to make use of the API, forming a
contract between these parties.
Specification text may address either party; typically the intended audience
can be inferred from context, though some sections are defined to address
only one of these parties.
(For example, <a href="#fundamentals-validusage">Valid Usage</a> sections only address application
developers).
Any requirements, prohibitions, recommendations or options defined by
<a href="#introduction-normative-terminology">normative terminology</a> are imposed
only on the audience of that text.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Structure and enumerated types defined in extensions that were promoted to
core in Vulkan 1.1 are now defined in terms of the equivalent Vulkan 1.1
interfaces.
This affects the Vulkan Specification, the Vulkan header files, and the
corresponding XML Registry.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="introduction-normative-terminology">1.1.1. Normative Terminology</h4>
<div class="paragraph">
<p>Within this specification, the key words <strong>must</strong>, <strong>required</strong>, <strong>should</strong>,
<strong>recommended</strong>, <strong>may</strong>, and <strong>optional</strong> are to be interpreted as described in
<a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119 - Key words for use in RFCs to
Indicate Requirement Levels</a> (<a href="http://www.ietf.org/rfc/rfc2119.txt" class="bare">http://www.ietf.org/rfc/rfc2119.txt</a>).
These key words are highlighted in the specification for clarity.
In text addressing application developers, their use expresses requirements
that apply to application behavior.
In text addressing implementors, their use expresses requirements that apply
to implementations.</p>
</div>
<div class="paragraph">
<p>In text addressing application developers, the additional key words <strong>can</strong>
and <strong>cannot</strong> are to be interpreted as describing the capabilities of an
application, as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>can</strong></dt>
<dd>
<p>This word means that the application is able to perform the action
described.</p>
</dd>
<dt class="hdlist1"><strong>cannot</strong></dt>
<dd>
<p>This word means that the API and/or the execution environment provide no
mechanism through which the application can express or accomplish the action
described.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These key words are never used in text addressing implementors.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There is an important distinction between <strong>cannot</strong> and <strong>must not</strong>, as used
in this Specification.
<strong>Cannot</strong> means something the application literally is unable to express or
accomplish through the API, while <strong>must not</strong> means something that the
application is capable of expressing through the API, but that the
consequences of doing so are undefined and potentially unrecoverable for the
implementation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unless otherwise noted in the section heading, all sections and appendices
in this document are normative.</p>
</div>
</div>
<div class="sect3">
<h4 id="introduction-technical-terminology">1.1.2. Technical Terminology</h4>
<div class="paragraph">
<p>The Vulkan Specification makes use of common engineering and graphics terms
such as <strong>Pipeline</strong>, <strong>Shader</strong>, and <strong>Host</strong> to identify and describe Vulkan API
constructs and their attributes, states, and behaviors.
The <a href="#glossary">Glossary</a> defines the basic meanings of these terms in the
context of the Specification.
The Specification text provides fuller definitions of the terms and may
elaborate, extend, or clarify the <a href="#glossary">Glossary</a> definitions.
When a term defined in the <a href="#glossary">Glossary</a> is used in normative
language within the Specification, the definitions within the Specification
govern and supersede any meanings the terms may have in other technical
contexts (i.e. outside the Specification).</p>
</div>
</div>
<div class="sect3">
<h4 id="introduction-normative-references">1.1.3. Normative References</h4>
<div class="paragraph">
<p>References to external documents are considered normative references if the
Specification uses any of the normative terms defined in
<a href="#introduction-normative-terminology">Normative Terminology</a> to refer to them or their
requirements, either as a whole or in part.</p>
</div>
<div class="paragraph">
<p>The following documents are referenced by normative sections of the
specification:</p>
</div>
<div id="ieee-754" class="paragraph">
<p><em>IEEE Standard for Floating-Point Arithmetic</em>, IEEE Std 754-2008,
<a href="http://dx.doi.org/10.1109/IEEESTD.2008.4610935" class="bare">http://dx.doi.org/10.1109/IEEESTD.2008.4610935</a>, August, 2008.</p>
</div>
<div class="paragraph">
<p><a id="data-format"></a> A. Garrard, <em>Khronos Data Format Specification, version
1.2</em>,
<a href="https://www.khronos.org/registry/DataFormat/specs/1.2/dataformat.1.2.html" class="bare">https://www.khronos.org/registry/DataFormat/specs/1.2/dataformat.1.2.html</a>,
September, 2017.</p>
</div>
<div class="paragraph">
<p><a id="spirv-extended"></a> J. Kessenich, <em>SPIR-V Extended Instructions for GLSL,
Version 1.00</em>, <a href="https://www.khronos.org/registry/spir-v/" class="bare">https://www.khronos.org/registry/spir-v/</a>, February 10, 2016.</p>
</div>
<div class="paragraph">
<p><a id="spirv-spec"></a> J. Kessenich, B. Ouriel, and R. Krisch, <em>SPIR-V
Specification, Version 1.3, Revision 2, Unified</em>,
<a href="https://www.khronos.org/registry/spir-v/" class="bare">https://www.khronos.org/registry/spir-v/</a>, May 11, 2018.</p>
</div>
<div class="paragraph">
<p><a id="vulkan-styleguide"></a> J. Leech and T. Hector, <em>Vulkan Documentation and
Extensions: Procedures and Conventions</em>,
<a href="https://www.khronos.org/registry/vulkan/specs/1.1/styleguide.html" class="bare">https://www.khronos.org/registry/vulkan/specs/1.1/styleguide.html</a></p>
</div>
<div id="LoaderAndLayerInterface" class="paragraph">
<p><em>Vulkan Loader Specification and Architecture Overview</em>,
<a href="https://github.com/KhronosGroup/Vulkan-Loader/blob/master/loader/LoaderAndLayerInterface.md" class="bare">https://github.com/KhronosGroup/Vulkan-Loader/blob/master/loader/LoaderAndLayerInterface.md</a>,
August, 2016.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fundamentals">2. Fundamentals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter introduces fundamental concepts including the Vulkan
architecture and execution model, API syntax, queues, pipeline
configurations, numeric representation, state and state queries, and the
different types of objects and shaders.
It provides a framework for interpreting more specific descriptions of
commands and behavior in the remainder of the Specification.</p>
</div>
<div class="sect2">
<h3 id="fundamentals-host-environment">2.1. Host and Device Environment</h3>
<div class="paragraph">
<p>The Vulkan Specification assumes and requires: the following properties of
the host environment with respect to Vulkan implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The host <strong class="purple">must</strong> have runtime support for 8, 16, 32 and 64-bit signed and
unsigned twos-complement integers, all addressable at the granularity of
their size in bytes.</p>
</li>
<li>
<p>The host <strong class="purple">must</strong> have runtime support for 32- and 64-bit floating-point
types satisfying the range and precision constraints in the
<a href="#fundamentals-floatingpoint">Floating Point Computation</a> section.</p>
</li>
<li>
<p>The representation and endianness of these types on the host <strong class="purple">must</strong> match
the representation and endianness of the same types on every physical
device supported.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Since a variety of data types and structures in Vulkan <strong class="purple">may</strong> be accessible by
both host and physical device operations, the implementation <strong class="purple">should</strong> be able
to access such data efficiently in both paths in order to facilitate writing
portable and performant applications.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-execmodel">2.2. Execution Model</h3>
<div class="paragraph">
<p>This section outlines the execution model of a Vulkan system.</p>
</div>
<div class="paragraph">
<p>Vulkan exposes one or more <em>devices</em>, each of which exposes one or more
<em>queues</em> which <strong class="purple">may</strong> process work asynchronously to one another.
The set of queues supported by a device is partitioned into <em>families</em>.
Each family supports one or more types of functionality and <strong class="purple">may</strong> contain
multiple queues with similar characteristics.
Queues within a single family are considered <em>compatible</em> with one another,
and work produced for a family of queues <strong class="purple">can</strong> be executed on any queue
within that family.
This Specification defines four types of functionality that queues <strong class="purple">may</strong>
support: graphics, compute, transfer, and sparse memory management.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>A single device <strong class="purple">may</strong> report multiple similar queue families rather than, or
as well as, reporting multiple members of one or more of those families.
This indicates that while members of those families have similar
capabilities, they are <em>not</em> directly compatible with one another.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Device memory is explicitly managed by the application.
Each device <strong class="purple">may</strong> advertise one or more heaps, representing different areas
of memory.
Memory heaps are either device local or host local, but are always visible
to the device.
Further detail about memory heaps is exposed via memory types available on
that heap.
Examples of memory areas that <strong class="purple">may</strong> be available on an implementation
include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>device local</em> is memory that is physically connected to the device.</p>
</li>
<li>
<p><em>device local, host visible</em> is device local memory that is visible to
the host.</p>
</li>
<li>
<p><em>host local, host visible</em> is memory that is local to the host and
visible to the device and host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On other architectures, there <strong class="purple">may</strong> only be a single heap that <strong class="purple">can</strong> be used
for any purpose.</p>
</div>
<div class="paragraph">
<p>A Vulkan application controls a set of devices through the submission of
command buffers which have recorded device commands issued via Vulkan
library calls.
The content of command buffers is specific to the underlying implementation
and is opaque to the application.
Once constructed, a command buffer <strong class="purple">can</strong> be submitted once or many times to a
queue for execution.
Multiple command buffers <strong class="purple">can</strong> be built in parallel by employing multiple
threads within the application.</p>
</div>
<div class="paragraph">
<p>Command buffers submitted to different queues <strong class="purple">may</strong> execute in parallel or
even out of order with respect to one another.
Command buffers submitted to a single queue respect
<a href="#synchronization-submission-order">submission order</a>, as described further
in <a href="#synchronization">synchronization chapter</a>.
Command buffer execution by the device is also asynchronous to host
execution.
Once a command buffer is submitted to a queue, control <strong class="purple">may</strong> return to the
application immediately.
Synchronization between the device and host, and between different queues is
the responsibility of the application.</p>
</div>
<div class="sect3">
<h4 id="fundamentals-queueoperation">2.2.1. Queue Operation</h4>
<div class="paragraph">
<p>Vulkan queues provide an interface to the execution engines of a device.
Commands for these execution engines are recorded into command buffers ahead
of execution time.
These command buffers are then submitted to queues with a <em>queue submission</em>
command for execution in a number of <em>batches</em>.
Once submitted to a queue, these commands will begin and complete execution
without further application intervention, though the order of this execution
is dependent on a number of <a href="#synchronization">implicit and explicit
ordering constraints</a>.</p>
</div>
<div class="paragraph">
<p>Work is submitted to queues using queue submission commands that typically
take the form <code>vkQueue*</code> (e.g. <a href="#vkQueueSubmit">vkQueueSubmit</a>,
<a href="#vkQueueBindSparse">vkQueueBindSparse</a>), and optionally take a list of semaphores upon
which to wait before work begins and a list of semaphores to signal once
work has completed.
The work itself, as well as signaling and waiting on the semaphores are all
<em>queue operations</em>.</p>
</div>
<div class="paragraph">
<p>Queue operations on different queues have no implicit ordering constraints,
and <strong class="purple">may</strong> execute in any order.
Explicit ordering constraints between queues <strong class="purple">can</strong> be expressed with
<a href="#synchronization-semaphores">semaphores</a> and
<a href="#synchronization-fences">fences</a>.</p>
</div>
<div class="paragraph">
<p>Command buffer submissions to a single queue respect
<a href="#synchronization-submission-order">submission order</a> and other
<a href="#synchronization-implicit">implicit ordering guarantees</a>, but otherwise
<strong class="purple">may</strong> overlap or execute out of order.
Other types of batches and queue submissions against a single queue (e.g.
<a href="#sparsemem-memory-binding">sparse memory binding</a>) have no implicit
ordering constraints with any other queue submission or batch.
Additional explicit ordering constraints between queue submissions and
individual batches can be expressed with
<a href="#synchronization-semaphores">semaphores</a> and
<a href="#synchronization-fences">fences</a>.</p>
</div>
<div class="paragraph">
<p>Before a fence or semaphore is signaled, it is guaranteed that any
previously submitted queue operations have completed execution, and that
memory writes from those queue operations are
<a href="#synchronization-dependencies-available-and-visible">available</a> to future
queue operations.
Waiting on a signaled semaphore or fence guarantees that previous writes
that are available are also
<a href="#synchronization-dependencies-available-and-visible">visible</a> to subsequent
commands.</p>
</div>
<div class="paragraph">
<p>Command buffer boundaries, both between primary command buffers of the same
or different batches or submissions as well as between primary and secondary
command buffers, do not introduce any additional ordering constraints.
In other words, submitting the set of command buffers (which <strong class="purple">can</strong> include
executing secondary command buffers) between any semaphore or fence
operations execute the recorded commands as if they had all been recorded
into a single primary command buffer, except that the current state is
<a href="#commandbuffers-statereset">reset</a> on each boundary.
Explicit ordering constraints <strong class="purple">can</strong> be expressed with <a href="#synchronization">explicit synchronization primitives</a>.</p>
</div>
<div class="paragraph">
<p>There are a few <a href="#synchronization-implicit">implicit ordering guarantees</a>
between commands within a command buffer, but only covering a subset of
execution.
Additional explicit ordering constraints can be expressed with the various
<a href="#synchronization">explicit synchronization primitives</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations have significant freedom to overlap execution of work
submitted to a queue, and this is common due to deep pipelining and
parallelism in Vulkan devices.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="fundamentals-queueoperation-command-types" class="paragraph">
<p>Commands recorded in command buffers either perform actions (draw, dispatch,
clear, copy, query/timestamp operations, begin/end subpass operations), set
state (bind pipelines, descriptor sets, and buffers, set dynamic state, push
constants, set render pass/subpass state), or perform synchronization
(set/wait events, pipeline barrier, render pass/subpass dependencies).
Some commands perform more than one of these tasks.
State setting commands update the <em>current state</em> of the command buffer.
Some commands that perform actions (e.g. draw/dispatch) do so based on the
current state set cumulatively since the start of the command buffer.
The work involved in performing action commands is often allowed to overlap
or to be reordered, but doing so <strong class="purple">must</strong> not alter the state to be used by
each action command.
In general, action commands are those commands that alter framebuffer
attachments, read/write buffer or image memory, or write to query pools.</p>
</div>
<div class="paragraph">
<p>Synchronization commands introduce explicit
<a href="#synchronization-dependencies">execution and memory dependencies</a> between
two sets of action commands, where the second set of commands depends on the
first set of commands.
These dependencies enforce that both the execution of certain
<a href="#synchronization-pipeline-stages">pipeline stages</a> in the later set occur
after the execution of certain stages in the source set, and that the
effects of <a href="#synchronization-global-memory-barriers">memory accesses</a>
performed by certain pipeline stages occur in order and are visible to each
other.
When not enforced by an explicit dependency or <a href="#synchronization-implicit">implicit ordering guarantees</a>, action commands <strong class="purple">may</strong> overlap execution or
execute out of order, and <strong class="purple">may</strong> not see the side effects of each other&#8217;s
memory accesses.</p>
</div>
<div class="paragraph">
<p>The device executes queue operations asynchronously with respect to the
host.
Control is returned to an application immediately following command buffer
submission to a queue.
The application <strong class="purple">must</strong> synchronize work between the host and device as
needed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-objectmodel-overview">2.3. Object Model</h3>
<div class="paragraph">
<p>The devices, queues, and other entities in Vulkan are represented by Vulkan
objects.
At the API level, all objects are referred to by handles.
There are two classes of handles, dispatchable and non-dispatchable.
<em>Dispatchable</em> handle types are a pointer to an opaque type.
This pointer <strong class="purple">may</strong> be used by layers as part of intercepting API commands,
and thus each API command takes a dispatchable type as its first parameter.
Each object of a dispatchable type <strong class="purple">must</strong> have a unique handle value during
its lifetime.</p>
</div>
<div class="paragraph">
<p><em>Non-dispatchable</em> handle types are a 64-bit integer type whose meaning is
implementation-dependent, and <strong class="purple">may</strong> encode object information directly in the
handle rather than acting as a reference to an underlying object.
Objects of a non-dispatchable type <strong class="purple">may</strong> not have unique handle values within
a type or across types.
If handle values are not unique, then destroying one such handle <strong class="purple">must</strong> not
cause identical handles of other types to become invalid, and <strong class="purple">must</strong> not
cause identical handles of the same type to become invalid if that handle
value has been created more times than it has been destroyed.</p>
</div>
<div class="paragraph">
<p>All objects created or allocated from a <code>VkDevice</code> (i.e. with a
<code>VkDevice</code> as the first parameter) are private to that device, and <strong class="purple">must</strong>
not be used on other devices.</p>
</div>
<div class="sect3">
<h4 id="fundamentals-objectmodel-lifetime">2.3.1. Object Lifetime</h4>
<div class="paragraph">
<p>Objects are created or allocated by <code>vkCreate*</code> and <code>vkAllocate*</code>
commands, respectively.
Once an object is created or allocated, its &#8220;structure&#8221; is considered to
be immutable, though the contents of certain object types is still free to
change.
Objects are destroyed or freed by <code>vkDestroy*</code> and <code>vkFree*</code>
commands, respectively.</p>
</div>
<div class="paragraph">
<p>Objects that are allocated (rather than created) take resources from an
existing pool object or memory heap, and when freed return resources to that
pool or heap.
While object creation and destruction are generally expected to be
low-frequency occurrences during runtime, allocating and freeing objects
<strong class="purple">can</strong> occur at high frequency.
Pool objects help accommodate improved performance of the allocations and
frees.</p>
</div>
<div class="paragraph">
<p>It is an application&#8217;s responsibility to track the lifetime of Vulkan
objects, and not to destroy them while they are still in use.</p>
</div>
<div id="fundamentals-objectmodel-lifetime-acquire" class="paragraph">
<p>The ownership of application-owned memory is immediately acquired by any
Vulkan command it is passed into.
Ownership of such memory <strong class="purple">must</strong> be released back to the application at the
end of the duration of the command, so that the application <strong class="purple">can</strong> alter or
free this memory as soon as all the commands that acquired it have returned.</p>
</div>
<div class="paragraph">
<p>The following object types are consumed when they are passed into a Vulkan
command and not further accessed by the objects they are used to create.
They <strong class="purple">must</strong> not be destroyed in the duration of any API command they are
passed into:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VkShaderModule</code></p>
</li>
<li>
<p><code>VkPipelineCache</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>VkRenderPass</code> object passed as a parameter to create another object
is not further accessed by that object after the duration of the command it
is passed into.
A <code>VkRenderPass</code> used in a command buffer follows the rules described
below.</p>
</div>
<div class="paragraph">
<p>A <code>VkPipelineLayout</code> object <strong class="purple">must</strong> not be destroyed while any command
buffer that uses it is in the recording state.</p>
</div>
<div class="paragraph">
<p><code>VkDescriptorSetLayout</code> objects <strong class="purple">may</strong> be accessed by commands that
operate on descriptor sets allocated using that layout, and those descriptor
sets <strong class="purple">must</strong> not be updated with <a href="#vkUpdateDescriptorSets">vkUpdateDescriptorSets</a> after the
descriptor set layout has been destroyed.
Otherwise, a <code>VkDescriptorSetLayout</code> object passed as a parameter to
create another object is not further accessed by that object after the
duration of the command it is passed into.</p>
</div>
<div class="paragraph">
<p>The application <strong class="purple">must</strong> not destroy any other type of Vulkan object until all
uses of that object by the device (such as via command buffer execution)
have completed.</p>
</div>
<div id="fundamentals-objectmodel-lifetime-cmdbuffers" class="paragraph">
<p>The following Vulkan objects <strong class="purple">must</strong> not be destroyed while any command
buffers using the object are in the <a href="#commandbuffers-lifecycle">pending
state</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VkEvent</code></p>
</li>
<li>
<p><code>VkQueryPool</code></p>
</li>
<li>
<p><code>VkBuffer</code></p>
</li>
<li>
<p><code>VkBufferView</code></p>
</li>
<li>
<p><code>VkImage</code></p>
</li>
<li>
<p><code>VkImageView</code></p>
</li>
<li>
<p><code>VkPipeline</code></p>
</li>
<li>
<p><code>VkSampler</code></p>
</li>
<li>
<p><code>VkDescriptorPool</code></p>
</li>
<li>
<p><code>VkFramebuffer</code></p>
</li>
<li>
<p><code>VkRenderPass</code></p>
</li>
<li>
<p><code>VkCommandBuffer</code></p>
</li>
<li>
<p><code>VkCommandPool</code></p>
</li>
<li>
<p><code>VkDeviceMemory</code></p>
</li>
<li>
<p><code>VkDescriptorSet</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Destroying these objects will move any command buffers that are in the
<a href="#commandbuffers-lifecycle">recording or executable state</a>, and are using
those objects, to the <a href="#commandbuffers-lifecycle">invalid state</a>.</p>
</div>
<div class="paragraph">
<p>The following Vulkan objects <strong class="purple">must</strong> not be destroyed while any queue is
executing commands that use the object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VkFence</code></p>
</li>
<li>
<p><code>VkSemaphore</code></p>
</li>
<li>
<p><code>VkCommandBuffer</code></p>
</li>
<li>
<p><code>VkCommandPool</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general, objects <strong class="purple">can</strong> be destroyed or freed in any order, even if the
object being freed is involved in the use of another object (e.g. use of a
resource in a view, use of a view in a descriptor set, use of an object in a
command buffer, binding of a memory allocation to a resource), as long as
any object that uses the freed object is not further used in any way except
to be destroyed or to be reset in such a way that it no longer uses the
other object (such as resetting a command buffer).
If the object has been reset, then it <strong class="purple">can</strong> be used as if it never used the
freed object.
An exception to this is when there is a parent/child relationship between
objects.
In this case, the application <strong class="purple">must</strong> not destroy a parent object before its
children, except when the parent is explicitly defined to free its children
when it is destroyed (e.g. for pool objects, as defined below).</p>
</div>
<div class="paragraph">
<p><code>VkCommandPool</code> objects are parents of <code>VkCommandBuffer</code> objects.
<code>VkDescriptorPool</code> objects are parents of <code>VkDescriptorSet</code> objects.
<code>VkDevice</code> objects are parents of many object types (all that take a
<code>VkDevice</code> as a parameter to their creation).</p>
</div>
<div class="paragraph">
<p>The following Vulkan objects have specific restrictions for when they <strong class="purple">can</strong>
be destroyed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VkQueue</code> objects <strong class="purple">cannot</strong> be explicitly destroyed.
Instead, they are implicitly destroyed when the <code>VkDevice</code> object
they are retrieved from is destroyed.</p>
</li>
<li>
<p>Destroying a pool object implicitly frees all objects allocated from
that pool.
Specifically, destroying <code>VkCommandPool</code> frees all
<code>VkCommandBuffer</code> objects that were allocated from it, and
destroying <code>VkDescriptorPool</code> frees all <code>VkDescriptorSet</code>
objects that were allocated from it.</p>
</li>
<li>
<p><code>VkDevice</code> objects <strong class="purple">can</strong> be destroyed when all <code>VkQueue</code> objects
retrieved from them are idle, and all objects created from them have
been destroyed.
This includes the following objects:</p>
<div class="ulist">
<ul>
<li>
<p><code>VkFence</code></p>
</li>
<li>
<p><code>VkSemaphore</code></p>
</li>
<li>
<p><code>VkEvent</code></p>
</li>
<li>
<p><code>VkQueryPool</code></p>
</li>
<li>
<p><code>VkBuffer</code></p>
</li>
<li>
<p><code>VkBufferView</code></p>
</li>
<li>
<p><code>VkImage</code></p>
</li>
<li>
<p><code>VkImageView</code></p>
</li>
<li>
<p><code>VkShaderModule</code></p>
</li>
<li>
<p><code>VkPipelineCache</code></p>
</li>
<li>
<p><code>VkPipeline</code></p>
</li>
<li>
<p><code>VkPipelineLayout</code></p>
</li>
<li>
<p><code>VkSampler</code></p>
</li>
<li>
<p><code>VkDescriptorSetLayout</code></p>
</li>
<li>
<p><code>VkDescriptorPool</code></p>
</li>
<li>
<p><code>VkFramebuffer</code></p>
</li>
<li>
<p><code>VkRenderPass</code></p>
</li>
<li>
<p><code>VkCommandPool</code></p>
</li>
<li>
<p><code>VkCommandBuffer</code></p>
</li>
<li>
<p><code>VkDeviceMemory</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VkPhysicalDevice</code> objects <strong class="purple">cannot</strong> be explicitly destroyed.
Instead, they are implicitly destroyed when the <code>VkInstance</code> object
they are retrieved from is destroyed.</p>
</li>
<li>
<p><code>VkInstance</code> objects <strong class="purple">can</strong> be destroyed once all <code>VkDevice</code>
objects created from any of its <code>VkPhysicalDevice</code> objects have been
destroyed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-abi">2.4. Application Binary Interface</h3>
<div class="paragraph">
<p>The mechanism by which Vulkan is made available to applications is platform-
or implementation- defined.
On many platforms the C interface described in this Specification is
provided by a shared library.
Since shared libraries can be changed independently of the applications that
use them, they present particular compatibility challenges, and this
Specification places some requirements on them.</p>
</div>
<div class="paragraph">
<p>Shared library implementations <strong class="purple">must</strong> use the default Application Binary
Interface (ABI) of the standard C compiler for the platform, or provide
customized API headers that cause application code to use the
implementation&#8217;s non-default ABI.
An ABI in this context means the size, alignment, and layout of C data
types; the procedure calling convention; and the naming convention for
shared library symbols corresponding to C functions.
Customizing the calling convention for a platform is usually accomplished by
defining <a href="#boilerplate-platform-specific-calling-conventions">calling
convention macros</a> appropriately in <code>vk_platform.h</code>.</p>
</div>
<div class="paragraph">
<p>On platforms where Vulkan is provided as a shared library, library symbols
beginning with &#8220;vk&#8221; and followed by a digit or uppercase letter are
reserved for use by the implementation.
Applications which use Vulkan <strong class="purple">must</strong> not provide definitions of these
symbols.
This allows the Vulkan shared library to be updated with additional symbols
for new API versions or extensions without causing symbol conflicts with
existing applications.</p>
</div>
<div class="paragraph">
<p>Shared library implementations <strong class="purple">should</strong> provide library symbols for commands
in the highest version of this Specification they support, and for
Window System Integration
extensions relevant to the platform.
They <strong class="purple">may</strong> also provide library symbols for commands defined by additional
extensions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>These requirements and recommendations are intended to allow implementors to
take advantage of platform-specific conventions for SDKs, ABIs, library
versioning mechanisms, etc.
while still minimizing the code changes necessary to port applications or
libraries between platforms.
Platform vendors, or providers of the <em>de facto</em> standard Vulkan shared
library for a platform, are encouraged to document what symbols the shared
library provides and how it will be versioned when new symbols are added.</p>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">should</strong> only rely on shared library symbols for commands in the
minimum core version required by the application.
<a href="#vkGetInstanceProcAddr">vkGetInstanceProcAddr</a> and <a href="#vkGetDeviceProcAddr">vkGetDeviceProcAddr</a> <strong class="purple">should</strong> be used to
obtain function pointers for commands in core versions beyond the
application&#8217;s minimum required version.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-commandsyntax">2.5. Command Syntax and Duration</h3>
<div class="paragraph">
<p>The Specification describes Vulkan commands as functions or procedures using
C99 syntax.
Language bindings for other languages such as C++ and JavaScript <strong class="purple">may</strong> allow
for stricter parameter passing, or object-oriented interfaces.</p>
</div>
<div class="paragraph">
<p>Vulkan uses the standard C types for the base type of scalar parameters
(e.g. types from <code>&lt;stdint.h&gt;</code>), with exceptions described below, or
elsewhere in the text when appropriate:</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkBool32</code> represents boolean <code>True</code> and <code>False</code> values, since C does
not have a sufficiently portable built-in boolean type:</p>
</div>
<div id="VkBool32" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> uint32_t VkBool32;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VK_TRUE</code> represents a boolean <strong>True</strong> (integer 1) value, and
<code>VK_FALSE</code> a boolean <strong>False</strong> (integer 0) value.</p>
</div>
<div class="paragraph">
<p>All values returned from a Vulkan implementation in a <code>VkBool32</code> will
be either <code>VK_TRUE</code> or <code>VK_FALSE</code>.</p>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">must</strong> not pass any other values than <code>VK_TRUE</code> or
<code>VK_FALSE</code> into a Vulkan implementation where a <code>VkBool32</code> is
expected.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkDeviceSize</code> represents device memory size and offset values:</p>
</div>
<div id="VkDeviceSize" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> uint64_t VkDeviceSize;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Commands that create Vulkan objects are of the form <code>vkCreate*</code> and take
<code>Vk*CreateInfo</code> structures with the parameters needed to create the
object.
These Vulkan objects are destroyed with commands of the form
<code>vkDestroy*</code>.</p>
</div>
<div class="paragraph">
<p>The last in-parameter to each command that creates or destroys a Vulkan
object is <code>pAllocator</code>.
The <code>pAllocator</code> parameter <strong class="purple">can</strong> be set to a non-<code>NULL</code> value such that
allocations for the given object are delegated to an application provided
callback; refer to the <a href="#memory-allocation">Memory Allocation</a> chapter for
further details.</p>
</div>
<div class="paragraph">
<p>Commands that allocate Vulkan objects owned by pool objects are of the form
<code>vkAllocate*</code>, and take <code>Vk*AllocateInfo</code> structures.
These Vulkan objects are freed with commands of the form <code>vkFree*</code>.
These objects do not take allocators; if host memory is needed, they will
use the allocator that was specified when their parent pool was created.</p>
</div>
<div class="paragraph">
<p>Commands are recorded into a command buffer by calling API commands of the
form <code>vkCmd*</code>.
Each such command <strong class="purple">may</strong> have different restrictions on where it <strong class="purple">can</strong> be used:
in a primary and/or secondary command buffer, inside and/or outside a render
pass, and in one or more of the supported queue types.
These restrictions are documented together with the definition of each such
command.</p>
</div>
<div class="paragraph">
<p>The <em>duration</em> of a Vulkan command refers to the interval between calling
the command and its return to the caller.</p>
</div>
<div class="sect3">
<h4 id="fundamentals-commandsyntax-results-lifetime">2.5.1. Lifetime of Retrieved Results</h4>
<div class="paragraph">
<p>Information is retrieved from the implementation with commands of the form
<code>vkGet*</code> and <code>vkEnumerate*</code>.</p>
</div>
<div class="paragraph">
<p>Unless otherwise specified for an individual command, the results are
<em>invariant</em>; that is, they will remain unchanged when retrieved again by
calling the same command with the same parameters, so long as those
parameters themselves all remain valid.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-threadingbehavior">2.6. Threading Behavior</h3>
<div class="paragraph">
<p>Vulkan is intended to provide scalable performance when used on multiple
host threads.
All commands support being called concurrently from multiple threads, but
certain parameters, or components of parameters are defined to be
<em>externally synchronized</em>.
This means that the caller <strong class="purple">must</strong> guarantee that no more than one thread is
using such a parameter at a given time.</p>
</div>
<div class="paragraph">
<p>More precisely, Vulkan commands use simple stores to update the state of
Vulkan objects.
A parameter declared as externally synchronized <strong class="purple">may</strong> have its contents
updated at any time during the host execution of the command.
If two commands operate on the same object and at least one of the commands
declares the object to be externally synchronized, then the caller <strong class="purple">must</strong>
guarantee not only that the commands do not execute simultaneously, but also
that the two commands are separated by an appropriate memory barrier (if
needed).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Memory barriers are particularly relevant for hosts based on the ARM CPU
architecture, which is more weakly ordered than many developers are
accustomed to from x86/x64 programming.
Fortunately, most higher-level synchronization primitives (like the pthread
library) perform memory barriers as a part of mutual exclusion, so mutexing
Vulkan objects via these primitives will have the desired effect.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Similarly the application <strong class="purple">must</strong> avoid any potential data hazard of
application-owned memory that has its
<a href="#fundamentals-objectmodel-lifetime-acquire">ownership temporarily acquired</a>
by a Vulkan command.
While the ownership of application-owned memory remains acquired by a
command the implementation <strong class="purple">may</strong> read the memory at any point, and it <strong class="purple">may</strong>
write non-<code>const</code> qualified memory at any point.
Parameters referring to non-<code>const</code> qualified application-owned memory
are not marked explicitly as <em>externally synchronized</em> in the Specification.</p>
</div>
<div class="paragraph">
<p>Many object types are <em>immutable</em>, meaning the objects <strong class="purple">cannot</strong> change once
they have been created.
These types of objects never need external synchronization, except that they
<strong class="purple">must</strong> not be destroyed while they are in use on another thread.
In certain special cases mutable object parameters are internally
synchronized, making external synchronization unnecessary.
One example of this is the use of a <code>VkPipelineCache</code> in
<code>vkCreateGraphicsPipelines</code> and <code>vkCreateComputePipelines</code>, where
external synchronization around such a heavyweight command would be
impractical.
The implementation <strong class="purple">must</strong> internally synchronize the cache in this example,
and <strong class="purple">may</strong> be able to do so in the form of a much finer-grained mutex around
the command.
Any command parameters that are not labeled as externally synchronized are
either not mutated by the command or are internally synchronized.
Additionally, certain objects related to a command&#8217;s parameters (e.g.
command pools and descriptor pools) <strong class="purple">may</strong> be affected by a command, and <strong class="purple">must</strong>
also be externally synchronized.
These implicit parameters are documented as described below.</p>
</div>
<div class="paragraph">
<p>Parameters of commands that are externally synchronized are listed below.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Externally Synchronized Parameters</div>
<div class="ulist">
<ul>
<li>
<p>The <code>instance</code> parameter in <a href="#vkDestroyInstance">vkDestroyInstance</a></p>
</li>
<li>
<p>The <code>device</code> parameter in <a href="#vkDestroyDevice">vkDestroyDevice</a></p>
</li>
<li>
<p>The <code>queue</code> parameter in <a href="#vkQueueSubmit">vkQueueSubmit</a></p>
</li>
<li>
<p>The <code>fence</code> parameter in <a href="#vkQueueSubmit">vkQueueSubmit</a></p>
</li>
<li>
<p>The <code>memory</code> parameter in <a href="#vkFreeMemory">vkFreeMemory</a></p>
</li>
<li>
<p>The <code>memory</code> parameter in <a href="#vkMapMemory">vkMapMemory</a></p>
</li>
<li>
<p>The <code>memory</code> parameter in <a href="#vkUnmapMemory">vkUnmapMemory</a></p>
</li>
<li>
<p>The <code>buffer</code> parameter in <a href="#vkBindBufferMemory">vkBindBufferMemory</a></p>
</li>
<li>
<p>The <code>image</code> parameter in <a href="#vkBindImageMemory">vkBindImageMemory</a></p>
</li>
<li>
<p>The <code>queue</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>The <code>fence</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>The <code>fence</code> parameter in <a href="#vkDestroyFence">vkDestroyFence</a></p>
</li>
<li>
<p>The <code>semaphore</code> parameter in <a href="#vkDestroySemaphore">vkDestroySemaphore</a></p>
</li>
<li>
<p>The <code>event</code> parameter in <a href="#vkDestroyEvent">vkDestroyEvent</a></p>
</li>
<li>
<p>The <code>event</code> parameter in <a href="#vkSetEvent">vkSetEvent</a></p>
</li>
<li>
<p>The <code>event</code> parameter in <a href="#vkResetEvent">vkResetEvent</a></p>
</li>
<li>
<p>The <code>queryPool</code> parameter in <a href="#vkDestroyQueryPool">vkDestroyQueryPool</a></p>
</li>
<li>
<p>The <code>buffer</code> parameter in <a href="#vkDestroyBuffer">vkDestroyBuffer</a></p>
</li>
<li>
<p>The <code>bufferView</code> parameter in <a href="#vkDestroyBufferView">vkDestroyBufferView</a></p>
</li>
<li>
<p>The <code>image</code> parameter in <a href="#vkDestroyImage">vkDestroyImage</a></p>
</li>
<li>
<p>The <code>imageView</code> parameter in <a href="#vkDestroyImageView">vkDestroyImageView</a></p>
</li>
<li>
<p>The <code>shaderModule</code> parameter in <a href="#vkDestroyShaderModule">vkDestroyShaderModule</a></p>
</li>
<li>
<p>The <code>pipelineCache</code> parameter in <a href="#vkDestroyPipelineCache">vkDestroyPipelineCache</a></p>
</li>
<li>
<p>The <code>dstCache</code> parameter in <a href="#vkMergePipelineCaches">vkMergePipelineCaches</a></p>
</li>
<li>
<p>The <code>pipeline</code> parameter in <a href="#vkDestroyPipeline">vkDestroyPipeline</a></p>
</li>
<li>
<p>The <code>pipelineLayout</code> parameter in <a href="#vkDestroyPipelineLayout">vkDestroyPipelineLayout</a></p>
</li>
<li>
<p>The <code>sampler</code> parameter in <a href="#vkDestroySampler">vkDestroySampler</a></p>
</li>
<li>
<p>The <code>descriptorSetLayout</code> parameter in <a href="#vkDestroyDescriptorSetLayout">vkDestroyDescriptorSetLayout</a></p>
</li>
<li>
<p>The <code>descriptorPool</code> parameter in <a href="#vkDestroyDescriptorPool">vkDestroyDescriptorPool</a></p>
</li>
<li>
<p>The <code>descriptorPool</code> parameter in <a href="#vkResetDescriptorPool">vkResetDescriptorPool</a></p>
</li>
<li>
<p>The <code>descriptorPool</code> the <code>pAllocateInfo</code> parameter in <a href="#vkAllocateDescriptorSets">vkAllocateDescriptorSets</a></p>
</li>
<li>
<p>The <code>descriptorPool</code> parameter in <a href="#vkFreeDescriptorSets">vkFreeDescriptorSets</a></p>
</li>
<li>
<p>The <code>framebuffer</code> parameter in <a href="#vkDestroyFramebuffer">vkDestroyFramebuffer</a></p>
</li>
<li>
<p>The <code>renderPass</code> parameter in <a href="#vkDestroyRenderPass">vkDestroyRenderPass</a></p>
</li>
<li>
<p>The <code>commandPool</code> parameter in <a href="#vkDestroyCommandPool">vkDestroyCommandPool</a></p>
</li>
<li>
<p>The <code>commandPool</code> parameter in <a href="#vkResetCommandPool">vkResetCommandPool</a></p>
</li>
<li>
<p>The <code>commandPool</code> the <code>pAllocateInfo</code> parameter in <a href="#vkAllocateCommandBuffers">vkAllocateCommandBuffers</a></p>
</li>
<li>
<p>The <code>commandPool</code> parameter in <a href="#vkFreeCommandBuffers">vkFreeCommandBuffers</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkEndCommandBuffer">vkEndCommandBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkResetCommandBuffer">vkResetCommandBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBindPipeline">vkCmdBindPipeline</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetViewport">vkCmdSetViewport</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetScissor">vkCmdSetScissor</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetLineWidth">vkCmdSetLineWidth</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetDepthBias">vkCmdSetDepthBias</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetBlendConstants">vkCmdSetBlendConstants</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetDepthBounds">vkCmdSetDepthBounds</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetStencilCompareMask">vkCmdSetStencilCompareMask</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetStencilWriteMask">vkCmdSetStencilWriteMask</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetStencilReference">vkCmdSetStencilReference</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBindDescriptorSets">vkCmdBindDescriptorSets</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBindIndexBuffer">vkCmdBindIndexBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBindVertexBuffers">vkCmdBindVertexBuffers</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdDraw">vkCmdDraw</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdDrawIndexed">vkCmdDrawIndexed</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdDrawIndirect">vkCmdDrawIndirect</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdDrawIndexedIndirect">vkCmdDrawIndexedIndirect</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdDispatch">vkCmdDispatch</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdDispatchIndirect">vkCmdDispatchIndirect</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdCopyBuffer">vkCmdCopyBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdCopyImage">vkCmdCopyImage</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBlitImage">vkCmdBlitImage</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdCopyBufferToImage">vkCmdCopyBufferToImage</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdCopyImageToBuffer">vkCmdCopyImageToBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdUpdateBuffer">vkCmdUpdateBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdFillBuffer">vkCmdFillBuffer</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdClearColorImage">vkCmdClearColorImage</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdClearDepthStencilImage">vkCmdClearDepthStencilImage</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdClearAttachments">vkCmdClearAttachments</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdResolveImage">vkCmdResolveImage</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdSetEvent">vkCmdSetEvent</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdResetEvent">vkCmdResetEvent</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdEndQuery">vkCmdEndQuery</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdResetQueryPool">vkCmdResetQueryPool</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdPushConstants">vkCmdPushConstants</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdNextSubpass">vkCmdNextSubpass</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a></p>
</li>
<li>
<p>The <code>commandBuffer</code> parameter in <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>There are also a few instances where a command <strong class="purple">can</strong> take in a user allocated
list whose contents are externally synchronized parameters.
In these cases, the caller <strong class="purple">must</strong> guarantee that at most one thread is using
a given element within the list at a given time.
These parameters are listed below.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Externally Synchronized Parameter Lists</div>
<div class="ulist">
<ul>
<li>
<p>Each element of the <code>pWaitSemaphores</code> member of each element of the <code>pSubmits</code> parameter in <a href="#vkQueueSubmit">vkQueueSubmit</a></p>
</li>
<li>
<p>Each element of the <code>pSignalSemaphores</code> member of each element of the <code>pSubmits</code> parameter in <a href="#vkQueueSubmit">vkQueueSubmit</a></p>
</li>
<li>
<p>Each element of the <code>pWaitSemaphores</code> member of each element of the <code>pBindInfo</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>Each element of the <code>pSignalSemaphores</code> member of each element of the <code>pBindInfo</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>The <code>buffer</code> member of each element of the <code>pBufferBinds</code> member of each element of the <code>pBindInfo</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>The <code>image</code> member of each element of the <code>pImageOpaqueBinds</code> member of each element of the <code>pBindInfo</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>The <code>image</code> member of each element of the <code>pImageBinds</code> member of each element of the <code>pBindInfo</code> parameter in <a href="#vkQueueBindSparse">vkQueueBindSparse</a></p>
</li>
<li>
<p>Each element of the <code>pFences</code> parameter in <a href="#vkResetFences">vkResetFences</a></p>
</li>
<li>
<p>Each element of the <code>pDescriptorSets</code> parameter in <a href="#vkFreeDescriptorSets">vkFreeDescriptorSets</a></p>
</li>
<li>
<p>The <code>dstSet</code> member of each element of the <code>pDescriptorWrites</code> parameter in <a href="#vkUpdateDescriptorSets">vkUpdateDescriptorSets</a></p>
</li>
<li>
<p>The <code>dstSet</code> member of each element of the <code>pDescriptorCopies</code> parameter in <a href="#vkUpdateDescriptorSets">vkUpdateDescriptorSets</a></p>
</li>
<li>
<p>Each element of the <code>pCommandBuffers</code> parameter in <a href="#vkFreeCommandBuffers">vkFreeCommandBuffers</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>In addition, there are some implicit parameters that need to be externally
synchronized.
For example, all <code>commandBuffer</code> parameters that need to be externally
synchronized imply that the <code>commandPool</code> that was passed in when
creating that command buffer also needs to be externally synchronized.
The implicit parameters and their associated object are listed below.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Implicit Externally Synchronized Parameters</div>
<div class="ulist">
<ul>
<li>
<p>All <code>VkQueue</code> objects created from <code>device</code> in <a href="#vkDeviceWaitIdle">vkDeviceWaitIdle</a></p>
</li>
<li>
<p>Any <code>VkDescriptorSet</code> objects allocated from <code>descriptorPool</code> in <a href="#vkResetDescriptorPool">vkResetDescriptorPool</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from in <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from in <a href="#vkEndCommandBuffer">vkEndCommandBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBindPipeline">vkCmdBindPipeline</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetViewport">vkCmdSetViewport</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetScissor">vkCmdSetScissor</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetLineWidth">vkCmdSetLineWidth</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetDepthBias">vkCmdSetDepthBias</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetBlendConstants">vkCmdSetBlendConstants</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetDepthBounds">vkCmdSetDepthBounds</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetStencilCompareMask">vkCmdSetStencilCompareMask</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetStencilWriteMask">vkCmdSetStencilWriteMask</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetStencilReference">vkCmdSetStencilReference</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBindDescriptorSets">vkCmdBindDescriptorSets</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBindIndexBuffer">vkCmdBindIndexBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBindVertexBuffers">vkCmdBindVertexBuffers</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdDraw">vkCmdDraw</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdDrawIndexed">vkCmdDrawIndexed</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdDrawIndirect">vkCmdDrawIndirect</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdDrawIndexedIndirect">vkCmdDrawIndexedIndirect</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdDispatch">vkCmdDispatch</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdDispatchIndirect">vkCmdDispatchIndirect</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdCopyBuffer">vkCmdCopyBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdCopyImage">vkCmdCopyImage</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBlitImage">vkCmdBlitImage</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdCopyBufferToImage">vkCmdCopyBufferToImage</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdCopyImageToBuffer">vkCmdCopyImageToBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdUpdateBuffer">vkCmdUpdateBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdFillBuffer">vkCmdFillBuffer</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdClearColorImage">vkCmdClearColorImage</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdClearDepthStencilImage">vkCmdClearDepthStencilImage</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdClearAttachments">vkCmdClearAttachments</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdResolveImage">vkCmdResolveImage</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdSetEvent">vkCmdSetEvent</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdResetEvent">vkCmdResetEvent</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBeginQuery">vkCmdBeginQuery</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdEndQuery">vkCmdEndQuery</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdResetQueryPool">vkCmdResetQueryPool</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdPushConstants">vkCmdPushConstants</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdNextSubpass">vkCmdNextSubpass</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a></p>
</li>
<li>
<p>The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from, in <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-errors">2.7. Errors</h3>
<div class="paragraph">
<p>Vulkan is a layered API.
The lowest layer is the core Vulkan layer, as defined by this Specification.
The application <strong class="purple">can</strong> use additional layers above the core for debugging,
validation, and other purposes.</p>
</div>
<div class="paragraph">
<p>One of the core principles of Vulkan is that building and submitting command
buffers <strong class="purple">should</strong> be highly efficient.
Thus error checking and validation of state in the core layer is minimal,
although more rigorous validation <strong class="purple">can</strong> be enabled through the use of layers.</p>
</div>
<div class="paragraph">
<p>The core layer assumes applications are using the API correctly.
Except as documented elsewhere in the Specification, the behavior of the
core layer to an application using the API incorrectly is undefined, and
<strong class="purple">may</strong> include program termination.
However, implementations <strong class="purple">must</strong> ensure that incorrect usage by an application
does not affect the integrity of the operating system, the Vulkan
implementation, or other Vulkan client applications in the system.
In particular, any guarantees made by an operating system about whether
memory from one process <strong class="purple">can</strong> be visible to another process or not <strong class="purple">must</strong> not
be violated by a Vulkan implementation for <strong>any memory allocation</strong>.
Vulkan implementations are not <strong class="purple">required</strong> to make additional security or
integrity guarantees beyond those provided by the OS unless explicitly
directed by the application&#8217;s use of a particular feature or extension (e.g.
via <a href="#features-features-robustBufferAccess">robust buffer access</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For instance, if an operating system guarantees that data in all its memory
allocations are set to zero when newly allocated, the Vulkan implementation
<strong class="purple">must</strong> make the same guarantees for any allocations it controls (e.g.
<a href="#VkDeviceMemory">VkDeviceMemory</a>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> request stronger robustness guarantees by enabling the
<code>robustBufferAccess</code> feature as described in <a href="#features">[features]</a>.</p>
</div>
<div class="paragraph">
<p>Validation of correct API usage is left to validation layers.
Applications <strong class="purple">should</strong> be developed with validation layers enabled, to help
catch and eliminate errors.
Once validated, released applications <strong class="purple">should</strong> not enable validation layers
by default.</p>
</div>
<div class="sect3">
<h4 id="fundamentals-validusage">2.7.1. Valid Usage</h4>
<div class="paragraph">
<p>Valid usage defines a set of conditions which <strong class="purple">must</strong> be met in order to
achieve well-defined run-time behavior in an application.
These conditions depend only on Vulkan state, and the parameters or objects
whose usage is constrained by the condition.</p>
</div>
<div class="paragraph">
<p>Some valid usage conditions have dependencies on run-time limits or feature
availability.
It is possible to validate these conditions against Vulkan&#8217;s minimum
supported values for these limits and features, or some subset of other
known values.</p>
</div>
<div class="paragraph">
<p>Valid usage conditions do not cover conditions where well-defined behavior
(including returning an error code) exists.</p>
</div>
<div class="paragraph">
<p>Valid usage conditions <strong class="purple">should</strong> apply to the command or structure where
complete information about the condition would be known during execution of
an application.
This is such that a validation layer or linter <strong class="purple">can</strong> be written directly
against these statements at the point they are specified.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This does lead to some non-obvious places for valid usage statements.
For instance, the valid values for a structure might depend on a separate
value in the calling command.
In this case, the structure itself will not reference this valid usage as it
is impossible to determine validity from the structure that it is invalid -
instead this valid usage would be attached to the calling command.</p>
</div>
<div class="paragraph">
<p>Another example is draw state - the state setters are independent, and can
cause a legitimately invalid state configuration between draw calls; so the
valid usage statements are attached to the place where all state needs to be
valid - at the draw command.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Valid usage conditions are described in a block labelled &#8220;Valid Usage&#8221;
following each command or structure they apply to.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-implicit-validity">2.7.2. Implicit Valid Usage</h4>
<div class="paragraph">
<p>Some valid usage conditions apply to all commands and structures in the API,
unless explicitly denoted otherwise for a specific command or structure.
These conditions are considered <em>implicit</em>, and are described in a block
labelled &#8220;Valid Usage (Implicit)&#8221; following each command or structure they
apply to.
Implicit valid usage conditions are described in detail below.</p>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-handles">Valid Usage for Object Handles</h5>
<div class="paragraph">
<p>Any input parameter to a command that is an object handle <strong class="purple">must</strong> be a valid
object handle, unless otherwise specified.
An object handle is valid if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It has been created or allocated by a previous, successful call to the
API.
Such calls are noted in the Specification.</p>
</li>
<li>
<p>It has not been deleted or freed by a previous call to the API.
Such calls are noted in the Specification.</p>
</li>
<li>
<p>Any objects used by that object, either as part of creation or
execution, <strong class="purple">must</strong> also be valid.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reserved values <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and <code>NULL</code> <strong class="purple">can</strong> be used in place of
valid non-dispatchable handles and dispatchable handles, respectively, when
<em>explicitly called out in the Specification</em>.
Any command that creates an object successfully <strong class="purple">must</strong> not return these
values.
It is valid to pass these values to <code>vkDestroy*</code> or <code>vkFree*</code>
commands, which will silently ignore these values.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-pointers">Valid Usage for Pointers</h5>
<div class="paragraph">
<p>Any parameter that is a pointer <strong class="purple">must</strong> be a <em>valid pointer</em> only if it is
explicitly called out by a Valid Usage statement.</p>
</div>
<div class="paragraph">
<p>A pointer is &#8220;valid&#8221; if it points at memory containing values of the
number and type(s) expected by the command, and all fundamental types
accessed through the pointer (e.g. as elements of an array or as members of
a structure) satisfy the alignment requirements of the host processor.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-strings">Valid Usage for Strings</h5>
<div class="paragraph">
<p>Any parameter that is a pointer to <code>char</code> <strong class="purple">must</strong> be a finite sequence of
values terminated by a null character, or if <em>explicitly called out in the
Specification</em>, <strong class="purple">can</strong> be <code>NULL</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-enums">Valid Usage for Enumerated Types</h5>
<div class="paragraph">
<p>Any parameter of an enumerated type <strong class="purple">must</strong> be a valid enumerant for that
type.
A enumerant is valid if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The enumerant is defined as part of the enumerated type.</p>
</li>
<li>
<p>The enumerant is not one of the special values defined for the
enumerated type, which are suffixed with <code>_BEGIN_RANGE</code>,
<code>_END_RANGE</code>, <code>_RANGE_SIZE</code> or <code>_MAX_ENUM</code><sup>1</sup>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The meaning of these special tokens is not exposed in the Vulkan
Specification.
They are not part of the API, and they <strong class="purple">should</strong> not be used by
applications.
Their original intended use was for internal consumption by Vulkan
implementations.
Even that use will no longer be supported in the future, but they will
be retained for backwards compatibility reasons.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any enumerated type returned from a query command or otherwise output from
Vulkan to the application <strong class="purple">must</strong> not have a reserved value.
Reserved values are values not defined by any extension for that enumerated
type.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This language is intended to accomodate cases such as &#8220;hidden&#8221; extensions
known only to driver internals, or layers enabling extensions without
knowledge of the application, without allowing return of values not defined
by any extension.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-flags">Valid Usage for Flags</h5>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A collection of flags is represented by a bitmask using the type
<code>VkFlags</code>:</p>
</div>
<div id="VkFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> uint32_t VkFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Bitmasks are passed to many commands and structures to compactly represent
options, but <code>VkFlags</code> is not used directly in the API.
Instead, a <code>Vk*Flags</code> type which is an alias of <code>VkFlags</code>, and
whose name matches the corresponding <code>Vk*FlagBits</code> that are valid for
that type, is used.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Any <code>Vk*Flags</code> member or parameter used in the API as an input <strong class="purple">must</strong> be
a valid combination of bit flags.
A valid combination is either zero or the bitwise OR of valid bit flags.
A bit flag is valid if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The bit flag is defined as part of the <code>Vk*FlagBits</code> type, where the
bits type is obtained by taking the flag type and replacing the trailing
<code>Flags</code> with <code>FlagBits</code>.
For example, a flag value of type <a href="#VkColorComponentFlags">VkColorComponentFlags</a> <strong class="purple">must</strong>
contain only bit flags defined by <a href="#VkColorComponentFlagBits">VkColorComponentFlagBits</a>.</p>
</li>
<li>
<p>The flag is allowed in the context in which it is being used.
For example, in some cases, certain bit flags or combinations of bit
flags are mutually exclusive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any <code>Vk*Flags</code> member or parameter returned from a query command or
otherwise output from Vulkan to the application <strong class="purple">may</strong> contain bit flags
undefined in its corresponding <code>Vk*FlagBits</code> type.
An application <strong class="purple">cannot</strong> rely on the state of these unspecified bits.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-sType">Valid Usage for Structure Types</h5>
<div class="paragraph">
<p>Any parameter that is a structure containing a <code>sType</code> member <strong class="purple">must</strong> have
a value of <code>sType</code> which is a valid <a href="#VkStructureType">VkStructureType</a> value matching
the type of the structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Structure types supported by the Vulkan API include:</p>
</div>
<div id="VkStructureType" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkStructureType {
    VK_STRUCTURE_TYPE_APPLICATION_INFO = <span class="integer">0</span>,
    VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO = <span class="integer">1</span>,
    VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO = <span class="integer">2</span>,
    VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO = <span class="integer">3</span>,
    VK_STRUCTURE_TYPE_SUBMIT_INFO = <span class="integer">4</span>,
    VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO = <span class="integer">5</span>,
    VK_STRUCTURE_TYPE_MAPPED_MEMORY_RANGE = <span class="integer">6</span>,
    VK_STRUCTURE_TYPE_BIND_SPARSE_INFO = <span class="integer">7</span>,
    VK_STRUCTURE_TYPE_FENCE_CREATE_INFO = <span class="integer">8</span>,
    VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO = <span class="integer">9</span>,
    VK_STRUCTURE_TYPE_EVENT_CREATE_INFO = <span class="integer">10</span>,
    VK_STRUCTURE_TYPE_QUERY_POOL_CREATE_INFO = <span class="integer">11</span>,
    VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO = <span class="integer">12</span>,
    VK_STRUCTURE_TYPE_BUFFER_VIEW_CREATE_INFO = <span class="integer">13</span>,
    VK_STRUCTURE_TYPE_IMAGE_CREATE_INFO = <span class="integer">14</span>,
    VK_STRUCTURE_TYPE_IMAGE_VIEW_CREATE_INFO = <span class="integer">15</span>,
    VK_STRUCTURE_TYPE_SHADER_MODULE_CREATE_INFO = <span class="integer">16</span>,
    VK_STRUCTURE_TYPE_PIPELINE_CACHE_CREATE_INFO = <span class="integer">17</span>,
    VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO = <span class="integer">18</span>,
    VK_STRUCTURE_TYPE_PIPELINE_VERTEX_INPUT_STATE_CREATE_INFO = <span class="integer">19</span>,
    VK_STRUCTURE_TYPE_PIPELINE_INPUT_ASSEMBLY_STATE_CREATE_INFO = <span class="integer">20</span>,
    VK_STRUCTURE_TYPE_PIPELINE_TESSELLATION_STATE_CREATE_INFO = <span class="integer">21</span>,
    VK_STRUCTURE_TYPE_PIPELINE_VIEWPORT_STATE_CREATE_INFO = <span class="integer">22</span>,
    VK_STRUCTURE_TYPE_PIPELINE_RASTERIZATION_STATE_CREATE_INFO = <span class="integer">23</span>,
    VK_STRUCTURE_TYPE_PIPELINE_MULTISAMPLE_STATE_CREATE_INFO = <span class="integer">24</span>,
    VK_STRUCTURE_TYPE_PIPELINE_DEPTH_STENCIL_STATE_CREATE_INFO = <span class="integer">25</span>,
    VK_STRUCTURE_TYPE_PIPELINE_COLOR_BLEND_STATE_CREATE_INFO = <span class="integer">26</span>,
    VK_STRUCTURE_TYPE_PIPELINE_DYNAMIC_STATE_CREATE_INFO = <span class="integer">27</span>,
    VK_STRUCTURE_TYPE_GRAPHICS_PIPELINE_CREATE_INFO = <span class="integer">28</span>,
    VK_STRUCTURE_TYPE_COMPUTE_PIPELINE_CREATE_INFO = <span class="integer">29</span>,
    VK_STRUCTURE_TYPE_PIPELINE_LAYOUT_CREATE_INFO = <span class="integer">30</span>,
    VK_STRUCTURE_TYPE_SAMPLER_CREATE_INFO = <span class="integer">31</span>,
    VK_STRUCTURE_TYPE_DESCRIPTOR_SET_LAYOUT_CREATE_INFO = <span class="integer">32</span>,
    VK_STRUCTURE_TYPE_DESCRIPTOR_POOL_CREATE_INFO = <span class="integer">33</span>,
    VK_STRUCTURE_TYPE_DESCRIPTOR_SET_ALLOCATE_INFO = <span class="integer">34</span>,
    VK_STRUCTURE_TYPE_WRITE_DESCRIPTOR_SET = <span class="integer">35</span>,
    VK_STRUCTURE_TYPE_COPY_DESCRIPTOR_SET = <span class="integer">36</span>,
    VK_STRUCTURE_TYPE_FRAMEBUFFER_CREATE_INFO = <span class="integer">37</span>,
    VK_STRUCTURE_TYPE_RENDER_PASS_CREATE_INFO = <span class="integer">38</span>,
    VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO = <span class="integer">39</span>,
    VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO = <span class="integer">40</span>,
    VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_INFO = <span class="integer">41</span>,
    VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO = <span class="integer">42</span>,
    VK_STRUCTURE_TYPE_RENDER_PASS_BEGIN_INFO = <span class="integer">43</span>,
    VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER = <span class="integer">44</span>,
    VK_STRUCTURE_TYPE_IMAGE_MEMORY_BARRIER = <span class="integer">45</span>,
    VK_STRUCTURE_TYPE_MEMORY_BARRIER = <span class="integer">46</span>,
    VK_STRUCTURE_TYPE_LOADER_INSTANCE_CREATE_INFO = <span class="integer">47</span>,
    VK_STRUCTURE_TYPE_LOADER_DEVICE_CREATE_INFO = <span class="integer">48</span>,
} VkStructureType;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each value corresponds to a particular structure with a <code>sType</code> member
with a matching name.
As a general rule, the name of each <code>VkStructureType</code> value is obtained
by taking the name of the structure, stripping the leading <code>Vk</code>,
prefixing each capital letter with <code>_</code>, converting the entire resulting
string to upper case, and prefixing it with <code>VK_STRUCTURE_TYPE_</code>.
For example, structures of type <code>VkImageCreateInfo</code> correspond to a
<code>VkStructureType</code> of <code>VK_STRUCTURE_TYPE_IMAGE_CREATE_INFO</code>, and thus
its <code>sType</code> member <strong class="purple">must</strong> equal that when it is passed to the API.</p>
</div>
<div class="paragraph">
<p>The values <code>VK_STRUCTURE_TYPE_LOADER_INSTANCE_CREATE_INFO</code> and
<code>VK_STRUCTURE_TYPE_LOADER_DEVICE_CREATE_INFO</code> are reserved for internal
use by the loader, and do not have corresponding Vulkan structures in this
Specification.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-pNext">Valid Usage for Structure Pointer Chains</h5>
<div class="paragraph">
<p>Any parameter that is a structure containing a <code>void*</code> <code>pNext</code> member
<strong class="purple">must</strong> have a value of <code>pNext</code> that is either <code>NULL</code>, or points to a
valid structure defined by an extension, containing <code>sType</code> and
<code>pNext</code> members as described in the <a href="#vulkan-styleguide">Vulkan
Documentation and Extensions</a> document in the section &#8220;Extension
Interactions&#8221;.
The set of structures connected by <code>pNext</code> pointers is referred to as a
<em><code>pNext</code> chain</em>.
If that extension is supported by the implementation, then it <strong class="purple">must</strong> be
enabled.</p>
</div>
<div class="paragraph">
<p>Each type of valid structure <strong class="purple">must</strong> not appear more than once in a
<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>Any component of the implementation (the loader, any enabled layers, and
drivers) <strong class="purple">must</strong> skip over, without processing (other than reading the
<code>sType</code> and <code>pNext</code> members) any structures in the chain with
<code>sType</code> values not defined by extensions supported by that component.</p>
</div>
<div class="paragraph">
<p>Extension structures are not described in the base Vulkan Specification, but
either in layered Specifications incorporating those extensions, or in
separate vendor-provided documents.</p>
</div>
<div class="paragraph">
<p>As a convenience to implementations and layers needing to iterate through a
structure pointer chain, the Vulkan API provides the following base
structures:</p>
</div>
<div id="VkBaseInStructure" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkBaseInStructure {
    VkStructureType                    sType;
    <span class="directive">const</span> <span class="keyword">struct</span> VkBaseInStructure*    pNext;
} VkBaseInStructure;</code></pre>
</div>
</div>
<div id="VkBaseOutStructure" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkBaseOutStructure {
    VkStructureType               sType;
    <span class="keyword">struct</span> VkBaseOutStructure*    pNext;
} VkBaseOutStructure;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkBaseInStructure</code> can be used to facilitate iterating through a
read-only structure pointer chain.
<code>VkBaseOutStructure</code> can be used to facilitate iterating through a
structure pointer chain that returns data back to the application.
These structures allow for some type safety and can be used by Vulkan API
functions that operate on generic inputs and outputs.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-nested-structs">Valid Usage for Nested Structures</h5>
<div class="paragraph">
<p>The above conditions also apply recursively to members of structures
provided as input to a command, either as a direct argument to the command,
or themselves a member of another structure.</p>
</div>
<div class="paragraph">
<p>Specifics on valid usage of each command are covered in their individual
sections.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-extensions">Valid Usage for Extensions</h5>
<div class="paragraph">
<p>Instance-level functionality or behavior added by an <a href="#extensions">instance
extension</a> to the API <strong class="purple">must</strong> not be used unless that extension is supported
by the instance as determined by
<a href="#vkEnumerateInstanceExtensionProperties">vkEnumerateInstanceExtensionProperties</a>, and that extension is enabled
in <a href="#VkInstanceCreateInfo">VkInstanceCreateInfo</a>.</p>
</div>
<div class="paragraph">
<p>Physical-device-level functionality or behavior added by an <a href="#extensions">instance extension</a> to the API <strong class="purple">must</strong> not be used unless that extension is
supported by the instance as determined by
<a href="#vkEnumerateInstanceExtensionProperties">vkEnumerateInstanceExtensionProperties</a>, and that extension is enabled
in <a href="#VkInstanceCreateInfo">VkInstanceCreateInfo</a>.</p>
</div>
<div class="paragraph">
<p>Physical-device-level functionality or behavior added by a <a href="#extensions">device extension</a> to the API <strong class="purple">must</strong> not be used unless the conditions
described in <a href="#initialization-phys-dev-extensions">Extending Physical Device
Core Functionality</a> are met.</p>
</div>
<div class="paragraph">
<p>Device functionality or behavior added by a <a href="#extensions">device extension</a>
to the API <strong class="purple">must</strong> not be used unless that extension is supported by the
device as determined by <a href="#vkEnumerateDeviceExtensionProperties">vkEnumerateDeviceExtensionProperties</a>, and that
extension is enabled in <a href="#VkDeviceCreateInfo">VkDeviceCreateInfo</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="fundamentals-validusage-versions">Valid Usage for Newer Core Versions</h5>
<div class="paragraph">
<p>Physical-device-level functionality or behavior added by a <a href="#versions">new
core version</a> of the API <strong class="purple">must</strong> not be used unless it is supported by the
physical device as determined by <a href="#vkGetPhysicalDeviceProperties">vkGetPhysicalDeviceProperties</a>.</p>
</div>
<div class="paragraph">
<p>Device-level functionality or behavior added by a <a href="#versions">new core
version</a> of the API <strong class="purple">must</strong> not be used unless it is supported by the device
as determined by <a href="#vkGetPhysicalDeviceProperties">vkGetPhysicalDeviceProperties</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-returncodes">2.7.3. Return Codes</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>While the core Vulkan API is not designed to capture incorrect usage, some
circumstances still require return codes.
Commands in Vulkan return their status via return codes that are in one of
two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Successful completion codes are returned when a command needs to
communicate success or status information.
All successful completion codes are non-negative values.</p>
</li>
<li>
<p>Run time error codes are returned when a command needs to communicate a
failure that could only be detected at run time.
All run time error codes are negative values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All return codes in Vulkan are reported via <a href="#VkResult">VkResult</a> return values.
The possible codes are:</p>
</div>
<div id="VkResult" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkResult {
    VK_SUCCESS = <span class="integer">0</span>,
    VK_NOT_READY = <span class="integer">1</span>,
    VK_TIMEOUT = <span class="integer">2</span>,
    VK_EVENT_SET = <span class="integer">3</span>,
    VK_EVENT_RESET = <span class="integer">4</span>,
    VK_INCOMPLETE = <span class="integer">5</span>,
    VK_ERROR_OUT_OF_HOST_MEMORY = -<span class="integer">1</span>,
    VK_ERROR_OUT_OF_DEVICE_MEMORY = -<span class="integer">2</span>,
    VK_ERROR_INITIALIZATION_FAILED = -<span class="integer">3</span>,
    VK_ERROR_DEVICE_LOST = -<span class="integer">4</span>,
    VK_ERROR_MEMORY_MAP_FAILED = -<span class="integer">5</span>,
    VK_ERROR_LAYER_NOT_PRESENT = -<span class="integer">6</span>,
    VK_ERROR_EXTENSION_NOT_PRESENT = -<span class="integer">7</span>,
    VK_ERROR_FEATURE_NOT_PRESENT = -<span class="integer">8</span>,
    VK_ERROR_INCOMPATIBLE_DRIVER = -<span class="integer">9</span>,
    VK_ERROR_TOO_MANY_OBJECTS = -<span class="integer">10</span>,
    VK_ERROR_FORMAT_NOT_SUPPORTED = -<span class="integer">11</span>,
    VK_ERROR_FRAGMENTED_POOL = -<span class="integer">12</span>,
} VkResult;</code></pre>
</div>
</div>
<div id="fundamentals-successcodes" class="ulist">
<div class="title">Success Codes</div>
<ul>
<li>
<p><code>VK_SUCCESS</code> Command successfully completed</p>
</li>
<li>
<p><code>VK_NOT_READY</code> A fence or query has not yet completed</p>
</li>
<li>
<p><code>VK_TIMEOUT</code> A wait operation has not completed in the specified
time</p>
</li>
<li>
<p><code>VK_EVENT_SET</code> An event is signaled</p>
</li>
<li>
<p><code>VK_EVENT_RESET</code> An event is unsignaled</p>
</li>
<li>
<p><code>VK_INCOMPLETE</code> A return array was too small for the result</p>
</li>
</ul>
</div>
<div id="fundamentals-errorcodes" class="ulist">
<div class="title">Error codes</div>
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code> A host memory allocation has failed.</p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code> A device memory allocation has
failed.</p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code> Initialization of an object could
not be completed for implementation-specific reasons.</p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code> The logical or physical device has been lost.
See <a href="#devsandqueues-lost-device">Lost Device</a></p>
</li>
<li>
<p><code>VK_ERROR_MEMORY_MAP_FAILED</code> Mapping of a memory object has failed.</p>
</li>
<li>
<p><code>VK_ERROR_LAYER_NOT_PRESENT</code> A requested layer is not present or
could not be loaded.</p>
</li>
<li>
<p><code>VK_ERROR_EXTENSION_NOT_PRESENT</code> A requested extension is not
supported.</p>
</li>
<li>
<p><code>VK_ERROR_FEATURE_NOT_PRESENT</code> A requested feature is not supported.</p>
</li>
<li>
<p><code>VK_ERROR_INCOMPATIBLE_DRIVER</code> The requested version of Vulkan is
not supported by the driver or is otherwise incompatible for
implementation-specific reasons.</p>
</li>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code> Too many objects of the type have
already been created.</p>
</li>
<li>
<p><code>VK_ERROR_FORMAT_NOT_SUPPORTED</code> A requested format is not supported
on this device.</p>
</li>
<li>
<p><code>VK_ERROR_FRAGMENTED_POOL</code> A pool allocation has failed due to
fragmentation of the pool&#8217;s memory.
This <strong class="purple">must</strong> only be returned if no attempt to allocate host or device
memory was made to accomodate the new allocation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a command returns a run time error, unless otherwise specified any output
parameters will have undefined contents, except that if the output parameter
is a structure with <code>sType</code> and <code>pNext</code> fields, those fields will be
unmodified.
Any structures chained from <code>pNext</code> will also have undefined contents,
except that <code>sType</code> and <code>pNext</code> will be unmodified.</p>
</div>
<div class="paragraph">
<p>Out of memory errors do not damage any currently existing Vulkan objects.
Objects that have already been successfully created <strong class="purple">can</strong> still be used by
the application.</p>
</div>
<div class="paragraph">
<p>Performance-critical commands generally do not have return codes.
If a run time error occurs in such commands, the implementation will defer
reporting the error until a specified point.
For commands that record into command buffers (<code>vkCmd*</code>) run time errors
are reported by <code>vkEndCommandBuffer</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-numerics">2.8. Numeric Representation and Computation</h3>
<div class="paragraph">
<p>Implementations normally perform computations in floating-point, and <strong class="purple">must</strong>
meet the range and precision requirements defined under &#8220;Floating-Point
Computation&#8221; below.</p>
</div>
<div class="paragraph">
<p>These requirements only apply to computations performed in Vulkan operations
outside of shader execution, such as texture image specification and
sampling, and per-fragment operations.
Range and precision requirements during shader execution differ and are
specified by the <a href="#spirvenv-precision-operation">Precision and Operation of
SPIR-V Instructions</a> section.</p>
</div>
<div class="paragraph">
<p>In some cases, the representation and/or precision of operations is
implicitly limited by the specified format of vertex or texel data consumed
by Vulkan.
Specific floating-point formats are described later in this section.</p>
</div>
<div class="sect3">
<h4 id="fundamentals-floatingpoint">2.8.1. Floating-Point Computation</h4>
<div class="paragraph">
<p>Most floating-point computation is performed in SPIR-V shader modules.
The properties of computation within shaders are constrained as defined by
the <a href="#spirvenv-precision-operation">Precision and Operation of SPIR-V
Instructions</a> section.</p>
</div>
<div class="paragraph">
<p>Some floating-point computation is performed outside of shaders, such as
viewport and depth range calculations.
For these computations, we do not specify how floating-point numbers are to
be represented, or the details of how operations on them are performed, but
only place minimal requirements on representation and precision as described
in the remainder of this section.</p>
</div>
<div class="paragraph">
<p>We require simply that numbers&#8217; floating-point parts contain enough bits
and that their exponent fields are large enough so that individual results
of floating-point operations are accurate to about 1 part in 10<sup>5</sup>.
The maximum representable magnitude for all floating-point values <strong class="purple">must</strong> be
at least 2<sup>32</sup>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">x × 0 = 0 × x = 0</span> for any non-infinite and
non-<span class="eq">NaN</span> <span class="eq">x</span>.</p>
</dd>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">1 × x = x × 1 = x</span>.</p>
</dd>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">x +  0 = 0 +  x = x</span>.</p>
</dd>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">0<sup>0</sup> = 1</span>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Occasionally, further requirements will be specified.
Most single-precision floating-point formats meet these requirements.</p>
</div>
<div class="paragraph">
<p>The special values <span class="eq">Inf</span> and <span class="eq">-Inf</span> encode values with magnitudes
too large to be represented; the special value <span class="eq">NaN</span> encodes &#8220;Not
A Number&#8221; values resulting from undefined arithmetic operations such
as <span class="eq">0 / 0</span>.
Implementations <strong class="purple">may</strong> support <span class="eq">Inf</span> and <span class="eq">NaN</span> in their floating-point
computations.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-fp-conversion">2.8.2. Floating-Point Format Conversions</h4>
<div class="paragraph">
<p>When a value is converted to a defined floating-point representation, finite
values falling between two representable finite values are rounded to one or
the other.
The rounding mode is not defined.
Finite values whose magnitude is larger than that of any representable
finite value may be rounded either to the closest representable finite value
or to the appropriately signed infinity.
For unsigned destination formats any negative values are converted to zero.
Positive infinity is converted to positive infinity; negative infinity is
converted to negative infinity in signed formats and to zero in unsigned
formats; and any <span class="eq">NaN</span> is converted to a <span class="eq">NaN</span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-fp16">2.8.3. 16-Bit Floating-Point Numbers</h4>
<div class="paragraph">
<p>16-bit floating point numbers are defined in the &#8220;16-bit floating point
numbers&#8221; section of the <a href="#data-format">Khronos Data Format Specification</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-fp11">2.8.4. Unsigned 11-Bit Floating-Point Numbers</h4>
<div class="paragraph">
<p>Unsigned 11-bit floating point numbers are defined in the &#8220;Unsigned 11-bit
floating point numbers&#8221; section of the <a href="#data-format">Khronos Data Format
Specification</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-fp10">2.8.5. Unsigned 10-Bit Floating-Point Numbers</h4>
<div class="paragraph">
<p>Unsigned 10-bit floating point numbers are defined in the &#8220;Unsigned 10-bit
floating point numbers&#8221; section of the <a href="#data-format">Khronos Data Format
Specification</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-general">2.8.6. General Requirements</h4>
<div class="paragraph">
<p>Any representable floating-point value in the appropriate format is legal as
input to a Vulkan command that requires floating-point data.
The result of providing a value that is not a floating-point number to such
a command is unspecified, but <strong class="purple">must</strong> not lead to Vulkan interruption or
termination.
For example, providing a negative zero (where applicable) or a denormalized
number to an Vulkan command <strong class="purple">must</strong> yield deterministic results, while
providing a <span class="eq">NaN</span> or <span class="eq">Inf</span> yields unspecified results.</p>
</div>
<div class="paragraph">
<p>Some calculations require division.
In such cases (including implied divisions performed by vector
normalization), division by zero produces an unspecified result but <strong class="purple">must</strong>
not lead to Vulkan interruption or termination.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-fixedconv">2.9. Fixed-Point Data Conversions</h3>
<div class="paragraph">
<p>When generic vertex attributes and pixel color or depth <em>components</em> are
represented as integers, they are often (but not always) considered to be
<em>normalized</em>.
Normalized integer values are treated specially when being converted to and
from floating-point values, and are usually referred to as <em>normalized
fixed-point</em>.</p>
</div>
<div class="paragraph">
<p>In the remainder of this section, <span class="eq">b</span> denotes the bit width of the
fixed-point integer representation.
When the integer is one of the types defined by the API, <span class="eq">b</span> is the bit
width of that type.
When the integer comes from an <a href="#resources-images">image</a> containing color
or depth component texels, <span class="eq">b</span> is the number of bits allocated to that
component in its <a href="#features-formats">specified image format</a>.</p>
</div>
<div class="paragraph">
<p>The signed and unsigned fixed-point representations are assumed to be
<span class="eq">b</span>-bit binary two&#8217;s-complement integers and binary unsigned integers,
respectively.</p>
</div>
<div class="sect3">
<h4 id="fundamentals-fixedfpconv">2.9.1. Conversion from Normalized Fixed-Point to Floating-Point</h4>
<div class="paragraph">
<p>Unsigned normalized fixed-point integers represent numbers in the range
<span class="eq">[0,1]</span>.
The conversion from an unsigned normalized fixed-point value <span class="eq">c</span> to the
corresponding floating-point value <span class="eq">f</span> is defined as</p>
</div>
<div class="stemblock">
<div class="content">
\[f = { c \over { 2^b - 1 } }\]
</div>
</div>
<div class="paragraph">
<p>Signed normalized fixed-point integers represent numbers in the range
<span class="eq">[-1,1]</span>.
The conversion from a signed normalized fixed-point value <span class="eq">c</span> to the
corresponding floating-point value <span class="eq">f</span> is performed using</p>
</div>
<div class="stemblock">
<div class="content">
\[f = \max\left( {c \over {2^{b-1} - 1}}, -1.0 \right)\]
</div>
</div>
<div class="paragraph">
<p>Only the range <span class="eq">[-2<sup>b-1</sup> +  1, 2<sup>b-1</sup> - 1]</span> is used to represent
signed fixed-point values in the range <span class="eq">[-1,1]</span>.
For example, if <span class="eq">b = 8</span>, then the integer value <span class="eq">-127</span> corresponds
to <span class="eq">-1.0</span> and the value 127 corresponds to <span class="eq">1.0</span>.
Note that while zero is exactly expressible in this representation, one
value (<span class="eq">-128</span> in the example) is outside the representable range, and
<strong class="purple">must</strong> be clamped before use.
This equation is used everywhere that signed normalized fixed-point values
are converted to floating-point.</p>
</div>
</div>
<div class="sect3">
<h4 id="fundamentals-fpfixedconv">2.9.2. Conversion from Floating-Point to Normalized Fixed-Point</h4>
<div class="paragraph">
<p>The conversion from a floating-point value <span class="eq">f</span> to the corresponding
unsigned normalized fixed-point value <span class="eq">c</span> is defined by first clamping
<span class="eq">f</span> to the range <span class="eq">[0,1]</span>, then computing</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">c = convertFloatToUint(f × (2<sup>b</sup> - 1), b)</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>where <span class="eq">convertFloatToUint}(r,b)</span> returns one of the two unsigned binary
integer values with exactly <span class="eq">b</span> bits which are closest to the
floating-point value <span class="eq">r</span>.
Implementations <strong class="purple">should</strong> round to nearest.
If <span class="eq">r</span> is equal to an integer, then that integer value <strong class="purple">must</strong> be
returned.
In particular, if <span class="eq">f</span> is equal to 0.0 or 1.0, then <span class="eq">c</span> <strong class="purple">must</strong> be
assigned 0 or <span class="eq">2<sup>b</sup> - 1</span>, respectively.</p>
</div>
<div class="paragraph">
<p>The conversion from a floating-point value <span class="eq">f</span> to the corresponding
signed normalized fixed-point value <span class="eq">c</span> is performed by clamping <span class="eq">f</span>
to the range <span class="eq">[-1,1]</span>, then computing</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">c = convertFloatToInt(f × (2<sup>b-1</sup> - 1), b)</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>where <span class="eq">convertFloatToInt(r,b)</span> returns one of the two signed
two&#8217;s-complement binary integer values with exactly <span class="eq">b</span> bits which are
closest to the floating-point value <span class="eq">r</span>.
Implementations <strong class="purple">should</strong> round to nearest.
If <span class="eq">r</span> is equal to an integer, then that integer value <strong class="purple">must</strong> be
returned.
In particular, if <span class="eq">f</span> is equal to -1.0, 0.0, or 1.0, then <span class="eq">c</span> <strong class="purple">must</strong>
be assigned <span class="eq">-(2<sup>b-1</sup> - 1)</span>, 0, or <span class="eq">2<sup>b-1</sup> - 1</span>, respectively.</p>
</div>
<div class="paragraph">
<p>This equation is used everywhere that floating-point values are converted to
signed normalized fixed-point.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-versionnum">2.10. API Version Numbers and Semantics</h3>
<div class="paragraph">
<p>The Vulkan version number is used in several places in the API.
In each such use, the API <em>major version number</em>, <em>minor version number</em>,
and <em>patch version number</em> are packed into a 32-bit integer as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The major version number is a 10-bit integer packed into bits 31-22.</p>
</li>
<li>
<p>The minor version number is a 10-bit integer packed into bits 21-12.</p>
</li>
<li>
<p>The patch version number is a 12-bit integer packed into bits 11-0.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Differences in any of the Vulkan version numbers indicates a change to the
API in some way, with each part of the version number indicating a different
scope of changes.</p>
</div>
<div class="paragraph">
<p>A difference in patch version numbers indicates that some usually small part
of the Specification or header has been modified, typically to fix a bug,
and <strong class="purple">may</strong> have an impact on the behavior of existing functionality.
Differences in this version number <strong class="purple">should</strong> not affect either <em>full
compatibility</em> or <em>backwards compatibility</em> between two versions, or add
additional interfaces to the API.</p>
</div>
<div class="paragraph">
<p>A difference in minor version numbers indicates that some amount of new
functionality has been added.
This will usually include new interfaces in the header, and <strong class="purple">may</strong> also
include behavior changes and bug fixes.
Functionality <strong class="purple">may</strong> be deprecated in a minor revision, but will not be
removed.
The patch version will continue to increment through minor version number
changes since all minor versions are generated from the same source files,
and changes to the source files may affect all minor versions within a major
version.
Differences in the patch version <strong class="purple">should</strong> not affect backwards compatibility,
but will affect full compatibility.
The patch version of the Specification is taken from
<a href="#VK_HEADER_VERSION">VK_HEADER_VERSION</a>.</p>
</div>
<div class="paragraph">
<p>A difference in major version numbers indicates a large set of changes to
the API, potentially including new functionality and header interfaces,
behavioral changes, removal of deprecated features, modification or outright
replacement of any feature, and is thus very likely to break any and all
compatibility.
Differences in this version will typically require significant modification
to an application in order for it to function.</p>
</div>
<div class="paragraph">
<p>C language macros for manipulating version numbers are defined in the
<a href="#boilerplate-versions">Version Number Macros</a> appendix.</p>
</div>
</div>
<div class="sect2">
<h3 id="fundamentals-common-objects">2.11. Common Object Types</h3>
<div class="paragraph">
<p>Some types of Vulkan objects are used in many different structures and
command parameters, and are described here.
These types include <em>offsets</em>, <em>extents</em>, and <em>rectangles</em>.</p>
</div>
<div class="sect3">
<h4 id="_offsets">2.11.1. Offsets</h4>
<div class="paragraph">
<p>Offsets are used to describe a pixel location within an image or
framebuffer, as an (x,y) location for two-dimensional images, or an (x,y,z)
location for three-dimensional images.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A two-dimensional offsets is defined by the structure:</p>
</div>
<div id="VkOffset2D" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkOffset2D {
    int32_t    x;
    int32_t    y;
} VkOffset2D;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>x</code> is the x offset.</p>
</li>
<li>
<p><code>y</code> is the y offset.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A three-dimensional offset is defined by the structure:</p>
</div>
<div id="VkOffset3D" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkOffset3D {
    int32_t    x;
    int32_t    y;
    int32_t    z;
} VkOffset3D;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>x</code> is the x offset.</p>
</li>
<li>
<p><code>y</code> is the y offset.</p>
</li>
<li>
<p><code>z</code> is the z offset.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_extents">2.11.2. Extents</h4>
<div class="paragraph">
<p>Extents are used to describe the size of a rectangular region of pixels
within an image or framebuffer, as (width,height) for two-dimensional
images, or as (width,height,depth) for three-dimensional images.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A two-dimensional extent is defined by the structure:</p>
</div>
<div id="VkExtent2D" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkExtent2D {
    uint32_t    width;
    uint32_t    height;
} VkExtent2D;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>width</code> is the width of the extent.</p>
</li>
<li>
<p><code>height</code> is the height of the extent.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A three-dimensional extent is defined by the structure:</p>
</div>
<div id="VkExtent3D" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkExtent3D {
    uint32_t    width;
    uint32_t    height;
    uint32_t    depth;
} VkExtent3D;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>width</code> is the width of the extent.</p>
</li>
<li>
<p><code>height</code> is the height of the extent.</p>
</li>
<li>
<p><code>depth</code> is the depth of the extent.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rectangles">2.11.3. Rectangles</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Rectangles are used to describe a specified rectangular region of pixels
within an image or framebuffer.
Rectangles include both an offset and an extent of the same dimensionality,
as described above.
Two-dimensional rectangles are defined by the structure</p>
</div>
<div id="VkRect2D" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkRect2D {
    VkOffset2D    offset;
    VkExtent2D    extent;
} VkRect2D;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>offset</code> is a <a href="#VkOffset2D">VkOffset2D</a> specifying the rectangle offset.</p>
</li>
<li>
<p><code>extent</code> is a <a href="#VkExtent2D">VkExtent2D</a> specifying the rectangle extent.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="initialization">3. Initialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before using Vulkan, an application <strong class="purple">must</strong> initialize it by loading the
Vulkan commands, and creating a <code>VkInstance</code> object.</p>
</div>
<div class="sect2">
<h3 id="initialization-functionpointers">3.1. Command Function Pointers</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Vulkan commands are not necessarily exposed statically on a platform.
Function pointers for all Vulkan commands <strong class="purple">can</strong> be obtained with the command:</p>
</div>
<div id="vkGetInstanceProcAddr" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">PFN_vkVoidFunction vkGetInstanceProcAddr(
    VkInstance                                  instance,
    <span class="directive">const</span> <span class="predefined-type">char</span>*                                 pName);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>instance</code> is the instance that the function pointer will be
compatible with, or <code>NULL</code> for commands not dependent on any instance.</p>
</li>
<li>
<p><code>pName</code> is the name of the command to obtain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkGetInstanceProcAddr</code> itself is obtained in a platform- and loader-
specific manner.
Typically, the loader library will export this command as a function symbol,
so applications <strong class="purple">can</strong> link against the loader library, or load it dynamically
and look up the symbol using platform-specific APIs.</p>
</div>
<div class="paragraph">
<p>The table below defines the various use cases for
<code>vkGetInstanceProcAddr</code> and expected return value (&#8220;fp&#8221; is &#8220;function
pointer&#8221;) for each case.</p>
</div>
<div class="paragraph">
<p>The returned function pointer is of type <a href="#PFN_vkVoidFunction">PFN_vkVoidFunction</a>, and must
be cast to the type of the command being queried.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 1. vkGetInstanceProcAddr behavior</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>instance</code></th>
<th class="tableblock halign-left valign-top"><code>pName</code></th>
<th class="tableblock halign-left valign-top">return value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undefined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undefined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#vkEnumerateInstanceExtensionProperties">vkEnumerateInstanceExtensionProperties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#vkEnumerateInstanceLayerProperties">vkEnumerateInstanceLayerProperties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#vkCreateInstance">vkCreateInstance</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* (any <code>pName</code> not covered above)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">core Vulkan command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp<sup>1</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled instance extension commands for <code>instance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp<sup>1</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">available device extension<sup>2</sup> commands for <code>instance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp<sup>1</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* (any <code>pName</code> not covered above)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The returned function pointer <strong class="purple">must</strong> only be called with a dispatchable
object (the first parameter) that is <code>instance</code> or a child of
<code>instance</code>, e.g. <a href="#VkInstance">VkInstance</a>, <a href="#VkPhysicalDevice">VkPhysicalDevice</a>,
<a href="#VkDevice">VkDevice</a>, <a href="#VkQueue">VkQueue</a>, or <a href="#VkCommandBuffer">VkCommandBuffer</a>.</p>
</dd>
<dt class="hdlist1">2</dt>
<dd>
<p>An &#8220;available device extension&#8221; is a device extension supported by any
physical device enumerated by <code>instance</code>.</p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetInstanceProcAddr-instance-parameter"></a> If <code>instance</code> is not <code>NULL</code>, <code>instance</code> <strong class="purple">must</strong> be a valid <code>VkInstance</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetInstanceProcAddr-pName-parameter"></a> <code>pName</code> <strong class="purple">must</strong> be a null-terminated UTF-8 string</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In order to support systems with multiple Vulkan implementations, the
function pointers returned by <code>vkGetInstanceProcAddr</code> <strong class="purple">may</strong> point to
dispatch code that calls a different real implementation for different
<a href="#VkDevice">VkDevice</a> objects or their child objects.
The overhead of the internal dispatch for <a href="#VkDevice">VkDevice</a> objects can be
avoided by obtaining device-specific function pointers for any commands that
use a device or device-child object as their dispatchable object.
Such function pointers <strong class="purple">can</strong> be obtained with the command:</p>
</div>
<div id="vkGetDeviceProcAddr" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">PFN_vkVoidFunction vkGetDeviceProcAddr(
    VkDevice                                    device,
    <span class="directive">const</span> <span class="predefined-type">char</span>*                                 pName);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The table below defines the various use cases for <code>vkGetDeviceProcAddr</code>
and expected return value for each case.</p>
</div>
<div class="paragraph">
<p>The returned function pointer is of type <a href="#PFN_vkVoidFunction">PFN_vkVoidFunction</a>, and must
be cast to the type of the command being queried.
The function pointer <strong class="purple">must</strong> only be called with a dispatchable object (the
first parameter) that is <code>device</code> or a child of <code>device</code>.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 2. vkGetDeviceProcAddr behavior</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>device</code></th>
<th class="tableblock halign-left valign-top"><code>pName</code></th>
<th class="tableblock halign-left valign-top">return value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undefined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">invalid device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undefined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undefined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">core device-level Vulkan command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled device extension commands</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">* (any <code>pName</code> not covered above)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NULL</code></p></td>
</tr>
</tbody>
</table>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceProcAddr-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceProcAddr-pName-parameter"></a> <code>pName</code> <strong class="purple">must</strong> be a null-terminated UTF-8 string</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The definition of <a href="#PFN_vkVoidFunction">PFN_vkVoidFunction</a> is:</p>
</div>
<div id="PFN_vkVoidFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkVoidFunction)(<span class="directive">void</span>);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="initialization-instances">3.2. Instances</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>There is no global state in Vulkan and all per-application state is stored
in a <code>VkInstance</code> object.
Creating a <code>VkInstance</code> object initializes the Vulkan library and allows
the application to pass information about itself to the implementation.</p>
</div>
<div class="paragraph">
<p>Instances are represented by <code>VkInstance</code> handles:</p>
</div>
<div id="VkInstance" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_HANDLE(VkInstance)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create an instance object, call:</p>
</div>
<div id="vkCreateInstance" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateInstance(
    <span class="directive">const</span> VkInstanceCreateInfo*                 pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkInstance*                                 pInstance);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pCreateInfo</code> points to an instance of <a href="#VkInstanceCreateInfo">VkInstanceCreateInfo</a>
controlling creation of the instance.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pInstance</code> points a <a href="#VkInstance">VkInstance</a> handle in which the resulting
instance is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCreateInstance</code> verifies that the requested layers exist.
If not, <code>vkCreateInstance</code> will return <code>VK_ERROR_LAYER_NOT_PRESENT</code>.
Next <code>vkCreateInstance</code> verifies that the requested extensions are
supported (e.g. in the implementation or in any enabled instance layer) and
if any requested extension is not supported, <code>vkCreateInstance</code> <strong class="purple">must</strong>
return <code>VK_ERROR_EXTENSION_NOT_PRESENT</code>.
After verifying and enabling the instance layers and extensions the
<code>VkInstance</code> object is created and returned to the application.
If a requested extension is only supported by a layer, both the layer and
the extension need to be specified at <code>vkCreateInstance</code> time for the
creation to succeed.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateInstance-ppEnabledExtensionNames-01388"></a>
All <a href="#extended-functionality-extensions-dependencies">required
extensions</a> for each extension in the
<a href="#VkInstanceCreateInfo">VkInstanceCreateInfo</a>::<code>ppEnabledExtensionNames</code> list <strong class="purple">must</strong>
also be present in that list.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateInstance-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkInstanceCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateInstance-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateInstance-pInstance-parameter"></a> <code>pInstance</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkInstance</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_LAYER_NOT_PRESENT</code></p>
</li>
<li>
<p><code>VK_ERROR_EXTENSION_NOT_PRESENT</code></p>
</li>
<li>
<p><code>VK_ERROR_INCOMPATIBLE_DRIVER</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkInstanceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkInstanceCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkInstanceCreateInfo {
    VkStructureType             sType;
    <span class="directive">const</span> <span class="directive">void</span>*                 pNext;
    VkInstanceCreateFlags       flags;
    <span class="directive">const</span> VkApplicationInfo*    pApplicationInfo;
    uint32_t                    enabledLayerCount;
    <span class="directive">const</span> <span class="predefined-type">char</span>* <span class="directive">const</span>*          ppEnabledLayerNames;
    uint32_t                    enabledExtensionCount;
    <span class="directive">const</span> <span class="predefined-type">char</span>* <span class="directive">const</span>*          ppEnabledExtensionNames;
} VkInstanceCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>pApplicationInfo</code> is <code>NULL</code> or a pointer to an instance of
<code>VkApplicationInfo</code>.
If not <code>NULL</code>, this information helps implementations recognize behavior
inherent to classes of applications.
<a href="#VkApplicationInfo">VkApplicationInfo</a> is defined in detail below.</p>
</li>
<li>
<p><code>enabledLayerCount</code> is the number of global layers to enable.</p>
</li>
<li>
<p><code>ppEnabledLayerNames</code> is a pointer to an array of
<code>enabledLayerCount</code> null-terminated UTF-8 strings containing the
names of layers to enable for the created instance.
See the <a href="#extended-functionality-layers">Layers</a> section for further
details.</p>
</li>
<li>
<p><code>enabledExtensionCount</code> is the number of global extensions to
enable.</p>
</li>
<li>
<p><code>ppEnabledExtensionNames</code> is a pointer to an array of
<code>enabledExtensionCount</code> null-terminated UTF-8 strings containing the
names of extensions to enable.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkInstanceCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkInstanceCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkInstanceCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkInstanceCreateInfo-pApplicationInfo-parameter"></a> If <code>pApplicationInfo</code> is not <code>NULL</code>, <code>pApplicationInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkApplicationInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkInstanceCreateInfo-ppEnabledLayerNames-parameter"></a> If <code>enabledLayerCount</code> is not <code>0</code>, <code>ppEnabledLayerNames</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>enabledLayerCount</code> null-terminated UTF-8 strings</p>
</li>
<li>
<p><a id="VUID-VkInstanceCreateInfo-ppEnabledExtensionNames-parameter"></a> If <code>enabledExtensionCount</code> is not <code>0</code>, <code>ppEnabledExtensionNames</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>enabledExtensionCount</code> null-terminated UTF-8 strings</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkInstanceCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkInstanceCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkInstanceCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkApplicationInfo</code> structure is defined as:</p>
</div>
<div id="VkApplicationInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkApplicationInfo {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    <span class="directive">const</span> <span class="predefined-type">char</span>*        pApplicationName;
    uint32_t           applicationVersion;
    <span class="directive">const</span> <span class="predefined-type">char</span>*        pEngineName;
    uint32_t           engineVersion;
    uint32_t           apiVersion;
} VkApplicationInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>pApplicationName</code> is <code>NULL</code> or is a pointer to a null-terminated
UTF-8 string containing the name of the application.</p>
</li>
<li>
<p><code>applicationVersion</code> is an unsigned integer variable containing the
developer-supplied version number of the application.</p>
</li>
<li>
<p><code>pEngineName</code> is <code>NULL</code> or is a pointer to a null-terminated UTF-8
string containing the name of the engine (if any) used to create the
application.</p>
</li>
<li>
<p><code>engineVersion</code> is an unsigned integer variable containing the
developer-supplied version number of the engine used to create the
application.</p>
</li>
<li>
<p><code>apiVersion</code> is the version of the Vulkan API against which the
application expects to run, encoded as described in the
<a href="#fundamentals-versionnum">API Version Numbers and Semantics</a> section.
If <code>apiVersion</code> is 0 the implementation <strong class="purple">must</strong> ignore it, otherwise
if the implementation does not support the requested <code>apiVersion</code>,
or an effective substitute for <code>apiVersion</code>, it <strong class="purple">must</strong> return
<code>VK_ERROR_INCOMPATIBLE_DRIVER</code>.
The patch version number specified in <code>apiVersion</code> is ignored when
creating an instance object.
Only the major and minor versions of the instance <strong class="purple">must</strong> match those
requested in <code>apiVersion</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkApplicationInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_APPLICATION_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkApplicationInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkApplicationInfo-pApplicationName-parameter"></a> If <code>pApplicationName</code> is not <code>NULL</code>, <code>pApplicationName</code> <strong class="purple">must</strong> be a null-terminated UTF-8 string</p>
</li>
<li>
<p><a id="VUID-VkApplicationInfo-pEngineName-parameter"></a> If <code>pEngineName</code> is not <code>NULL</code>, <code>pEngineName</code> <strong class="purple">must</strong> be a null-terminated UTF-8 string</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy an instance, call:</p>
</div>
<div id="vkDestroyInstance" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyInstance(
    VkInstance                                  instance,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>instance</code> is the handle of the instance to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyInstance-instance-00629"></a>
All child objects created using <code>instance</code> <strong class="purple">must</strong> have been destroyed
prior to destroying <code>instance</code></p>
</li>
<li>
<p><a id="VUID-vkDestroyInstance-instance-00630"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>instance</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyInstance-instance-00631"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>instance</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyInstance-instance-parameter"></a> If <code>instance</code> is not <code>NULL</code>, <code>instance</code> <strong class="purple">must</strong> be a valid <code>VkInstance</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyInstance-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>instance</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devsandqueues">4. Devices and Queues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once Vulkan is initialized, devices and queues are the primary objects used
to interact with a Vulkan implementation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Vulkan separates the concept of <em>physical</em> and <em>logical</em> devices.
A physical device usually represents a single complete implementation of
Vulkan (excluding instance-level functionality) available to the host, of
which there are a finite number.
A logical device represents an instance of that implementation with its own
state and resources independent of other logical devices.</p>
</div>
<div class="paragraph">
<p>Physical devices are represented by <code>VkPhysicalDevice</code> handles:</p>
</div>
<div id="VkPhysicalDevice" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_HANDLE(VkPhysicalDevice)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="devsandqueues-physical-device-enumeration">4.1. Physical Devices</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve a list of physical device objects representing the physical
devices installed in the system, call:</p>
</div>
<div id="vkEnumeratePhysicalDevices" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkEnumeratePhysicalDevices(
    VkInstance                                  instance,
    uint32_t*                                   pPhysicalDeviceCount,
    VkPhysicalDevice*                           pPhysicalDevices);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>instance</code> is a handle to a Vulkan instance previously created with
<a href="#vkCreateInstance">vkCreateInstance</a>.</p>
</li>
<li>
<p><code>pPhysicalDeviceCount</code> is a pointer to an integer related to the
number of physical devices available or queried, as described below.</p>
</li>
<li>
<p><code>pPhysicalDevices</code> is either <code>NULL</code> or a pointer to an array of
<code>VkPhysicalDevice</code> handles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pPhysicalDevices</code> is <code>NULL</code>, then the number of physical devices
available is returned in <code>pPhysicalDeviceCount</code>.
Otherwise, <code>pPhysicalDeviceCount</code> <strong class="purple">must</strong> point to a variable set by the
user to the number of elements in the <code>pPhysicalDevices</code> array, and on
return the variable is overwritten with the number of handles actually
written to <code>pPhysicalDevices</code>.
If <code>pPhysicalDeviceCount</code> is less than the number of physical devices
available, at most <code>pPhysicalDeviceCount</code> structures will be written.
If <code>pPhysicalDeviceCount</code> is smaller than the number of physical devices
available, <code>VK_INCOMPLETE</code> will be returned instead of <code>VK_SUCCESS</code>,
to indicate that not all the available physical devices were returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkEnumeratePhysicalDevices-instance-parameter"></a> <code>instance</code> <strong class="purple">must</strong> be a valid <code>VkInstance</code> handle</p>
</li>
<li>
<p><a id="VUID-vkEnumeratePhysicalDevices-pPhysicalDeviceCount-parameter"></a> <code>pPhysicalDeviceCount</code> <strong class="purple">must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkEnumeratePhysicalDevices-pPhysicalDevices-parameter"></a> If the value referenced by <code>pPhysicalDeviceCount</code> is not <code>0</code>, and <code>pPhysicalDevices</code> is not <code>NULL</code>, <code>pPhysicalDevices</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pPhysicalDeviceCount</code> <code>VkPhysicalDevice</code> handles</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query general properties of physical devices once enumerated, call:</p>
</div>
<div id="vkGetPhysicalDeviceProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetPhysicalDeviceProperties(
    VkPhysicalDevice                            physicalDevice,
    VkPhysicalDeviceProperties*                 pProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the physical device whose
properties will be queried.</p>
</li>
<li>
<p><code>pProperties</code> points to an instance of the
<a href="#VkPhysicalDeviceProperties">VkPhysicalDeviceProperties</a> structure, that will be filled with
returned information.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceProperties-physicalDevice-parameter"></a> <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <code>VkPhysicalDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceProperties-pProperties-parameter"></a> <code>pProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkPhysicalDeviceProperties</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceProperties</code> structure is defined as:</p>
</div>
<div id="VkPhysicalDeviceProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPhysicalDeviceProperties {
    uint32_t                            apiVersion;
    uint32_t                            driverVersion;
    uint32_t                            vendorID;
    uint32_t                            deviceID;
    VkPhysicalDeviceType                deviceType;
    <span class="predefined-type">char</span>                                deviceName[VK_MAX_PHYSICAL_DEVICE_NAME_SIZE];
    uint8_t                             pipelineCacheUUID[VK_UUID_SIZE];
    VkPhysicalDeviceLimits              limits;
    VkPhysicalDeviceSparseProperties    sparseProperties;
} VkPhysicalDeviceProperties;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>apiVersion</code> is the version of Vulkan supported by the device,
encoded as described in the <a href="#fundamentals-versionnum">API Version
Numbers and Semantics</a> section.</p>
</li>
<li>
<p><code>driverVersion</code> is the vendor-specified version of the driver.</p>
</li>
<li>
<p><code>vendorID</code> is a unique identifier for the <em>vendor</em> (see below) of
the physical device.</p>
</li>
<li>
<p><code>deviceID</code> is a unique identifier for the physical device among
devices available from the vendor.</p>
</li>
<li>
<p><code>deviceType</code> is a <a href="#VkPhysicalDeviceType">VkPhysicalDeviceType</a> specifying the type of
device.</p>
</li>
<li>
<p><code>deviceName</code> is a null-terminated UTF-8 string containing the name
of the device.</p>
</li>
<li>
<p><code>pipelineCacheUUID</code> is an array of size <code>VK_UUID_SIZE</code>,
containing 8-bit values that represent a universally unique identifier
for the device.</p>
</li>
<li>
<p><code>limits</code> is the <a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a> structure which
specifies device-specific limits of the physical device.
See <a href="#features-limits">Limits</a> for details.</p>
</li>
<li>
<p><code>sparseProperties</code> is the <a href="#VkPhysicalDeviceSparseProperties">VkPhysicalDeviceSparseProperties</a>
structure which specifies various sparse related properties of the
physical device.
See <a href="#sparsememory-physicalprops">Sparse Properties</a> for details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vendorID</code> and <code>deviceID</code> fields are provided to allow
applications to adapt to device characteristics that are not adequately
exposed by other Vulkan queries.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>These <strong class="purple">may</strong> include performance profiles, hardware errata, or other
characteristics.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <em>vendor</em> identified by <code>vendorID</code> is the entity responsible for the
most salient characteristics of the underlying implementation of the
<a href="#VkPhysicalDevice">VkPhysicalDevice</a> being queried.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For example, in the case of a discrete GPU implementation, this <strong class="purple">should</strong> be
the GPU chipset vendor.
In the case of a hardware accelerator integrated into a system-on-chip
(SoC), this <strong class="purple">should</strong> be the supplier of the silicon IP used to create the
accelerator.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the vendor has a <a href="https://pcisig.com/membership/member-companies">PCI
vendor ID</a>, the low 16 bits of <code>vendorID</code> <strong class="purple">must</strong> contain that PCI vendor
ID, and the remaining bits <strong class="purple">must</strong> be set to zero.
Otherwise, the value returned <strong class="purple">must</strong> be a valid Khronos vendor ID, obtained
as described in the <a href="#vulkan-styleguide">Vulkan Documentation and Extensions:
Procedures and Conventions</a> document in the section &#8220;Registering a Vendor
ID with Khronos&#8221;.
Khronos vendor IDs are allocated starting at 0x10000, to distinguish them
from the PCI vendor ID namespace.
Khronos vendor IDs are symbolically defined in the <a href="#VkVendorId">VkVendorId</a> type.</p>
</div>
<div class="paragraph">
<p>The vendor is also responsible for the value returned in <code>deviceID</code>.
If the implementation is driven primarily by a <a href="https://pcisig.com/">PCI
device</a> with a <a href="https://pcisig.com/">PCI device ID</a>, the low 16 bits of
<code>deviceID</code> <strong class="purple">must</strong> contain that PCI device ID, and the remaining bits
<strong class="purple">must</strong> be set to zero.
Otherwise, the choice of what values to return <strong class="purple">may</strong> be dictated by operating
system or platform policies - but <strong class="purple">should</strong> uniquely identify both the device
version and any major configuration options (for example, core count in the
case of multicore devices).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The same device ID <strong class="purple">should</strong> be used for all physical implementations of that
device version and configuration.
For example, all uses of a specific silicon IP GPU version and configuration
<strong class="purple">should</strong> use the same device ID, even if those uses occur in different SoCs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Khronos vendor IDs which <strong class="purple">may</strong> be returned in
<a href="#VkPhysicalDeviceProperties">VkPhysicalDeviceProperties</a>::<code>vendorID</code> are:</p>
</div>
<div id="VkVendorId" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkVendorId {
    VK_VENDOR_ID_VIV = <span class="hex">0x10001</span>,
    VK_VENDOR_ID_VSI = <span class="hex">0x10002</span>,
    VK_VENDOR_ID_KAZAN = <span class="hex">0x10003</span>,
} VkVendorId;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Khronos vendor IDs may be allocated by vendors at any time.
Only the latest canonical versions of this Specification, of the
corresponding <code>vk.xml</code> API Registry, and of the corresponding
<code>vulkan_core.h</code> header file <strong class="purple">must</strong> contain all reserved Khronos vendor IDs.</p>
</div>
<div class="paragraph">
<p>Only Khronos vendor IDs are given symbolic names at present.
PCI vendor IDs returned by the implementation can be looked up in the
PCI-SIG database.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The physical device types which <strong class="purple">may</strong> be returned in
<a href="#VkPhysicalDeviceProperties">VkPhysicalDeviceProperties</a>::<code>deviceType</code> are:</p>
</div>
<div id="VkPhysicalDeviceType" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkPhysicalDeviceType {
    VK_PHYSICAL_DEVICE_TYPE_OTHER = <span class="integer">0</span>,
    VK_PHYSICAL_DEVICE_TYPE_INTEGRATED_GPU = <span class="integer">1</span>,
    VK_PHYSICAL_DEVICE_TYPE_DISCRETE_GPU = <span class="integer">2</span>,
    VK_PHYSICAL_DEVICE_TYPE_VIRTUAL_GPU = <span class="integer">3</span>,
    VK_PHYSICAL_DEVICE_TYPE_CPU = <span class="integer">4</span>,
} VkPhysicalDeviceType;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PHYSICAL_DEVICE_TYPE_OTHER</code> - the device does not match any
other available types.</p>
</li>
<li>
<p><code>VK_PHYSICAL_DEVICE_TYPE_INTEGRATED_GPU</code> - the device is typically
one embedded in or tightly coupled with the host.</p>
</li>
<li>
<p><code>VK_PHYSICAL_DEVICE_TYPE_DISCRETE_GPU</code> - the device is typically a
separate processor connected to the host via an interlink.</p>
</li>
<li>
<p><code>VK_PHYSICAL_DEVICE_TYPE_VIRTUAL_GPU</code> - the device is typically a
virtual node in a virtualization environment.</p>
</li>
<li>
<p><code>VK_PHYSICAL_DEVICE_TYPE_CPU</code> - the device is typically running on
the same processors as the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The physical device type is advertised for informational purposes only, and
does not directly affect the operation of the system.
However, the device type <strong class="purple">may</strong> correlate with other advertised properties or
capabilities of the system, such as how many memory heaps there are.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query properties of queues available on a physical device, call:</p>
</div>
<div id="vkGetPhysicalDeviceQueueFamilyProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetPhysicalDeviceQueueFamilyProperties(
    VkPhysicalDevice                            physicalDevice,
    uint32_t*                                   pQueueFamilyPropertyCount,
    VkQueueFamilyProperties*                    pQueueFamilyProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the physical device whose
properties will be queried.</p>
</li>
<li>
<p><code>pQueueFamilyPropertyCount</code> is a pointer to an integer related to
the number of queue families available or queried, as described below.</p>
</li>
<li>
<p><code>pQueueFamilyProperties</code> is either <code>NULL</code> or a pointer to an array
of <a href="#VkQueueFamilyProperties">VkQueueFamilyProperties</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pQueueFamilyProperties</code> is <code>NULL</code>, then the number of queue families
available is returned in <code>pQueueFamilyPropertyCount</code>.
Otherwise, <code>pQueueFamilyPropertyCount</code> <strong class="purple">must</strong> point to a variable set by
the user to the number of elements in the <code>pQueueFamilyProperties</code>
array, and on return the variable is overwritten with the number of
structures actually written to <code>pQueueFamilyProperties</code>.
If <code>pQueueFamilyPropertyCount</code> is less than the number of queue families
available, at most <code>pQueueFamilyPropertyCount</code> structures will be
written.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyProperties-physicalDevice-parameter"></a> <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <code>VkPhysicalDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyProperties-pQueueFamilyPropertyCount-parameter"></a> <code>pQueueFamilyPropertyCount</code> <strong class="purple">must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyProperties-pQueueFamilyProperties-parameter"></a> If the value referenced by <code>pQueueFamilyPropertyCount</code> is not <code>0</code>, and <code>pQueueFamilyProperties</code> is not <code>NULL</code>, <code>pQueueFamilyProperties</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pQueueFamilyPropertyCount</code> <code>VkQueueFamilyProperties</code> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueueFamilyProperties</code> structure is defined as:</p>
</div>
<div id="VkQueueFamilyProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkQueueFamilyProperties {
    VkQueueFlags    queueFlags;
    uint32_t        queueCount;
    uint32_t        timestampValidBits;
    VkExtent3D      minImageTransferGranularity;
} VkQueueFamilyProperties;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queueFlags</code> is a bitmask of <a href="#VkQueueFlagBits">VkQueueFlagBits</a> indicating
capabilities of the queues in this queue family.</p>
</li>
<li>
<p><code>queueCount</code> is the unsigned integer count of queues in this queue
family.</p>
</li>
<li>
<p><code>timestampValidBits</code> is the unsigned integer count of meaningful
bits in the timestamps written via <code>vkCmdWriteTimestamp</code>.
The valid range for the count is 36..64 bits, or a value of 0,
indicating no support for timestamps.
Bits outside the valid range are guaranteed to be zeros.</p>
</li>
<li>
<p><code>minImageTransferGranularity</code> is the minimum granularity supported
for image transfer operations on the queues in this queue family.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The value returned in <code>minImageTransferGranularity</code> has a unit of
compressed texel blocks for images having a block-compressed format, and a
unit of texels otherwise.</p>
</div>
<div class="paragraph">
<p>Possible values of <code>minImageTransferGranularity</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq">(0,0,0)</span> which indicates that only whole mip levels <strong class="purple">must</strong> be
transferred using the image transfer operations on the corresponding
queues.
In this case, the following restrictions apply to all offset and extent
parameters of image transfer operations:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>x</code>, <code>y</code>, and <code>z</code> members of a <a href="#VkOffset3D">VkOffset3D</a>
parameter <strong class="purple">must</strong> always be zero.</p>
</li>
<li>
<p>The <code>width</code>, <code>height</code>, and <code>depth</code> members of a
<a href="#VkExtent3D">VkExtent3D</a> parameter <strong class="purple">must</strong> always match the width, height, and
depth of the image subresource corresponding to the parameter,
respectively.</p>
</li>
</ul>
</div>
</li>
<li>
<p><span class="eq">(A<sub>x</sub>, A<sub>y</sub>, A<sub>z</sub>)</span> where <span class="eq">A<sub>x</sub></span>, <span class="eq">A<sub>y</sub></span>, and <span class="eq">A<sub>z</sub></span>
are all integer powers of two.
In this case the following restrictions apply to all image transfer
operations:</p>
<div class="ulist">
<ul>
<li>
<p><code>x</code>, <code>y</code>, and <code>z</code> of a <a href="#VkOffset3D">VkOffset3D</a> parameter <strong class="purple">must</strong> be
integer multiples of <span class="eq">A<sub>x</sub></span>, <span class="eq">A<sub>y</sub></span>, and <span class="eq">A<sub>z</sub></span>,
respectively.</p>
</li>
<li>
<p><code>width</code> of a <a href="#VkExtent3D">VkExtent3D</a> parameter <strong class="purple">must</strong> be an integer
multiple of <span class="eq">A<sub>x</sub></span>, or else <span class="eq"><code>x</code> +  <code>width</code></span> <strong class="purple">must</strong>
equal the width of the image subresource corresponding to the
parameter.</p>
</li>
<li>
<p><code>height</code> of a <a href="#VkExtent3D">VkExtent3D</a> parameter <strong class="purple">must</strong> be an integer
multiple of <span class="eq">A<sub>y</sub></span>, or else <span class="eq"><code>y</code> +  <code>height</code></span> <strong class="purple">must</strong>
equal the height of the image subresource corresponding to the
parameter.</p>
</li>
<li>
<p><code>depth</code> of a <a href="#VkExtent3D">VkExtent3D</a> parameter <strong class="purple">must</strong> be an integer
multiple of <span class="eq">A<sub>z</sub></span>, or else <span class="eq"><code>z</code> +  <code>depth</code></span> <strong class="purple">must</strong>
equal the depth of the image subresource corresponding to the
parameter.</p>
</li>
<li>
<p>If the format of the image corresponding to the parameters is one of
the block-compressed formats then for the purposes of the above
calculations the granularity <strong class="purple">must</strong> be scaled up by the compressed texel
block dimensions.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Queues supporting graphics and/or compute operations <strong class="purple">must</strong> report
<span class="eq">(1,1,1)</span> in <code>minImageTransferGranularity</code>, meaning that there are
no additional restrictions on the granularity of image transfer operations
for these queues.
Other queues supporting image transfer operations are only <strong class="purple">required</strong> to
support whole mip level transfers, thus <code>minImageTransferGranularity</code>
for queues belonging to such queue families <strong class="purple">may</strong> be <span class="eq">(0,0,0)</span>.</p>
</div>
<div class="paragraph">
<p>The <a href="#memory-device">Device Memory</a> section describes memory properties
queried from the physical device.</p>
</div>
<div class="paragraph">
<p>For physical device feature queries see the <a href="#features">Features</a> chapter.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="#VkQueueFamilyProperties">VkQueueFamilyProperties</a>::<code>queueFlags</code>
indicating capabilities of queues in a queue family are:</p>
</div>
<div id="VkQueueFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkQueueFlagBits {
    VK_QUEUE_GRAPHICS_BIT = <span class="hex">0x00000001</span>,
    VK_QUEUE_COMPUTE_BIT = <span class="hex">0x00000002</span>,
    VK_QUEUE_TRANSFER_BIT = <span class="hex">0x00000004</span>,
    VK_QUEUE_SPARSE_BINDING_BIT = <span class="hex">0x00000008</span>,
} VkQueueFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUEUE_GRAPHICS_BIT</code> specifies that queues in this queue family
support graphics operations.</p>
</li>
<li>
<p><code>VK_QUEUE_COMPUTE_BIT</code> specifies that queues in this queue family
support compute operations.</p>
</li>
<li>
<p><code>VK_QUEUE_TRANSFER_BIT</code> specifies that queues in this queue family
support transfer operations.</p>
</li>
<li>
<p><code>VK_QUEUE_SPARSE_BINDING_BIT</code> specifies that queues in this queue
family support sparse memory management operations (see
<a href="#sparsememory">Sparse Resources</a>).
If any of the sparse resource features are enabled, then at least one
queue family <strong class="purple">must</strong> support this bit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If an implementation exposes any queue family that supports graphics
operations, at least one queue family of at least one physical device
exposed by the implementation <strong class="purple">must</strong> support both graphics and compute
operations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>All commands that are allowed on a queue that supports transfer operations
are also allowed on a queue that supports either graphics or compute
operations.
Thus, if the capabilities of a queue family include
<code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code>, then reporting
the <code>VK_QUEUE_TRANSFER_BIT</code> capability separately for that queue family
is <strong class="purple">optional</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For further details see <a href="#devsandqueues-queues">Queues</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueueFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkQueueFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueueFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkQueueFlagBits">VkQueueFlagBits</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="devsandqueues-devices">4.2. Devices</h3>
<div class="paragraph">
<p>Device objects represent logical connections to physical devices.
Each device exposes a number of <em>queue families</em> each having one or more
<em>queues</em>.
All queues in a queue family support the same operations.</p>
</div>
<div class="paragraph">
<p>As described in <a href="#devsandqueues-physical-device-enumeration">Physical
Devices</a>, a Vulkan application will first query for all physical devices in
a system.
Each physical device <strong class="purple">can</strong> then be queried for its capabilities, including
its queue and queue family properties.
Once an acceptable physical device is identified, an application will create
a corresponding logical device.
An application <strong class="purple">must</strong> create a separate logical device for each physical
device it will use.
The created logical device is then the primary interface to the physical
device.</p>
</div>
<div class="paragraph">
<p>How to enumerate the physical devices in a system and query those physical
devices for their queue family properties is described in the
<a href="#devsandqueues-physical-device-enumeration">Physical Device Enumeration</a>
section above.</p>
</div>
<div class="sect3">
<h4 id="devsandqueues-device-creation">4.2.1. Device Creation</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Logical devices are represented by <code>VkDevice</code> handles:</p>
</div>
<div id="VkDevice" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_HANDLE(VkDevice)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A logical device is created as a <em>connection</em> to a physical device.
To create a logical device, call:</p>
</div>
<div id="vkCreateDevice" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateDevice(
    VkPhysicalDevice                            physicalDevice,
    <span class="directive">const</span> VkDeviceCreateInfo*                   pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkDevice*                                   pDevice);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> <strong class="purple">must</strong> be one of the device handles returned from a
call to <code>vkEnumeratePhysicalDevices</code> (see
<a href="#devsandqueues-physical-device-enumeration">Physical Device
Enumeration</a>).</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkDeviceCreateInfo">VkDeviceCreateInfo</a> structure
containing information about how to create the device.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pDevice</code> points to a handle in which the created <a href="#VkDevice">VkDevice</a> is
returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCreateDevice</code> verifies that extensions and features requested in the
<code>ppEnabledExtensionNames</code> and <code>pEnabledFeatures</code> members of
<code>pCreateInfo</code>, respectively, are supported by the implementation.
If any requested extension is not supported, <code>vkCreateDevice</code> <strong class="purple">must</strong>
return <code>VK_ERROR_EXTENSION_NOT_PRESENT</code>.
If any requested feature is not supported, <code>vkCreateDevice</code> <strong class="purple">must</strong> return
<code>VK_ERROR_FEATURE_NOT_PRESENT</code>.
Support for extensions <strong class="purple">can</strong> be checked before creating a device by querying
<a href="#vkEnumerateDeviceExtensionProperties">vkEnumerateDeviceExtensionProperties</a>.
Support for features <strong class="purple">can</strong> similarly be checked by querying
<a href="#vkGetPhysicalDeviceFeatures">vkGetPhysicalDeviceFeatures</a>.</p>
</div>
<div class="paragraph">
<p>After verifying and enabling the extensions the <code>VkDevice</code> object is
created and returned to the application.
If a requested extension is only supported by a layer, both the layer and
the extension need to be specified at <code>vkCreateInstance</code> time for the
creation to succeed.</p>
</div>
<div class="paragraph">
<p>Multiple logical devices <strong class="purple">can</strong> be created from the same physical device.
Logical device creation <strong class="purple">may</strong> fail due to lack of device-specific resources
(in addition to the other errors).
If that occurs, <code>vkCreateDevice</code> will return
<code>VK_ERROR_TOO_MANY_OBJECTS</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateDevice-ppEnabledExtensionNames-01387"></a>
All <a href="#extended-functionality-extensions-dependencies">required
extensions</a> for each extension in the
<a href="#VkDeviceCreateInfo">VkDeviceCreateInfo</a>::<code>ppEnabledExtensionNames</code> list <strong class="purple">must</strong> also
be present in that list.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateDevice-physicalDevice-parameter"></a> <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <code>VkPhysicalDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateDevice-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkDeviceCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateDevice-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateDevice-pDevice-parameter"></a> <code>pDevice</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkDevice</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_EXTENSION_NOT_PRESENT</code></p>
</li>
<li>
<p><code>VK_ERROR_FEATURE_NOT_PRESENT</code></p>
</li>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkDeviceCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkDeviceCreateInfo {
    VkStructureType                    sType;
    <span class="directive">const</span> <span class="directive">void</span>*                        pNext;
    VkDeviceCreateFlags                flags;
    uint32_t                           queueCreateInfoCount;
    <span class="directive">const</span> VkDeviceQueueCreateInfo*     pQueueCreateInfos;
    uint32_t                           enabledLayerCount;
    <span class="directive">const</span> <span class="predefined-type">char</span>* <span class="directive">const</span>*                 ppEnabledLayerNames;
    uint32_t                           enabledExtensionCount;
    <span class="directive">const</span> <span class="predefined-type">char</span>* <span class="directive">const</span>*                 ppEnabledExtensionNames;
    <span class="directive">const</span> VkPhysicalDeviceFeatures*    pEnabledFeatures;
} VkDeviceCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>queueCreateInfoCount</code> is the unsigned integer size of the
<code>pQueueCreateInfos</code> array.
Refer to the <a href="#devsandqueues-queue-creation">Queue Creation</a> section
below for further details.</p>
</li>
<li>
<p><code>pQueueCreateInfos</code> is a pointer to an array of
<a href="#VkDeviceQueueCreateInfo">VkDeviceQueueCreateInfo</a> structures describing the queues that are
requested to be created along with the logical device.
Refer to the <a href="#devsandqueues-queue-creation">Queue Creation</a> section
below for further details.</p>
</li>
<li>
<p><code>enabledLayerCount</code> is deprecated and ignored.</p>
</li>
<li>
<p><code>ppEnabledLayerNames</code> is deprecated and ignored.
See <a href="#extended-functionality-device-layer-deprecation">Device Layer
Deprecation</a>.</p>
</li>
<li>
<p><code>enabledExtensionCount</code> is the number of device extensions to
enable.</p>
</li>
<li>
<p><code>ppEnabledExtensionNames</code> is a pointer to an array of
<code>enabledExtensionCount</code> null-terminated UTF-8 strings containing the
names of extensions to enable for the created device.
See the <a href="#extended-functionality-extensions">Extensions</a> section for
further details.</p>
</li>
<li>
<p><code>pEnabledFeatures</code> is <code>NULL</code> or a pointer to a
<a href="#VkPhysicalDeviceFeatures">VkPhysicalDeviceFeatures</a> structure that contains boolean
indicators of all the features to be enabled.
Refer to the <a href="#features-features">Features</a> section for further details.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceCreateInfo-queueFamilyIndex-00372"></a>
The <code>queueFamilyIndex</code> member of each element of
<code>pQueueCreateInfos</code> <strong class="purple">must</strong> be unique within <code>pQueueCreateInfos</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-pQueueCreateInfos-parameter"></a> <code>pQueueCreateInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>queueCreateInfoCount</code> valid <code>VkDeviceQueueCreateInfo</code> structures</p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-ppEnabledLayerNames-parameter"></a> If <code>enabledLayerCount</code> is not <code>0</code>, <code>ppEnabledLayerNames</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>enabledLayerCount</code> null-terminated UTF-8 strings</p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-ppEnabledExtensionNames-parameter"></a> If <code>enabledExtensionCount</code> is not <code>0</code>, <code>ppEnabledExtensionNames</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>enabledExtensionCount</code> null-terminated UTF-8 strings</p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-pEnabledFeatures-parameter"></a> If <code>pEnabledFeatures</code> is not <code>NULL</code>, <code>pEnabledFeatures</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkPhysicalDeviceFeatures</code> structure</p>
</li>
<li>
<p><a id="VUID-VkDeviceCreateInfo-queueCreateInfoCount-arraylength"></a> <code>queueCreateInfoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkDeviceCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkDeviceCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkDeviceCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-use">4.2.2. Device Use</h4>
<div class="paragraph">
<p>The following is a high-level list of <code>VkDevice</code> uses along with
references on where to find more information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation of queues.
See the <a href="#devsandqueues-queues">Queues</a> section below for further
details.</p>
</li>
<li>
<p>Creation and tracking of various synchronization constructs.
See <a href="#synchronization">Synchronization and Cache Control</a> for further
details.</p>
</li>
<li>
<p>Allocating, freeing, and managing memory.
See <a href="#memory">Memory Allocation</a> and <a href="#resources">Resource Creation</a> for
further details.</p>
</li>
<li>
<p>Creation and destruction of command buffers and command buffer pools.
See <a href="#commandbuffers">Command Buffers</a> for further details.</p>
</li>
<li>
<p>Creation, destruction, and management of graphics state.
See <a href="#pipelines">Pipelines</a> and <a href="#descriptorsets">Resource Descriptors</a>,
among others, for further details.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-lost-device">4.2.3. Lost Device</h4>
<div class="paragraph">
<p>A logical device <strong class="purple">may</strong> become <em>lost</em> for a number of implementation-specific
reasons, indicating that pending and future command execution <strong class="purple">may</strong> fail and
cause resources and backing memory to become undefined.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Typical reasons for device loss will include things like execution timing
out (to prevent denial of service), power management events, platform
resource management, or implementation errors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When this happens, certain commands will return <code>VK_ERROR_DEVICE_LOST</code>
(see <a href="#fundamentals-errorcodes">Error Codes</a> for a list of such commands).
After any such event, the logical device is considered <em>lost</em>.
It is not possible to reset the logical device to a non-lost state, however
the lost state is specific to a logical device (<code>VkDevice</code>), and the
corresponding physical device (<code>VkPhysicalDevice</code>) <strong class="purple">may</strong> be otherwise
unaffected.</p>
</div>
<div class="paragraph">
<p>In some cases, the physical device <strong class="purple">may</strong> also be lost, and attempting to
create a new logical device will fail, returning <code>VK_ERROR_DEVICE_LOST</code>.
This is usually indicative of a problem with the underlying implementation,
or its connection to the host.
If the physical device has not been lost, and a new logical device is
successfully created from that physical device, it <strong class="purple">must</strong> be in the non-lost
state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Whilst logical device loss <strong class="purple">may</strong> be recoverable, in the case of physical
device loss, it is unlikely that an application will be able to recover
unless additional, unaffected physical devices exist on the system.
The error is largely informational and intended only to inform the user that
a platform issue has occurred, and <strong class="purple">should</strong> be investigated further.
For example, underlying hardware <strong class="purple">may</strong> have developed a fault or become
physically disconnected from the rest of the system.
In many cases, physical device loss <strong class="purple">may</strong> cause other more serious issues
such as the operating system crashing; in which case it <strong class="purple">may</strong> not be reported
via the Vulkan API.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Undefined behavior caused by an application error <strong class="purple">may</strong> cause a device to
become lost.
However, such undefined behavior <strong class="purple">may</strong> also cause unrecoverable damage to the
process, and it is then not guaranteed that the API objects, including the
<code>VkPhysicalDevice</code> or the <code>VkInstance</code> are still valid or that the
error is recoverable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a device is lost, its child objects are not implicitly destroyed and
their handles are still valid.
Those objects <strong class="purple">must</strong> still be destroyed before their parents or the device
<strong class="purple">can</strong> be destroyed (see the <a href="#fundamentals-objectmodel-lifetime">Object
Lifetime</a> section).
The host address space corresponding to device memory mapped using
<a href="#vkMapMemory">vkMapMemory</a> is still valid, and host memory accesses to these mapped
regions are still valid, but the contents are undefined.
It is still legal to call any API command on the device and child objects.</p>
</div>
<div class="paragraph">
<p>Once a device is lost, command execution <strong class="purple">may</strong> fail, and commands that return
a <a href="#VkResult">VkResult</a> <strong class="purple">may</strong> return <code>VK_ERROR_DEVICE_LOST</code>.
Commands that do not allow run-time errors <strong class="purple">must</strong> still operate correctly for
valid usage and, if applicable, return valid data.</p>
</div>
<div class="paragraph">
<p>Commands that wait indefinitely for device execution (namely
<a href="#vkDeviceWaitIdle">vkDeviceWaitIdle</a>, <a href="#vkQueueWaitIdle">vkQueueWaitIdle</a>, <a href="#vkWaitForFences">vkWaitForFences</a>
with a maximum <code>timeout</code>, and <a href="#vkGetQueryPoolResults">vkGetQueryPoolResults</a> with the
<code>VK_QUERY_RESULT_WAIT_BIT</code> bit set in <code>flags</code>) <strong class="purple">must</strong> return in
finite time even in the case of a lost device, and return either
<code>VK_SUCCESS</code> or <code>VK_ERROR_DEVICE_LOST</code>.
For any command that <strong class="purple">may</strong> return <code>VK_ERROR_DEVICE_LOST</code>, for the purpose
of determining whether a command buffer is in the
<a href="#commandbuffers-lifecycle">pending state</a>, or whether resources are
considered in-use by the device, a return value of
<code>VK_ERROR_DEVICE_LOST</code> is equivalent to <code>VK_SUCCESS</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-destruction">4.2.4. Device Destruction</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a device, call:</p>
</div>
<div id="vkDestroyDevice" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyDevice(
    VkDevice                                    device,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To ensure that no work is active on the device, <a href="#vkDeviceWaitIdle">vkDeviceWaitIdle</a> <strong class="purple">can</strong>
be used to gate the destruction of the device.
Prior to destroying a device, an application is responsible for
destroying/freeing any Vulkan objects that were created using that device as
the first parameter of the corresponding <code>vkCreate*</code> or
<code>vkAllocate*</code> command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The lifetime of each of these objects is bound by the lifetime of the
<code>VkDevice</code> object.
Therefore, to avoid resource leaks, it is critical that an application
explicitly free all of these resources prior to calling
<code>vkDestroyDevice</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyDevice-device-00378"></a>
All child objects created on <code>device</code> <strong class="purple">must</strong> have been destroyed
prior to destroying <code>device</code></p>
</li>
<li>
<p><a id="VUID-vkDestroyDevice-device-00379"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>device</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyDevice-device-00380"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>device</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyDevice-device-parameter"></a> If <code>device</code> is not <code>NULL</code>, <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyDevice-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>device</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="devsandqueues-queues">4.3. Queues</h3>
<div class="sect3">
<h4 id="devsandqueues-queueprops">4.3.1. Queue Family Properties</h4>
<div class="paragraph">
<p>As discussed in the <a href="#devsandqueues-physical-device-enumeration">Physical
Device Enumeration</a> section above, the
<a href="#vkGetPhysicalDeviceQueueFamilyProperties">vkGetPhysicalDeviceQueueFamilyProperties</a> command is used to retrieve
details about the queue families and queues supported by a device.</p>
</div>
<div class="paragraph">
<p>Each index in the <code>pQueueFamilyProperties</code> array returned by
<a href="#vkGetPhysicalDeviceQueueFamilyProperties">vkGetPhysicalDeviceQueueFamilyProperties</a> describes a unique queue
family on that physical device.
These indices are used when creating queues, and they correspond directly
with the <code>queueFamilyIndex</code> that is passed to the <a href="#vkCreateDevice">vkCreateDevice</a>
command via the <a href="#VkDeviceQueueCreateInfo">VkDeviceQueueCreateInfo</a> structure as described in the
<a href="#devsandqueues-queue-creation">Queue Creation</a> section below.</p>
</div>
<div class="paragraph">
<p>Grouping of queue families within a physical device is
implementation-dependent.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The general expectation is that a physical device groups all queues of
matching capabilities into a single family.
However, while implementations <strong class="purple">should</strong> do this, it is possible that a
physical device <strong class="purple">may</strong> return two separate queue families with the same
capabilities.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once an application has identified a physical device with the queue(s) that
it desires to use, it will create those queues in conjunction with a logical
device.
This is described in the following section.</p>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-queue-creation">4.3.2. Queue Creation</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creating a logical device also creates the queues associated with that
device.
The queues to create are described by a set of <a href="#VkDeviceQueueCreateInfo">VkDeviceQueueCreateInfo</a>
structures that are passed to <a href="#vkCreateDevice">vkCreateDevice</a> in
<code>pQueueCreateInfos</code>.</p>
</div>
<div class="paragraph">
<p>Queues are represented by <code>VkQueue</code> handles:</p>
</div>
<div id="VkQueue" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_HANDLE(VkQueue)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceQueueCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkDeviceQueueCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkDeviceQueueCreateInfo {
    VkStructureType             sType;
    <span class="directive">const</span> <span class="directive">void</span>*                 pNext;
    VkDeviceQueueCreateFlags    flags;
    uint32_t                    queueFamilyIndex;
    uint32_t                    queueCount;
    <span class="directive">const</span> <span class="predefined-type">float</span>*                pQueuePriorities;
} VkDeviceQueueCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is an unsigned integer indicating the index of
the queue family to create on this device.
This index corresponds to the index of an element of the
<code>pQueueFamilyProperties</code> array that was returned by
<code>vkGetPhysicalDeviceQueueFamilyProperties</code>.</p>
</li>
<li>
<p><code>queueCount</code> is an unsigned integer specifying the number of queues
to create in the queue family indicated by <code>queueFamilyIndex</code>.</p>
</li>
<li>
<p><code>pQueuePriorities</code> is an array of <code>queueCount</code> normalized
floating point values, specifying priorities of work that will be
submitted to each created queue.
See <a href="#devsandqueues-priority">Queue Priority</a> for more information.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-queueFamilyIndex-00381"></a>
<code>queueFamilyIndex</code> <strong class="purple">must</strong> be less than
<code>pQueueFamilyPropertyCount</code> returned by
<code>vkGetPhysicalDeviceQueueFamilyProperties</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-queueCount-00382"></a>
<code>queueCount</code> <strong class="purple">must</strong> be less than or equal to the <code>queueCount</code>
member of the <code>VkQueueFamilyProperties</code> structure, as returned by
<code>vkGetPhysicalDeviceQueueFamilyProperties</code> in the
<code>pQueueFamilyProperties</code>[<code>queueFamilyIndex</code>]</p>
</li>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-pQueuePriorities-00383"></a>
Each element of <code>pQueuePriorities</code> <strong class="purple">must</strong> be between <code>0.0</code> and <code>1.0</code>
inclusive</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkDeviceQueueCreateFlagBits">VkDeviceQueueCreateFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-pQueuePriorities-parameter"></a> <code>pQueuePriorities</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>queueCount</code> <code>float</code> values</p>
</li>
<li>
<p><a id="VUID-VkDeviceQueueCreateInfo-queueCount-arraylength"></a> <code>queueCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkDeviceQueueCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkDeviceQueueCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkDeviceQueueCreateFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkDeviceQueueCreateFlagBits">VkDeviceQueueCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve a handle to a <a href="#VkQueue">VkQueue</a> object, call:</p>
</div>
<div id="vkGetDeviceQueue" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetDeviceQueue(
    VkDevice                                    device,
    uint32_t                                    queueFamilyIndex,
    uint32_t                                    queueIndex,
    VkQueue*                                    pQueue);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the queue.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is the index of the queue family to which the
queue belongs.</p>
</li>
<li>
<p><code>queueIndex</code> is the index within this queue family of the queue to
retrieve.</p>
</li>
<li>
<p><code>pQueue</code> is a pointer to a <a href="#VkQueue">VkQueue</a> object that will be filled
with the handle for the requested queue.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceQueue-queueFamilyIndex-00384"></a>
<code>queueFamilyIndex</code> <strong class="purple">must</strong> be one of the queue family indices
specified when <code>device</code> was created, via the
<code>VkDeviceQueueCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceQueue-queueIndex-00385"></a>
<code>queueIndex</code> <strong class="purple">must</strong> be less than the number of queues created for the
specified queue family index when <code>device</code> was created, via the
<code>queueCount</code> member of the <code>VkDeviceQueueCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceQueue-flags-01841"></a>
<a href="#VkDeviceQueueCreateInfo">VkDeviceQueueCreateInfo</a>::<code>flags</code> <strong class="purple">must</strong> have been set to zero
when <code>device</code> was created</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceQueue-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceQueue-pQueue-parameter"></a> <code>pQueue</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkQueue</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-index">4.3.3. Queue Family Index</h4>
<div class="paragraph">
<p>The queue family index is used in multiple places in Vulkan in order to tie
operations to a specific family of queues.</p>
</div>
<div class="paragraph">
<p>When retrieving a handle to the queue via <code>vkGetDeviceQueue</code>, the queue
family index is used to select which queue family to retrieve the
<code>VkQueue</code> handle from as described in the previous section.</p>
</div>
<div class="paragraph">
<p>When creating a <code>VkCommandPool</code> object (see
<a href="#commandbuffers-pools">Command Pools</a>), a queue family index is specified
in the <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a> structure.
Command buffers from this pool <strong class="purple">can</strong> only be submitted on queues
corresponding to this queue family.</p>
</div>
<div class="paragraph">
<p>When creating <code>VkImage</code> (see <a href="#resources-images">Images</a>) and
<code>VkBuffer</code> (see <a href="#resources-buffers">Buffers</a>) resources, a set of queue
families is included in the <a href="#VkImageCreateInfo">VkImageCreateInfo</a> and
<a href="#VkBufferCreateInfo">VkBufferCreateInfo</a> structures to specify the queue families that <strong class="purple">can</strong>
access the resource.</p>
</div>
<div class="paragraph">
<p>When inserting a <a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> or <a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a>
(see <a href="#synchronization-events">Events</a>) a source and destination queue family index
is specified to allow the ownership of a buffer or image to be transferred
from one queue family to another.
See the <a href="#resources-sharing">Resource Sharing</a> section for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-priority">4.3.4. Queue Priority</h4>
<div class="paragraph">
<p>Each queue is assigned a priority, as set in the
<a href="#VkDeviceQueueCreateInfo">VkDeviceQueueCreateInfo</a> structures when creating the device.
The priority of each queue is a normalized floating point value between 0.0
and 1.0, which is then translated to a discrete priority level by the
implementation.
Higher values indicate a higher priority, with 0.0 being the lowest priority
and 1.0 being the highest.</p>
</div>
<div class="paragraph">
<p>Within the same device, queues with higher priority <strong class="purple">may</strong> be allotted more
processing time than queues with lower priority.
The implementation makes no guarantees with regards to ordering or
scheduling among queues with the same priority, other than the constraints
defined by any <a href="#synchronization">explicit synchronization primitives</a>.
The implementation make no guarantees with regards to queues across
different devices.</p>
</div>
<div class="paragraph">
<p>An implementation <strong class="purple">may</strong> allow a higher-priority queue to starve a
lower-priority queue on the same <code>VkDevice</code> until the higher-priority
queue has no further commands to execute.
The relationship of queue priorities <strong class="purple">must</strong> not cause queues on one
<code>VkDevice</code> to starve queues on another <code>VkDevice</code>.</p>
</div>
<div class="paragraph">
<p>No specific guarantees are made about higher priority queues receiving more
processing time or better quality of service than lower priority queues.</p>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-submission">4.3.5. Queue Submission</h4>
<div class="paragraph">
<p>Work is submitted to a queue via <em>queue submission</em> commands such as
<a href="#vkQueueSubmit">vkQueueSubmit</a>.
Queue submission commands define a set of <em>queue operations</em> to be executed
by the underlying physical device, including synchronization with semaphores
and fences.</p>
</div>
<div class="paragraph">
<p>Submission commands take as parameters a target queue, zero or more
<em>batches</em> of work, and an <strong class="purple">optional</strong> fence to signal upon completion.
Each batch consists of three distinct parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Zero or more semaphores to wait on before execution of the rest of the
batch.</p>
<div class="ulist">
<ul>
<li>
<p>If present, these describe a <a href="#synchronization-semaphores-waiting">semaphore wait operation</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Zero or more work items to execute.</p>
<div class="ulist">
<ul>
<li>
<p>If present, these describe a <em>queue operation</em> matching the work
described.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Zero or more semaphores to signal upon completion of the work items.</p>
<div class="ulist">
<ul>
<li>
<p>If present, these describe a <a href="#synchronization-semaphores-signaling">semaphore signal operation</a>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a fence is present in a queue submission, it describes a
<a href="#synchronization-fences-signaling">fence signal operation</a>.</p>
</div>
<div class="paragraph">
<p>All work described by a queue submission command <strong class="purple">must</strong> be submitted to the
queue before the command returns.</p>
</div>
<div class="sect4">
<h5 id="devsandqueues-sparsebinding">Sparse Memory Binding</h5>
<div class="paragraph">
<p>In Vulkan it is possible to sparsely bind memory to buffers and images as
described in the <a href="#sparsememory">Sparse Resource</a> chapter.
Sparse memory binding is a queue operation.
A queue whose flags include the <code>VK_QUEUE_SPARSE_BINDING_BIT</code> <strong class="purple">must</strong> be
able to support the mapping of a virtual address to a physical address on
the device.
This causes an update to the page table mappings on the device.
This update <strong class="purple">must</strong> be synchronized on a queue to avoid corrupting page table
mappings during execution of graphics commands.
By binding the sparse memory resources on queues, all commands that are
dependent on the updated bindings are synchronized to only execute after the
binding is updated.
See the <a href="#synchronization">Synchronization and Cache Control</a> chapter for
how this synchronization is accomplished.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devsandqueues-queuedestruction">4.3.6. Queue Destruction</h4>
<div class="paragraph">
<p>Queues are created along with a logical device during <code>vkCreateDevice</code>.
All queues associated with a logical device are destroyed when
<code>vkDestroyDevice</code> is called on that device.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commandbuffers">5. Command Buffers</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Command buffers are objects used to record commands which <strong class="purple">can</strong> be
subsequently submitted to a device queue for execution.
There are two levels of command buffers - <em>primary command buffers</em>, which
<strong class="purple">can</strong> execute secondary command buffers, and which are submitted to queues,
and <em>secondary command buffers</em>, which <strong class="purple">can</strong> be executed by primary command
buffers, and which are not directly submitted to queues.</p>
</div>
<div class="paragraph">
<p>Command buffers are represented by <code>VkCommandBuffer</code> handles:</p>
</div>
<div id="VkCommandBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_HANDLE(VkCommandBuffer)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Recorded commands include commands to bind pipelines and descriptor sets to
the command buffer, commands to modify dynamic state, commands to draw (for
graphics rendering), commands to dispatch (for compute), commands to execute
secondary command buffers (for primary command buffers only), commands to
copy buffers and images, and other commands.</p>
</div>
<div id="commandbuffers-statereset" class="paragraph">
<p>Each command buffer manages state independently of other command buffers.
There is no inheritance of state across primary and secondary command
buffers, or between secondary command buffers.
When a command buffer begins recording, all state in that command buffer is
undefined.
When secondary command buffer(s) are recorded to execute on a primary
command buffer, the secondary command buffer inherits no state from the
primary command buffer, and all state of the primary command buffer is
undefined after an execute secondary command buffer command is recorded.
There is one exception to this rule - if the primary command buffer is
inside a render pass instance, then the render pass and subpass state is not
disturbed by executing secondary command buffers.
Whenever the state of a command buffer is undefined, the application <strong class="purple">must</strong>
set all relevant state on the command buffer before any state dependent
commands such as draws and dispatches are recorded, otherwise the behavior
of executing that command buffer is undefined.</p>
</div>
<div class="paragraph">
<p>Unless otherwise specified, and without explicit synchronization, the
various commands submitted to a queue via command buffers <strong class="purple">may</strong> execute in
arbitrary order relative to each other, and/or concurrently.
Also, the memory side-effects of those commands <strong class="purple">may</strong> not be directly visible
to other commands without explicit memory dependencies.
This is true within a command buffer, and across command buffers submitted
to a given queue.
See <a href="#synchronization">the synchronization chapter</a> for information on
<a href="#synchronization-implicit">implicit</a> and explicit synchronization between
commands.</p>
</div>
<div class="sect2">
<h3 id="commandbuffers-lifecycle">5.1. Command Buffer Lifecycle</h3>
<div class="paragraph">
<p>Each command buffer is always in one of the following states:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Initial</dt>
<dd>
<p>When a command buffer is <a href="#vkAllocateCommandBuffers">allocated</a>, it is
in the <em>initial state</em>.
Some commands are able to <em>reset</em> a command buffer, or a set of command
buffers, back to this state from any of the executable, recording or
invalid state.
Command buffers in the initial state <strong class="purple">can</strong> only be moved to the recording
state, or freed.</p>
</dd>
<dt class="hdlist1">Recording</dt>
<dd>
<p><a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> changes the state of a command buffer from
the initial state to the <em>recording state</em>.
Once a command buffer is in the recording state, <code>vkCmd*</code> commands
<strong class="purple">can</strong> be used to record to the command buffer.</p>
</dd>
<dt class="hdlist1">Executable</dt>
<dd>
<p><a href="#vkEndCommandBuffer">vkEndCommandBuffer</a> ends the recording of a command buffer, and
moves it from the recording state to the <em>executable state</em>.
Executable command buffers <strong class="purple">can</strong> be <a href="#commandbuffers-submission">submitted</a>, reset, or <a href="#commandbuffers-secondary">recorded to another
command buffer</a>.</p>
</dd>
<dt class="hdlist1">Pending</dt>
<dd>
<p><a href="#commandbuffers-submission">Queue submission</a> of a command buffer
changes the state of a command buffer from the executable state to the
<em>pending state</em>.
Whilst in the pending state, applications <strong class="purple">must</strong> not attempt to modify
the command buffer in any way - as the device <strong class="purple">may</strong> be processing the
commands recorded to it.
Once execution of a command buffer completes, the command buffer reverts
back to either the <em>executable state</em>, or the <em>invalid state</em> if it was
recorded with <code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code>.
A <a href="#synchronization">synchronization</a> command <strong class="purple">should</strong> be used to detect
when this occurs.</p>
</dd>
<dt class="hdlist1">Invalid</dt>
<dd>
<p>Some operations, such as <a href="#fundamentals-objectmodel-lifetime-cmdbuffers">modifying or deleting a resource</a> that was used in a command recorded
to a command buffer, will transition the state of that command buffer
into the <em>invalid state</em>.
Command buffers in the invalid state <strong class="purple">can</strong> only be reset or freed.</p>
</dd>
</dl>
</div>
<div id="commandbuffer-lifecycle-diagram" class="imageblock" style="text-align: center">
<div class="content">
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="224.63503mm"
   height="92.592918mm"
   viewBox="0 0 224.63503 92.592918"
   version="1.1"
   id="svg8"
   sodipodi:docname="commandbuffer_lifecycle.svg"
   inkscape:version="0.92.2 (5c3e80d, 2017-08-06)">
  <defs
     id="defs2">
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker5741"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path5739"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker5653"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path5651"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker5571"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path5569"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker3457"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path3455"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker3373"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path3371"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mstart"
       orient="auto"
       refY="0"
       refX="0"
       id="marker1404"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path1402"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(0.4,0,0,0.4,4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mstart"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Mstart"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path968"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(0.4,0,0,0.4,4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker1320"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path1318"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker1274"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path1272"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker1246"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path1244"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Mend"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path971"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker1274-3"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         inkscape:connector-curvature="0"
         id="path1272-3"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)" />
    </marker>
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="2"
     inkscape:cx="274.30175"
     inkscape:cy="131.46613"
     inkscape:document-units="mm"
     inkscape:current-layer="layer1"
     showgrid="true"
     inkscape:snap-text-baseline="true"
     inkscape:snap-object-midpoints="true"
     inkscape:measure-start="245,915"
     inkscape:measure-end="570,915"
     showguides="false"
     fit-margin-left="1"
     fit-margin-top="1"
     fit-margin-right="1"
     fit-margin-bottom="1"
     inkscape:window-width="1680"
     inkscape:window-height="987"
     inkscape:window-x="1672"
     inkscape:window-y="-8"
     inkscape:window-maximized="1">
    <inkscape:grid
       type="xygrid"
       id="grid907"
       originx="3.8383438"
       originy="-212.72305" />
  </sodipodi:namedview>
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(3.8383438,8.3159637)">
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.38502529;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-68-2-5"
       width="63.499996"
       height="7.9375005"
       x="76.729164"
       y="7.8066287" />
    <text
       id="text823-4-2-9-4-7-9-2"
       y="13.361835"
       x="108.38303"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-4"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496"
         y="13.361835"
         x="108.38303"
         sodipodi:role="line">Initial</tspan></text>
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.38502529;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-68-2-5-2"
       width="63.499996"
       height="7.9375005"
       x="156.10417"
       y="37.57225" />
    <text
       id="text823-4-2-9-4-7-9-2-0"
       y="43.12746"
       x="187.75806"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-4-2"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496"
         y="43.12746"
         x="187.75806"
         sodipodi:role="line">Recording</tspan></text>
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.38502529;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-68-2-5-7"
       width="63.499996"
       height="7.9375005"
       x="23.151045"
       y="73.291" />
    <text
       id="text823-4-2-9-4-7-9-2-7"
       y="78.846207"
       x="54.804928"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-4-0"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496"
         y="78.846207"
         x="54.804928"
         sodipodi:role="line">Pending</tspan></text>
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.38502529;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-68-2-5-1"
       width="63.499996"
       height="7.9375005"
       x="130.3073"
       y="73.291" />
    <text
       id="text823-4-2-9-4-7-9-2-9"
       y="78.846207"
       x="161.96117"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-4-9"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496"
         y="78.846207"
         x="161.96117"
         sodipodi:role="line">Executable</tspan></text>
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.38502529;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-68-2-5-9"
       width="63.499996"
       height="7.9375005"
       x="-2.6458311"
       y="37.57225" />
    <text
       id="text823-4-2-9-4-7-9-2-6"
       y="43.12746"
       x="29.008045"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-4-93"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496"
         y="43.12746"
         x="29.008045"
         sodipodi:role="line">Invalid</tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="108.47915"
       y="-4.0996227"
       id="text905"><tspan
         sodipodi:role="line"
         id="tspan903"
         x="108.47915"
         y="-4.0996227"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496">Allocate</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39749998;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Mend)"
       d="m 140.22916,11.775377 c 17.40186,4.563534 31.44429,11.931433 37.70313,25.796877"
       id="path911"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687497;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.58749987,1.58749987;stroke-dashoffset:0;stroke-opacity:1;marker-start:url(#marker1404)"
       d="M 76.72917,11.775375 C 59.32731,16.338909 45.28488,23.706809 39.02604,37.572252"
       id="path911-9"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687496px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1246)"
       d="m 177.93228,45.509753 c -2.5839,12.275404 -13.84985,21.278544 -31.74999,27.781249"
       id="path928"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687497;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.58749987,1.58749987;stroke-dashoffset:0;stroke-opacity:1;marker-start:url(#Arrow1Mstart)"
       d="m 39.02604,45.509753 c 2.5839,12.275404 13.849846,21.278544 31.749991,27.781249"
       id="path928-9"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.42705935px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1274)"
       d="m 130.30729,77.259753 c -14.77333,2.532909 -29.48724,2.761692 -43.65625,0"
       id="path945"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.42705935px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker1274-3)"
       d="m 86.651035,75.275378 c 14.773335,-2.532915 29.487245,-2.761695 43.656255,0"
       id="path945-6"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687497;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.58749987,1.58749987;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#marker1320)"
       d="m 156.10417,39.556628 c -33.57471,-4.289783 -37.71018,-13.456659 -47.625,-23.8125"
       id="path3349"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687497;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.58749987,1.58749987;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#marker3373)"
       d="M 144.19792,73.291002 C 129.70275,39.163626 116.89927,24.895373 108.47917,15.744128"
       id="path3363"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687496px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker3457)"
       d="M 108.47917,-2.1152472 V 7.8066273"
       id="path3447"
       inkscape:connector-curvature="0" />
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="164.04166"
       y="19.712879"
       id="text905-5"><tspan
         sodipodi:role="line"
         id="tspan903-4"
         x="164.04166"
         y="19.712879"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.39687496">Begin</tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="171.97917"
       y="63.369129"
       id="text905-5-4"><tspan
         sodipodi:role="line"
         id="tspan903-4-1"
         x="171.97917"
         y="63.369129"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.39687496">End</tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="108.47915"
       y="83.212875"
       id="text905-5-4-3"><tspan
         sodipodi:role="line"
         id="tspan903-4-1-1"
         x="108.47915"
         y="83.212875"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496">Submission</tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="107.73502"
       y="71.306633"
       id="text905-5-4-3-1"><tspan
         sodipodi:role="line"
         id="tspan903-4-1-1-9"
         x="108.47916"
         y="71.306633"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496">Completion </tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:end;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496;stroke-miterlimit:4;stroke-dasharray:none"
       x="44.979168"
       y="61.38475"
       id="text4726"><tspan
         sodipodi:role="line"
         x="44.979168"
         y="61.38475"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:end;writing-mode:lr-tb;text-anchor:end;stroke-width:0.39687496;stroke-miterlimit:4;stroke-dasharray:none"
         id="tspan4732">Completion with</tspan><tspan
         sodipodi:role="line"
         x="44.979168"
         y="66.676414"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:end;writing-mode:lr-tb;text-anchor:end;stroke-width:0.39687496;stroke-miterlimit:4;stroke-dasharray:none"
         id="tspan11757">One Time Submit</tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:end;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="52.916664"
       y="19.712879"
       id="text905-6"><tspan
         sodipodi:role="line"
         x="52.916664"
         y="19.712879"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:end;writing-mode:lr-tb;text-anchor:end;stroke-width:0.39687496"
         id="tspan3709">Reset</tspan></text>
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="116.41668"
       y="21.697252"
       id="text905-6-3"><tspan
         sodipodi:role="line"
         x="116.41668"
         y="21.697252"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.39687496"
         id="tspan3709-2">Reset</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:0.396875;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.5875,1.5875;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#marker5571)"
       d="M 156.10416,41.541003 H 60.854164"
       id="path5557"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687499;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.5875, 1.5875;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#marker5741)"
       d="M 140.22916,73.291002 C 126.33855,47.494128 119.0625,41.677088 60.854164,41.541003"
       id="path5559"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:0.39687499;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:1.5875, 1.5875;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#marker5653)"
       d="M 106.49479,15.744128 C 99.21875,45.645838 88.635415,41.541003 60.854164,41.541003"
       id="path5561"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.39687496"
       x="74.744797"
       y="47.494129"
       id="text905-6-3-4"><tspan
         sodipodi:role="line"
         x="74.744797"
         y="47.494129"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:4.23333311px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:0.39687496"
         id="tspan3709-2-2">Invalidate</tspan></text>
  </g>
</svg>
</div>
<div class="title">Figure 1. Lifecycle of a command buffer</div>
</div>
<div class="paragraph">
<p>Any given command that operates on a command buffer has its own requirements
on what state a command buffer <strong class="purple">must</strong> be in, which are detailed in the valid
usage constraints for that command.</p>
</div>
<div class="paragraph">
<p>Resetting a command buffer is an operation that discards any previously
recorded commands and puts a command buffer in the initial state.
Resetting occurs as a result of <a href="#vkResetCommandBuffer">vkResetCommandBuffer</a> or
<a href="#vkResetCommandPool">vkResetCommandPool</a>, or as part of <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> (which
additionally puts the command buffer in the recording state).</p>
</div>
<div class="paragraph">
<p><a href="#commandbuffers-secondary">Secondary command buffers</a> <strong class="purple">can</strong> be recorded to
a primary command buffer via <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a>.
This partially ties the lifecycle of the two command buffers together - if
the primary is submitted to a queue, both the primary and any secondaries
recorded to it move to the pending state.
Once execution of the primary completes, so does any secondary recorded
within it, and once all executions of each command buffer complete, they
move to the executable state.
If a secondary moves to any other state whilst it is recorded to another
command buffer, the primary moves to the invalid state.
A primary moving to any other state does not affect the state of the
secondary.
Resetting or freeing a primary command buffer removes the linkage to any
secondary command buffers that were recorded to it.</p>
</div>
</div>
<div class="sect2">
<h3 id="commandbuffers-pools">5.2. Command Pools</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Command pools are opaque objects that command buffer memory is allocated
from, and which allow the implementation to amortize the cost of resource
creation across multiple command buffers.
Command pools are externally synchronized, meaning that a command pool <strong class="purple">must</strong>
not be used concurrently in multiple threads.
That includes use via recording commands on any command buffers allocated
from the pool, as well as operations that allocate, free, and reset command
buffers or the pool itself.</p>
</div>
<div class="paragraph">
<p>Command pools are represented by <code>VkCommandPool</code> handles:</p>
</div>
<div id="VkCommandPool" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkCommandPool)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a command pool, call:</p>
</div>
<div id="vkCreateCommandPool" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateCommandPool(
    VkDevice                                    device,
    <span class="directive">const</span> VkCommandPoolCreateInfo*              pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkCommandPool*                              pCommandPool);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the command pool.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a> structure specifying the state of the
command pool object.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pCommandPool</code> points to a <a href="#VkCommandPool">VkCommandPool</a> handle in which the
created pool is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateCommandPool-queueFamilyIndex-01937"></a>
<code>pCreateInfo</code>::<code>queueFamilyIndex</code> <strong class="purple">must</strong> be the index of a queue
family available in the logical device <code>device</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateCommandPool-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateCommandPool-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkCommandPoolCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateCommandPool-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateCommandPool-pCommandPool-parameter"></a> <code>pCommandPool</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkCommandPool</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandPoolCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandPoolCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkCommandPoolCreateInfo {
    VkStructureType             sType;
    <span class="directive">const</span> <span class="directive">void</span>*                 pNext;
    VkCommandPoolCreateFlags    flags;
    uint32_t                    queueFamilyIndex;
} VkCommandPoolCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandPoolCreateFlagBits">VkCommandPoolCreateFlagBits</a> indicating
usage behavior for the pool and command buffers allocated from it.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> designates a queue family as described in section
<a href="#devsandqueues-queueprops">Queue Family Properties</a>.
All command buffers allocated from this command pool <strong class="purple">must</strong> be submitted
on queues from the same queue family.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_POOL_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCommandPoolCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkCommandPoolCreateFlagBits">VkCommandPoolCreateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>::<code>flags</code> to
specify usage behavior for a command pool are:</p>
</div>
<div id="VkCommandPoolCreateFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkCommandPoolCreateFlagBits {
    VK_COMMAND_POOL_CREATE_TRANSIENT_BIT = <span class="hex">0x00000001</span>,
    VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT = <span class="hex">0x00000002</span>,
} VkCommandPoolCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_POOL_CREATE_TRANSIENT_BIT</code> specifies that command
buffers allocated from the pool will be short-lived, meaning that they
will be reset or freed in a relatively short timeframe.
This flag <strong class="purple">may</strong> be used by the implementation to control memory
allocation behavior within the pool.</p>
</li>
<li>
<p><code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code> allows any command
buffer allocated from a pool to be individually reset to the
<a href="#commandbuffers-lifecycle">initial state</a>; either by calling
<a href="#vkResetCommandBuffer">vkResetCommandBuffer</a>, or via the implicit reset when calling
<a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a>.
If this flag is not set on a pool, then <code>vkResetCommandBuffer</code> <strong class="purple">must</strong>
not be called for any command buffer allocated from that pool.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandPoolCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkCommandPoolCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandPoolCreateFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandPoolCreateFlagBits">VkCommandPoolCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a command pool, call:</p>
</div>
<div id="vkResetCommandPool" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkResetCommandPool(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    VkCommandPoolResetFlags                     flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool to reset.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandPoolResetFlagBits">VkCommandPoolResetFlagBits</a> controlling
the reset operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Resetting a command pool recycles all of the resources from all of the
command buffers allocated from the command pool back to the command pool.
All command buffers that have been allocated from the command pool are put
in the <a href="#commandbuffers-lifecycle">initial state</a>.</p>
</div>
<div class="paragraph">
<p>Any primary command buffer allocated from another <a href="#VkCommandPool">VkCommandPool</a> that
is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and
has a secondary command buffer allocated from <code>commandPool</code> recorded
into it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandPool-commandPool-00040"></a>
All <code>VkCommandBuffer</code> objects allocated from <code>commandPool</code> <strong class="purple">must</strong>
not be in the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandPool-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkResetCommandPool-commandPool-parameter"></a> <code>commandPool</code> <strong class="purple">must</strong> be a valid <code>VkCommandPool</code> handle</p>
</li>
<li>
<p><a id="VUID-vkResetCommandPool-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkCommandPoolResetFlagBits">VkCommandPoolResetFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkResetCommandPool-commandPool-parent"></a> <code>commandPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#vkResetCommandPool">vkResetCommandPool</a>::<code>flags</code> to control
the reset operation are:</p>
</div>
<div id="VkCommandPoolResetFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkCommandPoolResetFlagBits {
    VK_COMMAND_POOL_RESET_RELEASE_RESOURCES_BIT = <span class="hex">0x00000001</span>,
} VkCommandPoolResetFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_POOL_RESET_RELEASE_RESOURCES_BIT</code> specifies that
resetting a command pool recycles all of the resources from the command
pool back to the system.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandPoolResetFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkCommandPoolResetFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandPoolResetFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandPoolResetFlagBits">VkCommandPoolResetFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a command pool, call:</p>
</div>
<div id="vkDestroyCommandPool" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyCommandPool(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the handle of the command pool to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a pool is destroyed, all command buffers allocated from the pool are
<a href="#vkFreeCommandBuffers">freed</a>.</p>
</div>
<div class="paragraph">
<p>Any primary command buffer allocated from another <a href="#VkCommandPool">VkCommandPool</a> that
is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and
has a secondary command buffer allocated from <code>commandPool</code> recorded
into it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-00041"></a>
All <code>VkCommandBuffer</code> objects allocated from <code>commandPool</code> <strong class="purple">must</strong>
not be in the <a href="#commandbuffers-lifecycle">pending state</a>.</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-00042"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>commandPool</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-00043"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>commandPool</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyCommandPool-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-parameter"></a> If <code>commandPool</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>commandPool</code> <strong class="purple">must</strong> be a valid <code>VkCommandPool</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyCommandPool-commandPool-parent"></a> If <code>commandPool</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="commandbuffer-allocation">5.3. Command Buffer Allocation and Management</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To allocate command buffers, call:</p>
</div>
<div id="vkAllocateCommandBuffers" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkAllocateCommandBuffers(
    VkDevice                                    device,
    <span class="directive">const</span> VkCommandBufferAllocateInfo*          pAllocateInfo,
    VkCommandBuffer*                            pCommandBuffers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>pAllocateInfo</code> is a pointer to an instance of the
<code>VkCommandBufferAllocateInfo</code> structure describing parameters of the
allocation.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is a pointer to an array of <a href="#VkCommandBuffer">VkCommandBuffer</a>
handles in which the resulting command buffer objects are returned.
The array <strong class="purple">must</strong> be at least the length specified by the
<code>commandBufferCount</code> member of <code>pAllocateInfo</code>.
Each allocated command buffer begins in the initial state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When command buffers are first allocated, they are in the
<a href="#commandbuffers-lifecycle">initial state</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-pAllocateInfo-parameter"></a> <code>pAllocateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkCommandBufferAllocateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkAllocateCommandBuffers-pCommandBuffers-parameter"></a> <code>pCommandBuffers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pAllocateInfo</code>::commandBufferCount <code>VkCommandBuffer</code> handles</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>pAllocateInfo</code>::commandPool <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferAllocateInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandBufferAllocateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkCommandBufferAllocateInfo {
    VkStructureType         sType;
    <span class="directive">const</span> <span class="directive">void</span>*             pNext;
    VkCommandPool           commandPool;
    VkCommandBufferLevel    level;
    uint32_t                commandBufferCount;
} VkCommandBufferAllocateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool from which the command buffers are
allocated.</p>
</li>
<li>
<p><code>level</code> is a <a href="#VkCommandBufferLevel">VkCommandBufferLevel</a> value specifying the command
buffer level.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the number of command buffers to allocate
from the pool.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-commandBufferCount-00044"></a>
<code>commandBufferCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_ALLOCATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-commandPool-parameter"></a> <code>commandPool</code> <strong class="purple">must</strong> be a valid <code>VkCommandPool</code> handle</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferAllocateInfo-level-parameter"></a> <code>level</code> <strong class="purple">must</strong> be a valid <a href="#VkCommandBufferLevel">VkCommandBufferLevel</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkCommandBufferAllocateInfo">VkCommandBufferAllocateInfo</a>::<code>level</code>,
specifying the command buffer level, are:</p>
</div>
<div id="VkCommandBufferLevel" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkCommandBufferLevel {
    VK_COMMAND_BUFFER_LEVEL_PRIMARY = <span class="integer">0</span>,
    VK_COMMAND_BUFFER_LEVEL_SECONDARY = <span class="integer">1</span>,
} VkCommandBufferLevel;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_BUFFER_LEVEL_PRIMARY</code> specifies a primary command
buffer.</p>
</li>
<li>
<p><code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code> specifies a secondary command
buffer.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset command buffers, call:</p>
</div>
<div id="vkResetCommandBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkResetCommandBuffer(
    VkCommandBuffer                             commandBuffer,
    VkCommandBufferResetFlags                   flags);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer to reset.
The command buffer <strong class="purple">can</strong> be in any state other than
<a href="#commandbuffers-lifecycle">pending</a>, and is moved into the
<a href="#commandbuffers-lifecycle">initial state</a>.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandBufferResetFlagBits">VkCommandBufferResetFlagBits</a>
controlling the reset operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any primary command buffer that is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and has <code>commandBuffer</code> recorded into
it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandBuffer-commandBuffer-00045"></a>
<code>commandBuffer</code> <strong class="purple">must</strong> not be in the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkResetCommandBuffer-commandBuffer-00046"></a>
<code>commandBuffer</code> <strong class="purple">must</strong> have been allocated from a pool that was
created with the <code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetCommandBuffer-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkResetCommandBuffer-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkCommandBufferResetFlagBits">VkCommandBufferResetFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#vkResetCommandBuffer">vkResetCommandBuffer</a>::<code>flags</code> to control
the reset operation are:</p>
</div>
<div id="VkCommandBufferResetFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkCommandBufferResetFlagBits {
    VK_COMMAND_BUFFER_RESET_RELEASE_RESOURCES_BIT = <span class="hex">0x00000001</span>,
} VkCommandBufferResetFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_BUFFER_RESET_RELEASE_RESOURCES_BIT</code> specifies that most
or all memory resources currently owned by the command buffer <strong class="purple">should</strong> be
returned to the parent command pool.
If this flag is not set, then the command buffer <strong class="purple">may</strong> hold onto memory
resources and reuse them when recording commands.
<code>commandBuffer</code> is moved to the <a href="#commandbuffers-lifecycle">initial
state</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandBufferResetFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkCommandBufferResetFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandBufferResetFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandBufferResetFlagBits">VkCommandBufferResetFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To free command buffers, call:</p>
</div>
<div id="vkFreeCommandBuffers" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkFreeCommandBuffers(
    VkDevice                                    device,
    VkCommandPool                               commandPool,
    uint32_t                                    commandBufferCount,
    <span class="directive">const</span> VkCommandBuffer*                      pCommandBuffers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the command pool.</p>
</li>
<li>
<p><code>commandPool</code> is the command pool from which the command buffers
were allocated.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the length of the <code>pCommandBuffers</code>
array.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is an array of handles of command buffers to free.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any primary command buffer that is in the <a href="#commandbuffers-lifecycle">recording or executable state</a> and has any element of <code>pCommandBuffers</code>
recorded into it, becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeCommandBuffers-pCommandBuffers-00047"></a>
All elements of <code>pCommandBuffers</code> <strong class="purple">must</strong> not be in the
<a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-pCommandBuffers-00048"></a>
<code>pCommandBuffers</code> <strong class="purple">must</strong> be a valid pointer to an array of
<code>commandBufferCount</code> <code>VkCommandBuffer</code> handles, each element of
which <strong class="purple">must</strong> either be a valid handle or <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeCommandBuffers-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-commandPool-parameter"></a> <code>commandPool</code> <strong class="purple">must</strong> be a valid <code>VkCommandPool</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-commandBufferCount-arraylength"></a> <code>commandBufferCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-commandPool-parent"></a> <code>commandPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
<li>
<p><a id="VUID-vkFreeCommandBuffers-pCommandBuffers-parent"></a> Each element of <code>pCommandBuffers</code> that is a valid handle <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>commandPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandPool</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to each member of <code>pCommandBuffers</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="commandbuffers-recording">5.4. Command Buffer Recording</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin recording a command buffer, call:</p>
</div>
<div id="vkBeginCommandBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkBeginCommandBuffer(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCommandBufferBeginInfo*             pBeginInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the handle of the command buffer which is to be
put in the recording state.</p>
</li>
<li>
<p><code>pBeginInfo</code> is an instance of the <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>
structure, which defines additional information about how the command
buffer begins recording.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00049"></a>
<code>commandBuffer</code> <strong class="purple">must</strong> not be in the <a href="#commandbuffers-lifecycle">recording or pending state</a>.</p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00050"></a>
If <code>commandBuffer</code> was allocated from a <a href="#VkCommandPool">VkCommandPool</a> which
did not have the <code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code>
flag set, <code>commandBuffer</code> <strong class="purple">must</strong> be in the
<a href="#commandbuffers-lifecycle">initial state</a>.</p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00051"></a>
If <code>commandBuffer</code> is a secondary command buffer, the
<code>pInheritanceInfo</code> member of <code>pBeginInfo</code> <strong class="purple">must</strong> be a valid
<code>VkCommandBufferInheritanceInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-00052"></a>
If <code>commandBuffer</code> is a secondary command buffer and either the
<code>occlusionQueryEnable</code> member of the <code>pInheritanceInfo</code> member
of <code>pBeginInfo</code> is <code>VK_FALSE</code>, or the precise occlusion queries
feature is not enabled, the <code>queryFlags</code> member of the
<code>pInheritanceInfo</code> member <code>pBeginInfo</code> <strong class="purple">must</strong> not contain
<code>VK_QUERY_CONTROL_PRECISE_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBeginCommandBuffer-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkBeginCommandBuffer-pBeginInfo-parameter"></a> <code>pBeginInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkCommandBufferBeginInfo</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCommandBufferBeginInfo</code> structure is defined as:</p>
</div>
<div id="VkCommandBufferBeginInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkCommandBufferBeginInfo {
    VkStructureType                          sType;
    <span class="directive">const</span> <span class="directive">void</span>*                              pNext;
    VkCommandBufferUsageFlags                flags;
    <span class="directive">const</span> VkCommandBufferInheritanceInfo*    pInheritanceInfo;
} VkCommandBufferBeginInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkCommandBufferUsageFlagBits">VkCommandBufferUsageFlagBits</a>
specifying usage behavior for the command buffer.</p>
</li>
<li>
<p><code>pInheritanceInfo</code> is a pointer to a
<code>VkCommandBufferInheritanceInfo</code> structure, which is used if
<code>commandBuffer</code> is a secondary command buffer.
If this is a primary command buffer, then this value is ignored.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-00053"></a>
If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>, the
<code>renderPass</code> member of <code>pInheritanceInfo</code> <strong class="purple">must</strong> be a valid
<code>VkRenderPass</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-00054"></a>
If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>, the
<code>subpass</code> member of <code>pInheritanceInfo</code> <strong class="purple">must</strong> be a valid subpass
index within the <code>renderPass</code> member of <code>pInheritanceInfo</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-00055"></a>
If <code>flags</code> contains
<code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code>, the
<code>framebuffer</code> member of <code>pInheritanceInfo</code> <strong class="purple">must</strong> be either
<a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, or a valid <code>VkFramebuffer</code> that is compatible
with the <code>renderPass</code> member of <code>pInheritanceInfo</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferBeginInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkCommandBufferUsageFlagBits">VkCommandBufferUsageFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkCommandBufferBeginInfo">VkCommandBufferBeginInfo</a>::<code>flags</code> to
specify usage behavior for a command buffer are:</p>
</div>
<div id="VkCommandBufferUsageFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkCommandBufferUsageFlagBits {
    VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT = <span class="hex">0x00000001</span>,
    VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT = <span class="hex">0x00000002</span>,
    VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT = <span class="hex">0x00000004</span>,
} VkCommandBufferUsageFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> specifies that each
recording of the command buffer will only be submitted once, and the
command buffer will be reset and recorded again between each submission.</p>
</li>
<li>
<p><code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code> specifies that a
secondary command buffer is considered to be entirely inside a render
pass.
If this is a primary command buffer, then this bit is ignored.</p>
</li>
<li>
<p><code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> specifies that a
command buffer <strong class="purple">can</strong> be resubmitted to a queue while it is in the
<em>pending state</em>, and recorded into multiple primary command buffers.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCommandBufferUsageFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkCommandBufferUsageFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkCommandBufferUsageFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkCommandBufferUsageFlagBits">VkCommandBufferUsageFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the command buffer is a secondary command buffer, then the
<code>VkCommandBufferInheritanceInfo</code> structure defines any state that will
be inherited from the primary command buffer:</p>
</div>
<div id="VkCommandBufferInheritanceInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkCommandBufferInheritanceInfo {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkRenderPass                     renderPass;
    uint32_t                         subpass;
    VkFramebuffer                    framebuffer;
    VkBool32                         occlusionQueryEnable;
    VkQueryControlFlags              queryFlags;
    VkQueryPipelineStatisticFlags    pipelineStatistics;
} VkCommandBufferInheritanceInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>renderPass</code> is a <a href="#VkRenderPass">VkRenderPass</a> object defining which render
passes the <code>VkCommandBuffer</code> will be <a href="#renderpass-compatibility">compatible</a> with and <strong class="purple">can</strong> be executed within.
If the <code>VkCommandBuffer</code> will not be executed within a render pass
instance, <code>renderPass</code> is ignored.</p>
</li>
<li>
<p><code>subpass</code> is the index of the subpass within the render pass
instance that the <code>VkCommandBuffer</code> will be executed within.
If the <code>VkCommandBuffer</code> will not be executed within a render pass
instance, <code>subpass</code> is ignored.</p>
</li>
<li>
<p><code>framebuffer</code> optionally refers to the <a href="#VkFramebuffer">VkFramebuffer</a> object
that the <code>VkCommandBuffer</code> will be rendering to if it is executed
within a render pass instance.
It <strong class="purple">can</strong> be <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a> if the framebuffer is not known, or if
the <code>VkCommandBuffer</code> will not be executed within a render pass
instance.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Specifying the exact framebuffer that the secondary command buffer will be
executed with <strong class="purple">may</strong> result in better performance at command buffer execution
time.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><code>occlusionQueryEnable</code> specifies whether the command buffer <strong class="purple">can</strong> be
executed while an occlusion query is active in the primary command
buffer.
If this is <code>VK_TRUE</code>, then this command buffer <strong class="purple">can</strong> be executed
whether the primary command buffer has an occlusion query active or not.
If this is <code>VK_FALSE</code>, then the primary command buffer <strong class="purple">must</strong> not
have an occlusion query active.</p>
</li>
<li>
<p><code>queryFlags</code> specifies the query flags that <strong class="purple">can</strong> be used by an
active occlusion query in the primary command buffer when this secondary
command buffer is executed.
If this value includes the <code>VK_QUERY_CONTROL_PRECISE_BIT</code> bit, then
the active query <strong class="purple">can</strong> return boolean results or actual sample counts.
If this bit is not set, then the active query <strong class="purple">must</strong> not use the
<code>VK_QUERY_CONTROL_PRECISE_BIT</code> bit.</p>
</li>
<li>
<p><code>pipelineStatistics</code> is a bitmask of
<a href="#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a> specifying the set of pipeline
statistics that <strong class="purple">can</strong> be counted by an active query in the primary
command buffer when this secondary command buffer is executed.
If this value includes a given bit, then this command buffer <strong class="purple">can</strong> be
executed whether the primary command buffer has a pipeline statistics
query active that includes this bit or not.
If this value excludes a given bit, then the active pipeline statistics
query <strong class="purple">must</strong> not be from a query pool that counts that statistic.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-occlusionQueryEnable-00056"></a>
If the <a href="#features-features-inheritedQueries">inherited queries</a> feature
is not enabled, <code>occlusionQueryEnable</code> <strong class="purple">must</strong> be <code>VK_FALSE</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-queryFlags-00057"></a>
If the <a href="#features-features-inheritedQueries">inherited queries</a> feature
is enabled, <code>queryFlags</code> <strong class="purple">must</strong> be a valid combination of
<a href="#VkQueryControlFlagBits">VkQueryControlFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-pipelineStatistics-00058"></a>
If the <a href="#features-features-pipelineStatisticsQuery">pipeline statistics
queries</a> feature is not enabled, <code>pipelineStatistics</code> <strong class="purple">must</strong> be
<code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COMMAND_BUFFER_INHERITANCE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCommandBufferInheritanceInfo-commonparent"></a> Both of <code>framebuffer</code>, and <code>renderPass</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If <code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> was not set when
creating a command buffer, that command buffer <strong class="purple">must</strong> not be submitted to a
queue whilst it is already in the <a href="#commandbuffers-lifecycle">pending
state</a>.
If <code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> is not set on a
secondary command buffer, that command buffer <strong class="purple">must</strong> not be used more than
once in a given primary command buffer.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>On some implementations, not using the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> bit enables command
buffers to be patched in-place if needed, rather than creating a copy of the
command buffer.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a command buffer is in the <a href="#commandbuffers-lifecycle">invalid, or
executable state</a>, and the command buffer was allocated from a command pool
with the <code>VK_COMMAND_POOL_CREATE_RESET_COMMAND_BUFFER_BIT</code> flag set,
then <code>vkBeginCommandBuffer</code> implicitly resets the command buffer,
behaving as if <code>vkResetCommandBuffer</code> had been called with
<code>VK_COMMAND_BUFFER_RESET_RELEASE_RESOURCES_BIT</code> not set.
After the implicit reset, <code>commandBuffer</code> is moved to the
<a href="#commandbuffers-lifecycle">recording state</a>.</p>
</div>
<div class="paragraph">
<p>Once recording starts, an application records a sequence of commands
(<code>vkCmd*</code>) to set state in the command buffer, draw, dispatch, and other
commands.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To complete recording of a command buffer, call:</p>
</div>
<div id="vkEndCommandBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkEndCommandBuffer(
    VkCommandBuffer                             commandBuffer);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer to complete recording.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If there was an error during recording, the application will be notified by
an unsuccessful return code returned by <code>vkEndCommandBuffer</code>.
If the application wishes to further use the command buffer, the command
buffer <strong class="purple">must</strong> be reset.
The command buffer <strong class="purple">must</strong> have been in the <a href="#commandbuffers-lifecycle">recording state</a>, and is moved to the <a href="#commandbuffers-lifecycle">executable state</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00059"></a>
<code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a>.</p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00060"></a>
If <code>commandBuffer</code> is a primary command buffer, there <strong class="purple">must</strong> not be
an active render pass instance</p>
</li>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-00061"></a>
All queries made <a href="#queries-operation-active">active</a> during the
recording of <code>commandBuffer</code> <strong class="purple">must</strong> have been made inactive</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkEndCommandBuffer-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When a command buffer is in the executable state, it <strong class="purple">can</strong> be submitted to a
queue for execution.</p>
</div>
</div>
<div class="sect2">
<h3 id="commandbuffers-submission">5.5. Command Buffer Submission</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To submit command buffers to a queue, call:</p>
</div>
<div id="vkQueueSubmit" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkQueueSubmit(
    VkQueue                                     queue,
    uint32_t                                    submitCount,
    <span class="directive">const</span> VkSubmitInfo*                         pSubmits,
    VkFence                                     fence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue that the command buffers will be submitted to.</p>
</li>
<li>
<p><code>submitCount</code> is the number of elements in the <code>pSubmits</code> array.</p>
</li>
<li>
<p><code>pSubmits</code> is a pointer to an array of <a href="#VkSubmitInfo">VkSubmitInfo</a>
structures, each specifying a command buffer submission batch.</p>
</li>
<li>
<p><code>fence</code> is an <strong class="purple">optional</strong> handle to a fence to be signaled once all
submitted command buffers have completed execution.
If <code>fence</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it defines a
<a href="#synchronization-fences-signaling">fence signal operation</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Submission can be a high overhead operation, and applications <strong class="purple">should</strong>
attempt to batch work together into as few calls to <code>vkQueueSubmit</code> as
possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>vkQueueSubmit</code> is a <a href="#devsandqueues-submission">queue submission
command</a>, with each batch defined by an element of <code>pSubmits</code> as an
instance of the <a href="#VkSubmitInfo">VkSubmitInfo</a> structure.
Batches begin execution in the order they appear in <code>pSubmits</code>, but <strong class="purple">may</strong>
complete out of order.</p>
</div>
<div class="paragraph">
<p>Fence and semaphore operations submitted with <a href="#vkQueueSubmit">vkQueueSubmit</a> have
additional ordering constraints compared to other submission commands, with
dependencies involving previous and subsequent queue operations.
Information about these additional constraints can be found in the
<a href="#synchronization-semaphores">semaphore</a> and <a href="#synchronization-fences">fence</a> sections of <a href="#synchronization">the synchronization chapter</a>.</p>
</div>
<div class="paragraph">
<p>Details on the interaction of <code>pWaitDstStageMask</code> with synchronization
are described in the <a href="#synchronization-semaphores-waiting">semaphore wait
operation</a> section of <a href="#synchronization">the synchronization chapter</a>.</p>
</div>
<div class="paragraph">
<p>The order that batches appear in <code>pSubmits</code> is used to determine
<a href="#synchronization-submission-order">submission order</a>, and thus all the
<a href="#synchronization-implicit">implicit ordering guarantees</a> that respect it.
Other than these implicit ordering guarantees and any <a href="#synchronization">explicit synchronization primitives</a>, these batches <strong class="purple">may</strong> overlap or
otherwise execute out of order.</p>
</div>
<div class="paragraph">
<p>If any command buffer submitted to this queue is in the
<a href="#commandbuffers-lifecycle">executable state</a>, it is moved to the
<a href="#commandbuffers-lifecycle">pending state</a>.
Once execution of all submissions of a command buffer complete, it moves
from the <a href="#commandbuffers-lifecycle">pending state</a>, back to the
<a href="#commandbuffers-lifecycle">executable state</a>.
If a command buffer was recorded with the
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> flag, it instead moves
back to the <a href="#commandbuffers-lifecycle">invalid state</a>.</p>
</div>
<div class="paragraph">
<p>If <code>vkQueueSubmit</code> fails, it <strong class="purple">may</strong> return
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> or <code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code>.
If it does, the implementation <strong class="purple">must</strong> ensure that the state and contents of
any resources or synchronization primitives referenced by the submitted
command buffers and any semaphores referenced by <code>pSubmits</code> is
unaffected by the call or its failure.
If <code>vkQueueSubmit</code> fails in such a way that the implementation is unable
to make that guarantee, the implementation <strong class="purple">must</strong> return
<code>VK_ERROR_DEVICE_LOST</code>.
See <a href="#devsandqueues-lost-device">Lost Device</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSubmit-fence-00063"></a>
If <code>fence</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>fence</code> <strong class="purple">must</strong> be
unsignaled</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-fence-00064"></a>
If <code>fence</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>fence</code> <strong class="purple">must</strong> not be
associated with any other queue command that has not yet completed
execution on that queue</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00065"></a>
Any calls to <a href="#vkCmdSetEvent">vkCmdSetEvent</a>, <a href="#vkCmdResetEvent">vkCmdResetEvent</a> or
<a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> that have been recorded into any of the command
buffer elements of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code>, <strong class="purple">must</strong> not reference any <a href="#VkEvent">VkEvent</a> that is referenced
by any of those commands in a command buffer that has been submitted to
another queue and is still in the <em>pending state</em>.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pWaitDstStageMask-00066"></a>
Any stage flag included in any element of the <code>pWaitDstStageMask</code>
member of any element of <code>pSubmits</code> <strong class="purple">must</strong> be a pipeline stage
supported by one of the capabilities of <code>queue</code>, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a>.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSignalSemaphores-00067"></a>
Each element of the <code>pSignalSemaphores</code> member of any element of
<code>pSubmits</code> <strong class="purple">must</strong> be unsignaled when the semaphore signal operation
it defines is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pWaitSemaphores-00068"></a>
When a semaphore unsignal operation defined by any element of the
<code>pWaitSemaphores</code> member of any element of <code>pSubmits</code> executes
on <code>queue</code>, no other queue <strong class="purple">must</strong> be waiting on the same semaphore.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pWaitSemaphores-00069"></a>
All elements of the <code>pWaitSemaphores</code> member of all elements of
<code>pSubmits</code> <strong class="purple">must</strong> be semaphores that are signaled, or have
<a href="#synchronization-semaphores-signaling">semaphore signal operations</a>
previously submitted for execution.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00070"></a>
Each element of the <code>pCommandBuffers</code> member of each element of
<code>pSubmits</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">pending or
executable state</a>.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00071"></a>
If any element of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>, it <strong class="purple">must</strong> not be in
the <a href="#commandbuffers-lifecycle">pending state</a>.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00072"></a>
Any <a href="#commandbuffers-secondary">secondary command buffers recorded</a>
into any element of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">pending or
executable state</a>.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00073"></a>
If any <a href="#commandbuffers-secondary">secondary command buffers recorded</a>
into any element of the <code>pCommandBuffers</code> member of any element of
<code>pSubmits</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code>, it <strong class="purple">must</strong> not be in
the <a href="#commandbuffers-lifecycle">pending state</a>.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pCommandBuffers-00074"></a>
Each element of the <code>pCommandBuffers</code> member of each element of
<code>pSubmits</code> <strong class="purple">must</strong> have been allocated from a <code>VkCommandPool</code> that
was created for the same queue family <code>queue</code> belongs to.</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSubmits-02207"></a>
If any element of <code>pSubmits</code>&#8594;<code>pCommandBuffers</code> includes a
<a href="#synchronization-queue-transfers-acquire">Queue Family Transfer Acquire
Operation</a>, there <strong class="purple">must</strong> exist a previously submitted
<a href="#synchronization-queue-transfers-release">Queue Family Transfer Release
Operation</a> on a queue in the queue family identified by the acquire
operation, with parameters matching the acquire operation as defined in
the definition of such <a href="#synchronization-queue-transfers-acquire">acquire operations</a>, and which happens before the acquire operation.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueSubmit-queue-parameter"></a> <code>queue</code> <strong class="purple">must</strong> be a valid <code>VkQueue</code> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-pSubmits-parameter"></a> If <code>submitCount</code> is not <code>0</code>, <code>pSubmits</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>submitCount</code> valid <code>VkSubmitInfo</code> structures</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-fence-parameter"></a> If <code>fence</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>fence</code> <strong class="purple">must</strong> be a valid <code>VkFence</code> handle</p>
</li>
<li>
<p><a id="VUID-vkQueueSubmit-commonparent"></a> Both of <code>fence</code>, and <code>queue</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queue</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to <code>pSubmits</code>[].pWaitSemaphores[] <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to <code>pSubmits</code>[].pSignalSemaphores[] <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to <code>fence</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSubmitInfo</code> structure is defined as:</p>
</div>
<div id="VkSubmitInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkSubmitInfo {
    VkStructureType                sType;
    <span class="directive">const</span> <span class="directive">void</span>*                    pNext;
    uint32_t                       waitSemaphoreCount;
    <span class="directive">const</span> VkSemaphore*             pWaitSemaphores;
    <span class="directive">const</span> VkPipelineStageFlags*    pWaitDstStageMask;
    uint32_t                       commandBufferCount;
    <span class="directive">const</span> VkCommandBuffer*         pCommandBuffers;
    uint32_t                       signalSemaphoreCount;
    <span class="directive">const</span> VkSemaphore*             pSignalSemaphores;
} VkSubmitInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>waitSemaphoreCount</code> is the number of semaphores upon which to wait
before executing the command buffers for the batch.</p>
</li>
<li>
<p><code>pWaitSemaphores</code> is a pointer to an array of semaphores upon which
to wait before the command buffers for this batch begin execution.
If semaphores to wait on are provided, they define a
<a href="#synchronization-semaphores-waiting">semaphore wait operation</a>.</p>
</li>
<li>
<p><code>pWaitDstStageMask</code> is a pointer to an array of pipeline stages at
which each corresponding semaphore wait will occur.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the number of command buffers to execute in
the batch.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is a pointer to an array of command buffers to
execute in the batch.</p>
</li>
<li>
<p><code>signalSemaphoreCount</code> is the number of semaphores to be signaled
once the commands specified in <code>pCommandBuffers</code> have completed
execution.</p>
</li>
<li>
<p><code>pSignalSemaphores</code> is a pointer to an array of semaphores which
will be signaled when the command buffers for this batch have completed
execution.
If semaphores to be signaled are provided, they define a
<a href="#synchronization-semaphores-signaling">semaphore signal operation</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The order that command buffers appear in <code>pCommandBuffers</code> is used to
determine <a href="#synchronization-submission-order">submission order</a>, and thus
all the <a href="#synchronization-implicit">implicit ordering guarantees</a> that
respect it.
Other than these implicit ordering guarantees and any <a href="#synchronization">explicit synchronization primitives</a>, these command buffers <strong class="purple">may</strong> overlap or
otherwise execute out of order.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-00075"></a>
Each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> not have been allocated with
<code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-00076"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, each element of <code>pWaitDstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-00077"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, each element of <code>pWaitDstStageMask</code> <strong class="purple">must</strong>
not contain <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-00078"></a>
Each element of <code>pWaitDstStageMask</code> <strong class="purple">must</strong> not include
<code>VK_PIPELINE_STAGE_HOST_BIT</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubmitInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_SUBMIT_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitSemaphores-parameter"></a> If <code>waitSemaphoreCount</code> is not <code>0</code>, <code>pWaitSemaphores</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>waitSemaphoreCount</code> valid <code>VkSemaphore</code> handles</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-parameter"></a> If <code>waitSemaphoreCount</code> is not <code>0</code>, <code>pWaitDstStageMask</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>waitSemaphoreCount</code> valid combinations of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pWaitDstStageMask-requiredbitmask"></a> Each element of <code>pWaitDstStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pCommandBuffers-parameter"></a> If <code>commandBufferCount</code> is not <code>0</code>, <code>pCommandBuffers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>commandBufferCount</code> valid <code>VkCommandBuffer</code> handles</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-pSignalSemaphores-parameter"></a> If <code>signalSemaphoreCount</code> is not <code>0</code>, <code>pSignalSemaphores</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>signalSemaphoreCount</code> valid <code>VkSemaphore</code> handles</p>
</li>
<li>
<p><a id="VUID-VkSubmitInfo-commonparent"></a> Each of the elements of <code>pCommandBuffers</code>, the elements of <code>pSignalSemaphores</code>, and the elements of <code>pWaitSemaphores</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="commandbuffers-submission-progress">5.6. Queue Forward Progress</h3>
<div class="paragraph">
<p>The application <strong class="purple">must</strong> ensure that command buffer submissions will be able to
complete without any subsequent operations by the application on any queue.
After any call to <code>vkQueueSubmit</code>, for every queued wait on a semaphore
there <strong class="purple">must</strong> be a prior signal of that semaphore that will not be consumed by
a different wait on the semaphore.</p>
</div>
<div class="paragraph">
<p>Command buffers in the submission <strong class="purple">can</strong> include <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a>
commands that wait on events that will not be signaled by earlier commands
in the queue.
Such events <strong class="purple">must</strong> be signaled by the application using <a href="#vkSetEvent">vkSetEvent</a>, and
the <code>vkCmdWaitEvents</code> commands that wait upon them <strong class="purple">must</strong> not be inside a
render pass instance.
Implementations <strong class="purple">may</strong> have limits on how long the command buffer will wait,
in order to avoid interfering with progress of other clients of the device.
If the event is not signaled within these limits, results are undefined and
<strong class="purple">may</strong> include device loss.</p>
</div>
</div>
<div class="sect2">
<h3 id="commandbuffers-secondary">5.7. Secondary Command Buffer Execution</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A secondary command buffer <strong class="purple">must</strong> not be directly submitted to a queue.
Instead, secondary command buffers are recorded to execute as part of a
primary command buffer with the command:</p>
</div>
<div id="vkCmdExecuteCommands" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdExecuteCommands(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    commandBufferCount,
    <span class="directive">const</span> VkCommandBuffer*                      pCommandBuffers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is a handle to a primary command buffer that the
secondary command buffers are executed in.</p>
</li>
<li>
<p><code>commandBufferCount</code> is the length of the <code>pCommandBuffers</code>
array.</p>
</li>
<li>
<p><code>pCommandBuffers</code> is an array of secondary command buffer handles,
which are recorded to execute in the primary command buffer in the order
they are listed in the array.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, and it was recorded
into any other primary command buffer which is currently in the
<a href="#commandbuffers-lifecycle">executable or recording state</a>, that primary
command buffer becomes <a href="#commandbuffers-lifecycle">invalid</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00087"></a>
<code>commandBuffer</code> <strong class="purple">must</strong> have been allocated with a <code>level</code> of
<code>VK_COMMAND_BUFFER_LEVEL_PRIMARY</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00088"></a>
Each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> have been allocated with a
<code>level</code> of <code>VK_COMMAND_BUFFER_LEVEL_SECONDARY</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00089"></a>
Each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> be in the
<a href="#commandbuffers-lifecycle">pending or executable state</a>.</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00090"></a>
If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, and it was
recorded into any other primary command buffer, that primary command
buffer <strong class="purple">must</strong> not be in the <a href="#commandbuffers-lifecycle">pending state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00091"></a>
If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, it <strong class="purple">must</strong> not be
in the <a href="#commandbuffers-lifecycle">pending state</a>.</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00092"></a>
If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, it <strong class="purple">must</strong> not
have already been recorded to <code>commandBuffer</code>.</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00093"></a>
If any element of <code>pCommandBuffers</code> was not recorded with the
<code>VK_COMMAND_BUFFER_USAGE_SIMULTANEOUS_USE_BIT</code> flag, it <strong class="purple">must</strong> not
appear more than once in <code>pCommandBuffers</code>.</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00094"></a>
Each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> have been allocated from a
<code>VkCommandPool</code> that was created for the same queue family as the
<code>VkCommandPool</code> from which <code>commandBuffer</code> was allocated</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-contents-00095"></a>
If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, that render pass instance <strong class="purple">must</strong> have been begun with the
<code>contents</code> parameter of <code>vkCmdBeginRenderPass</code> set to
<code>VK_SUBPASS_CONTENTS_SECONDARY_COMMAND_BUFFERS</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00096"></a>
If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> have been recorded
with the <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00097"></a>
If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> have been recorded
with <code>VkCommandBufferInheritanceInfo</code>::<code>subpass</code> set to the
index of the subpass which the given command buffer will be executed in</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pInheritanceInfo-00098"></a>
If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, the render passes specified in the
<code>pBeginInfo</code>::<code>pInheritanceInfo</code>::<code>renderPass</code> members of
the <a href="#vkBeginCommandBuffer">vkBeginCommandBuffer</a> commands used to begin recording each
element of <code>pCommandBuffers</code> <strong class="purple">must</strong> be
<a href="#renderpass-compatibility">compatible</a> with the current render pass.</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00099"></a>
If <code>vkCmdExecuteCommands</code> is being called within a render pass
instance, and any element of <code>pCommandBuffers</code> was recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>framebuffer</code> not equal to
<a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, that <code>VkFramebuffer</code> <strong class="purple">must</strong> match the
<code>VkFramebuffer</code> used in the current render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00100"></a>
If <code>vkCmdExecuteCommands</code> is not being called within a render pass
instance, each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> not have been
recorded with the <code>VK_COMMAND_BUFFER_USAGE_RENDER_PASS_CONTINUE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00101"></a>
If the <a href="#features-features-inheritedQueries">inherited queries</a> feature
is not enabled, <code>commandBuffer</code> <strong class="purple">must</strong> not have any queries
<a href="#queries-operation-active">active</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00102"></a>
If <code>commandBuffer</code> has a <code>VK_QUERY_TYPE_OCCLUSION</code> query
<a href="#queries-operation-active">active</a>, then each element of
<code>pCommandBuffers</code> <strong class="purple">must</strong> have been recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>occlusionQueryEnable</code> set to
<code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00103"></a>
If <code>commandBuffer</code> has a <code>VK_QUERY_TYPE_OCCLUSION</code> query
<a href="#queries-operation-active">active</a>, then each element of
<code>pCommandBuffers</code> <strong class="purple">must</strong> have been recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>queryFlags</code> having all bits
set that are set for the query</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-00104"></a>
If <code>commandBuffer</code> has a <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>
query <a href="#queries-operation-active">active</a>, then each element of
<code>pCommandBuffers</code> <strong class="purple">must</strong> have been recorded with
<code>VkCommandBufferInheritanceInfo</code>::<code>pipelineStatistics</code> having
all bits set that are set in the <code>VkQueryPool</code> the query uses</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-00105"></a>
Each element of <code>pCommandBuffers</code> <strong class="purple">must</strong> not begin any query types
that are <a href="#queries-operation-active">active</a> in <code>commandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-pCommandBuffers-parameter"></a> <code>pCommandBuffers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>commandBufferCount</code> valid <code>VkCommandBuffer</code> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support transfer, graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-bufferlevel"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commandBufferCount-arraylength"></a> <code>commandBufferCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdExecuteCommands-commonparent"></a> Both of <code>commandBuffer</code>, and the elements of <code>pCommandBuffers</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synchronization">6. Synchronization and Cache Control</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Synchronization of access to resources is primarily the responsibility of
the application in Vulkan.
The order of execution of commands with respect to the host and other
commands on the device has few implicit guarantees, and needs to be
explicitly specified.
Memory caches and other optimizations are also explicitly managed, requiring
that the flow of data through the system is largely under application
control.</p>
</div>
<div class="paragraph">
<p>Whilst some implicit guarantees exist between commands, five explicit
synchronization mechanisms are exposed by Vulkan:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#synchronization-fences">Fences</a></dt>
<dd>
<p>Fences <strong class="purple">can</strong> be used to communicate to the host that execution of some
task on the device has completed.</p>
</dd>
<dt class="hdlist1"><a href="#synchronization-semaphores">Semaphores</a></dt>
<dd>
<p>Semaphores <strong class="purple">can</strong> be used to control resource access across multiple
queues.</p>
</dd>
<dt class="hdlist1"><a href="#synchronization-events">Events</a></dt>
<dd>
<p>Events provide a fine-grained synchronization primitive which <strong class="purple">can</strong> be
signaled either within a command buffer or by the host, and <strong class="purple">can</strong> be
waited upon within a command buffer or queried on the host.</p>
</dd>
<dt class="hdlist1"><a href="#synchronization-pipeline-barriers">Pipeline Barriers</a></dt>
<dd>
<p>Pipeline barriers also provide synchronization control within a command
buffer, but at a single point, rather than with separate signal and wait
operations.</p>
</dd>
<dt class="hdlist1"><a href="#renderpass">Render Passes</a></dt>
<dd>
<p>Render passes provide a useful synchronization framework for most
rendering tasks, built upon the concepts in this chapter.
Many cases that would otherwise need an application to use other
synchronization primitives <strong class="purple">can</strong> be expressed more efficiently as part of
a render pass.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="synchronization-dependencies">6.1. Execution and Memory Dependencies</h3>
<div class="paragraph">
<p>An <em>operation</em> is an arbitrary amount of work to be executed on the host, a
device, or an external entity such as a presentation engine.
Synchronization commands introduce explicit <em>execution dependencies</em>, and
<em>memory dependencies</em> between two sets of operations defined by the
command&#8217;s two <em>synchronization scopes</em>.</p>
</div>
<div id="synchronization-dependencies-scopes" class="paragraph">
<p>The synchronization scopes define which other operations a synchronization
command is able to create execution dependencies with.
Any type of operation that is not in a synchronization command&#8217;s
synchronization scopes will not be included in the resulting dependency.
For example, for many synchronization commands, the synchronization scopes
<strong class="purple">can</strong> be limited to just operations executing in specific
<a href="#synchronization-pipeline-stages">pipeline stages</a>, which allows other
pipeline stages to be excluded from a dependency.
Other scoping options are possible, depending on the particular command.</p>
</div>
<div id="synchronization-dependencies-execution" class="paragraph">
<p>An <em>execution dependency</em> is a guarantee that for two sets of operations,
the first set <strong class="purple">must</strong> <em>happen-before</em> the second set.
If an operation happens-before another operation, then the first operation
<strong class="purple">must</strong> complete before the second operation is initiated.
More precisely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>A</strong> and <strong>B</strong> be separate sets of operations.</p>
</li>
<li>
<p>Let <strong>S</strong> be a synchronization command.</p>
</li>
<li>
<p>Let <strong>A<sub>S</sub></strong> and <strong>B<sub>S</sub></strong> be the synchronization scopes of <strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>A'</strong> be the intersection of sets <strong>A</strong> and <strong>A<sub>S</sub></strong>.</p>
</li>
<li>
<p>Let <strong>B'</strong> be the intersection of sets <strong>B</strong> and <strong>B<sub>S</sub></strong>.</p>
</li>
<li>
<p>Submitting <strong>A</strong>, <strong>S</strong> and <strong>B</strong> for execution, in that order, will result in
execution dependency <strong>E</strong> between <strong>A'</strong> and <strong>B'</strong>.</p>
</li>
<li>
<p>Execution dependency <strong>E</strong> guarantees that <strong>A'</strong> happens-before <strong>B'</strong>.</p>
</li>
</ul>
</div>
<div id="synchronization-dependencies-chains" class="paragraph">
<p>An <em>execution dependency chain</em> is a sequence of execution dependencies that
form a happens-before relation between the first dependency&#8217;s <strong>A'</strong> and the
final dependency&#8217;s <strong>B'</strong>.
For each consecutive pair of execution dependencies, a chain exists if the
intersection of <strong>B<sub>S</sub></strong> in the first dependency and <strong>A<sub>S</sub></strong> in the second
dependency is not an empty set.
The formation of a single execution dependency from an execution dependency
chain can be described by substituting the following in the description of
execution dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>S</strong> be a set of synchronization commands that generate an execution
dependency chain.</p>
</li>
<li>
<p>Let <strong>A<sub>S</sub></strong> be the first synchronization scope of the first command in
<strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>B<sub>S</sub></strong> be the second synchronization scope of the last command in
<strong>S</strong>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>An execution dependency is inherently also multiple execution dependencies -
a dependency exists between each subset of <strong>A'</strong> and each subset of <strong>B'</strong>, and
the same is true for execution dependency chains.
For example, a synchronization command with multiple
<a href="#synchronization-pipeline-stages">pipeline stages</a> in its stage masks
effectively generates one dependency between each source stage and each
destination stage.
This can be useful to think about when considering how execution chains are
formed if they do not involve all parts of a synchronization command&#8217;s
dependency.
Similarly, any set of adjacent dependencies in an execution dependency chain
<strong class="purple">can</strong> be considered an execution dependency chain in its own right.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Execution dependencies alone are not sufficient to guarantee that values
resulting from writes in one set of operations <strong class="purple">can</strong> be read from another set
of operations.</p>
</div>
<div id="synchronization-dependencies-available-and-visible" class="paragraph">
<p>Three additional types of operation are used to control memory access.
<em>Availability operations</em> cause the values generated by specified memory
write accesses to become <em>available</em> to a memory domain for future access.
Any available value remains available until a subsequent write to the same
memory location occurs (whether it is made available or not) or the memory
is freed.
<em>Memory domain operations</em> cause writes that are available to a source
memory domain to become available to a destination memory domain (an example
of this is making writes available to the host domain available to the
device domain).
<em>Visibility operations</em> cause values available to a memory domain to become
<em>visible</em> to specified memory accesses.</p>
</div>
<div id="synchronization-dependencies-memory" class="paragraph">
<p>A <em>memory dependency</em> is an execution dependency which includes availability
and visibility operations such that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first set of operations happens-before the availability operation.</p>
</li>
<li>
<p>The availability operation happens-before the visibility operation.</p>
</li>
<li>
<p>The visibility operation happens-before the second set of operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once written values are made visible to a particular type of memory access,
they <strong class="purple">can</strong> be read or written by that type of memory access.
Most synchronization commands in Vulkan define a memory dependency.</p>
</div>
<div id="synchronization-dependencies-access-scopes" class="paragraph">
<p>The specific memory accesses that are made available and visible are defined
by the <em>access scopes</em> of a memory dependency.
Any type of access that is in a memory dependency&#8217;s first access scope and
occurs in <strong>A'</strong> is made available.
Any type of access that is in a memory dependency&#8217;s second access scope and
occurs in <strong>B'</strong> has any available writes made visible to it.
Any type of operation that is not in a synchronization command&#8217;s access
scopes will not be included in the resulting dependency.</p>
</div>
<div class="paragraph">
<p>A memory dependency enforces availability and visibility of memory accesses
and execution order between two sets of operations.
Adding to the description of <a href="#synchronization-dependencies-chains">execution dependency chains</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>a</strong> be the set of memory accesses performed by <strong>A'</strong>.</p>
</li>
<li>
<p>Let <strong>b</strong> be the set of memory accesses performed by <strong>B'</strong>.</p>
</li>
<li>
<p>Let <strong>a<sub>S</sub></strong> be the first access scope of the first command in <strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>b<sub>S</sub></strong> be the second access scope of the last command in <strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>a'</strong> be the intersection of sets <strong>a</strong> and <strong>a<sub>S</sub></strong>.</p>
</li>
<li>
<p>Let <strong>b'</strong> be the intersection of sets <strong>b</strong> and <strong>b<sub>S</sub></strong>.</p>
</li>
<li>
<p>Submitting <strong>A</strong>, <strong>S</strong> and <strong>B</strong> for execution, in that order, will result in
a memory dependency <strong>m</strong> between <strong>A'</strong> and <strong>B'</strong>.</p>
</li>
<li>
<p>Memory dependency <strong>m</strong> guarantees that:</p>
<div class="ulist">
<ul>
<li>
<p>Memory writes in <strong>a'</strong> are made available.</p>
</li>
<li>
<p>Available memory writes, including those from <strong>a'</strong>, are made visible to
<strong>b'</strong>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Execution and memory dependencies are used to solve data hazards, i.e. to
ensure that read and write operations occur in a well-defined order.
Write-after-read hazards can be solved with just an execution dependency,
but read-after-write and write-after-write hazards need appropriate memory
dependencies to be included between them.
If an application does not include dependencies to solve these hazards, the
results and execution orders of memory accesses are undefined.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="synchronization-image-layout-transitions">6.1.1. Image Layout Transitions</h4>
<div class="paragraph">
<p>Image subresources <strong class="purple">can</strong> be transitioned from one <a href="#resources-image-layouts">layout</a> to another as part of a <a href="#synchronization-dependencies-memory">memory dependency</a> (e.g. by using an
<a href="#synchronization-image-memory-barriers">image memory barrier</a>).
When a layout transition is specified in a memory dependency, it
happens-after the availability operations in the memory dependency, and
happens-before the visibility operations.
Image layout transitions <strong class="purple">may</strong> perform read and write accesses on all memory
bound to the image subresource range, so applications <strong class="purple">must</strong> ensure that all
memory writes have been made
<a href="#synchronization-dependencies-available-and-visible">available</a> before a
layout transition is executed.
Available memory is automatically made visible to a layout transition, and
writes performed by a layout transition are automatically made available.</p>
</div>
<div class="paragraph">
<p>Layout transitions always apply to a particular image subresource range, and
specify both an old layout and new layout.
If the old layout does not match the new layout, a transition occurs.
The old layout <strong class="purple">must</strong> match the current layout of the image subresource
range, with one exception.
The old layout <strong class="purple">can</strong> always be specified as <code>VK_IMAGE_LAYOUT_UNDEFINED</code>,
though doing so invalidates the contents of the image subresource range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Setting the old layout to <code>VK_IMAGE_LAYOUT_UNDEFINED</code> implies that the
contents of the image subresource need not be preserved.
Implementations <strong class="purple">may</strong> use this information to avoid performing expensive data
transition operations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">must</strong> ensure that layout transitions happen-after all
operations accessing the image with the old layout, and happen-before any
operations that will access the image with the new layout.
Layout transitions are potentially read/write operations, so not defining
appropriate memory dependencies to guarantee this will result in a data
race.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Image layout transitions interact with <a href="#resources-memory-aliasing">memory
aliasing</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-pipeline-stages">6.1.2. Pipeline Stages</h4>
<div class="paragraph">
<p>The work performed by an <a href="#fundamentals-queueoperation-command-types">action
or synchronization command</a> consists of multiple operations, which are
performed as a sequence of logically independent steps known as <em>pipeline
stages</em>.
The exact pipeline stages executed depend on the particular command that is
used, and current command buffer state when the command was recorded.
<a href="#drawing">Drawing commands</a>, <a href="#dispatch">dispatching commands</a>,
<a href="#copies">copy commands</a>, <a href="#clears">clear commands</a>, and <a href="#synchronization">synchronization commands</a> all execute in different sets of
<a href="#synchronization-pipeline-stages-types">pipeline stages</a>.
<a href="#synchronization">Synchronization commands</a> do not execute in a defined
pipeline, but do execute <code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> and
<code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Operations performed by synchronization commands (e.g.
<a href="#synchronization-dependencies-available-and-visible">availability and
visibility operations</a>) are not executed by a defined pipeline stage.
However other commands can still synchronize with them via the
<code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> and
<code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code> pipeline stages.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Execution of operations across pipeline stages <strong class="purple">must</strong> adhere to
<a href="#synchronization-implicit">implicit ordering guarantees</a>, particularly
including <a href="#synchronization-pipeline-stages-order">pipeline stage order</a>.
Otherwise, execution across pipeline stages <strong class="purple">may</strong> overlap or execute out of
order with regards to other stages, unless otherwise enforced by an
execution dependency.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Several of the synchronization commands include pipeline stage parameters,
restricting the <a href="#synchronization-dependencies-scopes">synchronization
scopes</a> for that command to just those stages.
This allows fine grained control over the exact execution dependencies and
accesses performed by action commands.
Implementations <strong class="purple">should</strong> use these pipeline stages to avoid unnecessary
stalls or cache flushing.</p>
</div>
<div class="paragraph">
<p>Bits which can be set, specifying pipeline stages, are:</p>
</div>
<div id="VkPipelineStageFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkPipelineStageFlagBits {
    VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT = <span class="hex">0x00000001</span>,
    VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT = <span class="hex">0x00000002</span>,
    VK_PIPELINE_STAGE_VERTEX_INPUT_BIT = <span class="hex">0x00000004</span>,
    VK_PIPELINE_STAGE_VERTEX_SHADER_BIT = <span class="hex">0x00000008</span>,
    VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT = <span class="hex">0x00000010</span>,
    VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT = <span class="hex">0x00000020</span>,
    VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT = <span class="hex">0x00000040</span>,
    VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT = <span class="hex">0x00000080</span>,
    VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT = <span class="hex">0x00000100</span>,
    VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT = <span class="hex">0x00000200</span>,
    VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT = <span class="hex">0x00000400</span>,
    VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT = <span class="hex">0x00000800</span>,
    VK_PIPELINE_STAGE_TRANSFER_BIT = <span class="hex">0x00001000</span>,
    VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT = <span class="hex">0x00002000</span>,
    VK_PIPELINE_STAGE_HOST_BIT = <span class="hex">0x00004000</span>,
    VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT = <span class="hex">0x00008000</span>,
    VK_PIPELINE_STAGE_ALL_COMMANDS_BIT = <span class="hex">0x00010000</span>,
} VkPipelineStageFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> specifies the stage of the
pipeline where any commands are initially received by the queue.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code> specifies the stage of the
pipeline where Draw/DispatchIndirect data structures are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code> specifies the stage of the
pipeline where vertex and index buffers are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code> specifies the vertex shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> specifies the
tessellation control shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code> specifies the
tessellation evaluation shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code> specifies the geometry
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> specifies the fragment
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where early fragment tests (depth and stencil tests before
fragment shading) are performed.
This stage also includes <a href="#renderpass-load-store-ops">subpass load
operations</a> for framebuffer attachments with a depth/stencil format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where late fragment tests (depth and stencil tests after
fragment shading) are performed.
This stage also includes <a href="#renderpass-load-store-ops">subpass store
operations</a> for framebuffer attachments with a depth/stencil format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> specifies the stage
of the pipeline after blending where the final color values are output
from the pipeline.
This stage also includes <a href="#renderpass-load-store-ops">subpass load and
store operations</a> and multisample resolve operations for framebuffer
attachments with a color format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code> specifies the execution of a
compute shader.</p>
</li>
<li>
<p><a id="synchronization-pipeline-stages-transfer"></a>
<code>VK_PIPELINE_STAGE_TRANSFER_BIT</code> specifies the execution of copy
commands.
This includes the operations resulting from all <a href="#copies">copy
commands</a>, <a href="#clears">clear commands</a> (with the exception of
<a href="#vkCmdClearAttachments">vkCmdClearAttachments</a>), and <a href="#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code> specifies the final stage in
the pipeline where operations generated by all commands complete
execution.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_HOST_BIT</code> specifies a pseudo-stage indicating
execution on the host of reads/writes of device memory.
This stage is not invoked by any commands recorded in a command buffer.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</code> specifies the execution of all
graphics pipeline stages, and is equivalent to the logical OR of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> is equivalent to the logical OR
of every other pipeline stage flag that is supported on the queue it is
used with.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>An execution dependency with only <code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code>
in the destination stage mask will only prevent that stage from executing in
subsequently submitted commands.
As this stage does not perform any actual execution, this is not observable
- in effect, it does not delay processing of subsequent commands.
Similarly an execution dependency with only
<code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> in the source stage mask will
effectively not wait for any prior commands to complete.</p>
</div>
<div class="paragraph">
<p>When defining a memory dependency, using only
<code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code> or
<code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> would never make any accesses
available and/or visible because these stages do not access memory.</p>
</div>
<div class="paragraph">
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code> and
<code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> are useful for accomplishing layout
transitions and queue ownership operations when the required execution
dependency is satisfied by other means - for example, semaphore operations
between queues.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineStageFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkPipelineStageFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineStageFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>.</p>
</div>
</div>
</div>
<div id="synchronization-pipeline-stages-masks" class="paragraph">
<p>If a synchronization command includes a source stage mask, its first
<a href="#synchronization-dependencies-scopes">synchronization scope</a> only includes
execution of the pipeline stages specified in that mask, and its first
<a href="#synchronization-dependencies-access-scopes">access scope</a> only includes
memory access performed by pipeline stages specified in that mask.
If a synchronization command includes a destination stage mask, its second
<a href="#synchronization-dependencies-scopes">synchronization scope</a> only includes
execution of the pipeline stages specified in that mask, and its second
<a href="#synchronization-dependencies-access-scopes">access scope</a> only includes
memory access performed by pipeline stages specified in that mask.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Including a particular pipeline stage in the first
<a href="#synchronization-dependencies-scopes">synchronization scope</a> of a command
implicitly includes <a href="#synchronization-pipeline-stages-order">logically
earlier</a> pipeline stages in the synchronization scope.
Similarly, the second <a href="#synchronization-dependencies-scopes">synchronization
scope</a> includes <a href="#synchronization-pipeline-stages-order">logically later</a>
pipeline stages.</p>
</div>
<div class="paragraph">
<p>However, note that <a href="#synchronization-dependencies-access-scopes">access
scopes</a> are not affected in this way - only the precise stages specified
are considered part of each access scope.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Certain pipeline stages are only available on queues that support a
particular set of operations.
The following table lists, for each pipeline stage flag, which queue
capability flag <strong class="purple">must</strong> be supported by the queue.
When multiple flags are enumerated in the second column of the table, it
means that the pipeline stage is supported on the queue if it supports any
of the listed capability flags.
For further details on queue capabilities see
<a href="#devsandqueues-physical-device-enumeration">Physical Device Enumeration</a>
and <a href="#devsandqueues-queues">Queues</a>.</p>
</div>
<table id="synchronization-pipeline-stages-supported" class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Supported pipeline stage flags</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pipeline stage flag</th>
<th class="tableblock halign-left valign-top">Required queue capability flag</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code>, <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_HOST_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
</tbody>
</table>
<div id="synchronization-pipeline-stages-order" class="paragraph">
<p>Pipeline stages that execute as a result of a command logically complete
execution in a specific order, such that completion of a logically later
pipeline stage <strong class="purple">must</strong> not happen-before completion of a logically earlier
stage.
This means that including any stage in the source stage mask for a
particular synchronization command also implies that any logically earlier
stages are included in <strong>A<sub>S</sub></strong> for that command.</p>
</div>
<div class="paragraph">
<p>Similarly, initiation of a logically earlier pipeline stage <strong class="purple">must</strong> not
happen-after initiation of a logically later pipeline stage.
Including any given stage in the destination stage mask for a particular
synchronization command also implies that any logically later stages are
included in <strong>B<sub>S</sub></strong> for that command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> not support synchronization at every pipeline stage for
every synchronization operation.
If a pipeline stage that an implementation does not support synchronization
for appears in a source stage mask, it <strong class="purple">may</strong> substitute any logically later
stage in its place for the first synchronization scope.
If a pipeline stage that an implementation does not support synchronization
for appears in a destination stage mask, it <strong class="purple">may</strong> substitute any logically
earlier stage in its place for the second synchronization scope.</p>
</div>
<div class="paragraph">
<p>For example, if an implementation is unable to signal an event immediately
after vertex shader execution is complete, it <strong class="purple">may</strong> instead signal the event
after color attachment output has completed.</p>
</div>
<div class="paragraph">
<p>If an implementation makes such a substitution, it <strong class="purple">must</strong> not affect the
semantics of execution or memory dependencies or image and buffer memory
barriers.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="synchronization-pipeline-stages-types" class="paragraph">
<p>The order and set of pipeline stages executed by a given command is
determined by the command&#8217;s pipeline type, as described below:</p>
</div>
<div class="paragraph">
<p>For the graphics pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the compute pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the transfer pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For host operations, only one pipeline stage occurs, so no order is
guaranteed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-access-types">6.1.3. Access Types</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Memory in Vulkan <strong class="purple">can</strong> be accessed from within shader invocations and via
some fixed-function stages of the pipeline.
The <em>access type</em> is a function of the <a href="#descriptorsets">descriptor type</a>
used, or how a fixed-function stage accesses memory.
Each access type corresponds to a bit flag in <a href="#VkAccessFlagBits">VkAccessFlagBits</a>.</p>
</div>
<div id="synchronization-access-masks" class="paragraph">
<p>Some synchronization commands take sets of access types as parameters to
define the <a href="#synchronization-dependencies-access-scopes">access scopes</a> of
a memory dependency.
If a synchronization command includes a source access mask, its first
<a href="#synchronization-dependencies-access-scopes">access scope</a> only includes
accesses via the access types specified in that mask.
Similarly, if a synchronization command includes a destination access mask,
its second <a href="#synchronization-dependencies-access-scopes">access scope</a> only
includes accesses via the access types specified in that mask.</p>
</div>
<div class="paragraph">
<p>Access types that <strong class="purple">can</strong> be set in an access mask include:</p>
</div>
<div id="VkAccessFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkAccessFlagBits {
    VK_ACCESS_INDIRECT_COMMAND_READ_BIT = <span class="hex">0x00000001</span>,
    VK_ACCESS_INDEX_READ_BIT = <span class="hex">0x00000002</span>,
    VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT = <span class="hex">0x00000004</span>,
    VK_ACCESS_UNIFORM_READ_BIT = <span class="hex">0x00000008</span>,
    VK_ACCESS_INPUT_ATTACHMENT_READ_BIT = <span class="hex">0x00000010</span>,
    VK_ACCESS_SHADER_READ_BIT = <span class="hex">0x00000020</span>,
    VK_ACCESS_SHADER_WRITE_BIT = <span class="hex">0x00000040</span>,
    VK_ACCESS_COLOR_ATTACHMENT_READ_BIT = <span class="hex">0x00000080</span>,
    VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT = <span class="hex">0x00000100</span>,
    VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT = <span class="hex">0x00000200</span>,
    VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT = <span class="hex">0x00000400</span>,
    VK_ACCESS_TRANSFER_READ_BIT = <span class="hex">0x00000800</span>,
    VK_ACCESS_TRANSFER_WRITE_BIT = <span class="hex">0x00001000</span>,
    VK_ACCESS_HOST_READ_BIT = <span class="hex">0x00002000</span>,
    VK_ACCESS_HOST_WRITE_BIT = <span class="hex">0x00004000</span>,
    VK_ACCESS_MEMORY_READ_BIT = <span class="hex">0x00008000</span>,
    VK_ACCESS_MEMORY_WRITE_BIT = <span class="hex">0x00010000</span>,
} VkAccessFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code> specifies read access to an
indirect command structure read as part of an indirect drawing or
dispatch command.</p>
</li>
<li>
<p><code>VK_ACCESS_INDEX_READ_BIT</code> specifies read access to an index buffer
as part of an indexed drawing command, bound by
<a href="#vkCmdBindIndexBuffer">vkCmdBindIndexBuffer</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT</code> specifies read access to a
vertex buffer as part of a drawing command, bound by
<a href="#vkCmdBindVertexBuffers">vkCmdBindVertexBuffers</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_UNIFORM_READ_BIT</code> specifies read access to a
<a href="#descriptorsets-uniformbuffer">uniform buffer</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_INPUT_ATTACHMENT_READ_BIT</code> specifies read access to an
<a href="#renderpass">input attachment</a> within a render pass during fragment
shading.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADER_READ_BIT</code> specifies read access to a
<a href="#descriptorsets-storagebuffer">storage buffer</a>,
<a href="#descriptorsets-uniformtexelbuffer">uniform texel buffer</a>,
<a href="#descriptorsets-storagetexelbuffer">storage texel buffer</a>,
<a href="#descriptorsets-sampledimage">sampled image</a>, or
<a href="#descriptorsets-storageimage">storage image</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADER_WRITE_BIT</code> specifies write access to a
<a href="#descriptorsets-storagebuffer">storage buffer</a>,
<a href="#descriptorsets-storagetexelbuffer">storage texel buffer</a>, or
<a href="#descriptorsets-storageimage">storage image</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code> specifies read access to a
<a href="#renderpass">color attachment</a>, such as via <a href="#framebuffer-blending">blending</a>, <a href="#framebuffer-logicop">logic operations</a>, or via certain
<a href="#renderpass-load-store-ops">subpass load operations</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code> specifies write access to a
<a href="#renderpass">color or resolve attachment</a> during a <a href="#renderpass">render pass</a> or via certain <a href="#renderpass-load-store-ops">subpass load
and store operations</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code> specifies read access
to a <a href="#renderpass">depth/stencil attachment</a>, via <a href="#fragops-ds-state">depth or stencil operations</a> or via certain
<a href="#renderpass-load-store-ops">subpass load operations</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code> specifies write
access to a <a href="#renderpass">depth/stencil attachment</a>, via
<a href="#fragops-ds-state">depth or stencil operations</a> or via certain
<a href="#renderpass-load-store-ops">subpass load and store operations</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFER_READ_BIT</code> specifies read access to an image or
buffer in a <a href="#copies">copy</a> operation.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFER_WRITE_BIT</code> specifies write access to an image or
buffer in a <a href="#clears">clear</a> or <a href="#copies">copy</a> operation.</p>
</li>
<li>
<p><code>VK_ACCESS_HOST_READ_BIT</code> specifies read access by a host operation.
Accesses of this type are not performed through a resource, but directly
on memory.</p>
</li>
<li>
<p><code>VK_ACCESS_HOST_WRITE_BIT</code> specifies write access by a host
operation.
Accesses of this type are not performed through a resource, but directly
on memory.</p>
</li>
<li>
<p><code>VK_ACCESS_MEMORY_READ_BIT</code> specifies read access via non-specific
entities.
These entities include the Vulkan device and host, but <strong class="purple">may</strong> also include
entities external to the Vulkan device or otherwise not part of the core
Vulkan pipeline.
When included in a destination access mask, makes all available writes
visible to all future read accesses on entities known to the Vulkan
device.</p>
</li>
<li>
<p><code>VK_ACCESS_MEMORY_WRITE_BIT</code> specifies write access via non-specific
entities.
These entities include the Vulkan device and host, but <strong class="purple">may</strong> also include
entities external to the Vulkan device or otherwise not part of the core
Vulkan pipeline.
When included in a source access mask, all writes that are performed by
entities known to the Vulkan device are made available.
When included in a destination access mask, makes all available writes
visible to all future write accesses on entities known to the Vulkan
device.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain access types are only performed by a subset of pipeline stages.
Any synchronization command that takes both stage masks and access masks
uses both to define the <a href="#synchronization-dependencies-access-scopes">access
scopes</a> - only the specified access types performed by the specified stages
are included in the access scope.
An application <strong class="purple">must</strong> not specify an access flag in a synchronization command
if it does not include a pipeline stage in the corresponding stage mask that
is able to perform accesses of that type.
The following table lists, for each access flag, which pipeline stages <strong class="purple">can</strong>
perform that type of access.</p>
</div>
<table id="synchronization-access-types-supported" class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Supported access types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access flag</th>
<th class="tableblock halign-left valign-top">Supported pipeline stages</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_INDEX_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_UNIFORM_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>, or <code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_SHADER_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>, or <code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_SHADER_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>, or <code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_INPUT_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code>, or <code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code>, or <code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_TRANSFER_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_TRANSFER_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_HOST_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_HOST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_HOST_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_HOST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_MEMORY_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_MEMORY_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
</tr>
</tbody>
</table>
<div id="synchronization-host-access-types" class="paragraph">
<p>If a memory object does not have the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> property, then
<a href="#vkFlushMappedMemoryRanges">vkFlushMappedMemoryRanges</a> <strong class="purple">must</strong> be called in order to guarantee that
writes to the memory object from the host are made available to the host
domain, where they <strong class="purple">can</strong> be further made available to the device domain via a
domain operation.
Similarly, <a href="#vkInvalidateMappedMemoryRanges">vkInvalidateMappedMemoryRanges</a> <strong class="purple">must</strong> be called to guarantee
that writes which are available to the host domain are made visible to host
operations.</p>
</div>
<div class="paragraph">
<p>If the memory object does have the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> property flag, writes to the
memory object from the host are automatically made available to the host
domain.
Similarly, writes made available to the host domain are automatically made
visible to the host.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <a href="#vkQueueSubmit">vkQueueSubmit</a> command <a href="#synchronization-submission-host-writes">automatically performs a domain operation from host to device</a> for all
writes performed before the command executes, so in most cases an explicit
memory barrier is not needed for this case.
In the few circumstances where a submit does not occur between the host
write and the device read access, writes <strong class="purple">can</strong> be made available by using an
explicit memory barrier.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAccessFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkAccessFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkAccessFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkAccessFlagBits">VkAccessFlagBits</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-framebuffer-regions">6.1.4. Framebuffer Region Dependencies</h4>
<div class="paragraph">
<p><a href="#synchronization-pipeline-stages">Pipeline stages</a> that operate on, or
with respect to, the framebuffer are collectively the <em>framebuffer-space</em>
pipeline stages.
These stages are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For these pipeline stages, an execution or memory dependency from the first
set of operations to the second set <strong class="purple">can</strong> either be a single
<em>framebuffer-global</em> dependency, or split into multiple <em>framebuffer-local</em>
dependencies.
A dependency with non-framebuffer-space pipeline stages is neither
framebuffer-global nor framebuffer-local.</p>
</div>
<div class="paragraph">
<p>A <em>framebuffer region</em> is a set of sample (x, y, layer, sample) coordinates
that is a subset of the entire framebuffer.</p>
</div>
<div class="paragraph">
<p>Both <a href="#synchronization-dependencies-scopes">synchronization scopes</a> of a
framebuffer-local dependency include only the operations performed within
corresponding framebuffer regions (as defined below).
No ordering guarantees are made between different framebuffer regions for a
framebuffer-local dependency.</p>
</div>
<div class="paragraph">
<p>Both <a href="#synchronization-dependencies-scopes">synchronization scopes</a> of a
framebuffer-global dependency include operations on all framebuffer-regions.</p>
</div>
<div class="paragraph">
<p>If the first synchronization scope includes operations on pixels/fragments
with N samples and the second synchronization scope includes operations on
pixels/fragments with M samples, where N does not equal M, then a
framebuffer region containing all samples at a given (x, y, layer)
coordinate in the first synchronization scope corresponds to a region
containing all samples at the same coordinate in the second synchronization
scope.
In other words, it is a pixel granularity dependency.
If N equals M, then a framebuffer region containing a single (x, y, layer,
sample) coordinate in the first synchronization scope corresponds to a
region containing the same sample at the same coordinate in the second
synchronization scope.
In other words, it is a sample granularity dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Since fragment invocations are not specified to run in any particular
groupings, the size of a framebuffer region is implementation-dependent, not
known to the application, and <strong class="purple">must</strong> be assumed to be no larger than
specified above.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Practically, the pixel vs sample granularity dependency means that if an
input attachment has a different number of samples than the pipeline&#8217;s
<code>rasterizationSamples</code>, then a fragment <strong class="purple">can</strong> access any sample in the
input attachment&#8217;s pixel even if it only uses framebuffer-local
dependencies.
If the input attachment has the same number of samples, then the fragment
<strong class="purple">can</strong> only access the covered samples in its input <code>SampleMask</code> (i.e. the
fragment operations happen-after a framebuffer-local dependency for each
sample the fragment covers).
To access samples that are not covered, a framebuffer-global dependency is
required.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter, and
specifies the <code>VK_DEPENDENCY_BY_REGION_BIT</code> flag, then it defines
framebuffer-local dependencies for the framebuffer-space pipeline stages in
that synchronization command, for all framebuffer regions.
If no <code>dependencyFlags</code> parameter is included, or the
<code>VK_DEPENDENCY_BY_REGION_BIT</code> flag is not specified, then a
framebuffer-global dependency is specified for those stages.
The <code>VK_DEPENDENCY_BY_REGION_BIT</code> flag does not affect the dependencies
between non-framebuffer-space pipeline stages, nor does it affect the
dependencies between framebuffer-space and non-framebuffer-space pipeline
stages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Framebuffer-local dependencies are more optimal for most architectures;
particularly tile-based architectures - which can keep framebuffer-regions
entirely in on-chip registers and thus avoid external bandwidth across such
a dependency.
Including a framebuffer-global dependency in your rendering will usually
force all implementations to flush data to memory, or to a higher level
cache, breaking any potential locality optimizations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-implicit">6.2. Implicit Synchronization Guarantees</h3>
<div class="paragraph">
<p>A small number of implicit ordering guarantees are provided by Vulkan,
ensuring that the order in which commands are submitted is meaningful, and
avoiding unnecessary complexity in common operations.</p>
</div>
<div id="synchronization-submission-order" class="paragraph">
<p><em>Submission order</em> is a fundamental ordering in Vulkan, giving meaning to
the order in which <a href="#fundamentals-queueoperation-command-types">action and
synchronization commands</a> are recorded and submitted to a single queue.
Explicit and implicit ordering guarantees between commands in Vulkan all
work on the premise that this ordering is meaningful.
This order does not itself define any execution or memory dependencies;
synchronization commands and other orderings within the API use this
ordering to define their scopes.</p>
</div>
<div class="paragraph">
<p>Submission order for any given set of commands is based on the order in
which they were recorded to command buffers and then submitted.
This order is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The initial order is determined by the order in which
<a href="#vkQueueSubmit">vkQueueSubmit</a> commands are executed on the host, for a single
queue, from first to last.</p>
</li>
<li>
<p>The order in which <a href="#VkSubmitInfo">VkSubmitInfo</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="#vkQueueSubmit">vkQueueSubmit</a>, from lowest index to
highest.</p>
</li>
<li>
<p>The order in which command buffers are specified in the
<code>pCommandBuffers</code> member of <a href="#VkSubmitInfo">VkSubmitInfo</a>, from lowest index to
highest.</p>
</li>
<li>
<p>The order in which commands were recorded to a command buffer on the
host, from first to last:</p>
<div class="ulist">
<ul>
<li>
<p>For commands recorded outside a render pass, this includes all other
commands recorded outside a render pass, including
<a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a> and <a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a> commands; it
does not directly include commands inside a render pass.</p>
</li>
<li>
<p>For commands recorded inside a render pass, this includes all other
commands recorded inside the same subpass, including the
<a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a> and <a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a> commands that
delimit the same render pass instance; it does not include commands
recorded to other subpasses.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="#fundamentals-queueoperation-command-types">Action and synchronization
commands</a> recorded to a command buffer execute the
<code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> pipeline stage in
<a href="#synchronization-submission-order">submission order</a> - forming an implicit
execution dependency between this stage in each command.</p>
</div>
<div class="paragraph">
<p><a href="#fundamentals-queueoperation-command-types">State commands</a> do not execute
any operations on the device, instead they set the state of the command
buffer when they execute on the host, in the order that they are recorded.
<a href="#fundamentals-queueoperation-command-types">Action commands</a> consume the
current state of the command buffer when they are recorded, and will execute
state changes on the device as required to match the recorded state.</p>
</div>
<div class="paragraph">
<p><a href="#queries-order">Query commands</a>, <a href="#drawing-primitive-order">the order of
primitives passing through the graphics pipeline</a> and
<a href="#synchronization-image-barrier-layout-transition-order">image layout
transitions as part of an image memory barrier</a> provide additional
guarantees based on submission order.</p>
</div>
<div class="paragraph">
<p>Execution of <a href="#synchronization-pipeline-stages-order">pipeline stages</a>
within a given command also has a loose ordering, dependent only on a single
command.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-fences">6.3. Fences</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Fences are a synchronization primitive that <strong class="purple">can</strong> be used to insert a
dependency from a queue to the host.
Fences have two states - signaled and unsignaled.
A fence <strong class="purple">can</strong> be signaled as part of the execution of a
<a href="#devsandqueues-submission">queue submission</a> command.
Fences <strong class="purple">can</strong> be unsignaled on the host with <a href="#vkResetFences">vkResetFences</a>.
Fences <strong class="purple">can</strong> be waited on by the host with the <a href="#vkWaitForFences">vkWaitForFences</a> command,
and the current state <strong class="purple">can</strong> be queried with <a href="#vkGetFenceStatus">vkGetFenceStatus</a>.</p>
</div>
<div class="paragraph">
<p>Fences are represented by <code>VkFence</code> handles:</p>
</div>
<div id="VkFence" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkFence)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence, call:</p>
</div>
<div id="vkCreateFence" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateFence(
    VkDevice                                    device,
    <span class="directive">const</span> VkFenceCreateInfo*                    pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkFence*                                    pFence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the fence.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkFenceCreateInfo</code> structure which contains information about how
the fence is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pFence</code> points to a handle in which the resulting fence object is
returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateFence-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkFenceCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pFence-parameter"></a> <code>pFence</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkFence</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFenceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkFenceCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkFenceCreateInfo {
    VkStructureType       sType;
    <span class="directive">const</span> <span class="directive">void</span>*           pNext;
    VkFenceCreateFlags    flags;
} VkFenceCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a> specifying the
initial state and behavior of the fence.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_FENCE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceCreateFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkFenceCreateFlagBits {
    VK_FENCE_CREATE_SIGNALED_BIT = <span class="hex">0x00000001</span>,
} VkFenceCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_FENCE_CREATE_SIGNALED_BIT</code> specifies that the fence object is
created in the signaled state.
Otherwise, it is created in the unsignaled state.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkFenceCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkFenceCreateFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a fence, call:</p>
</div>
<div id="vkDestroyFence" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyFence(
    VkDevice                                    device,
    VkFence                                     fence,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the fence.</p>
</li>
<li>
<p><code>fence</code> is the handle of the fence to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFence-fence-01120"></a>
All <a href="#devsandqueues-submission">queue submission</a> commands that refer
to <code>fence</code> <strong class="purple">must</strong> have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-01121"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>fence</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-01122"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>fence</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFence-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-parameter"></a> If <code>fence</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>fence</code> <strong class="purple">must</strong> be a valid <code>VkFence</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-parent"></a> If <code>fence</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>fence</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the status of a fence from the host, call:</p>
</div>
<div id="vkGetFenceStatus" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetFenceStatus(
    VkDevice                                    device,
    VkFence                                     fence);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fence.</p>
</li>
<li>
<p><code>fence</code> is the handle of the fence to query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon success, <code>vkGetFenceStatus</code> returns the status of the fence object,
with the following return codes:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 5. Fence Object Status Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_SUCCESS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fence specified by <code>fence</code> is signaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_NOT_READY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fence specified by <code>fence</code> is unsignaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ERROR_DEVICE_LOST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The device has been lost.  See <a href="#devsandqueues-lost-device">Lost Device</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a <a href="#devsandqueues-submission">queue submission</a> command is pending
execution, then the value returned by this command <strong class="purple">may</strong> immediately be out
of date.</p>
</div>
<div class="paragraph">
<p>If the device has been lost (see <a href="#devsandqueues-lost-device">Lost Device</a>),
<code>vkGetFenceStatus</code> <strong class="purple">may</strong> return any of the above status codes.
If the device has been lost and <code>vkGetFenceStatus</code> is called repeatedly,
it will eventually return either <code>VK_SUCCESS</code> or
<code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetFenceStatus-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceStatus-fence-parameter"></a> <code>fence</code> <strong class="purple">must</strong> be a valid <code>VkFence</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceStatus-fence-parent"></a> <code>fence</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_NOT_READY</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-unsignaling" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of fences to unsignaled from the host, call:</p>
</div>
<div id="vkResetFences" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkResetFences(
    VkDevice                                    device,
    uint32_t                                    fenceCount,
    <span class="directive">const</span> VkFence*                              pFences);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fences.</p>
</li>
<li>
<p><code>fenceCount</code> is the number of fences to reset.</p>
</li>
<li>
<p><code>pFences</code> is a pointer to an array of fence handles to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkResetFences">vkResetFences</a> is executed on the host, it defines a <em>fence
unsignal operation</em> for each fence, which resets the fence to the unsignaled
state.</p>
</div>
<div class="paragraph">
<p>If any member of <code>pFences</code> is already in the unsignaled state when
<a href="#vkResetFences">vkResetFences</a> is executed, then <a href="#vkResetFences">vkResetFences</a> has no effect on
that fence.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetFences-pFences-01123"></a>
Each element of <code>pFences</code> <strong class="purple">must</strong> not be currently associated with any
queue command that has not yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetFences-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkResetFences-pFences-parameter"></a> <code>pFences</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>fenceCount</code> valid <code>VkFence</code> handles</p>
</li>
<li>
<p><a id="VUID-vkResetFences-fenceCount-arraylength"></a> <code>fenceCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkResetFences-pFences-parent"></a> Each element of <code>pFences</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to each member of <code>pFences</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-signaling" class="paragraph">
<p>When a fence is submitted to a queue as part of a
<a href="#devsandqueues-submission">queue submission</a> command, it defines a memory
dependency on the batches that were submitted as part of that command, and
defines a <em>fence signal operation</em> which sets the fence to the signaled
state.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes every batch submitted in the same <a href="#devsandqueues-submission">queue
submission</a> command.
Fence signal operations that are defined by <a href="#vkQueueSubmit">vkQueueSubmit</a> additionally
include in the first synchronization scope all commands that occur earlier
in <a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
only includes the fence signal operation.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more fences to enter the signaled state on the host,
call:</p>
</div>
<div id="vkWaitForFences" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkWaitForFences(
    VkDevice                                    device,
    uint32_t                                    fenceCount,
    <span class="directive">const</span> VkFence*                              pFences,
    VkBool32                                    waitAll,
    uint64_t                                    timeout);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fences.</p>
</li>
<li>
<p><code>fenceCount</code> is the number of fences to wait on.</p>
</li>
<li>
<p><code>pFences</code> is a pointer to an array of <code>fenceCount</code> fence
handles.</p>
</li>
<li>
<p><code>waitAll</code> is the condition that <strong class="purple">must</strong> be satisfied to successfully
unblock the wait.
If <code>waitAll</code> is <code>VK_TRUE</code>, then the condition is that all fences
in <code>pFences</code> are signaled.
Otherwise, the condition is that at least one fence in <code>pFences</code> is
signaled.</p>
</li>
<li>
<p><code>timeout</code> is the timeout period in units of nanoseconds.
<code>timeout</code> is adjusted to the closest value allowed by the
implementation-dependent timeout accuracy, which <strong class="purple">may</strong> be substantially
longer than one nanosecond, and <strong class="purple">may</strong> be longer than the requested
period.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the condition is satisfied when <code>vkWaitForFences</code> is called, then
<code>vkWaitForFences</code> returns immediately.
If the condition is not satisfied at the time <code>vkWaitForFences</code> is
called, then <code>vkWaitForFences</code> will block and wait up to <code>timeout</code>
nanoseconds for the condition to become satisfied.</p>
</div>
<div class="paragraph">
<p>If <code>timeout</code> is zero, then <code>vkWaitForFences</code> does not wait, but
simply returns the current state of the fences.
<code>VK_TIMEOUT</code> will be returned in this case if the condition is not
satisfied, even though no actual wait was performed.</p>
</div>
<div class="paragraph">
<p>If the specified timeout period expires before the condition is satisfied,
<code>vkWaitForFences</code> returns <code>VK_TIMEOUT</code>.
If the condition is satisfied before <code>timeout</code> nanoseconds has expired,
<code>vkWaitForFences</code> returns <code>VK_SUCCESS</code>.</p>
</div>
<div class="paragraph">
<p>If device loss occurs (see <a href="#devsandqueues-lost-device">Lost Device</a>) before
the timeout has expired, <code>vkWaitForFences</code> <strong class="purple">must</strong> return in finite time
with either <code>VK_SUCCESS</code> or <code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>While we guarantee that <code>vkWaitForFences</code> <strong class="purple">must</strong> return in finite time,
no guarantees are made that it returns immediately upon device loss.
However, the client can reasonably expect that the delay will be on the
order of seconds and that calling <code>vkWaitForFences</code> will not result in a
permanently (or seemingly permanently) dead process.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWaitForFences-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-pFences-parameter"></a> <code>pFences</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>fenceCount</code> valid <code>VkFence</code> handles</p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-fenceCount-arraylength"></a> <code>fenceCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-pFences-parent"></a> Each element of <code>pFences</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_TIMEOUT</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-waiting" class="paragraph">
<p>An execution dependency is defined by waiting for a fence to become
signaled, either via <a href="#vkWaitForFences">vkWaitForFences</a> or by polling on
<a href="#vkGetFenceStatus">vkGetFenceStatus</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the fence signal operation.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes the host operations of <a href="#vkWaitForFences">vkWaitForFences</a> or
<a href="#vkGetFenceStatus">vkGetFenceStatus</a> indicating that the fence has become signaled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Signaling a fence and waiting on the host does not guarantee that the
results of memory accesses will be visible to the host, as the access scope
of a memory dependency defined by a fence only includes device access.
A <a href="#synchronization-memory-barriers">memory barrier</a> or other memory
dependency <strong class="purple">must</strong> be used to guarantee this.
See the description of <a href="#synchronization-host-access-types">host access
types</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores">6.4. Semaphores</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Semaphores are a synchronization primitive that <strong class="purple">can</strong> be used to insert a
dependency between batches submitted to queues.
Semaphores have two states - signaled and unsignaled.
The state of a semaphore <strong class="purple">can</strong> be signaled after execution of a batch of
commands is completed.
A batch <strong class="purple">can</strong> wait for a semaphore to become signaled before it begins
execution, and the semaphore is also unsignaled before the batch begins
execution.</p>
</div>
<div class="paragraph">
<p>Semaphores are represented by <code>VkSemaphore</code> handles:</p>
</div>
<div id="VkSemaphore" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkSemaphore)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a semaphore, call:</p>
</div>
<div id="vkCreateSemaphore" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateSemaphore(
    VkDevice                                    device,
    <span class="directive">const</span> VkSemaphoreCreateInfo*                pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkSemaphore*                                pSemaphore);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the semaphore.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkSemaphoreCreateInfo</code> structure which contains information about
how the semaphore is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pSemaphore</code> points to a handle in which the resulting semaphore
object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When created, the semaphore is in the unsignaled state.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateSemaphore-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkSemaphoreCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pSemaphore-parameter"></a> <code>pSemaphore</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkSemaphore</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkSemaphoreCreateInfo {
    VkStructureType           sType;
    <span class="directive">const</span> <span class="directive">void</span>*               pNext;
    VkSemaphoreCreateFlags    flags;
} VkSemaphoreCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSemaphoreCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkSemaphoreCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSemaphoreCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a semaphore, call:</p>
</div>
<div id="vkDestroySemaphore" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroySemaphore(
    VkDevice                                    device,
    VkSemaphore                                 semaphore,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the semaphore.</p>
</li>
<li>
<p><code>semaphore</code> is the handle of the semaphore to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01137"></a>
All submitted batches that refer to <code>semaphore</code> <strong class="purple">must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01138"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>semaphore</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01139"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>semaphore</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroySemaphore-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-parameter"></a> If <code>semaphore</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>semaphore</code> <strong class="purple">must</strong> be a valid <code>VkSemaphore</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-parent"></a> If <code>semaphore</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>semaphore</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-signaling">6.4.1. Semaphore Signaling</h4>
<div class="paragraph">
<p>When a batch is submitted to a queue via a <a href="#devsandqueues-submission">queue
submission</a>, and it includes semaphores to be signaled, it defines a memory
dependency on the batch, and defines <em>semaphore signal operations</em> which set
the semaphores to the signaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes every command submitted in the same batch.
Semaphore signal operations that are defined by <a href="#vkQueueSubmit">vkQueueSubmit</a>
additionally include all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the semaphore signal operation.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-waiting">6.4.2. Semaphore Waiting &amp; Unsignaling</h4>
<div class="paragraph">
<p>When a batch is submitted to a queue via a <a href="#devsandqueues-submission">queue
submission</a>, and it includes semaphores to be waited on, it defines a
memory dependency between prior semaphore signal operations and the batch,
and defines <em>semaphore unsignal operations</em> which set the semaphores to the
unsignaled state.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope includes all semaphore signal operations
that operate on semaphores waited on in the same batch, and that
happen-before the wait completes.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes every command submitted in the same batch.
In the case of <a href="#vkQueueSubmit">vkQueueSubmit</a>, the second synchronization scope is
limited to operations on the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by the corresponding element of <code>pWaitDstStageMask</code>.
Also, in the case of <a href="#vkQueueSubmit">vkQueueSubmit</a>, the second synchronization scope
additionally includes all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The semaphore unsignal operation happens-after the first set of operations
in the execution dependency, and happens-before the second set of operations
in the execution dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Unlike fences or events, the act of waiting for a semaphore also unsignals
that semaphore.
If two operations are separately specified to wait for the same semaphore,
and there are no other execution dependencies between those operations,
behaviour is undefined.
An execution dependency <strong class="purple">must</strong> be present that guarantees that the semaphore
unsignal operation for the first of those waits, happens-before the
semaphore is signalled again, and before the second unsignal operation.
Semaphore waits and signals should thus occur in discrete 1:1 pairs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-waiting-state">6.4.3. Semaphore State Requirements For Wait Operations</h4>
<div class="paragraph">
<p>Before waiting on a semaphore, the application <strong class="purple">must</strong> ensure the semaphore is
in a valid state for a wait operation.
Specifically, when a <a href="#synchronization-semaphores-waiting">semaphore wait and
unsignal operation</a> is submitted to a queue:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The semaphore <strong class="purple">must</strong> be signaled, or have an associated
<a href="#synchronization-semaphores-signaling">semaphore signal operation</a> that
is pending execution.</p>
</li>
<li>
<p>There <strong class="purple">must</strong> be no other queue waiting on the same semaphore when the
operation executes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-events">6.5. Events</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Events are a synchronization primitive that <strong class="purple">can</strong> be used to insert a
fine-grained dependency between commands submitted to the same queue, or
between the host and a queue.
Events <strong class="purple">must</strong> not be used to insert a dependency between commands submitted
to different queues.
Events have two states - signaled and unsignaled.
An application <strong class="purple">can</strong> signal an event, or unsignal it, on either the host or
the device.
A device <strong class="purple">can</strong> wait for an event to become signaled before executing further
operations.
No command exists to wait for an event to become signaled on the host, but
the current state of an event <strong class="purple">can</strong> be queried.</p>
</div>
<div class="paragraph">
<p>Events are represented by <code>VkEvent</code> handles:</p>
</div>
<div id="VkEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkEvent)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create an event, call:</p>
</div>
<div id="vkCreateEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateEvent(
    VkDevice                                    device,
    <span class="directive">const</span> VkEventCreateInfo*                    pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkEvent*                                    pEvent);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the event.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkEventCreateInfo</code> structure which contains information about how
the event is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pEvent</code> points to a handle in which the resulting event object is
returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When created, the event object is in the unsignaled state.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateEvent-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkEventCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pEvent-parameter"></a> <code>pEvent</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkEvent</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkEventCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkEventCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkEventCreateInfo {
    VkStructureType       sType;
    <span class="directive">const</span> <span class="directive">void</span>*           pNext;
    VkEventCreateFlags    flags;
} VkEventCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkEventCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EVENT_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkEventCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkEventCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkEventCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy an event, call:</p>
</div>
<div id="vkDestroyEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyEvent(
    VkDevice                                    device,
    VkEvent                                     event,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the event.</p>
</li>
<li>
<p><code>event</code> is the handle of the event to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyEvent-event-01145"></a>
All submitted commands that refer to <code>event</code> <strong class="purple">must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-01146"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>event</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-01147"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>event</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyEvent-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-parameter"></a> If <code>event</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>event</code> <strong class="purple">must</strong> be a valid <code>VkEvent</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-parent"></a> If <code>event</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the state of an event from the host, call:</p>
</div>
<div id="vkGetEventStatus" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetEventStatus(
    VkDevice                                    device,
    VkEvent                                     event);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the handle of the event to query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon success, <code>vkGetEventStatus</code> returns the state of the event object
with the following return codes:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 6. Event Object Status Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EVENT_SET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event specified by <code>event</code> is signaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EVENT_RESET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event specified by <code>event</code> is unsignaled.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a <code>vkCmdSetEvent</code> or <code>vkCmdResetEvent</code> command is in a command
buffer that is in the <a href="#commandbuffers-lifecycle">pending state</a>, then the
value returned by this command <strong class="purple">may</strong> immediately be out of date.</p>
</div>
<div class="paragraph">
<p>The state of an event <strong class="purple">can</strong> be updated by the host.
The state of the event is immediately changed, and subsequent calls to
<code>vkGetEventStatus</code> will return the new state.
If an event is already in the requested state, then updating it to the same
state has no effect.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEventStatus-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEventStatus-event-parameter"></a> <code>event</code> <strong class="purple">must</strong> be a valid <code>VkEvent</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEventStatus-event-parent"></a> <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_EVENT_SET</code></p>
</li>
<li>
<p><code>VK_EVENT_RESET</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-events-signaling-host" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to signaled from the host, call:</p>
</div>
<div id="vkSetEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkSetEvent(
    VkDevice                                    device,
    VkEvent                                     event);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the event to set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkSetEvent">vkSetEvent</a> is executed on the host, it defines an <em>event signal
operation</em> which sets the event to the signaled state.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the signaled state when <a href="#vkSetEvent">vkSetEvent</a> is
executed, then <a href="#vkSetEvent">vkSetEvent</a> has no effect, and no event signal operation
occurs.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkSetEvent-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkSetEvent-event-parameter"></a> <code>event</code> <strong class="purple">must</strong> be a valid <code>VkEvent</code> handle</p>
</li>
<li>
<p><a id="VUID-vkSetEvent-event-parent"></a> <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-events-unsignaling-host" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to unsignaled from the host, call:</p>
</div>
<div id="vkResetEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkResetEvent(
    VkDevice                                    device,
    VkEvent                                     event);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the event to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkResetEvent">vkResetEvent</a> is executed on the host, it defines an <em>event
unsignal operation</em> which resets the event to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the unsignaled state when <a href="#vkResetEvent">vkResetEvent</a> is
executed, then <a href="#vkResetEvent">vkResetEvent</a> has no effect, and no event unsignal
operation occurs.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetEvent-event-01148"></a>
<code>event</code> <strong class="purple">must</strong> not be waited on by a <code>vkCmdWaitEvents</code> command
that is currently executing</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetEvent-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-parameter"></a> <code>event</code> <strong class="purple">must</strong> be a valid <code>VkEvent</code> handle</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-parent"></a> <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The state of an event <strong class="purple">can</strong> also be updated on the device by commands
inserted in command buffers.</p>
</div>
<div id="synchronization-events-signaling-device" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to signaled from a device, call:</p>
</div>
<div id="vkCmdSetEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdSetEvent(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    VkPipelineStageFlags                        stageMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be signaled.</p>
</li>
<li>
<p><code>stageMask</code> specifies the <a href="#synchronization-pipeline-stages">source
stage mask</a> used to determine when the <code>event</code> is signaled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdSetEvent">vkCmdSetEvent</a> is submitted to a queue, it defines an execution
dependency on commands that were submitted before it, and defines an event
signal operation which sets the event to the signaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations on the pipeline stages
determined by the <a href="#synchronization-pipeline-stages-masks">source stage
mask</a> specified by <code>stageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the event signal operation.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the signaled state when <a href="#vkCmdSetEvent">vkCmdSetEvent</a> is
executed on the device, then <a href="#vkCmdSetEvent">vkCmdSetEvent</a> has no effect, no event
signal operation occurs, and no execution dependency is generated.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-01149"></a>
<code>stageMask</code> <strong class="purple">must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-01150"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-01151"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-event-parameter"></a> <code>event</code> <strong class="purple">must</strong> be a valid <code>VkEvent</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-parameter"></a> <code>stageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-requiredbitmask"></a> <code>stageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commonparent"></a> Both of <code>commandBuffer</code>, and <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="synchronization-events-unsignaling-device" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to unsignaled from a device, call:</p>
</div>
<div id="vkCmdResetEvent" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdResetEvent(
    VkCommandBuffer                             commandBuffer,
    VkEvent                                     event,
    VkPipelineStageFlags                        stageMask);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be unsignaled.</p>
</li>
<li>
<p><code>stageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> specifying
the <a href="#synchronization-pipeline-stages">source stage mask</a> used to
determine when the <code>event</code> is unsignaled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdResetEvent">vkCmdResetEvent</a> is submitted to a queue, it defines an execution
dependency on commands that were submitted before it, and defines an event
unsignal operation which resets the event to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations on the pipeline stages
determined by the <a href="#synchronization-pipeline-stages-masks">source stage
mask</a> specified by <code>stageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes only the event unsignal operation.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the unsignaled state when <a href="#vkCmdResetEvent">vkCmdResetEvent</a>
is executed on the device, then <a href="#vkCmdResetEvent">vkCmdResetEvent</a> has no effect, no
event unsignal operation occurs, and no execution dependency is generated.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-01153"></a>
<code>stageMask</code> <strong class="purple">must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-01154"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-01155"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-01156"></a>
When this command executes, <code>event</code> <strong class="purple">must</strong> not be waited on by a
<code>vkCmdWaitEvents</code> command that is currently executing</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-parameter"></a> <code>event</code> <strong class="purple">must</strong> be a valid <code>VkEvent</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-parameter"></a> <code>stageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-requiredbitmask"></a> <code>stageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commonparent"></a> Both of <code>commandBuffer</code>, and <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more events to enter the signaled state on a device,
call:</p>
</div>
<div id="vkCmdWaitEvents" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdWaitEvents(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    eventCount,
    <span class="directive">const</span> VkEvent*                              pEvents,
    VkPipelineStageFlags                        srcStageMask,
    VkPipelineStageFlags                        dstStageMask,
    uint32_t                                    memoryBarrierCount,
    <span class="directive">const</span> VkMemoryBarrier*                      pMemoryBarriers,
    uint32_t                                    bufferMemoryBarrierCount,
    <span class="directive">const</span> VkBufferMemoryBarrier*                pBufferMemoryBarriers,
    uint32_t                                    imageMemoryBarrierCount,
    <span class="directive">const</span> VkImageMemoryBarrier*                 pImageMemoryBarriers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>eventCount</code> is the length of the <code>pEvents</code> array.</p>
</li>
<li>
<p><code>pEvents</code> is an array of event object handles to wait on.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages">source stage mask</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages">destination stage
mask</a>.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="#VkMemoryBarrier">VkMemoryBarrier</a>
structures.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWaitEvents</code> is submitted to a queue, it defines a memory
dependency between prior event signal operations on the same queue or the
host, and subsequent commands.
<code>vkCmdWaitEvents</code> <strong class="purple">must</strong> not be used to wait on event signal operations
occuring on other queues.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope only includes event signal operations that
operate on members of <code>pEvents</code>, and the operations that happened-before
the event signal operations.
Event signal operations performed by <a href="#vkCmdSetEvent">vkCmdSetEvent</a> that occur earlier
in <a href="#synchronization-submission-order">submission order</a> are included in the
first synchronization scope, if the <a href="#synchronization-pipeline-stages-order">logically latest</a> pipeline stage in their <code>stageMask</code> parameter is
<a href="#synchronization-pipeline-stages-order">logically earlier</a> than or equal
to the <a href="#synchronization-pipeline-stages-order">logically latest</a> pipeline
stage in <code>srcStageMask</code>.
Event signal operations performed by <a href="#vkSetEvent">vkSetEvent</a> are only included in
the first synchronization scope if <code>VK_PIPELINE_STAGE_HOST_BIT</code> is
included in <code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.
The second synchronization scope is limited to operations on the pipeline
stages determined by the <a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
Within that, the first access scope only includes the first access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the first access scope includes no
accesses.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
Within that, the second access scope only includes the second access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the second access scope includes
no accesses.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> is used with <a href="#vkCmdSetEvent">vkCmdSetEvent</a> to define a memory
dependency between two sets of action commands, roughly in the same way as
pipeline barriers, but split into two commands such that work between the
two <strong class="purple">may</strong> execute unhindered.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">should</strong> be careful to avoid race conditions when using events.
There is no direct ordering guarantee between a <a href="#vkCmdResetEvent">vkCmdResetEvent</a>
command and a <a href="#vkCmdWaitEvents">vkCmdWaitEvents</a> command submitted after it, so some
other execution dependency <strong class="purple">must</strong> be included between these commands (e.g. a
semaphore).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-01158"></a>
<code>srcStageMask</code> <strong class="purple">must</strong> be the bitwise OR of the <code>stageMask</code>
parameter used in previous calls to <code>vkCmdSetEvent</code> with any of the
members of <code>pEvents</code> and <code>VK_PIPELINE_STAGE_HOST_BIT</code> if any of
the members of <code>pEvents</code> was set using <code>vkSetEvent</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-01159"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-01160"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-01161"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-01162"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pEvents-01163"></a>
If <code>pEvents</code> includes one or more events that will be signaled by
<code>vkSetEvent</code> after <code>commandBuffer</code> has been submitted to a
queue, then <code>vkCmdWaitEvents</code> <strong class="purple">must</strong> not be called inside a render
pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-01164"></a>
Any pipeline stage included in <code>srcStageMask</code> or <code>dstStageMask</code>
<strong class="purple">must</strong> be supported by the capabilities of the queue family specified by
the <code>queueFamilyIndex</code> member of the <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a>.</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pMemoryBarriers-01165"></a>
Each element of <code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code> or
<code>pImageMemoryBarriers</code> <strong class="purple">must</strong> not have any access flag included in
its <code>srcAccessMask</code> member if that bit is not supported by any of
the pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access
types</a>.</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pMemoryBarriers-01166"></a>
Each element of <code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code> or
<code>pImageMemoryBarriers</code> <strong class="purple">must</strong> not have any access flag included in
its <code>dstAccessMask</code> member if that bit is not supported by any of
the pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access
types</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pEvents-parameter"></a> <code>pEvents</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>eventCount</code> valid <code>VkEvent</code> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-parameter"></a> <code>srcStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-requiredbitmask"></a> <code>srcStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-parameter"></a> <code>dstStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-requiredbitmask"></a> <code>dstStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pMemoryBarriers-parameter"></a> If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <code>VkMemoryBarrier</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter"></a> If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <code>VkBufferMemoryBarrier</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter"></a> If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <code>VkImageMemoryBarrier</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-eventCount-arraylength"></a> <code>eventCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commonparent"></a> Both of <code>commandBuffer</code>, and the elements of <code>pEvents</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-pipeline-barriers">6.6. Pipeline Barriers</h3>
<div class="paragraph">
<p><a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> is a synchronization command that inserts a
dependency between commands submitted to the same queue, or between commands
in the same subpass.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record a pipeline barrier, call:</p>
</div>
<div id="vkCmdPipelineBarrier" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdPipelineBarrier(
    VkCommandBuffer                             commandBuffer,
    VkPipelineStageFlags                        srcStageMask,
    VkPipelineStageFlags                        dstStageMask,
    VkDependencyFlags                           dependencyFlags,
    uint32_t                                    memoryBarrierCount,
    <span class="directive">const</span> VkMemoryBarrier*                      pMemoryBarriers,
    uint32_t                                    bufferMemoryBarrierCount,
    <span class="directive">const</span> VkBufferMemoryBarrier*                pBufferMemoryBarriers,
    uint32_t                                    imageMemoryBarrierCount,
    <span class="directive">const</span> VkImageMemoryBarrier*                 pImageMemoryBarriers);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages-masks">source stage
mask</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages-masks">destination
stage mask</a>.</p>
</li>
<li>
<p><code>dependencyFlags</code> is a bitmask of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a>
specifying how execution and memory dependencies are formed.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="#VkMemoryBarrier">VkMemoryBarrier</a>
structures.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> is submitted to a queue, it defines a memory
dependency between commands that were submitted before it, and those
submitted after it.</p>
</div>
<div class="paragraph">
<p>If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded outside a render pass instance,
the first <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a>.
If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded inside a render pass instance,
the first synchronization scope includes only commands that occur earlier in
<a href="#synchronization-submission-order">submission order</a> within the same
subpass.
In either case, the first synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded outside a render pass instance,
the second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.
If <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded inside a render pass instance,
the second synchronization scope includes only commands that occur later in
<a href="#synchronization-submission-order">submission order</a> within the same
subpass.
In either case, the second synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
Within that, the first access scope only includes the first access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the first access scope includes no
accesses.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
Within that, the second access scope only includes the second access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the second access scope includes
no accesses.</p>
</div>
<div class="paragraph">
<p>If <code>dependencyFlags</code> includes <code>VK_DEPENDENCY_BY_REGION_BIT</code>, then
any dependency between <a href="#synchronization-framebuffer-regions">framebuffer-space</a> pipeline stages is
<a href="#synchronization-framebuffer-regions">framebuffer-local</a> - otherwise it is
<a href="#synchronization-framebuffer-regions">framebuffer-global</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-01168"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-01169"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-01170"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-01171"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pDependencies-02024"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
the render pass <strong class="purple">must</strong> have been created with at least one
<code>VkSubpassDependency</code> instance in
<code>VkRenderPassCreateInfo</code>::<code>pDependencies</code> that expresses a
dependency from the current subpass to itself, and for which
<code>srcStageMask</code> contains a subset of the bit values in
<code>VkSubpassDependency</code>::<code>srcStageMask</code>, <code>dstStageMask</code>
contains a subset of the bit values in
<code>VkSubpassDependency</code>::<code>dstStageMask</code>, and <code>dependencyFlags</code>
is equal to <code>VkSubpassDependency</code>::<code>dependencyFlags</code>.</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pMemoryBarriers-02026"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
for each element of <code>pMemoryBarriers</code> and
<code>pImageMemoryBarriers</code>, the render pass <strong class="purple">must</strong> have been defined with
a <code>VkSubpassDependency</code> self-dependency for the current subpass with
valid <code>srcStageMask</code>, <code>dstStageMask</code>, and <code>dependencyFlags</code>
values such that <code>Vk*Barrier</code>::<code>srcAccessMask</code> contains a subset
of the bit values in <code>VkSubpassDependency</code>::<code>srcAccessMask</code> and
<code>Vk*Barrier</code>::<code>dstAccessMask</code> contains a subset of the bit
values in <code>VkSubpassDependency</code>::<code>dstAccessMask</code>.</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
<code>bufferMemoryBarrierCount</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-image-01179"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
the <code>image</code> member of any element of <code>pImageMemoryBarriers</code>
<strong class="purple">must</strong> be equal to one of the elements of <code>pAttachments</code> that the
current <code>framebuffer</code> was created with, that is also referred to by
one of the elements of the <code>pColorAttachments</code>,
<code>pResolveAttachments</code> or <code>pDepthStencilAttachment</code> members of
the <code>VkSubpassDescription</code> instance that the current subpass was
created with</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-oldLayout-01180"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
the <code>oldLayout</code> and <code>newLayout</code> members of any element of
<code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be equal to the <code>layout</code> member of
an element of the <code>pColorAttachments</code>, <code>pResolveAttachments</code> or
<code>pDepthStencilAttachment</code> members of the <code>VkSubpassDescription</code>
instance that the current subpass was created with, that refers to the
same <code>image</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-oldLayout-01181"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
the <code>oldLayout</code> and <code>newLayout</code> members of an element of
<code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182"></a>
If <code>vkCmdPipelineBarrier</code> is called within a render pass instance,
the <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members of
any element of <code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-01183"></a>
Any pipeline stage included in <code>srcStageMask</code> or <code>dstStageMask</code>
<strong class="purple">must</strong> be supported by the capabilities of the queue family specified by
the <code>queueFamilyIndex</code> member of the <a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a>.</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pMemoryBarriers-01184"></a>
Each element of <code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code> and
<code>pImageMemoryBarriers</code> <strong class="purple">must</strong> not have any access flag included in
its <code>srcAccessMask</code> member if that bit is not supported by any of
the pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access
types</a>.</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pMemoryBarriers-01185"></a>
Each element of <code>pMemoryBarriers</code>, <code>pBufferMemoryBarriers</code> and
<code>pImageMemoryBarriers</code> <strong class="purple">must</strong> not have any access flag included in
its <code>dstAccessMask</code> member if that bit is not supported by any of
the pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access
types</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-parameter"></a> <code>srcStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-requiredbitmask"></a> <code>srcStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-parameter"></a> <code>dstStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-requiredbitmask"></a> <code>dstStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dependencyFlags-parameter"></a> <code>dependencyFlags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter"></a> If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <code>VkMemoryBarrier</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter"></a> If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <code>VkBufferMemoryBarrier</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter"></a> If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <code>VkImageMemoryBarrier</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support transfer, graphics, or compute operations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <code>vkCmdPipelineBarrier</code>::<code>dependencyFlags</code>,
specifying how execution and memory dependencies are formed, are:</p>
</div>
<div id="VkDependencyFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkDependencyFlagBits {
    VK_DEPENDENCY_BY_REGION_BIT = <span class="hex">0x00000001</span>,
} VkDependencyFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DEPENDENCY_BY_REGION_BIT</code> specifies that dependencies will be
<a href="#synchronization-framebuffer-regions">framebuffer-local</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkDependencyFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkDependencyFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkDependencyFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkDependencyFlagBits">VkDependencyFlagBits</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-pipeline-barriers-subpass-self-dependencies">6.6.1. Subpass Self-dependency</h4>
<div class="paragraph">
<p>If <code>vkCmdPipelineBarrier</code> is called inside a render pass instance, the
following restrictions apply.
For a given subpass to allow a pipeline barrier, the render pass <strong class="purple">must</strong>
declare a <em>self-dependency</em> from that subpass to itself.
That is, there <strong class="purple">must</strong> exist a <code>VkSubpassDependency</code> in the subpass
dependency list for the render pass with <code>srcSubpass</code> and
<code>dstSubpass</code> equal to that subpass index.
More than one self-dependency <strong class="purple">can</strong> be declared for each subpass.
Self-dependencies <strong class="purple">must</strong> only include pipeline stage bits that are graphics
stages.
Self-dependencies <strong class="purple">must</strong> not have any earlier pipeline stages depend on any
later pipeline stages (according to the order of
<a href="#synchronization-pipeline-stages-types">graphics pipeline stages</a>), unless
all of the stages are
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a>.
If the source and destination stage masks both include framebuffer-space
stages, then <code>dependencyFlags</code> <strong class="purple">must</strong> include
<code>VK_DEPENDENCY_BY_REGION_BIT</code>.</p>
</div>
<div class="paragraph">
<p>A <code>vkCmdPipelineBarrier</code> command inside a render pass instance <strong class="purple">must</strong> be
a <em>subset</em> of one of the self-dependencies of the subpass it is used in,
meaning that the stage masks and access masks <strong class="purple">must</strong> each include only a
subset of the bits of the corresponding mask in that self-dependency.
If the self-dependency has <code>VK_DEPENDENCY_BY_REGION_BIT</code>
set, then so <strong class="purple">must</strong> the pipeline barrier.
Pipeline barriers within a render pass instance <strong class="purple">can</strong> only be types
<code>VkMemoryBarrier</code> or <code>VkImageMemoryBarrier</code>.
If a <code>VkImageMemoryBarrier</code> is used, the image and image subresource
range specified in the barrier <strong class="purple">must</strong> be a subset of one of the image views
used by the framebuffer in the current subpass.
Additionally, <code>oldLayout</code> <strong class="purple">must</strong> be equal to <code>newLayout</code>, and both
the <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-memory-barriers">6.7. Memory Barriers</h3>
<div class="paragraph">
<p><em>Memory barriers</em> are used to explicitly control access to buffer and image
subresource ranges.
Memory barriers are used to <a href="#synchronization-queue-transfers">transfer
ownership between queue families</a>,
<a href="#synchronization-image-layout-transitions">change image layouts</a>, and
define <a href="#synchronization-dependencies-available-and-visible">availability
and visibility operations</a>.
They explicitly define the <a href="#synchronization-access-types">access types</a>
and buffer and image subresource ranges that are included in the
<a href="#synchronization-dependencies-access-scopes">access scopes</a> of a memory
dependency that is created by a synchronization command that includes them.</p>
</div>
<div class="sect3">
<h4 id="synchronization-global-memory-barriers">6.7.1. Global Memory Barriers</h4>
<div class="paragraph">
<p>Global memory barriers apply to memory accesses involving all memory objects
that exist at the time of its execution.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkMemoryBarrier" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryBarrier {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkAccessFlags      srcAccessMask;
    VkAccessFlags      dstAccessMask;
} VkMemoryBarrier;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access types in the <a href="#synchronization-access-masks">source access
mask</a> specified by <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access types in the <a href="#synchronization-access-masks">destination
access mask</a> specified by <code>dstAccessMask</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-srcAccessMask-parameter"></a> <code>srcAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-dstAccessMask-parameter"></a> <code>dstAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-buffer-memory-barriers">6.7.2. Buffer Memory Barriers</h4>
<div class="paragraph">
<p>Buffer memory barriers only apply to memory accesses involving a specific
buffer range.
That is, a memory dependency formed from a buffer memory barrier is
<a href="#synchronization-dependencies-access-scopes">scoped</a> to access via the
specified buffer range.
Buffer memory barriers <strong class="purple">can</strong> also be used to define a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> for the
specified buffer range.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBufferMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkBufferMemoryBarrier" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkBufferMemoryBarrier {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkAccessFlags      srcAccessMask;
    VkAccessFlags      dstAccessMask;
    uint32_t           srcQueueFamilyIndex;
    uint32_t           dstQueueFamilyIndex;
    VkBuffer           buffer;
    VkDeviceSize       offset;
    VkDeviceSize       size;
} VkBufferMemoryBarrier;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>buffer</code> is a handle to the buffer whose backing memory is affected
by the barrier.</p>
</li>
<li>
<p><code>offset</code> is an offset in bytes into the backing memory for
<code>buffer</code>; this is relative to the base offset as bound to the buffer
(see <a href="#vkBindBufferMemory">vkBindBufferMemory</a>).</p>
</li>
<li>
<p><code>size</code> is a size in bytes of the affected area of backing memory for
<code>buffer</code>, or <code>VK_WHOLE_SIZE</code> to use the range from <code>offset</code>
to the end of the buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified buffer range, via access
types in the <a href="#synchronization-access-masks">source access mask</a> specified
by <code>srcAccessMask</code>.
If <code>srcAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code>, memory
writes performed by that access type are also made visible, as that access
type is not performed through a resource.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified buffer range, via access
types in the <a href="#synchronization-access-masks">destination access mask</a>.
specified by <code>dstAccessMask</code>.
If <code>dstAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code> or
<code>VK_ACCESS_HOST_READ_BIT</code>, available memory writes are also made visible
to accesses of those types, as those access types are not performed through
a resource.</p>
</div>
<div class="paragraph">
<p>If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, and
<code>srcQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-release">queue
family release operation</a> for the specified buffer range, and the second
access scope includes no access, as if <code>dstAccessMask</code> was <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstQueueFamilyIndex</code> is not equal to <code>srcQueueFamilyIndex</code>, and
<code>dstQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-acquire">queue
family acquire operation</a> for the specified buffer range, and the first
access scope includes no access, as if <code>srcAccessMask</code> was <code>0</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-offset-01187"></a>
<code>offset</code> <strong class="purple">must</strong> be less than the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-size-01188"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-size-01189"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
less than or equal to than the size of <code>buffer</code> minus <code>offset</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-01190"></a>
If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> both be <code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-01192"></a>
If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> either both be
<code>VK_QUEUE_FAMILY_IGNORED</code>, or both be a valid queue family (see
<a href="#devsandqueues-queueprops">Queue Family Properties</a>)</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-01196"></a>
If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not <code>VK_QUEUE_FAMILY_IGNORED</code>, at
least one of them <strong class="purple">must</strong> be the same as the family of the queue that will
execute this barrier</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-01931"></a>
If <code>buffer</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-srcAccessMask-parameter"></a> <code>srcAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-dstAccessMask-parameter"></a> <code>dstAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-parameter"></a> <code>buffer</code> <strong class="purple">must</strong> be a valid <code>VkBuffer</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-image-memory-barriers">6.7.3. Image Memory Barriers</h4>
<div class="paragraph">
<p>Image memory barriers only apply to memory accesses involving a specific
image subresource range.
That is, a memory dependency formed from an image memory barrier is
<a href="#synchronization-dependencies-access-scopes">scoped</a> to access via the
specified image subresource range.
Image memory barriers <strong class="purple">can</strong> also be used to define
<a href="#synchronization-image-layout-transitions">image layout transitions</a> or a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a> for the
specified image subresource range.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImageMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkImageMemoryBarrier" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImageMemoryBarrier {
    VkStructureType            sType;
    <span class="directive">const</span> <span class="directive">void</span>*                pNext;
    VkAccessFlags              srcAccessMask;
    VkAccessFlags              dstAccessMask;
    VkImageLayout              oldLayout;
    VkImageLayout              newLayout;
    uint32_t                   srcQueueFamilyIndex;
    uint32_t                   dstQueueFamilyIndex;
    VkImage                    image;
    VkImageSubresourceRange    subresourceRange;
} VkImageMemoryBarrier;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>oldLayout</code> is the old layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>newLayout</code> is the new layout in an
<a href="#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>image</code> is a handle to the image affected by this barrier.</p>
</li>
<li>
<p><code>subresourceRange</code> describes the <a href="#resources-image-views">image
subresource range</a> within <code>image</code> that is affected by this barrier.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified image subresource range,
via access types in the <a href="#synchronization-access-masks">source access mask</a>
specified by <code>srcAccessMask</code>.
If <code>srcAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code>, memory
writes performed by that access type are also made visible, as that access
type is not performed through a resource.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified image subresource range,
via access types in the <a href="#synchronization-access-masks">destination access
mask</a> specified by <code>dstAccessMask</code>.
If <code>dstAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code> or
<code>VK_ACCESS_HOST_READ_BIT</code>, available memory writes are also made visible
to accesses of those types, as those access types are not performed through
a resource.</p>
</div>
<div class="paragraph">
<p>If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, and
<code>srcQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-release">queue
family release operation</a> for the specified image subresource range, and
the second access scope includes no access, as if <code>dstAccessMask</code> was
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstQueueFamilyIndex</code> is not equal to <code>srcQueueFamilyIndex</code>, and
<code>dstQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="#synchronization-queue-transfers-acquire">queue
family acquire operation</a> for the specified image subresource range, and
the first access scope includes no access, as if <code>srcAccessMask</code> was
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>oldLayout</code> is not equal to <code>newLayout</code>, then the memory barrier
defines an <a href="#synchronization-image-layout-transitions">image layout
transition</a> for the specified image subresource range.</p>
</div>
<div id="synchronization-image-barrier-layout-transition-order" class="paragraph">
<p>Layout transitions that are performed via image memory barriers execute in
their entirety in <a href="#synchronization-submission-order">submission order</a>,
relative to other image layout transitions submitted to the same queue,
including those performed by <a href="#renderpass">render passes</a>.
In effect there is an implicit execution dependency from each such layout
transition to all layout transitions previously submitted to the same queue.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01197"></a>
<code>oldLayout</code> <strong class="purple">must</strong> be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or the current
layout of the image subresources affected by the barrier</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-newLayout-01198"></a>
<code>newLayout</code> <strong class="purple">must</strong> not be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01199"></a>
If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> both be <code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01200"></a>
If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> either both be
<code>VK_QUEUE_FAMILY_IGNORED</code>, or both be a valid queue family (see
<a href="#devsandqueues-queueprops">Queue Family Properties</a>).</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01205"></a>
If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not <code>VK_QUEUE_FAMILY_IGNORED</code>, at
least one of them <strong class="purple">must</strong> be the same as the family of the queue that will
execute this barrier</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01486"></a>
<code>subresourceRange.baseMipLevel</code> <strong class="purple">must</strong> be less than the
<code>mipLevels</code> specified in <a href="#VkImageCreateInfo">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01724"></a>
If <code>subresourceRange.levelCount</code> is not
<code>VK_REMAINING_MIP_LEVELS</code>, <span class="eq"><code>subresourceRange.baseMipLevel</code>
+  <code>subresourceRange.levelCount</code></span> <strong class="purple">must</strong> be less than or equal to
the <code>mipLevels</code> specified in <a href="#VkImageCreateInfo">VkImageCreateInfo</a> when
<code>image</code> was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01488"></a>
<code>subresourceRange.baseArrayLayer</code> <strong class="purple">must</strong> be less than the
<code>arrayLayers</code> specified in <a href="#VkImageCreateInfo">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01725"></a>
If <code>subresourceRange.layerCount</code> is not
<code>VK_REMAINING_ARRAY_LAYERS</code>,
<span class="eq"><code>subresourceRange.baseArrayLayer</code> + 
<code>subresourceRange.layerCount</code></span> <strong class="purple">must</strong> be less than or equal to the
<code>arrayLayers</code> specified in <a href="#VkImageCreateInfo">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01207"></a>
If <code>image</code> has a depth/stencil format with both depth and stencil
components, then the <code>aspectMask</code> member of <code>subresourceRange</code>
<strong class="purple">must</strong> include both <code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01208"></a>
If either <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong>
have been created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01209"></a>
If either <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL</code> then <code>image</code>
<strong class="purple">must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01210"></a>
If either <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> then <code>image</code>
<strong class="purple">must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01211"></a>
If either <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong>
have been created with <code>VK_IMAGE_USAGE_SAMPLED_BIT</code> or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01212"></a>
If either <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01213"></a>
If either <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01932"></a>
If <code>image</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMAGE_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcAccessMask-parameter"></a> <code>srcAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-dstAccessMask-parameter"></a> <code>dstAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-parameter"></a> <code>oldLayout</code> <strong class="purple">must</strong> be a valid <a href="#VkImageLayout">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-newLayout-parameter"></a> <code>newLayout</code> <strong class="purple">must</strong> be a valid <a href="#VkImageLayout">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-parameter"></a> <code>image</code> <strong class="purple">must</strong> be a valid <code>VkImage</code> handle</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-parameter"></a> <code>subresourceRange</code> <strong class="purple">must</strong> be a valid <code>VkImageSubresourceRange</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-queue-transfers">6.7.4. Queue Family Ownership Transfer</h4>
<div class="paragraph">
<p>Resources created with a <a href="#VkSharingMode">VkSharingMode</a> of
<code>VK_SHARING_MODE_EXCLUSIVE</code> <strong class="purple">must</strong> have their ownership explicitly
transferred from one queue family to another in order to access their
content in a well-defined manner on a queue in a different queue family.
If memory dependencies are correctly expressed between uses of such a
resource between two queues in different families, but no ownership transfer
is defined, the contents of that resource are undefined for any read
accesses performed by the second queue family.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If an application does not need the contents of a resource to remain valid
when transferring from one queue family to another, then the ownership
transfer <strong class="purple">should</strong> be skipped.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A queue family ownership transfer consists of two distinct parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Release exclusive ownership from the source queue family</p>
</li>
<li>
<p>Acquire exclusive ownership for the destination queue family</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An application <strong class="purple">must</strong> ensure that these operations occur in the correct order
by defining an execution dependency between them, e.g. using a semaphore.</p>
</div>
<div class="paragraph">
<p><a id="synchronization-queue-transfers-release"></a> A <em>release operation</em> is used to
release exclusive ownership of a range of a buffer or image subresource
range.
A release operation is defined by executing a
<a href="#synchronization-buffer-memory-barriers">buffer memory barrier</a> (for a
buffer range) or an <a href="#synchronization-image-memory-barriers">image memory
barrier</a> (for an image subresource range), on a queue from the source queue
family.
The <code>srcQueueFamilyIndex</code> parameter of the barrier <strong class="purple">must</strong> be set to the
source queue family index, and the <code>dstQueueFamilyIndex</code> parameter to
the destination queue family index.
<code>dstStageMask</code> is ignored for such a barrier, such that no visibility
operation is executed - the value of this mask does not affect the validity
of the barrier.
The release operation happens-after the availability operation.</p>
</div>
<div class="paragraph">
<p><a id="synchronization-queue-transfers-acquire"></a> An <em>acquire operation</em> is used
to acquire exclusive ownership of a range of a buffer or image subresource
range.
An acquire operation is defined by executing a
<a href="#synchronization-buffer-memory-barriers">buffer memory barrier</a> (for a
buffer range) or an <a href="#synchronization-image-memory-barriers">image memory
barrier</a> (for an image subresource range), on a queue from the destination
queue family.
The buffer range or image subresource range specified in an acquire
operation <strong class="purple">must</strong> match exactly that of a previous release operation.
The <code>srcQueueFamilyIndex</code> parameter of the barrier <strong class="purple">must</strong> be set to the
source queue family index, and the <code>dstQueueFamilyIndex</code> parameter to
the destination queue family index.
<code>srcStageMask</code> is ignored for such a barrier, such that no availability
operation is executed - the value of this mask does not affect the validity
of the barrier.
The acquire operation happens-before the visibility operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Whilst it is not invalid to provide destination or source access masks for
memory barriers used for release or acquire operations, respectively, they
have no practical effect.
Access after a release operation has undefined results, and so visibility
for those accesses has no practical effect.
Similarly, write access before an acquire operation will produce undefined
results for future access, so availability of those writes has no practical
use.
In an earlier version of the specification, these were required to match on
both sides - but this was subsequently relaxed.
These masks <strong class="purple">should</strong> be set to 0.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the transfer is via an image memory barrier, and an
<a href="#synchronization-image-layout-transitions">image layout transition</a> is
desired, then the values of <code>oldLayout</code> and <code>newLayout</code> in the
release memory barrier <strong class="purple">must</strong> be equal to values of <code>oldLayout</code> and
<code>newLayout</code> in the acquire memory barrier.
Although the image layout transition is submitted twice, it will only be
executed once.
A layout transition specified in this way happens-after the release
operation and happens-before the acquire operation.</p>
</div>
<div class="paragraph">
<p>If the values of <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> are
equal, no ownership transfer is performed, and the barrier operates as if
they were both set to <code>VK_QUEUE_FAMILY_IGNORED</code>.</p>
</div>
<div class="paragraph">
<p>Queue family ownership transfers <strong class="purple">may</strong> perform read and write accesses on all
memory bound to the image subresource or buffer range, so applications <strong class="purple">must</strong>
ensure that all memory writes have been made
<a href="#synchronization-dependencies-available-and-visible">available</a> before a
queue family ownership transfer is executed.
Available memory is automatically made visible to queue family release and
acquire operations, and writes performed by those operations are
automatically made available.</p>
</div>
<div class="paragraph">
<p>Once a queue family has acquired ownership of a buffer range or image
subresource range of an <code>VK_SHARING_MODE_EXCLUSIVE</code> resource, its
contents are undefined to other queue families unless ownership is
transferred.
The contents of any portion of another resource which aliases memory that is
bound to the transferred buffer or image subresource range are undefined
after a release or acquire operation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-wait-idle">6.8. Wait Idle Operations</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait on the host for the completion of outstanding queue operations for a
given queue, call:</p>
</div>
<div id="vkQueueWaitIdle" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkQueueWaitIdle(
    VkQueue                                     queue);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue on which to wait.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkQueueWaitIdle</code> is equivalent to submitting a fence to a queue and
waiting with an infinite timeout for that fence to signal.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueWaitIdle-queue-parameter"></a> <code>queue</code> <strong class="purple">must</strong> be a valid <code>VkQueue</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait on the host for the completion of outstanding queue operations for
all queues on a given logical device, call:</p>
</div>
<div id="vkDeviceWaitIdle" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkDeviceWaitIdle(
    VkDevice                                    device);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to idle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkDeviceWaitIdle</code> is equivalent to calling <code>vkQueueWaitIdle</code> for
all queues owned by <code>device</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDeviceWaitIdle-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to all <code>VkQueue</code> objects created from <code>device</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-submission-host-writes">6.9. Host Write Ordering Guarantees</h3>
<div class="paragraph">
<p>When batches of command buffers are submitted to a queue via
<a href="#vkQueueSubmit">vkQueueSubmit</a>, it defines a memory dependency with prior host
operations, and execution of command buffers submitted to the queue.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-scopes">synchronization scope</a> is
defined by the host execution model, but includes execution of
<a href="#vkQueueSubmit">vkQueueSubmit</a> on the host and anything that happened-before it.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands submitted in the same <a href="#devsandqueues-submission">queue submission</a>, and all commands that occur later in
<a href="#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all host writes to mappable device memory that are available to the
host memory domain.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="renderpass">7. Render Pass</h2>
<div class="sectionbody">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A <em>render pass</em> represents a collection of attachments, subpasses, and
dependencies between the subpasses, and describes how the attachments are
used over the course of the subpasses.
The use of a render pass in a command buffer is a <em>render pass instance</em>.</p>
</div>
<div class="paragraph">
<p>Render passes are represented by <code>VkRenderPass</code> handles:</p>
</div>
<div id="VkRenderPass" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkRenderPass)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>An <em>attachment description</em> describes the properties of an attachment
including its format, sample count, and how its contents are treated at the
beginning and end of each render pass instance.</p>
</div>
<div id="renderpass-subpass" class="paragraph">
<p>A <em>subpass</em> represents a phase of rendering that reads and writes a subset
of the attachments in a render pass.
Rendering commands are recorded into a particular subpass of a render pass
instance.</p>
</div>
<div class="paragraph">
<p>A <em>subpass description</em> describes the subset of attachments that is involved
in the execution of a subpass.
Each subpass <strong class="purple">can</strong> read from some attachments as <em>input attachments</em>, write
to some as <em>color attachments</em> or <em>depth/stencil attachments</em>, and perform
<em>multisample resolve operations</em> to <em>resolve attachments</em>.
A subpass description <strong class="purple">can</strong> also include a set of <em>preserve attachments</em>,
which are attachments that are not read or written by the subpass but whose
contents <strong class="purple">must</strong> be preserved throughout the subpass.</p>
</div>
<div class="paragraph">
<p>A subpass <em>uses an attachment</em> if the attachment is a color, depth/stencil,
resolve, or input attachment for that subpass (as determined by the
<code>pColorAttachments</code>, <code>pDepthStencilAttachment</code>,
<code>pResolveAttachments</code>, and <code>pInputAttachments</code> members of
<a href="#VkSubpassDescription">VkSubpassDescription</a>, respectively).
A subpass does not use an attachment if that attachment is preserved by the
subpass.
The <em>first use of an attachment</em> is in the lowest numbered subpass that uses
that attachment.
Similarly, the <em>last use of an attachment</em> is in the highest numbered
subpass that uses that attachment.</p>
</div>
<div class="paragraph">
<p>The subpasses in a render pass all render to the same dimensions, and
fragments for pixel (x,y,layer) in one subpass <strong class="purple">can</strong> only read attachment
contents written by previous subpasses at that same (x,y,layer) location.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>By describing a complete set of subpasses in advance, render passes provide
the implementation an opportunity to optimize the storage and transfer of
attachment data between subpasses.</p>
</div>
<div class="paragraph">
<p>In practice, this means that subpasses with a simple framebuffer-space
dependency <strong class="purple">may</strong> be merged into a single tiled rendering pass, keeping the
attachment data on-chip for the duration of a render pass instance.
However, it is also quite common for a render pass to only contain a single
subpass.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>Subpass dependencies</em> describe <a href="#synchronization-dependencies">execution
and memory dependencies</a> between subpasses.</p>
</div>
<div class="paragraph">
<p>A <em>subpass dependency chain</em> is a sequence of subpass dependencies in a
render pass, where the source subpass of each subpass dependency (after the
first) equals the destination subpass of the previous dependency.</p>
</div>
<div class="paragraph">
<p>Execution of subpasses <strong class="purple">may</strong> overlap or execute out of order with regards to
other subpasses, unless otherwise enforced by an execution dependency.
Each subpass only respects <a href="#synchronization-submission-order">submission
order</a> for commands recorded in the same subpass, and the
<a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a> and <a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a> commands that
delimit the render pass - commands within other subpasses are not included.
This affects most other <a href="#synchronization-implicit">implicit ordering
guarantees</a>.</p>
</div>
<div class="paragraph">
<p>A render pass describes the structure of subpasses and attachments
independent of any specific image views for the attachments.
The specific image views that will be used for the attachments, and their
dimensions, are specified in <code>VkFramebuffer</code> objects.
Framebuffers are created with respect to a specific render pass that the
framebuffer is compatible with (see <a href="#renderpass-compatibility">Render Pass
Compatibility</a>).
Collectively, a render pass and a framebuffer define the complete render
target state for one or more subpasses as well as the algorithmic
dependencies between the subpasses.</p>
</div>
<div class="paragraph">
<p>The various pipeline stages of the drawing commands for a given subpass <strong class="purple">may</strong>
execute concurrently and/or out of order, both within and across drawing
commands, whilst still respecting <a href="#synchronization-pipeline-stages-order">pipeline order</a>.
However for a given (x,y,layer,sample) sample location, certain per-sample
operations are performed in <a href="#primrast-order">rasterization order</a>.</p>
</div>
<div class="sect2">
<h3 id="renderpass-creation">7.1. Render Pass Creation</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a render pass, call:</p>
</div>
<div id="vkCreateRenderPass" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateRenderPass(
    VkDevice                                    device,
    <span class="directive">const</span> VkRenderPassCreateInfo*               pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkRenderPass*                               pRenderPass);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the render pass.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<a href="#VkRenderPassCreateInfo">VkRenderPassCreateInfo</a> structure that describes the parameters of
the render pass.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pRenderPass</code> points to a <a href="#VkRenderPass">VkRenderPass</a> handle in which the
resulting render pass object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateRenderPass-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateRenderPass-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkRenderPassCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateRenderPass-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateRenderPass-pRenderPass-parameter"></a> <code>pRenderPass</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkRenderPass</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkRenderPassCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkRenderPassCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkRenderPassCreateInfo {
    VkStructureType                   sType;
    <span class="directive">const</span> <span class="directive">void</span>*                       pNext;
    VkRenderPassCreateFlags           flags;
    uint32_t                          attachmentCount;
    <span class="directive">const</span> VkAttachmentDescription*    pAttachments;
    uint32_t                          subpassCount;
    <span class="directive">const</span> VkSubpassDescription*       pSubpasses;
    uint32_t                          dependencyCount;
    <span class="directive">const</span> VkSubpassDependency*        pDependencies;
} VkRenderPassCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>attachmentCount</code> is the number of attachments used by this render
pass, or zero indicating no attachments.
Attachments are referred to by zero-based indices in the range
[0,<code>attachmentCount</code>).</p>
</li>
<li>
<p><code>pAttachments</code> points to an array of <code>attachmentCount</code> number of
<a href="#VkAttachmentDescription">VkAttachmentDescription</a> structures describing properties of the
attachments, or <code>NULL</code> if <code>attachmentCount</code> is zero.</p>
</li>
<li>
<p><code>subpassCount</code> is the number of subpasses to create for this render
pass.
Subpasses are referred to by zero-based indices in the range
[0,<code>subpassCount</code>).
A render pass <strong class="purple">must</strong> have at least one subpass.</p>
</li>
<li>
<p><code>pSubpasses</code> points to an array of <code>subpassCount</code> number of
<a href="#VkSubpassDescription">VkSubpassDescription</a> structures describing properties of the
subpasses.</p>
</li>
<li>
<p><code>dependencyCount</code> is the number of dependencies between pairs of
subpasses, or zero indicating no dependencies.</p>
</li>
<li>
<p><code>pDependencies</code> points to an array of <code>dependencyCount</code> number
of <a href="#VkSubpassDependency">VkSubpassDependency</a> structures describing dependencies between
pairs of subpasses, or <code>NULL</code> if <code>dependencyCount</code> is zero.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-None-00832"></a>
If any two subpasses operate on attachments with overlapping ranges of
the same <code>VkDeviceMemory</code> object, and at least one subpass writes to
that area of <code>VkDeviceMemory</code>, a subpass dependency <strong class="purple">must</strong> be
included (either directly or via some intermediate subpasses) between
them</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-attachment-00833"></a>
If the <code>attachment</code> member of any element of
<code>pInputAttachments</code>, <code>pColorAttachments</code>,
<code>pResolveAttachments</code> or <code>pDepthStencilAttachment</code>, or the
attachment indexed by any element of <code>pPreserveAttachments</code> in any
element of <code>pSubpasses</code> is bound to a range of a
<code>VkDeviceMemory</code> object that overlaps with any other attachment in
any subpass (including the same subpass), the
<code>VkAttachmentDescription</code> structures describing them <strong class="purple">must</strong> include
<code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code> in <code>flags</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-attachment-00834"></a>
If the <code>attachment</code> member of any element of
<code>pInputAttachments</code>, <code>pColorAttachments</code>,
<code>pResolveAttachments</code> or <code>pDepthStencilAttachment</code>, or any
element of <code>pPreserveAttachments</code> in any element of <code>pSubpasses</code>
is not <code>VK_ATTACHMENT_UNUSED</code>, it <strong class="purple">must</strong> be less than
<code>attachmentCount</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pPreserveAttachments-00835"></a>
The value of each element of the <code>pPreserveAttachments</code> member in
each element of <code>pSubpasses</code> <strong class="purple">must</strong> not be <code>VK_ATTACHMENT_UNUSED</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pAttachments-00836"></a>
For any member of <code>pAttachments</code> with a <code>loadOp</code> equal to
<code>VK_ATTACHMENT_LOAD_OP_CLEAR</code>, the first use of that attachment
<strong class="purple">must</strong> not specify a <code>layout</code> equal to
<code>VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL</code> or
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code>.</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pDependencies-00837"></a>
For any element of <code>pDependencies</code>, if the <code>srcSubpass</code> is not
<code>VK_SUBPASS_EXTERNAL</code>, all stage flags included in the
<code>srcStageMask</code> member of that dependency <strong class="purple">must</strong> be a pipeline stage
supported by the <a href="#synchronization-pipeline-stages-types">pipeline</a>
identified by the <code>pipelineBindPoint</code> member of the source subpass.</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pDependencies-00838"></a>
For any element of <code>pDependencies</code>, if the <code>dstSubpass</code> is not
<code>VK_SUBPASS_EXTERNAL</code>, all stage flags included in the
<code>dstStageMask</code> member of that dependency <strong class="purple">must</strong> be a pipeline stage
supported by the <a href="#synchronization-pipeline-stages-types">pipeline</a>
identified by the <code>pipelineBindPoint</code> member of the source subpass.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_RENDER_PASS_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkRenderPassCreateFlagBits">VkRenderPassCreateFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pAttachments-parameter"></a> If <code>attachmentCount</code> is not <code>0</code>, <code>pAttachments</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>attachmentCount</code> valid <code>VkAttachmentDescription</code> structures</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pSubpasses-parameter"></a> <code>pSubpasses</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>subpassCount</code> valid <code>VkSubpassDescription</code> structures</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-pDependencies-parameter"></a> If <code>dependencyCount</code> is not <code>0</code>, <code>pDependencies</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dependencyCount</code> valid <code>VkSubpassDependency</code> structures</p>
</li>
<li>
<p><a id="VUID-VkRenderPassCreateInfo-subpassCount-arraylength"></a> <code>subpassCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkRenderPassCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkRenderPassCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkRenderPassCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAttachmentDescription</code> structure is defined as:</p>
</div>
<div id="VkAttachmentDescription" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkAttachmentDescription {
    VkAttachmentDescriptionFlags    flags;
    VkFormat                        format;
    VkSampleCountFlagBits           samples;
    VkAttachmentLoadOp              loadOp;
    VkAttachmentStoreOp             storeOp;
    VkAttachmentLoadOp              stencilLoadOp;
    VkAttachmentStoreOp             stencilStoreOp;
    VkImageLayout                   initialLayout;
    VkImageLayout                   finalLayout;
} VkAttachmentDescription;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkAttachmentDescriptionFlagBits">VkAttachmentDescriptionFlagBits</a>
specifying additional properties of the attachment.</p>
</li>
<li>
<p><code>format</code> is a <a href="#VkFormat">VkFormat</a> value specifying the format of the
image view that will be used for the attachment.</p>
</li>
<li>
<p><code>samples</code> is the number of samples of the image as defined in
<a href="#VkSampleCountFlagBits">VkSampleCountFlagBits</a>.</p>
</li>
<li>
<p><code>loadOp</code> is a <a href="#VkAttachmentLoadOp">VkAttachmentLoadOp</a> value specifying how the
contents of color and depth components of the attachment are treated at
the beginning of the subpass where it is first used.</p>
</li>
<li>
<p><code>storeOp</code> is a <a href="#VkAttachmentStoreOp">VkAttachmentStoreOp</a> value specifying how the
contents of color and depth components of the attachment are treated at
the end of the subpass where it is last used.</p>
</li>
<li>
<p><code>stencilLoadOp</code> is a <a href="#VkAttachmentLoadOp">VkAttachmentLoadOp</a> value specifying how
the contents of stencil components of the attachment are treated at the
beginning of the subpass where it is first used.</p>
</li>
<li>
<p><code>stencilStoreOp</code> is a <a href="#VkAttachmentStoreOp">VkAttachmentStoreOp</a> value specifying how
the contents of stencil components of the attachment are treated at the
end of the last subpass where it is used.</p>
</li>
<li>
<p><code>initialLayout</code> is the layout the attachment image subresource will
be in when a render pass instance begins.</p>
</li>
<li>
<p><code>finalLayout</code> is the layout the attachment image subresource will be
transitioned to when a render pass instance ends.
During a render pass instance, an attachment <strong class="purple">can</strong> use a different layout
in each subpass, if desired.</p>
</li>
</ul>
</div>
<div id="renderpass-load-store-ops" class="paragraph">
<p>If the attachment uses a color format, then <code>loadOp</code> and <code>storeOp</code>
are used, and <code>stencilLoadOp</code> and <code>stencilStoreOp</code> are ignored.
If the format has depth and/or stencil components, <code>loadOp</code> and
<code>storeOp</code> apply only to the depth data, while <code>stencilLoadOp</code> and
<code>stencilStoreOp</code> define how the stencil data is handled.
<code>loadOp</code> and <code>stencilLoadOp</code> define the <em>load operations</em> that
execute as part of the first subpass that uses the attachment.
<code>storeOp</code> and <code>stencilStoreOp</code> define the <em>store operations</em> that
execute as part of the last subpass that uses the attachment.</p>
</div>
<div class="paragraph">
<p>The load operation for each sample in an attachment happens-before any
recorded command which accesses the sample in the first subpass where the
attachment is used.
Load operations for attachments with a depth/stencil format execute in the
<code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> pipeline stage.
Load operations for attachments with a color format execute in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</div>
<div class="paragraph">
<p>The store operation for each sample in an attachment happens-after any
recorded command which accesses the sample in the last subpass where the
attachment is used.
Store operations for attachments with a depth/stencil format execute in the
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stage.
Store operations for attachments with a color format execute in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</div>
<div class="paragraph">
<p>If an attachment is not used by any subpass, then <code>loadOp</code>,
<code>storeOp</code>, <code>stencilStoreOp</code>, and <code>stencilLoadOp</code> are ignored,
and the attachment&#8217;s memory contents will not be modified by execution of a
render pass instance.</p>
</div>
<div id="renderpass-precision" class="paragraph">
<p>During a render pass instance, input/color attachments with color formats
that have a component size of 8, 16, or 32 bits <strong class="purple">must</strong> be represented in the
attachment&#8217;s format throughout the instance.
Attachments with other floating- or fixed-point color formats, or with depth
components <strong class="purple">may</strong> be represented in a format with a precision higher than the
attachment format, but <strong class="purple">must</strong> be represented with the same range.
When such a component is loaded via the <code>loadOp</code>, it will be converted
into an implementation-dependent format used by the render pass.
Such components <strong class="purple">must</strong> be converted from the render pass format, to the
format of the attachment, before they are resolved or stored at the end of a
render pass instance via <code>storeOp</code>.
Conversions occur as described in <a href="#fundamentals-numerics">Numeric
Representation and Computation</a> and <a href="#fundamentals-fixedconv">Fixed-Point
Data Conversions</a>.</p>
</div>
<div id="renderpass-aliasing" class="paragraph">
<p>If <code>flags</code> includes <code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code>, then
the attachment is treated as if it shares physical memory with another
attachment in the same render pass.
This information limits the ability of the implementation to reorder certain
operations (like layout transitions and the <code>loadOp</code>) such that it is
not improperly reordered against other uses of the same physical memory via
a different attachment.
This is described in more detail below.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAttachmentDescription-finalLayout-00843"></a>
<code>finalLayout</code> <strong class="purple">must</strong> not be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAttachmentDescription-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAttachmentDescriptionFlagBits">VkAttachmentDescriptionFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-format-parameter"></a> <code>format</code> <strong class="purple">must</strong> be a valid <a href="#VkFormat">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-samples-parameter"></a> <code>samples</code> <strong class="purple">must</strong> be a valid <a href="#VkSampleCountFlagBits">VkSampleCountFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-loadOp-parameter"></a> <code>loadOp</code> <strong class="purple">must</strong> be a valid <a href="#VkAttachmentLoadOp">VkAttachmentLoadOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-storeOp-parameter"></a> <code>storeOp</code> <strong class="purple">must</strong> be a valid <a href="#VkAttachmentStoreOp">VkAttachmentStoreOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-stencilLoadOp-parameter"></a> <code>stencilLoadOp</code> <strong class="purple">must</strong> be a valid <a href="#VkAttachmentLoadOp">VkAttachmentLoadOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-stencilStoreOp-parameter"></a> <code>stencilStoreOp</code> <strong class="purple">must</strong> be a valid <a href="#VkAttachmentStoreOp">VkAttachmentStoreOp</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-initialLayout-parameter"></a> <code>initialLayout</code> <strong class="purple">must</strong> be a valid <a href="#VkImageLayout">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkAttachmentDescription-finalLayout-parameter"></a> <code>finalLayout</code> <strong class="purple">must</strong> be a valid <a href="#VkImageLayout">VkImageLayout</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkAttachmentDescription">VkAttachmentDescription</a>::<code>flags</code>
describing additional properties of the attachment are:</p>
</div>
<div id="VkAttachmentDescriptionFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkAttachmentDescriptionFlagBits {
    VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT = <span class="hex">0x00000001</span>,
} VkAttachmentDescriptionFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code> specifies that the
attachment aliases the same device memory as other attachments.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAttachmentDescriptionFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkAttachmentDescriptionFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkAttachmentDescriptionFlags</code> is a bitmask type for setting a mask of
zero or more <a href="#VkAttachmentDescriptionFlagBits">VkAttachmentDescriptionFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkAttachmentDescription">VkAttachmentDescription</a>::<code>loadOp</code> and
<code>stencilLoadOp</code>, specifying how the contents of the attachment are
treated, are:</p>
</div>
<div id="VkAttachmentLoadOp" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkAttachmentLoadOp {
    VK_ATTACHMENT_LOAD_OP_LOAD = <span class="integer">0</span>,
    VK_ATTACHMENT_LOAD_OP_CLEAR = <span class="integer">1</span>,
    VK_ATTACHMENT_LOAD_OP_DONT_CARE = <span class="integer">2</span>,
} VkAttachmentLoadOp;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ATTACHMENT_LOAD_OP_LOAD</code> specifies that the previous contents of
the image within the render area will be preserved.
For attachments with a depth/stencil format, this uses the access type
<code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code>.
For attachments with a color format, this uses the access type
<code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code>.</p>
</li>
<li>
<p><code>VK_ATTACHMENT_LOAD_OP_CLEAR</code> specifies that the contents within the
render area will be cleared to a uniform value, which is specified when
a render pass instance is begun.
For attachments with a depth/stencil format, this uses the access type
<code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>.
For attachments with a color format, this uses the access type
<code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code>.</p>
</li>
<li>
<p><code>VK_ATTACHMENT_LOAD_OP_DONT_CARE</code> specifies that the previous
contents within the area need not be preserved; the contents of the
attachment will be undefined inside the render area.
For attachments with a depth/stencil format, this uses the access type
<code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>.
For attachments with a color format, this uses the access type
<code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkAttachmentDescription">VkAttachmentDescription</a>::<code>storeOp</code> and
<code>stencilStoreOp</code>, specifying how the contents of the attachment are
treated, are:</p>
</div>
<div id="VkAttachmentStoreOp" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkAttachmentStoreOp {
    VK_ATTACHMENT_STORE_OP_STORE = <span class="integer">0</span>,
    VK_ATTACHMENT_STORE_OP_DONT_CARE = <span class="integer">1</span>,
} VkAttachmentStoreOp;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ATTACHMENT_STORE_OP_STORE</code> specifies the contents generated
during the render pass and within the render area are written to memory.
For attachments with a depth/stencil format, this uses the access type
<code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>.
For attachments with a color format, this uses the access type
<code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code>.</p>
</li>
<li>
<p><code>VK_ATTACHMENT_STORE_OP_DONT_CARE</code> specifies the contents within the
render area are not needed after rendering, and <strong class="purple">may</strong> be discarded; the
contents of the attachment will be undefined inside the render area.
For attachments with a depth/stencil format, this uses the access type
<code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code>.
For attachments with a color format, this uses the access type
<code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If a render pass uses multiple attachments that alias the same device
memory, those attachments <strong class="purple">must</strong> each include the
<code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code> bit in their attachment
description flags.
Attachments aliasing the same memory occurs in multiple ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Multiple attachments being assigned the same image view as part of
framebuffer creation.</p>
</li>
<li>
<p>Attachments using distinct image views that correspond to the same image
subresource of an image.</p>
</li>
<li>
<p>Attachments using views of distinct image subresources which are bound
to overlapping memory ranges.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Render passes <strong class="purple">must</strong> include subpass dependencies (either directly or via a
subpass dependency chain) between any two subpasses that operate on the same
attachment or aliasing attachments and those subpass dependencies <strong class="purple">must</strong>
include execution and memory dependencies separating uses of the aliases, if
at least one of those subpasses writes to one of the aliases.
These dependencies <strong class="purple">must</strong> not include the <code>VK_DEPENDENCY_BY_REGION_BIT</code>
if the aliases are views of distinct image subresources which overlap in
memory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Multiple attachments that alias the same memory <strong class="purple">must</strong> not be used in a
single subpass.
A given attachment index <strong class="purple">must</strong> not be used multiple times in a single
subpass, with one exception: two subpass attachments <strong class="purple">can</strong> use the same
attachment index if at least one use is as an input attachment and neither
use is as a resolve or preserve attachment.
In other words, the same view <strong class="purple">can</strong> be used simultaneously as an input and
color or depth/stencil attachment, but <strong class="purple">must</strong> not be used as multiple color
or depth/stencil attachments nor as resolve or preserve attachments.
The precise set of valid scenarios is described in more detail
<a href="#renderpass-feedbackloop">below</a>.</p>
</div>
<div class="paragraph">
<p>If a set of attachments alias each other, then all except the first to be
used in the render pass <strong class="purple">must</strong> use an <code>initialLayout</code> of
<code>VK_IMAGE_LAYOUT_UNDEFINED</code>, since the earlier uses of the other aliases
make their contents undefined.
Once an alias has been used and a different alias has been used after it,
the first alias <strong class="purple">must</strong> not be used in any later subpasses.
However, an application <strong class="purple">can</strong> assign the same image view to multiple aliasing
attachment indices, which allows that image view to be used multiple times
even if other aliases are used in between.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Once an attachment needs the <code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code>
bit, there <strong class="purple">should</strong> be no additional cost of introducing additional aliases,
and using these additional aliases <strong class="purple">may</strong> allow more efficient clearing of the
attachments on multiple uses via <code>VK_ATTACHMENT_LOAD_OP_CLEAR</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSubpassDescription</code> structure is defined as:</p>
</div>
<div id="VkSubpassDescription" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkSubpassDescription {
    VkSubpassDescriptionFlags       flags;
    VkPipelineBindPoint             pipelineBindPoint;
    uint32_t                        inputAttachmentCount;
    <span class="directive">const</span> VkAttachmentReference*    pInputAttachments;
    uint32_t                        colorAttachmentCount;
    <span class="directive">const</span> VkAttachmentReference*    pColorAttachments;
    <span class="directive">const</span> VkAttachmentReference*    pResolveAttachments;
    <span class="directive">const</span> VkAttachmentReference*    pDepthStencilAttachment;
    uint32_t                        preserveAttachmentCount;
    <span class="directive">const</span> uint32_t*                 pPreserveAttachments;
} VkSubpassDescription;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkSubpassDescriptionFlagBits">VkSubpassDescriptionFlagBits</a>
specifying usage of the subpass.</p>
</li>
<li>
<p><code>pipelineBindPoint</code> is a <a href="#VkPipelineBindPoint">VkPipelineBindPoint</a> value specifying
whether this is a compute or graphics subpass.
Currently, only graphics subpasses are supported.</p>
</li>
<li>
<p><code>inputAttachmentCount</code> is the number of input attachments.</p>
</li>
<li>
<p><code>pInputAttachments</code> is an array of <a href="#VkAttachmentReference">VkAttachmentReference</a>
structures (defined below) that lists which of the render pass&#8217;s
attachments <strong class="purple">can</strong> be read in the fragment shader stage during the
subpass, and what layout each attachment will be in during the subpass.
Each element of the array corresponds to an input attachment unit number
in the shader, i.e. if the shader declares an input variable
<code>layout(input_attachment_index=X, set=Y, binding=Z)</code> then it uses the
attachment provided in <code>pInputAttachments</code>[X].
Input attachments <strong class="purple">must</strong> also be bound to the pipeline with a descriptor
set, with the input attachment descriptor written in the location
(set=Y, binding=Z).
Fragment shaders <strong class="purple">can</strong> use subpass input variables to access the contents
of an input attachment at the fragment&#8217;s (x, y, layer) framebuffer
coordinates.</p>
</li>
<li>
<p><code>colorAttachmentCount</code> is the number of color attachments.</p>
</li>
<li>
<p><code>pColorAttachments</code> is an array of <code>colorAttachmentCount</code>
<a href="#VkAttachmentReference">VkAttachmentReference</a> structures that lists which of the render
pass&#8217;s attachments will be used as color attachments in the subpass, and
what layout each attachment will be in during the subpass.
Each element of the array corresponds to a fragment shader output
location, i.e. if the shader declared an output variable
<code>layout(location=X)</code> then it uses the attachment provided in
<code>pColorAttachments</code>[X].</p>
</li>
<li>
<p><code>pResolveAttachments</code> is <code>NULL</code> or an array of
<code>colorAttachmentCount</code> <a href="#VkAttachmentReference">VkAttachmentReference</a> structures that
lists which of the render pass&#8217;s attachments are resolved to at the end
of the subpass, and what layout each attachment will be in during the
multisample resolve operation.
If <code>pResolveAttachments</code> is not <code>NULL</code>, each of its elements
corresponds to a color attachment (the element in
<code>pColorAttachments</code> at the same index), and a multisample resolve
operation is defined for each attachment.
At the end of each subpass, multisample resolve operations read the
subpass&#8217;s color attachments, and resolve the samples for each pixel to
the same pixel location in the corresponding resolve attachments, unless
the resolve attachment index is <code>VK_ATTACHMENT_UNUSED</code>.
If the first use of an attachment in a render pass is as a resolve
attachment, then the <code>loadOp</code> is effectively ignored as the resolve
is guaranteed to overwrite all pixels in the render area.</p>
</li>
<li>
<p><code>pDepthStencilAttachment</code> is a pointer to a
<a href="#VkAttachmentReference">VkAttachmentReference</a> specifying which attachment will be used for
depth/stencil data and the layout it will be in during the subpass.
Setting the attachment index to <code>VK_ATTACHMENT_UNUSED</code> or leaving
this pointer as <code>NULL</code> indicates that no depth/stencil attachment will
be used in the subpass.</p>
</li>
<li>
<p><code>preserveAttachmentCount</code> is the number of preserved attachments.</p>
</li>
<li>
<p><code>pPreserveAttachments</code> is an array of <code>preserveAttachmentCount</code>
render pass attachment indices describing the attachments that are not
used by a subpass, but whose contents <strong class="purple">must</strong> be preserved throughout the
subpass.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The contents of an attachment within the render area become undefined at the
start of a subpass <strong>S</strong> if all of the following conditions are true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attachment is used as a color, depth/stencil, or resolve attachment
in any subpass in the render pass.</p>
</li>
<li>
<p>There is a subpass <strong>S<sub>1</sub></strong> that uses or preserves the attachment, and a
subpass dependency from <strong>S<sub>1</sub></strong> to <strong>S</strong>.</p>
</li>
<li>
<p>The attachment is not used or preserved in subpass <strong>S</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the contents of an attachment become undefined in subpass <strong>S</strong>, they
remain undefined for subpasses in subpass dependency chains starting with
subpass <strong>S</strong> until they are written again.
However, they remain valid for subpasses in other subpass dependency chains
starting with subpass <strong>S<sub>1</sub></strong> if those subpasses use or preserve the
attachment.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubpassDescription-pipelineBindPoint-00844"></a>
<code>pipelineBindPoint</code> <strong class="purple">must</strong> be <code>VK_PIPELINE_BIND_POINT_GRAPHICS</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-colorAttachmentCount-00845"></a>
<code>colorAttachmentCount</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxColorAttachments</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-loadOp-00846"></a>
If the first use of an attachment in this render pass is as an input
attachment, and the attachment is not also used as a color or
depth/stencil attachment in the same subpass, then <code>loadOp</code> <strong class="purple">must</strong>
not be <code>VK_ATTACHMENT_LOAD_OP_CLEAR</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pResolveAttachments-00847"></a>
If <code>pResolveAttachments</code> is not <code>NULL</code>, for each resolve attachment
that does not have the value <code>VK_ATTACHMENT_UNUSED</code>, the
corresponding color attachment <strong class="purple">must</strong> not have the value
<code>VK_ATTACHMENT_UNUSED</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pResolveAttachments-00848"></a>
If <code>pResolveAttachments</code> is not <code>NULL</code>, the sample count of each
element of <code>pColorAttachments</code> <strong class="purple">must</strong> be anything other than
<code>VK_SAMPLE_COUNT_1_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pResolveAttachments-00849"></a>
Each element of <code>pResolveAttachments</code> <strong class="purple">must</strong> have a sample count of
<code>VK_SAMPLE_COUNT_1_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pResolveAttachments-00850"></a>
Each element of <code>pResolveAttachments</code> <strong class="purple">must</strong> have the same
<a href="#VkFormat">VkFormat</a> as its corresponding color attachment</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pColorAttachments-01417"></a>
All attachments in <code>pColorAttachments</code> that are not
<code>VK_ATTACHMENT_UNUSED</code> <strong class="purple">must</strong> have the same sample count</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pDepthStencilAttachment-01418"></a>
If <code>pDepthStencilAttachment</code> is not <code>VK_ATTACHMENT_UNUSED</code> and
any attachments in <code>pColorAttachments</code> are not
<code>VK_ATTACHMENT_UNUSED</code>, they <strong class="purple">must</strong> have the same sample count</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-None-00852"></a>
If any input attachments are <code>VK_ATTACHMENT_UNUSED</code>, then any
pipelines bound during the subpass <strong class="purple">must</strong> not access those input
attachments from the fragment shader</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-attachment-00853"></a>
The <code>attachment</code> member of each element of
<code>pPreserveAttachments</code> <strong class="purple">must</strong> not be <code>VK_ATTACHMENT_UNUSED</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pPreserveAttachments-00854"></a>
Each element of <code>pPreserveAttachments</code> <strong class="purple">must</strong> not also be an element
of any other member of the subpass description</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-layout-00855"></a>
If any attachment is used as both an input attachment and a color or
depth/stencil attachment, then each use <strong class="purple">must</strong> use the same <code>layout</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubpassDescription-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkSubpassDescriptionFlagBits">VkSubpassDescriptionFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pipelineBindPoint-parameter"></a> <code>pipelineBindPoint</code> <strong class="purple">must</strong> be a valid <a href="#VkPipelineBindPoint">VkPipelineBindPoint</a> value</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pInputAttachments-parameter"></a> If <code>inputAttachmentCount</code> is not <code>0</code>, <code>pInputAttachments</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>inputAttachmentCount</code> valid <code>VkAttachmentReference</code> structures</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pColorAttachments-parameter"></a> If <code>colorAttachmentCount</code> is not <code>0</code>, <code>pColorAttachments</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>colorAttachmentCount</code> valid <code>VkAttachmentReference</code> structures</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pResolveAttachments-parameter"></a> If <code>colorAttachmentCount</code> is not <code>0</code>, and <code>pResolveAttachments</code> is not <code>NULL</code>, <code>pResolveAttachments</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>colorAttachmentCount</code> valid <code>VkAttachmentReference</code> structures</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pDepthStencilAttachment-parameter"></a> If <code>pDepthStencilAttachment</code> is not <code>NULL</code>, <code>pDepthStencilAttachment</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAttachmentReference</code> structure</p>
</li>
<li>
<p><a id="VUID-VkSubpassDescription-pPreserveAttachments-parameter"></a> If <code>preserveAttachmentCount</code> is not <code>0</code>, <code>pPreserveAttachments</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>preserveAttachmentCount</code> <code>uint32_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkSubpassDescription">VkSubpassDescription</a>::<code>flags</code>,
specifying usage of the subpass, are:</p>
</div>
<div id="VkSubpassDescriptionFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkSubpassDescriptionFlagBits {
} VkSubpassDescriptionFlagBits;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>All bits for this type are defined by extensions, and none of those
extensions are enabled in this build of the specification.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSubpassDescriptionFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkSubpassDescriptionFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSubpassDescriptionFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkSubpassDescriptionFlagBits">VkSubpassDescriptionFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAttachmentReference</code> structure is defined as:</p>
</div>
<div id="VkAttachmentReference" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkAttachmentReference {
    uint32_t         attachment;
    VkImageLayout    layout;
} VkAttachmentReference;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>attachment</code> is the index of the attachment of the render pass, and
corresponds to the index of the corresponding element in the
<code>pAttachments</code> array of the <code>VkRenderPassCreateInfo</code> structure.
If any color or depth/stencil attachments are
<code>VK_ATTACHMENT_UNUSED</code>, then no writes occur for those attachments.</p>
</li>
<li>
<p><code>layout</code> is a <a href="#VkImageLayout">VkImageLayout</a> value specifying the layout the
attachment uses during the subpass.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAttachmentReference-layout-00857"></a>
<code>layout</code> <strong class="purple">must</strong> not be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAttachmentReference-layout-parameter"></a> <code>layout</code> <strong class="purple">must</strong> be a valid <a href="#VkImageLayout">VkImageLayout</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSubpassDependency</code> structure is defined as:</p>
</div>
<div id="VkSubpassDependency" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkSubpassDependency {
    uint32_t                srcSubpass;
    uint32_t                dstSubpass;
    VkPipelineStageFlags    srcStageMask;
    VkPipelineStageFlags    dstStageMask;
    VkAccessFlags           srcAccessMask;
    VkAccessFlags           dstAccessMask;
    VkDependencyFlags       dependencyFlags;
} VkSubpassDependency;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>srcSubpass</code> is the subpass index of the first subpass in the
dependency, or <code>VK_SUBPASS_EXTERNAL</code>.</p>
</li>
<li>
<p><code>dstSubpass</code> is the subpass index of the second subpass in the
dependency, or <code>VK_SUBPASS_EXTERNAL</code>.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages-masks">source stage
mask</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="#synchronization-pipeline-stages-masks">destination
stage mask</a></p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>dependencyFlags</code> is a bitmask of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>srcSubpass</code> is equal to <code>dstSubpass</code> then the
<a href="#VkSubpassDependency">VkSubpassDependency</a> describes a
<a href="#synchronization-pipeline-barriers-subpass-self-dependencies">subpass
self-dependency</a>, and only constrains the pipeline barriers allowed within
a subpass instance.
Otherwise, when a render pass instance which includes a subpass dependency
is submitted to a queue, it defines a memory dependency between the
subpasses identified by <code>srcSubpass</code> and <code>dstSubpass</code>.</p>
</div>
<div class="paragraph">
<p>If <code>srcSubpass</code> is equal to <code>VK_SUBPASS_EXTERNAL</code>, the first
<a href="#synchronization-dependencies-scopes">synchronization scope</a> includes
commands that occur earlier in <a href="#synchronization-submission-order">submission
order</a> than the <a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a> used to begin the render pass
instance.
Otherwise, the first set of commands includes all commands submitted as part
of the subpass instance identified by <code>srcSubpass</code> and any load, store
or multisample resolve operations on attachments used in <code>srcSubpass</code>.
In either case, the first synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstSubpass</code> is equal to <code>VK_SUBPASS_EXTERNAL</code>, the second
<a href="#synchronization-dependencies-scopes">synchronization scope</a> includes
commands that occur later in <a href="#synchronization-submission-order">submission
order</a> than the <a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a> used to end the render pass
instance.
Otherwise, the second set of commands includes all commands submitted as
part of the subpass instance identified by <code>dstSubpass</code> and any load,
store or multisample resolve operations on attachments used in
<code>dstSubpass</code>.
In either case, the second synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
It is also limited to access types in the <a href="#synchronization-access-masks">source access mask</a> specified by <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="#synchronization-dependencies-access-scopes">access scope</a> is
limited to access in the pipeline stages determined by the
<a href="#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
It is also limited to access types in the <a href="#synchronization-access-masks">destination access mask</a> specified by <code>dstAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="#synchronization-dependencies-available-and-visible">availability and
visibility operations</a> defined by a subpass dependency affect the execution
of <a href="#renderpass-layout-transitions">image layout transitions</a> within the
render pass.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For non-attachment resources, the memory dependency expressed by subpass
dependency is nearly identical to that of a <a href="#VkMemoryBarrier">VkMemoryBarrier</a> (with
matching <code>srcAccessMask</code>/<code>dstAccessMask</code> parameters) submitted as a
part of a <a href="#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> (with matching
<code>srcStageMask</code>/<code>dstStageMask</code> parameters).
The only difference being that its scopes are limited to the identified
subpasses rather than potentially affecting everything before and after.</p>
</div>
<div class="paragraph">
<p>For attachments however, subpass dependencies work more like a
<a href="#VkImageMemoryBarrier">VkImageMemoryBarrier</a> defined similarly to the <a href="#VkMemoryBarrier">VkMemoryBarrier</a>
above, the queue family indices set to <code>VK_QUEUE_FAMILY_IGNORED</code>, and
layouts as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The equivalent to <code>oldLayout</code> is the attachment&#8217;s layout according
to the subpass description for <code>srcSubpass</code>.</p>
</li>
<li>
<p>The equivalent to <code>newLayout</code> is the attachment&#8217;s layout according
to the subpass description for <code>dstSubpass</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubpassDependency-srcSubpass-00858"></a>
If <code>srcSubpass</code> is not <code>VK_SUBPASS_EXTERNAL</code>, <code>srcStageMask</code>
<strong class="purple">must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstSubpass-00859"></a>
If <code>dstSubpass</code> is not <code>VK_SUBPASS_EXTERNAL</code>, <code>dstStageMask</code>
<strong class="purple">must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcStageMask-00860"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstStageMask-00861"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcStageMask-00862"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstStageMask-00863"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcSubpass-00864"></a>
<code>srcSubpass</code> <strong class="purple">must</strong> be less than or equal to <code>dstSubpass</code>, unless
one of them is <code>VK_SUBPASS_EXTERNAL</code>, to avoid cyclic dependencies
and ensure a valid execution order</p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcSubpass-00865"></a>
<code>srcSubpass</code> and <code>dstSubpass</code> <strong class="purple">must</strong> not both be equal to
<code>VK_SUBPASS_EXTERNAL</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcSubpass-01989"></a>
If <code>srcSubpass</code> is equal to <code>dstSubpass</code>, <code>srcStageMask</code> and
<code>dstStageMask</code> <strong class="purple">must</strong> not set any bits that are neither
<code>VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</code>, nor one of the
<a href="#synchronization-pipeline-stages-types">graphics pipeline stages</a></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcSubpass-00867"></a>
If <code>srcSubpass</code> is equal to <code>dstSubpass</code> and not all of the
stages in <code>srcStageMask</code> and <code>dstStageMask</code> are
<a href="#synchronization-framebuffer-regions">framebuffer-space stages</a>, the
<a href="#synchronization-pipeline-stages-order">logically latest</a> pipeline
stage in <code>srcStageMask</code> <strong class="purple">must</strong> be
<a href="#synchronization-pipeline-stages-order">logically earlier</a> than or
equal to the <a href="#synchronization-pipeline-stages-order">logically
earliest</a> pipeline stage in <code>dstStageMask</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcAccessMask-00868"></a>
Any access flag included in <code>srcAccessMask</code> <strong class="purple">must</strong> be supported by
one of the pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstAccessMask-00869"></a>
Any access flag included in <code>dstAccessMask</code> <strong class="purple">must</strong> be supported by
one of the pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcSubpass-02243"></a>
If <code>srcSubpass</code> equals <code>dstSubpass</code>, and <code>srcStageMask</code> and
<code>dstStageMask</code> both include a
<a href="#synchronization-framebuffer-regions">framebuffer-space stage</a>, then
<code>dependencyFlags</code> <strong class="purple">must</strong> include <code>VK_DEPENDENCY_BY_REGION_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSubpassDependency-srcStageMask-parameter"></a> <code>srcStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcStageMask-requiredbitmask"></a> <code>srcStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstStageMask-parameter"></a> <code>dstStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstStageMask-requiredbitmask"></a> <code>dstStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-srcAccessMask-parameter"></a> <code>srcAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dstAccessMask-parameter"></a> <code>dstAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkSubpassDependency-dependencyFlags-parameter"></a> <code>dependencyFlags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkDependencyFlagBits">VkDependencyFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If there is no subpass dependency from <code>VK_SUBPASS_EXTERNAL</code> to the
first subpass that uses an attachment, then an implicit subpass dependency
exists from <code>VK_SUBPASS_EXTERNAL</code> to the first subpass it is used in.
The subpass dependency operates as if defined with the following parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c">VkSubpassDependency implicitDependency = {
    .srcSubpass = VK_SUBPASS_EXTERNAL;
    .dstSubpass = firstSubpass; <span class="comment">// First subpass attachment is used in</span>
    .srcStageMask = VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT;
    .dstStageMask = VK_PIPELINE_STAGE_ALL_COMMANDS_BIT;
    .srcAccessMask = <span class="integer">0</span>;
    .dstAccessMask = VK_ACCESS_INPUT_ATTACHMENT_READ_BIT |
                     VK_ACCESS_COLOR_ATTACHMENT_READ_BIT |
                     VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT |
                     VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT |
                     VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT;
    .dependencyFlags = <span class="integer">0</span>;
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, if there is no subpass dependency from the last subpass that uses
an attachment to <code>VK_SUBPASS_EXTERNAL</code>, then an implicit subpass
dependency exists from the last subpass it is used in to
<code>VK_SUBPASS_EXTERNAL</code>.
The subpass dependency operates as if defined with the following parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c">VkSubpassDependency implicitDependency = {
    .srcSubpass = lastSubpass; <span class="comment">// Last subpass attachment is used in</span>
    .dstSubpass = VK_SUBPASS_EXTERNAL;
    .srcStageMask = VK_PIPELINE_STAGE_ALL_COMMANDS_BIT;
    .dstStageMask = VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT;
    .srcAccessMask = VK_ACCESS_INPUT_ATTACHMENT_READ_BIT |
                     VK_ACCESS_COLOR_ATTACHMENT_READ_BIT |
                     VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT |
                     VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT |
                     VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT;
    .dstAccessMask = <span class="integer">0</span>;
    .dependencyFlags = <span class="integer">0</span>;
};</code></pre>
</div>
</div>
<div id="renderpass-layout-transitions" class="paragraph">
<p>As subpasses <strong class="purple">may</strong> overlap or execute out of order with regards to other
subpasses unless a subpass dependency chain describes otherwise, the layout
transitions required between subpasses <strong class="purple">cannot</strong> be known to an application.
Instead, an application provides the layout that each attachment <strong class="purple">must</strong> be in
at the start and end of a render pass, and the layout it <strong class="purple">must</strong> be in during
each subpass it is used in.
The implementation then <strong class="purple">must</strong> execute layout transitions between subpasses
in order to guarantee that the images are in the layouts required by each
subpass, and in the final layout at the end of the render pass.</p>
</div>
<div class="paragraph">
<p>Automatic layout transitions apply to the entire image subresource attached
to the framebuffer.</p>
</div>
<div class="paragraph">
<p>Automatic layout transitions away from the layout used in a subpass
happen-after the availability operations for all dependencies with that
subpass as the <code>srcSubpass</code>.</p>
</div>
<div class="paragraph">
<p>Automatic layout transitions into the layout used in a subpass happen-before
the visibility operations for all dependencies with that subpass as the
<code>dstSubpass</code>.</p>
</div>
<div class="paragraph">
<p>Automatic layout transitions away from <code>initialLayout</code> happens-after the
availability operations for all dependencies with a <code>srcSubpass</code> equal
to <code>VK_SUBPASS_EXTERNAL</code>, where <code>dstSubpass</code> uses the attachment
that will be transitioned.
For attachments created with <code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code>,
automatic layout transitions away from <code>initialLayout</code> happen-after the
availability operations for all dependencies with a <code>srcSubpass</code> equal
to <code>VK_SUBPASS_EXTERNAL</code>, where <code>dstSubpass</code> uses any aliased
attachment.</p>
</div>
<div class="paragraph">
<p>Automatic layout transitions into <code>finalLayout</code> happens-before the
visibility operations for all dependencies with a <code>dstSubpass</code> equal to
<code>VK_SUBPASS_EXTERNAL</code>, where <code>srcSubpass</code> uses the attachment that
will be transitioned.
For attachments created with <code>VK_ATTACHMENT_DESCRIPTION_MAY_ALIAS_BIT</code>,
automatic layout transitions into <code>finalLayout</code> happen-before the
visibility operations for all dependencies with a <code>dstSubpass</code> equal to
<code>VK_SUBPASS_EXTERNAL</code>, where <code>srcSubpass</code> uses any aliased
attachment.</p>
</div>
<div class="paragraph">
<p>If two subpasses use the same attachment in different layouts, and both
layouts are read-only, no subpass dependency needs to be specified between
those subpasses.
If an implementation treats those layouts separately, it <strong class="purple">must</strong> insert an
implicit subpass dependency between those subpasses to separate the uses in
each layout.
The subpass dependency operates as if defined with the following parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="comment">// Used for input attachments</span>
VkPipelineStageFlags inputAttachmentStages = VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT;
VkAccessFlags inputAttachmentAccess = VK_ACCESS_INPUT_ATTACHMENT_READ_BIT;

<span class="comment">// Used for depth/stencil attachments</span>
VkPipelineStageFlags depthStencilAttachmentStages = VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT | VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT;
VkAccessFlags depthStencilAttachmentAccess = VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT;

VkSubpassDependency implicitDependency = {
    .srcSubpass = firstSubpass;
    .dstSubpass = secondSubpass;
    .srcStageMask = inputAttachmentStages | depthStencilAttachmentStages;
    .dstStageMask = inputAttachmentStages | depthStencilAttachmentStages;
    .srcAccessMask = inputAttachmentAccess | depthStencilAttachmentAccess;
    .dstAccessMask = inputAttachmentAccess | depthStencilAttachmentAccess;
    .dependencyFlags = <span class="integer">0</span>;
};</code></pre>
</div>
</div>
<div id="renderpass-feedbackloop" class="paragraph">
<p>If a subpass uses the same attachment as both an input attachment and either
a color attachment or a depth/stencil attachment, writes via the color or
depth/stencil attachment are not automatically made visible to reads via the
input attachment, causing a <em>feedback loop</em>, except in any of the following
conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the color components or depth/stencil components read by the input
attachment are mutually exclusive with the components written by the
color or depth/stencil attachments, then there is no feedback loop.
This requires the graphics pipelines used by the subpass to disable
writes to color components that are read as inputs via the
<code>colorWriteMask</code>, and to disable writes to depth/stencil components
that are read as inputs via <code>depthWriteEnable</code> or
<code>stencilTestEnable</code>.</p>
</li>
<li>
<p>If the attachment is used as an input attachment and depth/stencil
attachment only, and the depth/stencil attachment is not written to.</p>
</li>
<li>
<p>If a memory dependency is inserted between when the attachment is
written and when it is subsequently read by later fragments.
<a href="#synchronization-pipeline-barriers">Pipeline barriers</a> expressing a
<a href="#synchronization-pipeline-barriers-subpass-self-dependencies">subpass
self-dependency</a> are the only way to achieve this, and one <strong class="purple">must</strong> be
inserted every time a fragment will read values at a particular sample
(x, y, layer, sample) coordinate, if those values have been written
since the most recent pipeline barrier; or the since start of the
subpass if there have been no pipeline barriers since the start of the
subpass.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An attachment used as both an input attachment and a color attachment <strong class="purple">must</strong>
be in the
<code>VK_IMAGE_LAYOUT_GENERAL</code> layout.
An attachment used as an input attachment and depth/stencil attachment <strong class="purple">must</strong>
be in the
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code>, or
<code>VK_IMAGE_LAYOUT_GENERAL</code> layout.
An attachment <strong class="purple">must</strong> not be used as both a depth/stencil attachment and a
color attachment.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a render pass, call:</p>
</div>
<div id="vkDestroyRenderPass" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyRenderPass(
    VkDevice                                    device,
    VkRenderPass                                renderPass,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the render pass.</p>
</li>
<li>
<p><code>renderPass</code> is the handle of the render pass to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyRenderPass-renderPass-00873"></a>
All submitted commands that refer to <code>renderPass</code> <strong class="purple">must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyRenderPass-renderPass-00874"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>renderPass</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyRenderPass-renderPass-00875"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>renderPass</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyRenderPass-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyRenderPass-renderPass-parameter"></a> If <code>renderPass</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>renderPass</code> <strong class="purple">must</strong> be a valid <code>VkRenderPass</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyRenderPass-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyRenderPass-renderPass-parent"></a> If <code>renderPass</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>renderPass</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="renderpass-compatibility">7.2. Render Pass Compatibility</h3>
<div class="paragraph">
<p>Framebuffers and graphics pipelines are created based on a specific render
pass object.
They <strong class="purple">must</strong> only be used with that render pass object, or one compatible with
it.</p>
</div>
<div class="paragraph">
<p>Two attachment references are compatible if they have matching format and
sample count, or are both <code>VK_ATTACHMENT_UNUSED</code> or the pointer that
would contain the reference is <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p>Two arrays of attachment references are compatible if all corresponding
pairs of attachments are compatible.
If the arrays are of different lengths, attachment references not present in
the smaller array are treated as <code>VK_ATTACHMENT_UNUSED</code>.</p>
</div>
<div class="paragraph">
<p>Two render passes are compatible if their corresponding color, input,
resolve, and depth/stencil attachment references are compatible and if they
are otherwise identical except for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initial and final image layout in attachment descriptions</p>
</li>
<li>
<p>Load and store operations in attachment descriptions</p>
</li>
<li>
<p>Image layout in attachment references</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A framebuffer is compatible with a render pass if it was created using the
same render pass or a compatible render pass.</p>
</div>
</div>
<div class="sect2">
<h3 id="_framebuffers">7.3. Framebuffers</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Render passes operate in conjunction with <em>framebuffers</em>.
Framebuffers represent a collection of specific memory attachments that a
render pass instance uses.</p>
</div>
<div class="paragraph">
<p>Framebuffers are represented by <code>VkFramebuffer</code> handles:</p>
</div>
<div id="VkFramebuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkFramebuffer)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a framebuffer, call:</p>
</div>
<div id="vkCreateFramebuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateFramebuffer(
    VkDevice                                    device,
    <span class="directive">const</span> VkFramebufferCreateInfo*              pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkFramebuffer*                              pFramebuffer);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the framebuffer.</p>
</li>
<li>
<p><code>pCreateInfo</code> points to a <a href="#VkFramebufferCreateInfo">VkFramebufferCreateInfo</a> structure
which describes additional information about framebuffer creation.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pFramebuffer</code> points to a <a href="#VkFramebuffer">VkFramebuffer</a> handle in which the
resulting framebuffer object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateFramebuffer-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateFramebuffer-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkFramebufferCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFramebuffer-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFramebuffer-pFramebuffer-parameter"></a> <code>pFramebuffer</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkFramebuffer</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFramebufferCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkFramebufferCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkFramebufferCreateInfo {
    VkStructureType             sType;
    <span class="directive">const</span> <span class="directive">void</span>*                 pNext;
    VkFramebufferCreateFlags    flags;
    VkRenderPass                renderPass;
    uint32_t                    attachmentCount;
    <span class="directive">const</span> VkImageView*          pAttachments;
    uint32_t                    width;
    uint32_t                    height;
    uint32_t                    layers;
} VkFramebufferCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>renderPass</code> is a render pass that defines what render passes the
framebuffer will be compatible with.
See <a href="#renderpass-compatibility">Render Pass Compatibility</a> for details.</p>
</li>
<li>
<p><code>attachmentCount</code> is the number of attachments.</p>
</li>
<li>
<p><code>pAttachments</code> is an array of <a href="#VkImageView">VkImageView</a> handles, each of
which will be used as the corresponding attachment in a render pass
instance.</p>
</li>
<li>
<p><code>width</code>, <code>height</code> and <code>layers</code> define the dimensions of the
framebuffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">must</strong> ensure that all accesses to memory that backs image
subresources used as attachments in a given renderpass instance either
happen-before the <a href="#renderpass-load-store-ops">load operations</a> for those
attachments, or happen-after the <a href="#renderpass-load-store-ops">store
operations</a> for those attachments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This restriction means
that the render pass has full knowledge of all uses of all of the
attachments, so that the implementation is able to make correct decisions
about when and how to perform layout transitions, when to overlap execution
of subpasses, etc.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="renderpass-noattachments" class="paragraph">
<p>It is legal for a subpass to use no color or depth/stencil attachments, and
rather use shader side effects such as image stores and atomics to produce
an output.
In this case, the subpass continues to use the <code>width</code>, <code>height</code>,
and <code>layers</code> of the framebuffer to define the dimensions of the
rendering area, and the <code>rasterizationSamples</code> from each pipeline&#8217;s
<a href="#VkPipelineMultisampleStateCreateInfo">VkPipelineMultisampleStateCreateInfo</a> to define the number of samples
used in rasterization; however, if
<a href="#VkPhysicalDeviceFeatures">VkPhysicalDeviceFeatures</a>::<code>variableMultisampleRate</code> is
<code>VK_FALSE</code>, then all pipelines to be bound with a given zero-attachment
subpass <strong class="purple">must</strong> have the same value for
<a href="#VkPipelineMultisampleStateCreateInfo">VkPipelineMultisampleStateCreateInfo</a>::<code>rasterizationSamples</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-attachmentCount-00876"></a>
<code>attachmentCount</code> <strong class="purple">must</strong> be equal to the attachment count specified
in <code>renderPass</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00877"></a>
Each element of <code>pAttachments</code> that is used as a color attachment or
resolve attachment by <code>renderPass</code> <strong class="purple">must</strong> have been created with a
<code>usage</code> value including <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00878"></a>
Each element of <code>pAttachments</code> that is used as a depth/stencil
attachment by <code>renderPass</code> <strong class="purple">must</strong> have been created with a
<code>usage</code> value including
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00879"></a>
Each element of <code>pAttachments</code> that is used as an input attachment
by <code>renderPass</code> <strong class="purple">must</strong> have been created with a <code>usage</code> value
including <code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00880"></a>
Each element of <code>pAttachments</code> <strong class="purple">must</strong> have been created with an
<a href="#VkFormat">VkFormat</a> value that matches the <a href="#VkFormat">VkFormat</a> specified by the
corresponding <code>VkAttachmentDescription</code> in <code>renderPass</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00881"></a>
Each element of <code>pAttachments</code> <strong class="purple">must</strong> have been created with a
<code>samples</code> value that matches the <code>samples</code> value specified by
the corresponding <code>VkAttachmentDescription</code> in <code>renderPass</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00882"></a>
Each element of <code>pAttachments</code> <strong class="purple">must</strong> have dimensions at least as
large as the corresponding framebuffer dimension</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00883"></a>
Each element of <code>pAttachments</code> <strong class="purple">must</strong> only specify a single mip level</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-00884"></a>
Each element of <code>pAttachments</code> <strong class="purple">must</strong> have been created with the
identity swizzle</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-width-00885"></a>
<code>width</code> <strong class="purple">must</strong> be greater than <code>0</code>.</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-width-00886"></a>
<code>width</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxFramebufferWidth</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-height-00887"></a>
<code>height</code> <strong class="purple">must</strong> be greater than <code>0</code>.</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-height-00888"></a>
<code>height</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxFramebufferHeight</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-layers-00889"></a>
<code>layers</code> <strong class="purple">must</strong> be greater than <code>0</code>.</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-layers-00890"></a>
<code>layers</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxFramebufferLayers</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_FRAMEBUFFER_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-renderPass-parameter"></a> <code>renderPass</code> <strong class="purple">must</strong> be a valid <code>VkRenderPass</code> handle</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-pAttachments-parameter"></a> If <code>attachmentCount</code> is not <code>0</code>, <code>pAttachments</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>attachmentCount</code> valid <code>VkImageView</code> handles</p>
</li>
<li>
<p><a id="VUID-VkFramebufferCreateInfo-commonparent"></a> Both of <code>renderPass</code>, and the elements of <code>pAttachments</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFramebufferCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkFramebufferCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkFramebufferCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a framebuffer, call:</p>
</div>
<div id="vkDestroyFramebuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyFramebuffer(
    VkDevice                                    device,
    VkFramebuffer                               framebuffer,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the framebuffer.</p>
</li>
<li>
<p><code>framebuffer</code> is the handle of the framebuffer to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFramebuffer-framebuffer-00892"></a>
All submitted commands that refer to <code>framebuffer</code> <strong class="purple">must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyFramebuffer-framebuffer-00893"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>framebuffer</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyFramebuffer-framebuffer-00894"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>framebuffer</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFramebuffer-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFramebuffer-framebuffer-parameter"></a> If <code>framebuffer</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>framebuffer</code> <strong class="purple">must</strong> be a valid <code>VkFramebuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFramebuffer-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyFramebuffer-framebuffer-parent"></a> If <code>framebuffer</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>framebuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="renderpass-commands">7.4. Render Pass Commands</h3>
<div class="paragraph">
<p>An application records the commands for a render pass instance one subpass
at a time, by beginning a render pass instance, iterating over the subpasses
to record commands for that subpass, and then ending the render pass
instance.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin a render pass instance, call:</p>
</div>
<div id="vkCmdBeginRenderPass" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdBeginRenderPass(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkRenderPassBeginInfo*                pRenderPassBegin,
    VkSubpassContents                           contents);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pRenderPassBegin</code> is a pointer to a <a href="#VkRenderPassBeginInfo">VkRenderPassBeginInfo</a>
structure (defined below) which specifies the render pass to begin an
instance of, and the framebuffer the instance uses.</p>
</li>
<li>
<p><code>contents</code> is a <a href="#VkSubpassContents">VkSubpassContents</a> value specifying how the
commands in the first subpass will be provided.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After beginning a render pass instance, the command buffer is ready to
record the commands for the first subpass of that render pass.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-initialLayout-00895"></a>
If any of the <code>initialLayout</code> or <code>finalLayout</code> member of the
<code>VkAttachmentDescription</code> structures or the <code>layout</code> member of
the <code>VkAttachmentReference</code> structures specified when creating the
render pass specified in the <code>renderPass</code> member of
<code>pRenderPassBegin</code> is <code>VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</code>
then the corresponding attachment image subresource of the framebuffer
specified in the <code>framebuffer</code> member of <code>pRenderPassBegin</code>
<strong class="purple">must</strong> have been created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code>
set</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-initialLayout-00896"></a>
If any of the <code>initialLayout</code> or <code>finalLayout</code> member of the
<code>VkAttachmentDescription</code> structures or the <code>layout</code> member of
the <code>VkAttachmentReference</code> structures specified when creating the
render pass specified in the <code>renderPass</code> member of
<code>pRenderPassBegin</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL</code>, or
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> then the
corresponding attachment image subresource of the framebuffer specified
in the <code>framebuffer</code> member of <code>pRenderPassBegin</code> <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-initialLayout-00897"></a>
If any of the <code>initialLayout</code> or <code>finalLayout</code> member of the
<code>VkAttachmentDescription</code> structures or the <code>layout</code> member of
the <code>VkAttachmentReference</code> structures specified when creating the
render pass specified in the <code>renderPass</code> member of
<code>pRenderPassBegin</code> is <code>VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL</code>
then the corresponding attachment image subresource of the framebuffer
specified in the <code>framebuffer</code> member of <code>pRenderPassBegin</code>
<strong class="purple">must</strong> have been created with <code>VK_IMAGE_USAGE_SAMPLED_BIT</code> or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-initialLayout-00898"></a>
If any of the <code>initialLayout</code> or <code>finalLayout</code> member of the
<code>VkAttachmentDescription</code> structures or the <code>layout</code> member of
the <code>VkAttachmentReference</code> structures specified when creating the
render pass specified in the <code>renderPass</code> member of
<code>pRenderPassBegin</code> is <code>VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL</code>
then the corresponding attachment image subresource of the framebuffer
specified in the <code>framebuffer</code> member of <code>pRenderPassBegin</code>
<strong class="purple">must</strong> have been created with <code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-initialLayout-00899"></a>
If any of the <code>initialLayout</code> or <code>finalLayout</code> member of the
<code>VkAttachmentDescription</code> structures or the <code>layout</code> member of
the <code>VkAttachmentReference</code> structures specified when creating the
render pass specified in the <code>renderPass</code> member of
<code>pRenderPassBegin</code> is <code>VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL</code>
then the corresponding attachment image subresource of the framebuffer
specified in the <code>framebuffer</code> member of <code>pRenderPassBegin</code>
<strong class="purple">must</strong> have been created with <code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code> set</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-initialLayout-00900"></a>
If any of the <code>initialLayout</code> members of the
<code>VkAttachmentDescription</code> structures specified when creating the
render pass specified in the <code>renderPass</code> member of
<code>pRenderPassBegin</code> is not <code>VK_IMAGE_LAYOUT_UNDEFINED</code>, then each
such <code>initialLayout</code> <strong class="purple">must</strong> be equal to the current layout of the
corresponding attachment image subresource of the framebuffer specified
in the <code>framebuffer</code> member of <code>pRenderPassBegin</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-srcStageMask-00901"></a>
The <code>srcStageMask</code> and <code>dstStageMask</code> members of any element of
the <code>pDependencies</code> member of <a href="#VkRenderPassCreateInfo">VkRenderPassCreateInfo</a> used to
create <code>renderPass</code> <strong class="purple">must</strong> be supported by the capabilities of the
queue family identified by the <code>queueFamilyIndex</code> member of the
<a href="#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a> used to create the command pool which
<code>commandBuffer</code> was allocated from.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-pRenderPassBegin-parameter"></a> <code>pRenderPassBegin</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkRenderPassBeginInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-contents-parameter"></a> <code>contents</code> <strong class="purple">must</strong> be a valid <a href="#VkSubpassContents">VkSubpassContents</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginRenderPass-bufferlevel"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkRenderPassBeginInfo</code> structure is defined as:</p>
</div>
<div id="VkRenderPassBeginInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkRenderPassBeginInfo {
    VkStructureType        sType;
    <span class="directive">const</span> <span class="directive">void</span>*            pNext;
    VkRenderPass           renderPass;
    VkFramebuffer          framebuffer;
    VkRect2D               renderArea;
    uint32_t               clearValueCount;
    <span class="directive">const</span> VkClearValue*    pClearValues;
} VkRenderPassBeginInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>renderPass</code> is the render pass to begin an instance of.</p>
</li>
<li>
<p><code>framebuffer</code> is the framebuffer containing the attachments that are
used with the render pass.</p>
</li>
<li>
<p><code>renderArea</code> is the render area that is affected by the render pass
instance, and is described in more detail below.</p>
</li>
<li>
<p><code>clearValueCount</code> is the number of elements in <code>pClearValues</code>.</p>
</li>
<li>
<p><code>pClearValues</code> is an array of <a href="#VkClearValue">VkClearValue</a> structures that
contains clear values for each attachment, if the attachment uses a
<code>loadOp</code> value of <code>VK_ATTACHMENT_LOAD_OP_CLEAR</code> or if the
attachment has a depth/stencil format and uses a <code>stencilLoadOp</code>
value of <code>VK_ATTACHMENT_LOAD_OP_CLEAR</code>.
The array is indexed by attachment number.
Only elements corresponding to cleared attachments are used.
Other elements of <code>pClearValues</code> are ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>renderArea</code> is the render area that is affected by the render pass
instance.
The effects of attachment load, store and multisample resolve operations are
restricted to the pixels whose x and y coordinates fall within the render
area on all attachments.
The render area extends to all layers of <code>framebuffer</code>.
The application <strong class="purple">must</strong> ensure (using scissor if necessary) that all rendering
is contained within the render area, otherwise the pixels outside of the
render area become undefined and shader side effects <strong class="purple">may</strong> occur for
fragments outside the render area.
The render area <strong class="purple">must</strong> be contained within the framebuffer dimensions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There <strong class="purple">may</strong> be a performance cost for using a render area smaller than the
framebuffer, unless it matches the render area granularity for the render
pass.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-clearValueCount-00902"></a>
<code>clearValueCount</code> <strong class="purple">must</strong> be greater than the largest attachment index
in <code>renderPass</code> that specifies a <code>loadOp</code> (or
<code>stencilLoadOp</code>, if the attachment has a depth/stencil format) of
<code>VK_ATTACHMENT_LOAD_OP_CLEAR</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-clearValueCount-00903"></a>
If <code>clearValueCount</code> is not <code>0</code>, <code>pClearValues</code> <strong class="purple">must</strong> be a valid
pointer to an array of <code>clearValueCount</code> valid <code>VkClearValue</code>
unions</p>
</li>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-renderPass-00904"></a>
<code>renderPass</code> <strong class="purple">must</strong> be <a href="#renderpass-compatibility">compatible</a> with
the <code>renderPass</code> member of the <code>VkFramebufferCreateInfo</code>
structure specified when creating <code>framebuffer</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_RENDER_PASS_BEGIN_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-renderPass-parameter"></a> <code>renderPass</code> <strong class="purple">must</strong> be a valid <code>VkRenderPass</code> handle</p>
</li>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-framebuffer-parameter"></a> <code>framebuffer</code> <strong class="purple">must</strong> be a valid <code>VkFramebuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-VkRenderPassBeginInfo-commonparent"></a> Both of <code>framebuffer</code>, and <code>renderPass</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a>::<code>contents</code>, specifying
how the commands in the first subpass will be provided, are:</p>
</div>
<div id="VkSubpassContents" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkSubpassContents {
    VK_SUBPASS_CONTENTS_INLINE = <span class="integer">0</span>,
    VK_SUBPASS_CONTENTS_SECONDARY_COMMAND_BUFFERS = <span class="integer">1</span>,
} VkSubpassContents;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUBPASS_CONTENTS_INLINE</code> specifies that the contents of the
subpass will be recorded inline in the primary command buffer, and
secondary command buffers <strong class="purple">must</strong> not be executed within the subpass.</p>
</li>
<li>
<p><code>VK_SUBPASS_CONTENTS_SECONDARY_COMMAND_BUFFERS</code> specifies that the
contents are recorded in secondary command buffers that will be called
from the primary command buffer, and <a href="#vkCmdExecuteCommands">vkCmdExecuteCommands</a> is the
only valid command on the command buffer until <a href="#vkCmdNextSubpass">vkCmdNextSubpass</a> or
<a href="#vkCmdEndRenderPass">vkCmdEndRenderPass</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the render area granularity, call:</p>
</div>
<div id="vkGetRenderAreaGranularity" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetRenderAreaGranularity(
    VkDevice                                    device,
    VkRenderPass                                renderPass,
    VkExtent2D*                                 pGranularity);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the render pass.</p>
</li>
<li>
<p><code>renderPass</code> is a handle to a render pass.</p>
</li>
<li>
<p><code>pGranularity</code> points to a <a href="#VkExtent2D">VkExtent2D</a> structure in which the
granularity is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The conditions leading to an optimal <code>renderArea</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>offset.x</code> member in <code>renderArea</code> is a multiple of the
<code>width</code> member of the returned <a href="#VkExtent2D">VkExtent2D</a> (the horizontal
granularity).</p>
</li>
<li>
<p>the <code>offset.y</code> member in <code>renderArea</code> is a multiple of the
<code>height</code> of the returned <a href="#VkExtent2D">VkExtent2D</a> (the vertical
granularity).</p>
</li>
<li>
<p>either the <code>offset.width</code> member in <code>renderArea</code> is a multiple
of the horizontal granularity or <code>offset.x</code>+<code>offset.width</code> is
equal to the <code>width</code> of the <code>framebuffer</code> in the
<a href="#VkRenderPassBeginInfo">VkRenderPassBeginInfo</a>.</p>
</li>
<li>
<p>either the <code>offset.height</code> member in <code>renderArea</code> is a multiple
of the vertical granularity or <code>offset.y</code>+<code>offset.height</code> is
equal to the <code>height</code> of the <code>framebuffer</code> in the
<a href="#VkRenderPassBeginInfo">VkRenderPassBeginInfo</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Subpass dependencies are not affected by the render area, and apply to the
entire image subresources attached to the framebuffer as specified in the
description of <a href="#renderpass-layout-transitions">automatic layout
transitions</a>.
Similarly, pipeline barriers are valid even if their effect extends outside
the render area.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetRenderAreaGranularity-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetRenderAreaGranularity-renderPass-parameter"></a> <code>renderPass</code> <strong class="purple">must</strong> be a valid <code>VkRenderPass</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetRenderAreaGranularity-pGranularity-parameter"></a> <code>pGranularity</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkExtent2D</code> structure</p>
</li>
<li>
<p><a id="VUID-vkGetRenderAreaGranularity-renderPass-parent"></a> <code>renderPass</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To transition to the next subpass in the render pass instance after
recording the commands for a subpass, call:</p>
</div>
<div id="vkCmdNextSubpass" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdNextSubpass(
    VkCommandBuffer                             commandBuffer,
    VkSubpassContents                           contents);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>contents</code> specifies how the commands in the next subpass will be
provided, in the same fashion as the corresponding parameter of
<a href="#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The subpass index for a render pass begins at zero when
<code>vkCmdBeginRenderPass</code> is recorded, and increments each time
<code>vkCmdNextSubpass</code> is recorded.</p>
</div>
<div class="paragraph">
<p>Moving to the next subpass automatically performs any multisample resolve
operations in the subpass being ended.
End-of-subpass multisample resolves are treated as color attachment writes
for the purposes of synchronization.
That is, they are considered to execute in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage and their
writes are synchronized with <code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code>.
Synchronization between rendering within a subpass and any resolve
operations at the end of the subpass occurs automatically, without need for
explicit dependencies or pipeline barriers.
However, if the resolve attachment is also used in a different subpass, an
explicit dependency is needed.</p>
</div>
<div class="paragraph">
<p>After transitioning to the next subpass, the application <strong class="purple">can</strong> record the
commands for that subpass.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdNextSubpass-None-00909"></a>
The current subpass index <strong class="purple">must</strong> be less than the number of subpasses in
the render pass minus one</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdNextSubpass-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdNextSubpass-contents-parameter"></a> <code>contents</code> <strong class="purple">must</strong> be a valid <a href="#VkSubpassContents">VkSubpassContents</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdNextSubpass-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdNextSubpass-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdNextSubpass-renderpass"></a> This command <strong class="purple">must</strong> only be called inside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdNextSubpass-bufferlevel"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record a command to end a render pass instance after recording the
commands for the last subpass, call:</p>
</div>
<div id="vkCmdEndRenderPass" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdEndRenderPass(
    VkCommandBuffer                             commandBuffer);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to end the current
render pass instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ending a render pass instance performs any multisample resolve operations on
the final subpass.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndRenderPass-None-00910"></a>
The current subpass index <strong class="purple">must</strong> be equal to the number of subpasses in
the render pass minus one</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndRenderPass-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndRenderPass-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndRenderPass-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEndRenderPass-renderpass"></a> This command <strong class="purple">must</strong> only be called inside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdEndRenderPass-bufferlevel"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="shaders">8. Shaders</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A shader specifies programmable operations that execute for each vertex,
control point, tessellated vertex, primitive, fragment, or workgroup in the
corresponding stage(s) of the graphics and compute pipelines.</p>
</div>
<div class="paragraph">
<p>Graphics pipelines include vertex shader execution as a result of
<a href="#drawing">primitive assembly</a>, followed, if enabled, by tessellation
control and evaluation shaders operating on
<a href="#drawing-primitive-topologies-patches">patches</a>, geometry shaders, if
enabled, operating on primitives, and fragment shaders, if present,
operating on fragments generated by <a href="#primsrast">Rasterization</a>.
In this specification, vertex, tessellation control, tessellation evaluation
and geometry shaders are collectively referred to as vertex processing
stages and occur in the logical pipeline before rasterization.
The fragment shader occurs logically after rasterization.</p>
</div>
<div class="paragraph">
<p>Only the compute shader stage is included in a compute pipeline.
Compute shaders operate on compute invocations in a workgroup.</p>
</div>
<div class="paragraph">
<p>Shaders <strong class="purple">can</strong> read from input variables, and read from and write to output
variables.
Input and output variables <strong class="purple">can</strong> be used to transfer data between shader
stages, or to allow the shader to interact with values that exist in the
execution environment.
Similarly, the execution environment provides constants that describe
capabilities.</p>
</div>
<div class="paragraph">
<p>Shader variables are associated with execution environment-provided inputs
and outputs using <em>built-in</em> decorations in the shader.
The available decorations for each stage are documented in the following
subsections.</p>
</div>
<div class="sect2">
<h3 id="shader-modules">8.1. Shader Modules</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><em>Shader modules</em> contain <em>shader code</em> and one or more entry points.
Shaders are selected from a shader module by specifying an entry point as
part of <a href="#pipelines">pipeline</a> creation.
The stages of a pipeline <strong class="purple">can</strong> use shaders that come from different modules.
The shader code defining a shader module <strong class="purple">must</strong> be in the SPIR-V format, as
described by the <a href="#spirvenv">Vulkan Environment for SPIR-V</a> appendix.</p>
</div>
<div class="paragraph">
<p>Shader modules are represented by <code>VkShaderModule</code> handles:</p>
</div>
<div id="VkShaderModule" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkShaderModule)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a shader module, call:</p>
</div>
<div id="vkCreateShaderModule" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateShaderModule(
    VkDevice                                    device,
    <span class="directive">const</span> VkShaderModuleCreateInfo*             pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkShaderModule*                             pShaderModule);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the shader module.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkShaderModuleCreateInfo</code> structure.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pShaderModule</code> points to a <a href="#VkShaderModule">VkShaderModule</a> handle in which the
resulting shader module object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once a shader module has been created, any entry points it contains <strong class="purple">can</strong> be
used in pipeline shader stages as described in <a href="#pipelines-compute">Compute
Pipelines</a> and <a href="#pipelines-graphics">Graphics Pipelines</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateShaderModule-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateShaderModule-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkShaderModuleCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateShaderModule-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateShaderModule-pShaderModule-parameter"></a> <code>pShaderModule</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkShaderModule</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkShaderModuleCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkShaderModuleCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkShaderModuleCreateInfo {
    VkStructureType              sType;
    <span class="directive">const</span> <span class="directive">void</span>*                  pNext;
    VkShaderModuleCreateFlags    flags;
    size_t                       codeSize;
    <span class="directive">const</span> uint32_t*              pCode;
} VkShaderModuleCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>codeSize</code> is the size, in bytes, of the code pointed to by
<code>pCode</code>.</p>
</li>
<li>
<p><code>pCode</code> points to code that is used to create the shader module.
The type and format of the code is determined from the content of the
memory addressed by <code>pCode</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-codeSize-01085"></a>
<code>codeSize</code> <strong class="purple">must</strong> be greater than 0</p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-codeSize-01086"></a>
<code>codeSize</code> <strong class="purple">must</strong> be a multiple of 4</p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pCode-01087"></a>
<code>pCode</code> <strong class="purple">must</strong> point to valid SPIR-V code, formatted and packed as
described by the <a href="#spirv-spec">Khronos SPIR-V Specification</a></p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pCode-01088"></a>
<code>pCode</code> <strong class="purple">must</strong> adhere to the validation rules described by the
<a href="#spirvenv-module-validation">Validation Rules within a Module</a> section
of the <a href="#spirvenv-capabilities">SPIR-V Environment</a> appendix</p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pCode-01089"></a>
<code>pCode</code> <strong class="purple">must</strong> declare the <code>Shader</code> capability for SPIR-V code</p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pCode-01090"></a>
<code>pCode</code> <strong class="purple">must</strong> not declare any capability that is not supported by
the API, as described by the <a href="#spirvenv-module-validation">Capabilities</a> section of the <a href="#spirvenv-capabilities">SPIR-V
Environment</a> appendix</p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pCode-01091"></a>
If <code>pCode</code> declares any of the capabilities listed as <strong class="purple">optional</strong> in
the <a href="#spirvenv-capabilities-table">SPIR-V Environment</a> appendix, the
corresponding feature(s) <strong class="purple">must</strong> be enabled.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_SHADER_MODULE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkShaderModuleCreateInfo-pCode-parameter"></a> <code>pCode</code> <strong class="purple">must</strong> be a valid pointer to an array of \(codeSize \over 4\) <code>uint32_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkShaderModuleCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkShaderModuleCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkShaderModuleCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a shader module, call:</p>
</div>
<div id="vkDestroyShaderModule" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyShaderModule(
    VkDevice                                    device,
    VkShaderModule                              shaderModule,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the shader module.</p>
</li>
<li>
<p><code>shaderModule</code> is the handle of the shader module to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A shader module <strong class="purple">can</strong> be destroyed while pipelines created using its shaders
are still in use.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyShaderModule-shaderModule-01092"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>shaderModule</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyShaderModule-shaderModule-01093"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>shaderModule</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyShaderModule-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyShaderModule-shaderModule-parameter"></a> If <code>shaderModule</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>shaderModule</code> <strong class="purple">must</strong> be a valid <code>VkShaderModule</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyShaderModule-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyShaderModule-shaderModule-parent"></a> If <code>shaderModule</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>shaderModule</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shaders-execution">8.2. Shader Execution</h3>
<div class="paragraph">
<p>At each stage of the pipeline, multiple invocations of a shader <strong class="purple">may</strong> execute
simultaneously.
Further, invocations of a single shader produced as the result of different
commands <strong class="purple">may</strong> execute simultaneously.
The relative execution order of invocations of the same shader type is
undefined.
Shader invocations <strong class="purple">may</strong> complete in a different order than that in which the
primitives they originated from were drawn or dispatched by the application.
However, fragment shader outputs are written to attachments in
<a href="#primrast-order">rasterization order</a>.</p>
</div>
<div class="paragraph">
<p>The relative order of invocations of different shader types is largely
undefined.
However, when invoking a shader whose inputs are generated from a previous
pipeline stage, the shader invocations from the previous stage are
guaranteed to have executed far enough to generate input values for all
required inputs.</p>
</div>
</div>
<div class="sect2">
<h3 id="shaders-execution-memory-ordering">8.3. Shader Memory Access Ordering</h3>
<div class="paragraph">
<p>The order in which image or buffer memory is read or written by shaders is
largely undefined.
For some shader types (vertex, tessellation evaluation, and in some cases,
fragment), even the number of shader invocations that <strong class="purple">may</strong> perform loads and
stores is undefined.</p>
</div>
<div class="paragraph">
<p>In particular, the following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#shaders-vertex-execution">Vertex</a> and
<a href="#shaders-tessellation-evaluation-execution">tessellation evaluation</a>
shaders will be invoked at least once for each unique vertex, as defined
in those sections.</p>
</li>
<li>
<p><a href="#shaders-fragment-execution">Fragment</a> shaders will be invoked zero or
more times, as defined in that section.</p>
</li>
<li>
<p>The relative order of invocations of the same shader type are undefined.
A store issued by a shader when working on primitive B might complete
prior to a store for primitive A, even if primitive A is specified prior
to primitive B. This applies even to fragment shaders; while fragment
shader outputs are always written to the framebuffer in
<a href="#primrast-order">rasterization order</a>, stores executed by fragment
shader invocations are not.</p>
</li>
<li>
<p>The relative order of invocations of different shader types is largely
undefined.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The above limitations on shader invocation order make some forms of
synchronization between shader invocations within a single set of primitives
unimplementable.
For example, having one invocation poll memory written by another invocation
assumes that the other invocation has been launched and will complete its
writes in finite time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Stores issued to different memory locations within a single shader
invocation <strong class="purple">may</strong> not be visible to other invocations, or <strong class="purple">may</strong> not become
visible in the order they were performed.</p>
</div>
<div class="paragraph">
<p>The <code>OpMemoryBarrier</code> instruction <strong class="purple">can</strong> be used to provide stronger
ordering of reads and writes performed by a single invocation.
<code>OpMemoryBarrier</code> guarantees that any memory transactions issued by the
shader invocation prior to the instruction complete prior to the memory
transactions issued after the instruction.
Memory barriers are needed for algorithms that require multiple invocations
to access the same memory and require the operations to be performed in a
partially-defined relative order.
For example, if one shader invocation does a series of writes, followed by
an <code>OpMemoryBarrier</code> instruction, followed by another write, then the
results of the series of writes before the barrier become visible to other
shader invocations at a time earlier or equal to when the results of the
final write become visible to those invocations.
In practice it means that another invocation that sees the results of the
final write would also see the previous writes.
Without the memory barrier, the final write <strong class="purple">may</strong> be visible before the
previous writes.</p>
</div>
<div class="paragraph">
<p>Writes that are the result of shader stores through a variable decorated
with <code>Coherent</code> automatically have available writes to the same buffer,
buffer view, or image view made visible to them, and are themselves
automatically made available to access by the same buffer, buffer view, or
image view.
Reads that are the result of shader loads through a variable decorated with
<code>Coherent</code> automatically have available writes to the same buffer, buffer
view, or image view made visible to them.
The order that coherent writes to different locations become available is
undefined, unless enforced by a memory barrier instruction or other memory
dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Explicit memory dependencies <strong class="purple">must</strong> still be used to guarantee availability
and visibility for access via other buffers, buffer views, or image views.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The built-in atomic memory transaction instructions <strong class="purple">can</strong> be used to read and
write a given memory address atomically.
While built-in atomic functions issued by multiple shader invocations are
executed in undefined order relative to each other, these functions perform
both a read and a write of a memory address and guarantee that no other
memory transaction will write to the underlying memory between the read and
write.
Atomic operations ensure automatic availability and visibility for writes
and reads in the same way as those to <code>Coherent</code> variables.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Memory accesses performed on different resource descriptors with the same
memory backing <strong class="purple">may</strong> not be well-defined even with the <code>Coherent</code>
decoration or via atomics, due to things such as image layouts or ownership
of the resource - as described in the <a href="#synchronization">Synchronization and
Cache Control</a> chapter.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Atomics allow shaders to use shared global addresses for mutual exclusion or
as counters, among other uses.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="shaders-inputs">8.4. Shader Inputs and Outputs</h3>
<div class="paragraph">
<p>Data is passed into and out of shaders using variables with input or output
storage class, respectively.
User-defined inputs and outputs are connected between stages by matching
their <code>Location</code> decorations.
Additionally, data <strong class="purple">can</strong> be provided by or communicated to special functions
provided by the execution environment using <code>BuiltIn</code> decorations.</p>
</div>
<div class="paragraph">
<p>In many cases, the same <code>BuiltIn</code> decoration <strong class="purple">can</strong> be used in multiple
shader stages with similar meaning.
The specific behavior of variables decorated as <code>BuiltIn</code> is documented
in the following sections.</p>
</div>
</div>
<div class="sect2">
<h3 id="shaders-vertex">8.5. Vertex Shaders</h3>
<div class="paragraph">
<p>Each vertex shader invocation operates on one vertex and its associated
<a href="#fxvertex-attrib">vertex attribute</a> data, and outputs one vertex and
associated data.
Graphics pipelines <strong class="purple">must</strong> include a vertex shader, and the vertex shader
stage is always the first shader stage in the graphics pipeline.</p>
</div>
<div class="sect3">
<h4 id="shaders-vertex-execution">8.5.1. Vertex Shader Execution</h4>
<div class="paragraph">
<p>A vertex shader <strong class="purple">must</strong> be executed at least once for each vertex specified by
a draw command.
During execution, the shader is presented with the index of the vertex and
instance for which it has been invoked.
Input variables declared in the vertex shader are filled by the
implementation with the values of vertex attributes associated with the
invocation being executed.</p>
</div>
<div class="paragraph">
<p>If the same vertex is specified multiple times in a draw command (e.g. by
including the same index value multiple times in an index buffer) the
implementation <strong class="purple">may</strong> reuse the results of vertex shading if it can statically
determine that the vertex shader invocations will produce identical results.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It is implementation-dependent when and if results of vertex shading are
reused, and thus how many times the vertex shader will be executed.
This is true also if the vertex shader contains stores or atomic operations
(see <a href="#features-features-vertexPipelineStoresAndAtomics"><code>vertexPipelineStoresAndAtomics</code></a>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shaders-tessellation-control">8.6. Tessellation Control Shaders</h3>
<div class="paragraph">
<p>The tessellation control shader is used to read an input patch provided by
the application and to produce an output patch.
Each tessellation control shader invocation operates on an input patch
(after all control points in the patch are processed by a vertex shader) and
its associated data, and outputs a single control point of the output patch
and its associated data, and <strong class="purple">can</strong> also output additional per-patch data.
The input patch is sized according to the <code>patchControlPoints</code> member of
<a href="#VkPipelineTessellationStateCreateInfo">VkPipelineTessellationStateCreateInfo</a>, as part of input assembly.
The size of the output patch is controlled by the <code>OpExecutionMode</code>
<code>OutputVertices</code> specified in the tessellation control or tessellation
evaluation shaders, which <strong class="purple">must</strong> be specified in at least one of the shaders.
The size of the input and output patches <strong class="purple">must</strong> each be greater than zero and
less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxTessellationPatchSize</code>.</p>
</div>
<div class="sect3">
<h4 id="shaders-tessellation-control-execution">8.6.1. Tessellation Control Shader Execution</h4>
<div class="paragraph">
<p>A tessellation control shader is invoked at least once for each <em>output</em>
vertex in a patch.</p>
</div>
<div class="paragraph">
<p>Inputs to the tessellation control shader are generated by the vertex
shader.
Each invocation of the tessellation control shader <strong class="purple">can</strong> read the attributes
of any incoming vertices and their associated data.
The invocations corresponding to a given patch execute logically in
parallel, with undefined relative execution order.
However, the <code>OpControlBarrier</code> instruction <strong class="purple">can</strong> be used to provide
limited control of the execution order by synchronizing invocations within a
patch, effectively dividing tessellation control shader execution into a set
of phases.
Tessellation control shaders will read undefined values if one invocation
reads a per-vertex or per-patch attribute written by another invocation at
any point during the same phase, or if two invocations attempt to write
different values to the same per-patch output in a single phase.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shaders-tessellation-evaluation">8.7. Tessellation Evaluation Shaders</h3>
<div class="paragraph">
<p>The Tessellation Evaluation Shader operates on an input patch of control
points and their associated data, and a single input barycentric coordinate
indicating the invocation&#8217;s relative position within the subdivided patch,
and outputs a single vertex and its associated data.</p>
</div>
<div class="sect3">
<h4 id="shaders-tessellation-evaluation-execution">8.7.1. Tessellation Evaluation Shader Execution</h4>
<div class="paragraph">
<p>A tessellation evaluation shader is invoked at least once for each unique
vertex generated by the tessellator.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shaders-geometry">8.8. Geometry Shaders</h3>
<div class="paragraph">
<p>The geometry shader operates on a group of vertices and their associated
data assembled from a single input primitive, and emits zero or more output
primitives and the group of vertices and their associated data required for
each output primitive.</p>
</div>
<div class="sect3">
<h4 id="shaders-geometry-execution">8.8.1. Geometry Shader Execution</h4>
<div class="paragraph">
<p>A geometry shader is invoked at least once for each primitive produced by
the tessellation stages, or at least once for each primitive generated by
<a href="#drawing">primitive assembly</a> when tessellation is not in use.
A shader can request that the geometry shader runs multiple
<a href="#geometry-invocations">instances</a>.
A geometry shader is invoked at least once for each instance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shaders-fragment">8.9. Fragment Shaders</h3>
<div class="paragraph">
<p>Fragment shaders are invoked as the result of rasterization in a graphics
pipeline.
Each fragment shader invocation operates on a single fragment and its
associated data.
With few exceptions, fragment shaders do not have access to any data
associated with other fragments and are considered to execute in isolation
of fragment shader invocations associated with other fragments.</p>
</div>
<div class="sect3">
<h4 id="shaders-fragment-execution">8.9.1. Fragment Shader Execution</h4>
<div class="paragraph">
<p>For each fragment generated by rasterization, a fragment shader <strong class="purple">may</strong> be
invoked.
A fragment shader <strong class="purple">must</strong> not be invoked if the <a href="#fragops-early">Early
Per-Fragment Tests</a> cause it to have no coverage.</p>
</div>
<div class="paragraph">
<p>Furthermore, if it is determined that a fragment generated as the result of
rasterizing a first primitive will have its outputs entirely overwritten by
a fragment generated as the result of rasterizing a second primitive in the
same subpass, and the fragment shader used for the fragment has no other
side effects, then the fragment shader <strong class="purple">may</strong> not be executed for the fragment
from the first primitive.</p>
</div>
<div class="paragraph">
<p>Relative ordering of execution of different fragment shader invocations is
not defined.</p>
</div>
<div class="paragraph">
<p>For each fragment generated by a primitive, the number of times the fragment
shader is invoked is implementation-dependent, but <strong class="purple">must</strong> obey the following
constraints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each covered sample is included in a single fragment shader invocation.</p>
</li>
<li>
<p>When sample shading is not enabled, there is at least one fragment
shader invocation.</p>
</li>
<li>
<p>When sample shading is enabled, the minimum number of fragment shader
invocations is as defined in
<a href="#primsrast-sampleshading">Sample Shading</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When there is more than one fragment shader invocation per fragment, the
association of samples to invocations is implementation-dependent.</p>
</div>
<div class="paragraph">
<p>In addition to the conditions outlined above for the invocation of a
fragment shader, a fragment shader invocation <strong class="purple">may</strong> be produced as a <em>helper
invocation</em>.
A helper invocation is a fragment shader invocation that is created solely
for the purposes of evaluating derivatives for use in non-helper fragment
shader invocations.
Stores and atomics performed by helper invocations <strong class="purple">must</strong> not have any effect
on memory, and values returned by atomic instructions in helper invocations
are undefined.</p>
</div>
</div>
<div class="sect3">
<h4 id="shaders-fragment-earlytest">8.9.2. Early Fragment Tests</h4>
<div class="paragraph">
<p>An explicit control is provided to allow fragment shaders to enable early
fragment tests.
If the fragment shader specifies the <code>EarlyFragmentTests</code>
<code>OpExecutionMode</code>, the per-fragment tests described in
<a href="#fragops-early-mode">Early Fragment Test Mode</a> are performed prior to
fragment shader execution.
Otherwise, they are performed after fragment shader execution.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shaders-compute">8.10. Compute Shaders</h3>
<div class="paragraph">
<p>Compute shaders are invoked via <a href="#vkCmdDispatch">vkCmdDispatch</a> and
<a href="#vkCmdDispatchIndirect">vkCmdDispatchIndirect</a> commands.
In general, they have access to similar resources as shader stages executing
as part of a graphics pipeline.</p>
</div>
<div class="paragraph">
<p>Compute workloads are formed from groups of work items called workgroups and
processed by the compute shader in the current compute pipeline.
A workgroup is a collection of shader invocations that execute the same
shader, potentially in parallel.
Compute shaders execute in <em>global workgroups</em> which are divided into a
number of <em>local workgroups</em> with a size that <strong class="purple">can</strong> be set by assigning a
value to the <code>LocalSize</code> execution mode or via an object decorated by the
<code>WorkgroupSize</code> decoration.
An invocation within a local workgroup <strong class="purple">can</strong> share data with other members of
the local workgroup through shared variables and issue memory and control
flow barriers to synchronize with other members of the local workgroup.</p>
</div>
</div>
<div class="sect2">
<h3 id="shaders-interpolation-decorations">8.11. Interpolation Decorations</h3>
<div class="paragraph">
<p>Interpolation decorations control the behavior of attribute interpolation in
the fragment shader stage.
Interpolation decorations <strong class="purple">can</strong> be applied to <code>Input</code> storage class
variables in the fragment shader stage&#8217;s interface, and control the
interpolation behavior of those variables.</p>
</div>
<div class="paragraph">
<p>Inputs that could be interpolated <strong class="purple">can</strong> be decorated by at most one of the
following decorations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Flat</code>: no interpolation</p>
</li>
<li>
<p><code>NoPerspective</code>: linear interpolation (for
<a href="#line_linear_interpolation">lines</a> and
<a href="#triangle_linear_interpolation">polygons</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Fragment input variables decorated with neither <code>Flat</code> nor
<code>NoPerspective</code> use perspective-correct interpolation (for
<a href="#line_perspective_interpolation">lines</a> and
<a href="#triangle_perspective_interpolation">polygons</a>).</p>
</div>
<div class="paragraph">
<p>The presence of and type of interpolation is controlled by the above
interpolation decorations as well as the auxiliary decorations <code>Centroid</code>
and <code>Sample</code>.</p>
</div>
<div class="paragraph">
<p>A variable decorated with <code>Flat</code> will not be interpolated.
Instead, it will have the same value for every fragment within a triangle.
This value will come from a single <a href="#vertexpostproc-flatshading">provoking
vertex</a>.
A variable decorated with <code>Flat</code> <strong class="purple">can</strong> also be decorated with
<code>Centroid</code> or <code>Sample</code>, which will mean the same thing as decorating
it only as <code>Flat</code>.</p>
</div>
<div class="paragraph">
<p>For fragment shader input variables decorated with neither <code>Centroid</code> nor
<code>Sample</code>, the assigned variable <strong class="purple">may</strong> be interpolated anywhere within the
fragment and a single value <strong class="purple">may</strong> be assigned to each sample within the
fragment.</p>
</div>
<div class="paragraph">
<p>If a fragment shader input is decorated with <code>Centroid</code>, a single value
<strong class="purple">may</strong> be assigned to that variable for all samples in the fragment, but that
value <strong class="purple">must</strong> be interpolated to a location that lies in both the fragment and
in the primitive being rendered, including any of the fragment&#8217;s samples
covered by the primitive.
Because the location at which the variable is interpolated <strong class="purple">may</strong> be different
in neighboring fragments, and derivatives <strong class="purple">may</strong> be computed by computing
differences between neighboring fragments, derivatives of centroid-sampled
inputs <strong class="purple">may</strong> be less accurate than those for non-centroid interpolated
variables.</p>
</div>
<div class="paragraph">
<p>If a fragment shader input is decorated with <code>Sample</code>, a separate value
<strong class="purple">must</strong> be assigned to that variable for each covered sample in the fragment,
and that value <strong class="purple">must</strong> be sampled at the location of the individual sample.
When <code>rasterizationSamples</code> is <code>VK_SAMPLE_COUNT_1_BIT</code>, the fragment
center <strong class="purple">must</strong> be used for <code>Centroid</code>, <code>Sample</code>, and undecorated
attribute interpolation.</p>
</div>
<div class="paragraph">
<p>Fragment shader inputs that are signed or unsigned integers, integer
vectors, or any double-precision floating-point type <strong class="purple">must</strong> be decorated with
<code>Flat</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="shaders-staticuse">8.12. Static Use</h3>
<div class="paragraph">
<p>A SPIR-V module declares a global object in memory using the <code>OpVariable</code>
instruction, which results in a pointer <code>x</code> to that object.
A specific entry point in a SPIR-V module is said to <em>statically use</em> that
object if that entry point&#8217;s call tree contains a function that contains a
memory instruction or image instruction with <code>x</code> as an <code>id</code> operand.
See the &#8220;Memory Instructions&#8221; and &#8220;Image Instructions&#8221; subsections of
section 3 &#8220;Binary Form&#8221; of the SPIR-V specification for the complete list
of SPIR-V memory instructions.</p>
</div>
<div class="paragraph">
<p>Static use is not used to control the behavior of variables with <code>Input</code>
and <code>Output</code> storage.
The effects of those variables are applied based only on whether they are
present in a shader entry point&#8217;s interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="shaders-invocationgroups">8.13. Invocation and Derivative Groups</h3>
<div class="paragraph">
<p>An <em>invocation group</em> (see the subsection &#8220;Control Flow&#8221; of section 2 of
the SPIR-V specification) for a compute shader is the set of invocations in
a single local workgroup.
For graphics shaders, an invocation group is an implementation-dependent
subset of the set of shader invocations of a given shader stage which are
produced by a single drawing command.
For indirect drawing commands with <code>drawCount</code> greater than one,
invocations from separate draws are in distinct invocation groups.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because the partitioning of invocations into invocation groups is
implementation-dependent and not observable, applications generally need to
assume the worst case of all invocations in a draw belonging to a single
invocation group.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <em>derivative group</em> (see the subsection &#8220;Control Flow&#8221; of section 2 of
the SPIR-V 1.00 Revision 4 specification) for a fragment shader is the set
of invocations generated by a single primitive (point, line, or triangle),
including any helper invocations generated by that primitive.
Derivatives are undefined for a sampled image instruction if the instruction
is in flow control that is not uniform across the derivative group.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pipelines">9. Pipelines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following <a href="#pipelines-block-diagram">figure</a> shows a block diagram of
the Vulkan pipelines.
Some Vulkan commands specify geometric objects to be drawn or computational
work to be performed, while others specify state controlling how objects are
handled by the various pipeline stages, or control data transfer between
memory organized as images and buffers.
Commands are effectively sent through a processing pipeline, either a
<em>graphics pipeline</em> or a <em>compute pipeline</em>.</p>
</div>
<div class="paragraph">
<p>The first stage of the <a href="#pipelines-graphics">graphics pipeline</a>
(<a href="#drawing">Input Assembler</a>) assembles vertices to form geometric
primitives such as points, lines, and triangles, based on a requested
primitive topology.
In the next stage (<a href="#shaders-vertex">Vertex Shader</a>) vertices <strong class="purple">can</strong> be
transformed, computing positions and attributes for each vertex.
If <a href="#tessellation">tessellation</a> and/or <a href="#geometry">geometry</a> shaders are
supported, they <strong class="purple">can</strong> then generate multiple primitives from a single input
primitive, possibly changing the primitive topology or generating additional
attribute data in the process.</p>
</div>
<div class="paragraph">
<p>The final resulting primitives are <a href="#vertexpostproc-clipping">clipped</a> to a
clip volume in preparation for the next stage, <a href="#primsrast">Rasterization</a>.
The rasterizer produces a series of framebuffer addresses and values using a
two-dimensional description of a point, line segment, or triangle.
Each <em>fragment</em> so produced is fed to the next stage
(<a href="#shaders-fragment">Fragment Shader</a>) that performs operations on
individual fragments before they finally alter the framebuffer.
These operations include conditional updates into the framebuffer based on
incoming and previously stored depth values (to effect <a href="#fragops-depth">depth
buffering</a>), <a href="#framebuffer-blending">blending</a> of incoming fragment colors
with stored colors, as well as <a href="#framebuffer-blendoperations">masking</a>,
<a href="#fragops-stencil">stenciling</a>, and other <a href="#framebuffer-logicop">logical
operations</a> on fragment values.</p>
</div>
<div class="paragraph">
<p>Framebuffer operations read and write the color and depth/stencil
attachments of the framebuffer for a given subpass of a <a href="#renderpass">render
pass instance</a>.
The attachments <strong class="purple">can</strong> be used as input attachments in the fragment shader in
a later subpass of the same render pass.</p>
</div>
<div class="paragraph">
<p>The <a href="#pipelines-compute">compute pipeline</a> is a separate pipeline from the
graphics pipeline, which operates on one-, two-, or three-dimensional
workgroups which <strong class="purple">can</strong> read from and write to buffer and image memory.</p>
</div>
<div class="paragraph">
<p>This ordering is meant only as a tool for describing Vulkan, not as a strict
rule of how Vulkan is implemented, and we present it only as a means to
organize the various operations of the pipelines.
Actual ordering guarantees between pipeline stages are explained in detail
in the <a href="#synchronization-pipeline-stages-order">synchronization chapter</a>.</p>
</div>
<div id="pipelines-block-diagram" class="imageblock" style="text-align: center">
<div class="content">
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="775.12067"
   height="418"
   viewBox="0 0 775.12066 418"
   version="1.1"
   id="svg8"
   sodipodi:docname="pipeline.svg"
   inkscape:version="0.92.2 (5c3e80d, 2017-08-06)">
  <defs
     id="defs2">
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker18097"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mstart">
      <path
         transform="matrix(0.4,0,0,0.4,4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path18095"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker17835"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mstart">
      <path
         transform="matrix(0.4,0,0,0.4,4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path17833"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17557"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path17555"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker17291"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path17289"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker16647"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path16645"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker16415"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path16413"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker16189"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path16187"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker15937"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path15935"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mstart"
       orient="auto"
       refY="0"
       refX="0"
       id="marker12928"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path12926"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(0.4,0,0,0.4,4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker11520"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path11518"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker11322"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path11320"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker11128"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path11126"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker10596"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path10594"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker9866"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path9864"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker9512"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path9510"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker8090"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path8088"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker7360"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path7358"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker7066"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mstart"
       inkscape:collect="always">
      <path
         transform="matrix(0.4,0,0,0.4,4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path7064"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker5716"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path5714"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker5106"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path5104"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker7066-0"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mstart">
      <path
         inkscape:connector-curvature="0"
         transform="matrix(0.4,0,0,0.4,4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path7064-8" />
    </marker>
    <marker
       inkscape:isstock="true"
       style="overflow:visible"
       id="marker7208-7"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Arrow1Mend"
       inkscape:collect="always">
      <path
         inkscape:connector-curvature="0"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         id="path7206-1" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-01"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-8"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7-8"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9-7"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-01-3"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-8-44"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mstart"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Mstart-3"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path1382-1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(0.4,0,0,0.4,4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker5200-6"
       style="overflow:visible"
       inkscape:isstock="true">
      <path
         id="path5198-1"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-01-3-1"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-8-44-8"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7-8-7"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9-7-8"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7-8-7-7"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9-7-8-5"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7-8-7-7-5"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9-7-8-5-5"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7-8-7-7-0"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9-7-8-5-2"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker17033-3-37-7-8-7-7-0-51"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path17031-7-0-9-7-8-5-2-5"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker9512-2"
       style="overflow:visible"
       inkscape:isstock="true"
       inkscape:collect="always">
      <path
         id="path9510-3"
         d="M 0,0 5,-5 -12.5,0 5,5 Z"
         style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1"
         transform="matrix(-0.4,0,0,-0.4,-4,0)"
         inkscape:connector-curvature="0" />
    </marker>
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.70710678"
     inkscape:cx="336.9947"
     inkscape:cy="227.64983"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="true"
     inkscape:snap-center="true"
     inkscape:snap-object-midpoints="true"
     inkscape:snap-text-baseline="true"
     inkscape:window-width="1680"
     inkscape:window-height="987"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     showguides="false"
     fit-margin-top="1"
     fit-margin-right="1"
     fit-margin-bottom="1"
     fit-margin-left="1"
     units="in"
     inkscape:snap-others="true"
     inkscape:snap-nodes="true"
     inkscape:object-nodes="true"
     height="7.5in">
    <inkscape:grid
       type="xygrid"
       id="grid817"
       originx="153.62068"
       originy="-783.5" />
  </sodipodi:namedview>
  <metadata
     id="metadata5">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(38.615418,2.1124474)">
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-1-2-4"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="269.3876" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3-9-8"
       width="220.00002"
       height="19.999928"
       x="-24.994741"
       y="159.38759" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-1"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="129.38759" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3-9"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="99.387589" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="59.387589" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="-0.6124118" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2"
       width="220.00002"
       height="19.999928"
       x="-24.994738"
       y="29.387552" />
    <text
       id="text823"
       y="74.351746"
       x="84.9011"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="74.351746"
         x="84.9011"
         sodipodi:role="line">Vertex Shader</tspan></text>
    <text
       id="text823-4"
       y="14.133646"
       x="84.634171"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="14.133646"
         x="84.634171"
         sodipodi:role="line">Draw</tspan></text>
    <text
       id="text823-4-2"
       y="43.111511"
       x="84.539764"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="43.111511"
         x="84.539764"
         sodipodi:role="line">Input Assembler</tspan></text>
    <text
       id="text823-7"
       y="114.35175"
       x="84.985733"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825-4"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="114.35175"
         x="84.985733"
         sodipodi:role="line">Tessellation Control Shader</tspan></text>
    <text
       id="text823-4-2-6-3"
       y="144.35175"
       x="84.985733"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-1-5"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="144.35175"
         x="84.985733"
         sodipodi:role="line">Tessellation Primitive Generator</tspan></text>
    <text
       id="text823-7-0"
       y="174.35175"
       x="84.985733"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825-4-7"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="174.35175"
         x="84.985733"
         sodipodi:role="line">Tessellation Evaluation Shader</tspan></text>
    <text
       id="text823-4-2-8"
       y="284.1662"
       x="84.930397"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-9"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="284.1662"
         x="84.930397"
         sodipodi:role="line">Rasterization</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker5106)"
       d="M -34.994737,89.387552 V 229.38755 h 120"
       id="path4474"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="ccc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker5716)"
       d="m 85.005263,89.387552 h -120.65"
       id="path5712"
       inkscape:connector-curvature="0" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1"
       width="220"
       height="20"
       x="245.00526"
       y="-0.61244744" />
    <text
       id="text823-4-2-9-4-7"
       y="14.384297"
       x="354.53976"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="14.384297"
         x="354.53976"
         sodipodi:role="line">Indirect Buffer</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker7360)"
       d="m 235.00526,309.38755 v 60 h -40"
       id="path7350"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="ccc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker8090)"
       d="m 245.00526,344.38755 h -5 v -5 h -10 v 5 h -35"
       id="path8837"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cccccc" />
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:4, 4;stroke-dashoffset:0;stroke-opacity:1"
       id="rect8983"
       width="220"
       height="165"
       x="245.00526"
       y="99.38755" />
    <text
       id="text823-4-2-9-4-7-9-85"
       y="112.9813"
       x="354.63092"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-7"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="112.9813"
         x="354.63092"
         sodipodi:role="line">Descriptor Sets</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#marker7066-0);marker-end:url(#marker7208-7)"
       d="m 245.00526,399.38755 h -50"
       id="path7056-3"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512)"
       d="m 245.00526,9.3875524 h -50"
       id="path9502"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9866)"
       d="m 245.00526,64.387552 h -50"
       id="path9856"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#marker7066);marker-end:url(#marker10596)"
       d="m 245.00526,309.38755 h -20 v -5 h -10 v 5 h -20"
       id="path10568"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cccccc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 245.00526,49.387552 h -25 v 15"
       id="path11116"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="ccc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker11128)"
       d="m 220.00526,109.38755 h -25"
       id="path11118"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker11322)"
       d="m 220.00526,169.38755 h -25"
       id="path11312"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker11520)"
       d="m 220.00526,209.38755 h -25"
       id="path11510"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#marker12928);marker-end:url(#marker15937)"
       d="m 195.00526,334.38755 h 25 V 74.387552 h -25"
       id="path15909"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cccc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 250.00526,129.38755 h -30"
       id="path16167"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 250.00526,149.38755 h -30"
       id="path16169"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 250.00526,169.38755 h -30"
       id="path16171"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="m 250.00526,189.38755 h -30"
       id="path16173"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker16647)"
       d="m 220.00526,209.38755 h 30"
       id="path16175"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker16189)"
       d="m 220.00526,229.38755 h 30"
       id="path16177"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker16415)"
       d="m 220.00526,249.38755 h 30"
       id="path16179"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17023"
       d="M 625.00526,19.387552 V 169.38755"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033)"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17281"
       d="m 490.00526,179.38755 h 25"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17291)"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17547"
       d="m 460.00526,129.38755 h 30 v 120 h -30"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17557)"
       sodipodi:nodetypes="cccc" />
    <path
       inkscape:connector-curvature="0"
       id="path17817"
       d="m 460.00526,149.38755 h 30"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17819"
       d="m 460.00526,169.38755 h 30"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17821"
       d="m 460.00526,189.38755 h 30"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17823"
       d="m 460.00526,209.38755 h 30"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#marker18097)"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17825"
       d="m 460.00526,229.38755 h 30"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#marker17835)"
       sodipodi:nodetypes="cc" />
    <rect
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:4, 4;stroke-dashoffset:0;stroke-opacity:1"
       id="rect8983-1"
       width="220.00002"
       height="115.00001"
       x="515.00525"
       y="299.38754" />
    <text
       id="text823-4-2-9-4-7-9-85-3"
       y="318.07571"
       x="624.95642"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-7-3"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="318.07571"
         x="624.95642"
         sodipodi:role="line">Legend</tspan></text>
    <path
       inkscape:connector-curvature="0"
       id="path17023-1"
       d="m 85.005263,19.387552 v 9.728741"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3)" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-3"
       d="m 85.005263,79.387552 v 20"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-01)"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4"
       d="m 85.005263,49.387552 v 9.728741"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37)" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0"
       d="m 85.005263,119.38755 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7)" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0-9"
       d="m 85.005263,149.52318 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7-8)" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3-9-8-4"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="199.38759" />
    <text
       id="text823-7-9-09"
       y="213.11151"
       x="84.611382"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825-4-0-5"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="213.11151"
         x="84.611382"
         sodipodi:role="line">Geometry Shader</tspan></text>
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-3-2"
       d="m 85.005265,179.38755 v 20"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-01-3)"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Arrow1Mstart-3);marker-end:url(#marker5200-6)"
       d="m 85.005263,189.38755 h -120"
       id="path4476-0"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-1-2"
       width="220.00002"
       height="19.999928"
       x="-24.994741"
       y="239.38759" />
    <text
       id="text823-4-8-5"
       y="252.89015"
       x="85.522842"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-9-2"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="252.89015"
         x="85.522842"
         sodipodi:role="line">Vertex Post-Processing</tspan></text>
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-3-2-4"
       d="m 85.005263,219.38755 v 20"
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-01-3-1)"
       sodipodi:nodetypes="cc" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0-9-1"
       d="m 85.005265,259.52318 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7-8-7)" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0-9-1-8"
       d="m 85.005265,289.52318 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7-8-7-7)" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-1-2-4-1"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="299.3876" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3-9-8-4-1"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="329.3876" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0-9-1-8-6"
       d="m 85.005265,319.52318 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7-8-7-7-5)" />
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0-9-1-8-3"
       d="m 85.005265,349.52318 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7-8-7-7-0)" />
    <text
       id="text823-4-5-3"
       y="313.07571"
       x="84.63092"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-7-4"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="313.07571"
         x="84.63092"
         sodipodi:role="line">Early Per-Fragment Tests</tspan></text>
    <text
       id="text823-7-9-0-6"
       y="343.07571"
       x="84.334686"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825-4-0-0-3"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="343.07571"
         x="84.334686"
         sodipodi:role="line">Fragment Shader</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-1-2-4-1-2"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="359.3876" />
    <text
       id="text823-4-5-5-7"
       y="372.8576"
       x="84.63092"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-7-7-9"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="372.8576"
         x="84.63092"
         sodipodi:role="line">Late Per-Fragment Tests</tspan></text>
    <path
       inkscape:connector-curvature="0"
       id="path17023-1-4-0-9-1-8-3-2"
       d="m 85.005265,379.52318 v 9.72874"
       style="fill:none;stroke:#000000;stroke-width:0.87524033;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker17033-3-37-7-8-7-7-0-51)" />
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-1-2-4-1-2-2"
       width="220.00002"
       height="19.999928"
       x="-24.994745"
       y="389.3876" />
    <text
       id="text823-4-2-9-4-3"
       y="403.07571"
       x="84.956436"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-4"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="403.07571"
         x="84.956436"
         sodipodi:role="line">Blending</tspan></text>
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-0"
       width="220"
       height="20"
       x="245.00526"
       y="59.387554" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6"
       width="220"
       height="20"
       x="245.00526"
       y="39.387554" />
    <text
       id="text823-4-2-9-4-7-1"
       y="54.384296"
       x="354.53976"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-2"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="54.384296"
         x="354.53976"
         sodipodi:role="line">Index Buffer</tspan></text>
    <text
       id="text823-4-2-9-4-7-3"
       y="74.3843"
       x="355.19733"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-9"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="74.3843"
         x="355.19733"
         sodipodi:role="line">Vertex Buffers</tspan></text>
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="119.38755" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-2"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="139.38754" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-3"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="159.38754" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-1"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="179.38754" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-34"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="199.38757" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-7"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="219.38757" />
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-5"
       width="210.00002"
       height="19.999994"
       x="250.00526"
       y="239.38757" />
    <text
       id="text823-4-2-9-4-7-9-65"
       y="134.35175"
       x="354.63092"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-92"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="134.35175"
         x="354.63092"
         sodipodi:role="line">Push Constants</tspan></text>
    <text
       id="text823-4-2-9-4-7-9-3-0"
       y="154.38429"
       x="354.70255"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-9-7"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="154.38429"
         x="354.70255"
         sodipodi:role="line">Uniform Buffers</tspan></text>
    <text
       id="text823-4-2-9-4-7-9-2-2"
       y="174.38429"
       x="354.70255"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-4-3"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="174.38429"
         x="354.70255"
         sodipodi:role="line">Uniform Texel Buffers</tspan></text>
    <text
       id="text823-4-2-9-4-7-9-8-2"
       y="193.0757"
       x="354.84579"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-1"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="193.0757"
         x="354.84579"
         sodipodi:role="line">Sampled Images</tspan></text>
    <text
       id="text823-4-2-9-4-7-9-8-0-8"
       y="213.10826"
       x="354.84579"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-4-5"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="213.10826"
         x="354.84579"
         sodipodi:role="line">Storage Buffers</tspan></text>
    <text
       id="text823-4-2-9-4-7-9-8-8-1"
       y="233.10826"
       x="354.84579"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-5-5"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="233.10826"
         x="354.84579"
         sodipodi:role="line">Storage Texel Buffers</tspan></text>
    <text
       id="text823-4-2-9-4-7-9-8-05-4"
       y="252.9455"
       x="354.84579"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-3-6"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="252.9455"
         x="354.84579"
         sodipodi:role="line">Storage Images</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3-0"
       width="220.00002"
       height="19.999928"
       x="515.00525"
       y="169.38756" />
    <text
       id="text823-0"
       y="184.35172"
       x="624.90112"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825-8"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="184.35172"
         x="624.90112"
         sodipodi:role="line">Compute Shader</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-6"
       width="220.00002"
       height="19.999928"
       x="515.00525"
       y="-0.61240721" />
    <text
       id="text823-4-0"
       y="13.11151"
       x="624.93042"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-2"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="13.11151"
         x="624.93042"
         sodipodi:role="line">Dispatch</tspan></text>
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-6"
       width="220"
       height="20"
       x="245.00526"
       y="299.38754" />
    <text
       id="text823-4-2-9-4-7-9-8-05-4-5"
       y="312.9455"
       x="354.84576"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-3-6-4"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="312.9455"
         x="354.84576"
         sodipodi:role="line">Depth/Stencil Attachments</tspan></text>
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-6-4"
       width="220"
       height="20"
       x="245.00526"
       y="329.38754" />
    <text
       id="text823-4-2-9-4-7-9-8-05-4-5-3"
       y="342.9455"
       x="354.84576"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-3-6-4-0"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="342.9455"
         x="354.84576"
         sodipodi:role="line">Input Attachments</tspan></text>
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-6-2"
       width="220"
       height="20"
       x="245.00526"
       y="389.38754" />
    <text
       id="text823-4-2-9-4-7-9-8-05-4-5-6"
       y="402.9455"
       x="354.84576"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-3-6-4-6"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="402.9455"
         x="354.84576"
         sodipodi:role="line">Color Attachments</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-26"
       width="210.00002"
       height="20.00001"
       x="520.00525"
       y="329.38754" />
    <text
       id="text823-4-8"
       y="344.13358"
       x="624.63416"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-1"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="344.13358"
         x="624.63416"
         sodipodi:role="line">Fixed Function Stage</tspan></text>
    <rect
       style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.89574087;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-2-3-0-5"
       width="210.00002"
       height="20.00001"
       x="520.00525"
       y="359.38754" />
    <text
       id="text823-0-2"
       y="373.11151"
       x="624.61139"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
       xml:space="preserve"><tspan
         id="tspan825-8-5"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none"
         y="373.11151"
         x="624.61139"
         sodipodi:role="line">Shader Stage</tspan></text>
    <rect
       style="fill:#808080;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
       id="rect815-1-4-3-6-1-6-7-5-0"
       width="210.00002"
       height="19.999994"
       x="520.00525"
       y="389.38757" />
    <text
       id="text823-4-2-9-4-7-9-8-05-4-9"
       y="402.9455"
       x="624.84583"
       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986"
       xml:space="preserve"><tspan
         id="tspan825-6-0-2-5-6-26-5-3-6-42"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;writing-mode:lr-tb;text-anchor:middle;stroke-width:1.26999986"
         y="402.9455"
         x="624.84583"
         sodipodi:role="line">Storage Images</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2)"
       d="m 465.00526,9.3875526 h 50"
       id="path9502-7"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
  </g>
</svg>
</div>
<div class="title">Figure 2. Block diagram of the Vulkan pipeline</div>
</div>
<div class="paragraph">
<p>Each pipeline is controlled by a monolithic object created from a
description of all of the shader stages and any relevant fixed-function
stages.
<a href="#interfaces">Linking</a> the whole pipeline together allows the optimization
of shaders based on their input/outputs and eliminates expensive draw time
state validation.</p>
</div>
<div class="paragraph">
<p>A pipeline object is bound to the current state using
<a href="#vkCmdBindPipeline">vkCmdBindPipeline</a>.
Any pipeline object state that is specified as <a href="#pipelines-dynamic-state">dynamic</a> is not applied to the current state when the pipeline object is
bound, but is instead set by dynamic state setting commands.</p>
</div>
<div class="paragraph">
<p>No state, including dynamic state, is inherited from one command buffer to
another.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Compute and graphics pipelines are each represented by <code>VkPipeline</code>
handles:</p>
</div>
<div id="VkPipeline" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkPipeline)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-compute">9.1. Compute Pipelines</h3>
<div class="paragraph">
<p>Compute pipelines consist of a single static compute shader stage and the
pipeline layout.</p>
</div>
<div class="paragraph">
<p>The compute pipeline represents a compute shader and is created by calling
<code>vkCreateComputePipelines</code> with <code>module</code> and <code>pName</code> selecting
an entry point from a shader module, where that entry point defines a valid
compute shader, in the <code>VkPipelineShaderStageCreateInfo</code> structure
contained within the <code>VkComputePipelineCreateInfo</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create compute pipelines, call:</p>
</div>
<div id="vkCreateComputePipelines" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateComputePipelines(
    VkDevice                                    device,
    VkPipelineCache                             pipelineCache,
    uint32_t                                    createInfoCount,
    <span class="directive">const</span> VkComputePipelineCreateInfo*          pCreateInfos,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkPipeline*                                 pPipelines);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the compute pipelines.</p>
</li>
<li>
<p><code>pipelineCache</code> is either <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, indicating that
pipeline caching is disabled; or the handle of a valid
<a href="#pipelines-cache">pipeline cache</a> object, in which case use of that
cache is enabled for the duration of the command.</p>
</li>
<li>
<p><code>createInfoCount</code> is the length of the <code>pCreateInfos</code> and
<code>pPipelines</code> arrays.</p>
</li>
<li>
<p><code>pCreateInfos</code> is an array of <a href="#VkComputePipelineCreateInfo">VkComputePipelineCreateInfo</a>
structures.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pPipelines</code> is a pointer to an array in which the resulting compute
pipeline objects are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateComputePipelines-flags-00695"></a>
If the <code>flags</code> member of any element of <code>pCreateInfos</code> contains
the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code> flag, and the
<code>basePipelineIndex</code> member of that same element is not <code>-1</code>,
<code>basePipelineIndex</code> <strong class="purple">must</strong> be less than the index into
<code>pCreateInfos</code> that corresponds to that element</p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-flags-00696"></a>
If the <code>flags</code> member of any element of <code>pCreateInfos</code> contains
the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code> flag, the base pipeline
<strong class="purple">must</strong> have been created with the
<code>VK_PIPELINE_CREATE_ALLOW_DERIVATIVES_BIT</code> flag set</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateComputePipelines-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-pipelineCache-parameter"></a> If <code>pipelineCache</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>pipelineCache</code> <strong class="purple">must</strong> be a valid <code>VkPipelineCache</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-pCreateInfos-parameter"></a> <code>pCreateInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>createInfoCount</code> valid <code>VkComputePipelineCreateInfo</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-pPipelines-parameter"></a> <code>pPipelines</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>createInfoCount</code> <code>VkPipeline</code> handles</p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-createInfoCount-arraylength"></a> <code>createInfoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCreateComputePipelines-pipelineCache-parent"></a> If <code>pipelineCache</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkComputePipelineCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkComputePipelineCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkComputePipelineCreateInfo {
    VkStructureType                    sType;
    <span class="directive">const</span> <span class="directive">void</span>*                        pNext;
    VkPipelineCreateFlags              flags;
    VkPipelineShaderStageCreateInfo    stage;
    VkPipelineLayout                   layout;
    VkPipeline                         basePipelineHandle;
    int32_t                            basePipelineIndex;
} VkComputePipelineCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkPipelineCreateFlagBits">VkPipelineCreateFlagBits</a> specifying
how the pipeline will be generated.</p>
</li>
<li>
<p><code>stage</code> is a <a href="#VkPipelineShaderStageCreateInfo">VkPipelineShaderStageCreateInfo</a> describing the
compute shader.</p>
</li>
<li>
<p><code>layout</code> is the description of binding locations used by both the
pipeline and descriptor sets used with the pipeline.</p>
</li>
<li>
<p><code>basePipelineHandle</code> is a pipeline to derive from</p>
</li>
<li>
<p><code>basePipelineIndex</code> is an index into the <code>pCreateInfos</code>
parameter to use as a pipeline to derive from</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The parameters <code>basePipelineHandle</code> and <code>basePipelineIndex</code> are
described in more detail in <a href="#pipelines-pipeline-derivatives">Pipeline
Derivatives</a>.</p>
</div>
<div class="paragraph">
<p><code>stage</code> points to a structure of type
<code>VkPipelineShaderStageCreateInfo</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-flags-00697"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineIndex</code> is -1, <code>basePipelineHandle</code> <strong class="purple">must</strong>
be a valid handle to a compute <code>VkPipeline</code></p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-flags-00698"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineHandle</code> is <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>basePipelineIndex</code> <strong class="purple">must</strong> be a valid index into the calling
command&#8217;s <code>pCreateInfos</code> parameter</p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-flags-00699"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineIndex</code> is not -1, <code>basePipelineHandle</code>
<strong class="purple">must</strong> be <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-flags-00700"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineHandle</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>basePipelineIndex</code> <strong class="purple">must</strong> be -1</p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-stage-00701"></a>
The <code>stage</code> member of <code>stage</code> <strong class="purple">must</strong> be
<code>VK_SHADER_STAGE_COMPUTE_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-stage-00702"></a>
The shader code for the entry point identified by <code>stage</code> and the
rest of the state identified by this structure <strong class="purple">must</strong> adhere to the
pipeline linking rules described in the <a href="#interfaces">Shader Interfaces</a>
chapter</p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-layout-00703"></a>
<code>layout</code> <strong class="purple">must</strong> be
<a href="#descriptorsets-pipelinelayout-consistency">consistent</a> with the layout
of the compute shader specified in <code>stage</code></p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-layout-01687"></a>
The number of resources in <code>layout</code> accessible to the compute shader
stage <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxPerStageResources</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COMPUTE_PIPELINE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineCreateFlagBits">VkPipelineCreateFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-stage-parameter"></a> <code>stage</code> <strong class="purple">must</strong> be a valid <code>VkPipelineShaderStageCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-layout-parameter"></a> <code>layout</code> <strong class="purple">must</strong> be a valid <code>VkPipelineLayout</code> handle</p>
</li>
<li>
<p><a id="VUID-VkComputePipelineCreateInfo-commonparent"></a> Both of <code>basePipelineHandle</code>, and <code>layout</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineShaderStageCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkPipelineShaderStageCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPipelineShaderStageCreateInfo {
    VkStructureType                     sType;
    <span class="directive">const</span> <span class="directive">void</span>*                         pNext;
    VkPipelineShaderStageCreateFlags    flags;
    VkShaderStageFlagBits               stage;
    VkShaderModule                      module;
    <span class="directive">const</span> <span class="predefined-type">char</span>*                         pName;
    <span class="directive">const</span> VkSpecializationInfo*         pSpecializationInfo;
} VkPipelineShaderStageCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>stage</code> is a <a href="#VkShaderStageFlagBits">VkShaderStageFlagBits</a> value specifying a single
pipeline stage.</p>
</li>
<li>
<p><code>module</code> is a <a href="#VkShaderModule">VkShaderModule</a> object that contains the shader
for this stage.</p>
</li>
<li>
<p><code>pName</code> is a pointer to a null-terminated UTF-8 string specifying
the entry point name of the shader for this stage.</p>
</li>
<li>
<p><code>pSpecializationInfo</code> is a pointer to <a href="#VkSpecializationInfo">VkSpecializationInfo</a>, as
described in <a href="#pipelines-specialization-constants">Specialization
Constants</a>, and <strong class="purple">can</strong> be <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00704"></a>
If the <a href="#features-features-geometryShader">geometry shaders</a> feature is
not enabled, <code>stage</code> <strong class="purple">must</strong> not be <code>VK_SHADER_STAGE_GEOMETRY_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00705"></a>
If the <a href="#features-features-tessellationShader">tessellation shaders</a>
feature is not enabled, <code>stage</code> <strong class="purple">must</strong> not be
<code>VK_SHADER_STAGE_TESSELLATION_CONTROL_BIT</code> or
<code>VK_SHADER_STAGE_TESSELLATION_EVALUATION_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00706"></a>
<code>stage</code> <strong class="purple">must</strong> not be <code>VK_SHADER_STAGE_ALL_GRAPHICS</code>, or
<code>VK_SHADER_STAGE_ALL</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-pName-00707"></a>
<code>pName</code> <strong class="purple">must</strong> be the name of an <code>OpEntryPoint</code> in <code>module</code>
with an execution model that matches <code>stage</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-maxClipDistances-00708"></a>
If the identified entry point includes any variable in its interface
that is declared with the <code>ClipDistance</code> <code>BuiltIn</code> decoration,
that variable <strong class="purple">must</strong> not have an array size greater than
<code>VkPhysicalDeviceLimits</code>::<code>maxClipDistances</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-maxCullDistances-00709"></a>
If the identified entry point includes any variable in its interface
that is declared with the <code>CullDistance</code> <code>BuiltIn</code> decoration,
that variable <strong class="purple">must</strong> not have an array size greater than
<code>VkPhysicalDeviceLimits</code>::<code>maxCullDistances</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-maxCombinedClipAndCullDistances-00710"></a>
If the identified entry point includes any variables in its interface
that are declared with the <code>ClipDistance</code> or <code>CullDistance</code>
<code>BuiltIn</code> decoration, those variables <strong class="purple">must</strong> not have array sizes
which sum to more than
<code>VkPhysicalDeviceLimits</code>::<code>maxCombinedClipAndCullDistances</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-maxSampleMaskWords-00711"></a>
If the identified entry point includes any variable in its interface
that is declared with the <code>SampleMask</code> <code>BuiltIn</code> decoration, that
variable <strong class="purple">must</strong> not have an array size greater than
<code>VkPhysicalDeviceLimits</code>::<code>maxSampleMaskWords</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00712"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_VERTEX_BIT</code>, the identified entry
point <strong class="purple">must</strong> not include any input variable in its interface that is
decorated with <code>CullDistance</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00713"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_TESSELLATION_CONTROL_BIT</code> or
<code>VK_SHADER_STAGE_TESSELLATION_EVALUATION_BIT</code>, and the identified
entry point has an <code>OpExecutionMode</code> instruction that specifies a
patch size with <code>OutputVertices</code>, the patch size <strong class="purple">must</strong> be greater
than <code>0</code> and less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxTessellationPatchSize</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00714"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_GEOMETRY_BIT</code>, the identified
entry point <strong class="purple">must</strong> have an <code>OpExecutionMode</code> instruction that
specifies a maximum output vertex count that is greater than <code>0</code> and
less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxGeometryOutputVertices</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00715"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_GEOMETRY_BIT</code>, the identified
entry point <strong class="purple">must</strong> have an <code>OpExecutionMode</code> instruction that
specifies an invocation count that is greater than <code>0</code> and less than or
equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxGeometryShaderInvocations</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00716"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_GEOMETRY_BIT</code>, and the identified
entry point writes to <code>Layer</code> for any primitive, it <strong class="purple">must</strong> write the
same value to <code>Layer</code> for all vertices of a given primitive</p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00717"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_GEOMETRY_BIT</code>, and the identified
entry point writes to <code>ViewportIndex</code> for any primitive, it <strong class="purple">must</strong>
write the same value to <code>ViewportIndex</code> for all vertices of a given
primitive</p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00718"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_FRAGMENT_BIT</code>, the identified
entry point <strong class="purple">must</strong> not include any output variables in its interface
decorated with <code>CullDistance</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-00719"></a>
If <code>stage</code> is <code>VK_SHADER_STAGE_FRAGMENT_BIT</code>, and the identified
entry point writes to <code>FragDepth</code> in any execution path, it <strong class="purple">must</strong>
write to <code>FragDepth</code> in all execution paths</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-stage-parameter"></a> <code>stage</code> <strong class="purple">must</strong> be a valid <a href="#VkShaderStageFlagBits">VkShaderStageFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-module-parameter"></a> <code>module</code> <strong class="purple">must</strong> be a valid <code>VkShaderModule</code> handle</p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-pName-parameter"></a> <code>pName</code> <strong class="purple">must</strong> be a null-terminated UTF-8 string</p>
</li>
<li>
<p><a id="VUID-VkPipelineShaderStageCreateInfo-pSpecializationInfo-parameter"></a> If <code>pSpecializationInfo</code> is not <code>NULL</code>, <code>pSpecializationInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkSpecializationInfo</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineShaderStageCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkPipelineShaderStageCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineShaderStageCreateFlags</code> is a bitmask type for setting a mask,
but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Commands and structures which need to specify one or more shader stages do
so using a bitmask whose bits correspond to stages.
Bits which <strong class="purple">can</strong> be set to specify shader stages are:</p>
</div>
<div id="VkShaderStageFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkShaderStageFlagBits {
    VK_SHADER_STAGE_VERTEX_BIT = <span class="hex">0x00000001</span>,
    VK_SHADER_STAGE_TESSELLATION_CONTROL_BIT = <span class="hex">0x00000002</span>,
    VK_SHADER_STAGE_TESSELLATION_EVALUATION_BIT = <span class="hex">0x00000004</span>,
    VK_SHADER_STAGE_GEOMETRY_BIT = <span class="hex">0x00000008</span>,
    VK_SHADER_STAGE_FRAGMENT_BIT = <span class="hex">0x00000010</span>,
    VK_SHADER_STAGE_COMPUTE_BIT = <span class="hex">0x00000020</span>,
    VK_SHADER_STAGE_ALL_GRAPHICS = <span class="hex">0x0000001F</span>,
    VK_SHADER_STAGE_ALL = <span class="hex">0x7FFFFFFF</span>,
} VkShaderStageFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SHADER_STAGE_VERTEX_BIT</code> specifies the vertex stage.</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_TESSELLATION_CONTROL_BIT</code> specifies the
tessellation control stage.</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_TESSELLATION_EVALUATION_BIT</code> specifies the
tessellation evaluation stage.</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_GEOMETRY_BIT</code> specifies the geometry stage.</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_FRAGMENT_BIT</code> specifies the fragment stage.</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_COMPUTE_BIT</code> specifies the compute stage.</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_ALL_GRAPHICS</code> is a combination of bits used as
shorthand to specify all graphics stages defined above (excluding the
compute stage).</p>
</li>
<li>
<p><code>VK_SHADER_STAGE_ALL</code> is a combination of bits used as shorthand to
specify all shader stages supported by the device, including all
additional stages which are introduced by extensions.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><code>VK_SHADER_STAGE_ALL_GRAPHICS</code> only includes the original five graphics
stages included in Vulkan 1.0, and not any stages added by extensions.
Thus, it may not have the desired effect in all cases.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkShaderStageFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkShaderStageFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkShaderStageFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkShaderStageFlagBits">VkShaderStageFlagBits</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-graphics">9.2. Graphics Pipelines</h3>
<div class="paragraph">
<p>Graphics pipelines consist of multiple shader stages, multiple
fixed-function pipeline stages, and a pipeline layout.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create graphics pipelines, call:</p>
</div>
<div id="vkCreateGraphicsPipelines" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateGraphicsPipelines(
    VkDevice                                    device,
    VkPipelineCache                             pipelineCache,
    uint32_t                                    createInfoCount,
    <span class="directive">const</span> VkGraphicsPipelineCreateInfo*         pCreateInfos,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkPipeline*                                 pPipelines);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the graphics pipelines.</p>
</li>
<li>
<p><code>pipelineCache</code> is either <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, indicating that
pipeline caching is disabled; or the handle of a valid
<a href="#pipelines-cache">pipeline cache</a> object, in which case use of that
cache is enabled for the duration of the command.</p>
</li>
<li>
<p><code>createInfoCount</code> is the length of the <code>pCreateInfos</code> and
<code>pPipelines</code> arrays.</p>
</li>
<li>
<p><code>pCreateInfos</code> is an array of <a href="#VkGraphicsPipelineCreateInfo">VkGraphicsPipelineCreateInfo</a>
structures.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pPipelines</code> is a pointer to an array in which the resulting
graphics pipeline objects are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#VkGraphicsPipelineCreateInfo">VkGraphicsPipelineCreateInfo</a> structure includes an array of shader
create info structures containing all the desired active shader stages, as
well as creation info to define all relevant fixed-function stages, and a
pipeline layout.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-flags-00720"></a>
If the <code>flags</code> member of any element of <code>pCreateInfos</code> contains
the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code> flag, and the
<code>basePipelineIndex</code> member of that same element is not <code>-1</code>,
<code>basePipelineIndex</code> <strong class="purple">must</strong> be less than the index into
<code>pCreateInfos</code> that corresponds to that element</p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-flags-00721"></a>
If the <code>flags</code> member of any element of <code>pCreateInfos</code> contains
the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code> flag, the base pipeline
<strong class="purple">must</strong> have been created with the
<code>VK_PIPELINE_CREATE_ALLOW_DERIVATIVES_BIT</code> flag set</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-pipelineCache-parameter"></a> If <code>pipelineCache</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>pipelineCache</code> <strong class="purple">must</strong> be a valid <code>VkPipelineCache</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-pCreateInfos-parameter"></a> <code>pCreateInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>createInfoCount</code> valid <code>VkGraphicsPipelineCreateInfo</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-pPipelines-parameter"></a> <code>pPipelines</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>createInfoCount</code> <code>VkPipeline</code> handles</p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-createInfoCount-arraylength"></a> <code>createInfoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCreateGraphicsPipelines-pipelineCache-parent"></a> If <code>pipelineCache</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkGraphicsPipelineCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkGraphicsPipelineCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkGraphicsPipelineCreateInfo {
    VkStructureType                                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                                      pNext;
    VkPipelineCreateFlags                            flags;
    uint32_t                                         stageCount;
    <span class="directive">const</span> VkPipelineShaderStageCreateInfo*           pStages;
    <span class="directive">const</span> VkPipelineVertexInputStateCreateInfo*      pVertexInputState;
    <span class="directive">const</span> VkPipelineInputAssemblyStateCreateInfo*    pInputAssemblyState;
    <span class="directive">const</span> VkPipelineTessellationStateCreateInfo*     pTessellationState;
    <span class="directive">const</span> VkPipelineViewportStateCreateInfo*         pViewportState;
    <span class="directive">const</span> VkPipelineRasterizationStateCreateInfo*    pRasterizationState;
    <span class="directive">const</span> VkPipelineMultisampleStateCreateInfo*      pMultisampleState;
    <span class="directive">const</span> VkPipelineDepthStencilStateCreateInfo*     pDepthStencilState;
    <span class="directive">const</span> VkPipelineColorBlendStateCreateInfo*       pColorBlendState;
    <span class="directive">const</span> VkPipelineDynamicStateCreateInfo*          pDynamicState;
    VkPipelineLayout                                 layout;
    VkRenderPass                                     renderPass;
    uint32_t                                         subpass;
    VkPipeline                                       basePipelineHandle;
    int32_t                                          basePipelineIndex;
} VkGraphicsPipelineCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkPipelineCreateFlagBits">VkPipelineCreateFlagBits</a> specifying
how the pipeline will be generated.</p>
</li>
<li>
<p><code>stageCount</code> is the number of entries in the <code>pStages</code> array.</p>
</li>
<li>
<p><code>pStages</code> is an array of size <code>stageCount</code> structures of type
<a href="#VkPipelineShaderStageCreateInfo">VkPipelineShaderStageCreateInfo</a> describing the set of the shader
stages to be included in the graphics pipeline.</p>
</li>
<li>
<p><code>pVertexInputState</code> is a pointer to an instance of the
<a href="#VkPipelineVertexInputStateCreateInfo">VkPipelineVertexInputStateCreateInfo</a> structure.</p>
</li>
<li>
<p><code>pInputAssemblyState</code> is a pointer to an instance of the
<a href="#VkPipelineInputAssemblyStateCreateInfo">VkPipelineInputAssemblyStateCreateInfo</a> structure which determines
input assembly behavior, as described in <a href="#drawing">Drawing Commands</a>.</p>
</li>
<li>
<p><code>pTessellationState</code> is a pointer to an instance of the
<a href="#VkPipelineTessellationStateCreateInfo">VkPipelineTessellationStateCreateInfo</a> structure, and is ignored if
the pipeline does not include a tessellation control shader stage and
tessellation evaluation shader stage.</p>
</li>
<li>
<p><code>pViewportState</code> is a pointer to an instance of the
<a href="#VkPipelineViewportStateCreateInfo">VkPipelineViewportStateCreateInfo</a> structure, and is ignored if the
pipeline has rasterization disabled.</p>
</li>
<li>
<p><code>pRasterizationState</code> is a pointer to an instance of the
<a href="#VkPipelineRasterizationStateCreateInfo">VkPipelineRasterizationStateCreateInfo</a> structure.</p>
</li>
<li>
<p><code>pMultisampleState</code> is a pointer to an instance of the
<a href="#VkPipelineMultisampleStateCreateInfo">VkPipelineMultisampleStateCreateInfo</a>, and is ignored if the
pipeline has rasterization disabled.</p>
</li>
<li>
<p><code>pDepthStencilState</code> is a pointer to an instance of the
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a> structure, and is ignored if
the pipeline has rasterization disabled or if the subpass of the render
pass the pipeline is created against does not use a depth/stencil
attachment.</p>
</li>
<li>
<p><code>pColorBlendState</code> is a pointer to an instance of the
<a href="#VkPipelineColorBlendStateCreateInfo">VkPipelineColorBlendStateCreateInfo</a> structure, and is ignored if
the pipeline has rasterization disabled or if the subpass of the render
pass the pipeline is created against does not use any color attachments.</p>
</li>
<li>
<p><code>pDynamicState</code> is a pointer to
<a href="#VkPipelineDynamicStateCreateInfo">VkPipelineDynamicStateCreateInfo</a> and is used to indicate which
properties of the pipeline state object are dynamic and <strong class="purple">can</strong> be changed
independently of the pipeline state.
This <strong class="purple">can</strong> be <code>NULL</code>, which means no state in the pipeline is considered
dynamic.</p>
</li>
<li>
<p><code>layout</code> is the description of binding locations used by both the
pipeline and descriptor sets used with the pipeline.</p>
</li>
<li>
<p><code>renderPass</code> is a handle to a render pass object describing the
environment in which the pipeline will be used; the pipeline <strong class="purple">must</strong> only
be used with an instance of any render pass compatible with the one
provided.
See <a href="#renderpass-compatibility">Render Pass Compatibility</a> for more
information.</p>
</li>
<li>
<p><code>subpass</code> is the index of the subpass in the render pass where this
pipeline will be used.</p>
</li>
<li>
<p><code>basePipelineHandle</code> is a pipeline to derive from.</p>
</li>
<li>
<p><code>basePipelineIndex</code> is an index into the <code>pCreateInfos</code>
parameter to use as a pipeline to derive from.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The parameters <code>basePipelineHandle</code> and <code>basePipelineIndex</code> are
described in more detail in <a href="#pipelines-pipeline-derivatives">Pipeline
Derivatives</a>.</p>
</div>
<div class="paragraph">
<p><code>pStages</code> points to an array of <a href="#VkPipelineShaderStageCreateInfo">VkPipelineShaderStageCreateInfo</a>
structures, which were previously described in <a href="#pipelines-compute">Compute
Pipelines</a>.</p>
</div>
<div class="paragraph">
<p><code>pDynamicState</code> points to a structure of type
<a href="#VkPipelineDynamicStateCreateInfo">VkPipelineDynamicStateCreateInfo</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-flags-00722"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineIndex</code> is -1, <code>basePipelineHandle</code> <strong class="purple">must</strong>
be a valid handle to a graphics <code>VkPipeline</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-flags-00723"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineHandle</code> is <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>basePipelineIndex</code> <strong class="purple">must</strong> be a valid index into the calling
command&#8217;s <code>pCreateInfos</code> parameter</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-flags-00724"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineIndex</code> is not -1, <code>basePipelineHandle</code>
<strong class="purple">must</strong> be <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-flags-00725"></a>
If <code>flags</code> contains the <code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>
flag, and <code>basePipelineHandle</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>basePipelineIndex</code> <strong class="purple">must</strong> be -1</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-stage-00726"></a>
The <code>stage</code> member of each element of <code>pStages</code> <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-stage-00727"></a>
The <code>stage</code> member of one element of <code>pStages</code> <strong class="purple">must</strong> be
<code>VK_SHADER_STAGE_VERTEX_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-stage-00728"></a>
The <code>stage</code> member of each element of <code>pStages</code> <strong class="purple">must</strong> not be
<code>VK_SHADER_STAGE_COMPUTE_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00729"></a>
If <code>pStages</code> includes a tessellation control shader stage, it <strong class="purple">must</strong>
include a tessellation evaluation shader stage</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00730"></a>
If <code>pStages</code> includes a tessellation evaluation shader stage, it
<strong class="purple">must</strong> include a tessellation control shader stage</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00731"></a>
If <code>pStages</code> includes a tessellation control shader stage and a
tessellation evaluation shader stage, <code>pTessellationState</code> <strong class="purple">must</strong> be
a valid pointer to a valid <code>VkPipelineTessellationStateCreateInfo</code>
structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00732"></a>
If <code>pStages</code> includes tessellation shader stages, the shader code of
at least one stage <strong class="purple">must</strong> contain an <code>OpExecutionMode</code> instruction
that specifies the type of subdivision in the pipeline</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00733"></a>
If <code>pStages</code> includes tessellation shader stages, and the shader
code of both stages contain an <code>OpExecutionMode</code> instruction that
specifies the type of subdivision in the pipeline, they <strong class="purple">must</strong> both
specify the same subdivision mode</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00734"></a>
If <code>pStages</code> includes tessellation shader stages, the shader code of
at least one stage <strong class="purple">must</strong> contain an <code>OpExecutionMode</code> instruction
that specifies the output patch size in the pipeline</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00735"></a>
If <code>pStages</code> includes tessellation shader stages, and the shader
code of both contain an <code>OpExecutionMode</code> instruction that specifies
the out patch size in the pipeline, they <strong class="purple">must</strong> both specify the same
patch size</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00736"></a>
If <code>pStages</code> includes tessellation shader stages, the <code>topology</code>
member of <code>pInputAssembly</code> <strong class="purple">must</strong> be
<code>VK_PRIMITIVE_TOPOLOGY_PATCH_LIST</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-topology-00737"></a>
If the <code>topology</code> member of <code>pInputAssembly</code> is
<code>VK_PRIMITIVE_TOPOLOGY_PATCH_LIST</code>, <code>pStages</code> <strong class="purple">must</strong> include
tessellation shader stages</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00738"></a>
If <code>pStages</code> includes a geometry shader stage, and does not include
any tessellation shader stages, its shader code <strong class="purple">must</strong> contain an
<code>OpExecutionMode</code> instruction that specifies an input primitive type
that is <a href="#shaders-geometry-execution">compatible</a> with the primitive
topology specified in <code>pInputAssembly</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00739"></a>
If <code>pStages</code> includes a geometry shader stage, and also includes
tessellation shader stages, its shader code <strong class="purple">must</strong> contain an
<code>OpExecutionMode</code> instruction that specifies an input primitive type
that is <a href="#shaders-geometry-execution">compatible</a> with the primitive
topology that is output by the tessellation stages</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00740"></a>
If <code>pStages</code> includes a fragment shader stage and a geometry shader
stage, and the fragment shader code reads from an input variable that is
decorated with <code>PrimitiveID</code>, then the geometry shader code <strong class="purple">must</strong>
write to a matching output variable, decorated with <code>PrimitiveID</code>, in
all execution paths</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00741"></a>
If <code>pStages</code> includes a fragment shader stage, its shader code <strong class="purple">must</strong>
not read from any input attachment that is defined as
<code>VK_ATTACHMENT_UNUSED</code> in <code>subpass</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-00742"></a>
The shader code for the entry points identified by <code>pStages</code>, and
the rest of the state identified by this structure <strong class="purple">must</strong> adhere to the
pipeline linking rules described in the <a href="#interfaces">Shader Interfaces</a>
chapter</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-subpass-00743"></a>
If rasterization is not disabled and <code>subpass</code> uses a depth/stencil
attachment in <code>renderPass</code> that has a layout of
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> in the
<code>VkAttachmentReference</code> defined by <code>subpass</code>, the
<code>depthWriteEnable</code> member of <code>pDepthStencilState</code> <strong class="purple">must</strong> be
<code>VK_FALSE</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-subpass-00744"></a>
If rasterization is not disabled and <code>subpass</code> uses a depth/stencil
attachment in <code>renderPass</code> that has a layout of
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> in the
<code>VkAttachmentReference</code> defined by <code>subpass</code>, the <code>failOp</code>,
<code>passOp</code> and <code>depthFailOp</code> members of each of the <code>front</code>
and <code>back</code> members of <code>pDepthStencilState</code> <strong class="purple">must</strong> be
<code>VK_STENCIL_OP_KEEP</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-blendEnable-02023"></a>
If rasterization is not disabled and the subpass uses color attachments,
then for each color attachment in the subpass the <code>blendEnable</code>
member of the corresponding element of the <code>pAttachment</code> member of
<code>pColorBlendState</code> <strong class="purple">must</strong> be <code>VK_FALSE</code> if the attached image&#8217;s
<a href="#resources-image-format-features">format features</a> does not contain the
<code>VK_FORMAT_FEATURE_COLOR_ATTACHMENT_BLEND_BIT</code>.</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-attachmentCount-00746"></a>
If rasterization is not disabled and the subpass uses color attachments,
the <code>attachmentCount</code> member of <code>pColorBlendState</code> <strong class="purple">must</strong> be
equal to the <code>colorAttachmentCount</code> used to create <code>subpass</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pDynamicStates-00747"></a>
If no element of the <code>pDynamicStates</code> member of <code>pDynamicState</code>
is <code>VK_DYNAMIC_STATE_VIEWPORT</code>, the <code>pViewports</code> member of
<code>pViewportState</code> <strong class="purple">must</strong> be a valid pointer to an array of
<code>pViewportState</code>::<code>viewportCount</code> valid <code>VkViewport</code>
structures</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pDynamicStates-00748"></a>
If no element of the <code>pDynamicStates</code> member of <code>pDynamicState</code>
is <code>VK_DYNAMIC_STATE_SCISSOR</code>, the <code>pScissors</code> member of
<code>pViewportState</code> <strong class="purple">must</strong> be a valid pointer to an array of
<code>pViewportState</code>::<code>scissorCount</code> <code>VkRect2D</code> structures</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pDynamicStates-00749"></a>
If the wide lines feature is not enabled, and no element of the
<code>pDynamicStates</code> member of <code>pDynamicState</code> is
<code>VK_DYNAMIC_STATE_LINE_WIDTH</code>, the <code>lineWidth</code> member of
<code>pRasterizationState</code> <strong class="purple">must</strong> be <code>1.0</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-rasterizerDiscardEnable-00750"></a>
If the <code>rasterizerDiscardEnable</code> member of <code>pRasterizationState</code>
is <code>VK_FALSE</code>, <code>pViewportState</code> <strong class="purple">must</strong> be a valid pointer to a
valid <code>VkPipelineViewportStateCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-rasterizerDiscardEnable-00751"></a>
If the <code>rasterizerDiscardEnable</code> member of <code>pRasterizationState</code>
is <code>VK_FALSE</code>, <code>pMultisampleState</code> <strong class="purple">must</strong> be a valid pointer to a
valid <code>VkPipelineMultisampleStateCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-rasterizerDiscardEnable-00752"></a>
If the <code>rasterizerDiscardEnable</code> member of <code>pRasterizationState</code>
is <code>VK_FALSE</code>, and <code>subpass</code> uses a depth/stencil attachment,
<code>pDepthStencilState</code> <strong class="purple">must</strong> be a valid pointer to a valid
<code>VkPipelineDepthStencilStateCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-rasterizerDiscardEnable-00753"></a>
If the <code>rasterizerDiscardEnable</code> member of <code>pRasterizationState</code>
is <code>VK_FALSE</code>, and <code>subpass</code> uses color attachments,
<code>pColorBlendState</code> <strong class="purple">must</strong> be a valid pointer to a valid
<code>VkPipelineColorBlendStateCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pDynamicStates-00754"></a>
If the depth bias clamping feature is not enabled, no element of the
<code>pDynamicStates</code> member of <code>pDynamicState</code> is
<code>VK_DYNAMIC_STATE_DEPTH_BIAS</code>, and the <code>depthBiasEnable</code> member
of <code>pRasterizationState</code> is <code>VK_TRUE</code>, the <code>depthBiasClamp</code>
member of <code>pRasterizationState</code> <strong class="purple">must</strong> be <code>0.0</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pDynamicStates-00755"></a>
If no element of the <code>pDynamicStates</code> member of <code>pDynamicState</code>
is <code>VK_DYNAMIC_STATE_DEPTH_BOUNDS</code>, and the
<code>depthBoundsTestEnable</code> member of <code>pDepthStencilState</code> is
<code>VK_TRUE</code>, the <code>minDepthBounds</code> and <code>maxDepthBounds</code> members
of <code>pDepthStencilState</code> <strong class="purple">must</strong> be between <code>0.0</code> and <code>1.0</code>, inclusive</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-layout-00756"></a>
<code>layout</code> <strong class="purple">must</strong> be
<a href="#descriptorsets-pipelinelayout-consistency">consistent</a> with all
shaders specified in <code>pStages</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-subpass-00757"></a>
If <code>subpass</code> uses color and/or depth/stencil attachments, then the
<code>rasterizationSamples</code> member of <code>pMultisampleState</code> <strong class="purple">must</strong> be
the same as the sample count for those subpass attachments</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-subpass-00758"></a>
If <code>subpass</code> does not use any color and/or depth/stencil
attachments, then the <code>rasterizationSamples</code> member of
<code>pMultisampleState</code> <strong class="purple">must</strong> follow the rules for a
<a href="#renderpass-noattachments">zero-attachment subpass</a></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-subpass-00759"></a>
<code>subpass</code> <strong class="purple">must</strong> be a valid subpass within <code>renderPass</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-layout-01688"></a>
The number of resources in <code>layout</code> accessible to each shader stage
that is used by the pipeline <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxPerStageResources</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-02097"></a>
If <code>pStages</code> includes a vertex shader stage, <code>pVertexInputState</code>
<strong class="purple">must</strong> be a valid pointer to a valid
<a href="#VkPipelineVertexInputStateCreateInfo">VkPipelineVertexInputStateCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-02098"></a>
If <code>pStages</code> includes a vertex shader stage,
<code>pInputAssemblyState</code> <strong class="purple">must</strong> be a valid pointer to a valid
<a href="#VkPipelineInputAssemblyStateCreateInfo">VkPipelineInputAssemblyStateCreateInfo</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_GRAPHICS_PIPELINE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkPipelineCreateFlagBits">VkPipelineCreateFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pStages-parameter"></a> <code>pStages</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stageCount</code> valid <code>VkPipelineShaderStageCreateInfo</code> structures</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pRasterizationState-parameter"></a> <code>pRasterizationState</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkPipelineRasterizationStateCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-pDynamicState-parameter"></a> If <code>pDynamicState</code> is not <code>NULL</code>, <code>pDynamicState</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkPipelineDynamicStateCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-layout-parameter"></a> <code>layout</code> <strong class="purple">must</strong> be a valid <code>VkPipelineLayout</code> handle</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-renderPass-parameter"></a> <code>renderPass</code> <strong class="purple">must</strong> be a valid <code>VkRenderPass</code> handle</p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-stageCount-arraylength"></a> <code>stageCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkGraphicsPipelineCreateInfo-commonparent"></a> Each of <code>basePipelineHandle</code>, <code>layout</code>, and <code>renderPass</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of the <code>flags</code> member of
<a href="#VkGraphicsPipelineCreateInfo">VkGraphicsPipelineCreateInfo</a> and <a href="#VkComputePipelineCreateInfo">VkComputePipelineCreateInfo</a>,
specifying how a pipeline is created, are:</p>
</div>
<div id="VkPipelineCreateFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkPipelineCreateFlagBits {
    VK_PIPELINE_CREATE_DISABLE_OPTIMIZATION_BIT = <span class="hex">0x00000001</span>,
    VK_PIPELINE_CREATE_ALLOW_DERIVATIVES_BIT = <span class="hex">0x00000002</span>,
    VK_PIPELINE_CREATE_DERIVATIVE_BIT = <span class="hex">0x00000004</span>,
} VkPipelineCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_CREATE_DISABLE_OPTIMIZATION_BIT</code> specifies that the
created pipeline will not be optimized.
Using this flag <strong class="purple">may</strong> reduce the time taken to create the pipeline.</p>
</li>
<li>
<p><code>VK_PIPELINE_CREATE_ALLOW_DERIVATIVES_BIT</code> specifies that the
pipeline to be created is allowed to be the parent of a pipeline that
will be created in a subsequent call to <a href="#vkCreateGraphicsPipelines">vkCreateGraphicsPipelines</a>
or <a href="#vkCreateComputePipelines">vkCreateComputePipelines</a>.</p>
</li>
<li>
<p><code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code> specifies that the pipeline to
be created will be a child of a previously created parent pipeline.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is valid to set both <code>VK_PIPELINE_CREATE_ALLOW_DERIVATIVES_BIT</code> and
<code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code>.
This allows a pipeline to be both a parent and possibly a child in a
pipeline hierarchy.
See <a href="#pipelines-pipeline-derivatives">Pipeline Derivatives</a> for more
information.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkPipelineCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineCreateFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkPipelineCreateFlagBits">VkPipelineCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineDynamicStateCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkPipelineDynamicStateCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPipelineDynamicStateCreateInfo {
    VkStructureType                      sType;
    <span class="directive">const</span> <span class="directive">void</span>*                          pNext;
    VkPipelineDynamicStateCreateFlags    flags;
    uint32_t                             dynamicStateCount;
    <span class="directive">const</span> VkDynamicState*                pDynamicStates;
} VkPipelineDynamicStateCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>dynamicStateCount</code> is the number of elements in the
<code>pDynamicStates</code> array.</p>
</li>
<li>
<p><code>pDynamicStates</code> is an array of <a href="#VkDynamicState">VkDynamicState</a> values
specifying which pieces of pipeline state will use the values from
dynamic state commands rather than from pipeline state creation info.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineDynamicStateCreateInfo-pDynamicStates-01442"></a>
Each element of <code>pDynamicStates</code> <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineDynamicStateCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_DYNAMIC_STATE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDynamicStateCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDynamicStateCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineDynamicStateCreateInfo-pDynamicStates-parameter"></a> <code>pDynamicStates</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dynamicStateCount</code> valid <a href="#VkDynamicState">VkDynamicState</a> values</p>
</li>
<li>
<p><a id="VUID-VkPipelineDynamicStateCreateInfo-dynamicStateCount-arraylength"></a> <code>dynamicStateCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineDynamicStateCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkPipelineDynamicStateCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineDynamicStateCreateFlags</code> is a bitmask type for setting a
mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The source of different pieces of dynamic state is specified by the
<a href="#VkPipelineDynamicStateCreateInfo">VkPipelineDynamicStateCreateInfo</a>::<code>pDynamicStates</code> property of the
currently active pipeline, each of whose elements <strong class="purple">must</strong> be one of the
values:</p>
</div>
<div id="VkDynamicState" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkDynamicState {
    VK_DYNAMIC_STATE_VIEWPORT = <span class="integer">0</span>,
    VK_DYNAMIC_STATE_SCISSOR = <span class="integer">1</span>,
    VK_DYNAMIC_STATE_LINE_WIDTH = <span class="integer">2</span>,
    VK_DYNAMIC_STATE_DEPTH_BIAS = <span class="integer">3</span>,
    VK_DYNAMIC_STATE_BLEND_CONSTANTS = <span class="integer">4</span>,
    VK_DYNAMIC_STATE_DEPTH_BOUNDS = <span class="integer">5</span>,
    VK_DYNAMIC_STATE_STENCIL_COMPARE_MASK = <span class="integer">6</span>,
    VK_DYNAMIC_STATE_STENCIL_WRITE_MASK = <span class="integer">7</span>,
    VK_DYNAMIC_STATE_STENCIL_REFERENCE = <span class="integer">8</span>,
} VkDynamicState;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DYNAMIC_STATE_VIEWPORT</code> specifies that the <code>pViewports</code>
state in <code>VkPipelineViewportStateCreateInfo</code> will be ignored and
<strong class="purple">must</strong> be set dynamically with <a href="#vkCmdSetViewport">vkCmdSetViewport</a> before any draw
commands.
The number of viewports used by a pipeline is still specified by the
<code>viewportCount</code> member of <code>VkPipelineViewportStateCreateInfo</code>.</p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_SCISSOR</code> specifies that the <code>pScissors</code> state
in <code>VkPipelineViewportStateCreateInfo</code> will be ignored and <strong class="purple">must</strong> be
set dynamically with <a href="#vkCmdSetScissor">vkCmdSetScissor</a> before any draw commands.
The number of scissor rectangles used by a pipeline is still specified
by the <code>scissorCount</code> member of
<code>VkPipelineViewportStateCreateInfo</code>.</p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_LINE_WIDTH</code> specifies that the <code>lineWidth</code>
state in <code>VkPipelineRasterizationStateCreateInfo</code> will be ignored
and <strong class="purple">must</strong> be set dynamically with <a href="#vkCmdSetLineWidth">vkCmdSetLineWidth</a> before any
draw commands that generate line primitives for the rasterizer.</p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_DEPTH_BIAS</code> specifies that the
<code>depthBiasConstantFactor</code>, <code>depthBiasClamp</code> and
<code>depthBiasSlopeFactor</code> states in
<code>VkPipelineRasterizationStateCreateInfo</code> will be ignored and <strong class="purple">must</strong>
be set dynamically with <a href="#vkCmdSetDepthBias">vkCmdSetDepthBias</a> before any draws are
performed with <code>depthBiasEnable</code> in
<code>VkPipelineRasterizationStateCreateInfo</code> set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_BLEND_CONSTANTS</code> specifies that the
<code>blendConstants</code> state in <code>VkPipelineColorBlendStateCreateInfo</code>
will be ignored and <strong class="purple">must</strong> be set dynamically with
<a href="#vkCmdSetBlendConstants">vkCmdSetBlendConstants</a> before any draws are performed with a
pipeline state with <code>VkPipelineColorBlendAttachmentState</code> member
<code>blendEnable</code> set to <code>VK_TRUE</code> and any of the blend functions
using a constant blend color.</p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_DEPTH_BOUNDS</code> specifies that the
<code>minDepthBounds</code> and <code>maxDepthBounds</code> states of
<a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a> will be ignored and <strong class="purple">must</strong> be
set dynamically with <a href="#vkCmdSetDepthBounds">vkCmdSetDepthBounds</a> before any draws are
performed with a pipeline state with
<code>VkPipelineDepthStencilStateCreateInfo</code> member
<code>depthBoundsTestEnable</code> set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_STENCIL_COMPARE_MASK</code> specifies that the
<code>compareMask</code> state in <code>VkPipelineDepthStencilStateCreateInfo</code>
for both <code>front</code> and <code>back</code> will be ignored and <strong class="purple">must</strong> be set
dynamically with <a href="#vkCmdSetStencilCompareMask">vkCmdSetStencilCompareMask</a> before any draws are
performed with a pipeline state with
<code>VkPipelineDepthStencilStateCreateInfo</code> member
<code>stencilTestEnable</code> set to <code>VK_TRUE</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_STENCIL_WRITE_MASK</code> specifies that the
<code>writeMask</code> state in <code>VkPipelineDepthStencilStateCreateInfo</code> for
both <code>front</code> and <code>back</code> will be ignored and <strong class="purple">must</strong> be set
dynamically with <a href="#vkCmdSetStencilWriteMask">vkCmdSetStencilWriteMask</a> before any draws are
performed with a pipeline state with
<code>VkPipelineDepthStencilStateCreateInfo</code> member
<code>stencilTestEnable</code> set to <code>VK_TRUE</code></p>
</li>
<li>
<p><code>VK_DYNAMIC_STATE_STENCIL_REFERENCE</code> specifies that the
<code>reference</code> state in <code>VkPipelineDepthStencilStateCreateInfo</code> for
both <code>front</code> and <code>back</code> will be ignored and <strong class="purple">must</strong> be set
dynamically with <a href="#vkCmdSetStencilReference">vkCmdSetStencilReference</a> before any draws are
performed with a pipeline state with
<code>VkPipelineDepthStencilStateCreateInfo</code> member
<code>stencilTestEnable</code> set to <code>VK_TRUE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_valid_combinations_of_stages_for_graphics_pipelines">9.2.1. Valid Combinations of Stages for Graphics Pipelines</h4>
<div class="paragraph">
<p>If tessellation shader stages are omitted, the tessellation shading and
fixed-function stages of the pipeline are skipped.</p>
</div>
<div class="paragraph">
<p>If a geometry shader is omitted, the geometry shading stage is skipped.</p>
</div>
<div class="paragraph">
<p>If a fragment shader is omitted, the results of fragment processing are
undefined.
Specifically, any fragment color outputs are considered to have undefined
values, and the fragment depth is considered to be unmodified.
This <strong class="purple">can</strong> be useful for depth-only rendering.</p>
</div>
<div class="paragraph">
<p>Presence of a shader stage in a pipeline is indicated by including a valid
<code>VkPipelineShaderStageCreateInfo</code> with <code>module</code> and <code>pName</code>
selecting an entry point from a shader module, where that entry point is
valid for the stage specified by <code>stage</code>.</p>
</div>
<div class="paragraph">
<p>Presence of some of the fixed-function stages in the pipeline is implicitly
derived from enabled shaders and provided state.
For example, the fixed-function tessellator is always present when the
pipeline has valid Tessellation Control and Tessellation Evaluation shaders.</p>
</div>
<div class="ulist">
<div class="title">For example:</div>
<ul>
<li>
<p>Depth/stencil-only rendering in a subpass with no color attachments</p>
<div class="ulist">
<ul>
<li>
<p>Active Pipeline Shader Stages</p>
<div class="ulist">
<ul>
<li>
<p>Vertex Shader</p>
</li>
</ul>
</div>
</li>
<li>
<p>Required: Fixed-Function Pipeline Stages</p>
<div class="ulist">
<ul>
<li>
<p><a href="#VkPipelineVertexInputStateCreateInfo">VkPipelineVertexInputStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineInputAssemblyStateCreateInfo">VkPipelineInputAssemblyStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineViewportStateCreateInfo">VkPipelineViewportStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineRasterizationStateCreateInfo">VkPipelineRasterizationStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineMultisampleStateCreateInfo">VkPipelineMultisampleStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Color-only rendering in a subpass with no depth/stencil attachment</p>
<div class="ulist">
<ul>
<li>
<p>Active Pipeline Shader Stages</p>
<div class="ulist">
<ul>
<li>
<p>Vertex Shader</p>
</li>
<li>
<p>Fragment Shader</p>
</li>
</ul>
</div>
</li>
<li>
<p>Required: Fixed-Function Pipeline Stages</p>
<div class="ulist">
<ul>
<li>
<p><a href="#VkPipelineVertexInputStateCreateInfo">VkPipelineVertexInputStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineInputAssemblyStateCreateInfo">VkPipelineInputAssemblyStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineViewportStateCreateInfo">VkPipelineViewportStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineRasterizationStateCreateInfo">VkPipelineRasterizationStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineMultisampleStateCreateInfo">VkPipelineMultisampleStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineColorBlendStateCreateInfo">VkPipelineColorBlendStateCreateInfo</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Rendering pipeline with tessellation and geometry shaders</p>
<div class="ulist">
<ul>
<li>
<p>Active Pipeline Shader Stages</p>
<div class="ulist">
<ul>
<li>
<p>Vertex Shader</p>
</li>
<li>
<p>Tessellation Control Shader</p>
</li>
<li>
<p>Tessellation Evaluation Shader</p>
</li>
<li>
<p>Geometry Shader</p>
</li>
<li>
<p>Fragment Shader</p>
</li>
</ul>
</div>
</li>
<li>
<p>Required: Fixed-Function Pipeline Stages</p>
<div class="ulist">
<ul>
<li>
<p><a href="#VkPipelineVertexInputStateCreateInfo">VkPipelineVertexInputStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineInputAssemblyStateCreateInfo">VkPipelineInputAssemblyStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineTessellationStateCreateInfo">VkPipelineTessellationStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineViewportStateCreateInfo">VkPipelineViewportStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineRasterizationStateCreateInfo">VkPipelineRasterizationStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineMultisampleStateCreateInfo">VkPipelineMultisampleStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineDepthStencilStateCreateInfo">VkPipelineDepthStencilStateCreateInfo</a></p>
</li>
<li>
<p><a href="#VkPipelineColorBlendStateCreateInfo">VkPipelineColorBlendStateCreateInfo</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-destruction">9.3. Pipeline destruction</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a graphics or compute pipeline, call:</p>
</div>
<div id="vkDestroyPipeline" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyPipeline(
    VkDevice                                    device,
    VkPipeline                                  pipeline,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the pipeline.</p>
</li>
<li>
<p><code>pipeline</code> is the handle of the pipeline to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyPipeline-pipeline-00765"></a>
All submitted commands that refer to <code>pipeline</code> <strong class="purple">must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipeline-pipeline-00766"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>pipeline</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipeline-pipeline-00767"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>pipeline</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyPipeline-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipeline-pipeline-parameter"></a> If <code>pipeline</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>pipeline</code> <strong class="purple">must</strong> be a valid <code>VkPipeline</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipeline-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipeline-pipeline-parent"></a> If <code>pipeline</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>pipeline</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-multiple">9.4. Multiple Pipeline Creation</h3>
<div class="paragraph">
<p>Multiple pipelines <strong class="purple">can</strong> be created simultaneously by passing an array of
<code>VkGraphicsPipelineCreateInfo</code> or <code>VkComputePipelineCreateInfo</code>
structures into the <a href="#vkCreateGraphicsPipelines">vkCreateGraphicsPipelines</a> and
<a href="#vkCreateComputePipelines">vkCreateComputePipelines</a> commands, respectively.
Applications <strong class="purple">can</strong> group together similar pipelines to be created in a single
call, and implementations are encouraged to look for reuse opportunities
within a group-create.</p>
</div>
<div class="paragraph">
<p>When an application attempts to create many pipelines in a single command,
it is possible that some subset <strong class="purple">may</strong> fail creation.
In that case, the corresponding entries in the <code>pPipelines</code> output array
will be filled with <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a> values.
If any pipeline fails creation (for example, due to out of memory errors),
the <code>vkCreate*Pipelines</code> commands will return an error code.
The implementation will attempt to create all pipelines, and only return
<a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a> values for those that actually failed.</p>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-pipeline-derivatives">9.5. Pipeline Derivatives</h3>
<div class="paragraph">
<p>A pipeline derivative is a child pipeline created from a parent pipeline,
where the child and parent are expected to have much commonality.
The goal of derivative pipelines is that they be cheaper to create using the
parent as a starting point, and that it be more efficient (on either host or
device) to switch/bind between children of the same parent.</p>
</div>
<div class="paragraph">
<p>A derivative pipeline is created by setting the
<code>VK_PIPELINE_CREATE_DERIVATIVE_BIT</code> flag in the
<code>Vk*PipelineCreateInfo</code> structure.
If this is set, then exactly one of <code>basePipelineHandle</code> or
<code>basePipelineIndex</code> members of the structure <strong class="purple">must</strong> have a valid
handle/index, and specifies the parent pipeline.
If <code>basePipelineHandle</code> is used, the parent pipeline <strong class="purple">must</strong> have already
been created.
If <code>basePipelineIndex</code> is used, then the parent is being created in the
same command.
<a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a> acts as the invalid handle for
<code>basePipelineHandle</code>, and -1 is the invalid index for
<code>basePipelineIndex</code>.
If <code>basePipelineIndex</code> is used, the base pipeline <strong class="purple">must</strong> appear earlier
in the array.
The base pipeline <strong class="purple">must</strong> have been created with the
<code>VK_PIPELINE_CREATE_ALLOW_DERIVATIVES_BIT</code> flag set.</p>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-cache">9.6. Pipeline Cache</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Pipeline cache objects allow the result of pipeline construction to be
reused between pipelines and between runs of an application.
Reuse between pipelines is achieved by passing the same pipeline cache
object when creating multiple related pipelines.
Reuse across runs of an application is achieved by retrieving pipeline cache
contents in one run of an application, saving the contents, and using them
to preinitialize a pipeline cache on a subsequent run.
The contents of the pipeline cache objects are managed by the
implementation.
Applications <strong class="purple">can</strong> manage the host memory consumed by a pipeline cache object
and control the amount of data retrieved from a pipeline cache object.</p>
</div>
<div class="paragraph">
<p>Pipeline cache objects are represented by <code>VkPipelineCache</code> handles:</p>
</div>
<div id="VkPipelineCache" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkPipelineCache)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create pipeline cache objects, call:</p>
</div>
<div id="vkCreatePipelineCache" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreatePipelineCache(
    VkDevice                                    device,
    <span class="directive">const</span> VkPipelineCacheCreateInfo*            pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkPipelineCache*                            pPipelineCache);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the pipeline cache
object.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="#VkPipelineCacheCreateInfo">VkPipelineCacheCreateInfo</a>
structure that contains the initial parameters for the pipeline cache
object.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pPipelineCache</code> is a pointer to a <a href="#VkPipelineCache">VkPipelineCache</a> handle in
which the resulting pipeline cache object is returned.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> track and manage the total host memory size of a pipeline
cache object using the <code>pAllocator</code>.
Applications <strong class="purple">can</strong> limit the amount of data retrieved from a pipeline cache
object in <code>vkGetPipelineCacheData</code>.
Implementations <strong class="purple">should</strong> not internally limit the total number of entries
added to a pipeline cache object or the total host memory consumed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once created, a pipeline cache <strong class="purple">can</strong> be passed to the
<code>vkCreateGraphicsPipelines</code> and <code>vkCreateComputePipelines</code> commands.
If the pipeline cache passed into these commands is not
<a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the implementation will query it for possible reuse
opportunities and update it with new content.
The use of the pipeline cache object in these commands is internally
synchronized, and the same pipeline cache object <strong class="purple">can</strong> be used in multiple
threads simultaneously.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations <strong class="purple">should</strong> make every effort to limit any critical sections to
the actual accesses to the cache, which is expected to be significantly
shorter than the duration of the <code>vkCreateGraphicsPipelines</code> and
<code>vkCreateComputePipelines</code> commands.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreatePipelineCache-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreatePipelineCache-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkPipelineCacheCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreatePipelineCache-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreatePipelineCache-pPipelineCache-parameter"></a> <code>pPipelineCache</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkPipelineCache</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPipelineCacheCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkPipelineCacheCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPipelineCacheCreateInfo {
    VkStructureType               sType;
    <span class="directive">const</span> <span class="directive">void</span>*                   pNext;
    VkPipelineCacheCreateFlags    flags;
    size_t                        initialDataSize;
    <span class="directive">const</span> <span class="directive">void</span>*                   pInitialData;
} VkPipelineCacheCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>initialDataSize</code> is the number of bytes in <code>pInitialData</code>.
If <code>initialDataSize</code> is zero, the pipeline cache will initially be
empty.</p>
</li>
<li>
<p><code>pInitialData</code> is a pointer to previously retrieved pipeline cache
data.
If the pipeline cache data is incompatible (as defined below) with the
device, the pipeline cache will be initially empty.
If <code>initialDataSize</code> is zero, <code>pInitialData</code> is ignored.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCacheCreateInfo-initialDataSize-00768"></a>
If <code>initialDataSize</code> is not <code>0</code>, it <strong class="purple">must</strong> be equal to the size of
<code>pInitialData</code>, as returned by <code>vkGetPipelineCacheData</code> when
<code>pInitialData</code> was originally retrieved</p>
</li>
<li>
<p><a id="VUID-VkPipelineCacheCreateInfo-initialDataSize-00769"></a>
If <code>initialDataSize</code> is not <code>0</code>, <code>pInitialData</code> <strong class="purple">must</strong> have been
retrieved from a previous call to <code>vkGetPipelineCacheData</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPipelineCacheCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_PIPELINE_CACHE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCacheCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCacheCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkPipelineCacheCreateInfo-pInitialData-parameter"></a> If <code>initialDataSize</code> is not <code>0</code>, <code>pInitialData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>initialDataSize</code> bytes</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineCacheCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkPipelineCacheCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineCacheCreateFlags</code> is a bitmask type for setting a mask, but
is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Pipeline cache objects <strong class="purple">can</strong> be merged using the command:</p>
</div>
<div id="vkMergePipelineCaches" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkMergePipelineCaches(
    VkDevice                                    device,
    VkPipelineCache                             dstCache,
    uint32_t                                    srcCacheCount,
    <span class="directive">const</span> VkPipelineCache*                      pSrcCaches);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the pipeline cache objects.</p>
</li>
<li>
<p><code>dstCache</code> is the handle of the pipeline cache to merge results
into.</p>
</li>
<li>
<p><code>srcCacheCount</code> is the length of the <code>pSrcCaches</code> array.</p>
</li>
<li>
<p><code>pSrcCaches</code> is an array of pipeline cache handles, which will be
merged into <code>dstCache</code>.
The previous contents of <code>dstCache</code> are included after the merge.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The details of the merge operation are implementation dependent, but
implementations <strong class="purple">should</strong> merge the contents of the specified pipelines and
prune duplicate entries.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkMergePipelineCaches-dstCache-00770"></a>
<code>dstCache</code> <strong class="purple">must</strong> not appear in the list of source caches</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkMergePipelineCaches-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkMergePipelineCaches-dstCache-parameter"></a> <code>dstCache</code> <strong class="purple">must</strong> be a valid <code>VkPipelineCache</code> handle</p>
</li>
<li>
<p><a id="VUID-vkMergePipelineCaches-pSrcCaches-parameter"></a> <code>pSrcCaches</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>srcCacheCount</code> valid <code>VkPipelineCache</code> handles</p>
</li>
<li>
<p><a id="VUID-vkMergePipelineCaches-srcCacheCount-arraylength"></a> <code>srcCacheCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkMergePipelineCaches-dstCache-parent"></a> <code>dstCache</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
<li>
<p><a id="VUID-vkMergePipelineCaches-pSrcCaches-parent"></a> Each element of <code>pSrcCaches</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>dstCache</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Data <strong class="purple">can</strong> be retrieved from a pipeline cache object using the command:</p>
</div>
<div id="vkGetPipelineCacheData" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetPipelineCacheData(
    VkDevice                                    device,
    VkPipelineCache                             pipelineCache,
    size_t*                                     pDataSize,
    <span class="directive">void</span>*                                       pData);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the pipeline cache.</p>
</li>
<li>
<p><code>pipelineCache</code> is the pipeline cache to retrieve data from.</p>
</li>
<li>
<p><code>pDataSize</code> is a pointer to a value related to the amount of data in
the pipeline cache, as described below.</p>
</li>
<li>
<p><code>pData</code> is either <code>NULL</code> or a pointer to a buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pData</code> is <code>NULL</code>, then the maximum size of the data that <strong class="purple">can</strong> be
retrieved from the pipeline cache, in bytes, is returned in <code>pDataSize</code>.
Otherwise, <code>pDataSize</code> <strong class="purple">must</strong> point to a variable set by the user to the
size of the buffer, in bytes, pointed to by <code>pData</code>, and on return the
variable is overwritten with the amount of data actually written to
<code>pData</code>.</p>
</div>
<div class="paragraph">
<p>If <code>pDataSize</code> is less than the maximum size that <strong class="purple">can</strong> be retrieved by
the pipeline cache, at most <code>pDataSize</code> bytes will be written to
<code>pData</code>, and <code>vkGetPipelineCacheData</code> will return
<code>VK_INCOMPLETE</code>.
Any data written to <code>pData</code> is valid and <strong class="purple">can</strong> be provided as the
<code>pInitialData</code> member of the <code>VkPipelineCacheCreateInfo</code> structure
passed to <code>vkCreatePipelineCache</code>.</p>
</div>
<div class="paragraph">
<p>Two calls to <code>vkGetPipelineCacheData</code> with the same parameters <strong class="purple">must</strong>
retrieve the same data unless a command that modifies the contents of the
cache is called between them.</p>
</div>
<div id="pipelines-cache-header" class="paragraph">
<p>Applications <strong class="purple">can</strong> store the data retrieved from the pipeline cache, and use
these data, possibly in a future run of the application, to populate new
pipeline cache objects.
The results of pipeline compiles, however, <strong class="purple">may</strong> depend on the vendor ID,
device ID, driver version, and other details of the device.
To enable applications to detect when previously retrieved data is
incompatible with the device, the initial bytes written to <code>pData</code> <strong class="purple">must</strong>
be a header consisting of the following members:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 85%;">
<caption class="title">Table 7. Layout for pipeline cache header version <code>VK_PIPELINE_CACHE_HEADER_VERSION_ONE</code></caption>
<colgroup>
<col style="width: 8%;">
<col style="width: 21%;">
<col style="width: 71%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Offset</th>
<th class="tableblock halign-left valign-top">Size</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length in bytes of the entire pipeline cache header
                             written as a stream of bytes, with the least
                             significant byte first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a <a href="#VkPipelineCacheHeaderVersion">VkPipelineCacheHeaderVersion</a> value
                             written as a stream of bytes, with the least
                             significant byte first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a vendor ID equal to
                             <code>VkPhysicalDeviceProperties</code>::<code>vendorID</code>
                             written as a stream of bytes, with the least
                             significant byte first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a device ID equal to
                             <code>VkPhysicalDeviceProperties</code>::<code>deviceID</code>
                             written as a stream of bytes, with the least
                             significant byte first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_UUID_SIZE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a pipeline cache ID equal to
                             <code>VkPhysicalDeviceProperties</code>::<code>pipelineCacheUUID</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The first four bytes encode the length of the entire pipeline cache header,
in bytes.
This value includes all fields in the header including the pipeline cache
version field and the size of the length field.</p>
</div>
<div class="paragraph">
<p>The next four bytes encode the pipeline cache version, as described for
<a href="#VkPipelineCacheHeaderVersion">VkPipelineCacheHeaderVersion</a>.
A consumer of the pipeline cache <strong class="purple">should</strong> use the cache version to interpret
the remainder of the cache header.</p>
</div>
<div class="paragraph">
<p>If <code>pDataSize</code> is less than what is necessary to store this header,
nothing will be written to <code>pData</code> and zero will be written to
<code>pDataSize</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPipelineCacheData-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPipelineCacheData-pipelineCache-parameter"></a> <code>pipelineCache</code> <strong class="purple">must</strong> be a valid <code>VkPipelineCache</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPipelineCacheData-pDataSize-parameter"></a> <code>pDataSize</code> <strong class="purple">must</strong> be a valid pointer to a <code>size_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetPipelineCacheData-pData-parameter"></a> If the value referenced by <code>pDataSize</code> is not <code>0</code>, and <code>pData</code> is not <code>NULL</code>, <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pDataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkGetPipelineCacheData-pipelineCache-parent"></a> <code>pipelineCache</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of the second group of four bytes in the header returned by
<a href="#vkGetPipelineCacheData">vkGetPipelineCacheData</a>, encoding the pipeline cache version, are:</p>
</div>
<div id="VkPipelineCacheHeaderVersion" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkPipelineCacheHeaderVersion {
    VK_PIPELINE_CACHE_HEADER_VERSION_ONE = <span class="integer">1</span>,
} VkPipelineCacheHeaderVersion;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_CACHE_HEADER_VERSION_ONE</code> specifies version one of the
pipeline cache.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a pipeline cache, call:</p>
</div>
<div id="vkDestroyPipelineCache" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyPipelineCache(
    VkDevice                                    device,
    VkPipelineCache                             pipelineCache,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the pipeline cache
object.</p>
</li>
<li>
<p><code>pipelineCache</code> is the handle of the pipeline cache to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyPipelineCache-pipelineCache-00771"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>pipelineCache</code>
was created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipelineCache-pipelineCache-00772"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>pipelineCache</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyPipelineCache-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipelineCache-pipelineCache-parameter"></a> If <code>pipelineCache</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>pipelineCache</code> <strong class="purple">must</strong> be a valid <code>VkPipelineCache</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipelineCache-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyPipelineCache-pipelineCache-parent"></a> If <code>pipelineCache</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>pipelineCache</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-specialization-constants">9.7. Specialization Constants</h3>
<div class="paragraph">
<p>Specialization constants are a mechanism whereby constants in a SPIR-V
module <strong class="purple">can</strong> have their constant value specified at the time the
<code>VkPipeline</code> is created.
This allows a SPIR-V module to have constants that <strong class="purple">can</strong> be modified while
executing an application that uses the Vulkan API.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Specialization constants are useful to allow a compute shader to have its
local workgroup size changed at runtime by the user, for example.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each instance of the <code>VkPipelineShaderStageCreateInfo</code> structure
contains a parameter <code>pSpecializationInfo</code>, which <strong class="purple">can</strong> be <code>NULL</code> to
indicate no specialization constants, or point to a
<code>VkSpecializationInfo</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSpecializationInfo</code> structure is defined as:</p>
</div>
<div id="VkSpecializationInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkSpecializationInfo {
    uint32_t                           mapEntryCount;
    <span class="directive">const</span> VkSpecializationMapEntry*    pMapEntries;
    size_t                             dataSize;
    <span class="directive">const</span> <span class="directive">void</span>*                        pData;
} VkSpecializationInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mapEntryCount</code> is the number of entries in the <code>pMapEntries</code>
array.</p>
</li>
<li>
<p><code>pMapEntries</code> is a pointer to an array of
<code>VkSpecializationMapEntry</code> which maps constant IDs to offsets in
<code>pData</code>.</p>
</li>
<li>
<p><code>dataSize</code> is the byte size of the <code>pData</code> buffer.</p>
</li>
<li>
<p><code>pData</code> contains the actual constant values to specialize with.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pMapEntries</code> points to a structure of type
<a href="#VkSpecializationMapEntry">VkSpecializationMapEntry</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSpecializationInfo-offset-00773"></a>
The <code>offset</code> member of each element of <code>pMapEntries</code> <strong class="purple">must</strong> be
less than <code>dataSize</code></p>
</li>
<li>
<p><a id="VUID-VkSpecializationInfo-pMapEntries-00774"></a>
The <code>size</code> member of each element of <code>pMapEntries</code> <strong class="purple">must</strong> be less
than or equal to <code>dataSize</code> minus <code>offset</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSpecializationInfo-pMapEntries-parameter"></a> If <code>mapEntryCount</code> is not <code>0</code>, <code>pMapEntries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>mapEntryCount</code> valid <code>VkSpecializationMapEntry</code> structures</p>
</li>
<li>
<p><a id="VUID-VkSpecializationInfo-pData-parameter"></a> If <code>dataSize</code> is not <code>0</code>, <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSpecializationMapEntry</code> structure is defined as:</p>
</div>
<div id="VkSpecializationMapEntry" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkSpecializationMapEntry {
    uint32_t    constantID;
    uint32_t    offset;
    size_t      size;
} VkSpecializationMapEntry;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>constantID</code> is the ID of the specialization constant in SPIR-V.</p>
</li>
<li>
<p><code>offset</code> is the byte offset of the specialization constant value
within the supplied data buffer.</p>
</li>
<li>
<p><code>size</code> is the byte size of the specialization constant value within
the supplied data buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a <code>constantID</code> value is not a specialization constant ID used in the
shader, that map entry does not affect the behavior of the pipeline.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSpecializationMapEntry-constantID-00776"></a>
For a <code>constantID</code> specialization constant declared in a shader,
<code>size</code> <strong class="purple">must</strong> match the byte size of the <code>constantID</code>.
If the specialization constant is of type <code>boolean</code>, <code>size</code> <strong class="purple">must</strong>
be the byte size of <code>VkBool32</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In human readable SPIR-V:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="glsl">OpDecorate %x SpecId 13 ; decorate .x component of WorkgroupSize with ID 13
OpDecorate %y SpecId 42 ; decorate .y component of WorkgroupSize with ID 42
OpDecorate %z SpecId 3  ; decorate .z component of WorkgroupSize with ID 3
OpDecorate %wgsize BuiltIn WorkgroupSize ; decorate WorkgroupSize onto constant
%i32 = OpTypeInt 32 0 ; declare an unsigned 32-bit type
%uvec3 = OpTypeVector %i32 3 ; declare a 3 element vector type of unsigned 32-bit
%x = OpSpecConstant %i32 1 ; declare the .x component of WorkgroupSize
%y = OpSpecConstant %i32 1 ; declare the .y component of WorkgroupSize
%z = OpSpecConstant %i32 1 ; declare the .z component of WorkgroupSize
%wgsize = OpSpecConstantComposite %uvec3 %x %y %z ; declare WorkgroupSize</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the above we have three specialization constants, one for each of the
x, y &amp; z elements of the WorkgroupSize vector.</p>
</div>
<div class="paragraph">
<p>Now to specialize the above via the specialization constants mechanism:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">const</span> VkSpecializationMapEntry entries[] =
{
    {
        <span class="integer">13</span>,                             <span class="comment">// constantID</span>
        <span class="integer">0</span> * <span class="keyword">sizeof</span>(uint32_t),           <span class="comment">// offset</span>
        <span class="keyword">sizeof</span>(uint32_t)                <span class="comment">// size</span>
    },
    {
        <span class="integer">42</span>,                             <span class="comment">// constantID</span>
        <span class="integer">1</span> * <span class="keyword">sizeof</span>(uint32_t),           <span class="comment">// offset</span>
        <span class="keyword">sizeof</span>(uint32_t)                <span class="comment">// size</span>
    },
    {
        <span class="integer">3</span>,                              <span class="comment">// constantID</span>
        <span class="integer">2</span> * <span class="keyword">sizeof</span>(uint32_t),           <span class="comment">// offset</span>
        <span class="keyword">sizeof</span>(uint32_t)                <span class="comment">// size</span>
    }
};

<span class="directive">const</span> uint32_t data[] = { <span class="integer">16</span>, <span class="integer">8</span>, <span class="integer">4</span> }; <span class="comment">// our workgroup size is 16x8x4</span>

<span class="directive">const</span> VkSpecializationInfo info =
{
    <span class="integer">3</span>,                                  <span class="comment">// mapEntryCount</span>
    entries,                            <span class="comment">// pMapEntries</span>
    <span class="integer">3</span> * <span class="keyword">sizeof</span>(uint32_t),               <span class="comment">// dataSize</span>
    data,                               <span class="comment">// pData</span>
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then when calling <a href="#vkCreateComputePipelines">vkCreateComputePipelines</a>, and passing the
<code>VkSpecializationInfo</code> we defined as the <code>pSpecializationInfo</code>
parameter of <a href="#VkPipelineShaderStageCreateInfo">VkPipelineShaderStageCreateInfo</a>, we will create a compute
pipeline with the runtime specified local workgroup size.</p>
</div>
<div class="paragraph">
<p>Another example would be that an application has a SPIR-V module that has
some platform-dependent constants they wish to use.</p>
</div>
<div class="paragraph">
<p>In human readable SPIR-V:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="glsl">OpDecorate %1 SpecId 0  ; decorate our signed 32-bit integer constant
OpDecorate %2 SpecId 12 ; decorate our 32-bit floating-point constant
%i32 = OpTypeInt 32 1   ; declare a signed 32-bit type
%float = OpTypeFloat 32 ; declare a 32-bit floating-point type
%1 = OpSpecConstant %i32 -1 ; some signed 32-bit integer constant
%2 = OpSpecConstant %float 0.5 ; some 32-bit floating-point constant</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the above we have two specialization constants, one is a signed 32-bit
integer and the second is a 32-bit floating-point.</p>
</div>
<div class="paragraph">
<p>Now to specialize the above via the specialization constants mechanism:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">struct</span> SpecializationData {
    int32_t data0;
    <span class="predefined-type">float</span> data1;
};

<span class="directive">const</span> VkSpecializationMapEntry entries[] =
{
    {
        <span class="integer">0</span>,                                    <span class="comment">// constantID</span>
        offsetof(SpecializationData, data0),  <span class="comment">// offset</span>
        <span class="keyword">sizeof</span>(SpecializationData::data0)     <span class="comment">// size</span>
    },
    {
        <span class="integer">12</span>,                                   <span class="comment">// constantID</span>
        offsetof(SpecializationData, data1),  <span class="comment">// offset</span>
        <span class="keyword">sizeof</span>(SpecializationData::data1)     <span class="comment">// size</span>
    }
};

SpecializationData data;
data.data0 = -<span class="integer">42</span>;    <span class="comment">// set the data for the 32-bit integer</span>
data.data1 = <span class="integer">4</span><span class="float">2</span><span class="float">.0f</span>;  <span class="comment">// set the data for the 32-bit floating-point</span>

<span class="directive">const</span> VkSpecializationInfo info =
{
    <span class="integer">2</span>,                                  <span class="comment">// mapEntryCount</span>
    entries,                            <span class="comment">// pMapEntries</span>
    <span class="keyword">sizeof</span>(data),                       <span class="comment">// dataSize</span>
    &amp;data,                              <span class="comment">// pData</span>
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is legal for a SPIR-V module with specializations to be compiled into a
pipeline where no specialization info was provided.
SPIR-V specialization constants contain default values such that if a
specialization is not provided, the default value will be used.
In the examples above, it would be valid for an application to only
specialize some of the specialization constants within the SPIR-V module,
and let the other constants use their default values encoded within the
OpSpecConstant declarations.</p>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-binding">9.8. Pipeline Binding</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Once a pipeline has been created, it <strong class="purple">can</strong> be bound to the command buffer
using the command:</p>
</div>
<div id="vkCmdBindPipeline" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkCmdBindPipeline(
    VkCommandBuffer                             commandBuffer,
    VkPipelineBindPoint                         pipelineBindPoint,
    VkPipeline                                  pipeline);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer that the pipeline will be
bound to.</p>
</li>
<li>
<p><code>pipelineBindPoint</code> is a <a href="#VkPipelineBindPoint">VkPipelineBindPoint</a> value specifying
whether to bind to the compute or graphics bind point.
Binding one does not disturb the other.</p>
</li>
<li>
<p><code>pipeline</code> is the pipeline to be bound.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once bound, a pipeline binding affects subsequent graphics or compute
commands in the command buffer until a different pipeline is bound to the
bind point.
The pipeline bound to <code>VK_PIPELINE_BIND_POINT_COMPUTE</code> controls the
behavior of <a href="#vkCmdDispatch">vkCmdDispatch</a> and <a href="#vkCmdDispatchIndirect">vkCmdDispatchIndirect</a>.
The pipeline bound to <code>VK_PIPELINE_BIND_POINT_GRAPHICS</code> controls the
behavior of all <a href="#drawing">drawing commands</a>.
No other commands are affected by the pipeline state.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipelineBindPoint-00777"></a>
If <code>pipelineBindPoint</code> is <code>VK_PIPELINE_BIND_POINT_COMPUTE</code>, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong>
support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipelineBindPoint-00778"></a>
If <code>pipelineBindPoint</code> is <code>VK_PIPELINE_BIND_POINT_GRAPHICS</code>, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipelineBindPoint-00779"></a>
If <code>pipelineBindPoint</code> is <code>VK_PIPELINE_BIND_POINT_COMPUTE</code>,
<code>pipeline</code> <strong class="purple">must</strong> be a compute pipeline</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipelineBindPoint-00780"></a>
If <code>pipelineBindPoint</code> is <code>VK_PIPELINE_BIND_POINT_GRAPHICS</code>,
<code>pipeline</code> <strong class="purple">must</strong> be a graphics pipeline</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipeline-00781"></a>
If the <a href="#features-features-variableMultisampleRate">variable multisample
rate</a> feature is not supported, <code>pipeline</code> is a graphics pipeline,
the current subpass has no attachments, and this is not the first call
to this function with a graphics pipeline after transitioning to the
current subpass, then the sample count specified by this pipeline <strong class="purple">must</strong>
match that set in the previous pipeline</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBindPipeline-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <code>VkCommandBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipelineBindPoint-parameter"></a> <code>pipelineBindPoint</code> <strong class="purple">must</strong> be a valid <a href="#VkPipelineBindPoint">VkPipelineBindPoint</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-pipeline-parameter"></a> <code>pipeline</code> <strong class="purple">must</strong> be a valid <code>VkPipeline</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBindPipeline-commonparent"></a> Both of <code>commandBuffer</code>, and <code>pipeline</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#vkCmdBindPipeline">vkCmdBindPipeline</a>::<code>pipelineBindPoint</code>,
specifying the bind point of a pipeline object, are:</p>
</div>
<div id="VkPipelineBindPoint" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkPipelineBindPoint {
    VK_PIPELINE_BIND_POINT_GRAPHICS = <span class="integer">0</span>,
    VK_PIPELINE_BIND_POINT_COMPUTE = <span class="integer">1</span>,
} VkPipelineBindPoint;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_BIND_POINT_COMPUTE</code> specifies binding as a compute
pipeline.</p>
</li>
<li>
<p><code>VK_PIPELINE_BIND_POINT_GRAPHICS</code> specifies binding as a graphics
pipeline.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipelines-dynamic-state">9.9. Dynamic State</h3>
<div class="paragraph">
<p>When a pipeline object is bound, any pipeline object state that is not
specified as dynamic is applied to the command buffer state.
Pipeline object state that is specified as dynamic is not applied to the
command buffer state at this time.
Instead, dynamic state <strong class="purple">can</strong> be modified at any time and persists for the
lifetime of the command buffer, or until modified by another dynamic state
setting command or another pipeline bind.</p>
</div>
<div class="paragraph">
<p>When a pipeline object is bound, the following applies to each state
parameter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the state is not specified as dynamic in the new pipeline object,
then that command buffer state is overwritten by the state in the new
pipeline object.</p>
</li>
<li>
<p>If the state is specified as dynamic in both the new and the previous
pipeline object, then that command buffer state is not disturbed.</p>
</li>
<li>
<p>If the state is specified as dynamic in the new pipeline object but is
not specified as dynamic in the previous pipeline object, then that
command buffer state becomes undefined.
If the state is an array, then the entire array becomes undefined.</p>
</li>
<li>
<p>If the state is an array specified as dynamic in both the new and the
previous pipeline object, and the array size is not the same in both
pipeline objects, then that command buffer state becomes undefined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Dynamic state setting commands <strong class="purple">must</strong> not be issued for state that is not
specified as dynamic in the bound pipeline object.</p>
</div>
<div class="paragraph">
<p>Dynamic state that does not affect the result of operations <strong class="purple">can</strong> be left
undefined.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For example, if blending is disabled by the pipeline object state then the
dynamic color blend constants do not need to be specified in the command
buffer, even if this state is specified as dynamic in the pipeline object.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="memory">10. Memory Allocation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vulkan memory is broken up into two categories, <em>host memory</em> and <em>device
memory</em>.</p>
</div>
<div class="sect2">
<h3 id="memory-host">10.1. Host Memory</h3>
<div class="paragraph">
<p>Host memory is memory needed by the Vulkan implementation for
non-device-visible storage.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This memory <strong class="purple">may</strong> be used to store the implementation&#8217;s representation and
state of Vulkan objects.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="memory-allocation" class="paragraph">
<p>Vulkan provides applications the opportunity to perform host memory
allocations on behalf of the Vulkan implementation.
If this feature is not used, the implementation will perform its own memory
allocations.
Since most memory allocations are off the critical path, this is not meant
as a performance feature.
Rather, this <strong class="purple">can</strong> be useful for certain embedded systems, for debugging
purposes (e.g. putting a guard page after all host allocations), or for
memory allocation logging.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Allocators are provided by the application as a pointer to a
<code>VkAllocationCallbacks</code> structure:</p>
</div>
<div id="VkAllocationCallbacks" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkAllocationCallbacks {
    <span class="directive">void</span>*                                   pUserData;
    PFN_vkAllocationFunction                pfnAllocation;
    PFN_vkReallocationFunction              pfnReallocation;
    PFN_vkFreeFunction                      pfnFree;
    PFN_vkInternalAllocationNotification    pfnInternalAllocation;
    PFN_vkInternalFreeNotification          pfnInternalFree;
} VkAllocationCallbacks;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is a value to be interpreted by the implementation of
the callbacks.
When any of the callbacks in <code>VkAllocationCallbacks</code> are called, the
Vulkan implementation will pass this value as the first parameter to the
callback.
This value <strong class="purple">can</strong> vary each time an allocator is passed into a command,
even when the same object takes an allocator in multiple commands.</p>
</li>
<li>
<p><code>pfnAllocation</code> is a pointer to an application-defined memory
allocation function of type <a href="#PFN_vkAllocationFunction">PFN_vkAllocationFunction</a>.</p>
</li>
<li>
<p><code>pfnReallocation</code> is a pointer to an application-defined memory
reallocation function of type <a href="#PFN_vkReallocationFunction">PFN_vkReallocationFunction</a>.</p>
</li>
<li>
<p><code>pfnFree</code> is a pointer to an application-defined memory free
function of type <a href="#PFN_vkFreeFunction">PFN_vkFreeFunction</a>.</p>
</li>
<li>
<p><code>pfnInternalAllocation</code> is a pointer to an application-defined
function that is called by the implementation when the implementation
makes internal allocations, and it is of type
<a href="#PFN_vkInternalAllocationNotification">PFN_vkInternalAllocationNotification</a>.</p>
</li>
<li>
<p><code>pfnInternalFree</code> is a pointer to an application-defined function
that is called by the implementation when the implementation frees
internal allocations, and it is of type
<a href="#PFN_vkInternalFreeNotification">PFN_vkInternalFreeNotification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnAllocation-00632"></a>
<code>pfnAllocation</code> <strong class="purple">must</strong> be a valid pointer to a valid user-defined
<a href="#PFN_vkAllocationFunction">PFN_vkAllocationFunction</a></p>
</li>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnReallocation-00633"></a>
<code>pfnReallocation</code> <strong class="purple">must</strong> be a valid pointer to a valid user-defined
<a href="#PFN_vkReallocationFunction">PFN_vkReallocationFunction</a></p>
</li>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnFree-00634"></a>
<code>pfnFree</code> <strong class="purple">must</strong> be a valid pointer to a valid user-defined
<a href="#PFN_vkFreeFunction">PFN_vkFreeFunction</a></p>
</li>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnInternalAllocation-00635"></a>
If either of <code>pfnInternalAllocation</code> or <code>pfnInternalFree</code> is not
<code>NULL</code>, both <strong class="purple">must</strong> be valid callbacks</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnAllocation</code> is:</p>
</div>
<div id="PFN_vkAllocationFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span>* (VKAPI_PTR *PFN_vkAllocationFunction)(
    <span class="directive">void</span>*                                       pUserData,
    size_t                                      size,
    size_t                                      alignment,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>size</code> is the size in bytes of the requested allocation.</p>
</li>
<li>
<p><code>alignment</code> is the requested alignment of the allocation in bytes
and <strong class="purple">must</strong> be a power of two.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
<div id="vkAllocationFunction_return_rules" class="paragraph">
<p>If <code>pfnAllocation</code> is unable to allocate the requested memory, it <strong class="purple">must</strong>
return <code>NULL</code>.
If the allocation was successful, it <strong class="purple">must</strong> return a valid pointer to memory
allocation containing at least <code>size</code> bytes, and with the pointer value
being a multiple of <code>alignment</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Correct Vulkan operation <strong class="purple">cannot</strong> be assumed if the application does not
follow these rules.</p>
</div>
<div class="paragraph">
<p>For example, <code>pfnAllocation</code> (or <code>pfnReallocation</code>) could cause
termination of running Vulkan instance(s) on a failed allocation for
debugging purposes, either directly or indirectly.
In these circumstances, it <strong class="purple">cannot</strong> be assumed that any part of any affected
<a href="#VkInstance">VkInstance</a> objects are going to operate correctly (even
<a href="#vkDestroyInstance">vkDestroyInstance</a>), and the application <strong class="purple">must</strong> ensure it cleans up
properly via other means (e.g. process termination).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>pfnAllocation</code> returns <code>NULL</code>, and if the implementation is unable
to continue correct processing of the current command without the requested
allocation, it <strong class="purple">must</strong> treat this as a run-time error, and generate
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> at the appropriate time for the command in
which the condition was detected, as described in <a href="#fundamentals-errorcodes">Return Codes</a>.</p>
</div>
<div class="paragraph">
<p>If the implementation is able to continue correct processing of the current
command without the requested allocation, then it <strong class="purple">may</strong> do so, and <strong class="purple">must</strong> not
generate <code>VK_ERROR_OUT_OF_HOST_MEMORY</code> as a result of this failed
allocation.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnReallocation</code> is:</p>
</div>
<div id="PFN_vkReallocationFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span>* (VKAPI_PTR *PFN_vkReallocationFunction)(
    <span class="directive">void</span>*                                       pUserData,
    <span class="directive">void</span>*                                       pOriginal,
    size_t                                      size,
    size_t                                      alignment,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>pOriginal</code> <strong class="purple">must</strong> be either <code>NULL</code> or a pointer previously returned
by <code>pfnReallocation</code> or <code>pfnAllocation</code> of the same allocator.</p>
</li>
<li>
<p><code>size</code> is the size in bytes of the requested allocation.</p>
</li>
<li>
<p><code>alignment</code> is the requested alignment of the allocation in bytes
and <strong class="purple">must</strong> be a power of two.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pfnReallocation</code> <strong class="purple">must</strong> return an allocation with enough space for
<code>size</code> bytes, and the contents of the original allocation from bytes
zero to <span class="eq">min(original size, new size) - 1</span> <strong class="purple">must</strong> be preserved in the
returned allocation.
If <code>size</code> is larger than the old size, the contents of the additional
space are undefined.
If satisfying these requirements involves creating a new allocation, then
the old allocation <strong class="purple">should</strong> be freed.</p>
</div>
<div class="paragraph">
<p>If <code>pOriginal</code> is <code>NULL</code>, then <code>pfnReallocation</code> <strong class="purple">must</strong> behave
equivalently to a call to <a href="#PFN_vkAllocationFunction">PFN_vkAllocationFunction</a> with the same
parameter values (without <code>pOriginal</code>).</p>
</div>
<div class="paragraph">
<p>If <code>size</code> is zero, then <code>pfnReallocation</code> <strong class="purple">must</strong> behave equivalently
to a call to <a href="#PFN_vkFreeFunction">PFN_vkFreeFunction</a> with the same <code>pUserData</code>
parameter value, and <code>pMemory</code> equal to <code>pOriginal</code>.</p>
</div>
<div class="paragraph">
<p>If <code>pOriginal</code> is non-<code>NULL</code>, the implementation <strong class="purple">must</strong> ensure that
<code>alignment</code> is equal to the <code>alignment</code> used to originally allocate
<code>pOriginal</code>.</p>
</div>
<div class="paragraph">
<p>If this function fails and <code>pOriginal</code> is non-<code>NULL</code> the application
<strong class="purple">must</strong> not free the old allocation.</p>
</div>
<div class="paragraph">
<p><code>pfnReallocation</code> <strong class="purple">must</strong> follow the same
<a href="#vkAllocationFunction_return_rules">rules for return values as
<code>PFN_vkAllocationFunction</code></a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnFree</code> is:</p>
</div>
<div id="PFN_vkFreeFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkFreeFunction)(
    <span class="directive">void</span>*                                       pUserData,
    <span class="directive">void</span>*                                       pMemory);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>pMemory</code> is the allocation to be freed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pMemory</code> <strong class="purple">may</strong> be <code>NULL</code>, which the callback <strong class="purple">must</strong> handle safely.
If <code>pMemory</code> is non-<code>NULL</code>, it <strong class="purple">must</strong> be a pointer previously allocated
by <code>pfnAllocation</code> or <code>pfnReallocation</code>.
The application <strong class="purple">should</strong> free this memory.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnInternalAllocation</code> is:</p>
</div>
<div id="PFN_vkInternalAllocationNotification" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkInternalAllocationNotification)(
    <span class="directive">void</span>*                                       pUserData,
    size_t                                      size,
    VkInternalAllocationType                    allocationType,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>size</code> is the requested size of an allocation.</p>
</li>
<li>
<p><code>allocationType</code> is a <a href="#VkInternalAllocationType">VkInternalAllocationType</a> value
specifying the requested type of an allocation.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is a purely informational callback.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnInternalFree</code> is:</p>
</div>
<div id="PFN_vkInternalFreeNotification" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkInternalFreeNotification)(
    <span class="directive">void</span>*                                       pUserData,
    size_t                                      size,
    VkInternalAllocationType                    allocationType,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>size</code> is the requested size of an allocation.</p>
</li>
<li>
<p><code>allocationType</code> is a <a href="#VkInternalAllocationType">VkInternalAllocationType</a> value
specifying the requested type of an allocation.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="memory-host-allocation-scope" class="paragraph">
<p>Each allocation has an <em>allocation scope</em> which defines its lifetime and
which object it is associated with.
Possible values passed to the <code>allocationScope</code> parameter of the
callback functions specified by <a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>, indicating the
allocation scope, are:</p>
</div>
<div id="VkSystemAllocationScope" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkSystemAllocationScope {
    VK_SYSTEM_ALLOCATION_SCOPE_COMMAND = <span class="integer">0</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_OBJECT = <span class="integer">1</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_CACHE = <span class="integer">2</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_DEVICE = <span class="integer">3</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_INSTANCE = <span class="integer">4</span>,
} VkSystemAllocationScope;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_COMMAND</code> specifies that the allocation
is scoped to the duration of the Vulkan command.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_OBJECT</code> specifies that the allocation is
scoped to the lifetime of the Vulkan object that is being created or
used.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_CACHE</code> specifies that the allocation is
scoped to the lifetime of a <code>VkPipelineCache</code>
object.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_DEVICE</code> specifies that the allocation is
scoped to the lifetime of the Vulkan device.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_INSTANCE</code> specifies that the allocation
is scoped to the lifetime of the Vulkan instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most Vulkan commands operate on a single object, or there is a sole object
that is being created or manipulated.
When an allocation uses an allocation scope of
<code>VK_SYSTEM_ALLOCATION_SCOPE_OBJECT</code> or
<code>VK_SYSTEM_ALLOCATION_SCOPE_CACHE</code>, the allocation is scoped to the
object being created or manipulated.</p>
</div>
<div class="paragraph">
<p>When an implementation requires host memory, it will make callbacks to the
application using the most specific allocator and allocation scope
available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an allocation is scoped to the duration of a command, the allocator
will use the <code>VK_SYSTEM_ALLOCATION_SCOPE_COMMAND</code> allocation scope.
The most specific allocator available is used: if the object being
created or manipulated has an allocator, that object&#8217;s allocator will be
used, else if the parent <code>VkDevice</code> has an allocator it will be
used, else if the parent <code>VkInstance</code> has an allocator it will be
used.
Else,</p>
</li>
<li>
<p>If an allocation is associated with an object of type
<code>VkPipelineCache</code>, the allocator will use the
<code>VK_SYSTEM_ALLOCATION_SCOPE_CACHE</code> allocation scope.
The most specific allocator available is used (cache, else device, else
instance).
Else,</p>
</li>
<li>
<p>If an allocation is scoped to the lifetime of an object, that object is
being created or manipulated by the command, and that object&#8217;s type is
not <code>VkDevice</code> or <code>VkInstance</code>, the allocator will use an
allocation scope of <code>VK_SYSTEM_ALLOCATION_SCOPE_OBJECT</code>.
The most specific allocator available is used (object, else device, else
instance).
Else,</p>
</li>
<li>
<p>If an allocation is scoped to the lifetime of a device, the allocator
will use an allocation scope of <code>VK_SYSTEM_ALLOCATION_SCOPE_DEVICE</code>.
The most specific allocator available is used (device, else instance).
Else,</p>
</li>
<li>
<p>If the allocation is scoped to the lifetime of an instance and the
instance has an allocator, its allocator will be used with an allocation
scope of <code>VK_SYSTEM_ALLOCATION_SCOPE_INSTANCE</code>.</p>
</li>
<li>
<p>Otherwise an implementation will allocate memory through an alternative
mechanism that is unspecified.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Objects that are allocated from pools do not specify their own allocator.
When an implementation requires host memory for such an object, that memory
is sourced from the object&#8217;s parent pool&#8217;s allocator.</p>
</div>
<div class="paragraph">
<p>The application is not expected to handle allocating memory that is intended
for execution by the host due to the complexities of differing security
implementations across multiple platforms.
The implementation will allocate such memory internally and invoke an
application provided informational callback when these <em>internal
allocations</em> are allocated and freed.
Upon allocation of executable memory, <code>pfnInternalAllocation</code> will be
called.
Upon freeing executable memory, <code>pfnInternalFree</code> will be called.
An implementation will only call an informational callback for executable
memory allocations and frees.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>allocationType</code> parameter to the <code>pfnInternalAllocation</code> and
<code>pfnInternalFree</code> functions <strong class="purple">may</strong> be one of the following values:</p>
</div>
<div id="VkInternalAllocationType" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkInternalAllocationType {
    VK_INTERNAL_ALLOCATION_TYPE_EXECUTABLE = <span class="integer">0</span>,
} VkInternalAllocationType;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_INTERNAL_ALLOCATION_TYPE_EXECUTABLE</code> specifies that the
allocation is intended for execution by the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>An implementation <strong class="purple">must</strong> only make calls into an application-provided
allocator during the execution of an API command.
An implementation <strong class="purple">must</strong> only make calls into an application-provided
allocator from the same thread that called the provoking API command.
The implementation <strong class="purple">should</strong> not synchronize calls to any of the callbacks.
If synchronization is needed, the callbacks <strong class="purple">must</strong> provide it themselves.
The informational callbacks are subject to the same restrictions as the
allocation callbacks.</p>
</div>
<div class="paragraph">
<p>If an implementation intends to make calls through a
<code>VkAllocationCallbacks</code> structure between the time a <code>vkCreate*</code>
command returns and the time a corresponding <code>vkDestroy*</code> command
begins, that implementation <strong class="purple">must</strong> save a copy of the allocator before the
<code>vkCreate*</code> command returns.
The callback functions and any data structures they rely upon <strong class="purple">must</strong> remain
valid for the lifetime of the object they are associated with.</p>
</div>
<div class="paragraph">
<p>If an allocator is provided to a <code>vkCreate*</code> command, a <em>compatible</em>
allocator <strong class="purple">must</strong> be provided to the corresponding <code>vkDestroy*</code> command.
Two <code>VkAllocationCallbacks</code> structures are compatible if memory
allocated with <code>pfnAllocation</code> or <code>pfnReallocation</code> in each <strong class="purple">can</strong> be
freed with <code>pfnReallocation</code> or <code>pfnFree</code> in the other.
An allocator <strong class="purple">must</strong> not be provided to a <code>vkDestroy*</code> command if an
allocator was not provided to the corresponding <code>vkCreate*</code> command.</p>
</div>
<div class="paragraph">
<p>If a non-<code>NULL</code> allocator is used, the <code>pfnAllocation</code>,
<code>pfnReallocation</code> and <code>pfnFree</code> members <strong class="purple">must</strong> be non-<code>NULL</code> and
point to valid implementations of the callbacks.
An application <strong class="purple">can</strong> choose to not provide informational callbacks by setting
both <code>pfnInternalAllocation</code> and <code>pfnInternalFree</code> to <code>NULL</code>.
<code>pfnInternalAllocation</code> and <code>pfnInternalFree</code> <strong class="purple">must</strong> either both be
<code>NULL</code> or both be non-<code>NULL</code>.</p>
</div>
<div class="paragraph">
<p>If <code>pfnAllocation</code> or <code>pfnReallocation</code> fail, the implementation
<strong class="purple">may</strong> fail object creation and/or generate an
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> error, as appropriate.</p>
</div>
<div class="paragraph">
<p>Allocation callbacks <strong class="purple">must</strong> not call any Vulkan commands.</p>
</div>
<div class="paragraph">
<p>The following sets of rules define when an implementation is permitted to
call the allocator callbacks.</p>
</div>
<div class="paragraph">
<p><code>pfnAllocation</code> or <code>pfnReallocation</code> <strong class="purple">may</strong> be called in the following
situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allocations scoped to a <code>VkDevice</code> or <code>VkInstance</code> <strong class="purple">may</strong> be
allocated from any API command.</p>
</li>
<li>
<p>Allocations scoped to a command <strong class="purple">may</strong> be allocated from any API command.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkPipelineCache</code> <strong class="purple">may</strong> only be allocated
from:</p>
<div class="ulist">
<ul>
<li>
<p><code>vkCreatePipelineCache</code></p>
</li>
<li>
<p><code>vkMergePipelineCaches</code> for <code>dstCache</code></p>
</li>
<li>
<p><code>vkCreateGraphicsPipelines</code> for <code>pipelineCache</code></p>
</li>
<li>
<p><code>vkCreateComputePipelines</code> for <code>pipelineCache</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkDescriptorPool</code> <strong class="purple">may</strong> only be allocated
from:</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
<li>
<p><code>vkAllocateDescriptorSets</code> for the <code>descriptorPool</code> member of
its <code>pAllocateInfo</code> parameter</p>
</li>
<li>
<p><code>vkCreateDescriptorPool</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkCommandPool</code> <strong class="purple">may</strong> only be allocated from:</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
<li>
<p><code>vkCreateCommandPool</code></p>
</li>
<li>
<p><code>vkAllocateCommandBuffers</code> for the <code>commandPool</code> member of its
<code>pAllocateInfo</code> parameter</p>
</li>
<li>
<p>any <code>vkCmd*</code> command whose <code>commandBuffer</code> was allocated from
that <code>VkCommandPool</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to any other object <strong class="purple">may</strong> only be allocated in that
object&#8217;s <code>vkCreate*</code> command.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pfnFree</code> <strong class="purple">may</strong> be called in the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allocations scoped to a <code>VkDevice</code> or <code>VkInstance</code> <strong class="purple">may</strong> be freed
from any API command.</p>
</li>
<li>
<p>Allocations scoped to a command <strong class="purple">must</strong> be freed by any API command which
allocates such memory.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkPipelineCache</code> <strong class="purple">may</strong> be freed from
<code>vkDestroyPipelineCache</code>.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkDescriptorPool</code> <strong class="purple">may</strong> be freed from</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkCommandPool</code> <strong class="purple">may</strong> be freed from:</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
<li>
<p><code>vkResetCommandBuffer</code> whose <code>commandBuffer</code> was allocated from
that <code>VkCommandPool</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to any other object <strong class="purple">may</strong> be freed in that object&#8217;s
<code>vkDestroy*</code> command.</p>
</li>
<li>
<p>Any command that allocates host memory <strong class="purple">may</strong> also free host memory of the
same scope.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="memory-device">10.2. Device Memory</h3>
<div class="paragraph">
<p><em>Device memory</em> is memory that is visible to the device&#8201;&#8212;&#8201;for example the
contents of the image or buffer objects, which <strong class="purple">can</strong> be natively used by the
device.</p>
</div>
<div class="paragraph">
<p>Memory properties of a physical device describe the memory heaps and memory
types available.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query memory properties, call:</p>
</div>
<div id="vkGetPhysicalDeviceMemoryProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetPhysicalDeviceMemoryProperties(
    VkPhysicalDevice                            physicalDevice,
    VkPhysicalDeviceMemoryProperties*           pMemoryProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the device to query.</p>
</li>
<li>
<p><code>pMemoryProperties</code> points to an instance of
<code>VkPhysicalDeviceMemoryProperties</code> structure in which the properties
are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceMemoryProperties-physicalDevice-parameter"></a> <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <code>VkPhysicalDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceMemoryProperties-pMemoryProperties-parameter"></a> <code>pMemoryProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkPhysicalDeviceMemoryProperties</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceMemoryProperties</code> structure is defined as:</p>
</div>
<div id="VkPhysicalDeviceMemoryProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPhysicalDeviceMemoryProperties {
    uint32_t        memoryTypeCount;
    VkMemoryType    memoryTypes[VK_MAX_MEMORY_TYPES];
    uint32_t        memoryHeapCount;
    VkMemoryHeap    memoryHeaps[VK_MAX_MEMORY_HEAPS];
} VkPhysicalDeviceMemoryProperties;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>memoryTypeCount</code> is the number of valid elements in the
<code>memoryTypes</code> array.</p>
</li>
<li>
<p><code>memoryTypes</code> is an array of <a href="#VkMemoryType">VkMemoryType</a> structures
describing the <em>memory types</em> that <strong class="purple">can</strong> be used to access memory
allocated from the heaps specified by <code>memoryHeaps</code>.</p>
</li>
<li>
<p><code>memoryHeapCount</code> is the number of valid elements in the
<code>memoryHeaps</code> array.</p>
</li>
<li>
<p><code>memoryHeaps</code> is an array of <a href="#VkMemoryHeap">VkMemoryHeap</a> structures
describing the <em>memory heaps</em> from which memory <strong class="purple">can</strong> be allocated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>VkPhysicalDeviceMemoryProperties</code> structure describes a number of
<em>memory heaps</em> as well as a number of <em>memory types</em> that <strong class="purple">can</strong> be used to
access memory allocated in those heaps.
Each heap describes a memory resource of a particular size, and each memory
type describes a set of memory properties (e.g. host cached vs uncached)
that <strong class="purple">can</strong> be used with a given memory heap.
Allocations using a particular memory type will consume resources from the
heap indicated by that memory type&#8217;s heap index.
More than one memory type <strong class="purple">may</strong> share each heap, and the heaps and memory
types provide a mechanism to advertise an accurate size of the physical
memory resources while allowing the memory to be used with a variety of
different properties.</p>
</div>
<div class="paragraph">
<p>The number of memory heaps is given by <code>memoryHeapCount</code> and is less
than or equal to <code>VK_MAX_MEMORY_HEAPS</code>.
Each heap is described by an element of the <code>memoryHeaps</code> array as a
<a href="#VkMemoryHeap">VkMemoryHeap</a> structure.
The number of memory types available across all memory heaps is given by
<code>memoryTypeCount</code> and is less than or equal to
<code>VK_MAX_MEMORY_TYPES</code>.
Each memory type is described by an element of the <code>memoryTypes</code> array
as a <a href="#VkMemoryType">VkMemoryType</a> structure.</p>
</div>
<div class="paragraph">
<p>At least one heap <strong class="purple">must</strong> include <code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code> in
<a href="#VkMemoryHeap">VkMemoryHeap</a>::<code>flags</code>.
If there are multiple heaps that all have similar performance
characteristics, they <strong class="purple">may</strong> all include
<code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code>.
In a unified memory architecture (UMA) system there is often only a single
memory heap which is considered to be equally &#8220;local&#8221; to the host and to
the device, and such an implementation <strong class="purple">must</strong> advertise the heap as
device-local.</p>
</div>
<div id="memory-device-bitmask-list" class="paragraph">
<p>Each memory type returned by <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a> <strong class="purple">must</strong>
have its <code>propertyFlags</code> set to one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There <strong class="purple">must</strong> be at least one memory type with both the
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> and
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> bits set in its
<code>propertyFlags</code>.
There <strong class="purple">must</strong> be at least one memory type with the
<code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> bit set in its
<code>propertyFlags</code>.</p>
</div>
<div class="paragraph">
<p>For each pair of elements <strong>X</strong> and <strong>Y</strong> returned in <code>memoryTypes</code>, <strong>X</strong>
<strong class="purple">must</strong> be placed at a lower index position than <strong>Y</strong> if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either the set of bit flags returned in the <code>propertyFlags</code> member
of <strong>X</strong> is a strict subset of the set of bit flags returned in the
<code>propertyFlags</code> member of <strong>Y</strong>.</p>
</li>
<li>
<p>or the <code>propertyFlags</code> members of <strong>X</strong> and <strong>Y</strong> are equal, and <strong>X</strong>
belongs to a memory heap with greater performance (as determined in an
implementation-specific manner).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There is no ordering requirement between <strong>X</strong> and <strong>Y</strong> elements for the case
their <code>propertyFlags</code> members are not in a subset relation.
That potentially allows more than one possible way to order the same set of
memory types.
Notice that the <a href="#memory-device-bitmask-list">list of all allowed memory
property flag combinations</a> is written in a valid order.
But if instead <code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> was before
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code>, the list would still be in a
valid order.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This ordering requirement enables applications to use a simple search loop
to select the desired memory type along the lines of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Find a memory in `memoryTypeBitsRequirement` that includes all of `requiredProperties`</span>
int32_t findProperties(<span class="directive">const</span> VkPhysicalDeviceMemoryProperties* pMemoryProperties,
                       uint32_t memoryTypeBitsRequirement,
                       VkMemoryPropertyFlags requiredProperties) {
    <span class="directive">const</span> uint32_t memoryCount = pMemoryProperties-&gt;memoryTypeCount;
    <span class="keyword">for</span> (uint32_t memoryIndex = <span class="integer">0</span>; memoryIndex &lt; memoryCount; ++memoryIndex) {
        <span class="directive">const</span> uint32_t memoryTypeBits = (<span class="integer">1</span> &lt;&lt; memoryIndex);
        <span class="directive">const</span> <span class="predefined-type">bool</span> isRequiredMemoryType = memoryTypeBitsRequirement &amp; memoryTypeBits;

        <span class="directive">const</span> VkMemoryPropertyFlags properties =
            pMemoryProperties-&gt;memoryTypes[memoryIndex].propertyFlags;
        <span class="directive">const</span> <span class="predefined-type">bool</span> hasRequiredProperties =
            (properties &amp; requiredProperties) == requiredProperties;

        <span class="keyword">if</span> (isRequiredMemoryType &amp;&amp; hasRequiredProperties)
            <span class="keyword">return</span> <span class="keyword">static_cast</span>&lt;int32_t&gt;(memoryIndex);
    }

    <span class="comment">// failed to find memory type</span>
    <span class="keyword">return</span> -<span class="integer">1</span>;
}

<span class="comment">// Try to find an optimal memory type, or if it does not exist try fallback memory type</span>
<span class="comment">// `device` is the VkDevice</span>
<span class="comment">// `image` is the VkImage that requires memory to be bound</span>
<span class="comment">// `memoryProperties` properties as returned by vkGetPhysicalDeviceMemoryProperties</span>
<span class="comment">// `requiredProperties` are the property flags that must be present</span>
<span class="comment">// `optimalProperties` are the property flags that are preferred by the application</span>
VkMemoryRequirements memoryRequirements;
vkGetImageMemoryRequirements(device, image, &amp;memoryRequirements);
int32_t memoryType =
    findProperties(&amp;memoryProperties, memoryRequirements.memoryTypeBits, optimalProperties);
<span class="keyword">if</span> (memoryType == -<span class="integer">1</span>) <span class="comment">// not found; try fallback properties</span>
    memoryType =
        findProperties(&amp;memoryProperties, memoryRequirements.memoryTypeBits, requiredProperties);</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryHeap</code> structure is defined as:</p>
</div>
<div id="VkMemoryHeap" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryHeap {
    VkDeviceSize         size;
    VkMemoryHeapFlags    flags;
} VkMemoryHeap;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>size</code> is the total memory size in bytes in the heap.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkMemoryHeapFlagBits">VkMemoryHeapFlagBits</a> specifying
attribute flags for the heap.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="#VkMemoryHeap">VkMemoryHeap</a>::<code>flags</code>, indicating
attribute flags for the heap, are:</p>
</div>
<div id="VkMemoryHeapFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkMemoryHeapFlagBits {
    VK_MEMORY_HEAP_DEVICE_LOCAL_BIT = <span class="hex">0x00000001</span>,
} VkMemoryHeapFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code> specifies that the heap
corresponds to device local memory.
Device local memory <strong class="purple">may</strong> have different performance characteristics than
host local memory, and <strong class="purple">may</strong> support different memory property flags.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryHeapFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryHeapFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryHeapFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkMemoryHeapFlagBits">VkMemoryHeapFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryType</code> structure is defined as:</p>
</div>
<div id="VkMemoryType" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryType {
    VkMemoryPropertyFlags    propertyFlags;
    uint32_t                 heapIndex;
} VkMemoryType;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>heapIndex</code> describes which memory heap this memory type corresponds
to, and <strong class="purple">must</strong> be less than <code>memoryHeapCount</code> from the
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a> structure.</p>
</li>
<li>
<p><code>propertyFlags</code> is a bitmask of <a href="#VkMemoryPropertyFlagBits">VkMemoryPropertyFlagBits</a> of
properties for this memory type.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="#VkMemoryType">VkMemoryType</a>::<code>propertyFlags</code>,
indicating properties of a memory heap, are:</p>
</div>
<div id="VkMemoryPropertyFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkMemoryPropertyFlagBits {
    VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT = <span class="hex">0x00000001</span>,
    VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT = <span class="hex">0x00000002</span>,
    VK_MEMORY_PROPERTY_HOST_COHERENT_BIT = <span class="hex">0x00000004</span>,
    VK_MEMORY_PROPERTY_HOST_CACHED_BIT = <span class="hex">0x00000008</span>,
    VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT = <span class="hex">0x00000010</span>,
} VkMemoryPropertyFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> bit specifies that memory
allocated with this type is the most efficient for device access.
This property will be set if and only if the memory type belongs to a
heap with the <code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code> set.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> bit specifies that memory
allocated with this type <strong class="purple">can</strong> be mapped for host access using
<a href="#vkMapMemory">vkMapMemory</a>.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> bit specifies that the host
cache management commands <a href="#vkFlushMappedMemoryRanges">vkFlushMappedMemoryRanges</a> and
<a href="#vkInvalidateMappedMemoryRanges">vkInvalidateMappedMemoryRanges</a> are not needed to flush host writes
to the device or make device writes visible to the host, respectively.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> bit specifies that memory
allocated with this type is cached on the host.
Host memory accesses to uncached memory are slower than to cached
memory, however uncached memory is always host coherent.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> bit specifies that the
memory type only allows device access to the memory.
Memory types <strong class="purple">must</strong> not have both
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> and
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> set.
Additionally, the object&#8217;s backing memory <strong class="purple">may</strong> be provided by the
implementation lazily as specified in <a href="#memory-device-lazy_allocation">Lazily Allocated Memory</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryPropertyFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryPropertyFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryPropertyFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkMemoryPropertyFlagBits">VkMemoryPropertyFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A Vulkan device operates on data in device memory via memory objects that
are represented in the API by a <code>VkDeviceMemory</code> handle:</p>
</div>
<div id="VkDeviceMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkDeviceMemory)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To allocate memory objects, call:</p>
</div>
<div id="vkAllocateMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkAllocateMemory(
    VkDevice                                    device,
    <span class="directive">const</span> VkMemoryAllocateInfo*                 pAllocateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkDeviceMemory*                             pMemory);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>pAllocateInfo</code> is a pointer to an instance of the
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure describing parameters of the
allocation.
A successful returned allocation <strong class="purple">must</strong> use the requested parameters&#8201;&#8212;&#8201;no substitution is permitted by the implementation.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pMemory</code> is a pointer to a <a href="#VkDeviceMemory">VkDeviceMemory</a> handle in which
information about the allocated memory is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Allocations returned by <code>vkAllocateMemory</code> are guaranteed to meet any
alignment requirement of the implementation.
For example, if an implementation requires 128 byte alignment for images and
64 byte alignment for buffers, the device memory returned through this
mechanism would be 128-byte aligned.
This ensures that applications <strong class="purple">can</strong> correctly suballocate objects of
different types (with potentially different alignment requirements) in the
same memory object.</p>
</div>
<div class="paragraph">
<p>When memory is allocated, its contents are undefined.</p>
</div>
<div class="paragraph">
<p>The maximum number of valid memory allocations that <strong class="purple">can</strong> exist
simultaneously within a <a href="#VkDevice">VkDevice</a> <strong class="purple">may</strong> be restricted by implementation-
or platform-dependent limits.
If a call to <a href="#vkAllocateMemory">vkAllocateMemory</a> would cause the total number of
allocations to exceed these limits, such a call will fail and <strong class="purple">must</strong> return
<code>VK_ERROR_TOO_MANY_OBJECTS</code>.
The
<a href="#features-limits-maxMemoryAllocationCount"><code>maxMemoryAllocationCount</code></a>
feature describes the number of allocations that <strong class="purple">can</strong> exist simultaneously
before encountering these internal limits.</p>
</div>
<div class="paragraph">
<p>Some platforms <strong class="purple">may</strong> have a limit on the maximum size of a single allocation.
For example, certain systems <strong class="purple">may</strong> fail to create allocations with a size
greater than or equal to 4GB.
Such a limit is implementation-dependent, and if such a failure occurs then
the error <code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code> <strong class="purple">must</strong> be returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocateInfo-01713"></a>
<code>pAllocateInfo</code>-&gt;<code>allocationSize</code> <strong class="purple">must</strong> be less than or equal
to
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a>::<code>memoryHeaps</code>[<code>pAllocateInfo</code>-&gt;<code>memoryTypeIndex</code>].<code>size</code>
as returned by <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a> for the
<a href="#VkPhysicalDevice">VkPhysicalDevice</a> that <code>device</code> was created from.</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocateInfo-01714"></a>
<code>pAllocateInfo</code>-&gt;<code>memoryTypeIndex</code> <strong class="purple">must</strong> be less than
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a>::<code>memoryTypeCount</code> as
returned by <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a> for the
<a href="#VkPhysicalDevice">VkPhysicalDevice</a> that <code>device</code> was created from.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAllocateMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocateInfo-parameter"></a> <code>pAllocateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkMemoryAllocateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pMemory-parameter"></a> <code>pMemory</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkDeviceMemory</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryAllocateInfo</code> structure is defined as:</p>
</div>
<div id="VkMemoryAllocateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryAllocateInfo {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkDeviceSize       allocationSize;
    uint32_t           memoryTypeIndex;
} VkMemoryAllocateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>allocationSize</code> is the size of the allocation in bytes</p>
</li>
<li>
<p><code>memoryTypeIndex</code> is an index identifying a memory type from the
<code>memoryTypes</code> array of the <a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a>
structure</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-00638"></a>
<code>allocationSize</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To free a memory object, call:</p>
</div>
<div id="vkFreeMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkFreeMemory(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the <a href="#VkDeviceMemory">VkDeviceMemory</a> object to be freed.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before freeing a memory object, an application <strong class="purple">must</strong> ensure the memory
object is no longer in use by the device&#8212;&#8203;for example by command buffers in
the <em>pending state</em>.
The memory <strong class="purple">can</strong> remain bound to images or buffers at the time the memory
object is freed, but any further use of them (on host or device) for
anything other than destroying those objects will result in undefined
behavior.
If there are still any bound images or buffers, the memory <strong class="purple">may</strong> not be
immediately released by the implementation, but <strong class="purple">must</strong> be released by the
time all bound images and buffers have been destroyed.
Once memory is released, it is returned to the heap from which it was
allocated.</p>
</div>
<div class="paragraph">
<p>How memory objects are bound to Images and Buffers is described in detail in
the <a href="#resources-association">Resource Memory Association</a> section.</p>
</div>
<div class="paragraph">
<p>If a memory object is mapped at the time it is freed, it is implicitly
unmapped.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As described <a href="#memory-device-unmap-does-not-flush">below</a>, host writes are
not implicitly flushed when the memory object is unmapped, but the
implementation <strong class="purple">must</strong> guarantee that writes that have not been flushed do not
affect any other memory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeMemory-memory-00677"></a>
All submitted commands that refer to <code>memory</code> (via images or
buffers) <strong class="purple">must</strong> have completed execution</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeMemory-memory-parameter"></a> If <code>memory</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeMemory-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkFreeMemory-memory-parent"></a> If <code>memory</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>memory</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="memory-device-hostaccess">10.2.1. Host Access to Device Memory Objects</h4>
<div class="paragraph">
<p>Memory objects created with <a href="#vkAllocateMemory">vkAllocateMemory</a> are not directly host
accessible.</p>
</div>
<div class="paragraph">
<p>Memory objects created with the memory property
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> are considered <em>mappable</em>.
Memory objects <strong class="purple">must</strong> be mappable in order to be successfully mapped on the
host.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve a host virtual address pointer to a region of a mappable memory
object, call:</p>
</div>
<div id="vkMapMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkMapMemory(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    VkDeviceSize                                offset,
    VkDeviceSize                                size,
    VkMemoryMapFlags                            flags,
    <span class="directive">void</span>**                                      ppData);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the <a href="#VkDeviceMemory">VkDeviceMemory</a> object to be mapped.</p>
</li>
<li>
<p><code>offset</code> is a zero-based byte offset from the beginning of the
memory object.</p>
</li>
<li>
<p><code>size</code> is the size of the memory range to map, or
<code>VK_WHOLE_SIZE</code> to map from <code>offset</code> to the end of the
allocation.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>ppData</code> points to a pointer in which is returned a host-accessible
pointer to the beginning of the mapped range.
This pointer minus <code>offset</code> <strong class="purple">must</strong> be aligned to at least
<a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>minMemoryMapAlignment</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is an application error to call <code>vkMapMemory</code> on a memory object that
is already mapped.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><code>vkMapMemory</code> will fail if the implementation is unable to allocate an
appropriately sized contiguous virtual address range, e.g. due to virtual
address space fragmentation or platform limits.
In such cases, <code>vkMapMemory</code> <strong class="purple">must</strong> return
<code>VK_ERROR_MEMORY_MAP_FAILED</code>.
The application <strong class="purple">can</strong> improve the likelihood of success by reducing the size
of the mapped range and/or removing unneeded mappings using
<code>VkUnmapMemory</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="memory-device-hostaccess-hazards" class="paragraph">
<p><code>vkMapMemory</code> does not check whether the device memory is currently in
use before returning the host-accessible pointer.
The application <strong class="purple">must</strong> guarantee that any previously submitted command that
writes to this range has completed before the host reads from or writes to
that range, and that any previously submitted command that reads from that
range has completed before the host writes to that region (see
<a href="#synchronization-submission-host-writes">here</a> for details on fulfilling
such a guarantee).
If the device memory was allocated without the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> set, these guarantees <strong class="purple">must</strong> be
made for an extended range: the application <strong class="purple">must</strong> round down the start of
the range to the nearest multiple of
<a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code>, and round the end
of the range up to the nearest multiple of
<a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code>.</p>
</div>
<div class="paragraph">
<p>While a range of device memory is mapped for host access, the application is
responsible for synchronizing both device and host access to that memory
range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It is important for the application developer to become meticulously
familiar with all of the mechanisms described in the chapter on
<a href="#synchronization">Synchronization and Cache Control</a> as they are crucial
to maintaining memory access ordering.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkMapMemory-memory-00678"></a>
<code>memory</code> <strong class="purple">must</strong> not be currently mapped</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-offset-00679"></a>
<code>offset</code> <strong class="purple">must</strong> be less than the size of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-size-00680"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-size-00681"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
less than or equal to the size of the <code>memory</code> minus <code>offset</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-00682"></a>
<code>memory</code> <strong class="purple">must</strong> have been created with a memory type that reports
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkMapMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-ppData-parameter"></a> <code>ppData</code> <strong class="purple">must</strong> be a valid pointer to a pointer value</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>memory</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_MEMORY_MAP_FAILED</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryMapFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryMapFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryMapFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Two commands are provided to enable applications to work with non-coherent
memory allocations: <code>vkFlushMappedMemoryRanges</code> and
<code>vkInvalidateMappedMemoryRanges</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If the memory object was created with the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> set,
<code>vkFlushMappedMemoryRanges</code> and <code>vkInvalidateMappedMemoryRanges</code> are
unnecessary and <strong class="purple">may</strong> have a performance cost.
However, <a href="#synchronization-dependencies-available-and-visible">availability
and visibility operations</a> still need to be managed on the device.
See the description of <a href="#synchronization-host-access-types">host access
types</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To flush ranges of non-coherent memory from the host caches, call:</p>
</div>
<div id="vkFlushMappedMemoryRanges" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkFlushMappedMemoryRanges(
    VkDevice                                    device,
    uint32_t                                    memoryRangeCount,
    <span class="directive">const</span> VkMappedMemoryRange*                  pMemoryRanges);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory ranges.</p>
</li>
<li>
<p><code>memoryRangeCount</code> is the length of the <code>pMemoryRanges</code> array.</p>
</li>
<li>
<p><code>pMemoryRanges</code> is a pointer to an array of
<a href="#VkMappedMemoryRange">VkMappedMemoryRange</a> structures describing the memory ranges to
flush.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkFlushMappedMemoryRanges</code> guarantees that host writes to the memory
ranges described by <code>pMemoryRanges</code> are made available to the host
memory domain, such that they <strong class="purple">can</strong> be made available to the device memory
domain via <a href="#synchronization-dependencies-available-and-visible">memory
domain operations</a> using the <code>VK_ACCESS_HOST_WRITE_BIT</code>
<a href="#synchronization-access-types">access type</a>.</p>
</div>
<div class="paragraph">
<p>Within each range described by <code>pMemoryRanges</code>, each set of
<code>nonCoherentAtomSize</code> bytes in that range is flushed if any byte in that
set has been written by the host since it was first mapped, or the last time
it was flushed.
If <code>pMemoryRanges</code> includes sets of <code>nonCoherentAtomSize</code> bytes
where no bytes have been written by the host, those bytes <strong class="purple">must</strong> not be
flushed.</p>
</div>
<div id="memory-device-unmap-does-not-flush" class="paragraph">
<p>Unmapping non-coherent memory does not implicitly flush the mapped memory,
and host writes that have not been flushed <strong class="purple">may</strong> not ever be visible to the
device.
However, implementations <strong class="purple">must</strong> ensure that writes that have not been flushed
do not become visible to any other memory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The above guarantee avoids a potential memory corruption in scenarios where
host writes to a mapped memory object have not been flushed before the
memory is unmapped (or freed), and the virtual address range is subsequently
reused for a different mapping (or memory allocation).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFlushMappedMemoryRanges-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFlushMappedMemoryRanges-pMemoryRanges-parameter"></a> <code>pMemoryRanges</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryRangeCount</code> valid <code>VkMappedMemoryRange</code> structures</p>
</li>
<li>
<p><a id="VUID-vkFlushMappedMemoryRanges-memoryRangeCount-arraylength"></a> <code>memoryRangeCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To invalidate ranges of non-coherent memory from the host caches, call:</p>
</div>
<div id="vkInvalidateMappedMemoryRanges" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkInvalidateMappedMemoryRanges(
    VkDevice                                    device,
    uint32_t                                    memoryRangeCount,
    <span class="directive">const</span> VkMappedMemoryRange*                  pMemoryRanges);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory ranges.</p>
</li>
<li>
<p><code>memoryRangeCount</code> is the length of the <code>pMemoryRanges</code> array.</p>
</li>
<li>
<p><code>pMemoryRanges</code> is a pointer to an array of
<a href="#VkMappedMemoryRange">VkMappedMemoryRange</a> structures describing the memory ranges to
invalidate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkInvalidateMappedMemoryRanges</code> guarantees that device writes to the
memory ranges described by <code>pMemoryRanges</code>, which have been made
available to the host memory domain using the <code>VK_ACCESS_HOST_WRITE_BIT</code>
and <code>VK_ACCESS_HOST_READ_BIT</code> <a href="#synchronization-access-types">access
types</a>, are made visible to the host.
If a range of non-coherent memory is written by the host and then
invalidated without first being flushed, its contents are undefined.</p>
</div>
<div class="paragraph">
<p>Within each range described by <code>pMemoryRanges</code>, each set of
<code>nonCoherentAtomSize</code> bytes in that range is invalidated if any byte in
that set has been written by the device since it was first mapped, or the
last time it was invalidated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Mapping non-coherent memory does not implicitly invalidate the mapped
memory, and device writes that have not been invalidated <strong class="purple">must</strong> be made
visible before the host reads or overwrites them.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkInvalidateMappedMemoryRanges-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkInvalidateMappedMemoryRanges-pMemoryRanges-parameter"></a> <code>pMemoryRanges</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryRangeCount</code> valid <code>VkMappedMemoryRange</code> structures</p>
</li>
<li>
<p><a id="VUID-vkInvalidateMappedMemoryRanges-memoryRangeCount-arraylength"></a> <code>memoryRangeCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMappedMemoryRange</code> structure is defined as:</p>
</div>
<div id="VkMappedMemoryRange" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMappedMemoryRange {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkDeviceMemory     memory;
    VkDeviceSize       offset;
    VkDeviceSize       size;
} VkMappedMemoryRange;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memory</code> is the memory object to which this range belongs.</p>
</li>
<li>
<p><code>offset</code> is the zero-based byte offset from the beginning of the
memory object.</p>
</li>
<li>
<p><code>size</code> is either the size of range, or <code>VK_WHOLE_SIZE</code> to affect
the range from <code>offset</code> to the end of the current mapping of the
allocation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMappedMemoryRange-memory-00684"></a>
<code>memory</code> <strong class="purple">must</strong> be currently mapped</p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-00685"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>offset</code> and
<code>size</code> <strong class="purple">must</strong> specify a range contained within the currently mapped
range of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-00686"></a>
If <code>size</code> is equal to <code>VK_WHOLE_SIZE</code>, <code>offset</code> <strong class="purple">must</strong> be
within the currently mapped range of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-01389"></a>
If <code>size</code> is equal to <code>VK_WHOLE_SIZE</code>, the end of the current
mapping of <code>memory</code> <strong class="purple">must</strong> be a multiple of
<a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code> bytes from the
beginning of the memory object.</p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-offset-00687"></a>
<code>offset</code> <strong class="purple">must</strong> be a multiple of
<a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-01390"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong>
either be a multiple of
<a href="#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code>, or <code>offset</code>
plus <code>size</code> <strong class="purple">must</strong> equal the size of <code>memory</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMappedMemoryRange-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MAPPED_MEMORY_RANGE</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To unmap a memory object once host access to it is no longer needed by the
application, call:</p>
</div>
<div id="vkUnmapMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkUnmapMemory(
    VkDevice                                    device,
    VkDeviceMemory                              memory);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the memory object to be unmapped.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUnmapMemory-memory-00689"></a>
<code>memory</code> <strong class="purple">must</strong> be currently mapped</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUnmapMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkUnmapMemory-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkUnmapMemory-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>memory</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="memory-device-lazy_allocation">10.2.2. Lazily Allocated Memory</h4>
<div class="paragraph">
<p>If the memory object is allocated from a heap with the
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> bit set, that object&#8217;s backing
memory <strong class="purple">may</strong> be provided by the implementation lazily.
The actual committed size of the memory <strong class="purple">may</strong> initially be as small as zero
(or as large as the requested size), and monotonically increases as
additional memory is needed.</p>
</div>
<div class="paragraph">
<p>A memory type with this flag set is only allowed to be bound to a
<code>VkImage</code> whose usage flags include
<code>VK_IMAGE_USAGE_TRANSIENT_ATTACHMENT_BIT</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Using lazily allocated memory objects for framebuffer attachments that are
not needed once a render pass instance has completed <strong class="purple">may</strong> allow some
implementations to never allocate memory for such attachments.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the amount of lazily-allocated memory that is currently
committed for a memory object, call:</p>
</div>
<div id="vkGetDeviceMemoryCommitment" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetDeviceMemoryCommitment(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    VkDeviceSize*                               pCommittedMemoryInBytes);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the memory object being queried.</p>
</li>
<li>
<p><code>pCommittedMemoryInBytes</code> is a pointer to a <code>VkDeviceSize</code>
value in which the number of bytes currently committed is returned, on
success.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The implementation <strong class="purple">may</strong> update the commitment at any time, and the value
returned by this query <strong class="purple">may</strong> be out of date.</p>
</div>
<div class="paragraph">
<p>The implementation guarantees to allocate any committed memory from the
heapIndex indicated by the memory type that the memory object was created
with.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-memory-00690"></a>
<code>memory</code> <strong class="purple">must</strong> have been created with a memory type that reports
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-pCommittedMemoryInBytes-parameter"></a> <code>pCommittedMemoryInBytes</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkDeviceSize</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resources">11. Resource Creation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vulkan supports two primary resource types: <em>buffers</em> and <em>images</em>.
Resources are views of memory with associated formatting and dimensionality.
Buffers are essentially unformatted arrays of bytes whereas images contain
format information, <strong class="purple">can</strong> be multidimensional and <strong class="purple">may</strong> have associated
metadata.</p>
</div>
<div class="sect2">
<h3 id="resources-buffers">11.1. Buffers</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Buffers represent linear arrays of data which are used for various purposes
by binding them to a graphics or compute pipeline via descriptor sets or via
certain commands, or by directly specifying them as parameters to certain
commands.</p>
</div>
<div class="paragraph">
<p>Buffers are represented by <code>VkBuffer</code> handles:</p>
</div>
<div id="VkBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkBuffer)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create buffers, call:</p>
</div>
<div id="vkCreateBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateBuffer(
    VkDevice                                    device,
    <span class="directive">const</span> VkBufferCreateInfo*                   pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkBuffer*                                   pBuffer);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the buffer object.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkBufferCreateInfo</code> structure containing parameters affecting
creation of the buffer.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pBuffer</code> points to a <a href="#VkBuffer">VkBuffer</a> handle in which the resulting
buffer object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateBuffer-flags-00911"></a>
If the <code>flags</code> member of <code>pCreateInfo</code> includes
<code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code>, creating this <code>VkBuffer</code>
<strong class="purple">must</strong> not cause the total required sparse memory for all currently valid
sparse resources on the device to exceed
<code>VkPhysicalDeviceLimits</code>::<code>sparseAddressSpaceSize</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateBuffer-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateBuffer-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkBufferCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateBuffer-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateBuffer-pBuffer-parameter"></a> <code>pBuffer</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkBuffer</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBufferCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkBufferCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkBufferCreateInfo {
    VkStructureType        sType;
    <span class="directive">const</span> <span class="directive">void</span>*            pNext;
    VkBufferCreateFlags    flags;
    VkDeviceSize           size;
    VkBufferUsageFlags     usage;
    VkSharingMode          sharingMode;
    uint32_t               queueFamilyIndexCount;
    <span class="directive">const</span> uint32_t*        pQueueFamilyIndices;
} VkBufferCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkBufferCreateFlagBits">VkBufferCreateFlagBits</a> specifying
additional parameters of the buffer.</p>
</li>
<li>
<p><code>size</code> is the size in bytes of the buffer to be created.</p>
</li>
<li>
<p><code>usage</code> is a bitmask of <a href="#VkBufferUsageFlagBits">VkBufferUsageFlagBits</a> specifying
allowed usages of the buffer.</p>
</li>
<li>
<p><code>sharingMode</code> is a <a href="#VkSharingMode">VkSharingMode</a> value specifying the sharing
mode of the buffer when it will be accessed by multiple queue families.</p>
</li>
<li>
<p><code>queueFamilyIndexCount</code> is the number of entries in the
<code>pQueueFamilyIndices</code> array.</p>
</li>
<li>
<p><code>pQueueFamilyIndices</code> is a list of queue families that will access
this buffer (ignored if <code>sharingMode</code> is not
<code>VK_SHARING_MODE_CONCURRENT</code>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferCreateInfo-size-00912"></a>
<code>size</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-sharingMode-00913"></a>
If <code>sharingMode</code> is <code>VK_SHARING_MODE_CONCURRENT</code>,
<code>pQueueFamilyIndices</code> <strong class="purple">must</strong> be a valid pointer to an array of
<code>queueFamilyIndexCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-sharingMode-00914"></a>
If <code>sharingMode</code> is <code>VK_SHARING_MODE_CONCURRENT</code>,
<code>queueFamilyIndexCount</code> <strong class="purple">must</strong> be greater than <code>1</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-sharingMode-01391"></a>
If <code>sharingMode</code> is <code>VK_SHARING_MODE_CONCURRENT</code>, each element
of <code>pQueueFamilyIndices</code> <strong class="purple">must</strong> be unique and <strong class="purple">must</strong> be less than
<code>pQueueFamilyPropertyCount</code> returned by
<a href="#vkGetPhysicalDeviceQueueFamilyProperties">vkGetPhysicalDeviceQueueFamilyProperties</a> for the
<code>physicalDevice</code> that was used to create <code>device</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-flags-00915"></a>
If the <a href="#features-features-sparseBinding">sparse bindings</a> feature is
not enabled, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-flags-00916"></a>
If the <a href="#features-features-sparseResidencyBuffer">sparse buffer
residency</a> feature is not enabled, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_BUFFER_CREATE_SPARSE_RESIDENCY_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-flags-00917"></a>
If the <a href="#features-features-sparseResidencyAliased">sparse aliased
residency</a> feature is not enabled, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_BUFFER_CREATE_SPARSE_ALIASED_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-flags-00918"></a>
If <code>flags</code> contains <code>VK_BUFFER_CREATE_SPARSE_RESIDENCY_BIT</code> or
<code>VK_BUFFER_CREATE_SPARSE_ALIASED_BIT</code>, it <strong class="purple">must</strong> also contain
<code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_BUFFER_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkBufferCreateFlagBits">VkBufferCreateFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-usage-parameter"></a> <code>usage</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkBufferUsageFlagBits">VkBufferUsageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-usage-requiredbitmask"></a> <code>usage</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferCreateInfo-sharingMode-parameter"></a> <code>sharingMode</code> <strong class="purple">must</strong> be a valid <a href="#VkSharingMode">VkSharingMode</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkBufferCreateInfo">VkBufferCreateInfo</a>::<code>usage</code>, specifying
usage behavior of a buffer, are:</p>
</div>
<div id="VkBufferUsageFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkBufferUsageFlagBits {
    VK_BUFFER_USAGE_TRANSFER_SRC_BIT = <span class="hex">0x00000001</span>,
    VK_BUFFER_USAGE_TRANSFER_DST_BIT = <span class="hex">0x00000002</span>,
    VK_BUFFER_USAGE_UNIFORM_TEXEL_BUFFER_BIT = <span class="hex">0x00000004</span>,
    VK_BUFFER_USAGE_STORAGE_TEXEL_BUFFER_BIT = <span class="hex">0x00000008</span>,
    VK_BUFFER_USAGE_UNIFORM_BUFFER_BIT = <span class="hex">0x00000010</span>,
    VK_BUFFER_USAGE_STORAGE_BUFFER_BIT = <span class="hex">0x00000020</span>,
    VK_BUFFER_USAGE_INDEX_BUFFER_BIT = <span class="hex">0x00000040</span>,
    VK_BUFFER_USAGE_VERTEX_BUFFER_BIT = <span class="hex">0x00000080</span>,
    VK_BUFFER_USAGE_INDIRECT_BUFFER_BIT = <span class="hex">0x00000100</span>,
} VkBufferUsageFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUFFER_USAGE_TRANSFER_SRC_BIT</code> specifies that the buffer <strong class="purple">can</strong> be
used as the source of a <em>transfer command</em> (see the definition of
<a href="#synchronization-pipeline-stages-transfer"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></a>).</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_TRANSFER_DST_BIT</code> specifies that the buffer <strong class="purple">can</strong> be
used as the destination of a transfer command.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_UNIFORM_TEXEL_BUFFER_BIT</code> specifies that the buffer
<strong class="purple">can</strong> be used to create a <code>VkBufferView</code> suitable for occupying a
<code>VkDescriptorSet</code> slot of type
<code>VK_DESCRIPTOR_TYPE_UNIFORM_TEXEL_BUFFER</code>.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_STORAGE_TEXEL_BUFFER_BIT</code> specifies that the buffer
<strong class="purple">can</strong> be used to create a <code>VkBufferView</code> suitable for occupying a
<code>VkDescriptorSet</code> slot of type
<code>VK_DESCRIPTOR_TYPE_STORAGE_TEXEL_BUFFER</code>.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_UNIFORM_BUFFER_BIT</code> specifies that the buffer <strong class="purple">can</strong>
be used in a <code>VkDescriptorBufferInfo</code> suitable for occupying a
<code>VkDescriptorSet</code> slot either of type
<code>VK_DESCRIPTOR_TYPE_UNIFORM_BUFFER</code> or
<code>VK_DESCRIPTOR_TYPE_UNIFORM_BUFFER_DYNAMIC</code>.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_STORAGE_BUFFER_BIT</code> specifies that the buffer <strong class="purple">can</strong>
be used in a <code>VkDescriptorBufferInfo</code> suitable for occupying a
<code>VkDescriptorSet</code> slot either of type
<code>VK_DESCRIPTOR_TYPE_STORAGE_BUFFER</code> or
<code>VK_DESCRIPTOR_TYPE_STORAGE_BUFFER_DYNAMIC</code>.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_INDEX_BUFFER_BIT</code> specifies that the buffer is
suitable for passing as the <code>buffer</code> parameter to
<code>vkCmdBindIndexBuffer</code>.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VERTEX_BUFFER_BIT</code> specifies that the buffer is
suitable for passing as an element of the <code>pBuffers</code> array to
<code>vkCmdBindVertexBuffers</code>.</p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_INDIRECT_BUFFER_BIT</code> specifies that the buffer is
suitable for passing as the <code>buffer</code> parameter to
<code>vkCmdDrawIndirect</code>, <code>vkCmdDrawIndexedIndirect</code>,
or <code>vkCmdDispatchIndirect</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkBufferUsageFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkBufferUsageFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkBufferUsageFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkBufferUsageFlagBits">VkBufferUsageFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkBufferCreateInfo">VkBufferCreateInfo</a>::<code>flags</code>, specifying
additional parameters of a buffer, are:</p>
</div>
<div id="VkBufferCreateFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkBufferCreateFlagBits {
    VK_BUFFER_CREATE_SPARSE_BINDING_BIT = <span class="hex">0x00000001</span>,
    VK_BUFFER_CREATE_SPARSE_RESIDENCY_BIT = <span class="hex">0x00000002</span>,
    VK_BUFFER_CREATE_SPARSE_ALIASED_BIT = <span class="hex">0x00000004</span>,
} VkBufferCreateFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code> specifies that the buffer will
be backed using sparse memory binding.</p>
</li>
<li>
<p><code>VK_BUFFER_CREATE_SPARSE_RESIDENCY_BIT</code> specifies that the buffer
<strong class="purple">can</strong> be partially backed using sparse memory binding.
Buffers created with this flag <strong class="purple">must</strong> also be created with the
<code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code> flag.</p>
</li>
<li>
<p><code>VK_BUFFER_CREATE_SPARSE_ALIASED_BIT</code> specifies that the buffer will
be backed using sparse memory binding with memory ranges that might also
simultaneously be backing another buffer (or another portion of the same
buffer).
Buffers created with this flag <strong class="purple">must</strong> also be created with the
<code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code> flag.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#sparsememory-sparseresourcefeatures">Sparse Resource Features</a> and
<a href="#features-features">Physical Device Features</a> for details of the sparse
memory features supported on a device.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkBufferCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkBufferCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkBufferCreateFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkBufferCreateFlagBits">VkBufferCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a buffer, call:</p>
</div>
<div id="vkDestroyBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyBuffer(
    VkDevice                                    device,
    VkBuffer                                    buffer,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the buffer.</p>
</li>
<li>
<p><code>buffer</code> is the buffer to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyBuffer-buffer-00922"></a>
All submitted commands that refer to <code>buffer</code>, either directly or
via a <code>VkBufferView</code>, <strong class="purple">must</strong> have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyBuffer-buffer-00923"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>buffer</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyBuffer-buffer-00924"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>buffer</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyBuffer-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyBuffer-buffer-parameter"></a> If <code>buffer</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>buffer</code> <strong class="purple">must</strong> be a valid <code>VkBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyBuffer-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyBuffer-buffer-parent"></a> If <code>buffer</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>buffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resources-buffer-views">11.2. Buffer Views</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A <em>buffer view</em> represents a contiguous range of a buffer and a specific
format to be used to interpret the data.
Buffer views are used to enable shaders to access buffer contents
interpreted as formatted data.
In order to create a valid buffer view, the buffer <strong class="purple">must</strong> have been created
with at least one of the following usage flags:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUFFER_USAGE_UNIFORM_TEXEL_BUFFER_BIT</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_STORAGE_TEXEL_BUFFER_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Buffer views are represented by <code>VkBufferView</code> handles:</p>
</div>
<div id="VkBufferView" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkBufferView)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a buffer view, call:</p>
</div>
<div id="vkCreateBufferView" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateBufferView(
    VkDevice                                    device,
    <span class="directive">const</span> VkBufferViewCreateInfo*               pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkBufferView*                               pView);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the buffer view.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkBufferViewCreateInfo</code> structure containing parameters to be used
to create the buffer.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pView</code> points to a <a href="#VkBufferView">VkBufferView</a> handle in which the resulting
buffer view object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateBufferView-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateBufferView-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkBufferViewCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateBufferView-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateBufferView-pView-parameter"></a> <code>pView</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkBufferView</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBufferViewCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkBufferViewCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkBufferViewCreateInfo {
    VkStructureType            sType;
    <span class="directive">const</span> <span class="directive">void</span>*                pNext;
    VkBufferViewCreateFlags    flags;
    VkBuffer                   buffer;
    VkFormat                   format;
    VkDeviceSize               offset;
    VkDeviceSize               range;
} VkBufferViewCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>buffer</code> is a <a href="#VkBuffer">VkBuffer</a> on which the view will be created.</p>
</li>
<li>
<p><code>format</code> is a <a href="#VkFormat">VkFormat</a> describing the format of the data
elements in the buffer.</p>
</li>
<li>
<p><code>offset</code> is an offset in bytes from the base address of the buffer.
Accesses to the buffer view from shaders use addressing that is relative
to this starting offset.</p>
</li>
<li>
<p><code>range</code> is a size in bytes of the buffer view.
If <code>range</code> is equal to <code>VK_WHOLE_SIZE</code>, the range from
<code>offset</code> to the end of the buffer is used.
If <code>VK_WHOLE_SIZE</code> is used and the remaining size of the buffer is
not a multiple of the element size of <code>format</code>, then the nearest
smaller multiple is used.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-offset-00925"></a>
<code>offset</code> <strong class="purple">must</strong> be less than the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-offset-00926"></a>
<code>offset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceLimits</code>::<code>minTexelBufferOffsetAlignment</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-range-00928"></a>
If <code>range</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>range</code> <strong class="purple">must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-range-00929"></a>
If <code>range</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>range</code> <strong class="purple">must</strong> be
a multiple of the element size of <code>format</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-range-00930"></a>
If <code>range</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>range</code> divided
by the element size of <code>format</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxTexelBufferElements</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-offset-00931"></a>
If <code>range</code> is not equal to <code>VK_WHOLE_SIZE</code>, the sum of
<code>offset</code> and <code>range</code> <strong class="purple">must</strong> be less than or equal to the size of
<code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-buffer-00932"></a>
<code>buffer</code> <strong class="purple">must</strong> have been created with a <code>usage</code> value containing
at least one of <code>VK_BUFFER_USAGE_UNIFORM_TEXEL_BUFFER_BIT</code> or
<code>VK_BUFFER_USAGE_STORAGE_TEXEL_BUFFER_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-buffer-00933"></a>
If <code>buffer</code> was created with <code>usage</code> containing
<code>VK_BUFFER_USAGE_UNIFORM_TEXEL_BUFFER_BIT</code>, <code>format</code> <strong class="purple">must</strong> be
supported for uniform texel buffers, as specified by the
<code>VK_FORMAT_FEATURE_UNIFORM_TEXEL_BUFFER_BIT</code> flag in
<code>VkFormatProperties</code>::<code>bufferFeatures</code> returned by
<code>vkGetPhysicalDeviceFormatProperties</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-buffer-00934"></a>
If <code>buffer</code> was created with <code>usage</code> containing
<code>VK_BUFFER_USAGE_STORAGE_TEXEL_BUFFER_BIT</code>, <code>format</code> <strong class="purple">must</strong> be
supported for storage texel buffers, as specified by the
<code>VK_FORMAT_FEATURE_STORAGE_TEXEL_BUFFER_BIT</code> flag in
<code>VkFormatProperties</code>::<code>bufferFeatures</code> returned by
<code>vkGetPhysicalDeviceFormatProperties</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-buffer-00935"></a>
If <code>buffer</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_BUFFER_VIEW_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-buffer-parameter"></a> <code>buffer</code> <strong class="purple">must</strong> be a valid <code>VkBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-VkBufferViewCreateInfo-format-parameter"></a> <code>format</code> <strong class="purple">must</strong> be a valid <a href="#VkFormat">VkFormat</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkBufferViewCreateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkBufferViewCreateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkBufferViewCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a buffer view, call:</p>
</div>
<div id="vkDestroyBufferView" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkDestroyBufferView(
    VkDevice                                    device,
    VkBufferView                                bufferView,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the buffer view.</p>
</li>
<li>
<p><code>bufferView</code> is the buffer view to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyBufferView-bufferView-00936"></a>
All submitted commands that refer to <code>bufferView</code> <strong class="purple">must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyBufferView-bufferView-00937"></a>
If <code>VkAllocationCallbacks</code> were provided when <code>bufferView</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyBufferView-bufferView-00938"></a>
If no <code>VkAllocationCallbacks</code> were provided when <code>bufferView</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyBufferView-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyBufferView-bufferView-parameter"></a> If <code>bufferView</code> is not <a href="#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>bufferView</code> <strong class="purple">must</strong> be a valid <code>VkBufferView</code> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyBufferView-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyBufferView-bufferView-parent"></a> If <code>bufferView</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>bufferView</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resources-images">11.3. Images</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Images represent multidimensional - up to 3 - arrays of data which <strong class="purple">can</strong> be
used for various purposes (e.g. attachments, textures), by binding them to a
graphics or compute pipeline via descriptor sets, or by directly specifying
them as parameters to certain commands.</p>
</div>
<div class="paragraph">
<p>Images are represented by <code>VkImage</code> handles:</p>
</div>
<div id="VkImage" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkImage)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create images, call:</p>
</div>
<div id="vkCreateImage" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkCreateImage(
    VkDevice                                    device,
    <span class="directive">const</span> VkImageCreateInfo*                    pCreateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkImage*                                    pImage);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the image.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to an instance of the
<code>VkImageCreateInfo</code> structure containing parameters to be used to
create the image.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pImage</code> points to a <a href="#VkImage">VkImage</a> handle in which the resulting
image object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateImage-flags-00939"></a>
If the <code>flags</code> member of <code>pCreateInfo</code> includes
<code>VK_IMAGE_CREATE_SPARSE_BINDING_BIT</code>, creating this <code>VkImage</code>
<strong class="purple">must</strong> not cause the total required sparse memory for all currently valid
sparse resources on the device to exceed
<code>VkPhysicalDeviceLimits</code>::<code>sparseAddressSpaceSize</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateImage-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateImage-pCreateInfo-parameter"></a> <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkImageCreateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateImage-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateImage-pImage-parameter"></a> <code>pImage</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkImage</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImageCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkImageCreateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImageCreateInfo {
    VkStructureType          sType;
    <span class="directive">const</span> <span class="directive">void</span>*              pNext;
    VkImageCreateFlags       flags;
    VkImageType              imageType;
    VkFormat                 format;
    VkExtent3D               extent;
    uint32_t                 mipLevels;
    uint32_t                 arrayLayers;
    VkSampleCountFlagBits    samples;
    VkImageTiling            tiling;
    VkImageUsageFlags        usage;
    VkSharingMode            sharingMode;
    uint32_t                 queueFamilyIndexCount;
    <span class="directive">const</span> uint32_t*          pQueueFamilyIndices;
    VkImageLayout            initialLayout;
} VkImageCreateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkImageCreateFlagBits">VkImageCreateFlagBits</a> describing
additional parameters of the image.</p>
</li>
<li>
<p><code>imageType</code> is a <a href="#VkImageType">VkImageType</a> value specifying the basic
dimensionality of the image.
Layers in array textures do not count as a dimension for the purposes of
the image type.</p>
</li>
<li>
<p><code>format</code> is a <a href="#VkFormat">VkFormat</a> describing the format and type of the
data elements that will be contained in the image.</p>
</li>
<li>
<p><code>extent</code> is a <a href="#VkExtent3D">VkExtent3D</a> describing the number of data
elements in each dimension of the base level.</p>
</li>
<li>
<p><code>mipLevels</code> describes the number of levels of detail available for
minified sampling of the image.</p>
</li>
<li>
<p><code>arrayLayers</code> is the number of layers in the image.</p>
</li>
<li>
<p><code>samples</code> is the number of sub-data element samples in the image as
defined in <a href="#VkSampleCountFlagBits">VkSampleCountFlagBits</a>.
See <a href="#primsrast-multisampling">Multisampling</a>.</p>
</li>
<li>
<p><code>tiling</code> is a <a href="#VkImageTiling">VkImageTiling</a> value specifying the tiling
arrangement of the data elements in memory.</p>
</li>
<li>
<p><code>usage</code> is a bitmask of <a href="#VkImageUsageFlagBits">VkImageUsageFlagBits</a> describing the
intended usage of the image.</p>
</li>
<li>
<p><code>sharingMode</code> is a <a href="#VkSharingMode">VkSharingMode</a> value specifying the sharing
mode of the image when it will be accessed by multiple queue families.</p>
</li>
<li>
<p><code>queueFamilyIndexCount</code> is the number of entries in the
<code>pQueueFamilyIndices</code> array.</p>
</li>
<li>
<p><code>pQueueFamilyIndices</code> is a list of queue families that will access
this image (ignored if <code>sharingMode</code> is not
<code>VK_SHARING_MODE_CONCURRENT</code>).</p>
</li>
<li>
<p><code>initialLayout</code> is a <a href="#VkImageLayout">VkImageLayout</a> value specifying the
initial <a href="#VkImageLayout">VkImageLayout</a> of all image subresources of the image.
See <a href="#resources-image-layouts">Image Layouts</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Images created with <code>tiling</code> equal to <code>VK_IMAGE_TILING_LINEAR</code> have
further restrictions on their limits and capabilities compared to images
created with <code>tiling</code> equal to <code>VK_IMAGE_TILING_OPTIMAL</code>.
Creation of images with tiling <code>VK_IMAGE_TILING_LINEAR</code> <strong class="purple">may</strong> not be
supported unless other parameters meet all of the constraints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>imageType</code> is <code>VK_IMAGE_TYPE_2D</code></p>
</li>
<li>
<p><code>format</code> is not a depth/stencil format</p>
</li>
<li>
<p><code>mipLevels</code> is 1</p>
</li>
<li>
<p><code>arrayLayers</code> is 1</p>
</li>
<li>
<p><code>samples</code> is <code>VK_SAMPLE_COUNT_1_BIT</code></p>
</li>
<li>
<p><code>usage</code> only includes <code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code> and/or
<code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> support additional limits and capabilities beyond those
listed above.</p>
</div>
<div class="paragraph">
<p>To determine the set of valid <code>usage</code> bits for a given format, call
<a href="#vkGetPhysicalDeviceFormatProperties">vkGetPhysicalDeviceFormatProperties</a>.</p>
</div>
<div class="paragraph">
<p>If the size of the resultant image would exceed <code>maxResourceSize</code>, then
<code>vkCreateImage</code> <strong class="purple">must</strong> fail and return
<code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code>.
This failure <strong class="purple">may</strong> occur even when all image creation parameters satisfy
their valid usage requirements.</p>
</div>
<div id="resources-image-creation-limits" class="sidebarblock">
<div class="content">
<div class="title">Image Creation Limits</div>
<div class="paragraph">
<p>Valid values for some image creation parameters are limited by a numerical
upper bound or by inclusion in a bitset.
For example, <code>VkImageCreateInfo</code>::<code>arrayLayers</code> is limited by
<code>imageCreateMaxArrayLayers</code>, defined below; and
<code>VkImageCreateInfo</code>::<code>samples</code> is limited by
<code>imageCreateSampleCounts</code>, also defined below.</p>
</div>
<div class="paragraph">
<p>Several limiting values are defined below, as well as assisting values from
which the limiting values are derived.
The limiting values are referenced by the relevant valid usage statements of
<code>VkImageCreateInfo</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>VkBool32 imageCreateMaybeLinear</code> indicate if the resulant image may
be <a href="#glossary-linear-image">linear</a>.
(The definition below is trivial because certain extensions are disabled
in this build of the specification).</p>
<div class="ulist">
<ul>
<li>
<p>If <code>tiling</code> is <code>VK_IMAGE_TILING_LINEAR</code>, then
<code>imageCreateMaybeLinear</code> is <code>true</code>.</p>
</li>
<li>
<p>If <code>tiling</code> is <code>VK_IMAGE_TILING_OPTIMAL</code>, then
<code>imageCreateMaybeLinear</code> is <code>false</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>VkFormatFeatureFlags imageCreateFormatFeatures</code> be the set of format
features available during image creation.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>tiling</code> is <code>VK_IMAGE_TILING_LINEAR</code>, then
<code>imageCreateFormatFeatures</code> is the value of
<a href="#VkImageFormatProperties">VkImageFormatProperties</a>::<code>linearTilingFeatures</code> found by
calling <a href="#vkGetPhysicalDeviceFormatProperties">vkGetPhysicalDeviceFormatProperties</a> with parameter
<code>format</code> equal to <code>VkImageCreateInfo</code>::<code>format</code>.</p>
</li>
<li>
<p>If <code>tiling</code> is <code>VK_IMAGE_TILING_OPTIMAL</code>,
then <code>imageCreateFormatFeatures</code> is value of
<a href="#VkImageFormatProperties">VkImageFormatProperties</a>::<code>optimalTilingFeatures</code> found by
calling <a href="#vkGetPhysicalDeviceFormatProperties">vkGetPhysicalDeviceFormatProperties</a> with parameter
<code>format</code> equal to <code>VkImageCreateInfo</code>::<code>format</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.86<br>
Last updated 2018-09-29 03:21:33 PDT
</div>
</div>


</body>
</html>