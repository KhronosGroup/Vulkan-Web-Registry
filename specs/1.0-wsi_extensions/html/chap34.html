<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="The Khronos® Vulkan  Working Group">
<title>Vulkan® 1.0.299 - A Specification (with all ratified extensions)</title>
<link rel="stylesheet" href="style0.css" type="text/css">
<link rel="stylesheet" href="style1.css" type="text/css">
<link rel="stylesheet" href="style2.css" type="text/css">

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin="" even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<!--ChunkedSearchJSMarker-->
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<link rel="stylesheet" href="style3.css" type="text/css">
<script>
    function hideElement(e){
        e.setAttribute("hidden", "");
        e.classList.add("hidden");
    }

    function unhideElement(e){
        e.classList.remove("hidden");
        e.removeAttribute("hidden");
    }

    function hideLoadableContent(){
        unhideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) hideElement(loadable);
    }

    function unhideLoadableContent(){
        hideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) unhideElement(loadable);
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
<link rel="stylesheet" href="asciidoctor-chunker.css" type="text/css"></head>
<body class="book toc2 toc-left">
<div style="text-align: center;">
    <span class="image"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgdmlld0JveD0iMCAwIDExNTAgMzI2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MS40MTQyMTsiPgogICAgPGcgaWQ9IkFydGJvYXJkMSIgdHJhbnNmb3JtPSJtYXRyaXgoMC45NTUxNSwwLDAsMC44ODgyODMsLTQwLjExNjMsLTMwLjIwMTYpIj4KICAgICAgICA8cmVjdCB4PSI0MiIgeT0iMzQiIHdpZHRoPSIxMjA0IiBoZWlnaHQ9IjM2NyIgc3R5bGU9ImZpbGw6bm9uZTsiLz4KICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLjA0Njk2LDAsMCwxLjEyNTc3LC00Ni45OTEzLC01MC40MzI1KSI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik03MjQuMSwzODUuMDZMNjgzLjUzLDM4NS4wNkM2ODMuNTMsMzg1LjA2IDY4My41MywyODYuMDkgNjgzLjUzLDI1NS40QzY5Ni40OSwyNjIuNjIgNzEzLjYyLDI3NS45NCA3MjQuMSwyODguNzJMNzI0LjEsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxnPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTM4MS43NSwzODUuMDZMMzMxLjE3LDM4NS4wNkwyNjUuMTYsMTgxLjAzTDMxMS4xNywxODEuMDNMMzU2LjYxLDMyNC40OEwzNTcuMTgsMzI0LjQ4TDQwMy4xOCwxODEuMDNMNDQ5LjQ3LDE4MS4wM0wzODEuNzUsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNTg1LjUxLDM4NS4wNkw1NDYuOTMsMzg1LjA2TDU0Ni45MywzNjQuNDlMNTQ2LjA4LDM2NC40OUM1NDAuOTMsMzczLjA3IDUzNC4yNywzNzkuMjYgNTI2LjA3LDM4My4wN0M1MTcuODgsMzg2Ljg4IDUwOS41LDM4OC43OCA1MDAuOTIsMzg4Ljc4QzQ5MC4wNiwzODguNzggNDgxLjE2LDM4Ny4zNSA0NzQuMiwzODQuNUM0NjcuMjUsMzgxLjY1IDQ2MS43NywzNzcuNTkgNDU3Ljc3LDM3Mi4zNkM0NTMuNzYsMzY3LjEyIDQ1MC45NSwzNjAuNzQgNDQ5LjMzLDM1My4yMUM0NDcuNzIsMzQ1LjY5IDQ0Ni45MSwzMzcuMzUgNDQ2LjkxLDMyOC4yMUw0NDYuOTEsMjM3LjMzTDQ4Ny40OSwyMzcuMzNMNDg3LjQ5LDMyMC43N0M0ODcuNDksMzMyLjk2IDQ4OS40LDM0Mi4wNiA0OTMuMjEsMzQ4LjA2QzQ5Ny4wMiwzNTQuMDcgNTAzLjc4LDM1Ny4wNiA1MTMuNSwzNTcuMDZDNTI0LjU1LDM1Ny4wNiA1MzIuNTUsMzUzLjc4IDUzNy41LDM0Ny4yQzU0Mi40NiwzNDAuNjIgNTQ0LjkzLDMyOS44MSA1NDQuOTMsMzE0Ljc2TDU0NC45MywyMzcuMzJMNTg1LjUyLDIzNy4zMkw1ODUuNTIsMzg1LjA2TDU4NS41MSwzODUuMDZaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8cGF0aCBkPSJNNzMwLjg0LDI5Ni4xOUw3MzAuNzQsMjkwLjQ3TDc4MS44OSwyMzcuMzNMODI5LjkxLDIzNy4zM0w3NzQuMTgsMjkxLjYyTDgzNi4xOSwzODUuMDZMNzg3LjA0LDM4NS4wNkw3MzAuODQsMjk2LjE5WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik04NDMuNjIsMjgyLjc2Qzg0NC4xOSwyNzMuMjQgODQ2LjU4LDI2NS4zMyA4NTAuNzcsMjU5LjA0Qzg1NC45NiwyNTIuNzUgODYwLjI5LDI0Ny43MSA4NjYuNzcsMjQzLjlDODczLjI1LDI0MC4wOSA4ODAuNTQsMjM3LjM3IDg4OC42NCwyMzUuNzZDODk2LjczLDIzNC4xNCA5MDQuODgsMjMzLjMzIDkxMy4wNywyMzMuMzNDOTIwLjUsMjMzLjMzIDkyOC4wMiwyMzMuODUgOTM1LjY0LDIzNC45Qzk0My4yNywyMzUuOTUgOTUwLjIxLDIzOCA5NTYuNSwyNDEuMDVDOTYyLjc4LDI0NC4xIDk2Ny45MywyNDguMzQgOTcxLjk0LDI1My43NkM5NzUuOTQsMjU5LjE5IDk3Ny45NCwyNjYuMzggOTc3Ljk0LDI3NS4zNEw5NzcuOTQsMzUyLjIxQzk3Ny45NCwzNTguODggOTc4LjMyLDM2NS4yNyA5NzkuMDgsMzcxLjM2Qzk3OS44NCwzNzcuNDYgOTgxLjE4LDM4Mi4wMyA5ODMuMDksMzg1LjA4TDk0MS45NCwzODUuMDhDOTQxLjE4LDM4Mi44IDk0MC41NiwzODAuNDYgOTQwLjA4LDM3OC4wOEM5MzkuNjEsMzc1LjcgOTM5LjI3LDM3My4yOCA5MzkuMDgsMzcwLjc5QzkzMi42LDM3Ny40NyA5MjQuOTcsMzgyLjEzIDkxNi4yMSwzODQuOEM5MDcuNDUsMzg3LjQ2IDg5OC40OSwzODguOCA4ODkuMzUsMzg4LjhDODgyLjMsMzg4LjggODc1LjcyLDM4Ny45NCA4NjkuNjQsMzg2LjIzQzg2My41NCwzODQuNTIgODU4LjIsMzgxLjg1IDg1My42NCwzNzguMjNDODQ5LjA2LDM3NC42MSA4NDUuNDgsMzcwLjA0IDg0Mi45MiwzNjQuNTFDODQwLjM1LDM1OC45OSA4MzkuMDYsMzUyLjQyIDgzOS4wNiwzNDQuOEM4MzkuMDYsMzM2LjQyIDg0MC41NCwzMjkuNTEgODQzLjQ5LDMyNC4wOEM4NDYuNDUsMzE4LjY1IDg1MC4yNSwzMTQuMzIgODU0LjkzLDMxMS4wOEM4NTkuNiwzMDcuODQgODY0LjkzLDMwNS40MSA4NzAuOTMsMzAzLjc5Qzg3Ni45MywzMDIuMTcgODgyLjk4LDMwMC44OCA4ODkuMDcsMjk5LjkzQzg5NS4xNywyOTguOTkgOTAxLjE3LDI5OC4yMiA5MDcuMDgsMjk3LjY1QzkxMi45OSwyOTcuMDggOTE4LjIyLDI5Ni4yMiA5MjIuNzksMjk1LjA4QzkyNy4zNywyOTMuOTMgOTMwLjk4LDI5Mi4yNyA5MzMuNjUsMjkwLjA3QzkzNi4zMiwyODcuODggOTM3LjU2LDI4NC42OSA5MzcuMzcsMjgwLjVDOTM3LjM3LDI3Ni4xMiA5MzYuNjUsMjcyLjY0IDkzNS4yMiwyNzAuMDdDOTMzLjc5LDI2Ny41IDkzMS44OSwyNjUuNSA5MjkuNTEsMjY0LjA3QzkyNy4xMywyNjIuNjQgOTI0LjM3LDI2MS42OSA5MjEuMjIsMjYxLjIxQzkxOC4wNywyNjAuNzMgOTE0LjcsMjYwLjQ5IDkxMS4wOCwyNjAuNDlDOTAzLjA4LDI2MC40OSA4OTYuNzksMjYyLjIgODkyLjIyLDI2NS42NEM4ODcuNjUsMjY5LjA3IDg4NC45OCwyNzQuNzggODg0LjIyLDI4Mi43OUw4NDMuNjIsMjgyLjc5TDg0My42MiwyODIuNzZaTTkzNy4zNSwzMTIuNzdDOTM1LjYzLDMxNC4zIDkzMy40OSwzMTUuNDggOTMwLjkyLDMxNi4zNEM5MjguMzUsMzE3LjIxIDkyNS41OSwzMTcuOTIgOTIyLjYzLDMxOC40OUM5MTkuNjgsMzE5LjA2IDkxNi41OCwzMTkuNTQgOTEzLjM1LDMxOS45MkM5MTAuMTEsMzIwLjMgOTA2Ljg3LDMyMC43NyA5MDMuNjMsMzIxLjM1QzkwMC41OCwzMjEuOTIgODk3LjU4LDMyMi42OSA4OTQuNjMsMzIzLjYzQzg5MS42OCwzMjQuNTkgODg5LjEsMzI1Ljg3IDg4Ni45MSwzMjcuNDlDODg0LjcyLDMyOS4xMSA4ODIuOTYsMzMxLjE2IDg4MS42MiwzMzMuNjNDODgwLjI5LDMzNi4xMSA4NzkuNjIsMzM5LjI1IDg3OS42MiwzNDMuMDZDODc5LjYyLDM0Ni42OCA4ODAuMjksMzQ5LjczIDg4MS42MiwzNTIuMkM4ODIuOTYsMzU0LjY4IDg4NC43NywzNTYuNjMgODg3LjA1LDM1OC4wNkM4ODkuMzQsMzU5LjQ5IDg5MiwzNjAuNDkgODk1LjA1LDM2MS4wNkM4OTguMSwzNjEuNjMgOTAxLjI0LDM2MS45MSA5MDQuNDgsMzYxLjkxQzkxMi40OCwzNjEuOTEgOTE4LjY4LDM2MC41OCA5MjMuMDYsMzU3LjkyQzkyNy40NCwzNTUuMjUgOTMwLjY5LDM1Mi4wNiA5MzIuNzcsMzQ4LjM0QzkzNC44NiwzNDQuNjMgOTM2LjE2LDM0MC44NyA5MzYuNjIsMzM3LjA2QzkzNy4xLDMzMy4yNSA5MzcuMzMsMzMwLjIgOTM3LjM0LDMyNy45Mkw5MzcuMzQsMzEyLjc3TDkzNy4zNSwzMTIuNzdaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTEwMDQuMjEsMjM3LjMzTDEwNDIuOCwyMzcuMzNMMTA0Mi44LDI1Ny45TDEwNDMuNjUsMjU3LjlDMTA0OC43OSwyNDkuMzMgMTA1NS40NiwyNDMuMDkgMTA2My42NSwyMzkuMTlDMTA3MS44NCwyMzUuMjggMTA4MC4yMywyMzMuMzMgMTA4OC43OSwyMzMuMzNDMTA5OS42NiwyMzMuMzMgMTEwOC41NiwyMzQuODEgMTExNS41MiwyMzcuNzZDMTEyMi40NywyNDAuNzIgMTEyNy45NCwyNDQuODEgMTEzMS45NSwyNTAuMDVDMTEzNS45NSwyNTUuMjkgMTEzOC43NiwyNjEuNjcgMTE0MC4zOCwyNjkuMTlDMTE0MiwyNzYuNzIgMTE0Mi44MSwyODUuMDUgMTE0Mi44MSwyOTQuMkwxMTQyLjgxLDM4NS4wN0wxMTAyLjI0LDM4NS4wN0wxMTAyLjI0LDMwMS42M0MxMTAyLjI0LDI4OS40MyAxMTAwLjMzLDI4MC4zNCAxMDk2LjUzLDI3NC4zNEMxMDkyLjcxLDI2OC4zNCAxMDg1Ljk1LDI2NS4zNCAxMDc2LjIzLDI2NS4zNEMxMDY1LjE4LDI2NS4zNCAxMDU3LjE5LDI2OC42MyAxMDUyLjIzLDI3NS4yQzEwNDcuMjcsMjgxLjc2IDEwNDQuOCwyOTIuNTggMTA0NC44LDMwNy42M0wxMDQ0LjgsMzg1LjA3TDEwMDQuMjIsMzg1LjA3TDEwMDQuMjIsMjM3LjMzTDEwMDQuMjEsMjM3LjMzWiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik02MTIuMzcsMjExLjg0TDYxMi4zNywzODUuMDdMNjUyLjk1LDM4NS4wN0w2NTIuOTUsMjM0LjIxQzYzOS45MywyMjYuMjMgNjI2LjM2LDIxOC43NCA2MTIuMzcsMjExLjg0WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOTguNDMsMjE5LjIxQzIyMS45NSwxNTAuMzIgMzYyLjU4LDEyNS4wNSA1MTIuNTgsMTYyLjc4QzYwMi41NSwxODUuNCA2NzYuMDcsMjI5LjI4IDcyNC4wOSwyNzIuNjdDNzAyLjMsMjE1LjEyIDU5Ni42NSwxMzMuMDggNDUxLjE4LDEwNC45NkMyODYuNyw3My4xNiAxMjQuNDcsMTAxLjExIDEwNC4zOSwxNzQuMUM4OS44OSwyMjYuODMgMTUzLjU3LDI4OC42IDI1Mi4wNSwzMzAuODRDMjA3LjgxLDI5NS4wMiAxODYuMjksMjU0Ljc4IDE5OC40MywyMTkuMjFaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTcyNC4xNiwyNDcuNjJMNzI0LjE2LDE4MS4wM0w2ODMuNTcsMTgxLjAzTDY4My41NywyMDEuMjVDNzAwLjg4LDIxNi43MSA3MTQuNjEsMjMyLjQ1IDcyNC4xNiwyNDcuNjJaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS4wNDY5NiwwLDAsMS4xMjU3NywtNDYuOTkxMywtNTAuNDMyNSkiPgogICAgICAgICAgICA8cGF0aCBkPSJNMTIxNC45OCwzNjMuNDNDMTIxNC45OCwzNzUuNjkgMTIwNS4zNSwzODUuMzIgMTE5Mi44MywzODUuMzJDMTE4MC40MywzODUuMzIgMTE3MC41NCwzNzUuNjkgMTE3MC41NCwzNjMuNDNDMTE3MC41NCwzNTEuNDMgMTE4MC40MywzNDEuOCAxMTkyLjgzLDM0MS44QzEyMDUuMzUsMzQxLjggMTIxNC45OCwzNTEuNDMgMTIxNC45OCwzNjMuNDNaTTExNzYuMDgsMzYzLjQzQzExNzYuMDgsMzczLjA2IDExODMuMiwzODAuNyAxMTkyLjk2LDM4MC43QzEyMDIuNDUsMzgwLjcgMTIwOS40NCwzNzMuMDUgMTIwOS40NCwzNjMuNTZDMTIwOS40NCwzNTMuOTMgMTIwMi40NSwzNDYuMTUgMTE5Mi44MiwzNDYuMTVDMTE4My4yLDM0Ni4xNiAxMTc2LjA4LDM1My45NCAxMTc2LjA4LDM2My40M1pNMTE4OS4zOSwzNzQuNzdMMTE4NC4zOCwzNzQuNzdMMTE4NC4zOCwzNTMuMTRDMTE4Ni4zNiwzNTIuNzQgMTE4OS4xMywzNTIuNDggMTE5Mi42OSwzNTIuNDhDMTE5Ni43OCwzNTIuNDggMTE5OC42MiwzNTMuMTQgMTIwMC4yMSwzNTQuMDZDMTIwMS40LDM1NC45OCAxMjAyLjMyLDM1Ni43IDEyMDIuMzIsMzU4LjgxQzEyMDIuMzIsMzYxLjE4IDEyMDAuNDcsMzYzLjAzIDExOTcuODQsMzYzLjgyTDExOTcuODQsMzY0LjA4QzExOTkuOTUsMzY0Ljg3IDEyMDEuMTQsMzY2LjQ1IDEyMDEuOCwzNjkuMzVDMTIwMi40NiwzNzIuNjUgMTIwMi44NSwzNzMuOTcgMTIwMy4zOCwzNzQuNzZMMTE5Ny45NywzNzQuNzZDMTE5Ny4zMSwzNzMuOTcgMTE5Ni45MiwzNzEuOTkgMTE5Ni4yNiwzNjkuNDlDMTE5NS44NiwzNjcuMTIgMTE5NC41NSwzNjYuMDYgMTE5MS43OCwzNjYuMDZMMTE4OS40MSwzNjYuMDZMMTE4OS40MSwzNzQuNzdMMTE4OS4zOSwzNzQuNzdaTTExODkuNTMsMzYyLjUxTDExOTEuOSwzNjIuNTFDMTE5NC42NywzNjIuNTEgMTE5Ni45MSwzNjEuNTkgMTE5Ni45MSwzNTkuMzRDMTE5Ni45MSwzNTcuMzYgMTE5NS40NiwzNTYuMDQgMTE5Mi4yOSwzNTYuMDRDMTE5MC45NywzNTYuMDQgMTE5MC4wNSwzNTYuMTcgMTE4OS41MiwzNTYuM0wxMTg5LjUyLDM2Mi41MUwxMTg5LjUzLDM2Mi41MVoiIHN0eWxlPSJmaWxsOnJnYigxNzIsMjIsNDQpO2ZpbGwtcnVsZTpub256ZXJvOyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==" alt="Vulkan Logo" width="50%">
    </span>
</div>
<div id="header">
<h1>Vulkan<sup>®</sup> 1.0.299 - A Specification (with all ratified extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan  Working Group</span><br>
<span id="revnumber">version 1.0.299,</span>
<span id="revdate">2024-10-18 11:21:53Z</span>
<br><span id="revremark">from git branch: github-main commit: 46e04bb59e0f85b9124899e694a477dd9025d17c</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html">Titlepage</a></li><li><a href="chap1.html">1. Preamble</a></li>
<li><a href="chap2.html">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap2.html#introduction-conventions">2.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap3.html">3. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap3.html#fundamentals-host-environment">3.1. Host and Device Environment</a></li>
<li><a href="chap3.html#fundamentals-execmodel">3.2. Execution Model</a></li>
<li><a href="chap3.html#fundamentals-objectmodel-overview">3.3. Object Model</a></li>
<li><a href="chap3.html#fundamentals-abi">3.4. Application Binary Interface</a></li>
<li><a href="chap3.html#fundamentals-commandsyntax">3.5. Command Syntax and Duration</a></li>
<li><a href="chap3.html#fundamentals-threadingbehavior">3.6. Threading Behavior</a></li>
<li><a href="chap3.html#fundamentals-validusage">3.7. Valid Usage</a></li>
<li><a href="chap3.html#fundamentals-returncodes">3.8. <code>VkResult</code> Return Codes</a></li>
<li><a href="chap3.html#fundamentals-numerics">3.9. Numeric Representation and Computation</a></li>
<li><a href="chap3.html#fundamentals-fixedconv">3.10. Fixed-Point Data Conversions</a></li>
<li><a href="chap3.html#fundamentals-strings">3.11. String Representation</a></li>
<li><a href="chap3.html#fundamentals-common-objects">3.12. Common Object Types</a></li>
<li><a href="chap3.html#fundamentals-api-name-aliases">3.13. API Name Aliases</a></li>
</ul>
</li>
<li><a href="chap4.html">4. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap4.html#initialization-functionpointers">4.1. Command Function Pointers</a></li>
<li><a href="chap4.html#initialization-instances">4.2. Instances</a></li>
</ul>
</li>
<li><a href="chap5.html">5. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap5.html#devsandqueues-physical-device-enumeration">5.1. Physical Devices</a></li>
<li><a href="chap5.html#devsandqueues-devices">5.2. Devices</a></li>
<li><a href="chap5.html#devsandqueues-queues">5.3. Queues</a></li>
</ul>
</li>
<li><a href="chap6.html">6. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap6.html#commandbuffers-lifecycle">6.1. Command Buffer Lifecycle</a></li>
<li><a href="chap6.html#commandbuffers-pools">6.2. Command Pools</a></li>
<li><a href="chap6.html#commandbuffer-allocation">6.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap6.html#commandbuffers-recording">6.4. Command Buffer Recording</a></li>
<li><a href="chap6.html#commandbuffers-submission">6.5. Command Buffer Submission</a></li>
<li><a href="chap6.html#commandbuffers-submission-progress">6.6. Queue Forward Progress</a></li>
<li><a href="chap6.html#commandbuffers-secondary">6.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap6.html#commandbuffers-nested">6.8. Nested Command Buffers</a></li>
<li><a href="chap6.html#commandbuffers-devicemask">6.9. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap7.html">7. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap7.html#synchronization-dependencies">7.1. Execution and Memory Dependencies</a></li>
<li><a href="chap7.html#synchronization-implicit">7.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap7.html#synchronization-fences">7.3. Fences</a></li>
<li><a href="chap7.html#synchronization-semaphores">7.4. Semaphores</a></li>
<li><a href="chap7.html#synchronization-events">7.5. Events</a></li>
<li><a href="chap7.html#synchronization-pipeline-barriers">7.6. Pipeline Barriers</a></li>
<li><a href="chap7.html#synchronization-memory-barriers">7.7. Memory Barriers</a></li>
<li><a href="chap7.html#synchronization-wait-idle">7.8. Wait Idle Operations</a></li>
<li><a href="chap7.html#synchronization-submission-host-writes">7.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap7.html#synchronization-device-group">7.10. Synchronization and Multiple Physical Devices</a></li>
<li><a href="chap7.html#calibrated-timestamps">7.11. Calibrated Timestamps</a></li>
</ul>
</li>
<li><a href="chap8.html">8. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap8.html#renderpass-objects">8.1. Render Pass Objects</a></li>
<li><a href="chap8.html#renderpass-creation">8.2. Render Pass Creation</a></li>
<li><a href="chap8.html#renderpass-compatibility">8.3. Render Pass Compatibility</a></li>
<li><a href="chap8.html#_framebuffers">8.4. Framebuffers</a></li>
<li><a href="chap8.html#renderpass-load-operations">8.5. Render Pass Load Operations</a></li>
<li><a href="chap8.html#renderpass-store-operations">8.6. Render Pass Store Operations</a></li>
<li><a href="chap8.html#renderpass-resolve-operations">8.7. Render Pass Multisample Resolve Operations</a></li>
<li><a href="chap8.html#renderpass-commands">8.8. Render Pass Commands</a></li>
<li><a href="chap8.html#_common_render_pass_data_races_informative">8.9. Common Render Pass Data Races (Informative)</a></li>
</ul>
</li>
<li><a href="chap9.html">9. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap9.html#shaders-objects">9.1. Shader Objects</a></li>
<li><a href="chap9.html#shader-modules">9.2. Shader Modules</a></li>
<li><a href="chap9.html#shaders-binding">9.3. Binding Shaders</a></li>
<li><a href="chap9.html#shaders-execution">9.4. Shader Execution</a></li>
<li><a href="chap9.html#shaders-execution-memory-ordering">9.5. Shader Memory Access Ordering</a></li>
<li><a href="chap9.html#shaders-inputs">9.6. Shader Inputs and Outputs</a></li>
<li><a href="chap9.html#shaders-vertex">9.7. Vertex Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-control">9.8. Tessellation Control Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-evaluation">9.9. Tessellation Evaluation Shaders</a></li>
<li><a href="chap9.html#shaders-geometry">9.10. Geometry Shaders</a></li>
<li><a href="chap9.html#shaders-fragment">9.11. Fragment Shaders</a></li>
<li><a href="chap9.html#shaders-compute">9.12. Compute Shaders</a></li>
<li><a href="chap9.html#shaders-ray-generation">9.13. Ray Generation Shaders</a></li>
<li><a href="chap9.html#shaders-intersection">9.14. Intersection Shaders</a></li>
<li><a href="chap9.html#shaders-any-hit">9.15. Any-Hit Shaders</a></li>
<li><a href="chap9.html#shaders-closest-hit">9.16. Closest Hit Shaders</a></li>
<li><a href="chap9.html#shaders-miss">9.17. Miss Shaders</a></li>
<li><a href="chap9.html#shaders-callable">9.18. Callable Shaders</a></li>
<li><a href="chap9.html#shaders-interpolation-decorations">9.19. Interpolation Decorations</a></li>
<li><a href="chap9.html#shaders-staticuse">9.20. Static Use</a></li>
<li><a href="chap9.html#shaders-scope">9.21. Scope</a></li>
<li><a href="chap9.html#shaders-derivative-operations">9.22. Derivative Operations</a></li>
<li><a href="chap9.html#shaders-helper-invocations">9.23. Helper Invocations</a></li>
<li><a href="chap9.html#_cooperative_matrices">9.24. Cooperative Matrices</a></li>
</ul>
</li>
<li><a href="chap10.html">10. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap10.html#pipelines-multiple">10.1. Multiple Pipeline Creation</a></li>
<li><a href="chap10.html#pipelines-compute">10.2. Compute Pipelines</a></li>
<li><a href="chap10.html#pipelines-graphics">10.3. Graphics Pipelines</a></li>
<li><a href="chap10.html#pipelines-ray-tracing">10.4. Ray Tracing Pipelines</a></li>
<li><a href="chap10.html#pipelines-destruction">10.5. Pipeline Destruction</a></li>
<li><a href="chap10.html#pipelines-pipeline-derivatives">10.6. Pipeline Derivatives</a></li>
<li><a href="chap10.html#pipelines-cache">10.7. Pipeline Cache</a></li>
<li><a href="chap10.html#pipelines-binaries">10.8. Pipeline Binaries</a></li>
<li><a href="chap10.html#pipelines-specialization-constants">10.9. Specialization Constants</a></li>
<li><a href="chap10.html#pipelines-library">10.10. Pipeline Libraries</a></li>
<li><a href="chap10.html#pipelines-binding">10.11. Pipeline Binding</a></li>
<li><a href="chap10.html#pipelines-dynamic-state">10.12. Dynamic State</a></li>
<li><a href="chap10.html#pipelines-shader-information">10.13. Pipeline Properties and Shader Information</a></li>
</ul>
</li>
<li><a href="chap11.html">11. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#memory-host">11.1. Host Memory</a></li>
<li><a href="chap11.html#memory-device">11.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap12.html">12. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap12.html#resources-buffers">12.1. Buffers</a></li>
<li><a href="chap12.html#resources-buffer-views">12.2. Buffer Views</a></li>
<li><a href="chap12.html#resources-images">12.3. Images</a></li>
<li><a href="chap12.html#resources-image-layouts">12.4. Image Layouts</a></li>
<li><a href="chap12.html#resources-image-views">12.5. Image Views</a></li>
<li><a href="chap12.html#resources-acceleration-structures">12.6. Acceleration Structures</a></li>
<li><a href="chap12.html#resources-micromaps">12.7. Micromaps</a></li>
<li><a href="chap12.html#resources-association">12.8. Resource Memory Association</a></li>
<li><a href="chap12.html#resources-sharing">12.9. Resource Sharing Mode</a></li>
<li><a href="chap12.html#resources-memory-aliasing">12.10. Memory Aliasing</a></li>
</ul>
</li>
<li><a href="chap13.html">13. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap13.html#samplers-YCbCr-conversion">13.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> Conversion</a></li>
</ul>
</li>
<li><a href="chap14.html">14. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap14.html#descriptorsets-types">14.1. Descriptor Types</a></li>
<li><a href="chap14.html#descriptorsets-sets">14.2. Descriptor Sets</a></li>
<li><a href="chap14.html#descriptorsets-physical-storage-buffer">14.3. Physical Storage Buffer Access</a></li>
</ul>
</li>
<li><a href="chap15.html">15. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap15.html#interfaces-iointerfaces">15.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap15.html#interfaces-vertexinput">15.2. Vertex Input Interface</a></li>
<li><a href="chap15.html#interfaces-fragmentoutput">15.3. Fragment Output Interface</a></li>
<li><a href="chap15.html#interfaces-fragmenttileimage">15.4. Fragment Tile Image Interface</a></li>
<li><a href="chap15.html#interfaces-inputattachment">15.5. Fragment Input Attachment Interface</a></li>
<li><a href="chap15.html#interfaces-raypipeline">15.6. Ray Tracing Pipeline Interface</a></li>
<li><a href="chap15.html#interfaces-resources">15.7. Shader Resource Interface</a></li>
<li><a href="chap15.html#interfaces-builtin-variables">15.8. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap16.html">16. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_image_operations_overview">16.1. Image Operations Overview</a></li>
<li><a href="chap16.html#_conversion_formulas">16.2. Conversion Formulas</a></li>
<li><a href="chap16.html#textures-input">16.3. Texel Input Operations</a></li>
<li><a href="chap16.html#_texel_output_operations">16.4. Texel Output Operations</a></li>
<li><a href="chap16.html#textures-normalized-operations">16.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#_unnormalized_texel_coordinate_operations">16.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-integer-coordinate-operations">16.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-sample-operations">16.8. Image Sample Operations</a></li>
<li><a href="chap16.html#textures-instructions">16.9. Image Operation Steps</a></li>
<li><a href="chap16.html#textures-queries">16.10. Image Query Instructions</a></li>
</ul>
</li>
<li><a href="chap17.html">17. Queries</a>
<ul class="sectlevel2">
<li><a href="chap17.html#queries-pools">17.1. Query Pools</a></li>
<li><a href="chap17.html#queries-operation">17.2. Query Operation</a></li>
<li><a href="chap17.html#queries-occlusion">17.3. Occlusion Queries</a></li>
<li><a href="chap17.html#queries-pipestats">17.4. Pipeline Statistics Queries</a></li>
<li><a href="chap17.html#queries-timestamps">17.5. Timestamp Queries</a></li>
<li><a href="chap17.html#queries-performance">17.6. Performance Queries</a></li>
<li><a href="chap17.html#queries-transform-feedback">17.7. Transform Feedback Queries</a></li>
<li><a href="chap17.html#queries-result-status-only">17.8. Result Status Queries</a></li>
<li><a href="chap17.html#queries-video-encode-feedback">17.9. Video Encode Feedback Queries</a></li>
</ul>
</li>
<li><a href="chap18.html">18. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#clears-outside">18.1. Clearing Images Outside a Render Pass Instance</a></li>
<li><a href="chap18.html#clears-inside">18.2. Clearing Images Inside a Render Pass Instance</a></li>
<li><a href="chap18.html#clears-values">18.3. Clear Values</a></li>
<li><a href="chap18.html#clears-filling-buffers">18.4. Filling Buffers</a></li>
<li><a href="chap18.html#clears-updating-buffers">18.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap19.html">19. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#copies-buffers">19.1. Copying Data Between Buffers</a></li>
<li><a href="chap19.html#copies-images">19.2. Copying Data Between Images</a></li>
<li><a href="chap19.html#copies-buffers-images">19.3. Copying Data Between Buffers and Images</a></li>
<li><a href="chap19.html#copies-imagescaling">19.4. Image Copies With Scaling</a></li>
<li><a href="chap19.html#copies-resolve">19.5. Resolving Multisample Images</a></li>
</ul>
</li>
<li><a href="chap20.html">20. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#drawing-primitive-topologies">20.1. Primitive Topologies</a></li>
<li><a href="chap20.html#drawing-primitive-order">20.2. Primitive Order</a></li>
<li><a href="chap20.html#drawing-primitive-shading">20.3. Programmable Primitive Shading</a></li>
</ul>
</li>
<li><a href="chap21.html">21. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap21.html#fxvertex-attrib">21.1. Vertex Attributes</a></li>
<li><a href="chap21.html#fxvertex-input">21.2. Vertex Input Description</a></li>
<li><a href="chap21.html#fxvertex-attribute_divisor">21.3. Vertex Attribute Divisor in Instanced Rendering</a></li>
<li><a href="chap21.html#fxvertex-input-address-calculation">21.4. Vertex Input Address Calculation</a></li>
</ul>
</li>
<li><a href="chap22.html">22. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap22.html#_tessellator">22.1. Tessellator</a></li>
<li><a href="chap22.html#_tessellator_patch_discard">22.2. Tessellator Patch Discard</a></li>
<li><a href="chap22.html#tessellation-tessellator-spacing">22.3. Tessellator Spacing</a></li>
<li><a href="chap22.html#tessellation-primitive-order">22.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap22.html#tessellation-vertex-winding-order">22.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap22.html#tessellation-triangle-tessellation">22.6. Triangle Tessellation</a></li>
<li><a href="chap22.html#tessellation-quad-tessellation">22.7. Quad Tessellation</a></li>
<li><a href="chap22.html#tessellation-isoline-tessellation">22.8. Isoline Tessellation</a></li>
<li><a href="chap22.html#tessellation-point-mode">22.9. Tessellation Point Mode</a></li>
<li><a href="chap22.html#_tessellation_pipeline_state">22.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap23.html">23. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#geometry-input">23.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap23.html#geometry-output">23.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap23.html#geometry-invocations">23.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap23.html#geometry-ordering">23.4. Geometry Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap24.html">24. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap24.html#vertexpostproc-transform-feedback">24.1. Transform Feedback</a></li>
<li><a href="chap24.html#vertexpostproc-flatshading">24.2. Flat Shading</a></li>
<li><a href="chap24.html#vertexpostproc-clipping">24.3. Primitive Clipping</a></li>
<li><a href="chap24.html#vertexpostproc-clipping-shader-outputs">24.4. Clipping Shader Outputs</a></li>
<li><a href="chap24.html#vertexpostproc-coord-transform">24.5. Coordinate Transformations</a></li>
<li><a href="chap24.html#vertexpostproc-viewport">24.6. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap25.html">25. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap25.html#primsrast-discard">25.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap25.html#primsrast-stream">25.2. Controlling the Vertex Stream Used for Rasterization</a></li>
<li><a href="chap25.html#primsrast-order">25.3. Rasterization Order</a></li>
<li><a href="chap25.html#primsrast-multisampling">25.4. Multisampling</a></li>
<li><a href="chap25.html#primsrast-samplelocations">25.5. Custom Sample Locations</a></li>
<li><a href="chap25.html#primsrast-fragment-shading-rate">25.6. Fragment Shading Rates</a></li>
<li><a href="chap25.html#primsrast-sampleshading">25.7. Sample Shading</a></li>
<li><a href="chap25.html#primsrast-barycentric">25.8. Barycentric Interpolation</a></li>
<li><a href="chap25.html#primsrast-points">25.9. Points</a></li>
<li><a href="chap25.html#primsrast-lines">25.10. Line Segments</a></li>
<li><a href="chap25.html#primsrast-polygons">25.11. Polygons</a></li>
</ul>
</li>
<li><a href="chap26.html">26. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap26.html#fragops-discard-rectangles">26.1. Discard Rectangles Test</a></li>
<li><a href="chap26.html#fragops-scissor">26.2. Scissor Test</a></li>
<li><a href="chap26.html#fragops-samplemask">26.3. Sample Mask Test</a></li>
<li><a href="chap26.html#fragops-shader">26.4. Fragment Shading</a></li>
<li><a href="chap26.html#fragops-covg">26.5. Multisample Coverage</a></li>
<li><a href="chap26.html#fragops-ds-state">26.6. Depth and Stencil Operations</a></li>
<li><a href="chap26.html#fragops-dbt">26.7. Depth Bounds Test</a></li>
<li><a href="chap26.html#fragops-stencil">26.8. Stencil Test</a></li>
<li><a href="chap26.html#fragops-depth">26.9. Depth Test</a></li>
<li><a href="chap26.html#fragops-samplecount">26.10. Sample Counting</a></li>
<li><a href="chap26.html#fragops-coverage-reduction">26.11. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap27.html">27. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap27.html#framebuffer-blending">27.1. Blending</a></li>
<li><a href="chap27.html#framebuffer-logicop">27.2. Logical Operations</a></li>
<li><a href="chap27.html#framebuffer-color-write-mask">27.3. Color Write Mask</a></li>
<li><a href="chap27.html#framebuffer-color-write-enable">27.4. Color Write Enable</a></li>
</ul>
</li>
<li><a href="chap28.html">28. Dispatching Commands</a></li>
<li><a href="chap29.html">29. Device-Generated Commands</a>
<ul class="sectlevel2">
<li><a href="chap29.html#indirectmdslayout">29.1. Indirect Commands Layout</a></li>
<li><a href="chap29.html#_indirect_commands_generation_and_execution">29.2. Indirect Commands Generation and Execution</a></li>
</ul>
</li>
<li><a href="chap30.html">30. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap30.html#sparsememory-sparseresourcefeatures">30.1. Sparse Resource Features</a></li>
<li><a href="chap30.html#sparsememory-fully-resident">30.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap30.html#sparsememory-partially-resident-buffers">30.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap30.html#sparsememory-partially-resident-images">30.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap30.html#sparsememory-sparse-memory-aliasing">30.5. Sparse Memory Aliasing</a></li>
<li><a href="chap30.html#_sparse_resource_implementation_guidelines_informative">30.6. Sparse Resource Implementation Guidelines (Informative)</a></li>
<li><a href="chap30.html#sparsememory-resourceapi">30.7. Sparse Resource API</a></li>
</ul>
</li>
<li><a href="chap31.html">31. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap31.html#_wsi_platform">31.1. WSI Platform</a></li>
<li><a href="chap31.html#_wsi_surface">31.2. WSI Surface</a></li>
<li><a href="chap31.html#display">31.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap31.html#_querying_for_wsi_support">31.4. Querying for WSI Support</a></li>
<li><a href="chap31.html#_surface_queries">31.5. Surface Queries</a></li>
<li><a href="chap31.html#_full_screen_exclusive_control">31.6. Full Screen Exclusive Control</a></li>
<li><a href="chap31.html#_device_group_queries">31.7. Device Group Queries</a></li>
<li><a href="chap31.html#present-wait">31.8. Present Wait</a></li>
<li><a href="chap31.html#_wsi_swapchain">31.9. WSI Swapchain</a></li>
<li><a href="chap31.html#_hdr_metadata">31.10. HDR Metadata</a></li>
</ul>
</li>
<li><a href="chap32.html">32. Deferred Host Operations</a>
<ul class="sectlevel2">
<li><a href="chap32.html#deferred-host-operations-requesting">32.1. Requesting Deferral</a></li>
<li><a href="chap32.html#_deferred_host_operations_api">32.2. Deferred Host Operations API</a></li>
</ul>
</li>
<li><a href="chap33.html">33. Acceleration Structures</a>
<ul class="sectlevel2">
<li><a href="chap33.html#acceleration-structure-def">33.1. Acceleration Structures</a></li>
<li><a href="chap33.html#host-acceleration-structure">33.2. Host Acceleration Structure Operations</a></li>
</ul>
</li>
<li class="current"><a href="chap34.html">34. Micromap</a>
<ul class="sectlevel2">
<li class="current"><a href="chap34.html#micromap-def">34.1. Micromaps</a></li>
<li class="current"><a href="chap34.html#host-micromap">34.2. Host Micromap Operations</a></li>
</ul>
</li>
<li><a href="chap35.html">35. Ray Traversal</a>
<ul class="sectlevel2">
<li><a href="chap35.html#ray-intersection-candidate-determination">35.1. Ray Intersection Candidate Determination</a></li>
<li><a href="chap35.html#ray-intersection-culling">35.2. Ray Intersection Culling</a></li>
<li><a href="chap35.html#ray-intersection-confirmation">35.3. Ray Intersection Confirmation</a></li>
<li><a href="chap35.html#ray-closest-hit-determination">35.4. Ray Closest Hit Determination</a></li>
<li><a href="chap35.html#ray-result-determination">35.5. Ray Result Determination</a></li>
</ul>
</li>
<li><a href="chap36.html">36. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="chap36.html#ray-tracing-shader-call">36.1. Shader Call Instructions</a></li>
<li><a href="chap36.html#ray-tracing-commands">36.2. Ray Tracing Commands</a></li>
<li><a href="chap36.html#shader-binding-table">36.3. Shader Binding Table</a></li>
<li><a href="chap36.html#ray-tracing-pipeline-stack">36.4. Ray Tracing Pipeline Stack</a></li>
<li><a href="chap36.html#ray-tracing-capture-replay">36.5. Ray Tracing Capture Replay</a></li>
</ul>
</li>
<li><a href="chap37.html">37. Video Coding</a>
<ul class="sectlevel2">
<li><a href="chap37.html#video-picture-resources">37.1. Video Picture Resources</a></li>
<li><a href="chap37.html#dpb">37.2. Decoded Picture Buffer</a></li>
<li><a href="chap37.html#video-profiles">37.3. Video Profiles</a></li>
<li><a href="chap37.html#video-capabilities">37.4. Video Capabilities</a></li>
<li><a href="chap37.html#video-session">37.5. Video Sessions</a></li>
<li><a href="chap37.html#video-profile-compatibility">37.6. Video Profile Compatibility</a></li>
<li><a href="chap37.html#video-session-parameters">37.7. Video Session Parameters</a></li>
<li><a href="chap37.html#video-coding-scope">37.8. Video Coding Scope</a></li>
<li><a href="chap37.html#video-coding-control">37.9. Video Coding Control</a></li>
<li><a href="chap37.html#video-inline-queries">37.10. Inline Queries</a></li>
<li><a href="chap37.html#video-decode-operations">37.11. Video Decode Operations</a></li>
<li><a href="chap37.html#decode-h264">37.12. H.264 Decode Operations</a></li>
<li><a href="chap37.html#decode-h265">37.13. H.265 Decode Operations</a></li>
<li><a href="chap37.html#decode-av1">37.14. AV1 Decode Operations</a></li>
<li><a href="chap37.html#video-encode-operations">37.15. Video Encode Operations</a></li>
<li><a href="chap37.html#encode-rate-control">37.16. Video Encode Rate Control</a></li>
<li><a href="chap37.html#encode-h264">37.17. H.264 Encode Operations</a></li>
<li><a href="chap37.html#encode-h265">37.18. H.265 Encode Operations</a></li>
</ul>
</li>
<li><a href="chap38.html">38. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap38.html#extendingvulkan-instanceanddevicefunctionality">38.1. Instance and Device Functionality</a></li>
<li><a href="chap38.html#extendingvulkan-coreversions">38.2. Core Versions</a></li>
<li><a href="chap38.html#extendingvulkan-layers">38.3. Layers</a></li>
<li><a href="chap38.html#extendingvulkan-extensions">38.4. Extensions</a></li>
<li><a href="chap38.html#extendingvulkan-extensions-extensiondependencies">38.5. Extension Dependencies</a></li>
<li><a href="chap38.html#_compatibility_guarantees_informative">38.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap39.html">39. Features</a>
<ul class="sectlevel2">
<li><a href="chap39.html#features-requirements">39.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap40.html">40. Limits</a>
<ul class="sectlevel2">
<li><a href="chap40.html#limits-minmax">40.1. Limit Requirements</a></li>
<li><a href="chap40.html#limits-multisample">40.2. Additional Multisampling Capabilities</a></li>
</ul>
</li>
<li><a href="chap41.html">41. Formats</a>
<ul class="sectlevel2">
<li><a href="chap41.html#formats-definition">41.1. Format Definition</a></li>
<li><a href="chap41.html#formats-properties">41.2. Format Properties</a></li>
<li><a href="chap41.html#features-required-format-support">41.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap42.html">42. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap42.html#capabilities-image">42.1. Additional Image Capabilities</a></li>
<li><a href="chap42.html#capabilities-buffer">42.2. Additional Buffer Capabilities</a></li>
<li><a href="chap42.html#capabilities-semaphore">42.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap42.html#capabilities-fence">42.4. Optional Fence Capabilities</a></li>
<li><a href="chap42.html#features-timestamp-calibration">42.5. Timestamp Calibration Capabilities</a></li>
</ul>
</li>
<li><a href="chap43.html">43. Debugging</a>
<ul class="sectlevel2">
<li><a href="chap43.html#_frame_boundary">43.1. Frame Boundary</a></li>
</ul>
</li>
<li><a href="chap44.html">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap44.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap44.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap44.html#spirvenv-module-validation">Validation Rules Within a Module</a></li>
<li><a href="chap44.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap44.html#spirvenv-image-signedness">Signedness of SPIR-V Image Accesses</a></li>
<li><a href="chap44.html#spirvenv-format-type-matching">Image Format and Type Matching</a></li>
<li><a href="chap44.html#spirvenv-image-dimensions">Compatibility Between SPIR-V Image Dimensions and Vulkan ImageView Types</a></li>
<li><a href="chap44.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats and Vulkan Formats</a></li>
<li><a href="chap44.html#spirenv-ray-query-precision-operation">Ray Query Precision and Operation</a></li>
</ul>
</li>
<li><a href="chap45.html">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap45.html#memory-model-agent">Agent</a></li>
<li><a href="chap45.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap45.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap45.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap45.html#memory-model-references">Reference</a></li>
<li><a href="chap45.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap45.html#shader-call-related">Shader Call Related</a></li>
<li><a href="chap45.html#shader-call-order">Shader Call Order</a></li>
<li><a href="chap45.html#memory-model-scope">Scope</a></li>
<li><a href="chap45.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap45.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap45.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap45.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap45.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap45.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap45.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap45.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap45.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap45.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap45.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap45.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap45.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap45.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap45.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap45.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap45.html#memory-model-acyclicity">Acyclicity</a></li>
<li><a href="chap45.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap45.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap45.html#memory-model-informative-descriptions">Descriptions (Informative)</a></li>
<li><a href="chap45.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
<li><a href="chap45.html#memory-model-cooperative-matrix">Cooperative Matrix Memory Access</a></li>
</ul>
</li>
<li><a href="chap46.html">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap46.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap46.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap46.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap47.html">Appendix D: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap47.html#versions-1.0">Vulkan Version 1.0</a></li>
</ul>
</li>
<li><a href="chap48.html">Appendix E: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap48.html#_extension_dependencies">Extension Dependencies</a></li>
<li><a href="chap48.html#_extension_interactions">Extension Interactions</a></li>
<li><a href="chap48.html#current-extension-appendices-list">List of Current Extensions</a></li>
<li><a href="chap48.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
<li><a href="chap48.html#deprecated-extension-appendices-list">List of Deprecated Extensions</a></li>
</ul>
</li>
<li><a href="chap49.html">Appendix F: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap49.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap49.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap49.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
<li><a href="chap49.html#boilerplate-video-std-headers">Video Std Headers</a></li>
</ul>
</li>
<li><a href="chap50.html">Appendix G: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap50.html#_repeatability">Repeatability</a></li>
<li><a href="chap50.html#_multi_pass_algorithms">Multi-Pass Algorithms</a></li>
<li><a href="chap50.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap50.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap51.html">Appendix H: Lexicon</a>
<ul class="sectlevel2">
<li><a href="chap51.html#glossary">Glossary</a></li>
<li><a href="chap51.html#lexicon-common-abbreviations">Common Abbreviations</a></li>
<li><a href="chap51.html#lexicon-video-abbreviations">Video-Specific Abbreviations</a></li>
<li><a href="chap51.html#lexicon-prefixes">Prefixes</a></li>
</ul>
</li>
<li><a href="chap52.html">Appendix I: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap52.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap52.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="loading_msg" class="hidden" hidden=""><p>Loading… please wait.</p></div>
<!--ChunkedSearchboxMarker-->
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
<div id="content" class="loadable"><div class="sect1">
<h2 id="micromap"><a class="anchor" href="chap34.html"></a>34. Micromap</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="micromap-def"><a class="anchor" href="chap34.html#micromap-def"></a>34.1. Micromaps</h3>
<div class="paragraph">
<p><em>Acceleration structures</em> store and organize geometry for ray tracing, but
in some cases it is beneficial to include some information within the
geometry, particularly for triangles.
A <em>micromap</em> organizes this data around a map of values corresponding to
subdivided microtriangles which can be added to a triangle geometry when
building a <em>bottom level acceleration structure</em>.</p>
</div>
<div class="paragraph">
<p>An <em>opacity micromap</em> is a type of micromap which stores information to
control intersection opacity as described in <a href="chap35.html#ray-opacity-micromap">Ray
Opacity Micromap</a>.</p>
</div>
<div class="paragraph">
<p>A micromap is considered to be constructed if a <a href="chap34.html#micromap-building">micromap
build command</a> or <a href="chap34.html#micromap-copying">copy command</a> has been executed with
the given acceleration structure as the destination.</p>
</div>
<div class="sect3">
<h4 id="micromap-building"><a class="anchor" href="chap34.html#micromap-building"></a>34.1.1. Building Micromaps</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build micromaps call:</p>
</div>
<div id="vkCmdBuildMicromapsEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="kt">void</span> <span class="nf">vkCmdBuildMicromapsEXT</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">infoCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMicromapBuildInfoEXT</span><span class="o">*</span>               <span class="n">pInfos</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>infoCount</code> is the number of micromaps to build.
It specifies the number of the <code>pInfos</code> structures that <strong class="purple">must</strong> be
provided.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a> structures defining the data used to build
each micromap.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vkCmdBuildMicromapsEXT</code> command provides the ability to initiate
multiple micromaps builds, however there is no ordering or synchronization
implied between any of the individual micromap builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This means that there <strong class="purple">cannot</strong> be any memory aliasing between any micromap
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="micromap-scratch" class="paragraph">
<p>Accesses to the micromap scratch buffers as identified by the
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a>::<code>scratchData</code> buffer device addresses
<strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
(<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code> |
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>).
Accesses to <a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a>::<code>dstMicromap</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code>.</p>
</div>
<div class="paragraph">
<p>Accesses to other input buffers as identified by any used values of
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a>::<code>data</code> or
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a>::<code>triangleArray</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_SHADER_READ_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07461" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07461"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07461</span><br>

For each <code>pInfos</code>[i], <code>dstMicromap</code> <strong class="purple">must</strong> have been created with
a value of <a href="chap12.html#VkMicromapCreateInfoEXT">VkMicromapCreateInfoEXT</a>::<code>size</code> greater than or
equal to the memory size required by the build operation, as returned by
<a href="chap12.html#vkGetMicromapBuildSizesEXT">vkGetMicromapBuildSizesEXT</a> with <span class="eq"><code>pBuildInfo</code> =
<code>pInfos</code>[i]</span></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-mode-07462" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-mode-07462"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-mode-07462</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="chap34.html#VkBuildMicromapModeEXT">VkBuildMicromapModeEXT</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-dstMicromap-07463" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-dstMicromap-07463"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-dstMicromap-07463</span><br>

The <code>dstMicromap</code> member of any element of <code>pInfos</code> <strong class="purple">must</strong> be a
valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07464" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07464"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07464</span><br>

For each element of <code>pInfos</code> its <code>type</code> member <strong class="purple">must</strong> match the
value of <a href="chap12.html#VkMicromapCreateInfoEXT">VkMicromapCreateInfoEXT</a>::<code>type</code> when its
<code>dstMicromap</code> was created</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-dstMicromap-07465" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-dstMicromap-07465"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-dstMicromap-07465</span><br>

The range of memory backing the <code>dstMicromap</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>dstMicromap</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-dstMicromap-07466" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-dstMicromap-07466"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-dstMicromap-07466</span><br>

The range of memory backing the <code>dstMicromap</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any element of
<code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-scratchData-07467" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-scratchData-07467"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-scratchData-07467</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07508" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07508"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07508</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstMicromap</code> member <strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07509" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07509"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07509</span><br>

If <code>pInfos</code>[i].<code>mode</code> is <code>VK_BUILD_MICROMAP_MODE_BUILD_EXT</code>,
all addresses between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code>
and <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> +  N - 1 <strong class="purple">must</strong>
be in the buffer device address range of the same buffer, where N is
given by the <code>buildScratchSize</code> member of the
<a href="chap12.html#VkMicromapBuildSizesInfoEXT">VkMicromapBuildSizesInfoEXT</a> structure returned from a call to
<a href="chap12.html#vkGetMicromapBuildSizesEXT">vkGetMicromapBuildSizesEXT</a> with an identical
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a> structure and primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-data-07510" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-data-07510"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-data-07510</span><br>

The buffers from which the buffer device addresses for all of the
<code>data</code> and <code>triangleArray</code> members of all <code>pInfos</code>[i] are
queried <strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_MICROMAP_BUILD_INPUT_READ_ONLY_BIT_EXT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07511" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07511"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07511</span><br>

For each element of <code>pInfos</code>[i] the buffer from which the buffer
device address <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> is
queried <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_STORAGE_BUFFER_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07512" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07512"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07512</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>,
<code>data.deviceAddress</code>, and <code>triangleArray.deviceAddress</code> members
<strong class="purple">must</strong> be valid device addresses obtained from
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07513" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07513"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07513</span><br>

For each element of <code>pInfos</code>, if <code>scratchData.deviceAddress</code>,
<code>data.deviceAddress</code>, or <code>triangleArray.deviceAddress</code> is the
address of a non-sparse buffer then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07514" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07514"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07514</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a multiple of
<a href="chap40.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>minAccelerationStructureScratchOffsetAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-07515" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-07515"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-07515</span><br>

For each element of <code>pInfos</code>, its <code>triangleArray.deviceAddress</code>
and <code>data.deviceAddress</code> members <strong class="purple">must</strong> be a multiple of <code>256</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-commandBuffer-parameter" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-pInfos-parameter" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-pInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-commandBuffer-recording" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-commandBuffer-cmdpool" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-renderpass" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-renderpass"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-videocoding" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-videocoding"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildMicromapsEXT-infoCount-arraylength" href="chap34.html#VUID-vkCmdBuildMicromapsEXT-infoCount-arraylength"></a> <span class="vuid">VUID-vkCmdBuildMicromapsEXT-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap37.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Formats which <strong class="purple">can</strong> be set in <a href="chap34.html#VkMicromapUsageEXT">VkMicromapUsageEXT</a>::<code>format</code> and
<a href="chap34.html#VkMicromapTriangleEXT">VkMicromapTriangleEXT</a>::<code>format</code> for micromap builds, are:</p>
</div>
<div id="VkOpacityMicromapFormatEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkOpacityMicromapFormatEXT</span> <span class="p">{</span>
    <span class="n">VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkOpacityMicromapFormatEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</code> indicates that the given
micromap format has one bit per subtriangle encoding either fully opaque
or fully transparent.</p>
</li>
<li>
<p><code>VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</code> indicates that the given
micromap format has two bits per subtriangle encoding four modes which
can be interpreted as described in <a href="chap35.html#ray-opacity-micromap">ray
traversal</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For compactness, these values are stored as 16-bit in some structures.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMicromapBuildInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkMicromapBuildInfoEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkMicromapBuildInfoEXT</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                     <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                         <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkMicromapTypeEXT</span>                   <span class="n">type</span><span class="p">;</span>
    <span class="n">VkBuildMicromapFlagsEXT</span>             <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkBuildMicromapModeEXT</span>              <span class="n">mode</span><span class="p">;</span>
    <span class="n">VkMicromapEXT</span>                       <span class="n">dstMicromap</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                            <span class="n">usageCountsCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkMicromapUsageEXT</span><span class="o">*</span>           <span class="n">pUsageCounts</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkMicromapUsageEXT</span><span class="o">*</span> <span class="k">const</span><span class="o">*</span>    <span class="n">ppUsageCounts</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>       <span class="n">data</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressKHR</span>            <span class="n">scratchData</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>       <span class="n">triangleArray</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                        <span class="n">triangleArrayStride</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkMicromapBuildInfoEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>type</code> is a <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> value specifying the type of
micromap being built.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap12.html#VkBuildMicromapFlagBitsEXT">VkBuildMicromapFlagBitsEXT</a> specifying
additional parameters of the micromap.</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap34.html#VkBuildMicromapModeEXT">VkBuildMicromapModeEXT</a> value specifying the type
of operation to perform.</p>
</li>
<li>
<p><code>dstMicromap</code> is a pointer to the target micromap for the build.</p>
</li>
<li>
<p><code>usageCountsCount</code> specifies the number of usage counts structures
that will be used to determine the size of this micromap.</p>
</li>
<li>
<p><code>pUsageCounts</code> is a pointer to an array of <a href="chap34.html#VkMicromapUsageEXT">VkMicromapUsageEXT</a>
structures.</p>
</li>
<li>
<p><code>ppUsageCounts</code> is a pointer to an array of pointers to
<a href="chap34.html#VkMicromapUsageEXT">VkMicromapUsageEXT</a> structures.</p>
</li>
<li>
<p><code>data</code> is the device or host address to memory which contains the
data for the micromap.</p>
</li>
<li>
<p><code>scratchData</code> is the device or host address to memory that will be
used as scratch memory for the build.</p>
</li>
<li>
<p><code>triangleArray</code> is the device or host address to memory containing
the <a href="chap34.html#VkMicromapTriangleEXT">VkMicromapTriangleEXT</a> data</p>
</li>
<li>
<p><code>triangleArrayStride</code> is the stride in bytes between each element of
<code>triangleArray</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only one of <code>pUsageCounts</code> or <code>ppUsageCounts</code> <strong class="purple">can</strong> be a valid
pointer, the other <strong class="purple">must</strong> be <code>NULL</code>.
The elements of the non-<code>NULL</code> array describe the total counts used to build
each micromap.
Each element contains a <code>count</code> which is the number of micromap
triangles of that <code>format</code> and <code>subdivisionLevel</code> contained in the
micromap.
Multiple elements with the same <code>format</code> and <code>subdivisionLevel</code> are
allowed and the total count for that <code>format</code> and <code>subdivisionLevel</code>
is the sum of the <code>count</code> for each element.</p>
</div>
<div class="paragraph">
<p>Each micromap triangle refers to one element in <code>triangleArray</code> which
contains the <code>format</code> and <code>subdivisionLevel</code> for that particular
triangle as well as a <code>dataOffset</code> in bytes which is the location
relative to <code>data</code> where that triangle’s micromap data begins.
The data at <code>triangleArray</code> is laid out as a 4 byte unsigned integer for
the <code>dataOffset</code> followed by a 2 byte unsigned integer for the
subdivision level then a 2 byte unsigned integer for the format.
In practice, compilers compile <a href="chap34.html#VkMicromapTriangleEXT">VkMicromapTriangleEXT</a> to match this
pattern.</p>
</div>
<div class="paragraph">
<p>For opacity micromaps, the data at <code>data</code> is packed as either one bit
per element for <code>VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</code> or two bits per
element for <code>VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</code> and is packed from
LSB to MSB in each byte.
The data at each index in those bytes is interpreted as discussed in
<a href="chap35.html#ray-opacity-micromap">Ray Opacity Micromap</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-pUsageCounts-07516" href="chap34.html#VUID-VkMicromapBuildInfoEXT-pUsageCounts-07516"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-pUsageCounts-07516</span><br>

Only one of <code>pUsageCounts</code> or <code>ppUsageCounts</code> <strong class="purple">can</strong> be a valid
pointer, the other <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-type-07517" href="chap34.html#VUID-VkMicromapBuildInfoEXT-type-07517"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-type-07517</span><br>

If <code>type</code> is <code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> the
<code>format</code> member of <a href="chap34.html#VkMicromapUsageEXT">VkMicromapUsageEXT</a> <strong class="purple">must</strong> be a valid value
from <code>VkOpacityMicromapFormatEXT</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-type-07518" href="chap34.html#VUID-VkMicromapBuildInfoEXT-type-07518"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-type-07518</span><br>

If <code>type</code> is <code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> the
<code>format</code> member of <a href="chap34.html#VkMicromapTriangleEXT">VkMicromapTriangleEXT</a> <strong class="purple">must</strong> be a valid
value from <code>VkOpacityMicromapFormatEXT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-sType-sType" href="chap34.html#VUID-VkMicromapBuildInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MICROMAP_BUILD_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-pNext-pNext" href="chap34.html#VUID-VkMicromapBuildInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-type-parameter" href="chap34.html#VUID-VkMicromapBuildInfoEXT-type-parameter"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-type-parameter</span><br>
 <code>type</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> value</p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-flags-parameter" href="chap34.html#VUID-VkMicromapBuildInfoEXT-flags-parameter"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap12.html#VkBuildMicromapFlagBitsEXT">VkBuildMicromapFlagBitsEXT</a> values</p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-pUsageCounts-parameter" href="chap34.html#VUID-VkMicromapBuildInfoEXT-pUsageCounts-parameter"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-pUsageCounts-parameter</span><br>
 If <code>usageCountsCount</code> is not <code>0</code>, and <code>pUsageCounts</code> is not <code>NULL</code>, <code>pUsageCounts</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>usageCountsCount</code> <a href="chap34.html#VkMicromapUsageEXT">VkMicromapUsageEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-VkMicromapBuildInfoEXT-ppUsageCounts-parameter" href="chap34.html#VUID-VkMicromapBuildInfoEXT-ppUsageCounts-parameter"></a> <span class="vuid">VUID-VkMicromapBuildInfoEXT-ppUsageCounts-parameter</span><br>
 If <code>usageCountsCount</code> is not <code>0</code>, and <code>ppUsageCounts</code> is not <code>NULL</code>, <code>ppUsageCounts</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>usageCountsCount</code> valid pointers to <a href="chap34.html#VkMicromapUsageEXT">VkMicromapUsageEXT</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBuildMicromapModeEXT</code> enumeration is defined as:</p>
</div>
<div id="VkBuildMicromapModeEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkBuildMicromapModeEXT</span> <span class="p">{</span>
    <span class="n">VK_BUILD_MICROMAP_MODE_BUILD_EXT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkBuildMicromapModeEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUILD_MICROMAP_MODE_BUILD_EXT</code> specifies that the destination
micromap will be built using the specified data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMicromapUsageEXT</code> structure is defined as:</p>
</div>
<div id="VkMicromapUsageEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkMicromapUsageEXT</span> <span class="p">{</span>
    <span class="kt">uint32_t</span>    <span class="n">count</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">subdivisionLevel</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">format</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkMicromapUsageEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>count</code> is the number of triangles in the usage format defined by
the <code>subdivisionLevel</code> and <code>format</code> below in the micromap</p>
</li>
<li>
<p><code>subdivisionLevel</code> is the subdivision level of this usage format</p>
</li>
<li>
<p><code>format</code> is the format of this usage format</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMicromapUsageEXT-format-07519" href="chap34.html#VUID-VkMicromapUsageEXT-format-07519"></a> <span class="vuid">VUID-VkMicromapUsageEXT-format-07519</span><br>

If the <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> of the micromap is
<code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> then <code>format</code> <strong class="purple">must</strong> be
<code>VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</code> or
<code>VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapUsageEXT-format-07520" href="chap34.html#VUID-VkMicromapUsageEXT-format-07520"></a> <span class="vuid">VUID-VkMicromapUsageEXT-format-07520</span><br>

If the <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> of the micromap is
<code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> and <code>format</code> is
<code>VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</code> then <code>subdivisionLevel</code>
<strong class="purple">must</strong> be less than or equal to
<a href="chap40.html#VkPhysicalDeviceOpacityMicromapPropertiesEXT">VkPhysicalDeviceOpacityMicromapPropertiesEXT</a>::<code>maxOpacity2StateSubdivisionLevel</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapUsageEXT-format-07521" href="chap34.html#VUID-VkMicromapUsageEXT-format-07521"></a> <span class="vuid">VUID-VkMicromapUsageEXT-format-07521</span><br>

If the <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> of the micromap is
<code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> and <code>format</code> is
<code>VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</code> then <code>subdivisionLevel</code>
<strong class="purple">must</strong> be less than or equal to
<a href="chap40.html#VkPhysicalDeviceOpacityMicromapPropertiesEXT">VkPhysicalDeviceOpacityMicromapPropertiesEXT</a>::<code>maxOpacity4StateSubdivisionLevel</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>format</code> is interpreted based on the <code>type</code> of the micromap
using it.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMicromapTriangleEXT</code> structure is defined as:</p>
</div>
<div id="VkMicromapTriangleEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkMicromapTriangleEXT</span> <span class="p">{</span>
    <span class="kt">uint32_t</span>    <span class="n">dataOffset</span><span class="p">;</span>
    <span class="kt">uint16_t</span>    <span class="n">subdivisionLevel</span><span class="p">;</span>
    <span class="kt">uint16_t</span>    <span class="n">format</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkMicromapTriangleEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dataOffset</code> is the offset in bytes of the start of the data for
this triangle.
This is a byte aligned value.</p>
</li>
<li>
<p><code>subdivisionLevel</code> is the subdivision level of this triangle</p>
</li>
<li>
<p><code>format</code> is the format of this triangle</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMicromapTriangleEXT-format-07522" href="chap34.html#VUID-VkMicromapTriangleEXT-format-07522"></a> <span class="vuid">VUID-VkMicromapTriangleEXT-format-07522</span><br>

If the <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> of the micromap is
<code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> then <code>format</code> <strong class="purple">must</strong> be
<code>VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</code> or
<code>VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapTriangleEXT-format-07523" href="chap34.html#VUID-VkMicromapTriangleEXT-format-07523"></a> <span class="vuid">VUID-VkMicromapTriangleEXT-format-07523</span><br>

If the <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> of the micromap is
<code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> and <code>format</code> is
<code>VK_OPACITY_MICROMAP_FORMAT_2_STATE_EXT</code> then <code>subdivisionLevel</code>
<strong class="purple">must</strong> be less than or equal to
<a href="chap40.html#VkPhysicalDeviceOpacityMicromapPropertiesEXT">VkPhysicalDeviceOpacityMicromapPropertiesEXT</a>::<code>maxOpacity2StateSubdivisionLevel</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapTriangleEXT-format-07524" href="chap34.html#VUID-VkMicromapTriangleEXT-format-07524"></a> <span class="vuid">VUID-VkMicromapTriangleEXT-format-07524</span><br>

If the <a href="chap12.html#VkMicromapTypeEXT">VkMicromapTypeEXT</a> of the micromap is
<code>VK_MICROMAP_TYPE_OPACITY_MICROMAP_EXT</code> and <code>format</code> is
<code>VK_OPACITY_MICROMAP_FORMAT_4_STATE_EXT</code> then <code>subdivisionLevel</code>
<strong class="purple">must</strong> be less than or equal to
<a href="chap40.html#VkPhysicalDeviceOpacityMicromapPropertiesEXT">VkPhysicalDeviceOpacityMicromapPropertiesEXT</a>::<code>maxOpacity4StateSubdivisionLevel</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>format</code> is interpreted based on the <code>type</code> of the micromap
using it.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="micromap-copying"><a class="anchor" href="chap34.html#micromap-copying"></a>34.1.2. Copying Micromaps</h4>
<div class="paragraph">
<p>An additional command exists for copying micromaps without updating their
contents.
Before copying, an application <strong class="purple">must</strong> query the size of the resulting
micromap.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query micromap size parameters call:</p>
</div>
<div id="vkCmdWriteMicromapsPropertiesEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="kt">void</span> <span class="nf">vkCmdWriteMicromapsPropertiesEXT</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">micromapCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMicromapEXT</span><span class="o">*</span>                        <span class="n">pMicromaps</span><span class="p">,</span>
    <span class="n">VkQueryType</span>                                 <span class="n">queryType</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">firstQuery</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>micromapCount</code> is the count of micromaps for which to query the
property.</p>
</li>
<li>
<p><code>pMicromaps</code> is a pointer to an array of existing previously built
micromaps.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>firstQuery</code> is the first query index within the query pool that
will contain the <code>micromapCount</code> number of results.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to any of the micromaps listed in <code>pMicromaps</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>queryType</code> is
<code>VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT</code>, then the value
written out is the number of bytes required by a serialized micromap.</p>
</li>
<li>
<p>If <code>queryType</code> is <code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code>,
then the value written out is the number of bytes required by a
compacted micromap.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-07525" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-07525"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-07525</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> matching
<code>queryType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-07526" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-07526"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-07526</span><br>

The queries identified by <code>queryPool</code> and <code>firstQuery</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-buffer-07527" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-buffer-07527"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-buffer-07527</span><br>

The <code>buffer</code> used to create each micromap in <code>pMicrmaps</code> <strong class="purple">must</strong>
be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-query-07528" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-query-07528"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-query-07528</span><br>

The sum of <code>query</code> plus <code>micromapCount</code> <strong class="purple">must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-07501" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-07501"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-07501</span><br>

All micromaps in <code>pMicromaps</code> <strong class="purple">must</strong> have been constructed prior to
the execution of this command</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-07502" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-07502"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-07502</span><br>

All micromaps in <code>pMicromaps</code> <strong class="purple">must</strong> have been constructed with
<code>VK_BUILD_MICROMAP_ALLOW_COMPACTION_BIT_EXT</code> if <code>queryType</code> is
<code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-queryType-07503" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-queryType-07503"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-queryType-07503</span><br>

<code>queryType</code> <strong class="purple">must</strong> be <code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code>
or <code>VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-parameter" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-parameter" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-parameter"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-pMicromaps-parameter</span><br>
 <code>pMicromaps</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>micromapCount</code> valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-queryType-parameter" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-queryType-parameter"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-parameter" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-recording" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-cmdpool" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-renderpass" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-renderpass"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-videocoding" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-videocoding"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-micromapCount-arraylength" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-micromapCount-arraylength"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-micromapCount-arraylength</span><br>
 <code>micromapCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteMicromapsPropertiesEXT-commonparent" href="chap34.html#VUID-vkCmdWriteMicromapsPropertiesEXT-commonparent"></a> <span class="vuid">VUID-vkCmdWriteMicromapsPropertiesEXT-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>queryPool</code>, and the elements of <code>pMicromaps</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap37.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy a micromap call:</p>
</div>
<div id="vkCmdCopyMicromapEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyMicromapEXT</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMicromapInfoEXT</span><span class="o">*</span>                <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap34.html#VkCopyMicromapInfoEXT">VkCopyMicromapInfoEXT</a> structure
defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command copies the <code>pInfo-&gt;src</code> micromap to the <code>pInfo-&gt;dst</code>
micromap in the manner specified by <code>pInfo-&gt;mode</code>.</p>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo-&gt;src</code> and <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code> or
<code>VK_ACCESS_2_MICROMAP_WRITE_BIT_EXT</code> as appropriate.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-buffer-07529" href="chap34.html#VUID-vkCmdCopyMicromapEXT-buffer-07529"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-buffer-07529</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-buffer-07530" href="chap34.html#VUID-vkCmdCopyMicromapEXT-buffer-07530"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-buffer-07530</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-commandBuffer-parameter" href="chap34.html#VUID-vkCmdCopyMicromapEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-pInfo-parameter" href="chap34.html#VUID-vkCmdCopyMicromapEXT-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkCopyMicromapInfoEXT">VkCopyMicromapInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-commandBuffer-recording" href="chap34.html#VUID-vkCmdCopyMicromapEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-commandBuffer-cmdpool" href="chap34.html#VUID-vkCmdCopyMicromapEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-renderpass" href="chap34.html#VUID-vkCmdCopyMicromapEXT-renderpass"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapEXT-videocoding" href="chap34.html#VUID-vkCmdCopyMicromapEXT-videocoding"></a> <span class="vuid">VUID-vkCmdCopyMicromapEXT-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap37.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyMicromapInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkCopyMicromapInfoEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkCopyMicromapInfoEXT</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>          <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>              <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkMicromapEXT</span>            <span class="n">src</span><span class="p">;</span>
    <span class="n">VkMicromapEXT</span>            <span class="n">dst</span><span class="p">;</span>
    <span class="n">VkCopyMicromapModeEXT</span>    <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkCopyMicromapInfoEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the source micromap for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target micromap for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap34.html#VkCopyMicromapModeEXT">VkCopyMicromapModeEXT</a> value specifying additional
operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-mode-07531" href="chap34.html#VUID-VkCopyMicromapInfoEXT-mode-07531"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-mode-07531</span><br>

<code>mode</code> <strong class="purple">must</strong> be <code>VK_COPY_MICROMAP_MODE_COMPACT_EXT</code> or
<code>VK_COPY_MICROMAP_MODE_CLONE_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-src-07532" href="chap34.html#VUID-VkCopyMicromapInfoEXT-src-07532"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-src-07532</span><br>

The source acceleration structure <code>src</code> <strong class="purple">must</strong> have been constructed
prior to the execution of this command</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-mode-07533" href="chap34.html#VUID-VkCopyMicromapInfoEXT-mode-07533"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-mode-07533</span><br>

If <code>mode</code> is <code>VK_COPY_MICROMAP_MODE_COMPACT_EXT</code>, <code>src</code>
<strong class="purple">must</strong> have been constructed with
<code>VK_BUILD_MICROMAP_ALLOW_COMPACTION_BIT_EXT</code> in the build</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-buffer-07534" href="chap34.html#VUID-VkCopyMicromapInfoEXT-buffer-07534"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-buffer-07534</span><br>

The <code>buffer</code> used to create <code>src</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-buffer-07535" href="chap34.html#VUID-VkCopyMicromapInfoEXT-buffer-07535"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-buffer-07535</span><br>

The <code>buffer</code> used to create <code>dst</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-sType-sType" href="chap34.html#VUID-VkCopyMicromapInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_MICROMAP_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-pNext-pNext" href="chap34.html#VUID-VkCopyMicromapInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-src-parameter" href="chap34.html#VUID-VkCopyMicromapInfoEXT-src-parameter"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-dst-parameter" href="chap34.html#VUID-VkCopyMicromapInfoEXT-dst-parameter"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-mode-parameter" href="chap34.html#VUID-VkCopyMicromapInfoEXT-mode-parameter"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkCopyMicromapModeEXT">VkCopyMicromapModeEXT</a> value</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapInfoEXT-commonparent" href="chap34.html#VUID-VkCopyMicromapInfoEXT-commonparent"></a> <span class="vuid">VUID-VkCopyMicromapInfoEXT-commonparent</span><br>
 Both of <code>dst</code>, and <code>src</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>mode</code> specifying additional operations to perform
during the copy, are:</p>
</div>
<div id="VkCopyMicromapModeEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkCopyMicromapModeEXT</span> <span class="p">{</span>
    <span class="n">VK_COPY_MICROMAP_MODE_CLONE_EXT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_COPY_MICROMAP_MODE_SERIALIZE_EXT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">VK_COPY_MICROMAP_MODE_DESERIALIZE_EXT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">VK_COPY_MICROMAP_MODE_COMPACT_EXT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkCopyMicromapModeEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COPY_MICROMAP_MODE_CLONE_EXT</code> creates a direct copy of the
micromap specified in <code>src</code> into the one specified by <code>dst</code>.
The <code>dst</code> micromap <strong class="purple">must</strong> have been created with the same parameters
as <code>src</code>.</p>
</li>
<li>
<p><code>VK_COPY_MICROMAP_MODE_SERIALIZE_EXT</code> serializes the micromap to a
semi-opaque format which can be reloaded on a compatible implementation.</p>
</li>
<li>
<p><code>VK_COPY_MICROMAP_MODE_DESERIALIZE_EXT</code> deserializes the semi-opaque
serialization format in the buffer to the micromap.</p>
</li>
<li>
<p><code>VK_COPY_MICROMAP_MODE_COMPACT_EXT</code> creates a more compact version
of a micromap <code>src</code> into <code>dst</code>.
The micromap <code>dst</code> <strong class="purple">must</strong> have been created with a size at least as
large as that returned by <a href="chap34.html#vkCmdWriteMicromapsPropertiesEXT">vkCmdWriteMicromapsPropertiesEXT</a> after
the build of the micromap specified by <code>src</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy a micromap to device memory call:</p>
</div>
<div id="vkCmdCopyMicromapToMemoryEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyMicromapToMemoryEXT</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMicromapToMemoryInfoEXT</span><span class="o">*</span>        <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is an a pointer to a <a href="chap34.html#VkCopyMicromapToMemoryInfoEXT">VkCopyMicromapToMemoryInfoEXT</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with the <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>.
Accesses to the buffer indicated by <code>pInfo-&gt;dst.deviceAddress</code> <strong class="purple">must</strong> be
synchronized with the <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
pipeline stage and an access type of <code>VK_ACCESS_TRANSFER_WRITE_BIT</code>.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as <a href="chap34.html#vkCopyMicromapToMemoryEXT">vkCopyMicromapToMemoryEXT</a>,
but writes its result to a device address, and is executed on the device
rather than the host.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="chap34.html#vkCmdCopyMemoryToMicromapEXT">vkCmdCopyMemoryToMicromapEXT</a> or
<a href="chap34.html#vkCopyMemoryToMicromapEXT">vkCopyMemoryToMicromapEXT</a>.</p>
</div>
<div id="serialized-micromap-header" class="paragraph">
<p>The defined header structure for the serialized data consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data matching
<code>VkPhysicalDeviceIDProperties</code>::<code>driverUUID</code></p>
</li>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data identifying the compatibility for
    comparison using <a href="chap34.html#vkGetDeviceMicromapCompatibilityEXT">vkGetDeviceMicromapCompatibilityEXT</a>
The serialized data is written to the buffer (or read from the buffer)
according to the host endianness.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07536" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07536"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07536</span><br>

<code>pInfo-&gt;dst.deviceAddress</code> <strong class="purple">must</strong> be a valid device address for a
buffer bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07537" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07537"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07537</span><br>

<code>pInfo-&gt;dst.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>256</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07538" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07538"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-07538</span><br>

If the buffer pointed to by <code>pInfo-&gt;dst.deviceAddress</code> is non-sparse
then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-buffer-07539" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-buffer-07539"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-buffer-07539</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-parameter" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-parameter" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkCopyMicromapToMemoryInfoEXT">VkCopyMicromapToMemoryInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-recording" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-cmdpool" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-renderpass" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-renderpass"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMicromapToMemoryEXT-videocoding" href="chap34.html#VUID-vkCmdCopyMicromapToMemoryEXT-videocoding"></a> <span class="vuid">VUID-vkCmdCopyMicromapToMemoryEXT-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap37.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCopyMicromapToMemoryInfoEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkCopyMicromapToMemoryInfoEXT</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>             <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                 <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkMicromapEXT</span>               <span class="n">src</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressKHR</span>    <span class="n">dst</span><span class="p">;</span>
    <span class="n">VkCopyMicromapModeEXT</span>       <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkCopyMicromapToMemoryInfoEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the source micromap for the copy</p>
</li>
<li>
<p><code>dst</code> is the device or host address to memory which is the target
for the copy</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap34.html#VkCopyMicromapModeEXT">VkCopyMicromapModeEXT</a> value specifying additional
operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-src-07540" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-src-07540"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-src-07540</span><br>

The source micromap <code>src</code> <strong class="purple">must</strong> have been constructed prior to the
execution of this command</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-dst-07541" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-dst-07541"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-dst-07541</span><br>

The memory pointed to by <code>dst</code> <strong class="purple">must</strong> be at least as large as the
serialization size of <code>src</code>, as reported by
<a href="chap34.html#vkWriteMicromapsPropertiesEXT">vkWriteMicromapsPropertiesEXT</a> or
<a href="chap34.html#vkCmdWriteMicromapsPropertiesEXT">vkCmdWriteMicromapsPropertiesEXT</a> with a query type of
<code>VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-mode-07542" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-mode-07542"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-mode-07542</span><br>

<code>mode</code> <strong class="purple">must</strong> be <code>VK_COPY_MICROMAP_MODE_SERIALIZE_EXT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-sType-sType" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_MICROMAP_TO_MEMORY_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-pNext-pNext" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-src-parameter" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-src-parameter"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMicromapToMemoryInfoEXT-mode-parameter" href="chap34.html#VUID-VkCopyMicromapToMemoryInfoEXT-mode-parameter"></a> <span class="vuid">VUID-VkCopyMicromapToMemoryInfoEXT-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkCopyMicromapModeEXT">VkCopyMicromapModeEXT</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy device memory to a micromap call:</p>
</div>
<div id="vkCmdCopyMemoryToMicromapEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyMemoryToMicromapEXT</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMemoryToMicromapInfoEXT</span><span class="o">*</span>        <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap34.html#VkCopyMicromapToMemoryInfoEXT">VkCopyMicromapToMemoryInfoEXT</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with the <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_2_MICROMAP_READ_BIT_EXT</code>.
Accesses to the buffer indicated by <code>pInfo-&gt;src.deviceAddress</code> <strong class="purple">must</strong> be
synchronized with the <code>VK_PIPELINE_STAGE_2_MICROMAP_BUILD_BIT_EXT</code>
pipeline stage and an access type of <code>VK_ACCESS_TRANSFER_READ_BIT</code>.</p>
</div>
<div class="paragraph">
<p>This command can accept micromaps produced by either
<a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a> or <a href="chap34.html#vkCopyMicromapToMemoryEXT">vkCopyMicromapToMemoryEXT</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07543" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07543"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07543</span><br>

<code>pInfo-&gt;src.deviceAddress</code> <strong class="purple">must</strong> be a valid device address for a
buffer bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07544" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07544"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07544</span><br>

<code>pInfo-&gt;src.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>256</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07545" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07545"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-07545</span><br>

If the buffer pointed to by <code>pInfo-&gt;src.deviceAddress</code> is non-sparse
then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-buffer-07546" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-buffer-07546"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-buffer-07546</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-parameter" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-parameter" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkCopyMemoryToMicromapInfoEXT">VkCopyMemoryToMicromapInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-recording" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-cmdpool" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-renderpass" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-renderpass"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToMicromapEXT-videocoding" href="chap34.html#VUID-vkCmdCopyMemoryToMicromapEXT-videocoding"></a> <span class="vuid">VUID-vkCmdCopyMemoryToMicromapEXT-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap37.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyMemoryToMicromapInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkCopyMemoryToMicromapInfoEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkCopyMemoryToMicromapInfoEXT</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>    <span class="n">src</span><span class="p">;</span>
    <span class="n">VkMicromapEXT</span>                    <span class="n">dst</span><span class="p">;</span>
    <span class="n">VkCopyMicromapModeEXT</span>            <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkCopyMemoryToMicromapInfoEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the device or host address to memory containing the source
data for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target micromap for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap34.html#VkCopyMicromapModeEXT">VkCopyMicromapModeEXT</a> value specifying additional
operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-src-07547" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-src-07547"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-src-07547</span><br>

The source memory pointed to by <code>src</code> <strong class="purple">must</strong> contain data previously
serialized using <a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-mode-07548" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-mode-07548"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-mode-07548</span><br>

<code>mode</code> <strong class="purple">must</strong> be <code>VK_COPY_MICROMAP_MODE_DESERIALIZE_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-src-07549" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-src-07549"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-src-07549</span><br>

The data in <code>src</code> <strong class="purple">must</strong> have a format compatible with the
destination physical device as returned by
<a href="chap34.html#vkGetDeviceMicromapCompatibilityEXT">vkGetDeviceMicromapCompatibilityEXT</a></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-dst-07550" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-dst-07550"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-dst-07550</span><br>

<code>dst</code> <strong class="purple">must</strong> have been created with a <code>size</code> greater than or
equal to that used to serialize the data in <code>src</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-sType-sType" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_MEMORY_TO_MICROMAP_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-pNext-pNext" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-dst-parameter" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-dst-parameter"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToMicromapInfoEXT-mode-parameter" href="chap34.html#VUID-VkCopyMemoryToMicromapInfoEXT-mode-parameter"></a> <span class="vuid">VUID-VkCopyMemoryToMicromapInfoEXT-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkCopyMicromapModeEXT">VkCopyMicromapModeEXT</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To check if a serialized micromap is compatible with the current device
call:</p>
</div>
<div id="vkGetDeviceMicromapCompatibilityEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="kt">void</span> <span class="nf">vkGetDeviceMicromapCompatibilityEXT</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMicromapVersionInfoEXT</span><span class="o">*</span>             <span class="n">pVersionInfo</span><span class="p">,</span>
    <span class="n">VkAccelerationStructureCompatibilityKHR</span><span class="o">*</span>    <span class="n">pCompatibility</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device to check the version against.</p>
</li>
<li>
<p><code>pVersionInfo</code> is a pointer to a <a href="chap34.html#VkMicromapVersionInfoEXT">VkMicromapVersionInfoEXT</a>
structure specifying version information to check against the device.</p>
</li>
<li>
<p><code>pCompatibility</code> is a pointer to a
<a href="chap33.html#VkAccelerationStructureCompatibilityKHR">VkAccelerationStructureCompatibilityKHR</a> value in which
compatibility information is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceMicromapCompatibilityEXT-micromap-07551" href="chap34.html#VUID-vkGetDeviceMicromapCompatibilityEXT-micromap-07551"></a> <span class="vuid">VUID-vkGetDeviceMicromapCompatibilityEXT-micromap-07551</span><br>

The <a href="chap39.html#features-micromap"><code>micromap</code></a> feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceMicromapCompatibilityEXT-device-parameter" href="chap34.html#VUID-vkGetDeviceMicromapCompatibilityEXT-device-parameter"></a> <span class="vuid">VUID-vkGetDeviceMicromapCompatibilityEXT-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMicromapCompatibilityEXT-pVersionInfo-parameter" href="chap34.html#VUID-vkGetDeviceMicromapCompatibilityEXT-pVersionInfo-parameter"></a> <span class="vuid">VUID-vkGetDeviceMicromapCompatibilityEXT-pVersionInfo-parameter</span><br>
 <code>pVersionInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkMicromapVersionInfoEXT">VkMicromapVersionInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMicromapCompatibilityEXT-pCompatibility-parameter" href="chap34.html#VUID-vkGetDeviceMicromapCompatibilityEXT-pCompatibility-parameter"></a> <span class="vuid">VUID-vkGetDeviceMicromapCompatibilityEXT-pCompatibility-parameter</span><br>
 <code>pCompatibility</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap33.html#VkAccelerationStructureCompatibilityKHR">VkAccelerationStructureCompatibilityKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMicromapVersionInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkMicromapVersionInfoEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkMicromapVersionInfoEXT</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span>     <span class="n">pVersionData</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkMicromapVersionInfoEXT</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pVersionData</code> is a pointer to the version header of a micromap as
defined in <a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code>pVersionData</code> is a <em>pointer</em> to an array of 2×<code>VK_UUID_SIZE</code>
<code>uint8_t</code> values instead of two <code>VK_UUID_SIZE</code> arrays as the expected
use case for this member is to be pointed at the header of a previously
serialized micromap (via <a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a> or
<a href="chap34.html#vkCopyMicromapToMemoryEXT">vkCopyMicromapToMemoryEXT</a>) that is loaded in memory.
Using arrays would necessitate extra memory copies of the UUIDs.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMicromapVersionInfoEXT-sType-sType" href="chap34.html#VUID-VkMicromapVersionInfoEXT-sType-sType"></a> <span class="vuid">VUID-VkMicromapVersionInfoEXT-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MICROMAP_VERSION_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapVersionInfoEXT-pNext-pNext" href="chap34.html#VUID-VkMicromapVersionInfoEXT-pNext-pNext"></a> <span class="vuid">VUID-VkMicromapVersionInfoEXT-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMicromapVersionInfoEXT-pVersionData-parameter" href="chap34.html#VUID-VkMicromapVersionInfoEXT-pVersionData-parameter"></a> <span class="vuid">VUID-VkMicromapVersionInfoEXT-pVersionData-parameter</span><br>
 <code>pVersionData</code> <strong class="purple">must</strong> be a valid pointer to an array of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7063em;vertical-align:-0.0951em;"></span><span class="mord"><span class="mord mathtt">VK_UUID_SIZE</span></span></span></span></span> <code>uint8_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="host-micromap"><a class="anchor" href="chap34.html#host-micromap"></a>34.2. Host Micromap Operations</h3>
<div class="paragraph">
<p>Implementations are also required to provide host implementations of the
micromap operations if the <a href="chap39.html#features-micromapHostCommands"><code>micromapHostCommands</code></a> feature is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap34.html#vkBuildMicromapsEXT">vkBuildMicromapsEXT</a> corresponding to <a href="chap34.html#vkCmdBuildMicromapsEXT">vkCmdBuildMicromapsEXT</a></p>
</li>
<li>
<p><a href="chap34.html#vkCopyMicromapEXT">vkCopyMicromapEXT</a> corresponding to <a href="chap34.html#vkCmdCopyMicromapEXT">vkCmdCopyMicromapEXT</a></p>
</li>
<li>
<p><a href="chap34.html#vkCopyMicromapToMemoryEXT">vkCopyMicromapToMemoryEXT</a> corresponding to
<a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a></p>
</li>
<li>
<p><a href="chap34.html#vkCopyMemoryToMicromapEXT">vkCopyMemoryToMicromapEXT</a> corresponding to
<a href="chap34.html#vkCmdCopyMemoryToMicromapEXT">vkCmdCopyMemoryToMicromapEXT</a></p>
</li>
<li>
<p><a href="chap34.html#vkWriteMicromapsPropertiesEXT">vkWriteMicromapsPropertiesEXT</a> corresponding to
<a href="chap34.html#vkCmdWriteMicromapsPropertiesEXT">vkCmdWriteMicromapsPropertiesEXT</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These commands are functionally equivalent to their device counterparts,
except that they are executed on the host timeline, rather than being
enqueued into command buffers.</p>
</div>
<div class="paragraph">
<p>All micromaps used by the host commands <strong class="purple">must</strong> be bound to host-visible
memory, and all input data for micromap builds <strong class="purple">must</strong> be referenced using
host addresses instead of device addresses.
Applications are not required to map micromap memory when using the host
commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="chap34.html#vkBuildMicromapsEXT">vkBuildMicromapsEXT</a> and <a href="chap34.html#vkCmdBuildMicromapsEXT">vkCmdBuildMicromapsEXT</a> <strong class="purple">may</strong> use
different algorithms, and thus are not required to produce identical
structures.</p>
</div>
<div class="paragraph">
<p>Apart from these details, the host and device operations are
interchangeable.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For efficient execution, micromaps manipulated using these commands should
always be bound to host cached memory, as the implementation may need to
repeatedly read and write this memory during the execution of the command.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build micromaps on the host, call:</p>
</div>
<div id="vkBuildMicromapsEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="n">VkResult</span> <span class="nf">vkBuildMicromapsEXT</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">infoCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMicromapBuildInfoEXT</span><span class="o">*</span>               <span class="n">pInfos</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the <code>VkDevice</code> for which the micromaps are being
built.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap32.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>infoCount</code> is the number of micromaps to build.
It specifies the number of the <code>pInfos</code> that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a> structures defining the geometry used to
build each micromap.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as <a href="chap34.html#vkCmdBuildMicromapsEXT">vkCmdBuildMicromapsEXT</a> but is
executed by the host.</p>
</div>
<div class="paragraph">
<p>The <code>vkBuildMicromapsEXT</code> command provides the ability to initiate
multiple micromaps builds, however there is no ordering or synchronization
implied between any of the individual micromap builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This means that there <strong class="purple">cannot</strong> be any memory aliasing between any micromap
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07461" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07461"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07461</span><br>

For each <code>pInfos</code>[i], <code>dstMicromap</code> <strong class="purple">must</strong> have been created with
a value of <a href="chap12.html#VkMicromapCreateInfoEXT">VkMicromapCreateInfoEXT</a>::<code>size</code> greater than or
equal to the memory size required by the build operation, as returned by
<a href="chap12.html#vkGetMicromapBuildSizesEXT">vkGetMicromapBuildSizesEXT</a> with <span class="eq"><code>pBuildInfo</code> =
<code>pInfos</code>[i]</span></p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-mode-07462" href="chap34.html#VUID-vkBuildMicromapsEXT-mode-07462"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-mode-07462</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="chap34.html#VkBuildMicromapModeEXT">VkBuildMicromapModeEXT</a> value</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-dstMicromap-07463" href="chap34.html#VUID-vkBuildMicromapsEXT-dstMicromap-07463"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-dstMicromap-07463</span><br>

The <code>dstMicromap</code> member of any element of <code>pInfos</code> <strong class="purple">must</strong> be a
valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07464" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07464"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07464</span><br>

For each element of <code>pInfos</code> its <code>type</code> member <strong class="purple">must</strong> match the
value of <a href="chap12.html#VkMicromapCreateInfoEXT">VkMicromapCreateInfoEXT</a>::<code>type</code> when its
<code>dstMicromap</code> was created</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-dstMicromap-07465" href="chap34.html#VUID-vkBuildMicromapsEXT-dstMicromap-07465"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-dstMicromap-07465</span><br>

The range of memory backing the <code>dstMicromap</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>dstMicromap</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-dstMicromap-07466" href="chap34.html#VUID-vkBuildMicromapsEXT-dstMicromap-07466"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-dstMicromap-07466</span><br>

The range of memory backing the <code>dstMicromap</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any element of
<code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-scratchData-07467" href="chap34.html#VUID-vkBuildMicromapsEXT-scratchData-07467"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-scratchData-07467</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07552" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07552"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07552</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstMicromap</code> member <strong class="purple">must</strong> be bound to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07553" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07553"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07553</span><br>

For each element of <code>pInfos</code>, all referenced addresses of
<code>pInfos</code>[i].<code>data.hostAddress</code> <strong class="purple">must</strong> be valid host memory</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07554" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07554"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07554</span><br>

For each element of <code>pInfos</code>, all referenced addresses of
<code>pInfos</code>[i].<code>triangleArray.hostAddress</code> <strong class="purple">must</strong> be valid host
memory</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-micromapHostCommands-07555" href="chap34.html#VUID-vkBuildMicromapsEXT-micromapHostCommands-07555"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-micromapHostCommands-07555</span><br>

The <a href="chap39.html#features-micromapHostCommands"><code>VkPhysicalDeviceOpacityMicromapFeaturesEXT</code>::<code>micromapHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07556" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07556"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07556</span><br>

If <code>pInfos</code>[i].<code>mode</code> is <code>VK_BUILD_MICROMAP_MODE_BUILD_EXT</code>,
all addresses between <code>pInfos</code>[i].<code>scratchData.hostAddress</code> and
<code>pInfos</code>[i].<code>scratchData.hostAddress</code> + N - 1 <strong class="purple">must</strong> be valid
host memory, where N is given by the <code>buildScratchSize</code> member of
the <a href="chap12.html#VkMicromapBuildSizesInfoEXT">VkMicromapBuildSizesInfoEXT</a> structure returned from a call to
<a href="chap12.html#vkGetMicromapBuildSizesEXT">vkGetMicromapBuildSizesEXT</a> with an identical
<a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a> structure and primitive count</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-07557" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-07557"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-07557</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstMicromap</code> member <strong class="purple">must</strong> be bound to memory that was not allocated
with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-device-parameter" href="chap34.html#VUID-vkBuildMicromapsEXT-device-parameter"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-deferredOperation-parameter" href="chap34.html#VUID-vkBuildMicromapsEXT-deferredOperation-parameter"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap49.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-pInfos-parameter" href="chap34.html#VUID-vkBuildMicromapsEXT-pInfos-parameter"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="chap34.html#VkMicromapBuildInfoEXT">VkMicromapBuildInfoEXT</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-infoCount-arraylength" href="chap34.html#VUID-vkBuildMicromapsEXT-infoCount-arraylength"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkBuildMicromapsEXT-deferredOperation-parent" href="chap34.html#VUID-vkBuildMicromapsEXT-deferredOperation-parent"></a> <span class="vuid">VUID-vkBuildMicromapsEXT-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy or compact a micromap on the host, call:</p>
</div>
<div id="vkCopyMicromapEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="n">VkResult</span> <span class="nf">vkCopyMicromapEXT</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMicromapInfoEXT</span><span class="o">*</span>                <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the micromaps.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap32.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap34.html#VkCopyMicromapInfoEXT">VkCopyMicromapInfoEXT</a> structure
defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as <a href="chap34.html#vkCmdCopyMicromapEXT">vkCmdCopyMicromapEXT</a> but is
executed by the host.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMicromapEXT-deferredOperation-03678" href="chap34.html#VUID-vkCopyMicromapEXT-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyMicromapEXT-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-buffer-07558" href="chap34.html#VUID-vkCopyMicromapEXT-buffer-07558"></a> <span class="vuid">VUID-vkCopyMicromapEXT-buffer-07558</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-buffer-07559" href="chap34.html#VUID-vkCopyMicromapEXT-buffer-07559"></a> <span class="vuid">VUID-vkCopyMicromapEXT-buffer-07559</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-micromapHostCommands-07560" href="chap34.html#VUID-vkCopyMicromapEXT-micromapHostCommands-07560"></a> <span class="vuid">VUID-vkCopyMicromapEXT-micromapHostCommands-07560</span><br>

The <a href="chap39.html#features-micromapHostCommands"><code>VkPhysicalDeviceOpacityMicromapFeaturesEXT</code>::<code>micromapHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-buffer-07561" href="chap34.html#VUID-vkCopyMicromapEXT-buffer-07561"></a> <span class="vuid">VUID-vkCopyMicromapEXT-buffer-07561</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-buffer-07562" href="chap34.html#VUID-vkCopyMicromapEXT-buffer-07562"></a> <span class="vuid">VUID-vkCopyMicromapEXT-buffer-07562</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMicromapEXT-device-parameter" href="chap34.html#VUID-vkCopyMicromapEXT-device-parameter"></a> <span class="vuid">VUID-vkCopyMicromapEXT-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-deferredOperation-parameter" href="chap34.html#VUID-vkCopyMicromapEXT-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyMicromapEXT-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap49.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-pInfo-parameter" href="chap34.html#VUID-vkCopyMicromapEXT-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyMicromapEXT-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkCopyMicromapInfoEXT">VkCopyMicromapInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapEXT-deferredOperation-parent" href="chap34.html#VUID-vkCopyMicromapEXT-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyMicromapEXT-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy host accessible memory to a micromap, call:</p>
</div>
<div id="vkCopyMemoryToMicromapEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="n">VkResult</span> <span class="nf">vkCopyMemoryToMicromapEXT</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMemoryToMicromapInfoEXT</span><span class="o">*</span>        <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;dst</code>.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap32.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap34.html#VkCopyMemoryToMicromapInfoEXT">VkCopyMemoryToMicromapInfoEXT</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as <a href="chap34.html#vkCmdCopyMemoryToMicromapEXT">vkCmdCopyMemoryToMicromapEXT</a>
but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command can accept micromaps produced by either
<a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a> or <a href="chap34.html#vkCopyMicromapToMemoryEXT">vkCopyMicromapToMemoryEXT</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-deferredOperation-03678" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-pInfo-07563" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-pInfo-07563"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-pInfo-07563</span><br>

<code>pInfo-&gt;src.hostAddress</code> <strong class="purple">must</strong> be a valid host pointer</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-pInfo-07564" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-pInfo-07564"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-pInfo-07564</span><br>

<code>pInfo-&gt;src.hostAddress</code> <strong class="purple">must</strong> be aligned to 16 bytes</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-buffer-07565" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-buffer-07565"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-buffer-07565</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-micromapHostCommands-07566" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-micromapHostCommands-07566"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-micromapHostCommands-07566</span><br>

The <a href="chap39.html#features-micromapHostCommands"><code>VkPhysicalDeviceOpacityMicromapFeaturesEXT</code>::<code>micromapHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-buffer-07567" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-buffer-07567"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-buffer-07567</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-device-parameter" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-device-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-deferredOperation-parameter" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap49.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-pInfo-parameter" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkCopyMemoryToMicromapInfoEXT">VkCopyMemoryToMicromapInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToMicromapEXT-deferredOperation-parent" href="chap34.html#VUID-vkCopyMemoryToMicromapEXT-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyMemoryToMicromapEXT-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy a micromap to host accessible memory, call:</p>
</div>
<div id="vkCopyMicromapToMemoryEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="n">VkResult</span> <span class="nf">vkCopyMicromapToMemoryEXT</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMicromapToMemoryInfoEXT</span><span class="o">*</span>        <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;src</code>.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap32.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap34.html#VkCopyMicromapToMemoryInfoEXT">VkCopyMicromapToMemoryInfoEXT</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as <a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a>
but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="chap34.html#vkCmdCopyMicromapToMemoryEXT">vkCmdCopyMicromapToMemoryEXT</a>, but writes its result directly to a host
pointer, and is executed on the host rather than the device.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="chap34.html#vkCmdCopyMemoryToMicromapEXT">vkCmdCopyMemoryToMicromapEXT</a> or
<a href="chap34.html#vkCopyMemoryToMicromapEXT">vkCopyMemoryToMicromapEXT</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-deferredOperation-03678" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-buffer-07568" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-buffer-07568"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-buffer-07568</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-pInfo-07569" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-pInfo-07569"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-pInfo-07569</span><br>

<code>pInfo-&gt;dst.hostAddress</code> <strong class="purple">must</strong> be a valid host pointer</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-pInfo-07570" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-pInfo-07570"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-pInfo-07570</span><br>

<code>pInfo-&gt;dst.hostAddress</code> <strong class="purple">must</strong> be aligned to 16 bytes</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-micromapHostCommands-07571" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-micromapHostCommands-07571"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-micromapHostCommands-07571</span><br>

The <a href="chap39.html#features-micromapHostCommands"><code>VkPhysicalDeviceOpacityMicromapFeaturesEXT</code>::<code>micromapHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-buffer-07572" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-buffer-07572"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-buffer-07572</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-device-parameter" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-device-parameter"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-deferredOperation-parameter" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap49.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-pInfo-parameter" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap34.html#VkCopyMicromapToMemoryInfoEXT">VkCopyMicromapToMemoryInfoEXT</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyMicromapToMemoryEXT-deferredOperation-parent" href="chap34.html#VUID-vkCopyMicromapToMemoryEXT-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyMicromapToMemoryEXT-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query micromap size parameters on the host, call:</p>
</div>
<div id="vkWriteMicromapsPropertiesEXT" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_EXT_opacity_micromap</span>
<span class="n">VkResult</span> <span class="nf">vkWriteMicromapsPropertiesEXT</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">micromapCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMicromapEXT</span><span class="o">*</span>                        <span class="n">pMicromaps</span><span class="p">,</span>
    <span class="n">VkQueryType</span>                                 <span class="n">queryType</span><span class="p">,</span>
    <span class="kt">size_t</span>                                      <span class="n">dataSize</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span>                                       <span class="n">pData</span><span class="p">,</span>
    <span class="kt">size_t</span>                                      <span class="n">stride</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the micromaps in <code>pMicromaps</code>.</p>
</li>
<li>
<p><code>micromapCount</code> is the count of micromaps for which to query the
property.</p>
</li>
<li>
<p><code>pMicromaps</code> is a pointer to an array of existing previously built
micromaps.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the property to
be queried.</p>
</li>
<li>
<p><code>dataSize</code> is the size in bytes of the buffer pointed to by
<code>pData</code>.</p>
</li>
<li>
<p><code>pData</code> is a pointer to an application-allocated buffer where the
results will be written.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>pData</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="chap34.html#vkCmdWriteMicromapsPropertiesEXT">vkCmdWriteMicromapsPropertiesEXT</a> but is executed by the host.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-07501" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-07501"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-07501</span><br>

All micromaps in <code>pMicromaps</code> <strong class="purple">must</strong> have been constructed prior to
the execution of this command</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-07502" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-07502"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-07502</span><br>

All micromaps in <code>pMicromaps</code> <strong class="purple">must</strong> have been constructed with
<code>VK_BUILD_MICROMAP_ALLOW_COMPACTION_BIT_EXT</code> if <code>queryType</code> is
<code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-queryType-07503" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-queryType-07503"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-queryType-07503</span><br>

<code>queryType</code> <strong class="purple">must</strong> be <code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code>
or <code>VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-queryType-10071" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-queryType-10071"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-queryType-10071</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT</code> or
<code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code> then <code>stride</code> <strong class="purple">must</strong>
be a multiple of the size of <a href="chap3.html#VkDeviceSize">VkDeviceSize</a></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-queryType-10072" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-queryType-10072"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-queryType-10072</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_MICROMAP_SERIALIZATION_SIZE_EXT</code> or
<code>VK_QUERY_TYPE_MICROMAP_COMPACTED_SIZE_EXT</code> then <code>pData</code> <strong class="purple">must</strong>
point to a <a href="chap3.html#VkDeviceSize">VkDeviceSize</a></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-dataSize-07576" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-dataSize-07576"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-dataSize-07576</span><br>

<code>dataSize</code> <strong class="purple">must</strong> be greater than or equal to
<span class="eq"><code>micromapCount</code>*<code>stride</code></span></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-buffer-07577" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-buffer-07577"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-buffer-07577</span><br>

The <code>buffer</code> used to create each micromap in <code>pMicromaps</code> <strong class="purple">must</strong>
be bound to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-micromapHostCommands-07578" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-micromapHostCommands-07578"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-micromapHostCommands-07578</span><br>

The <a href="chap39.html#features-micromapHostCommands"><code>VkPhysicalDeviceOpacityMicromapFeaturesEXT</code>::<code>micromapHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-buffer-07579" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-buffer-07579"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-buffer-07579</span><br>

The <code>buffer</code> used to create each micromap in <code>pMicromaps</code> <strong class="purple">must</strong>
be bound to memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-device-parameter" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-device-parameter"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-parameter" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-parameter"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-parameter</span><br>
 <code>pMicromaps</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>micromapCount</code> valid <a href="chap12.html#VkMicromapEXT">VkMicromapEXT</a> handles</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-queryType-parameter" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-queryType-parameter"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-pData-parameter" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-pData-parameter"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-pData-parameter</span><br>
 <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-micromapCount-arraylength" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-micromapCount-arraylength"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-micromapCount-arraylength</span><br>
 <code>micromapCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-dataSize-arraylength" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-dataSize-arraylength"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-dataSize-arraylength</span><br>
 <code>dataSize</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-parent" href="chap34.html#VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-parent"></a> <span class="vuid">VUID-vkWriteMicromapsPropertiesEXT-pMicromaps-parent</span><br>
 Each element of <code>pMicromaps</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
<nav>
  <a rel="prev" href="chap33.html" class="nav nav-prev" title="Previous page" aria-label="Previous page" aria-keyshortcuts="Left">
        <i class="fa fa-angle-left"></i>
     </a>
  <a rel="next" href="chap35.html" class="nav nav-next" title="Next page" aria-label="Next page" aria-keyshortcuts="Right">
        <i class="fa fa-angle-right"></i>
     </a>
  <div style="clear: both"></div>
</nav>




</body>
  <script>
  function isInViewport(ele) {
    const rect = ele.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
    );
  }
  function yPosition (ele) {
    const rect = ele.getBoundingClientRect();
    return (rect.top - 20); // 20px above
  }
  let curr = document.getElementsByClassName('current');
  if (!isInViewport(curr[curr.length - 1])) {
    document.getElementById('toc').scrollTo({
      top: yPosition(curr[0]),
      left: 0,
      behavior: 'smooth'
    });
  }

  /* For page navigation */
  function gotoPage(selector) {
    const button = document.querySelector(selector);
    if (button)
      window.location.href = button.href;
  }
  document.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowRight':
        e.preventDefault();
        gotoPage('.nav-next');
        break;
      case 'ArrowLeft':
        e.preventDefault();
        gotoPage('.nav-prev');
        break;
    }
  });
  </script>
  </html>