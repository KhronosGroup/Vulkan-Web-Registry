<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="The Khronos® Vulkan Working Group">
<title>Vulkan® 1.0.235 - A Specification (with KHR extensions)</title>
<link rel="stylesheet" href="style0.css" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="style1.css" type="text/css">
<link rel="stylesheet" href="style2.css" type="text/css">

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin="" even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<!--ChunkedSearchJSMarker-->
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<link rel="stylesheet" href="style3.css" type="text/css">
<script>
    function hideElement(e){
        e.setAttribute("hidden", "");
        e.classList.add("hidden");
    }

    function unhideElement(e){
        e.classList.remove("hidden");
        e.removeAttribute("hidden");
    }

    function hideLoadableContent(){
        unhideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) hideElement(loadable);
    }

    function unhideLoadableContent(){
        hideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) unhideElement(loadable);
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
<link rel="stylesheet" href="asciidoctor-chunker.css" type="text/css"></head>
<body class="book toc2 toc-left">
<div style="text-align: center;">
    <span class="image"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgdmlld0JveD0iMCAwIDExNTAgMzI2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MS40MTQyMTsiPgogICAgPGcgaWQ9IkFydGJvYXJkMSIgdHJhbnNmb3JtPSJtYXRyaXgoMC45NTUxNSwwLDAsMC44ODgyODMsLTQwLjExNjMsLTMwLjIwMTYpIj4KICAgICAgICA8cmVjdCB4PSI0MiIgeT0iMzQiIHdpZHRoPSIxMjA0IiBoZWlnaHQ9IjM2NyIgc3R5bGU9ImZpbGw6bm9uZTsiLz4KICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLjA0Njk2LDAsMCwxLjEyNTc3LC00Ni45OTEzLC01MC40MzI1KSI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik03MjQuMSwzODUuMDZMNjgzLjUzLDM4NS4wNkM2ODMuNTMsMzg1LjA2IDY4My41MywyODYuMDkgNjgzLjUzLDI1NS40QzY5Ni40OSwyNjIuNjIgNzEzLjYyLDI3NS45NCA3MjQuMSwyODguNzJMNzI0LjEsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxnPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTM4MS43NSwzODUuMDZMMzMxLjE3LDM4NS4wNkwyNjUuMTYsMTgxLjAzTDMxMS4xNywxODEuMDNMMzU2LjYxLDMyNC40OEwzNTcuMTgsMzI0LjQ4TDQwMy4xOCwxODEuMDNMNDQ5LjQ3LDE4MS4wM0wzODEuNzUsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNTg1LjUxLDM4NS4wNkw1NDYuOTMsMzg1LjA2TDU0Ni45MywzNjQuNDlMNTQ2LjA4LDM2NC40OUM1NDAuOTMsMzczLjA3IDUzNC4yNywzNzkuMjYgNTI2LjA3LDM4My4wN0M1MTcuODgsMzg2Ljg4IDUwOS41LDM4OC43OCA1MDAuOTIsMzg4Ljc4QzQ5MC4wNiwzODguNzggNDgxLjE2LDM4Ny4zNSA0NzQuMiwzODQuNUM0NjcuMjUsMzgxLjY1IDQ2MS43NywzNzcuNTkgNDU3Ljc3LDM3Mi4zNkM0NTMuNzYsMzY3LjEyIDQ1MC45NSwzNjAuNzQgNDQ5LjMzLDM1My4yMUM0NDcuNzIsMzQ1LjY5IDQ0Ni45MSwzMzcuMzUgNDQ2LjkxLDMyOC4yMUw0NDYuOTEsMjM3LjMzTDQ4Ny40OSwyMzcuMzNMNDg3LjQ5LDMyMC43N0M0ODcuNDksMzMyLjk2IDQ4OS40LDM0Mi4wNiA0OTMuMjEsMzQ4LjA2QzQ5Ny4wMiwzNTQuMDcgNTAzLjc4LDM1Ny4wNiA1MTMuNSwzNTcuMDZDNTI0LjU1LDM1Ny4wNiA1MzIuNTUsMzUzLjc4IDUzNy41LDM0Ny4yQzU0Mi40NiwzNDAuNjIgNTQ0LjkzLDMyOS44MSA1NDQuOTMsMzE0Ljc2TDU0NC45MywyMzcuMzJMNTg1LjUyLDIzNy4zMkw1ODUuNTIsMzg1LjA2TDU4NS41MSwzODUuMDZaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8cGF0aCBkPSJNNzMwLjg0LDI5Ni4xOUw3MzAuNzQsMjkwLjQ3TDc4MS44OSwyMzcuMzNMODI5LjkxLDIzNy4zM0w3NzQuMTgsMjkxLjYyTDgzNi4xOSwzODUuMDZMNzg3LjA0LDM4NS4wNkw3MzAuODQsMjk2LjE5WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik04NDMuNjIsMjgyLjc2Qzg0NC4xOSwyNzMuMjQgODQ2LjU4LDI2NS4zMyA4NTAuNzcsMjU5LjA0Qzg1NC45NiwyNTIuNzUgODYwLjI5LDI0Ny43MSA4NjYuNzcsMjQzLjlDODczLjI1LDI0MC4wOSA4ODAuNTQsMjM3LjM3IDg4OC42NCwyMzUuNzZDODk2LjczLDIzNC4xNCA5MDQuODgsMjMzLjMzIDkxMy4wNywyMzMuMzNDOTIwLjUsMjMzLjMzIDkyOC4wMiwyMzMuODUgOTM1LjY0LDIzNC45Qzk0My4yNywyMzUuOTUgOTUwLjIxLDIzOCA5NTYuNSwyNDEuMDVDOTYyLjc4LDI0NC4xIDk2Ny45MywyNDguMzQgOTcxLjk0LDI1My43NkM5NzUuOTQsMjU5LjE5IDk3Ny45NCwyNjYuMzggOTc3Ljk0LDI3NS4zNEw5NzcuOTQsMzUyLjIxQzk3Ny45NCwzNTguODggOTc4LjMyLDM2NS4yNyA5NzkuMDgsMzcxLjM2Qzk3OS44NCwzNzcuNDYgOTgxLjE4LDM4Mi4wMyA5ODMuMDksMzg1LjA4TDk0MS45NCwzODUuMDhDOTQxLjE4LDM4Mi44IDk0MC41NiwzODAuNDYgOTQwLjA4LDM3OC4wOEM5MzkuNjEsMzc1LjcgOTM5LjI3LDM3My4yOCA5MzkuMDgsMzcwLjc5QzkzMi42LDM3Ny40NyA5MjQuOTcsMzgyLjEzIDkxNi4yMSwzODQuOEM5MDcuNDUsMzg3LjQ2IDg5OC40OSwzODguOCA4ODkuMzUsMzg4LjhDODgyLjMsMzg4LjggODc1LjcyLDM4Ny45NCA4NjkuNjQsMzg2LjIzQzg2My41NCwzODQuNTIgODU4LjIsMzgxLjg1IDg1My42NCwzNzguMjNDODQ5LjA2LDM3NC42MSA4NDUuNDgsMzcwLjA0IDg0Mi45MiwzNjQuNTFDODQwLjM1LDM1OC45OSA4MzkuMDYsMzUyLjQyIDgzOS4wNiwzNDQuOEM4MzkuMDYsMzM2LjQyIDg0MC41NCwzMjkuNTEgODQzLjQ5LDMyNC4wOEM4NDYuNDUsMzE4LjY1IDg1MC4yNSwzMTQuMzIgODU0LjkzLDMxMS4wOEM4NTkuNiwzMDcuODQgODY0LjkzLDMwNS40MSA4NzAuOTMsMzAzLjc5Qzg3Ni45MywzMDIuMTcgODgyLjk4LDMwMC44OCA4ODkuMDcsMjk5LjkzQzg5NS4xNywyOTguOTkgOTAxLjE3LDI5OC4yMiA5MDcuMDgsMjk3LjY1QzkxMi45OSwyOTcuMDggOTE4LjIyLDI5Ni4yMiA5MjIuNzksMjk1LjA4QzkyNy4zNywyOTMuOTMgOTMwLjk4LDI5Mi4yNyA5MzMuNjUsMjkwLjA3QzkzNi4zMiwyODcuODggOTM3LjU2LDI4NC42OSA5MzcuMzcsMjgwLjVDOTM3LjM3LDI3Ni4xMiA5MzYuNjUsMjcyLjY0IDkzNS4yMiwyNzAuMDdDOTMzLjc5LDI2Ny41IDkzMS44OSwyNjUuNSA5MjkuNTEsMjY0LjA3QzkyNy4xMywyNjIuNjQgOTI0LjM3LDI2MS42OSA5MjEuMjIsMjYxLjIxQzkxOC4wNywyNjAuNzMgOTE0LjcsMjYwLjQ5IDkxMS4wOCwyNjAuNDlDOTAzLjA4LDI2MC40OSA4OTYuNzksMjYyLjIgODkyLjIyLDI2NS42NEM4ODcuNjUsMjY5LjA3IDg4NC45OCwyNzQuNzggODg0LjIyLDI4Mi43OUw4NDMuNjIsMjgyLjc5TDg0My42MiwyODIuNzZaTTkzNy4zNSwzMTIuNzdDOTM1LjYzLDMxNC4zIDkzMy40OSwzMTUuNDggOTMwLjkyLDMxNi4zNEM5MjguMzUsMzE3LjIxIDkyNS41OSwzMTcuOTIgOTIyLjYzLDMxOC40OUM5MTkuNjgsMzE5LjA2IDkxNi41OCwzMTkuNTQgOTEzLjM1LDMxOS45MkM5MTAuMTEsMzIwLjMgOTA2Ljg3LDMyMC43NyA5MDMuNjMsMzIxLjM1QzkwMC41OCwzMjEuOTIgODk3LjU4LDMyMi42OSA4OTQuNjMsMzIzLjYzQzg5MS42OCwzMjQuNTkgODg5LjEsMzI1Ljg3IDg4Ni45MSwzMjcuNDlDODg0LjcyLDMyOS4xMSA4ODIuOTYsMzMxLjE2IDg4MS42MiwzMzMuNjNDODgwLjI5LDMzNi4xMSA4NzkuNjIsMzM5LjI1IDg3OS42MiwzNDMuMDZDODc5LjYyLDM0Ni42OCA4ODAuMjksMzQ5LjczIDg4MS42MiwzNTIuMkM4ODIuOTYsMzU0LjY4IDg4NC43NywzNTYuNjMgODg3LjA1LDM1OC4wNkM4ODkuMzQsMzU5LjQ5IDg5MiwzNjAuNDkgODk1LjA1LDM2MS4wNkM4OTguMSwzNjEuNjMgOTAxLjI0LDM2MS45MSA5MDQuNDgsMzYxLjkxQzkxMi40OCwzNjEuOTEgOTE4LjY4LDM2MC41OCA5MjMuMDYsMzU3LjkyQzkyNy40NCwzNTUuMjUgOTMwLjY5LDM1Mi4wNiA5MzIuNzcsMzQ4LjM0QzkzNC44NiwzNDQuNjMgOTM2LjE2LDM0MC44NyA5MzYuNjIsMzM3LjA2QzkzNy4xLDMzMy4yNSA5MzcuMzMsMzMwLjIgOTM3LjM0LDMyNy45Mkw5MzcuMzQsMzEyLjc3TDkzNy4zNSwzMTIuNzdaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTEwMDQuMjEsMjM3LjMzTDEwNDIuOCwyMzcuMzNMMTA0Mi44LDI1Ny45TDEwNDMuNjUsMjU3LjlDMTA0OC43OSwyNDkuMzMgMTA1NS40NiwyNDMuMDkgMTA2My42NSwyMzkuMTlDMTA3MS44NCwyMzUuMjggMTA4MC4yMywyMzMuMzMgMTA4OC43OSwyMzMuMzNDMTA5OS42NiwyMzMuMzMgMTEwOC41NiwyMzQuODEgMTExNS41MiwyMzcuNzZDMTEyMi40NywyNDAuNzIgMTEyNy45NCwyNDQuODEgMTEzMS45NSwyNTAuMDVDMTEzNS45NSwyNTUuMjkgMTEzOC43NiwyNjEuNjcgMTE0MC4zOCwyNjkuMTlDMTE0MiwyNzYuNzIgMTE0Mi44MSwyODUuMDUgMTE0Mi44MSwyOTQuMkwxMTQyLjgxLDM4NS4wN0wxMTAyLjI0LDM4NS4wN0wxMTAyLjI0LDMwMS42M0MxMTAyLjI0LDI4OS40MyAxMTAwLjMzLDI4MC4zNCAxMDk2LjUzLDI3NC4zNEMxMDkyLjcxLDI2OC4zNCAxMDg1Ljk1LDI2NS4zNCAxMDc2LjIzLDI2NS4zNEMxMDY1LjE4LDI2NS4zNCAxMDU3LjE5LDI2OC42MyAxMDUyLjIzLDI3NS4yQzEwNDcuMjcsMjgxLjc2IDEwNDQuOCwyOTIuNTggMTA0NC44LDMwNy42M0wxMDQ0LjgsMzg1LjA3TDEwMDQuMjIsMzg1LjA3TDEwMDQuMjIsMjM3LjMzTDEwMDQuMjEsMjM3LjMzWiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik02MTIuMzcsMjExLjg0TDYxMi4zNywzODUuMDdMNjUyLjk1LDM4NS4wN0w2NTIuOTUsMjM0LjIxQzYzOS45MywyMjYuMjMgNjI2LjM2LDIxOC43NCA2MTIuMzcsMjExLjg0WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOTguNDMsMjE5LjIxQzIyMS45NSwxNTAuMzIgMzYyLjU4LDEyNS4wNSA1MTIuNTgsMTYyLjc4QzYwMi41NSwxODUuNCA2NzYuMDcsMjI5LjI4IDcyNC4wOSwyNzIuNjdDNzAyLjMsMjE1LjEyIDU5Ni42NSwxMzMuMDggNDUxLjE4LDEwNC45NkMyODYuNyw3My4xNiAxMjQuNDcsMTAxLjExIDEwNC4zOSwxNzQuMUM4OS44OSwyMjYuODMgMTUzLjU3LDI4OC42IDI1Mi4wNSwzMzAuODRDMjA3LjgxLDI5NS4wMiAxODYuMjksMjU0Ljc4IDE5OC40MywyMTkuMjFaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTcyNC4xNiwyNDcuNjJMNzI0LjE2LDE4MS4wM0w2ODMuNTcsMTgxLjAzTDY4My41NywyMDEuMjVDNzAwLjg4LDIxNi43MSA3MTQuNjEsMjMyLjQ1IDcyNC4xNiwyNDcuNjJaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS4wNDY5NiwwLDAsMS4xMjU3NywtNDYuOTkxMywtNTAuNDMyNSkiPgogICAgICAgICAgICA8cGF0aCBkPSJNMTIxNC45OCwzNjMuNDNDMTIxNC45OCwzNzUuNjkgMTIwNS4zNSwzODUuMzIgMTE5Mi44MywzODUuMzJDMTE4MC40MywzODUuMzIgMTE3MC41NCwzNzUuNjkgMTE3MC41NCwzNjMuNDNDMTE3MC41NCwzNTEuNDMgMTE4MC40MywzNDEuOCAxMTkyLjgzLDM0MS44QzEyMDUuMzUsMzQxLjggMTIxNC45OCwzNTEuNDMgMTIxNC45OCwzNjMuNDNaTTExNzYuMDgsMzYzLjQzQzExNzYuMDgsMzczLjA2IDExODMuMiwzODAuNyAxMTkyLjk2LDM4MC43QzEyMDIuNDUsMzgwLjcgMTIwOS40NCwzNzMuMDUgMTIwOS40NCwzNjMuNTZDMTIwOS40NCwzNTMuOTMgMTIwMi40NSwzNDYuMTUgMTE5Mi44MiwzNDYuMTVDMTE4My4yLDM0Ni4xNiAxMTc2LjA4LDM1My45NCAxMTc2LjA4LDM2My40M1pNMTE4OS4zOSwzNzQuNzdMMTE4NC4zOCwzNzQuNzdMMTE4NC4zOCwzNTMuMTRDMTE4Ni4zNiwzNTIuNzQgMTE4OS4xMywzNTIuNDggMTE5Mi42OSwzNTIuNDhDMTE5Ni43OCwzNTIuNDggMTE5OC42MiwzNTMuMTQgMTIwMC4yMSwzNTQuMDZDMTIwMS40LDM1NC45OCAxMjAyLjMyLDM1Ni43IDEyMDIuMzIsMzU4LjgxQzEyMDIuMzIsMzYxLjE4IDEyMDAuNDcsMzYzLjAzIDExOTcuODQsMzYzLjgyTDExOTcuODQsMzY0LjA4QzExOTkuOTUsMzY0Ljg3IDEyMDEuMTQsMzY2LjQ1IDEyMDEuOCwzNjkuMzVDMTIwMi40NiwzNzIuNjUgMTIwMi44NSwzNzMuOTcgMTIwMy4zOCwzNzQuNzZMMTE5Ny45NywzNzQuNzZDMTE5Ny4zMSwzNzMuOTcgMTE5Ni45MiwzNzEuOTkgMTE5Ni4yNiwzNjkuNDlDMTE5NS44NiwzNjcuMTIgMTE5NC41NSwzNjYuMDYgMTE5MS43OCwzNjYuMDZMMTE4OS40MSwzNjYuMDZMMTE4OS40MSwzNzQuNzdMMTE4OS4zOSwzNzQuNzdaTTExODkuNTMsMzYyLjUxTDExOTEuOSwzNjIuNTFDMTE5NC42NywzNjIuNTEgMTE5Ni45MSwzNjEuNTkgMTE5Ni45MSwzNTkuMzRDMTE5Ni45MSwzNTcuMzYgMTE5NS40NiwzNTYuMDQgMTE5Mi4yOSwzNTYuMDRDMTE5MC45NywzNTYuMDQgMTE5MC4wNSwzNTYuMTcgMTE4OS41MiwzNTYuM0wxMTg5LjUyLDM2Mi41MUwxMTg5LjUzLDM2Mi41MVoiIHN0eWxlPSJmaWxsOnJnYigxNzIsMjIsNDQpO2ZpbGwtcnVsZTpub256ZXJvOyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==" alt="Vulkan Logo" width="50%">
    </span>
</div>
<div id="header">
<h1>Vulkan<sup>®</sup> 1.0.235 - A Specification (with KHR extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan Working Group</span><br>
<span id="revnumber">version 1.0.235,</span>
<span id="revdate">2022-11-17 12:36:40Z</span>
<br><span id="revremark">from git branch: github-main commit: f4eb3e9a7acdef9ab62ac9af954a50409895ac6d</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html">Titlepage</a></li><li><a href="chap1.html">1. Preamble</a></li>
<li><a href="chap2.html">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap2.html#introduction-conventions">2.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap3.html">3. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap3.html#fundamentals-host-environment">3.1. Host and Device Environment</a></li>
<li><a href="chap3.html#fundamentals-execmodel">3.2. Execution Model</a></li>
<li><a href="chap3.html#fundamentals-objectmodel-overview">3.3. Object Model</a></li>
<li><a href="chap3.html#fundamentals-abi">3.4. Application Binary Interface</a></li>
<li><a href="chap3.html#fundamentals-commandsyntax">3.5. Command Syntax and Duration</a></li>
<li><a href="chap3.html#fundamentals-threadingbehavior">3.6. Threading Behavior</a></li>
<li><a href="chap3.html#fundamentals-validusage">3.7. Valid Usage</a></li>
<li><a href="chap3.html#fundamentals-returncodes">3.8. <code>VkResult</code> Return Codes</a></li>
<li><a href="chap3.html#fundamentals-numerics">3.9. Numeric Representation and Computation</a></li>
<li><a href="chap3.html#fundamentals-fixedconv">3.10. Fixed-Point Data Conversions</a></li>
<li><a href="chap3.html#fundamentals-common-objects">3.11. Common Object Types</a></li>
<li><a href="chap3.html#fundamentals-api-name-aliases">3.12. API Name Aliases</a></li>
</ul>
</li>
<li><a href="chap4.html">4. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap4.html#initialization-functionpointers">4.1. Command Function Pointers</a></li>
<li><a href="chap4.html#initialization-instances">4.2. Instances</a></li>
</ul>
</li>
<li><a href="chap5.html">5. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap5.html#devsandqueues-physical-device-enumeration">5.1. Physical Devices</a></li>
<li><a href="chap5.html#devsandqueues-devices">5.2. Devices</a></li>
<li><a href="chap5.html#devsandqueues-queues">5.3. Queues</a></li>
</ul>
</li>
<li><a href="chap6.html">6. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap6.html#commandbuffers-lifecycle">6.1. Command Buffer Lifecycle</a></li>
<li><a href="chap6.html#commandbuffers-pools">6.2. Command Pools</a></li>
<li><a href="chap6.html#commandbuffer-allocation">6.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap6.html#commandbuffers-recording">6.4. Command Buffer Recording</a></li>
<li><a href="chap6.html#commandbuffers-submission">6.5. Command Buffer Submission</a></li>
<li><a href="chap6.html#commandbuffers-submission-progress">6.6. Queue Forward Progress</a></li>
<li><a href="chap6.html#commandbuffers-secondary">6.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap6.html#commandbuffers-devicemask">6.8. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap7.html">7. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap7.html#synchronization-dependencies">7.1. Execution and Memory Dependencies</a></li>
<li><a href="chap7.html#synchronization-implicit">7.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap7.html#synchronization-fences">7.3. Fences</a></li>
<li><a href="chap7.html#synchronization-semaphores">7.4. Semaphores</a></li>
<li><a href="chap7.html#synchronization-events">7.5. Events</a></li>
<li><a href="chap7.html#synchronization-pipeline-barriers">7.6. Pipeline Barriers</a></li>
<li><a href="chap7.html#synchronization-memory-barriers">7.7. Memory Barriers</a></li>
<li><a href="chap7.html#synchronization-wait-idle">7.8. Wait Idle Operations</a></li>
<li><a href="chap7.html#synchronization-submission-host-writes">7.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap7.html#synchronization-device-group">7.10. Synchronization and Multiple Physical Devices</a></li>
</ul>
</li>
<li><a href="chap8.html">8. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap8.html#renderpass-creation">8.1. Render Pass Creation</a></li>
<li><a href="chap8.html#renderpass-compatibility">8.2. Render Pass Compatibility</a></li>
<li><a href="chap8.html#_framebuffers">8.3. Framebuffers</a></li>
<li><a href="chap8.html#renderpass-commands">8.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="chap9.html">9. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap9.html#shader-modules">9.1. Shader Modules</a></li>
<li><a href="chap9.html#shaders-execution">9.2. Shader Execution</a></li>
<li><a href="chap9.html#shaders-execution-memory-ordering">9.3. Shader Memory Access Ordering</a></li>
<li><a href="chap9.html#shaders-inputs">9.4. Shader Inputs and Outputs</a></li>
<li><a href="chap9.html#shaders-vertex">9.5. Vertex Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-control">9.6. Tessellation Control Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-evaluation">9.7. Tessellation Evaluation Shaders</a></li>
<li><a href="chap9.html#shaders-geometry">9.8. Geometry Shaders</a></li>
<li><a href="chap9.html#shaders-fragment">9.9. Fragment Shaders</a></li>
<li><a href="chap9.html#shaders-compute">9.10. Compute Shaders</a></li>
<li><a href="chap9.html#shaders-ray-generation">9.11. Ray Generation Shaders</a></li>
<li><a href="chap9.html#shaders-intersection">9.12. Intersection Shaders</a></li>
<li><a href="chap9.html#shaders-any-hit">9.13. Any-Hit Shaders</a></li>
<li><a href="chap9.html#shaders-closest-hit">9.14. Closest Hit Shaders</a></li>
<li><a href="chap9.html#shaders-miss">9.15. Miss Shaders</a></li>
<li><a href="chap9.html#shaders-callable">9.16. Callable Shaders</a></li>
<li><a href="chap9.html#shaders-interpolation-decorations">9.17. Interpolation decorations</a></li>
<li><a href="chap9.html#shaders-staticuse">9.18. Static Use</a></li>
<li><a href="chap9.html#shaders-scope">9.19. Scope</a></li>
<li><a href="chap9.html#shaders-derivative-operations">9.20. Derivative Operations</a></li>
<li><a href="chap9.html#shaders-helper-invocations">9.21. Helper Invocations</a></li>
</ul>
</li>
<li><a href="chap10.html">10. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap10.html#pipelines-compute">10.1. Compute Pipelines</a></li>
<li><a href="chap10.html#pipelines-graphics">10.2. Graphics Pipelines</a></li>
<li><a href="chap10.html#pipelines-ray-tracing">10.3. Ray Tracing Pipelines</a></li>
<li><a href="chap10.html#pipelines-destruction">10.4. Pipeline Destruction</a></li>
<li><a href="chap10.html#pipelines-multiple">10.5. Multiple Pipeline Creation</a></li>
<li><a href="chap10.html#pipelines-pipeline-derivatives">10.6. Pipeline Derivatives</a></li>
<li><a href="chap10.html#pipelines-cache">10.7. Pipeline Cache</a></li>
<li><a href="chap10.html#pipelines-specialization-constants">10.8. Specialization Constants</a></li>
<li><a href="chap10.html#pipelines-library">10.9. Pipeline Libraries</a></li>
<li><a href="chap10.html#pipelines-binding">10.10. Pipeline Binding</a></li>
<li><a href="chap10.html#pipelines-dynamic-state">10.11. Dynamic State</a></li>
<li><a href="chap10.html#pipelines-shader-information">10.12. Pipeline Properties and Shader Information</a></li>
</ul>
</li>
<li><a href="chap11.html">11. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#memory-host">11.1. Host Memory</a></li>
<li><a href="chap11.html#memory-device">11.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap12.html">12. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap12.html#resources-buffers">12.1. Buffers</a></li>
<li><a href="chap12.html#resources-buffer-views">12.2. Buffer Views</a></li>
<li><a href="chap12.html#resources-images">12.3. Images</a></li>
<li><a href="chap12.html#resources-image-layouts">12.4. Image Layouts</a></li>
<li><a href="chap12.html#resources-image-views">12.5. Image Views</a></li>
<li><a href="chap12.html#resources-acceleration-structures">12.6. Acceleration Structures</a></li>
<li><a href="chap12.html#resources-association">12.7. Resource Memory Association</a></li>
<li><a href="chap12.html#resources-sharing">12.8. Resource Sharing Mode</a></li>
<li><a href="chap12.html#resources-memory-aliasing">12.9. Memory Aliasing</a></li>
</ul>
</li>
<li><a href="chap13.html">13. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap13.html#samplers-YCbCr-conversion">13.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> conversion</a></li>
</ul>
</li>
<li><a href="chap14.html">14. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap14.html#descriptorsets-types">14.1. Descriptor Types</a></li>
<li><a href="chap14.html#descriptorsets-sets">14.2. Descriptor Sets</a></li>
<li><a href="chap14.html#descriptorsets-physical-storage-buffer">14.3. Physical Storage Buffer Access</a></li>
</ul>
</li>
<li><a href="chap15.html">15. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap15.html#interfaces-iointerfaces">15.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap15.html#interfaces-vertexinput">15.2. Vertex Input Interface</a></li>
<li><a href="chap15.html#interfaces-fragmentoutput">15.3. Fragment Output Interface</a></li>
<li><a href="chap15.html#interfaces-inputattachment">15.4. Fragment Input Attachment Interface</a></li>
<li><a href="chap15.html#interfaces-raypipeline">15.5. Ray Tracing Pipeline Interface</a></li>
<li><a href="chap15.html#interfaces-resources">15.6. Shader Resource Interface</a></li>
<li><a href="chap15.html#interfaces-builtin-variables">15.7. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap16.html">16. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_image_operations_overview">16.1. Image Operations Overview</a></li>
<li><a href="chap16.html#_conversion_formulas">16.2. Conversion Formulas</a></li>
<li><a href="chap16.html#_texel_input_operations">16.3. Texel Input Operations</a></li>
<li><a href="chap16.html#_texel_output_operations">16.4. Texel Output Operations</a></li>
<li><a href="chap16.html#textures-normalized-operations">16.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#_unnormalized_texel_coordinate_operations">16.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-integer-coordinate-operations">16.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-sample-operations">16.8. Image Sample Operations</a></li>
<li><a href="chap16.html#textures-instructions">16.9. Image Operation Steps</a></li>
<li><a href="chap16.html#textures-queries">16.10. Image Query Instructions</a></li>
</ul>
</li>
<li><a href="chap17.html">17. Queries</a>
<ul class="sectlevel2">
<li><a href="chap17.html#queries-pools">17.1. Query Pools</a></li>
<li><a href="chap17.html#queries-operation">17.2. Query Operation</a></li>
<li><a href="chap17.html#queries-occlusion">17.3. Occlusion Queries</a></li>
<li><a href="chap17.html#queries-pipestats">17.4. Pipeline Statistics Queries</a></li>
<li><a href="chap17.html#queries-timestamps">17.5. Timestamp Queries</a></li>
<li><a href="chap17.html#queries-performance">17.6. Performance Queries</a></li>
<li><a href="chap17.html#queries-result-status-only">17.7. Result Status Queries</a></li>
<li><a href="chap17.html#queries-video-encode-bitstream-buffer-range">17.8. Video Encode Bitstream Buffer Range</a></li>
</ul>
</li>
<li><a href="chap18.html">18. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#clears-outside">18.1. Clearing Images Outside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-inside">18.2. Clearing Images Inside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-values">18.3. Clear Values</a></li>
<li><a href="chap18.html#clears-filling-buffers">18.4. Filling Buffers</a></li>
<li><a href="chap18.html#clears-updating-buffers">18.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap19.html">19. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#copies-buffers">19.1. Copying Data Between Buffers</a></li>
<li><a href="chap19.html#copies-images">19.2. Copying Data Between Images</a></li>
<li><a href="chap19.html#copies-buffers-images">19.3. Copying Data Between Buffers and Images</a></li>
<li><a href="chap19.html#copies-imagescaling">19.4. Image Copies with Scaling</a></li>
<li><a href="chap19.html#copies-resolve">19.5. Resolving Multisample Images</a></li>
</ul>
</li>
<li><a href="chap20.html">20. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#drawing-primitive-topologies">20.1. Primitive Topologies</a></li>
<li><a href="chap20.html#drawing-primitive-order">20.2. Primitive Order</a></li>
<li><a href="chap20.html#drawing-primitive-shading">20.3. Programmable Primitive Shading</a></li>
</ul>
</li>
<li><a href="chap21.html">21. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap21.html#fxvertex-attrib">21.1. Vertex Attributes</a></li>
<li><a href="chap21.html#fxvertex-input">21.2. Vertex Input Description</a></li>
<li><a href="chap21.html#fxvertex-input-address-calculation">21.3. Vertex Input Address Calculation</a></li>
</ul>
</li>
<li><a href="chap22.html">22. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap22.html#_tessellator">22.1. Tessellator</a></li>
<li><a href="chap22.html#_tessellator_patch_discard">22.2. Tessellator Patch Discard</a></li>
<li><a href="chap22.html#tessellation-tessellator-spacing">22.3. Tessellator Spacing</a></li>
<li><a href="chap22.html#tessellation-primitive-order">22.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap22.html#tessellation-vertex-winding-order">22.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap22.html#tessellation-triangle-tessellation">22.6. Triangle Tessellation</a></li>
<li><a href="chap22.html#tessellation-quad-tessellation">22.7. Quad Tessellation</a></li>
<li><a href="chap22.html#tessellation-isoline-tessellation">22.8. Isoline Tessellation</a></li>
<li><a href="chap22.html#tessellation-point-mode">22.9. Tessellation Point Mode</a></li>
<li><a href="chap22.html#_tessellation_pipeline_state">22.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap23.html">23. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#geometry-input">23.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap23.html#geometry-output">23.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap23.html#geometry-invocations">23.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap23.html#geometry-ordering">23.4. Geometry Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap24.html">24. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap24.html#vertexpostproc-flatshading">24.1. Flat Shading</a></li>
<li><a href="chap24.html#vertexpostproc-clipping">24.2. Primitive Clipping</a></li>
<li><a href="chap24.html#vertexpostproc-clipping-shader-outputs">24.3. Clipping Shader Outputs</a></li>
<li><a href="chap24.html#vertexpostproc-coord-transform">24.4. Coordinate Transformations</a></li>
<li><a href="chap24.html#vertexpostproc-viewport">24.5. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap25.html">25. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap25.html#primsrast-discard">25.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap25.html#primsrast-order">25.2. Rasterization Order</a></li>
<li><a href="chap25.html#primsrast-multisampling">25.3. Multisampling</a></li>
<li><a href="chap25.html#primsrast-fragment-shading-rate">25.4. Fragment Shading Rates</a></li>
<li><a href="chap25.html#primsrast-sampleshading">25.5. Sample Shading</a></li>
<li><a href="chap25.html#primsrast-barycentric">25.6. Barycentric Interpolation</a></li>
<li><a href="chap25.html#primsrast-points">25.7. Points</a></li>
<li><a href="chap25.html#primsrast-lines">25.8. Line Segments</a></li>
<li><a href="chap25.html#primsrast-polygons">25.9. Polygons</a></li>
</ul>
</li>
<li><a href="chap26.html">26. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap26.html#fragops-scissor">26.1. Scissor Test</a></li>
<li><a href="chap26.html#fragops-samplemask">26.2. Sample Mask Test</a></li>
<li><a href="chap26.html#fragops-shader">26.3. Fragment Shading</a></li>
<li><a href="chap26.html#fragops-covg">26.4. Multisample Coverage</a></li>
<li><a href="chap26.html#fragops-ds-state">26.5. Depth and Stencil Operations</a></li>
<li><a href="chap26.html#fragops-dbt">26.6. Depth Bounds Test</a></li>
<li><a href="chap26.html#fragops-stencil">26.7. Stencil Test</a></li>
<li><a href="chap26.html#fragops-depth">26.8. Depth Test</a></li>
<li><a href="chap26.html#fragops-samplecount">26.9. Sample Counting</a></li>
<li><a href="chap26.html#fragops-coverage-reduction">26.10. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap27.html">27. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap27.html#framebuffer-blending">27.1. Blending</a></li>
<li><a href="chap27.html#framebuffer-logicop">27.2. Logical Operations</a></li>
<li><a href="chap27.html#framebuffer-color-write-mask">27.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap28.html">28. Dispatching Commands</a></li>
<li><a href="chap29.html">29. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap29.html#sparsememory-sparseresourcefeatures">29.1. Sparse Resource Features</a></li>
<li><a href="chap29.html#sparsememory-fully-resident">29.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-buffers">29.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-images">29.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-sparse-memory-aliasing">29.5. Sparse Memory Aliasing</a></li>
<li><a href="chap29.html#_sparse_resource_implementation_guidelines_informative">29.6. Sparse Resource Implementation Guidelines (Informative)</a></li>
<li><a href="chap29.html#sparsememory-resourceapi">29.7. Sparse Resource API</a></li>
</ul>
</li>
<li><a href="chap30.html">30. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap30.html#_wsi_platform">30.1. WSI Platform</a></li>
<li><a href="chap30.html#_wsi_surface">30.2. WSI Surface</a></li>
<li><a href="chap30.html#display">30.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap30.html#_querying_for_wsi_support">30.4. Querying for WSI Support</a></li>
<li><a href="chap30.html#_surface_queries">30.5. Surface Queries</a></li>
<li><a href="chap30.html#_device_group_queries">30.6. Device Group Queries</a></li>
<li><a href="chap30.html#present-wait">30.7. Present Wait</a></li>
<li><a href="chap30.html#_wsi_swapchain">30.8. WSI Swapchain</a></li>
</ul>
</li>
<li><a href="chap31.html">31. Deferred Host Operations</a>
<ul class="sectlevel2">
<li><a href="chap31.html#deferred-host-operations-requesting">31.1. Requesting Deferral</a></li>
<li><a href="chap31.html#_deferred_host_operations_api">31.2. Deferred Host Operations API</a></li>
</ul>
</li>
<li class="current"><a href="chap32.html">32. Acceleration Structures</a>
<ul class="sectlevel2">
<li class="current"><a href="chap32.html#acceleration-structure-def">32.1. Acceleration Structures</a></li>
<li class="current"><a href="chap32.html#host-acceleration-structure">32.2. Host Acceleration Structure Operations</a></li>
</ul>
</li>
<li><a href="chap33.html">33. Ray Traversal</a>
<ul class="sectlevel2">
<li><a href="chap33.html#ray-intersection-candidate-determination">33.1. Ray Intersection Candidate Determination</a></li>
<li><a href="chap33.html#ray-intersection-culling">33.2. Ray Intersection Culling</a></li>
<li><a href="chap33.html#ray-intersection-confirmation">33.3. Ray Intersection Confirmation</a></li>
<li><a href="chap33.html#ray-closest-hit-determination">33.4. Ray Closest Hit Determination</a></li>
<li><a href="chap33.html#ray-result-determination">33.5. Ray Result Determination</a></li>
</ul>
</li>
<li><a href="chap34.html">34. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="chap34.html#ray-tracing-shader-call">34.1. Shader Call Instructions</a></li>
<li><a href="chap34.html#ray-tracing-commands">34.2. Ray Tracing Commands</a></li>
<li><a href="chap34.html#shader-binding-table">34.3. Shader Binding Table</a></li>
<li><a href="chap34.html#ray-tracing-pipeline-stack">34.4. Ray Tracing Pipeline Stack</a></li>
</ul>
</li>
<li><a href="chap35.html">35. Video Decode and Encode Operations</a>
<ul class="sectlevel2">
<li><a href="chap35.html#_technical_terminology_and_semantics">35.1. Technical Terminology and Semantics</a></li>
<li><a href="chap35.html#_introduction">35.2. Introduction</a></li>
<li><a href="chap35.html#video-physical-device-capabilities">35.3. Video Physical Device Capabilities</a></li>
<li><a href="chap35.html#video-session-objects">35.4. Video Session Objects</a></li>
<li><a href="chap35.html#video-decode-operations">35.5. Video Decode Operations</a></li>
<li><a href="chap35.html#video-encode-operations">35.6. Video Encode Operations</a></li>
</ul>
</li>
<li><a href="chap36.html">36. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap36.html#extendingvulkan-instanceanddevicefunctionality">36.1. Instance and Device Functionality</a></li>
<li><a href="chap36.html#extendingvulkan-coreversions">36.2. Core Versions</a></li>
<li><a href="chap36.html#extendingvulkan-layers">36.3. Layers</a></li>
<li><a href="chap36.html#extendingvulkan-extensions">36.4. Extensions</a></li>
<li><a href="chap36.html#extendingvulkan-extensions-extensiondependencies">36.5. Extension Dependencies</a></li>
<li><a href="chap36.html#_compatibility_guarantees_informative">36.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap37.html">37. Features</a>
<ul class="sectlevel2">
<li><a href="chap37.html#features-requirements">37.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap38.html">38. Limits</a>
<ul class="sectlevel2">
<li><a href="chap38.html#limits-minmax">38.1. Limit Requirements</a></li>
</ul>
</li>
<li><a href="chap39.html">39. Formats</a>
<ul class="sectlevel2">
<li><a href="chap39.html#formats-definition">39.1. Format Definition</a></li>
<li><a href="chap39.html#formats-properties">39.2. Format Properties</a></li>
<li><a href="chap39.html#features-required-format-support">39.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap40.html">40. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap40.html#capabilities-image">40.1. Additional Image Capabilities</a></li>
<li><a href="chap40.html#capabilities-buffer">40.2. Additional Buffer Capabilities</a></li>
<li><a href="chap40.html#capabilities-semaphore">40.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap40.html#capabilities-fence">40.4. Optional Fence Capabilities</a></li>
</ul>
</li>
<li><a href="chap41.html">41. Debugging</a></li>
<li><a href="chap42.html">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap42.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap42.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap42.html#spirvenv-module-validation">Validation Rules within a Module</a></li>
<li><a href="chap42.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap42.html#spirvenv-image-signedness">Signedness of SPIR-V Image Accesses</a></li>
<li><a href="chap42.html#spirvenv-format-type-matching">Image Format and Type Matching</a></li>
<li><a href="chap42.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats And Vulkan Formats</a></li>
</ul>
</li>
<li><a href="chap43.html">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap43.html#memory-model-agent">Agent</a></li>
<li><a href="chap43.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap43.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap43.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap43.html#memory-model-references">Reference</a></li>
<li><a href="chap43.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap43.html#shader-call-related">Shader Call Related</a></li>
<li><a href="chap43.html#shader-call-order">Shader Call Order</a></li>
<li><a href="chap43.html#memory-model-scope">Scope</a></li>
<li><a href="chap43.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap43.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap43.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap43.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap43.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap43.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap43.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap43.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap43.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap43.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap43.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap43.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap43.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap43.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap43.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap43.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap43.html#memory-model-acyclicity">Acyclicity</a></li>
<li><a href="chap43.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap43.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap43.html#memory-model-informative-descriptions">Descriptions (Informative)</a></li>
<li><a href="chap43.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
</ul>
</li>
<li><a href="chap44.html">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap44.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap44.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap44.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap45.html">Appendix D: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap45.html#versions-1.0">Version 1.0</a></li>
</ul>
</li>
<li><a href="chap46.html">Appendix E: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap46.html#extension-appendices-list">List of Extensions</a></li>
<li><a href="chap46.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
</ul>
</li>
<li><a href="chap47.html">Appendix F: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap47.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap47.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap47.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
<li><a href="chap47.html#boilerplate-video-std-headers">Video Std Headers (Informative)</a></li>
</ul>
</li>
<li><a href="chap48.html">Appendix G: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap48.html#_repeatability">Repeatability</a></li>
<li><a href="chap48.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap48.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap48.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap49.html">Appendix H: Lexicon</a>
<ul class="sectlevel2">
<li><a href="chap49.html#glossary">Glossary</a></li>
<li><a href="chap49.html#lexicon-common-abbreviations">Common Abbreviations</a></li>
<li><a href="chap49.html#lexicon-video-abbreviations">Video-Specific Abbreviations</a></li>
<li><a href="chap49.html#lexicon-prefixes">Prefixes</a></li>
</ul>
</li>
<li><a href="chap50.html">Appendix I: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap50.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap50.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="loading_msg" class="hidden" hidden=""><p>Loading… please wait.</p></div>
<!--ChunkedSearchboxMarker-->
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
<div id="content" class="loadable"><div class="sect1">
<h2 id="acceleration-structure"><a class="anchor" href="chap32.html"></a>32. Acceleration Structures</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="acceleration-structure-def"><a class="anchor" href="chap32.html#acceleration-structure-def"></a>32.1. Acceleration Structures</h3>
<div class="paragraph">
<p><em>Acceleration structures</em> are data structures used by the implementation to
efficiently manage scene geometry as it is <a href="chap33.html">traversed during
a ray tracing query</a>.
The application is responsible for managing acceleration structure objects
(see <a href="chap12.html#resources-acceleration-structures">Acceleration Structures</a>),
including allocation, destruction, executing builds or updates, and
synchronizing resources used during ray tracing queries.</p>
</div>
<div class="paragraph">
<p>There are two types of acceleration structures, <em>top level acceleration
structures</em> and <em>bottom level acceleration structures</em>.</p>
</div>
<div class="paragraph">
<p>An acceleration structure is considered to be constructed if an
<a href="chap32.html#acceleration-structure-building">acceleration structure build command</a> or
<a href="chap32.html#acceleration-structure-copying">copy command</a> has been executed with the
given acceleration structure as the destination.</p>
</div>
<div id="fig-accelstruct" class="imageblock text-center">
<div class="content">
<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="122.6349mm" height="111.36717mm" viewBox="0 0 122.6349 111.36717" version="1.1" id="svg4035" inkscape:version="0.92.3 (2405546, 2018-03-11)" sodipodi:docname="accelstruct.svg">
  <defs id="defs4029">
    <marker inkscape:isstock="true" style="overflow:visible" id="marker5699" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Lend">
      <path transform="matrix(-0.8,0,0,-0.8,-10,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5697" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path4902" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-2" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-7" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-1" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-5" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-0" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-3" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
  </defs>
  <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="205.45633" inkscape:cy="48.906685" inkscape:document-units="mm" inkscape:current-layer="layer1" showgrid="false" inkscape:window-width="2560" inkscape:window-height="1538" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="0"></sodipodi:namedview>
  <metadata id="metadata4032">
    <rdf:rdf>
      <cc:work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
        <dc:title></dc:title>
      </cc:work>
    </rdf:rdf>
  </metadata>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-36.531136,-66.301968)">
    <rect id="rect4037" width="117.55059" height="33.639881" x="39.498512" y="66.434525" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect id="rect4037-1" width="34.855381" height="33.760372" x="54.720116" y="143.83646" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.14462024;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect id="rect4037-1-1" width="34.855381" height="33.760372" x="120.36967" y="143.83646" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.14462024;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874" width="34.206844" height="21.355652" x="36.663692" y="109.68093" ry="6.6145835"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874-5" width="34.206844" height="21.355654" x="82.682297" y="109.68093" ry="6.6145835"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874-4" width="34.206844" height="21.355654" x="124.82664" y="109.68093" ry="6.6145835"></rect>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend)" d="m 53.861607,100.45238 v 9.07143" id="path4897" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-2)" d="m 100.35268,100.00656 v 9.07143" id="path4897-7" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-1)" d="m 141.17411,100.38454 v 9.07144" id="path4897-3" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.30833337;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-0)" d="m 137.20536,131.26903 v 12.31946" id="path4897-4" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker5699)" d="m 52.727677,131.25744 v 7.18155 h 18.898811 v 5.29166" id="path5689" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.2711173px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 100.35268,130.50149 v 7.9375 H 71.626488" id="path5743" inkscape:connector-curvature="0"></path>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="46.680061" y="85.333328" id="text5747"><tspan sodipodi:role="line" x="46.680061" y="85.333328" style="font-size:6.3499999px;stroke-width:0.26458332" id="tspan5749">Top-Level Acceleration Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:0.75;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="55.942436" y="153.21938" id="text5747-1"><tspan sodipodi:role="line" x="55.942436" y="153.21938" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5749-5">Bottom-Level</tspan><tspan sodipodi:role="line" x="55.942436" y="161.15688" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5773">Acceleration</tspan><tspan sodipodi:role="line" x="55.942436" y="169.09438" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5777">Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:0.75;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="120.77655" y="153.21938" id="text5747-1-2"><tspan sodipodi:role="line" x="120.77655" y="153.21938" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5749-5-0">Bottom-Level</tspan><tspan sodipodi:role="line" x="120.77655" y="161.15688" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5773-3">Acceleration</tspan><tspan sodipodi:role="line" x="120.77655" y="169.09438" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5777-3">Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="41.388393" y="117.02173" id="text5810"><tspan sodipodi:role="line" id="tspan5808" x="41.388393" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="41.388393" y="122.31339" style="stroke-width:0.26458332" id="tspan5812">and shading</tspan><tspan sodipodi:role="line" x="41.388393" y="127.60506" style="stroke-width:0.26458332" id="tspan5814">information</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="87.024742" y="117.02173" id="text5810-7"><tspan sodipodi:role="line" id="tspan5808-6" x="87.024742" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="87.024742" y="122.31339" style="stroke-width:0.26458332" id="tspan5812-7">and shading</tspan><tspan sodipodi:role="line" x="87.024742" y="127.60506" style="stroke-width:0.26458332" id="tspan5814-8">information</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="129.92503" y="117.02173" id="text5810-73"><tspan sodipodi:role="line" id="tspan5808-5" x="129.92503" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="129.92503" y="122.31339" style="stroke-width:0.26458332" id="tspan5812-1">and shading</tspan><tspan sodipodi:role="line" x="129.92503" y="127.60506" style="stroke-width:0.26458332" id="tspan5814-80">information</tspan></text>
  </g>
</svg>
</div>
<div class="title">Figure 22. Acceleration Structure</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Caption</div>
<div class="paragraph">
<p>The diagram shows the relationship between top and bottom level acceleration
structures.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-geometry"><a class="anchor" href="chap32.html#acceleration-structure-geometry"></a>32.1.1. Geometry</h4>
<div class="paragraph">
<p><em>Geometries</em> refer to a triangle or axis-aligned bounding box.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-top-level"><a class="anchor" href="chap32.html#acceleration-structure-top-level"></a>32.1.2. Top Level Acceleration Structures</h4>
<div class="paragraph">
<p>Opaque acceleration structure for an array of instances.
The descriptor or device address referencing this is the starting point for
traversal.</p>
</div>
<div class="paragraph">
<p>The top level acceleration structure takes a reference to any bottom level
acceleration structure referenced by its instances.
Those bottom level acceleration structure objects <strong class="purple">must</strong> be valid when the
top level acceleration structure is accessed.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-bottom-level"><a class="anchor" href="chap32.html#acceleration-structure-bottom-level"></a>32.1.3. Bottom Level Acceleration Structures</h4>
<div class="paragraph">
<p>Opaque acceleration structure for an array of geometries.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-update"><a class="anchor" href="chap32.html#acceleration-structure-update"></a>32.1.4. Acceleration Structure Update Rules</h4>
<div class="paragraph">
<p>The API defines two types of operations to produce acceleration structures
from geometry:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>build</em> operation is used to construct an acceleration structure.</p>
</li>
<li>
<p>An <em>update</em> operation is used to modify an existing acceleration
structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An update operation imposes certain constraints on the input, in exchange
for considerably faster execution.
When performing an update, the application is required to provide a full
description of the acceleration structure, but is prohibited from changing
anything other than instance definitions, transform matrices, and vertex or
AABB positions.
All other aspects of the description <strong class="purple">must</strong> exactly match the one from the
original build.</p>
</div>
<div class="paragraph">
<p>More precisely, the application <strong class="purple">must</strong> not use an update operation to do any
of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change primitives or instances from <em>active</em> to <em>inactive</em>, or vice
versa (as defined in <a href="chap32.html#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a>).</p>
</li>
<li>
<p>Change the index or vertex formats of triangle geometry.</p>
</li>
<li>
<p>Change triangle geometry transform pointers from null to non-null or
vice versa.</p>
</li>
<li>
<p>Change the number of geometries or instances in the structure.</p>
</li>
<li>
<p>Change the geometry flags for any geometry in the structure.</p>
</li>
<li>
<p>Change the number of vertices or primitives for any geometry in the
structure.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-inactive-prims"><a class="anchor" href="chap32.html#acceleration-structure-inactive-prims"></a>32.1.5. Inactive Primitives and Instances</h4>
<div class="paragraph">
<p>Acceleration structures allow the use of particular input values to signal
<em>inactive</em> primitives or instances.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> triangle is one for which the first (X) component of any
vertex is NaN.
If any other vertex component is NaN, and the first is not, the behavior is
undefined.
If the vertex format does not have a NaN representation, then all triangles
are considered active.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> instance is one whose acceleration structure handle is
<a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> AABB is one for which the minimum X coordinate is NaN.
If any other component is NaN, and the first is not, the behavior is
undefined.</p>
</div>
<div class="paragraph">
<p>In the above definitions, “NaN” refers to any type of NaN.
Signaling, non-signaling, quiet, loud, or otherwise.</p>
</div>
<div class="paragraph">
<p>An inactive object is considered invisible to all rays, and <strong class="purple">should</strong> not be
represented in the acceleration structure.
Implementations <strong class="purple">should</strong> ensure that the presence of inactive objects does
not seriously degrade traversal performance.</p>
</div>
<div class="paragraph">
<p>Inactive objects are counted in the auto-generated index sequences which are
provided to shaders via <code>InstanceId</code> and <code>PrimitiveId</code> SPIR-V
decorations.
This allows objects in the scene to change freely between the active and
inactive states, without affecting the layout of any arrays which are being
indexed using the ID values.</p>
</div>
<div class="paragraph">
<p>Any transition between the active and inactive states requires a full
acceleration structure rebuild.
Applications <strong class="purple">must</strong> not perform an acceleration structure update where an
object is active in the source acceleration structure but would be inactive
in the destination, or vice versa.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-building"><a class="anchor" href="chap32.html#acceleration-structure-building"></a>32.1.6. Building Acceleration Structures</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures call:</p>
</div>
<div id="vkCmdBuildAccelerationStructuresKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkCmdBuildAccelerationStructuresKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">infoCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureBuildGeometryInfoKHR</span><span class="o">*</span> <span class="n">pInfos</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureBuildRangeInfoKHR</span><span class="o">*</span> <span class="k">const</span><span class="o">*</span> <span class="n">ppBuildRangeInfos</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.
It specifies the number of the <code>pInfos</code> structures and
<code>ppBuildRangeInfos</code> pointers that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>ppBuildRangeInfos</code> is a pointer to an array of <code>infoCount</code>
pointers to arrays of <a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a>
structures.
Each <code>ppBuildRangeInfos</code>[i] is a pointer to an array of
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vkCmdBuildAccelerationStructuresKHR</code> command provides the ability
to initiate multiple acceleration structures builds, however there is no
ordering or synchronization implied between any of the individual
acceleration structure builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that an application <strong class="purple">cannot</strong> build a top-level acceleration
structure in the same <a href="chap32.html#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a> call as the
associated bottom-level or instance acceleration structures are being built.
There also <strong class="purple">cannot</strong> be any memory aliasing between any acceleration structure
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="acceleration-structure-scratch" class="paragraph">
<p>Accesses to the acceleration structure scratch buffers as identified by the
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>scratchData</code> buffer
device addresses <strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with
the <code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> or
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>.
Similarly for accesses to each
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>srcAccelerationStructure</code>
and
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>dstAccelerationStructure</code>.</p>
</div>
<div class="paragraph">
<p>Accesses to other input buffers as identified by any used values of
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>,
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>,
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>,
<a href="chap32.html#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code>, and
<a href="chap32.html#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_SHADER_READ_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-mode-04628" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-mode-04628"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-mode-04628</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="chap32.html#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-srcAccelerationStructure-04629" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-srcAccelerationStructure-04629"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-srcAccelerationStructure-04629</span><br>

If the <code>srcAccelerationStructure</code> member of any element of
<code>pInfos</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be a valid
<a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-04630" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-04630"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-04630</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03403" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03403"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03403</span><br>

The <code>srcAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03698" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03698"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03698</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03800" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03800"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03800</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03699" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03699"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03699</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03700" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03700"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03700</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03663" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03663"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03663</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>,
<a href="chap32.html#acceleration-structure-inactive-prims">inactive primitives</a> in its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made active</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03664" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03664"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03664</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, active primitives
in its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made
<a href="chap32.html#acceleration-structure-inactive-prims">inactive</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-None-03407" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-None-03407"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-None-03407</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be referenced by the <code>geometry.instances.data</code> member of
any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other
element of <code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03701" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03701"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03701</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>srcAccelerationStructure</code> member of
any other element of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, which is accessed
by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03702" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03702"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03702</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>dstAccelerationStructure</code> member of
any other element of <code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03703" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03703"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03703</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03704" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03704"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03704</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03705" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03705"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03705</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>srcAccelerationStructure</code> member of any element
of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> (including the
same element), which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03706" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03706"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03706</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing any acceleration structure referenced by the
<code>geometry.instances.data</code> member of any element of <code>pGeometries</code>
or <code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03667" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03667"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03667</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> have previously been
constructed with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code> in the
build</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03668" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03668"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03668</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
members <strong class="purple">must</strong> either be the same <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a>, or
not have any <a href="chap12.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03758" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03758"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03758</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>geometryCount</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03759" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03759"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03759</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>flags</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03760" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03760"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03760</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>type</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03761" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03761"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03761</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>geometryType</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03762" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03762"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03762</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>flags</code> member
<strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03763" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03763"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03763</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.vertexFormat</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03764" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03764"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03764</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.maxVertex</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03765" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03765"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03765</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.indexType</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03766" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03766"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03766</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> address was <code>NULL</code> when
<code>srcAccelerationStructure</code> was last built, then it <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03767" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03767"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03767</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> address was not <code>NULL</code> when
<code>srcAccelerationStructure</code> was last built, then it <strong class="purple">must</strong> not be
<code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03768" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03768"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03768</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
then the value of each index referenced <strong class="purple">must</strong> be the same as the
corresponding index value when <code>srcAccelerationStructure</code> was last
built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-primitiveCount-03769" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-primitiveCount-03769"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-primitiveCount-03769</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, its <code>primitiveCount</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-firstVertex-03770" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-firstVertex-03770"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-firstVertex-03770</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, if the corresponding geometry uses indices, its
<code>firstVertex</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03801" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03801"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03801</span><br>

For each element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the corresponding
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxInstanceCount</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03707" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03707"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03707</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03708" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03708"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03708</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03709" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03709"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03709</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03671" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03671"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03671</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> +  N - 1 <strong class="purple">must</strong> be in
the buffer device address range of the same buffer, where N is given by
the <code>buildScratchSize</code> member of the
<a href="chap12.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03672" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03672"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03672</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> +  N - 1 <strong class="purple">must</strong> be in
the buffer device address range of the same buffer, where N is given by
the <code>updateScratchSize</code> member of the
<a href="chap12.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-geometry-03673" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-geometry-03673"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-geometry-03673</span><br>

The buffers from which the buffer device addresses for all of the
<code>geometry.triangles.vertexData</code>, <code>geometry.triangles.indexData</code>,
<code>geometry.triangles.transformData</code>, <code>geometry.aabbs.data</code>, and
<code>geometry.instances.data</code> members of all
<code>pInfos</code>[i].<code>pGeometries</code> and <code>pInfos</code>[i].<code>ppGeometries</code>
are queried <strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_ACCELERATION_STRUCTURE_BUILD_INPUT_READ_ONLY_BIT_KHR</code>
usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03674" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03674"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03674</span><br>

The buffer from which the buffer device address
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> is queried <strong class="purple">must</strong> have
been created with <code>VK_BUFFER_USAGE_STORAGE_BUFFER_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03802" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03802"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03802</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a valid device address obtained from
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03803" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03803"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03803</span><br>

For each element of <code>pInfos</code>, if <code>scratchData.deviceAddress</code> is
the address of a non-sparse buffer then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03710" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03710"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03710</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a multiple of
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>minAccelerationStructureScratchOffsetAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03804" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03804"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03804</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03805" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03805"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03805</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.vertexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03711" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03711"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03711</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to
the size in bytes of the smallest component of the format in
<code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03806" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03806"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03806</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03807" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03807"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03807</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
if <code>geometry.triangles.indexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03712" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03712"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03712</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and with
<code>geometry.triangles.indexType</code> not equal to
<code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to the
size in bytes of the type in <code>indexType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03808" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03808"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03808</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be a valid device address obtained from
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03809" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03809"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03809</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03810" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03810"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03810</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03811" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03811"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03811</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device address
obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03812" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03812"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03812</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, if
<code>geometry.aabbs.data.deviceAddress</code> is the address of a non-sparse
buffer then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03714" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03714"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03714</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03715" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03715"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03715</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_FALSE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03716" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03716"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03716</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03717" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03717"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03717</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, each element of
<code>geometry.instances.data.deviceAddress</code> in device memory <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03813" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03813"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03813</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03814" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03814"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03814</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if
<code>geometry.instances.data.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-06707" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-06707"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-06707</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, each
<a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address containing a value obtained from
<a href="chap12.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a> or <code>0</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03675" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03675"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03675</span><br>

For each <code>pInfos</code>[i], <code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been
created with a value of
<a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>size</code> greater than or
equal to the memory size required by the build operation, as returned by
<a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with <span class="eq"><code>pBuildInfo</code>
= <code>pInfos</code>[i]</span> and with each element of the
<code>pMaxPrimitiveCounts</code> array greater than or equal to the equivalent
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> values for <code>j</code> in
<span class="eq">[0,<code>pInfos</code>[i].<code>geometryCount</code>)</span></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676</span><br>

Each element of <code>ppBuildRangeInfos</code>[i] <strong class="purple">must</strong> be a valid pointer to
an array of <code>pInfos</code>[i].<code>geometryCount</code>
<code>VkAccelerationStructureBuildRangeInfoKHR</code> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter</span><br>
 <code>ppBuildRangeInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-recording" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-cmdpool" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-renderpass" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-renderpass"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-videocoding" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-videocoding"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-infoCount-arraylength" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresKHR-infoCount-arraylength"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures with some parameters sourced on the device
call:</p>
</div>
<div id="vkCmdBuildAccelerationStructuresIndirectKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkCmdBuildAccelerationStructuresIndirectKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">infoCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureBuildGeometryInfoKHR</span><span class="o">*</span> <span class="n">pInfos</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkDeviceAddress</span><span class="o">*</span>                      <span class="n">pIndirectDeviceAddresses</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span>                             <span class="n">pIndirectStrides</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span> <span class="k">const</span><span class="o">*</span>                      <span class="n">ppMaxPrimitiveCounts</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>pIndirectDeviceAddresses</code> is a pointer to an array of
<code>infoCount</code> buffer device addresses which point to
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
<li>
<p><code>pIndirectStrides</code> is a pointer to an array of <code>infoCount</code> byte
strides between elements of <code>pIndirectDeviceAddresses</code>.</p>
</li>
<li>
<p><code>ppMaxPrimitiveCounts</code> is a pointer to an array of <code>infoCount</code>
pointers to arrays of <code>pInfos</code>[i].<code>geometryCount</code> values
indicating the maximum number of primitives that will be built by this
command for each geometry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to acceleration structures, scratch buffers, vertex buffers, index
buffers, and instance buffers must be synchronized as with
<a href="chap32.html#acceleration-structure-scratch">vkCmdBuildAccelerationStructuresKHR</a>.</p>
</div>
<div class="paragraph">
<p>Accesses to any element of <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-mode-04628" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-mode-04628"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-mode-04628</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="chap32.html#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-srcAccelerationStructure-04629" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-srcAccelerationStructure-04629"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-srcAccelerationStructure-04629</span><br>

If the <code>srcAccelerationStructure</code> member of any element of
<code>pInfos</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be a valid
<a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-04630" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-04630"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-04630</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03403" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03403"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03403</span><br>

The <code>srcAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03698" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03698"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03698</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03800" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03800"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03800</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03699" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03699"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03699</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03700" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03700"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03700</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03663" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03663"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03663</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>,
<a href="chap32.html#acceleration-structure-inactive-prims">inactive primitives</a> in its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made active</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03664" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03664"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03664</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, active primitives
in its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made
<a href="chap32.html#acceleration-structure-inactive-prims">inactive</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-None-03407" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-None-03407"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-None-03407</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be referenced by the <code>geometry.instances.data</code> member of
any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other
element of <code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03701" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03701"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03701</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>srcAccelerationStructure</code> member of
any other element of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, which is accessed
by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03702" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03702"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03702</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>dstAccelerationStructure</code> member of
any other element of <code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03703" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03703"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03703</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03704" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03704"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03704</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03705" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03705"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03705</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>srcAccelerationStructure</code> member of any element
of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> (including the
same element), which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03706" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03706"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03706</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing any acceleration structure referenced by the
<code>geometry.instances.data</code> member of any element of <code>pGeometries</code>
or <code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03667" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03667"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03667</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> have previously been
constructed with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code> in the
build</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03668" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03668"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03668</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
members <strong class="purple">must</strong> either be the same <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a>, or
not have any <a href="chap12.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03758" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03758"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03758</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>geometryCount</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03759" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03759"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03759</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>flags</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03760" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03760"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03760</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>type</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03761" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03761"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03761</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>geometryType</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03762" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03762"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03762</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>flags</code> member
<strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03763" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03763"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03763</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.vertexFormat</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03764" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03764"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03764</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.maxVertex</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03765" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03765"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03765</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.indexType</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03766" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03766"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03766</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> address was <code>NULL</code> when
<code>srcAccelerationStructure</code> was last built, then it <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03767" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03767"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03767</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> address was not <code>NULL</code> when
<code>srcAccelerationStructure</code> was last built, then it <strong class="purple">must</strong> not be
<code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03768" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03768"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03768</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
then the value of each index referenced <strong class="purple">must</strong> be the same as the
corresponding index value when <code>srcAccelerationStructure</code> was last
built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-primitiveCount-03769" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-primitiveCount-03769"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-primitiveCount-03769</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, its <code>primitiveCount</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-firstVertex-03770" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-firstVertex-03770"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-firstVertex-03770</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, if the corresponding geometry uses indices, its
<code>firstVertex</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03801" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03801"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03801</span><br>

For each element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the corresponding
<code>ppMaxPrimitiveCounts</code>[i][j] <strong class="purple">must</strong> be less than or equal to
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxInstanceCount</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03707" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03707"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03707</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03708" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03708"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03708</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03709" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03709"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03709</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03671" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03671"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03671</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> +  N - 1 <strong class="purple">must</strong> be in
the buffer device address range of the same buffer, where N is given by
the <code>buildScratchSize</code> member of the
<a href="chap12.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03672" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03672"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03672</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> +  N - 1 <strong class="purple">must</strong> be in
the buffer device address range of the same buffer, where N is given by
the <code>updateScratchSize</code> member of the
<a href="chap12.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-geometry-03673" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-geometry-03673"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-geometry-03673</span><br>

The buffers from which the buffer device addresses for all of the
<code>geometry.triangles.vertexData</code>, <code>geometry.triangles.indexData</code>,
<code>geometry.triangles.transformData</code>, <code>geometry.aabbs.data</code>, and
<code>geometry.instances.data</code> members of all
<code>pInfos</code>[i].<code>pGeometries</code> and <code>pInfos</code>[i].<code>ppGeometries</code>
are queried <strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_ACCELERATION_STRUCTURE_BUILD_INPUT_READ_ONLY_BIT_KHR</code>
usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03674" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03674"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03674</span><br>

The buffer from which the buffer device address
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> is queried <strong class="purple">must</strong> have
been created with <code>VK_BUFFER_USAGE_STORAGE_BUFFER_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03802" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03802"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03802</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a valid device address obtained from
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03803" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03803"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03803</span><br>

For each element of <code>pInfos</code>, if <code>scratchData.deviceAddress</code> is
the address of a non-sparse buffer then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03710" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03710"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03710</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a multiple of
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>minAccelerationStructureScratchOffsetAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03804" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03804"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03804</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03805" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03805"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03805</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.vertexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03711" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03711"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03711</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to
the size in bytes of the smallest component of the format in
<code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03806" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03806"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03806</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03807" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03807"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03807</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
if <code>geometry.triangles.indexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03712" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03712"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03712</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and with
<code>geometry.triangles.indexType</code> not equal to
<code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to the
size in bytes of the type in <code>indexType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03808" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03808"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03808</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be a valid device address obtained from
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03809" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03809"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03809</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03810" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03810"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03810</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03811" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03811"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03811</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device address
obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03812" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03812"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03812</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, if
<code>geometry.aabbs.data.deviceAddress</code> is the address of a non-sparse
buffer then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03714" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03714"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03714</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03715" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03715"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03715</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_FALSE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03716" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03716"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03716</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03717" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03717"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03717</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, each element of
<code>geometry.instances.data.deviceAddress</code> in device memory <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03813" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03813"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03813</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03814" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03814"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03814</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if
<code>geometry.instances.data.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-06707" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-06707"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-06707</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, each
<a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address containing a value obtained from
<a href="chap12.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a> or <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03645" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03645"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03645</span><br>

For any element of <code>pIndirectDeviceAddresses</code>, if the buffer from
which it was queried is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03646" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03646"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03646</span><br>

For any element of <code>pIndirectDeviceAddresses</code>[i], all device
addresses between <code>pIndirectDeviceAddresses</code>[i] and
<span class="eq"><code>pIndirectDeviceAddresses</code>[i] + 
(<code>pInfos</code>[i].<code>geometryCount</code> × <code>pIndirectStrides</code>[i]) -
1</span> <strong class="purple">must</strong> be in the buffer device address range of the same buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03647" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03647"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03647</span><br>

For any element of <code>pIndirectDeviceAddresses</code>, the buffer from which
it was queried <strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_INDIRECT_BUFFER_BIT</code> bit set</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03648" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03648"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03648</span><br>

Each element of <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be a multiple of
<code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-03787" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-03787"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-03787</span><br>

Each element of <code>pIndirectStrides</code> <strong class="purple">must</strong> be a multiple of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-03649" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-03649"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-03649</span><br>

<code>commandBuffer</code> <strong class="purple">must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-accelerationStructureIndirectBuild-03650" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-accelerationStructureIndirectBuild-03650"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-accelerationStructureIndirectBuild-03650</span><br>

The <a href="chap37.html#features-accelerationStructureIndirectBuild"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureIndirectBuild</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03651" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03651"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03651</span><br>

Each <a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structure referenced
by any element of <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be a valid
<a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03652" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03652"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03652</span><br>

<code>pInfos</code>[i].<code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been created
with a value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>size</code>
greater than or equal to the memory size required by the build
operation, as returned by <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a>
with <span class="eq"><code>pBuildInfo</code> = <code>pInfos</code>[i]</span> and
<span class="eq"><code>pMaxPrimitiveCounts</code> = <code>ppMaxPrimitiveCounts</code>[i]</span></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-03653" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-03653"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-03653</span><br>

Each <code>ppMaxPrimitiveCounts</code>[i][j] <strong class="purple">must</strong> be greater than or equal to
the the <code>primitiveCount</code> value specified by the
<a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structure located at
<span class="eq"><code>pIndirectDeviceAddresses</code>[i] +  (<code>j</code> ×
<code>pIndirectStrides</code>[i])</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-parameter</span><br>
 <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <code>VkDeviceAddress</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-parameter</span><br>
 <code>pIndirectStrides</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-parameter" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-parameter</span><br>
 <code>ppMaxPrimitiveCounts</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-recording" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-cmdpool" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-renderpass" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-renderpass"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-videocoding" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-videocoding"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-infoCount-arraylength" href="chap32.html#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-infoCount-arraylength"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureBuildGeometryInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkAccelerationStructureBuildGeometryInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureBuildGeometryInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                     <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                         <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureTypeKHR</span>                      <span class="n">type</span><span class="p">;</span>
    <span class="n">VkBuildAccelerationStructureFlagsKHR</span>                <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkBuildAccelerationStructureModeKHR</span>                 <span class="n">mode</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureKHR</span>                          <span class="n">srcAccelerationStructure</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureKHR</span>                          <span class="n">dstAccelerationStructure</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                            <span class="n">geometryCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureGeometryKHR</span><span class="o">*</span>           <span class="n">pGeometries</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureGeometryKHR</span><span class="o">*</span> <span class="k">const</span><span class="o">*</span>    <span class="n">ppGeometries</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressKHR</span>                            <span class="n">scratchData</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureBuildGeometryInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>type</code> is a <a href="chap12.html#VkAccelerationStructureTypeKHR">VkAccelerationStructureTypeKHR</a> value specifying
the type of acceleration structure being built.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="chap12.html#VkBuildAccelerationStructureFlagBitsKHR">VkBuildAccelerationStructureFlagBitsKHR</a> specifying additional
parameters of the acceleration structure.</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap32.html#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value
specifying the type of operation to perform.</p>
</li>
<li>
<p><code>srcAccelerationStructure</code> is a pointer to an existing acceleration
structure that is to be used to update the <code>dst</code> acceleration
structure when <code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>.</p>
</li>
<li>
<p><code>dstAccelerationStructure</code> is a pointer to the target acceleration
structure for the build.</p>
</li>
<li>
<p><code>geometryCount</code> specifies the number of geometries that will be
built into <code>dstAccelerationStructure</code>.</p>
</li>
<li>
<p><code>pGeometries</code> is a pointer to an array of
<a href="chap32.html#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures.</p>
</li>
<li>
<p><code>ppGeometries</code> is a pointer to an array of pointers to
<a href="chap32.html#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures.</p>
</li>
<li>
<p><code>scratchData</code> is the device or host address to memory that will be
used as scratch memory for the build.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only one of <code>pGeometries</code> or <code>ppGeometries</code> <strong class="purple">can</strong> be a valid pointer,
the other <strong class="purple">must</strong> be <code>NULL</code>.
Each element of the non-<code>NULL</code> array describes the data used to build each
acceleration structure geometry.</p>
</div>
<div id="acceleration-structure-geometry-index" class="paragraph">
<p>The index of each element of the <code>pGeometries</code> or <code>ppGeometries</code>
members of <a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> is used as the
<em>geometry index</em> during ray traversal.
The geometry index is available in ray shaders via the
<a href="chap15.html#interfaces-builtin-variables-raygeometryindex"><code>RayGeometryIndexKHR</code>
built-in</a>, and is <a href="chap34.html#shader-binding-table-hit-shader-indexing">used to
determine hit and intersection shaders executed during traversal</a>.
The geometry index is available to ray queries via the
<code>OpRayQueryGetIntersectionGeometryIndexKHR</code> instruction.</p>
</div>
<div class="paragraph">
<p>Members <code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
<strong class="purple">may</strong> be the same or different for an update operation (when <code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>).
If they are the same, the update happens in-place.
Otherwise, the target acceleration structure is updated and the source is
not modified.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03654" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03654"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03654</span><br>

<code>type</code> <strong class="purple">must</strong> not be <code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-03788" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-03788"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-03788</span><br>

Only one of <code>pGeometries</code> or <code>ppGeometries</code> <strong class="purple">can</strong> be a valid
pointer, the other <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03789" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03789"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03789</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, the
<code>geometryType</code> member of elements of either <code>pGeometries</code> or
<code>ppGeometries</code> <strong class="purple">must</strong> be <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03790" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03790"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03790</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>,
<code>geometryCount</code> <strong class="purple">must</strong> be <code>1</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03791" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03791"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03791</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
the <code>geometryType</code> member of elements of either <code>pGeometries</code> or
<code>ppGeometries</code> <strong class="purple">must</strong> not be <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03792" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03792"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03792</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
then the <code>geometryType</code> member of each geometry in either
<code>pGeometries</code> or <code>ppGeometries</code> <strong class="purple">must</strong> be the same</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03793" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03793"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03793</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
then <code>geometryCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxGeometryCount</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03794" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03794"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03794</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
and the <code>geometryType</code> member of either <code>pGeometries</code> or
<code>ppGeometries</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the total number
of AABBs in all geometries <strong class="purple">must</strong> be less than or equal to
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxPrimitiveCount</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03795" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03795"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03795</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
and the <code>geometryType</code> member of either <code>pGeometries</code> or
<code>ppGeometries</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the total
number of triangles in all geometries <strong class="purple">must</strong> be less than or equal to
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxPrimitiveCount</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-03796" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-03796"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-03796</span><br>

If <code>flags</code> has the
<code>VK_BUILD_ACCELERATION_STRUCTURE_PREFER_FAST_TRACE_BIT_KHR</code> bit set,
then it <strong class="purple">must</strong> not have the
<code>VK_BUILD_ACCELERATION_STRUCTURE_PREFER_FAST_BUILD_BIT_KHR</code> bit set</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_BUILD_GEOMETRY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter</span><br>
 <code>type</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureTypeKHR">VkAccelerationStructureTypeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap12.html#VkBuildAccelerationStructureFlagBitsKHR">VkBuildAccelerationStructureFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-parameter" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-parameter</span><br>
 If <code>geometryCount</code> is not <code>0</code>, and <code>pGeometries</code> is not <code>NULL</code>, <code>pGeometries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>geometryCount</code> valid <a href="chap32.html#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-ppGeometries-parameter" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-ppGeometries-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-ppGeometries-parameter</span><br>
 If <code>geometryCount</code> is not <code>0</code>, and <code>ppGeometries</code> is not <code>NULL</code>, <code>ppGeometries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>geometryCount</code> valid pointers to valid <a href="chap32.html#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent" href="chap32.html#VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent</span><br>
 Both of <code>dstAccelerationStructure</code>, and <code>srcAccelerationStructure</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBuildAccelerationStructureModeKHR</code> enumeration is defined as:</p>
</div>
<div id="VkBuildAccelerationStructureModeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkBuildAccelerationStructureModeKHR</span> <span class="p">{</span>
    <span class="n">VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkBuildAccelerationStructureModeKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code> specifies that the
destination acceleration structure will be built using the specified
geometries.</p>
</li>
<li>
<p><code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> specifies that the
destination acceleration structure will be built using data in a source
acceleration structure, updated by the specified geometries.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceOrHostAddressKHR</code> union is defined as:</p>
</div>
<div id="VkDeviceOrHostAddressKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="n">VkDeviceOrHostAddressKHR</span> <span class="p">{</span>
    <span class="n">VkDeviceAddress</span>    <span class="n">deviceAddress</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>              <span class="n">hostAddress</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkDeviceOrHostAddressKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceAddress</code> is a buffer device address as returned by the
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a> command.</p>
</li>
<li>
<p><code>hostAddress</code> is a host memory address.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceOrHostAddressConstKHR</code> union is defined as:</p>
</div>
<div id="VkDeviceOrHostAddressConstKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="n">VkDeviceOrHostAddressConstKHR</span> <span class="p">{</span>
    <span class="n">VkDeviceAddress</span>    <span class="n">deviceAddress</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">hostAddress</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkDeviceOrHostAddressConstKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceAddress</code> is a buffer device address as returned by the
<a href="chap14.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a> command.</p>
</li>
<li>
<p><code>hostAddress</code> is a const host memory address.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryKHR</code> structure is defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureGeometryKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkGeometryTypeKHR</span>                         <span class="n">geometryType</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureGeometryDataKHR</span>    <span class="n">geometry</span><span class="p">;</span>
    <span class="n">VkGeometryFlagsKHR</span>                        <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureGeometryKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>geometryType</code> describes which type of geometry this
<code>VkAccelerationStructureGeometryKHR</code> refers to.</p>
</li>
<li>
<p><code>geometry</code> is a <a href="chap32.html#VkAccelerationStructureGeometryDataKHR">VkAccelerationStructureGeometryDataKHR</a> union
describing the geometry data for the relevant geometry type.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap12.html#VkGeometryFlagBitsKHR">VkGeometryFlagBitsKHR</a> values
describing additional properties of how the geometry should be built.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-sType-sType" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-pNext-pNext" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter</span><br>
 <code>geometryType</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkGeometryTypeKHR">VkGeometryTypeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-triangles-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-triangles-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-triangles-parameter</span><br>
 If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the <code>triangles</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter</span><br>
 If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the <code>aabbs</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-instances-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-instances-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-instances-parameter</span><br>
 If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the <code>instances</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-flags-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryKHR-flags-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap12.html#VkGeometryFlagBitsKHR">VkGeometryFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryDataKHR</code> union is defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryDataKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="n">VkAccelerationStructureGeometryDataKHR</span> <span class="p">{</span>
    <span class="n">VkAccelerationStructureGeometryTrianglesDataKHR</span>    <span class="n">triangles</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureGeometryAabbsDataKHR</span>        <span class="n">aabbs</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureGeometryInstancesDataKHR</span>    <span class="n">instances</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureGeometryDataKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>triangles</code> is a
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure.</p>
</li>
<li>
<p><code>aabbs</code> is a <a href="chap32.html#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>
structure.</p>
</li>
<li>
<p><code>instances</code> is a
<a href="chap32.html#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryTrianglesDataKHR</code> structure is
defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryTrianglesDataKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureGeometryTrianglesDataKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkFormat</span>                         <span class="n">vertexFormat</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>    <span class="n">vertexData</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                     <span class="n">vertexStride</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                         <span class="n">maxVertex</span><span class="p">;</span>
    <span class="n">VkIndexType</span>                      <span class="n">indexType</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>    <span class="n">indexData</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>    <span class="n">transformData</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureGeometryTrianglesDataKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>vertexFormat</code> is the <a href="chap39.html#VkFormat">VkFormat</a> of each vertex element.</p>
</li>
<li>
<p><code>vertexData</code> is a device or host address to memory containing vertex
data for this geometry.</p>
</li>
<li>
<p><code>maxVertex</code> is the highest index of a vertex that will be addressed
by a build command using this structure.</p>
</li>
<li>
<p><code>vertexStride</code> is the stride in bytes between each vertex.</p>
</li>
<li>
<p><code>indexType</code> is the <a href="chap20.html#VkIndexType">VkIndexType</a> of each index element.</p>
</li>
<li>
<p><code>indexData</code> is a device or host address to memory containing index
data for this geometry.</p>
</li>
<li>
<p><code>transformData</code> is a device or host address to memory containing an
optional reference to a <a href="chap32.html#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure describing
a transformation from the space in which the vertices in this geometry
are described to the space in which the acceleration structure is
defined.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Unlike the stride for vertex buffers in
<a href="chap21.html#VkVertexInputBindingDescription">VkVertexInputBindingDescription</a> for graphics pipelines which must not
exceed <code>maxVertexInputBindingStride</code>, <code>vertexStride</code> for
acceleration structure geometry is instead restricted to being a 32-bit
value.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03735" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03735"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03735</span><br>

<code>vertexStride</code> <strong class="purple">must</strong> be a multiple of the size in bytes of the
smallest component of <code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03819" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03819"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03819</span><br>

<code>vertexStride</code> <strong class="purple">must</strong> be less than or equal to <span class="eq">2<sup>32</sup>-1</span></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-03797" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-03797"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-03797</span><br>

<code>vertexFormat</code> <strong class="purple">must</strong> support the
<code>VK_FORMAT_FEATURE_ACCELERATION_STRUCTURE_VERTEX_BUFFER_BIT_KHR</code> in
<a href="chap39.html#VkFormatProperties">VkFormatProperties</a>::<code>bufferFeatures</code> as returned by
<a href="chap39.html#vkGetPhysicalDeviceFormatProperties2KHR">vkGetPhysicalDeviceFormatProperties2KHR</a></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-03798" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-03798"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-03798</span><br>

<code>indexType</code> <strong class="purple">must</strong> be <code>VK_INDEX_TYPE_UINT16</code>,
<code>VK_INDEX_TYPE_UINT32</code>, or <code>VK_INDEX_TYPE_NONE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_TRIANGLES_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter</span><br>
 <code>vertexFormat</code> <strong class="purple">must</strong> be a valid <a href="chap39.html#VkFormat">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter" href="chap32.html#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter</span><br>
 <code>indexType</code> <strong class="purple">must</strong> be a valid <a href="chap20.html#VkIndexType">VkIndexType</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkTransformMatrixKHR</code> structure is defined as:</p>
</div>
<div id="VkTransformMatrixKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkTransformMatrixKHR</span> <span class="p">{</span>
    <span class="kt">float</span>    <span class="n">matrix</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="p">}</span> <span class="n">VkTransformMatrixKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>matrix</code> is a 3x4 row-major affine transformation matrix.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkTransformMatrixKHR-matrix-03799" href="chap32.html#VUID-VkTransformMatrixKHR-matrix-03799"></a> <span class="vuid">VUID-VkTransformMatrixKHR-matrix-03799</span><br>

The first three columns of <code>matrix</code> <strong class="purple">must</strong> define an invertible 3x3
matrix</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryAabbsDataKHR</code> structure is defined
as:</p>
</div>
<div id="VkAccelerationStructureGeometryAabbsDataKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureGeometryAabbsDataKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>    <span class="n">data</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                     <span class="n">stride</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureGeometryAabbsDataKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>data</code> is a device or host address to memory containing
<a href="chap32.html#VkAabbPositionsKHR">VkAabbPositionsKHR</a> structures containing position data for each
axis-aligned bounding box in the geometry.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between each entry in <code>data</code>.
The stride <strong class="purple">must</strong> be a multiple of <code>8</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545" href="chap32.html#VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545</span><br>

<code>stride</code> <strong class="purple">must</strong> be a multiple of <code>8</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03820" href="chap32.html#VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03820"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03820</span><br>

<code>stride</code> <strong class="purple">must</strong> be less than or equal to <span class="eq">2<sup>32</sup>-1</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType" href="chap32.html#VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_AABBS_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext" href="chap32.html#VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAabbPositionsKHR</code> structure is defined as:</p>
</div>
<div id="VkAabbPositionsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAabbPositionsKHR</span> <span class="p">{</span>
    <span class="kt">float</span>    <span class="n">minX</span><span class="p">;</span>
    <span class="kt">float</span>    <span class="n">minY</span><span class="p">;</span>
    <span class="kt">float</span>    <span class="n">minZ</span><span class="p">;</span>
    <span class="kt">float</span>    <span class="n">maxX</span><span class="p">;</span>
    <span class="kt">float</span>    <span class="n">maxY</span><span class="p">;</span>
    <span class="kt">float</span>    <span class="n">maxZ</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAabbPositionsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>minX</code> is the x position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>minY</code> is the y position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>minZ</code> is the z position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>maxX</code> is the x position of the other opposing corner of a bounding
box.</p>
</li>
<li>
<p><code>maxY</code> is the y position of the other opposing corner of a bounding
box.</p>
</li>
<li>
<p><code>maxZ</code> is the z position of the other opposing corner of a bounding
box.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minX-03546" href="chap32.html#VUID-VkAabbPositionsKHR-minX-03546"></a> <span class="vuid">VUID-VkAabbPositionsKHR-minX-03546</span><br>

<code>minX</code> <strong class="purple">must</strong> be less than or equal to <code>maxX</code></p>
</li>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minY-03547" href="chap32.html#VUID-VkAabbPositionsKHR-minY-03547"></a> <span class="vuid">VUID-VkAabbPositionsKHR-minY-03547</span><br>

<code>minY</code> <strong class="purple">must</strong> be less than or equal to <code>maxY</code></p>
</li>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minZ-03548" href="chap32.html#VUID-VkAabbPositionsKHR-minZ-03548"></a> <span class="vuid">VUID-VkAabbPositionsKHR-minZ-03548</span><br>

<code>minZ</code> <strong class="purple">must</strong> be less than or equal to <code>maxZ</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryInstancesDataKHR</code> structure is
defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryInstancesDataKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureGeometryInstancesDataKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">arrayOfPointers</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>    <span class="n">data</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureGeometryInstancesDataKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>arrayOfPointers</code> specifies whether <code>data</code> is used as an array
of addresses or just an array.</p>
</li>
<li>
<p><code>data</code> is either the address of an array of device or host addresses
referencing individual <a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>
structures
if <code>arrayOfPointers</code> is <code>VK_TRUE</code>, or the address of an array of
<a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>
structures.
Addresses and <a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures are
tightly packed.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType" href="chap32.html#VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_INSTANCES_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext" href="chap32.html#VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><em>Acceleration structure instances</em> <strong class="purple">can</strong> be built into top-level acceleration
structures.
Each acceleration structure instance is a separate entry in the top-level
acceleration structure which includes all the geometry of a bottom-level
acceleration structure at a transformed location.
Multiple instances <strong class="purple">can</strong> point to the same bottom level acceleration
structure.</p>
</div>
<div class="paragraph">
<p>An acceleration structure instance is defined by the structure:</p>
</div>
<div id="VkAccelerationStructureInstanceKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureInstanceKHR</span> <span class="p">{</span>
    <span class="n">VkTransformMatrixKHR</span>          <span class="n">transform</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                      <span class="n">instanceCustomIndex</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                      <span class="n">mask</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                      <span class="n">instanceShaderBindingTableRecordOffset</span><span class="o">:</span><span class="mi">24</span><span class="p">;</span>
    <span class="n">VkGeometryInstanceFlagsKHR</span>    <span class="n">flags</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
    <span class="kt">uint64_t</span>                      <span class="n">accelerationStructureReference</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureInstanceKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>transform</code> is a <a href="chap32.html#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure describing a
transformation to be applied to the acceleration structure.</p>
</li>
<li>
<p><code>instanceCustomIndex</code> is a 24-bit user-specified index value
accessible to ray shaders in the <code>InstanceCustomIndexKHR</code> built-in.</p>
</li>
<li>
<p><code>mask</code> is an 8-bit visibility mask for the geometry.
The instance <strong class="purple">may</strong> only be hit if <code>Cull Mask &amp; instance.mask != 0</code></p>
</li>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> is a 24-bit offset used in
calculating the hit shader binding table index.</p>
</li>
<li>
<p><code>flags</code> is an 8-bit mask of <a href="chap32.html#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a>
values to apply to this instance.</p>
</li>
<li>
<p><code>accelerationStructureReference</code> is either:</p>
<div class="ulist">
<ul>
<li>
<p>a device address containing the value obtained from
<a href="chap12.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a>
     (used by device operations which reference acceleration structures) or,</p>
</li>
<li>
<p>a <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> object (used by host operations
which reference acceleration structures).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The C language specification does not define the ordering of bit-fields, but
in practice, this struct produces the correct layout with existing
compilers.
The intended bit pattern is for the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>instanceCustomIndex</code> and <code>mask</code> occupy the same memory as if a
single <code>uint32_t</code> was specified in their place</p>
<div class="ulist">
<ul>
<li>
<p><code>instanceCustomIndex</code> occupies the 24 least significant bits of
that memory</p>
</li>
<li>
<p><code>mask</code> occupies the 8 most significant bits of that memory</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> and <code>flags</code> occupy the
same memory as if a single <code>uint32_t</code> was specified in their place</p>
<div class="ulist">
<ul>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> occupies the 24 least
significant bits of that memory</p>
</li>
<li>
<p><code>flags</code> occupies the 8 most significant bits of that memory</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a compiler produces code that diverges from that pattern, applications
<strong class="purple">must</strong> employ another method to set values according to the correct bit
pattern.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureInstanceKHR-flags-parameter" href="chap32.html#VUID-VkAccelerationStructureInstanceKHR-flags-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureInstanceKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap32.html#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>flags</code> in the instance modifying the behavior of
that instance are:</p>
</div>
<div id="VkGeometryInstanceFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkGeometryInstanceFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_GEOMETRY_INSTANCE_TRIANGLE_FLIP_FACING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR</span> <span class="o">=</span> <span class="n">VK_GEOMETRY_INSTANCE_TRIANGLE_FLIP_FACING_BIT_KHR</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkGeometryInstanceFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR</code> disables
face culling for this instance.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_TRIANGLE_FLIP_FACING_BIT_KHR</code> indicates that
the <a href="chap33.html#ray-traversal-culling-face">facing determination</a> for geometry in
this instance is inverted.
Because the facing is determined in object space, an instance transform
does not change the winding, but a geometry transform does.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</code> causes this instance to
act as though <code>VK_GEOMETRY_OPAQUE_BIT_KHR</code> were specified on all
geometries referenced by this instance.
This behavior <strong class="purple">can</strong> be overridden by the SPIR-V <code>NoOpaqueKHR</code> ray
flag.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</code> causes this instance
to act as though <code>VK_GEOMETRY_OPAQUE_BIT_KHR</code> were not specified on
all geometries referenced by this instance.
This behavior <strong class="purple">can</strong> be overridden by the SPIR-V <code>OpaqueKHR</code> ray flag.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</code> and
<code>VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</code> <strong class="purple">must</strong> not be used in the
same flag.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkGeometryInstanceFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkGeometryInstanceFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkGeometryInstanceFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap32.html#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkAccelerationStructureBuildRangeInfoKHR</code> is defined as:</p>
</div>
<div id="VkAccelerationStructureBuildRangeInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureBuildRangeInfoKHR</span> <span class="p">{</span>
    <span class="kt">uint32_t</span>    <span class="n">primitiveCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">primitiveOffset</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">firstVertex</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">transformOffset</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureBuildRangeInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>primitiveCount</code> defines the number of primitives for a
corresponding acceleration structure geometry.</p>
</li>
<li>
<p><code>primitiveOffset</code> defines an offset in bytes into the memory where
primitive data is defined.</p>
</li>
<li>
<p><code>firstVertex</code> is the index of the first vertex to build from for
triangle geometry.</p>
</li>
<li>
<p><code>transformOffset</code> defines an offset in bytes into the memory where a
transform matrix is defined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The primitive count and primitive offset are interpreted differently
depending on the <a href="chap12.html#VkGeometryTypeKHR">VkGeometryTypeKHR</a> used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>primitiveCount</code> is the number of triangles to be built, where each
triangle is treated as 3 vertices.</p>
<div class="ulist">
<ul>
<li>
<p>If the geometry uses indices, <span class="eq"><code>primitiveCount</code> × 3</span>
indices are consumed from
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>,
starting at an offset of <code>primitiveOffset</code>.
The value of <code>firstVertex</code> is added to the index values before
fetching vertices.</p>
</li>
<li>
<p>If the geometry does not use indices, <span class="eq"><code>primitiveCount</code> ×
3</span> vertices are consumed from
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>,
starting at an offset of <span class="eq"><code>primitiveOffset</code> + 
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexStride</code>
× <code>firstVertex</code></span>.</p>
</li>
<li>
<p>If
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>
is not <code>NULL</code>, a single <a href="chap32.html#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure is
consumed from
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>,
at an offset of <code>transformOffset</code>.
This matrix describes a transformation from the space in which the
vertices for all triangles in this geometry are described to the space
in which the acceleration structure is defined.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>primitiveCount</code> is the number of axis-aligned bounding boxes.
<code>primitiveCount</code> <a href="chap32.html#VkAabbPositionsKHR">VkAabbPositionsKHR</a> structures are consumed
from <a href="chap32.html#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code>,
starting at an offset of <code>primitiveOffset</code>.</p>
</li>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>primitiveCount</code> is the number of acceleration structures.
<code>primitiveCount</code> <a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>
structures are consumed from
<a href="chap32.html#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code>,
starting at an offset of <code>primitiveOffset</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03656" href="chap32.html#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03656"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03656</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if the
geometry uses indices, the offset <code>primitiveOffset</code> from
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>
<strong class="purple">must</strong> be a multiple of the element size of
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexType</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03657" href="chap32.html#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03657"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03657</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if the
geometry does not use indices, the offset <code>primitiveOffset</code> from
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>
<strong class="purple">must</strong> be a multiple of the component size of
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-transformOffset-03658" href="chap32.html#VUID-VkAccelerationStructureBuildRangeInfoKHR-transformOffset-03658"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-transformOffset-03658</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the offset
<code>transformOffset</code> from
<a href="chap32.html#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>
<strong class="purple">must</strong> be a multiple of 16</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03659" href="chap32.html#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03659"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03659</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the offset
<code>primitiveOffset</code> from
<a href="chap32.html#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code> <strong class="purple">must</strong> be a
multiple of 8</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03660" href="chap32.html#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03660"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03660</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the offset
<code>primitiveOffset</code> from
<a href="chap32.html#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code> <strong class="purple">must</strong>
be a multiple of 16</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-copying"><a class="anchor" href="chap32.html#acceleration-structure-copying"></a>32.1.7. Copying Acceleration Structures</h4>
<div class="paragraph">
<p>An additional command exists for copying acceleration structures without
updating their contents.
The acceleration structure object <strong class="purple">can</strong> be compacted in order to improve
performance.
Before copying, an application <strong class="purple">must</strong> query the size of the resulting
acceleration structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query acceleration structure size parameters call:</p>
</div>
<div id="vkCmdWriteAccelerationStructuresPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkCmdWriteAccelerationStructuresPropertiesKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">accelerationStructureCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureKHR</span><span class="o">*</span>           <span class="n">pAccelerationStructures</span><span class="p">,</span>
    <span class="n">VkQueryType</span>                                 <span class="n">queryType</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">firstQuery</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> is a pointer to an array of existing
previously built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>firstQuery</code> is the first query index within the query pool that
will contain the <code>accelerationStructureCount</code> number of results.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to any of the acceleration structures listed in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then the
value written out is the number of bytes required by a compacted
acceleration structure.</p>
</li>
<li>
<p>If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
the value written out is the number of bytes required by a serialized
acceleration structure.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> matching
<code>queryType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494</span><br>

The queries identified by <code>queryPool</code> and <code>firstQuery</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-buffer-03736" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-buffer-03736"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-buffer-03736</span><br>

The <code>buffer</code> used to create each acceleration structure in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-query-04880" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-query-04880"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-query-04880</span><br>

The sum of <code>query</code> plus <code>accelerationStructureCount</code> <strong class="purple">must</strong> be
less than or equal to the number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-04964" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-04964"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-04964</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built prior to the execution of this command</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-06742" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-06742"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-06742</span><br>

<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code>,
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>,
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter</span><br>
 <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-videocoding" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-videocoding"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength</span><br>
 <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent" href="chap32.html#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>queryPool</code>, and the elements of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyAccelerationStructureKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyAccelerationStructureInfoKHR</span><span class="o">*</span>   <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap32.html#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command copies the <code>pInfo-&gt;src</code> acceleration structure to the
<code>pInfo-&gt;dst</code> acceleration structure in the manner specified by
<code>pInfo-&gt;mode</code>.</p>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo-&gt;src</code> and <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be
<a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> or
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code> as appropriate.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-buffer-03737" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-buffer-03737"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-buffer-03737</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-buffer-03738" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-buffer-03738"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-buffer-03738</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-renderpass" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-renderpass"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-videocoding" href="chap32.html#VUID-vkCmdCopyAccelerationStructureKHR-videocoding"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyAccelerationStructureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkCopyAccelerationStructureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkCopyAccelerationStructureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureKHR</span>            <span class="n">src</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureKHR</span>            <span class="n">dst</span><span class="p">;</span>
    <span class="n">VkCopyAccelerationStructureModeKHR</span>    <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkCopyAccelerationStructureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the source acceleration structure for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap32.html#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value
specifying additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-mode-03410" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-mode-03410"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-mode-03410</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> or
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-04963" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-src-04963"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-src-04963</span><br>

The source acceleration structure <code>src</code> <strong class="purple">must</strong> have been constructed
prior to the execution of this command</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-03411" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-src-03411"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-src-03411</span><br>

If <code>mode</code> is <code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code>,
<code>src</code> <strong class="purple">must</strong> have been constructed with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> in the
build</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-buffer-03718" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-buffer-03718"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-buffer-03718</span><br>

The <code>buffer</code> used to create <code>src</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-buffer-03719" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-buffer-03719"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-buffer-03719</span><br>

The <code>buffer</code> used to create <code>dst</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-sType-sType" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_ACCELERATION_STRUCTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-parameter" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-src-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-commonparent" href="chap32.html#VUID-VkCopyAccelerationStructureInfoKHR-commonparent"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-commonparent</span><br>
 Both of <code>dst</code>, and <code>src</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>mode</code> specifying additional operations to perform
during the copy, are:</p>
</div>
<div id="VkCopyAccelerationStructureModeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkCopyAccelerationStructureModeKHR</span> <span class="p">{</span>
    <span class="n">VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkCopyAccelerationStructureModeKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code> creates a direct
copy of the acceleration structure specified in <code>src</code> into the one
specified by <code>dst</code>.
The <code>dst</code> acceleration structure <strong class="purple">must</strong> have been created with the
same parameters as <code>src</code>.
If <code>src</code> contains references to other acceleration structures,
<code>dst</code> will reference the same acceleration structures.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> creates a more
compact version of an acceleration structure <code>src</code> into <code>dst</code>.
The acceleration structure <code>dst</code> <strong class="purple">must</strong> have been created with a size
at least as large as that returned by
<a href="chap32.html#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a>
or <a href="chap32.html#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a>
after the build of the acceleration structure specified by <code>src</code>.
If <code>src</code> contains references to other acceleration structures,
<code>dst</code> will reference the same acceleration structures.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code> serializes the
acceleration structure to a semi-opaque format which can be reloaded on
a compatible implementation.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code> deserializes
the semi-opaque serialization format in the buffer to the acceleration
structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure to device memory call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureToMemoryKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyAccelerationStructureToMemoryKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyAccelerationStructureToMemoryInfoKHR</span><span class="o">*</span> <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is an a pointer to a
<a href="chap32.html#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>.
Accesses to the buffer indicated by <code>pInfo-&gt;dst.deviceAddress</code> <strong class="purple">must</strong> be
synchronized with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline stage
and an access type of <code>VK_ACCESS_TRANSFER_WRITE_BIT</code>.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="chap32.html#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>, but writes its result to a
device address, and is executed on the device rather than the host.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="chap32.html#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> or
<a href="chap32.html#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a>.</p>
</div>
<div id="serialized-as-header" class="paragraph">
<p>The defined header structure for the serialized data consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data matching
<code>VkPhysicalDeviceIDProperties</code>::<code>driverUUID</code></p>
</li>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data identifying the compatibility for
comparison using <a href="chap32.html#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
<li>
<p>A 64-bit integer of the total size matching the value queried using
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p>A 64-bit integer of the deserialized size to be passed in to
<code>VkAccelerationStructureCreateInfoKHR</code>::<code>size</code></p>
</li>
<li>
<p>A 64-bit integer of the count of the number of acceleration structure
handles following.
This value matches the value queried using
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>.
This will be zero for a bottom-level acceleration structure.
For top-level acceleration structures this number is
implementation-dependent; the number of and ordering of the handles may
not match the instance descriptions which were used to build the
acceleration structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding handles matching the values returned by
<a href="chap12.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a>
are tightly packed in the buffer following the count.
The application is expected to store a mapping between those handles and the
original application-generated bottom-level acceleration structures to
provide when deserializing.
The serialized data is written to the buffer (or read from the buffer)
according to the host endianness.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03739" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03739"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03739</span><br>

<code>pInfo-&gt;dst.deviceAddress</code> <strong class="purple">must</strong> be a valid device address for a
buffer bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03740" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03740"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03740</span><br>

<code>pInfo-&gt;dst.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>256</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03741" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03741"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03741</span><br>

If the buffer pointed to by <code>pInfo-&gt;dst.deviceAddress</code> is non-sparse
then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-videocoding" href="chap32.html#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-videocoding"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCopyAccelerationStructureToMemoryInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkCopyAccelerationStructureToMemoryInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureKHR</span>            <span class="n">src</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressKHR</span>              <span class="n">dst</span><span class="p">;</span>
    <span class="n">VkCopyAccelerationStructureModeKHR</span>    <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkCopyAccelerationStructureToMemoryInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the source acceleration structure for the copy</p>
</li>
<li>
<p><code>dst</code> is the device or host address to memory which is the target
for the copy</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap32.html#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value
specifying additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-04959" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-04959"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-04959</span><br>

The source acceleration structure <code>src</code> <strong class="purple">must</strong> have been constructed
prior to the execution of this command</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561</span><br>

The memory pointed to by <code>dst</code> <strong class="purple">must</strong> be at least as large as the
serialization size of <code>src</code>, as reported by
<a href="chap32.html#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a> or
<a href="chap32.html#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> with a query type of
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_ACCELERATION_STRUCTURE_TO_MEMORY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter" href="chap32.html#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy device memory to an acceleration structure call:</p>
</div>
<div id="vkCmdCopyMemoryToAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyMemoryToAccelerationStructureKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMemoryToAccelerationStructureInfoKHR</span><span class="o">*</span> <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="chap32.html#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be <a href="chap7.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap7.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap7.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>.
Accesses to the buffer indicated by <code>pInfo-&gt;src.deviceAddress</code> <strong class="purple">must</strong> be
synchronized with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline stage
and an access type of <code>VK_ACCESS_TRANSFER_READ_BIT</code>.</p>
</div>
<div class="paragraph">
<p>This command can accept acceleration structures produced by either
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="chap32.html#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
<div class="paragraph">
<p>The structure provided as input to deserialize is as described in
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>, with any acceleration
structure handles filled in with the newly-queried handles to bottom level
acceleration structures created before deserialization.
These do not need to be built at deserialize time, but <strong class="purple">must</strong> be created.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03742" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03742"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03742</span><br>

<code>pInfo-&gt;src.deviceAddress</code> <strong class="purple">must</strong> be a valid device address for a
buffer bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03743" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03743"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03743</span><br>

<code>pInfo-&gt;src.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>256</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03744" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03744"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03744</span><br>

If the buffer pointed to by <code>pInfo-&gt;src.deviceAddress</code> is non-sparse
then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-buffer-03745" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-buffer-03745"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-buffer-03745</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-videocoding" href="chap32.html#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-videocoding"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyMemoryToAccelerationStructureInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkCopyMemoryToAccelerationStructureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkCopyMemoryToAccelerationStructureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkDeviceOrHostAddressConstKHR</span>         <span class="n">src</span><span class="p">;</span>
    <span class="n">VkAccelerationStructureKHR</span>            <span class="n">dst</span><span class="p">;</span>
    <span class="n">VkCopyAccelerationStructureModeKHR</span>    <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkCopyMemoryToAccelerationStructureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the device or host address to memory containing the source
data for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="chap32.html#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value
specifying additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-src-04960" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-src-04960"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-src-04960</span><br>

The source memory pointed to by <code>src</code> <strong class="purple">must</strong> contain data previously
serialized using <a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>,
potentially modified to relocate acceleration structure references as
described in that command</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414</span><br>

The data in <code>src</code> <strong class="purple">must</strong> have a format compatible with the
destination physical device as returned by
<a href="chap32.html#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-03746" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-03746"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-03746</span><br>

<code>dst</code> <strong class="purple">must</strong> have been created with a <code>size</code> greater than or
equal to that used to serialize the data in <code>src</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_MEMORY_TO_ACCELERATION_STRUCTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter" href="chap32.html#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="chap32.html#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To check if a serialized acceleration structure is compatible with the
current device call:</p>
</div>
<div id="vkGetDeviceAccelerationStructureCompatibilityKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="kt">void</span> <span class="nf">vkGetDeviceAccelerationStructureCompatibilityKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureVersionInfoKHR</span><span class="o">*</span> <span class="n">pVersionInfo</span><span class="p">,</span>
    <span class="n">VkAccelerationStructureCompatibilityKHR</span><span class="o">*</span>    <span class="n">pCompatibility</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device to check the version against.</p>
</li>
<li>
<p><code>pVersionInfo</code> is a pointer to a
<a href="chap32.html#VkAccelerationStructureVersionInfoKHR">VkAccelerationStructureVersionInfoKHR</a> structure specifying version
information to check against the device.</p>
</li>
<li>
<p><code>pCompatibility</code> is a pointer to a
<a href="chap32.html#VkAccelerationStructureCompatibilityKHR">VkAccelerationStructureCompatibilityKHR</a> value in which
compatibility information is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracingPipeline-03661" href="chap32.html#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracingPipeline-03661"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracingPipeline-03661</span><br>

The <a href="chap37.html#features-rayTracingPipeline"><code>rayTracingPipeline</code></a> or
<a href="chap37.html#features-rayQuery"><code>rayQuery</code></a> feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter" href="chap32.html#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pVersionInfo-parameter" href="chap32.html#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pVersionInfo-parameter"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pVersionInfo-parameter</span><br>
 <code>pVersionInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkAccelerationStructureVersionInfoKHR">VkAccelerationStructureVersionInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pCompatibility-parameter" href="chap32.html#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pCompatibility-parameter"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pCompatibility-parameter</span><br>
 <code>pCompatibility</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap32.html#VkAccelerationStructureCompatibilityKHR">VkAccelerationStructureCompatibilityKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureVersionInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkAccelerationStructureVersionInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAccelerationStructureVersionInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span>     <span class="n">pVersionData</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureVersionInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pVersionData</code> is a pointer to the version header of an acceleration
structure as defined in <a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><code>pVersionData</code> is a <em>pointer</em> to an array of 2×<code>VK_UUID_SIZE</code>
<code>uint8_t</code> values instead of two <code>VK_UUID_SIZE</code> arrays as the expected
use case for this member is to be pointed at the header of a previously
serialized acceleration structure (via
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="chap32.html#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>) that is loaded in memory.
Using arrays would necessitate extra memory copies of the UUIDs.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureVersionInfoKHR-sType-sType" href="chap32.html#VUID-VkAccelerationStructureVersionInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureVersionInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_VERSION_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureVersionInfoKHR-pNext-pNext" href="chap32.html#VUID-VkAccelerationStructureVersionInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureVersionInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureVersionInfoKHR-pVersionData-parameter" href="chap32.html#VUID-VkAccelerationStructureVersionInfoKHR-pVersionData-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureVersionInfoKHR-pVersionData-parameter</span><br>
 <code>pVersionData</code> <strong class="purple">must</strong> be a valid pointer to an array of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.70625em;vertical-align:-0.09514em;"></span><span class="mord"><span class="mord mathtt">V</span><span class="mord mathtt">K</span><span class="mord mathtt">_</span><span class="mord mathtt">U</span><span class="mord mathtt">U</span><span class="mord mathtt">I</span><span class="mord mathtt">D</span><span class="mord mathtt">_</span><span class="mord mathtt">S</span><span class="mord mathtt">I</span><span class="mord mathtt">Z</span><span class="mord mathtt">E</span></span></span></span></span> <code>uint8_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>pCompatibility</code> returned by
<a href="chap32.html#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a> are:</p>
</div>
<div id="VkAccelerationStructureCompatibilityKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkAccelerationStructureCompatibilityKHR</span> <span class="p">{</span>
    <span class="n">VK_ACCELERATION_STRUCTURE_COMPATIBILITY_COMPATIBLE_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_ACCELERATION_STRUCTURE_COMPATIBILITY_INCOMPATIBLE_KHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkAccelerationStructureCompatibilityKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCELERATION_STRUCTURE_COMPATIBILITY_COMPATIBLE_KHR</code> if the
<code>pVersionData</code> version acceleration structure is compatible with
<code>device</code>.</p>
</li>
<li>
<p><code>VK_ACCELERATION_STRUCTURE_COMPATIBILITY_INCOMPATIBLE_KHR</code> if the
<code>pVersionData</code> version acceleration structure is not compatible with
<code>device</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="host-acceleration-structure"><a class="anchor" href="chap32.html#host-acceleration-structure"></a>32.2. Host Acceleration Structure Operations</h3>
<div class="paragraph">
<p>Implementations are also required to provide host implementations of the
acceleration structure operations if the
<a href="chap37.html#features-accelerationStructureHostCommands"><code>accelerationStructureHostCommands</code></a> feature is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap32.html#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a> corresponding to
<a href="chap32.html#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a></p>
</li>
<li>
<p><a href="chap32.html#vkCopyAccelerationStructureKHR">vkCopyAccelerationStructureKHR</a> corresponding to
<a href="chap32.html#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="chap32.html#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a> corresponding to
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a></p>
</li>
<li>
<p><a href="chap32.html#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a> corresponding to
<a href="chap32.html#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="chap32.html#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a> corresponding to
<a href="chap32.html#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These commands are functionally equivalent to their device counterparts,
except that they are executed on the host timeline, rather than being
enqueued into command buffers.</p>
</div>
<div class="paragraph">
<p>All acceleration structures used by the host commands <strong class="purple">must</strong> be bound to
host-visible memory, and all input data for acceleration structure builds
<strong class="purple">must</strong> be referenced using host addresses instead of device addresses.
Applications are not required to map acceleration structure memory when
using the host commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <a href="chap32.html#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a> and
<a href="chap32.html#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a> <strong class="purple">may</strong> use different algorithms, and
thus are not required to produce identical structures.
The structures produced by these two commands <strong class="purple">may</strong> exhibit different memory
footprints or traversal performance, but should strive to be similar where
possible.</p>
</div>
<div class="paragraph">
<p>Apart from these details, the host and device operations are
interchangeable.
For example, an application <strong class="purple">can</strong> use <a href="chap32.html#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a>
to build a structure, compact it on the device using
<a href="chap32.html#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a>, and serialize the result using
<a href="chap32.html#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For efficient execution, acceleration structures manipulated using these
commands should always be bound to host cached memory, as the implementation
may need to repeatedly read and write this memory during the execution of
the command.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures on the host, call:</p>
</div>
<div id="vkBuildAccelerationStructuresKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="n">VkResult</span> <span class="nf">vkBuildAccelerationStructuresKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">infoCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureBuildGeometryInfoKHR</span><span class="o">*</span> <span class="n">pInfos</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureBuildRangeInfoKHR</span><span class="o">*</span> <span class="k">const</span><span class="o">*</span> <span class="n">ppBuildRangeInfos</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the <code>VkDevice</code> for which the acceleration structures
are being built.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap31.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.
It specifies the number of the <code>pInfos</code> structures and
<code>ppBuildRangeInfos</code> pointers that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>ppBuildRangeInfos</code> is a pointer to an array of <code>infoCount</code>
pointers to arrays of <a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a>
structures.
Each <code>ppBuildRangeInfos</code>[i] is a pointer to an array of
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="chap32.html#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>The <code>vkBuildAccelerationStructuresKHR</code> command provides the ability to
initiate multiple acceleration structures builds, however there is no
ordering or synchronization implied between any of the individual
acceleration structure builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that an application <strong class="purple">cannot</strong> build a top-level acceleration
structure in the same <a href="chap32.html#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a> call as the
associated bottom-level or instance acceleration structures are being built.
There also <strong class="purple">cannot</strong> be any memory aliasing between any acceleration structure
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-mode-04628" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-mode-04628"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-mode-04628</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="chap32.html#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-srcAccelerationStructure-04629" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-srcAccelerationStructure-04629"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-srcAccelerationStructure-04629</span><br>

If the <code>srcAccelerationStructure</code> member of any element of
<code>pInfos</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be a valid
<a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-04630" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-04630"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-04630</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03403" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03403"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03403</span><br>

The <code>srcAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03698" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03698"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03698</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03800" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03800"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03800</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> be a valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03699" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03699"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03699</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03700" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03700"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03700</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03663" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03663"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03663</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>,
<a href="chap32.html#acceleration-structure-inactive-prims">inactive primitives</a> in its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made active</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03664" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03664"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03664</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, active primitives
in its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made
<a href="chap32.html#acceleration-structure-inactive-prims">inactive</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-None-03407" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-None-03407"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-None-03407</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be referenced by the <code>geometry.instances.data</code> member of
any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other
element of <code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03701" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03701"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03701</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>srcAccelerationStructure</code> member of
any other element of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, which is accessed
by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03702" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03702"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03702</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>dstAccelerationStructure</code> member of
any other element of <code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03703" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03703"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03703</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-scratchData-03704" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-scratchData-03704"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-scratchData-03704</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-scratchData-03705" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-scratchData-03705"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-scratchData-03705</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>srcAccelerationStructure</code> member of any element
of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> (including the
same element), which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03706" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03706"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03706</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing any acceleration structure referenced by the
<code>geometry.instances.data</code> member of any element of <code>pGeometries</code>
or <code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03667" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03667"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03667</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> have previously been
constructed with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code> in the
build</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03668" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03668"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03668</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
members <strong class="purple">must</strong> either be the same <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a>, or
not have any <a href="chap12.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03758" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03758"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03758</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>geometryCount</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03759" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03759"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03759</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>flags</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03760" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03760"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03760</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>type</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03761" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03761"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03761</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>geometryType</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03762" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03762"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03762</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>flags</code> member
<strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03763" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03763"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03763</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.vertexFormat</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03764" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03764"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03764</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.maxVertex</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03765" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03765"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03765</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.indexType</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03766" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03766"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03766</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> address was <code>NULL</code> when
<code>srcAccelerationStructure</code> was last built, then it <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03767" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03767"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03767</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> address was not <code>NULL</code> when
<code>srcAccelerationStructure</code> was last built, then it <strong class="purple">must</strong> not be
<code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03768" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03768"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03768</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
then the value of each index referenced <strong class="purple">must</strong> be the same as the
corresponding index value when <code>srcAccelerationStructure</code> was last
built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-primitiveCount-03769" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-primitiveCount-03769"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-primitiveCount-03769</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, its <code>primitiveCount</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-firstVertex-03770" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-firstVertex-03770"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-firstVertex-03770</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, if the corresponding geometry uses indices, its
<code>firstVertex</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03801" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03801"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03801</span><br>

For each element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the corresponding
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap38.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxInstanceCount</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03675" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03675"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03675</span><br>

For each <code>pInfos</code>[i], <code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been
created with a value of
<a href="chap12.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>size</code> greater than or
equal to the memory size required by the build operation, as returned by
<a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with <span class="eq"><code>pBuildInfo</code>
= <code>pInfos</code>[i]</span> and with each element of the
<code>pMaxPrimitiveCounts</code> array greater than or equal to the equivalent
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> values for <code>j</code> in
<span class="eq">[0,<code>pInfos</code>[i].<code>geometryCount</code>)</span></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676</span><br>

Each element of <code>ppBuildRangeInfos</code>[i] <strong class="purple">must</strong> be a valid pointer to
an array of <code>pInfos</code>[i].<code>geometryCount</code>
<code>VkAccelerationStructureBuildRangeInfoKHR</code> structures</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03677" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03678" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03722" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03722"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03722</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to host-visible
device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03723" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03723"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03723</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03724" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03724"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03724</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-accelerationStructureHostCommands-03581" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-accelerationStructureHostCommands-03581"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-accelerationStructureHostCommands-03581</span><br>

The <a href="chap37.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03725" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03725"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03725</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.hostAddress</code> and
<code>pInfos</code>[i].<code>scratchData.hostAddress</code> + N - 1 <strong class="purple">must</strong> be valid
host memory, where N is given by the <code>buildScratchSize</code> member of
the <a href="chap12.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned
from a call to <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an
identical <a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure
and primitive count</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03726" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03726"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03726</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.hostAddress</code> and
<code>pInfos</code>[i].<code>scratchData.hostAddress</code> + N - 1 <strong class="purple">must</strong> be valid
host memory, where N is given by the <code>updateScratchSize</code> member of
the <a href="chap12.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned
from a call to <a href="chap12.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an
identical <a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure
and primitive count</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03771" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03771"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03771</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.hostAddress</code> <strong class="purple">must</strong> be a valid host
address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03772" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03772"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03772</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.hostAddress</code> <strong class="purple">must</strong> be a valid host
address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03773" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03773"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03773</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.hostAddress</code> is not <code>0</code>, it <strong class="purple">must</strong>
be a valid host address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03774" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03774"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03774</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, <code>geometry.aabbs.data.hostAddress</code>
<strong class="purple">must</strong> be a valid host address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03775" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03775"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03775</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to memory that was
not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03776" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03776"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03776</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03777" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03777"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03777</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03778" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03778"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03778</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>geometry.instances.data.hostAddress</code> <strong class="purple">must</strong> be a valid host address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03779" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-03779"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03779</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, each
<a href="chap32.html#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>geometry.instances.data.hostAddress</code> must be a valid
<a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> object</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-device-parameter" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-device-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parameter" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-parameter" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-pInfos-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="chap32.html#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter</span><br>
 <code>ppBuildRangeInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <a href="chap32.html#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-infoCount-arraylength" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-infoCount-arraylength"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parent" href="chap32.html#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy or compact an acceleration structure on the host, call:</p>
</div>
<div id="vkCopyAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="n">VkResult</span> <span class="nf">vkCopyAccelerationStructureKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyAccelerationStructureInfoKHR</span><span class="o">*</span>   <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the acceleration structures.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap31.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="chap32.html#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="chap32.html#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a> but is executed by the host.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-03677" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-03678" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03727" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-buffer-03727"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03727</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03728" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-buffer-03728"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03728</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-accelerationStructureHostCommands-03582" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-accelerationStructureHostCommands-03582"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-accelerationStructureHostCommands-03582</span><br>

The <a href="chap37.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03780" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-buffer-03780"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03780</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03781" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-buffer-03781"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03781</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-device-parameter" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-device-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-parameter" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-pInfo-parameter" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-parent" href="chap32.html#VUID-vkCopyAccelerationStructureKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy host accessible memory to an acceleration structure, call:</p>
</div>
<div id="vkCopyMemoryToAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="n">VkResult</span> <span class="nf">vkCopyMemoryToAccelerationStructureKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyMemoryToAccelerationStructureInfoKHR</span><span class="o">*</span> <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;dst</code>.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap31.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="chap32.html#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="chap32.html#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command can accept acceleration structures produced by either
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="chap32.html#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03677" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03678" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03729" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03729"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03729</span><br>

<code>pInfo-&gt;src.hostAddress</code> <strong class="purple">must</strong> be a valid host pointer</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03750" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03750"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03750</span><br>

<code>pInfo-&gt;src.hostAddress</code> <strong class="purple">must</strong> be aligned to 16 bytes</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03730" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03730"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03730</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-accelerationStructureHostCommands-03583" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-accelerationStructureHostCommands-03583"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-accelerationStructureHostCommands-03583</span><br>

The <a href="chap37.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03782" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03782"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03782</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;dst</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parameter" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parent" href="chap32.html#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure to host accessible memory, call:</p>
</div>
<div id="vkCopyAccelerationStructureToMemoryKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="n">VkResult</span> <span class="nf">vkCopyAccelerationStructureToMemoryKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkDeferredOperationKHR</span>                      <span class="n">deferredOperation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkCopyAccelerationStructureToMemoryInfoKHR</span><span class="o">*</span> <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;src</code>.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap31.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="chap32.html#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="chap32.html#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>, but writes its result
directly to a host pointer, and is executed on the host rather than the
device.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="chap32.html#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> or
<a href="chap32.html#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03677" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03678" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03731" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03731"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03731</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03732" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03732"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03732</span><br>

<code>pInfo-&gt;dst.hostAddress</code> <strong class="purple">must</strong> be a valid host pointer</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03751" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03751"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03751</span><br>

<code>pInfo-&gt;dst.hostAddress</code> <strong class="purple">must</strong> be aligned to 16 bytes</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-accelerationStructureHostCommands-03584" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-accelerationStructureHostCommands-03584"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-accelerationStructureHostCommands-03584</span><br>

The <a href="chap37.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03783" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03783"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03783</span><br>

The <code>buffer</code> used to create <code>pInfo-&gt;src</code> <strong class="purple">must</strong> be bound to
memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parameter" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap31.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap32.html#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parent" href="chap32.html#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query acceleration structure size parameters on the host, call:</p>
</div>
<div id="vkWriteAccelerationStructuresPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_acceleration_structure</span>
<span class="n">VkResult</span> <span class="nf">vkWriteAccelerationStructuresPropertiesKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">accelerationStructureCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAccelerationStructureKHR</span><span class="o">*</span>           <span class="n">pAccelerationStructures</span><span class="p">,</span>
    <span class="n">VkQueryType</span>                                 <span class="n">queryType</span><span class="p">,</span>
    <span class="kt">size_t</span>                                      <span class="n">dataSize</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span>                                       <span class="n">pData</span><span class="p">,</span>
    <span class="kt">size_t</span>                                      <span class="n">stride</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the acceleration structures in
<code>pAccelerationStructures</code>.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> is a pointer to an array of existing
previously built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the property to
be queried.</p>
</li>
<li>
<p><code>dataSize</code> is the size in bytes of the buffer pointed to by
<code>pData</code>.</p>
</li>
<li>
<p><code>pData</code> is a pointer to a user-allocated buffer where the results
will be written.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>pData</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="chap32.html#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> but is executed by the
host.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-04964" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-04964"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-04964</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built prior to the execution of this command</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06742" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06742"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06742</span><br>

<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code>,
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>,
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then
<code>stride</code> <strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then
<code>pData</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
<code>stride</code> <strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
<code>pData</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06731" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06731"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06731</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code>, then <code>stride</code>
<strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06732" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06732"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06732</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code>, then <code>pData</code>
<strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06733" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06733"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06733</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>,
then <code>stride</code> <strong class="purple">must</strong> be a multiple of the size of
<code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06734" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06734"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-06734</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>,
then <code>pData</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452</span><br>

<code>dataSize</code> <strong class="purple">must</strong> be greater than or equal to
<span class="eq"><code>accelerationStructureCount</code>*<code>stride</code></span></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03733" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03733"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03733</span><br>

The <code>buffer</code> used to create each acceleration structure in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be bound to host-visible device
memory</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureHostCommands-03585" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureHostCommands-03585"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureHostCommands-03585</span><br>

The <a href="chap37.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03784" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03784"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03784</span><br>

The <code>buffer</code> used to create each acceleration structure in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be bound to memory that was not
allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter</span><br>
 <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap12.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handles</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter</span><br>
 <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength</span><br>
 <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength</span><br>
 <code>dataSize</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent" href="chap32.html#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent</span><br>
 Each element of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>

<nav>
  <a rel="prev" href="chap31.html" class="nav nav-prev" title="Previous page" aria-label="Previous page" aria-keyshortcuts="Left">
        <i class="fa fa-angle-left"></i>
     </a>
  <a rel="next" href="chap33.html" class="nav nav-next" title="Next page" aria-label="Next page" aria-keyshortcuts="Right">
        <i class="fa fa-angle-right"></i>
     </a>
  <div style="clear: both"></div>
</nav>
<div id="footer">
<div id="footer-text">
Version 1.0.235<br>
Last updated 2022-11-03 01:43:08 -0700
</div>
</div>



</body>
  <script>
  function isInViewport(ele) {
    const rect = ele.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
    );
  }
  function yPosition (ele) {
    const rect = ele.getBoundingClientRect();
    return (rect.top - 20); // 20px above
  }
  let curr = document.getElementsByClassName('current');
  if (!isInViewport(curr[curr.length - 1])) {
    document.getElementById('toc').scrollTo({
      top: yPosition(curr[0]),
      left: 0,
      behavior: 'smooth'
    });
  }

  /* For page navigation */
  function gotoPage(selector) {
    const button = document.querySelector(selector);
    if (button)
      window.location.href = button.href;
  }
  document.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowRight':
        e.preventDefault();
        gotoPage('.nav-next');
        break;
      case 'ArrowLeft':
        e.preventDefault();
        gotoPage('.nav-prev');
        break;
    }
  });
  </script>
  </html>