<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="The Khronos® Vulkan  Working Group">
<title>Vulkan® 1.2.281 - A Specification (with all ratified extensions)</title>
<link rel="stylesheet" href="style0.css" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="style1.css" type="text/css">
<link rel="stylesheet" href="style2.css" type="text/css">

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin="" even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<!--ChunkedSearchJSMarker-->
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<link rel="stylesheet" href="style3.css" type="text/css">
<script>
    function hideElement(e){
        e.setAttribute("hidden", "");
        e.classList.add("hidden");
    }

    function unhideElement(e){
        e.classList.remove("hidden");
        e.removeAttribute("hidden");
    }

    function hideLoadableContent(){
        unhideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) hideElement(loadable);
    }

    function unhideLoadableContent(){
        hideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) unhideElement(loadable);
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
<link rel="stylesheet" href="asciidoctor-chunker.css" type="text/css"></head>
<body class="book toc2 toc-left">
<div style="text-align: center;">
    <span class="image"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgdmlld0JveD0iMCAwIDExNTAgMzI2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MS40MTQyMTsiPgogICAgPGcgaWQ9IkFydGJvYXJkMSIgdHJhbnNmb3JtPSJtYXRyaXgoMC45NTUxNSwwLDAsMC44ODgyODMsLTQwLjExNjMsLTMwLjIwMTYpIj4KICAgICAgICA8cmVjdCB4PSI0MiIgeT0iMzQiIHdpZHRoPSIxMjA0IiBoZWlnaHQ9IjM2NyIgc3R5bGU9ImZpbGw6bm9uZTsiLz4KICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLjA0Njk2LDAsMCwxLjEyNTc3LC00Ni45OTEzLC01MC40MzI1KSI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik03MjQuMSwzODUuMDZMNjgzLjUzLDM4NS4wNkM2ODMuNTMsMzg1LjA2IDY4My41MywyODYuMDkgNjgzLjUzLDI1NS40QzY5Ni40OSwyNjIuNjIgNzEzLjYyLDI3NS45NCA3MjQuMSwyODguNzJMNzI0LjEsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxnPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTM4MS43NSwzODUuMDZMMzMxLjE3LDM4NS4wNkwyNjUuMTYsMTgxLjAzTDMxMS4xNywxODEuMDNMMzU2LjYxLDMyNC40OEwzNTcuMTgsMzI0LjQ4TDQwMy4xOCwxODEuMDNMNDQ5LjQ3LDE4MS4wM0wzODEuNzUsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNTg1LjUxLDM4NS4wNkw1NDYuOTMsMzg1LjA2TDU0Ni45MywzNjQuNDlMNTQ2LjA4LDM2NC40OUM1NDAuOTMsMzczLjA3IDUzNC4yNywzNzkuMjYgNTI2LjA3LDM4My4wN0M1MTcuODgsMzg2Ljg4IDUwOS41LDM4OC43OCA1MDAuOTIsMzg4Ljc4QzQ5MC4wNiwzODguNzggNDgxLjE2LDM4Ny4zNSA0NzQuMiwzODQuNUM0NjcuMjUsMzgxLjY1IDQ2MS43NywzNzcuNTkgNDU3Ljc3LDM3Mi4zNkM0NTMuNzYsMzY3LjEyIDQ1MC45NSwzNjAuNzQgNDQ5LjMzLDM1My4yMUM0NDcuNzIsMzQ1LjY5IDQ0Ni45MSwzMzcuMzUgNDQ2LjkxLDMyOC4yMUw0NDYuOTEsMjM3LjMzTDQ4Ny40OSwyMzcuMzNMNDg3LjQ5LDMyMC43N0M0ODcuNDksMzMyLjk2IDQ4OS40LDM0Mi4wNiA0OTMuMjEsMzQ4LjA2QzQ5Ny4wMiwzNTQuMDcgNTAzLjc4LDM1Ny4wNiA1MTMuNSwzNTcuMDZDNTI0LjU1LDM1Ny4wNiA1MzIuNTUsMzUzLjc4IDUzNy41LDM0Ny4yQzU0Mi40NiwzNDAuNjIgNTQ0LjkzLDMyOS44MSA1NDQuOTMsMzE0Ljc2TDU0NC45MywyMzcuMzJMNTg1LjUyLDIzNy4zMkw1ODUuNTIsMzg1LjA2TDU4NS41MSwzODUuMDZaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8cGF0aCBkPSJNNzMwLjg0LDI5Ni4xOUw3MzAuNzQsMjkwLjQ3TDc4MS44OSwyMzcuMzNMODI5LjkxLDIzNy4zM0w3NzQuMTgsMjkxLjYyTDgzNi4xOSwzODUuMDZMNzg3LjA0LDM4NS4wNkw3MzAuODQsMjk2LjE5WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik04NDMuNjIsMjgyLjc2Qzg0NC4xOSwyNzMuMjQgODQ2LjU4LDI2NS4zMyA4NTAuNzcsMjU5LjA0Qzg1NC45NiwyNTIuNzUgODYwLjI5LDI0Ny43MSA4NjYuNzcsMjQzLjlDODczLjI1LDI0MC4wOSA4ODAuNTQsMjM3LjM3IDg4OC42NCwyMzUuNzZDODk2LjczLDIzNC4xNCA5MDQuODgsMjMzLjMzIDkxMy4wNywyMzMuMzNDOTIwLjUsMjMzLjMzIDkyOC4wMiwyMzMuODUgOTM1LjY0LDIzNC45Qzk0My4yNywyMzUuOTUgOTUwLjIxLDIzOCA5NTYuNSwyNDEuMDVDOTYyLjc4LDI0NC4xIDk2Ny45MywyNDguMzQgOTcxLjk0LDI1My43NkM5NzUuOTQsMjU5LjE5IDk3Ny45NCwyNjYuMzggOTc3Ljk0LDI3NS4zNEw5NzcuOTQsMzUyLjIxQzk3Ny45NCwzNTguODggOTc4LjMyLDM2NS4yNyA5NzkuMDgsMzcxLjM2Qzk3OS44NCwzNzcuNDYgOTgxLjE4LDM4Mi4wMyA5ODMuMDksMzg1LjA4TDk0MS45NCwzODUuMDhDOTQxLjE4LDM4Mi44IDk0MC41NiwzODAuNDYgOTQwLjA4LDM3OC4wOEM5MzkuNjEsMzc1LjcgOTM5LjI3LDM3My4yOCA5MzkuMDgsMzcwLjc5QzkzMi42LDM3Ny40NyA5MjQuOTcsMzgyLjEzIDkxNi4yMSwzODQuOEM5MDcuNDUsMzg3LjQ2IDg5OC40OSwzODguOCA4ODkuMzUsMzg4LjhDODgyLjMsMzg4LjggODc1LjcyLDM4Ny45NCA4NjkuNjQsMzg2LjIzQzg2My41NCwzODQuNTIgODU4LjIsMzgxLjg1IDg1My42NCwzNzguMjNDODQ5LjA2LDM3NC42MSA4NDUuNDgsMzcwLjA0IDg0Mi45MiwzNjQuNTFDODQwLjM1LDM1OC45OSA4MzkuMDYsMzUyLjQyIDgzOS4wNiwzNDQuOEM4MzkuMDYsMzM2LjQyIDg0MC41NCwzMjkuNTEgODQzLjQ5LDMyNC4wOEM4NDYuNDUsMzE4LjY1IDg1MC4yNSwzMTQuMzIgODU0LjkzLDMxMS4wOEM4NTkuNiwzMDcuODQgODY0LjkzLDMwNS40MSA4NzAuOTMsMzAzLjc5Qzg3Ni45MywzMDIuMTcgODgyLjk4LDMwMC44OCA4ODkuMDcsMjk5LjkzQzg5NS4xNywyOTguOTkgOTAxLjE3LDI5OC4yMiA5MDcuMDgsMjk3LjY1QzkxMi45OSwyOTcuMDggOTE4LjIyLDI5Ni4yMiA5MjIuNzksMjk1LjA4QzkyNy4zNywyOTMuOTMgOTMwLjk4LDI5Mi4yNyA5MzMuNjUsMjkwLjA3QzkzNi4zMiwyODcuODggOTM3LjU2LDI4NC42OSA5MzcuMzcsMjgwLjVDOTM3LjM3LDI3Ni4xMiA5MzYuNjUsMjcyLjY0IDkzNS4yMiwyNzAuMDdDOTMzLjc5LDI2Ny41IDkzMS44OSwyNjUuNSA5MjkuNTEsMjY0LjA3QzkyNy4xMywyNjIuNjQgOTI0LjM3LDI2MS42OSA5MjEuMjIsMjYxLjIxQzkxOC4wNywyNjAuNzMgOTE0LjcsMjYwLjQ5IDkxMS4wOCwyNjAuNDlDOTAzLjA4LDI2MC40OSA4OTYuNzksMjYyLjIgODkyLjIyLDI2NS42NEM4ODcuNjUsMjY5LjA3IDg4NC45OCwyNzQuNzggODg0LjIyLDI4Mi43OUw4NDMuNjIsMjgyLjc5TDg0My42MiwyODIuNzZaTTkzNy4zNSwzMTIuNzdDOTM1LjYzLDMxNC4zIDkzMy40OSwzMTUuNDggOTMwLjkyLDMxNi4zNEM5MjguMzUsMzE3LjIxIDkyNS41OSwzMTcuOTIgOTIyLjYzLDMxOC40OUM5MTkuNjgsMzE5LjA2IDkxNi41OCwzMTkuNTQgOTEzLjM1LDMxOS45MkM5MTAuMTEsMzIwLjMgOTA2Ljg3LDMyMC43NyA5MDMuNjMsMzIxLjM1QzkwMC41OCwzMjEuOTIgODk3LjU4LDMyMi42OSA4OTQuNjMsMzIzLjYzQzg5MS42OCwzMjQuNTkgODg5LjEsMzI1Ljg3IDg4Ni45MSwzMjcuNDlDODg0LjcyLDMyOS4xMSA4ODIuOTYsMzMxLjE2IDg4MS42MiwzMzMuNjNDODgwLjI5LDMzNi4xMSA4NzkuNjIsMzM5LjI1IDg3OS42MiwzNDMuMDZDODc5LjYyLDM0Ni42OCA4ODAuMjksMzQ5LjczIDg4MS42MiwzNTIuMkM4ODIuOTYsMzU0LjY4IDg4NC43NywzNTYuNjMgODg3LjA1LDM1OC4wNkM4ODkuMzQsMzU5LjQ5IDg5MiwzNjAuNDkgODk1LjA1LDM2MS4wNkM4OTguMSwzNjEuNjMgOTAxLjI0LDM2MS45MSA5MDQuNDgsMzYxLjkxQzkxMi40OCwzNjEuOTEgOTE4LjY4LDM2MC41OCA5MjMuMDYsMzU3LjkyQzkyNy40NCwzNTUuMjUgOTMwLjY5LDM1Mi4wNiA5MzIuNzcsMzQ4LjM0QzkzNC44NiwzNDQuNjMgOTM2LjE2LDM0MC44NyA5MzYuNjIsMzM3LjA2QzkzNy4xLDMzMy4yNSA5MzcuMzMsMzMwLjIgOTM3LjM0LDMyNy45Mkw5MzcuMzQsMzEyLjc3TDkzNy4zNSwzMTIuNzdaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTEwMDQuMjEsMjM3LjMzTDEwNDIuOCwyMzcuMzNMMTA0Mi44LDI1Ny45TDEwNDMuNjUsMjU3LjlDMTA0OC43OSwyNDkuMzMgMTA1NS40NiwyNDMuMDkgMTA2My42NSwyMzkuMTlDMTA3MS44NCwyMzUuMjggMTA4MC4yMywyMzMuMzMgMTA4OC43OSwyMzMuMzNDMTA5OS42NiwyMzMuMzMgMTEwOC41NiwyMzQuODEgMTExNS41MiwyMzcuNzZDMTEyMi40NywyNDAuNzIgMTEyNy45NCwyNDQuODEgMTEzMS45NSwyNTAuMDVDMTEzNS45NSwyNTUuMjkgMTEzOC43NiwyNjEuNjcgMTE0MC4zOCwyNjkuMTlDMTE0MiwyNzYuNzIgMTE0Mi44MSwyODUuMDUgMTE0Mi44MSwyOTQuMkwxMTQyLjgxLDM4NS4wN0wxMTAyLjI0LDM4NS4wN0wxMTAyLjI0LDMwMS42M0MxMTAyLjI0LDI4OS40MyAxMTAwLjMzLDI4MC4zNCAxMDk2LjUzLDI3NC4zNEMxMDkyLjcxLDI2OC4zNCAxMDg1Ljk1LDI2NS4zNCAxMDc2LjIzLDI2NS4zNEMxMDY1LjE4LDI2NS4zNCAxMDU3LjE5LDI2OC42MyAxMDUyLjIzLDI3NS4yQzEwNDcuMjcsMjgxLjc2IDEwNDQuOCwyOTIuNTggMTA0NC44LDMwNy42M0wxMDQ0LjgsMzg1LjA3TDEwMDQuMjIsMzg1LjA3TDEwMDQuMjIsMjM3LjMzTDEwMDQuMjEsMjM3LjMzWiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik02MTIuMzcsMjExLjg0TDYxMi4zNywzODUuMDdMNjUyLjk1LDM4NS4wN0w2NTIuOTUsMjM0LjIxQzYzOS45MywyMjYuMjMgNjI2LjM2LDIxOC43NCA2MTIuMzcsMjExLjg0WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOTguNDMsMjE5LjIxQzIyMS45NSwxNTAuMzIgMzYyLjU4LDEyNS4wNSA1MTIuNTgsMTYyLjc4QzYwMi41NSwxODUuNCA2NzYuMDcsMjI5LjI4IDcyNC4wOSwyNzIuNjdDNzAyLjMsMjE1LjEyIDU5Ni42NSwxMzMuMDggNDUxLjE4LDEwNC45NkMyODYuNyw3My4xNiAxMjQuNDcsMTAxLjExIDEwNC4zOSwxNzQuMUM4OS44OSwyMjYuODMgMTUzLjU3LDI4OC42IDI1Mi4wNSwzMzAuODRDMjA3LjgxLDI5NS4wMiAxODYuMjksMjU0Ljc4IDE5OC40MywyMTkuMjFaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTcyNC4xNiwyNDcuNjJMNzI0LjE2LDE4MS4wM0w2ODMuNTcsMTgxLjAzTDY4My41NywyMDEuMjVDNzAwLjg4LDIxNi43MSA3MTQuNjEsMjMyLjQ1IDcyNC4xNiwyNDcuNjJaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS4wNDY5NiwwLDAsMS4xMjU3NywtNDYuOTkxMywtNTAuNDMyNSkiPgogICAgICAgICAgICA8cGF0aCBkPSJNMTIxNC45OCwzNjMuNDNDMTIxNC45OCwzNzUuNjkgMTIwNS4zNSwzODUuMzIgMTE5Mi44MywzODUuMzJDMTE4MC40MywzODUuMzIgMTE3MC41NCwzNzUuNjkgMTE3MC41NCwzNjMuNDNDMTE3MC41NCwzNTEuNDMgMTE4MC40MywzNDEuOCAxMTkyLjgzLDM0MS44QzEyMDUuMzUsMzQxLjggMTIxNC45OCwzNTEuNDMgMTIxNC45OCwzNjMuNDNaTTExNzYuMDgsMzYzLjQzQzExNzYuMDgsMzczLjA2IDExODMuMiwzODAuNyAxMTkyLjk2LDM4MC43QzEyMDIuNDUsMzgwLjcgMTIwOS40NCwzNzMuMDUgMTIwOS40NCwzNjMuNTZDMTIwOS40NCwzNTMuOTMgMTIwMi40NSwzNDYuMTUgMTE5Mi44MiwzNDYuMTVDMTE4My4yLDM0Ni4xNiAxMTc2LjA4LDM1My45NCAxMTc2LjA4LDM2My40M1pNMTE4OS4zOSwzNzQuNzdMMTE4NC4zOCwzNzQuNzdMMTE4NC4zOCwzNTMuMTRDMTE4Ni4zNiwzNTIuNzQgMTE4OS4xMywzNTIuNDggMTE5Mi42OSwzNTIuNDhDMTE5Ni43OCwzNTIuNDggMTE5OC42MiwzNTMuMTQgMTIwMC4yMSwzNTQuMDZDMTIwMS40LDM1NC45OCAxMjAyLjMyLDM1Ni43IDEyMDIuMzIsMzU4LjgxQzEyMDIuMzIsMzYxLjE4IDEyMDAuNDcsMzYzLjAzIDExOTcuODQsMzYzLjgyTDExOTcuODQsMzY0LjA4QzExOTkuOTUsMzY0Ljg3IDEyMDEuMTQsMzY2LjQ1IDEyMDEuOCwzNjkuMzVDMTIwMi40NiwzNzIuNjUgMTIwMi44NSwzNzMuOTcgMTIwMy4zOCwzNzQuNzZMMTE5Ny45NywzNzQuNzZDMTE5Ny4zMSwzNzMuOTcgMTE5Ni45MiwzNzEuOTkgMTE5Ni4yNiwzNjkuNDlDMTE5NS44NiwzNjcuMTIgMTE5NC41NSwzNjYuMDYgMTE5MS43OCwzNjYuMDZMMTE4OS40MSwzNjYuMDZMMTE4OS40MSwzNzQuNzdMMTE4OS4zOSwzNzQuNzdaTTExODkuNTMsMzYyLjUxTDExOTEuOSwzNjIuNTFDMTE5NC42NywzNjIuNTEgMTE5Ni45MSwzNjEuNTkgMTE5Ni45MSwzNTkuMzRDMTE5Ni45MSwzNTcuMzYgMTE5NS40NiwzNTYuMDQgMTE5Mi4yOSwzNTYuMDRDMTE5MC45NywzNTYuMDQgMTE5MC4wNSwzNTYuMTcgMTE4OS41MiwzNTYuM0wxMTg5LjUyLDM2Mi41MUwxMTg5LjUzLDM2Mi41MVoiIHN0eWxlPSJmaWxsOnJnYigxNzIsMjIsNDQpO2ZpbGwtcnVsZTpub256ZXJvOyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==" alt="Vulkan Logo" width="50%">
    </span>
</div>
<div id="header">
<h1>Vulkan<sup>®</sup> 1.2.281 - A Specification (with all ratified extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan  Working Group</span><br>
<span id="revnumber">version 1.2.281,</span>
<span id="revdate">2024-03-22 08:17:39Z</span>
<br><span id="revremark">from git branch: github-main commit: d6029cc2b7499faf2e7857420ec4996fc5cb0a50</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html">Titlepage</a></li><li><a href="chap1.html">1. Preamble</a></li>
<li><a href="chap2.html">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap2.html#introduction-conventions">2.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap3.html">3. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap3.html#fundamentals-host-environment">3.1. Host and Device Environment</a></li>
<li><a href="chap3.html#fundamentals-execmodel">3.2. Execution Model</a></li>
<li><a href="chap3.html#fundamentals-objectmodel-overview">3.3. Object Model</a></li>
<li><a href="chap3.html#fundamentals-abi">3.4. Application Binary Interface</a></li>
<li><a href="chap3.html#fundamentals-commandsyntax">3.5. Command Syntax and Duration</a></li>
<li><a href="chap3.html#fundamentals-threadingbehavior">3.6. Threading Behavior</a></li>
<li><a href="chap3.html#fundamentals-validusage">3.7. Valid Usage</a></li>
<li><a href="chap3.html#fundamentals-returncodes">3.8. <code>VkResult</code> Return Codes</a></li>
<li><a href="chap3.html#fundamentals-numerics">3.9. Numeric Representation and Computation</a></li>
<li><a href="chap3.html#fundamentals-fixedconv">3.10. Fixed-Point Data Conversions</a></li>
<li><a href="chap3.html#fundamentals-common-objects">3.11. Common Object Types</a></li>
<li><a href="chap3.html#fundamentals-api-name-aliases">3.12. API Name Aliases</a></li>
</ul>
</li>
<li><a href="chap4.html">4. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap4.html#initialization-functionpointers">4.1. Command Function Pointers</a></li>
<li><a href="chap4.html#initialization-instances">4.2. Instances</a></li>
</ul>
</li>
<li><a href="chap5.html">5. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap5.html#devsandqueues-physical-device-enumeration">5.1. Physical Devices</a></li>
<li><a href="chap5.html#devsandqueues-devices">5.2. Devices</a></li>
<li><a href="chap5.html#devsandqueues-queues">5.3. Queues</a></li>
</ul>
</li>
<li><a href="chap6.html">6. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap6.html#commandbuffers-lifecycle">6.1. Command Buffer Lifecycle</a></li>
<li><a href="chap6.html#commandbuffers-pools">6.2. Command Pools</a></li>
<li><a href="chap6.html#commandbuffer-allocation">6.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap6.html#commandbuffers-recording">6.4. Command Buffer Recording</a></li>
<li><a href="chap6.html#commandbuffers-submission">6.5. Command Buffer Submission</a></li>
<li><a href="chap6.html#commandbuffers-submission-progress">6.6. Queue Forward Progress</a></li>
<li><a href="chap6.html#commandbuffers-secondary">6.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap6.html#commandbuffers-nested">6.8. Nested Command Buffers</a></li>
<li><a href="chap6.html#commandbuffers-devicemask">6.9. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap7.html">7. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap7.html#synchronization-dependencies">7.1. Execution and Memory Dependencies</a></li>
<li><a href="chap7.html#synchronization-implicit">7.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap7.html#synchronization-fences">7.3. Fences</a></li>
<li><a href="chap7.html#synchronization-semaphores">7.4. Semaphores</a></li>
<li><a href="chap7.html#synchronization-events">7.5. Events</a></li>
<li><a href="chap7.html#synchronization-pipeline-barriers">7.6. Pipeline Barriers</a></li>
<li><a href="chap7.html#synchronization-memory-barriers">7.7. Memory Barriers</a></li>
<li><a href="chap7.html#synchronization-wait-idle">7.8. Wait Idle Operations</a></li>
<li><a href="chap7.html#synchronization-submission-host-writes">7.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap7.html#synchronization-device-group">7.10. Synchronization and Multiple Physical Devices</a></li>
<li><a href="chap7.html#calibrated-timestamps">7.11. Calibrated Timestamps</a></li>
</ul>
</li>
<li><a href="chap8.html">8. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap8.html#renderpass-objects">8.1. Render Pass Objects</a></li>
<li><a href="chap8.html#renderpass-creation">8.2. Render Pass Creation</a></li>
<li><a href="chap8.html#renderpass-compatibility">8.3. Render Pass Compatibility</a></li>
<li><a href="chap8.html#_framebuffers">8.4. Framebuffers</a></li>
<li><a href="chap8.html#renderpass-load-operations">8.5. Render Pass Load Operations</a></li>
<li><a href="chap8.html#renderpass-store-operations">8.6. Render Pass Store Operations</a></li>
<li><a href="chap8.html#renderpass-resolve-operations">8.7. Render Pass Multisample Resolve Operations</a></li>
<li><a href="chap8.html#renderpass-commands">8.8. Render Pass Commands</a></li>
<li><a href="chap8.html#_common_render_pass_data_races_informative">8.9. Common Render Pass Data Races (Informative)</a></li>
</ul>
</li>
<li><a href="chap9.html">9. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap9.html#shaders-objects">9.1. Shader Objects</a></li>
<li><a href="chap9.html#shader-modules">9.2. Shader Modules</a></li>
<li><a href="chap9.html#shaders-binding">9.3. Binding Shaders</a></li>
<li><a href="chap9.html#shaders-execution">9.4. Shader Execution</a></li>
<li><a href="chap9.html#shaders-execution-memory-ordering">9.5. Shader Memory Access Ordering</a></li>
<li><a href="chap9.html#shaders-inputs">9.6. Shader Inputs and Outputs</a></li>
<li><a href="chap9.html#shaders-vertex">9.7. Vertex Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-control">9.8. Tessellation Control Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-evaluation">9.9. Tessellation Evaluation Shaders</a></li>
<li><a href="chap9.html#shaders-geometry">9.10. Geometry Shaders</a></li>
<li><a href="chap9.html#shaders-fragment">9.11. Fragment Shaders</a></li>
<li><a href="chap9.html#shaders-compute">9.12. Compute Shaders</a></li>
<li><a href="chap9.html#shaders-ray-generation">9.13. Ray Generation Shaders</a></li>
<li><a href="chap9.html#shaders-intersection">9.14. Intersection Shaders</a></li>
<li><a href="chap9.html#shaders-any-hit">9.15. Any-Hit Shaders</a></li>
<li><a href="chap9.html#shaders-closest-hit">9.16. Closest Hit Shaders</a></li>
<li><a href="chap9.html#shaders-miss">9.17. Miss Shaders</a></li>
<li><a href="chap9.html#shaders-callable">9.18. Callable Shaders</a></li>
<li><a href="chap9.html#shaders-interpolation-decorations">9.19. Interpolation Decorations</a></li>
<li><a href="chap9.html#shaders-staticuse">9.20. Static Use</a></li>
<li><a href="chap9.html#shaders-scope">9.21. Scope</a></li>
<li><a href="chap9.html#shaders-group-operations">9.22. Group Operations</a></li>
<li><a href="chap9.html#shaders-quad-operations">9.23. Quad Group Operations</a></li>
<li><a href="chap9.html#shaders-derivative-operations">9.24. Derivative Operations</a></li>
<li><a href="chap9.html#shaders-helper-invocations">9.25. Helper Invocations</a></li>
<li><a href="chap9.html#_cooperative_matrices">9.26. Cooperative Matrices</a></li>
</ul>
</li>
<li><a href="chap10.html">10. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap10.html#pipelines-multiple">10.1. Multiple Pipeline Creation</a></li>
<li><a href="chap10.html#pipelines-compute">10.2. Compute Pipelines</a></li>
<li><a href="chap10.html#pipelines-graphics">10.3. Graphics Pipelines</a></li>
<li><a href="chap10.html#pipelines-ray-tracing">10.4. Ray Tracing Pipelines</a></li>
<li><a href="chap10.html#pipelines-destruction">10.5. Pipeline Destruction</a></li>
<li><a href="chap10.html#pipelines-pipeline-derivatives">10.6. Pipeline Derivatives</a></li>
<li><a href="chap10.html#pipelines-cache">10.7. Pipeline Cache</a></li>
<li><a href="chap10.html#pipelines-specialization-constants">10.8. Specialization Constants</a></li>
<li><a href="chap10.html#pipelines-library">10.9. Pipeline Libraries</a></li>
<li><a href="chap10.html#pipelines-binding">10.10. Pipeline Binding</a></li>
<li><a href="chap10.html#pipelines-dynamic-state">10.11. Dynamic State</a></li>
<li><a href="chap10.html#pipelines-shader-information">10.12. Pipeline Properties and Shader Information</a></li>
</ul>
</li>
<li><a href="chap11.html">11. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#memory-host">11.1. Host Memory</a></li>
<li><a href="chap11.html#memory-device">11.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap12.html">12. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap12.html#resources-buffers">12.1. Buffers</a></li>
<li><a href="chap12.html#resources-buffer-views">12.2. Buffer Views</a></li>
<li><a href="chap12.html#resources-images">12.3. Images</a></li>
<li><a href="chap12.html#resources-image-layouts">12.4. Image Layouts</a></li>
<li><a href="chap12.html#resources-image-views">12.5. Image Views</a></li>
<li><a href="chap12.html#resources-acceleration-structures">12.6. Acceleration Structures</a></li>
<li><a href="chap12.html#resources-micromaps">12.7. Micromaps</a></li>
<li><a href="chap12.html#resources-association">12.8. Resource Memory Association</a></li>
<li><a href="chap12.html#resources-sharing">12.9. Resource Sharing Mode</a></li>
<li><a href="chap12.html#resources-memory-aliasing">12.10. Memory Aliasing</a></li>
</ul>
</li>
<li><a href="chap13.html">13. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap13.html#samplers-YCbCr-conversion">13.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> Conversion</a></li>
</ul>
</li>
<li><a href="chap14.html">14. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap14.html#descriptorsets-types">14.1. Descriptor Types</a></li>
<li><a href="chap14.html#descriptorsets-sets">14.2. Descriptor Sets</a></li>
<li><a href="chap14.html#descriptorsets-physical-storage-buffer">14.3. Physical Storage Buffer Access</a></li>
</ul>
</li>
<li><a href="chap15.html">15. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap15.html#interfaces-iointerfaces">15.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap15.html#interfaces-vertexinput">15.2. Vertex Input Interface</a></li>
<li><a href="chap15.html#interfaces-fragmentoutput">15.3. Fragment Output Interface</a></li>
<li><a href="chap15.html#interfaces-fragmenttileimage">15.4. Fragment Tile Image Interface</a></li>
<li><a href="chap15.html#interfaces-inputattachment">15.5. Fragment Input Attachment Interface</a></li>
<li><a href="chap15.html#interfaces-raypipeline">15.6. Ray Tracing Pipeline Interface</a></li>
<li><a href="chap15.html#interfaces-resources">15.7. Shader Resource Interface</a></li>
<li><a href="chap15.html#interfaces-builtin-variables">15.8. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap16.html">16. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_image_operations_overview">16.1. Image Operations Overview</a></li>
<li><a href="chap16.html#_conversion_formulas">16.2. Conversion Formulas</a></li>
<li><a href="chap16.html#_texel_input_operations">16.3. Texel Input Operations</a></li>
<li><a href="chap16.html#_texel_output_operations">16.4. Texel Output Operations</a></li>
<li><a href="chap16.html#textures-normalized-operations">16.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#_unnormalized_texel_coordinate_operations">16.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-integer-coordinate-operations">16.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-sample-operations">16.8. Image Sample Operations</a></li>
<li><a href="chap16.html#textures-instructions">16.9. Image Operation Steps</a></li>
<li><a href="chap16.html#textures-queries">16.10. Image Query Instructions</a></li>
</ul>
</li>
<li><a href="chap17.html">17. Queries</a>
<ul class="sectlevel2">
<li><a href="chap17.html#queries-pools">17.1. Query Pools</a></li>
<li><a href="chap17.html#queries-operation">17.2. Query Operation</a></li>
<li><a href="chap17.html#queries-occlusion">17.3. Occlusion Queries</a></li>
<li><a href="chap17.html#queries-pipestats">17.4. Pipeline Statistics Queries</a></li>
<li><a href="chap17.html#queries-timestamps">17.5. Timestamp Queries</a></li>
<li><a href="chap17.html#queries-performance">17.6. Performance Queries</a></li>
<li><a href="chap17.html#queries-transform-feedback">17.7. Transform Feedback Queries</a></li>
<li><a href="chap17.html#queries-result-status-only">17.8. Result Status Queries</a></li>
<li><a href="chap17.html#queries-video-encode-feedback">17.9. Video Encode Feedback Queries</a></li>
</ul>
</li>
<li><a href="chap18.html">18. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#clears-outside">18.1. Clearing Images Outside a Render Pass Instance</a></li>
<li><a href="chap18.html#clears-inside">18.2. Clearing Images Inside a Render Pass Instance</a></li>
<li><a href="chap18.html#clears-values">18.3. Clear Values</a></li>
<li><a href="chap18.html#clears-filling-buffers">18.4. Filling Buffers</a></li>
<li><a href="chap18.html#clears-updating-buffers">18.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap19.html">19. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#copies-buffers">19.1. Copying Data Between Buffers</a></li>
<li><a href="chap19.html#copies-images">19.2. Copying Data Between Images</a></li>
<li><a href="chap19.html#copies-buffers-images">19.3. Copying Data Between Buffers and Images</a></li>
<li><a href="chap19.html#copies-imagescaling">19.4. Image Copies With Scaling</a></li>
<li><a href="chap19.html#copies-resolve">19.5. Resolving Multisample Images</a></li>
</ul>
</li>
<li><a href="chap20.html">20. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#drawing-primitive-topologies">20.1. Primitive Topologies</a></li>
<li><a href="chap20.html#drawing-primitive-order">20.2. Primitive Order</a></li>
<li><a href="chap20.html#drawing-primitive-shading">20.3. Programmable Primitive Shading</a></li>
</ul>
</li>
<li><a href="chap21.html">21. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap21.html#fxvertex-attrib">21.1. Vertex Attributes</a></li>
<li><a href="chap21.html#fxvertex-input">21.2. Vertex Input Description</a></li>
<li><a href="chap21.html#fxvertex-attribute_divisor">21.3. Vertex Attribute Divisor in Instanced Rendering</a></li>
<li><a href="chap21.html#fxvertex-input-address-calculation">21.4. Vertex Input Address Calculation</a></li>
</ul>
</li>
<li><a href="chap22.html">22. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap22.html#_tessellator">22.1. Tessellator</a></li>
<li><a href="chap22.html#_tessellator_patch_discard">22.2. Tessellator Patch Discard</a></li>
<li><a href="chap22.html#tessellation-tessellator-spacing">22.3. Tessellator Spacing</a></li>
<li><a href="chap22.html#tessellation-primitive-order">22.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap22.html#tessellation-vertex-winding-order">22.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap22.html#tessellation-triangle-tessellation">22.6. Triangle Tessellation</a></li>
<li><a href="chap22.html#tessellation-quad-tessellation">22.7. Quad Tessellation</a></li>
<li><a href="chap22.html#tessellation-isoline-tessellation">22.8. Isoline Tessellation</a></li>
<li><a href="chap22.html#tessellation-point-mode">22.9. Tessellation Point Mode</a></li>
<li><a href="chap22.html#_tessellation_pipeline_state">22.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap23.html">23. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#geometry-input">23.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap23.html#geometry-output">23.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap23.html#geometry-invocations">23.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap23.html#geometry-ordering">23.4. Geometry Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap24.html">24. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap24.html#vertexpostproc-transform-feedback">24.1. Transform Feedback</a></li>
<li><a href="chap24.html#vertexpostproc-flatshading">24.2. Flat Shading</a></li>
<li><a href="chap24.html#vertexpostproc-clipping">24.3. Primitive Clipping</a></li>
<li><a href="chap24.html#vertexpostproc-clipping-shader-outputs">24.4. Clipping Shader Outputs</a></li>
<li><a href="chap24.html#vertexpostproc-coord-transform">24.5. Coordinate Transformations</a></li>
<li><a href="chap24.html#vertexpostproc-viewport">24.6. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap25.html">25. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap25.html#primsrast-discard">25.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap25.html#primsrast-stream">25.2. Controlling the Vertex Stream Used for Rasterization</a></li>
<li><a href="chap25.html#primsrast-order">25.3. Rasterization Order</a></li>
<li><a href="chap25.html#primsrast-multisampling">25.4. Multisampling</a></li>
<li><a href="chap25.html#primsrast-fragment-shading-rate">25.5. Fragment Shading Rates</a></li>
<li><a href="chap25.html#primsrast-sampleshading">25.6. Sample Shading</a></li>
<li><a href="chap25.html#primsrast-barycentric">25.7. Barycentric Interpolation</a></li>
<li><a href="chap25.html#primsrast-points">25.8. Points</a></li>
<li><a href="chap25.html#primsrast-lines">25.9. Line Segments</a></li>
<li><a href="chap25.html#primsrast-polygons">25.10. Polygons</a></li>
</ul>
</li>
<li><a href="chap26.html">26. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap26.html#fragops-discard-rectangles">26.1. Discard Rectangles Test</a></li>
<li><a href="chap26.html#fragops-scissor">26.2. Scissor Test</a></li>
<li><a href="chap26.html#fragops-samplemask">26.3. Sample Mask Test</a></li>
<li><a href="chap26.html#fragops-shader">26.4. Fragment Shading</a></li>
<li><a href="chap26.html#fragops-covg">26.5. Multisample Coverage</a></li>
<li><a href="chap26.html#fragops-ds-state">26.6. Depth and Stencil Operations</a></li>
<li><a href="chap26.html#fragops-dbt">26.7. Depth Bounds Test</a></li>
<li><a href="chap26.html#fragops-stencil">26.8. Stencil Test</a></li>
<li><a href="chap26.html#fragops-depth">26.9. Depth Test</a></li>
<li><a href="chap26.html#fragops-samplecount">26.10. Sample Counting</a></li>
<li><a href="chap26.html#fragops-coverage-reduction">26.11. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap27.html">27. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap27.html#framebuffer-blending">27.1. Blending</a></li>
<li><a href="chap27.html#framebuffer-logicop">27.2. Logical Operations</a></li>
<li><a href="chap27.html#framebuffer-color-write-mask">27.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap28.html">28. Dispatching Commands</a></li>
<li><a href="chap29.html">29. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap29.html#sparsememory-sparseresourcefeatures">29.1. Sparse Resource Features</a></li>
<li><a href="chap29.html#sparsememory-fully-resident">29.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-buffers">29.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-images">29.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-sparse-memory-aliasing">29.5. Sparse Memory Aliasing</a></li>
<li><a href="chap29.html#_sparse_resource_implementation_guidelines_informative">29.6. Sparse Resource Implementation Guidelines (Informative)</a></li>
<li><a href="chap29.html#sparsememory-resourceapi">29.7. Sparse Resource API</a></li>
</ul>
</li>
<li><a href="chap30.html">30. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap30.html#_wsi_platform">30.1. WSI Platform</a></li>
<li><a href="chap30.html#_wsi_surface">30.2. WSI Surface</a></li>
<li><a href="chap30.html#display">30.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap30.html#_querying_for_wsi_support">30.4. Querying for WSI Support</a></li>
<li><a href="chap30.html#_surface_queries">30.5. Surface Queries</a></li>
<li><a href="chap30.html#_device_group_queries">30.6. Device Group Queries</a></li>
<li><a href="chap30.html#present-wait">30.7. Present Wait</a></li>
<li><a href="chap30.html#_wsi_swapchain">30.8. WSI Swapchain</a></li>
<li><a href="chap30.html#_hdr_metadata">30.9. Hdr Metadata</a></li>
</ul>
</li>
<li><a href="chap31.html">31. Deferred Host Operations</a>
<ul class="sectlevel2">
<li><a href="chap31.html#deferred-host-operations-requesting">31.1. Requesting Deferral</a></li>
<li><a href="chap31.html#_deferred_host_operations_api">31.2. Deferred Host Operations API</a></li>
</ul>
</li>
<li><a href="chap32.html">32. Acceleration Structures</a>
<ul class="sectlevel2">
<li><a href="chap32.html#acceleration-structure-def">32.1. Acceleration Structures</a></li>
<li><a href="chap32.html#host-acceleration-structure">32.2. Host Acceleration Structure Operations</a></li>
</ul>
</li>
<li><a href="chap33.html">33. Micromap</a>
<ul class="sectlevel2">
<li><a href="chap33.html#micromap-def">33.1. Micromaps</a></li>
<li><a href="chap33.html#host-micromap">33.2. Host Micromap Operations</a></li>
</ul>
</li>
<li><a href="chap34.html">34. Ray Traversal</a>
<ul class="sectlevel2">
<li><a href="chap34.html#ray-intersection-candidate-determination">34.1. Ray Intersection Candidate Determination</a></li>
<li><a href="chap34.html#ray-intersection-culling">34.2. Ray Intersection Culling</a></li>
<li><a href="chap34.html#ray-intersection-confirmation">34.3. Ray Intersection Confirmation</a></li>
<li><a href="chap34.html#ray-closest-hit-determination">34.4. Ray Closest Hit Determination</a></li>
<li><a href="chap34.html#ray-result-determination">34.5. Ray Result Determination</a></li>
</ul>
</li>
<li><a href="chap35.html">35. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="chap35.html#ray-tracing-shader-call">35.1. Shader Call Instructions</a></li>
<li><a href="chap35.html#ray-tracing-commands">35.2. Ray Tracing Commands</a></li>
<li><a href="chap35.html#shader-binding-table">35.3. Shader Binding Table</a></li>
<li><a href="chap35.html#ray-tracing-pipeline-stack">35.4. Ray Tracing Pipeline Stack</a></li>
<li><a href="chap35.html#ray-tracing-capture-replay">35.5. Ray Tracing Capture Replay</a></li>
</ul>
</li>
<li class="current"><a href="chap36.html">36. Video Coding</a>
<ul class="sectlevel2">
<li class="current"><a href="chap36.html#video-picture-resources">36.1. Video Picture Resources</a></li>
<li class="current"><a href="chap36.html#dpb">36.2. Decoded Picture Buffer</a></li>
<li class="current"><a href="chap36.html#video-profiles">36.3. Video Profiles</a></li>
<li class="current"><a href="chap36.html#video-capabilities">36.4. Video Capabilities</a></li>
<li class="current"><a href="chap36.html#video-session">36.5. Video Sessions</a></li>
<li class="current"><a href="chap36.html#video-profile-compatibility">36.6. Video Profile Compatibility</a></li>
<li class="current"><a href="chap36.html#video-session-parameters">36.7. Video Session Parameters</a></li>
<li class="current"><a href="chap36.html#video-coding-scope">36.8. Video Coding Scope</a></li>
<li class="current"><a href="chap36.html#video-coding-control">36.9. Video Coding Control</a></li>
<li class="current"><a href="chap36.html#video-inline-queries">36.10. Inline Queries</a></li>
<li class="current"><a href="chap36.html#video-decode-operations">36.11. Video Decode Operations</a></li>
<li class="current"><a href="chap36.html#decode-h264">36.12. H.264 Decode Operations</a></li>
<li class="current"><a href="chap36.html#decode-h265">36.13. H.265 Decode Operations</a></li>
<li class="current"><a href="chap36.html#decode-av1">36.14. AV1 Decode Operations</a></li>
<li class="current"><a href="chap36.html#video-encode-operations">36.15. Video Encode Operations</a></li>
<li class="current"><a href="chap36.html#encode-rate-control">36.16. Video Encode Rate Control</a></li>
<li class="current"><a href="chap36.html#encode-h264">36.17. H.264 Encode Operations</a></li>
<li class="current"><a href="chap36.html#encode-h265">36.18. H.265 Encode Operations</a></li>
</ul>
</li>
<li><a href="chap37.html">37. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap37.html#extendingvulkan-instanceanddevicefunctionality">37.1. Instance and Device Functionality</a></li>
<li><a href="chap37.html#extendingvulkan-coreversions">37.2. Core Versions</a></li>
<li><a href="chap37.html#extendingvulkan-layers">37.3. Layers</a></li>
<li><a href="chap37.html#extendingvulkan-extensions">37.4. Extensions</a></li>
<li><a href="chap37.html#extendingvulkan-extensions-extensiondependencies">37.5. Extension Dependencies</a></li>
<li><a href="chap37.html#_compatibility_guarantees_informative">37.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap38.html">38. Features</a>
<ul class="sectlevel2">
<li><a href="chap38.html#features-requirements">38.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap39.html">39. Limits</a>
<ul class="sectlevel2">
<li><a href="chap39.html#limits-minmax">39.1. Limit Requirements</a></li>
</ul>
</li>
<li><a href="chap40.html">40. Formats</a>
<ul class="sectlevel2">
<li><a href="chap40.html#formats-definition">40.1. Format Definition</a></li>
<li><a href="chap40.html#formats-properties">40.2. Format Properties</a></li>
<li><a href="chap40.html#features-required-format-support">40.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap41.html">41. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap41.html#capabilities-image">41.1. Additional Image Capabilities</a></li>
<li><a href="chap41.html#capabilities-buffer">41.2. Additional Buffer Capabilities</a></li>
<li><a href="chap41.html#capabilities-semaphore">41.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap41.html#capabilities-fence">41.4. Optional Fence Capabilities</a></li>
<li><a href="chap41.html#features-timestamp-calibration">41.5. Timestamp Calibration Capabilities</a></li>
</ul>
</li>
<li><a href="chap42.html">42. Debugging</a>
<ul class="sectlevel2">
<li><a href="chap42.html#_frame_boundary">42.1. Frame Boundary</a></li>
</ul>
</li>
<li><a href="chap43.html">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap43.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap43.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap43.html#spirvenv-module-validation">Validation Rules Within a Module</a></li>
<li><a href="chap43.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap43.html#spirvenv-image-signedness">Signedness of SPIR-V Image Accesses</a></li>
<li><a href="chap43.html#spirvenv-format-type-matching">Image Format and Type Matching</a></li>
<li><a href="chap43.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats and Vulkan Formats</a></li>
<li><a href="chap43.html#spirenv-ray-query-precision-operation">Ray Query Precision and Operation</a></li>
</ul>
</li>
<li><a href="chap44.html">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap44.html#memory-model-agent">Agent</a></li>
<li><a href="chap44.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap44.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap44.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap44.html#memory-model-references">Reference</a></li>
<li><a href="chap44.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap44.html#shader-call-related">Shader Call Related</a></li>
<li><a href="chap44.html#shader-call-order">Shader Call Order</a></li>
<li><a href="chap44.html#memory-model-scope">Scope</a></li>
<li><a href="chap44.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap44.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap44.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap44.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap44.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap44.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap44.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap44.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap44.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap44.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap44.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap44.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap44.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap44.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap44.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap44.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap44.html#memory-model-acyclicity">Acyclicity</a></li>
<li><a href="chap44.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap44.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap44.html#memory-model-informative-descriptions">Descriptions (Informative)</a></li>
<li><a href="chap44.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
</ul>
</li>
<li><a href="chap45.html">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap45.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap45.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap45.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap46.html">Appendix D: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap46.html#versions-1.2">Version 1.2</a></li>
<li><a href="chap46.html#versions-1.1">Version 1.1</a></li>
<li><a href="chap46.html#versions-1.0">Version 1.0</a></li>
</ul>
</li>
<li><a href="chap47.html">Appendix E: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap47.html#_extension_dependencies">Extension Dependencies</a></li>
<li><a href="chap47.html#_extension_interactions">Extension Interactions</a></li>
<li><a href="chap47.html#extension-appendices-list">List of Current Extensions</a></li>
<li><a href="chap47.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
<li><a href="chap47.html#deprecated-extension-appendices-list">List of Deprecated Extensions</a></li>
</ul>
</li>
<li><a href="chap48.html">Appendix F: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap48.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap48.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap48.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
<li><a href="chap48.html#boilerplate-video-std-headers">Video Std Headers</a></li>
</ul>
</li>
<li><a href="chap49.html">Appendix G: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap49.html#_repeatability">Repeatability</a></li>
<li><a href="chap49.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap49.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap49.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap50.html">Appendix H: Lexicon</a>
<ul class="sectlevel2">
<li><a href="chap50.html#glossary">Glossary</a></li>
<li><a href="chap50.html#lexicon-common-abbreviations">Common Abbreviations</a></li>
<li><a href="chap50.html#lexicon-video-abbreviations">Video-Specific Abbreviations</a></li>
<li><a href="chap50.html#lexicon-prefixes">Prefixes</a></li>
</ul>
</li>
<li><a href="chap51.html">Appendix I: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap51.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap51.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="loading_msg" class="hidden" hidden=""><p>Loading… please wait.</p></div>
<!--ChunkedSearchboxMarker-->
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
<div id="content" class="loadable"><div class="sect1">
<h2 id="video-coding"><a class="anchor" href="chap36.html"></a>36. Video Coding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vulkan implementations <strong class="purple">may</strong> expose one or more queue families supporting
video coding operations.
These operations are performed by recording them into a command buffer
within a <a href="chap36.html#video-coding-scope">video coding scope</a>, and submitting them to
queues with compatible video coding capabilities.</p>
</div>
<div class="paragraph">
<p>The Vulkan video functionalities are designed to be made available through a
set of APIs built on top of each other, consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A core API providing common video coding functionalities,</p>
</li>
<li>
<p>APIs providing codec-independent video decode and video encode related
functionalities, respectively,</p>
</li>
<li>
<p>Additional codec-specific APIs built on top of those.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This chapter details the fundamental components and operations of these.</p>
</div>
<div class="sect2">
<h3 id="video-picture-resources"><a class="anchor" href="chap36.html#video-picture-resources"></a>36.1. Video Picture Resources</h3>
<div class="paragraph">
<p>In the context of video coding, multidimensional arrays of image data that
<strong class="purple">can</strong> be used as the source or target of video coding operations are referred
to as <em>video picture resources</em>.
They <strong class="purple">may</strong> store additional metadata that includes implementation-private
information used during the execution of video coding operations, as
discussed later.</p>
</div>
<div class="paragraph">
<p>Video picture resources are backed by <a href="chap12.html#VkImage">VkImage</a> objects.
Individual subregions of <a href="chap12.html#VkImageView">VkImageView</a> objects created from such
resources <strong class="purple">can</strong> be used as
<a href="chap36.html#decode-output-picture">decode output pictures</a>,
<a href="chap36.html#encode-input-picture">encode input pictures</a>,
<a href="chap36.html#reconstructed-picture">reconstructed pictures</a>, and/or
<a href="chap36.html#reference-picture">reference pictures</a>.</p>
</div>
<div class="paragraph">
<p>The parameters of a video picture resource are specified using a
<code>VkVideoPictureResourceInfoKHR</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoPictureResourceInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoPictureResourceInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoPictureResourceInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkOffset2D</span>         <span class="n">codedOffset</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>         <span class="n">codedExtent</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">baseArrayLayer</span><span class="p">;</span>
    <span class="n">VkImageView</span>        <span class="n">imageViewBinding</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoPictureResourceInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>codedOffset</code> is the offset in texels of the image subregion to use.</p>
</li>
<li>
<p><code>codedExtent</code> is the size in pixels of the coded image data.</p>
</li>
<li>
<p><code>baseArrayLayer</code> is the array layer of the image view specified in
<code>imageViewBinding</code> to use as the video picture resource.</p>
</li>
<li>
<p><code>imageViewBinding</code> is an image view representing the video picture
resource.</p>
</li>
</ul>
</div>
<div id="video-image-subresource-reference" class="paragraph">
<p>The image subresource referred to by such a structure is defined as the
image array layer index specified in <code>baseArrayLayer</code> relative to the
image subresource range the image view specified in <code>imageViewBinding</code>
was created with.</p>
</div>
<div class="paragraph">
<p>The meaning of the <code>codedOffset</code> and <code>codedExtent</code> depends on the
command and context the video picture resource is used in, as well as on the
used <a href="chap36.html#video-profiles">video profile</a> and corresponding codec-specific
semantics, as described later.</p>
</div>
<div id="video-picture-resource-uniqueness" class="paragraph">
<p>A video picture resource is uniquely defined by the image subresource
referred to by an instance of this structure, together with the
<code>codedOffset</code> and <code>codedExtent</code> members that identify the image
subregion within the image subresource referenced corresponding to the video
picture resource according to the particular codec-specific semantics.</p>
</div>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="chap36.html#video-profiles">video profile</a>.
As a result, given an effective image subregion corresponding to a video
picture resource, the actual image subregion accessed <strong class="purple">may</strong> be larger than
that as it <strong class="purple">may</strong> include additional padding texels due to the picture access
granularity.
Any writes performed by video coding operations to such padding texels will
result in undefined texel values.</p>
</div>
<div id="video-picture-resource-matching" class="paragraph">
<p>Two video picture resources match if they refer to the same image
subresource and they specify identical <code>codedOffset</code> and
<code>codedExtent</code> values.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175" href="chap36.html#VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-baseArrayLayer-07175</span><br>

<code>baseArrayLayer</code> <strong class="purple">must</strong> be less than the
<a href="chap12.html#VkImageViewCreateInfo">VkImageViewCreateInfo</a>::<code>subresourceRange.layerCount</code> specified
when the image view <code>imageViewBinding</code> was created</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoPictureResourceInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_PICTURE_RESOURCE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoPictureResourceInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoPictureResourceInfoKHR-imageViewBinding-parameter" href="chap36.html#VUID-VkVideoPictureResourceInfoKHR-imageViewBinding-parameter"></a> <span class="vuid">VUID-VkVideoPictureResourceInfoKHR-imageViewBinding-parameter</span><br>
 <code>imageViewBinding</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkImageView">VkImageView</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dpb"><a class="anchor" href="chap36.html#dpb"></a>36.2. Decoded Picture Buffer</h3>
<div id="reconstructed-picture" class="paragraph">
<p>An integral part of video coding pipelines is the reconstruction of pictures
from a compressed video bitstream.
A <em>reconstructed picture</em> is a <a href="chap36.html#video-picture-resources">video picture
resource</a> resulting from this process.</p>
</div>
<div id="reference-picture" class="paragraph">
<p>Such reconstructed pictures <strong class="purple">can</strong> be used as <em>reference pictures</em> in
subsequent video coding operations to provide predictions of the values of
samples of subsequently decoded or encoded pictures.
The correct use of such reconstructed pictures as reference pictures is
driven by the video compression standard, the implementation, and the
application-specific use cases.</p>
</div>
<div id="active-reference-pictures" class="paragraph">
<p>The list of reference pictures used to provide such predictions within a
single video coding operation is referred to as the list of <em>active
reference pictures</em>.</p>
</div>
<div class="paragraph">
<p>The <em>decoded picture buffer (DPB)</em> is an indexed data structure that
maintains the set of reference pictures available to be used in video coding
operations.
<a id="dpb-slot"></a> Individual indexed entries of the DPB are referred to as the
<em>decoded picture buffer (DPB) slots</em>.
<a id="dpb-capacity"></a> The range of valid DPB slot indices is between zero and
<code>N-1</code>, where <code>N</code> is the capacity of the DPB.
Each DPB slot <strong class="purple">can</strong> refer to a reference picture containing a <em>video frame</em>
or <strong class="purple">can</strong> refer to up to two reference pictures containing the top and/or
bottom <em>fields</em> that, when both present, together represent a full <em>video
frame</em>
.</p>
</div>
<div id="dpb-state-and-backing-store" class="paragraph">
<p>In Vulkan, the state and the backing store of the DPB is separated as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The state of individual DPB slots is maintained by <a href="chap36.html#video-session">video
session</a> objects.</p>
</li>
<li>
<p>The backing store of DPB slots is provided by subregions of
<a href="chap12.html#VkImage">VkImage</a> objects used as <a href="chap36.html#video-picture-resources">video picture
resources</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the implementation <strong class="purple">may</strong> also maintain opaque metadata
associated with DPB slots, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="reference-metadata"></a> <em>Reference picture metadata</em> corresponding to the
video picture resource associated with the DPB slot.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such metadata <strong class="purple">may</strong> be stored by the implementation as part of the DPB slot
state maintained by the video session, or as part of the video picture
resource backing the DPB slot.</p>
</div>
<div class="paragraph">
<p>Any metadata stored in the video picture resources backing DPB slots are
independent of the video session used to store it, hence such video picture
resources <strong class="purple">can</strong> be shared with other video sessions.
Correspondingly, any metadata that is dependent on the video session will
always be stored as part of the DPB slot state maintained by that video
session.</p>
</div>
<div class="paragraph">
<p>The responsibility of managing the DPB is split between the application and
the implementation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application maintains the association between <a href="chap36.html#dpb-slot">DPB slot</a>
indices and corresponding <a href="chap36.html#video-picture-resources">video picture
resources</a>.</p>
</li>
<li>
<p>The implementation maintains global and per-slot opaque
<a href="chap36.html#reference-metadata">reference picture metadata</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, the application is also responsible for managing the mapping
between the codec-specific picture IDs and DPB slots, and any other
codec-specific states unless otherwise specified.</p>
</div>
<div class="sect3">
<h4 id="dpb-slot-states"><a class="anchor" href="chap36.html#dpb-slot-states"></a>36.2.1. DPB Slot States</h4>
<div class="paragraph">
<p>At a given time, each DPB slot is either in <em>active</em> or <em>inactive</em> state.
Initially, all DPB slots managed by a <a href="chap36.html#video-session">video session</a> are in
<em>inactive</em> state.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong class="purple">can</strong> be <em>activated</em> by using it as the target of picture
reconstruction in a video coding operation with the reconstructed picture
requested to be set up as a reference picture, according to the
codec-specific semantics, changing its state to <em>active</em> and associating it
with a <em>picture reference</em> to the <a href="chap36.html#reconstructed-picture">reconstructed
pictures</a>.</p>
</div>
<div class="paragraph">
<p>Some video coding standards allow multiple picture references to be
associated with a single DPB slot.
In this case the state of the individual picture references <strong class="purple">can</strong> be
independently updated.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As an example, H.264 decoding allows associating a separate top field and
bottom field picture with the same DPB slot.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>As part of reference picture setup, the implementation <strong class="purple">may</strong> also generate
<a href="chap36.html#reference-metadata">reference picture metadata</a>.
Such reference picture metadata is specific to each picture reference
associated with the DPB slot.</p>
</div>
<div class="paragraph">
<p>If such a video coding operation completes successfully, the activated DPB
slot will have a <em>valid picture reference</em> and the <a href="chap36.html#reconstructed-picture">reconstructed picture</a> is associated with the DPB slot.
This is true even if the DPB slot is used as the target of a picture
reconstruction that only sets up a top field or bottom field reference
picture and thus does not yet refer to a complete frame.
However, if any data provided as input to such a video coding operation is
not compliant with the video compression standard used, that video coding
operation <strong class="purple">may</strong> complete unsuccessfully, in which case the activated DPB slot
will have an <em>invalid picture reference</em>.
This is true even if the DPB slot previously had a valid picture reference
to a top field or bottom field reference picture, but the reconstruction of
the other field corresponding to the DPB slot failed.</p>
</div>
<div class="paragraph">
<p>The application <strong class="purple">can</strong> use <a href="chap17.html">queries</a> to get feedback about the
outcome of video coding operations and use the resulting
<a href="chap17.html#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> value to determine whether the video coding
operation completed successfully (result status is positive) or
unsuccessfully (result status is negative).</p>
</div>
<div class="paragraph">
<p>Using a <a href="chap36.html#reference-picture">reference picture</a> associated with a DPB slot
that has an <em>invalid picture reference</em> as an <a href="chap36.html#active-reference-pictures">active reference picture</a> in subsequent video coding operations is legal,
however, the contents of the outputs of such operations are undefined, and
any DPB slots activated by such video coding operations will also have an
<em>invalid picture reference</em>.
This is true even if such video coding operations <strong class="purple">may</strong> otherwise complete
successfully.</p>
</div>
<div class="paragraph">
<p>A DPB slot <strong class="purple">can</strong> also be <em>deactivated</em> by the application, changing its state
to <em>inactive</em> and invalidating any picture references and
<a href="chap36.html#reference-metadata">reference picture metadata</a> associated with the DPB
slot.</p>
</div>
<div class="paragraph">
<p>If an already active DPB slot is used as the target of picture
reconstruction in a video coding operation, but the decoded picture is not
requested to be set up as a reference picture, according to the
codec-specific semantics, no reference picture setup happens and the
corresponding picture reference and <a href="chap36.html#reference-metadata">reference picture
metadata</a> is invalidated within the DPB slot.
If the DPB slot no longer has any associated picture references after such
an operation, the DPB slot is implicitly deactivated.</p>
</div>
<div class="paragraph">
<p>If an already active DPB slot is used as the target of picture
reconstruction when decoding a field picture that is not marked as
reference, then the behavior is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the DPB slot is currently associated with a frame, then the DPB slot
is deactivated.</p>
</li>
<li>
<p>If the DPB slot is not currently associated with a top field picture and
the decoded picture is a top field picture, or if the DPB slot is not
currently associated with a bottom field picture and the decoded picture
is a bottom field picture, then the other field picture association of
the DPB slot, if any, is not disturbed.</p>
</li>
<li>
<p>If the DPB slot is currently associated with a top field picture and the
decoded picture is a top field picture, or if the DPB slot is currently
associated with a bottom field picture and the decoded picture is a
bottom field picture, then that picture association is invalidated,
without disturbing the other field picture association, if any.
If the DPB slot no longer has any associated picture references after
such an operation, the DPB slot is implicitly deactivated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A DPB slot <strong class="purple">can</strong> be activated with a new frame even if it is already active.
In this case all previous associations of the DPB slots with
<a href="chap36.html#reference-picture">reference pictures</a> are replaced with an association
with the <a href="chap36.html#reconstructed-picture">reconstructed picture</a> used to activate
it.</p>
</div>
<div class="paragraph">
<p>If an already active DPB slot is activated with a reconstructed field
picture, then the behavior is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the DPB slot is currently associated with a frame, then that
association is replaced with an association with the reconstructed field
picture used to activate it.</p>
</li>
<li>
<p>If the DPB slot is not currently associated with a top field picture and
the DPB slot is activated with a top field picture, or if the DPB slot
is not currently associated with a bottom field picture and the DPB slot
is activated with a bottom field picture, then the DPB slot is
associated with the reconstructed field picture used to activate it,
without disturbing the other field picture association, if any.</p>
</li>
<li>
<p>If the DPB slot is currently associated with a top field picture and the
DPB slot is activated with a new top field picture, or if the DPB slot
is currently associated with a bottom field picture and the DPB slot is
activated with a new bottom field picture, then that association is
replaced with an association with the reconstructed field picture used
to activate it, without disturbing the other field picture association,
if any.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-profiles"><a class="anchor" href="chap36.html#video-profiles"></a>36.3. Video Profiles</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoProfileInfoKHR</code> structure is defined as follows:</p>
</div>
<div id="VkVideoProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoProfileInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                     <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                         <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoCodecOperationFlagBitsKHR</span>    <span class="n">videoCodecOperation</span><span class="p">;</span>
    <span class="n">VkVideoChromaSubsamplingFlagsKHR</span>    <span class="n">chromaSubsampling</span><span class="p">;</span>
    <span class="n">VkVideoComponentBitDepthFlagsKHR</span>    <span class="n">lumaBitDepth</span><span class="p">;</span>
    <span class="n">VkVideoComponentBitDepthFlagsKHR</span>    <span class="n">chromaBitDepth</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoProfileInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoCodecOperation</code> is a <a href="chap36.html#VkVideoCodecOperationFlagBitsKHR">VkVideoCodecOperationFlagBitsKHR</a>
value specifying a video codec operation.</p>
</li>
<li>
<p><code>chromaSubsampling</code> is a bitmask of
<a href="chap36.html#VkVideoChromaSubsamplingFlagBitsKHR">VkVideoChromaSubsamplingFlagBitsKHR</a> specifying video chroma
subsampling information.</p>
</li>
<li>
<p><code>lumaBitDepth</code> is a bitmask of
<a href="chap36.html#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> specifying video luma bit
depth information.</p>
</li>
<li>
<p><code>chromaBitDepth</code> is a bitmask of
<a href="chap36.html#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> specifying video chroma bit
depth information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Video profiles are provided as input to video capability queries such as
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> or
<a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a>, as well as when creating
resources to be used by video coding operations such as images, buffers,
query pools, and video sessions.</p>
</div>
<div class="paragraph">
<p>The full description of a video profile is specified by an instance of this
structure, and the codec-specific and auxiliary structures provided in its
<code>pNext</code> chain.</p>
</div>
<div id="video-profile-error-codes" class="paragraph">
<p>When this structure is specified as an input parameter to
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a>, or through the
<code>pProfiles</code> member of a <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure in the
<code>pNext</code> chain of the input parameter of a query command such as
<a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> or
<a href="chap41.html#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a>, the following error codes
indicate specific causes of the failure of the query operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code> indicates that the
requested video picture layout
(e.g. through the <code>pictureLayout</code> member of a
<a href="chap36.html#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>VkVideoProfileInfoKHR</code>)
is not supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code> indicates that
a video profile operation specified by <code>videoCodecOperation</code> is not
supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code> indicates that
video format parameters specified by <code>chromaSubsampling</code>,
<code>lumaBitDepth</code>, or <code>chromaBitDepth</code> are not supported.</p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code> indicates that the
codec-specific parameters corresponding to the video codec operation are
not supported.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013" href="chap36.html#VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-07013</span><br>

<code>chromaSubsampling</code> <strong class="purple">must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014" href="chap36.html#VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-07014</span><br>

<code>lumaBitDepth</code> <strong class="purple">must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015" href="chap36.html#VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-07015</span><br>

If <code>chromaSubsampling</code> is not
<code>VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</code>, then
<code>chromaBitDepth</code> <strong class="purple">must</strong> have a single bit set</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07179" href="chap36.html#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07179"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07179</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07180" href="chap36.html#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07180"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07180</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoDecodeH265ProfileInfoKHR">VkVideoDecodeH265ProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-09256" href="chap36.html#VUID-VkVideoProfileInfoKHR-videoCodecOperation-09256"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-09256</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoDecodeAV1ProfileInfoKHR">VkVideoDecodeAV1ProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07181" href="chap36.html#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07181"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07181</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoEncodeH264ProfileInfoKHR">VkVideoEncodeH264ProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-07182" href="chap36.html#VUID-VkVideoProfileInfoKHR-videoCodecOperation-07182"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-07182</span><br>

If <code>videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoEncodeH265ProfileInfoKHR">VkVideoEncodeH265ProfileInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_PROFILE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-videoCodecOperation-parameter" href="chap36.html#VUID-VkVideoProfileInfoKHR-videoCodecOperation-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-videoCodecOperation-parameter</span><br>
 <code>videoCodecOperation</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoCodecOperationFlagBitsKHR">VkVideoCodecOperationFlagBitsKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-parameter" href="chap36.html#VUID-VkVideoProfileInfoKHR-chromaSubsampling-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-parameter</span><br>
 <code>chromaSubsampling</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoChromaSubsamplingFlagBitsKHR">VkVideoChromaSubsamplingFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaSubsampling-requiredbitmask" href="chap36.html#VUID-VkVideoProfileInfoKHR-chromaSubsampling-requiredbitmask"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaSubsampling-requiredbitmask</span><br>
 <code>chromaSubsampling</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-parameter" href="chap36.html#VUID-VkVideoProfileInfoKHR-lumaBitDepth-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-parameter</span><br>
 <code>lumaBitDepth</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-lumaBitDepth-requiredbitmask" href="chap36.html#VUID-VkVideoProfileInfoKHR-lumaBitDepth-requiredbitmask"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-lumaBitDepth-requiredbitmask</span><br>
 <code>lumaBitDepth</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileInfoKHR-chromaBitDepth-parameter" href="chap36.html#VUID-VkVideoProfileInfoKHR-chromaBitDepth-parameter"></a> <span class="vuid">VUID-VkVideoProfileInfoKHR-chromaBitDepth-parameter</span><br>
 <code>chromaBitDepth</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code>,
specifying the type of video coding operation and video compression standard
used by a video profile, are:</p>
</div>
<div id="VkVideoCodecOperationFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoCodecOperationFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_CODEC_OPERATION_NONE_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_encode_h264</span>
    <span class="n">VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_encode_h265</span>
    <span class="n">VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00020000</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_decode_h264</span>
    <span class="n">VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_decode_h265</span>
    <span class="n">VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_decode_av1</span>
    <span class="n">VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoCodecOperationFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_NONE_KHR</code> indicates no support for any
video codec operations.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> specifies support for
<a href="chap36.html#decode-h264">H.264 decode operations</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> specifies support for
<a href="chap36.html#decode-h265">H.265 decode operations</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code> specifies support for
<a href="chap36.html#decode-av1">AV1 decode operations</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> specifies support for
<a href="chap36.html#encode-h264">H.264 encode operations</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> specifies support for
<a href="chap36.html#encode-h265">H.265 encode operations</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoCodecOperationFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoCodecOperationFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoCodecOperationFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoCodecOperationFlagBitsKHR">VkVideoCodecOperationFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The video format chroma subsampling is defined with the following enums:</p>
</div>
<div id="VkVideoChromaSubsamplingFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoChromaSubsamplingFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_CHROMA_SUBSAMPLING_INVALID_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_CHROMA_SUBSAMPLING_420_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_CHROMA_SUBSAMPLING_422_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_CHROMA_SUBSAMPLING_444_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoChromaSubsamplingFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_MONOCHROME_BIT_KHR</code> specifies that the
format is monochrome.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_420_BIT_KHR</code> specified that the format
is 4:2:0 chroma subsampled, i.e. the two chroma components are sampled
horizontally and vertically at half the sample rate of the luma
component.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_422_BIT_KHR</code> - the format is 4:2:2
chroma subsampled, i.e. the two chroma components are sampled
horizontally at half the sample rate of luma component.</p>
</li>
<li>
<p><code>VK_VIDEO_CHROMA_SUBSAMPLING_444_BIT_KHR</code> - the format is 4:4:4
chroma sampled, i.e. all three components of the Y′C<sub>B</sub>C<sub>R</sub> format are
sampled at the same rate, thus there is no chroma subsampling.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Chroma subsampling is described in more detail in the
<a href="chap16.html#textures-chroma-reconstruction">Chroma Reconstruction</a> section.</p>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoChromaSubsamplingFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoChromaSubsamplingFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoChromaSubsamplingFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="chap36.html#VkVideoChromaSubsamplingFlagBitsKHR">VkVideoChromaSubsamplingFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values for the video format component bit depth are:</p>
</div>
<div id="VkVideoComponentBitDepthFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoComponentBitDepthFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_COMPONENT_BIT_DEPTH_INVALID_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_COMPONENT_BIT_DEPTH_8_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_COMPONENT_BIT_DEPTH_10_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_COMPONENT_BIT_DEPTH_12_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoComponentBitDepthFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_8_BIT_KHR</code> specifies a component bit
depth of 8 bits.</p>
</li>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_10_BIT_KHR</code> specifies a component bit
depth of 10 bits.</p>
</li>
<li>
<p><code>VK_VIDEO_COMPONENT_BIT_DEPTH_12_BIT_KHR</code> specifies a component bit
depth of 12 bits.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoComponentBitDepthFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoComponentBitDepthFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoComponentBitDepthFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="chap36.html#VkVideoComponentBitDepthFlagBitsKHR">VkVideoComponentBitDepthFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Additional information about the video decode use case <strong class="purple">can</strong> be provided by
adding a <code>VkVideoDecodeUsageInfoKHR</code> structure to the <code>pNext</code> chain
of <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeUsageInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeUsageInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeUsageInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>               <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                   <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoDecodeUsageFlagsKHR</span>    <span class="n">videoUsageHints</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeUsageInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoUsageHints</code> is a bitmask of
<a href="chap36.html#VkVideoDecodeUsageFlagBitsKHR">VkVideoDecodeUsageFlagBitsKHR</a> specifying hints about the intended
use of the video decode profile.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeUsageInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeUsageInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeUsageInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_USAGE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeUsageInfoKHR-videoUsageHints-parameter" href="chap36.html#VUID-VkVideoDecodeUsageInfoKHR-videoUsageHints-parameter"></a> <span class="vuid">VUID-VkVideoDecodeUsageInfoKHR-videoUsageHints-parameter</span><br>
 <code>videoUsageHints</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoDecodeUsageFlagBitsKHR">VkVideoDecodeUsageFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following bits <strong class="purple">can</strong> be specified in
<a href="chap36.html#VkVideoDecodeUsageInfoKHR">VkVideoDecodeUsageInfoKHR</a>::<code>videoUsageHints</code> as a hint about the
video decode use case:</p>
</div>
<div id="VkVideoDecodeUsageFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoDecodeUsageFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_DECODE_USAGE_DEFAULT_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_DECODE_USAGE_TRANSCODING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_DECODE_USAGE_OFFLINE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_DECODE_USAGE_STREAMING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoDecodeUsageFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_DECODE_USAGE_TRANSCODING_BIT_KHR</code> specifies that video
decoding is intended to be used in conjunction with video encoding to
transcode a video bitstream with the same and/or different codecs.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_USAGE_OFFLINE_BIT_KHR</code> specifies that video
decoding is intended to be used to consume a local video bitstream.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_USAGE_STREAMING_BIT_KHR</code> specifies that video
decoding is intended to be used to consume a video bitstream received as
a continuous flow over network.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There are no restrictions on the combination of bits that <strong class="purple">can</strong> be specified
by the application.
However, applications <strong class="purple">should</strong> use reasonable combinations in order for the
implementation to be able to select the most appropriate mode of operation
for the particular use case.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeUsageFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoDecodeUsageFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeUsageFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoDecodeUsageFlagBitsKHR">VkVideoDecodeUsageFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Additional information about the video encode use case <strong class="purple">can</strong> be provided by
adding a <code>VkVideoEncodeUsageInfoKHR</code> structure to the <code>pNext</code> chain
of <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeUsageInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeUsageInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeUsageInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                 <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                     <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeUsageFlagsKHR</span>      <span class="n">videoUsageHints</span><span class="p">;</span>
    <span class="n">VkVideoEncodeContentFlagsKHR</span>    <span class="n">videoContentHints</span><span class="p">;</span>
    <span class="n">VkVideoEncodeTuningModeKHR</span>      <span class="n">tuningMode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeUsageInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoUsageHints</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeUsageFlagBitsKHR">VkVideoEncodeUsageFlagBitsKHR</a> specifying hints about the intended
use of the video encode profile.</p>
</li>
<li>
<p><code>videoContentHints</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeContentFlagBitsKHR">VkVideoEncodeContentFlagBitsKHR</a> specifying hints about the content
to be encoded using the video encode profile.</p>
</li>
<li>
<p><code>tuningMode</code> is a <a href="chap36.html#VkVideoEncodeTuningModeKHR">VkVideoEncodeTuningModeKHR</a> value specifying
the tuning mode to use when encoding with the video profile.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeUsageInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_USAGE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-videoUsageHints-parameter" href="chap36.html#VUID-VkVideoEncodeUsageInfoKHR-videoUsageHints-parameter"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-videoUsageHints-parameter</span><br>
 <code>videoUsageHints</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoEncodeUsageFlagBitsKHR">VkVideoEncodeUsageFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-videoContentHints-parameter" href="chap36.html#VUID-VkVideoEncodeUsageInfoKHR-videoContentHints-parameter"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-videoContentHints-parameter</span><br>
 <code>videoContentHints</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoEncodeContentFlagBitsKHR">VkVideoEncodeContentFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeUsageInfoKHR-tuningMode-parameter" href="chap36.html#VUID-VkVideoEncodeUsageInfoKHR-tuningMode-parameter"></a> <span class="vuid">VUID-VkVideoEncodeUsageInfoKHR-tuningMode-parameter</span><br>
 If <code>tuningMode</code> is not <code>0</code>, <code>tuningMode</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeTuningModeKHR">VkVideoEncodeTuningModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following bits <strong class="purple">can</strong> be specified in
<a href="chap36.html#VkVideoEncodeUsageInfoKHR">VkVideoEncodeUsageInfoKHR</a>::<code>videoUsageHints</code> as a hint about the
video encode use case:</p>
</div>
<div id="VkVideoEncodeUsageFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeUsageFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_USAGE_DEFAULT_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_USAGE_TRANSCODING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_USAGE_STREAMING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_USAGE_RECORDING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_USAGE_CONFERENCING_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeUsageFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_TRANSCODING_BIT_KHR</code> specifies that video
encoding is intended to be used in conjunction with video decoding to
transcode a video bitstream with the same and/or different codecs.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_STREAMING_BIT_KHR</code> specifies that video
encoding is intended to be used to produce a video bitstream that is
expected to be sent as a continuous flow over network.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_RECORDING_BIT_KHR</code> specifies that video
encoding is intended to be used for real-time recording for offline
consumption.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_USAGE_CONFERENCING_BIT_KHR</code> specifies that video
encoding is intended to be used in a video conferencing scenario.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There are no restrictions on the combination of bits that <strong class="purple">can</strong> be specified
by the application.
However, applications <strong class="purple">should</strong> use reasonable combinations in order for the
implementation to be able to select the most appropriate mode of operation
for the particular use case.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeUsageFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeUsageFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeUsageFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoEncodeUsageFlagBitsKHR">VkVideoEncodeUsageFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following bits <strong class="purple">can</strong> be specified in
<a href="chap36.html#VkVideoEncodeUsageInfoKHR">VkVideoEncodeUsageInfoKHR</a>::<code>videoContentHints</code> as a hint about the
encoded video content:</p>
</div>
<div id="VkVideoEncodeContentFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeContentFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_CONTENT_DEFAULT_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_CONTENT_CAMERA_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_CONTENT_DESKTOP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_CONTENT_RENDERED_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeContentFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_CONTENT_CAMERA_BIT_KHR</code> specifies that video
encoding is intended to be used to encode camera content.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_CONTENT_DESKTOP_BIT_KHR</code> specifies that video
encoding is intended to be used to encode desktop content.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_CONTENT_RENDERED_BIT_KHR</code> specified that video
encoding is intended to be used to encode rendered (e.g. game) content.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There are no restrictions on the combination of bits that <strong class="purple">can</strong> be specified
by the application.
However, applications <strong class="purple">should</strong> use reasonable combinations in order for the
implementation to be able to select the most appropriate mode of operation
for the particular content type.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeContentFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeContentFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeContentFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoEncodeContentFlagBitsKHR">VkVideoEncodeContentFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible video encode tuning mode values are as follows:</p>
</div>
<div id="VkVideoEncodeTuningModeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeTuningModeKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_TUNING_MODE_DEFAULT_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_TUNING_MODE_HIGH_QUALITY_KHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_TUNING_MODE_LOW_LATENCY_KHR</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_TUNING_MODE_ULTRA_LOW_LATENCY_KHR</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_TUNING_MODE_LOSSLESS_KHR</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeTuningModeKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_DEFAULT_KHR</code> specifies the default
tuning mode.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_HIGH_QUALITY_KHR</code> specifies that video
encoding is tuned for high quality.
When using this tuning mode, the implementation <strong class="purple">may</strong> compromise the
latency of video encoding operations to improve quality.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_LOW_LATENCY_KHR</code> specifies that video
encoding is tuned for low latency.
When using this tuning mode, the implementation <strong class="purple">may</strong> compromise quality
to increase the performance and lower the latency of video encode
operations.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_ULTRA_LOW_LATENCY_KHR</code> specifies that
video encoding is tuned for ultra-low latency.
When using this tuning mode, the implementation <strong class="purple">may</strong> compromise quality
to maximize the performance and minimize the latency of video encoding
operations.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_TUNING_MODE_LOSSLESS_KHR</code> specifies that video
encoding is tuned for lossless encoding.
When using this tuning mode, video encode operations produce lossless
output.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoProfileListInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoProfileListInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoProfileListInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                 <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                     <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                        <span class="n">profileCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoProfileInfoKHR</span><span class="o">*</span>    <span class="n">pProfiles</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoProfileListInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>profileCount</code> is the number of elements in the <code>pProfiles</code>
array.</p>
</li>
<li>
<p><code>pProfiles</code> is a pointer to an array of <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structures.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Video transcoding is an example of a use case that necessitates the
specification of multiple profiles in various contexts.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When the application provides a video decode profile and one or more video
encode profiles in the profile list, the implementation ensures that any
capabilitities returned or resources created are suitable for the video
transcoding use cases without the need for manual data transformations.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-pProfiles-06813" href="chap36.html#VUID-VkVideoProfileListInfoKHR-pProfiles-06813"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-pProfiles-06813</span><br>

<code>pProfiles</code> <strong class="purple">must</strong> not contain more than one element whose
<code>videoCodecOperation</code> member specifies a decode operation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoProfileListInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_PROFILE_LIST_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoProfileListInfoKHR-pProfiles-parameter" href="chap36.html#VUID-VkVideoProfileListInfoKHR-pProfiles-parameter"></a> <span class="vuid">VUID-VkVideoProfileListInfoKHR-pProfiles-parameter</span><br>
 If <code>profileCount</code> is not <code>0</code>, <code>pProfiles</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>profileCount</code> valid <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-capabilities"><a class="anchor" href="chap36.html#video-capabilities"></a>36.4. Video Capabilities</h3>
<div class="sect3">
<h4 id="video-coding-capabilities"><a class="anchor" href="chap36.html#video-coding-capabilities"></a>36.4.1. Video Coding Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query video coding capabilities for a specific video profile, call:</p>
</div>
<div id="vkGetPhysicalDeviceVideoCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkGetPhysicalDeviceVideoCapabilitiesKHR</span><span class="p">(</span>
    <span class="n">VkPhysicalDevice</span>                            <span class="n">physicalDevice</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoProfileInfoKHR</span><span class="o">*</span>                <span class="n">pVideoProfile</span><span class="p">,</span>
    <span class="n">VkVideoCapabilitiesKHR</span><span class="o">*</span>                     <span class="n">pCapabilities</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the
video decode or encode capabilities.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structure.</p>
</li>
<li>
<p><code>pCapabilities</code> is a pointer to a <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>
structure in which the capabilities are returned.</p>
</li>
</ul>
</div>
<div id="video-profile-support" class="paragraph">
<p>If the <a href="chap36.html#video-profiles">video profile</a> described by <code>pVideoProfile</code> is
supported by the implementation, then this command returns <code>VK_SUCCESS</code>
and <code>pCapabilities</code> is filled with the capabilities supported with the
specified video profile.
Otherwise, one of the <a href="chap36.html#video-profile-error-codes">video-profile-specific
error codes</a> are returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07183" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07183"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07183</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode
operation, then the <code>pNext</code> chain of <code>pCapabilities</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07184" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07184"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07184</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07185" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07185"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07185</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeH265CapabilitiesKHR">VkVideoDecodeH265CapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-09257" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-09257"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-09257</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeAV1CapabilitiesKHR">VkVideoDecodeAV1CapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07186" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07186"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07186</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation, then the <code>pNext</code> chain of <code>pCapabilities</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07187" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07187"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07187</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07188" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07188"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-07188</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pCapabilities</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-physicalDevice-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkPhysicalDevice">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pVideoProfile-parameter</span><br>
 <code>pVideoProfile</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pCapabilities-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pCapabilities-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoCapabilitiesKHR-pCapabilities-parameter</span><br>
 <code>pCapabilities</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoCapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>              <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoCapabilityFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                 <span class="n">minBitstreamBufferOffsetAlignment</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                 <span class="n">minBitstreamBufferSizeAlignment</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>                   <span class="n">pictureAccessGranularity</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>                   <span class="n">minCodedExtent</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>                   <span class="n">maxCodedExtent</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                     <span class="n">maxDpbSlots</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                     <span class="n">maxActiveReferencePictures</span><span class="p">;</span>
    <span class="n">VkExtensionProperties</span>        <span class="n">stdHeaderVersion</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoCapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoCapabilityFlagBitsKHR">VkVideoCapabilityFlagBitsKHR</a>
specifying capability flags.</p>
</li>
<li>
<p><code>minBitstreamBufferOffsetAlignment</code> is the minimum alignment for
bitstream buffer offsets.</p>
</li>
<li>
<p><code>minBitstreamBufferSizeAlignment</code> is the minimum alignment for
bitstream buffer range sizes.</p>
</li>
<li>
<p><code>pictureAccessGranularity</code> is the granularity at which image access
to video picture resources happen.</p>
</li>
<li>
<p><code>minCodedExtent</code> is the minimum width and height of the coded
frames.</p>
</li>
<li>
<p><code>maxCodedExtent</code> is the maximum width and height of the coded
frames.</p>
</li>
<li>
<p><code>maxDpbSlots</code> is the maximum number of <a href="chap36.html#dpb-slot">DPB slots</a>
supported by a single video session.</p>
</li>
<li>
<p><code>maxActiveReferencePictures</code> is the maximum number of
<a href="chap36.html#active-reference-pictures">active reference pictures</a> a single video
coding operation <strong class="purple">can</strong> use.</p>
</li>
<li>
<p><a id="video-std-header-version"></a> <code>stdHeaderVersion</code> is a
<a href="chap37.html#VkExtensionProperties">VkExtensionProperties</a> structure reporting the Video Std header
name and version supported for the video profile.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It is common for video compression standards to allow using all reference
pictures associated with active DPB slots as active reference pictures,
hence for video decode profiles the values returned in <code>maxDpbSlots</code> and
<code>maxActiveReferencePictures</code> are often equal.
Similarly, in case of video decode profiles supporting field pictures the
value of <code>maxActiveReferencePictures</code> often equals
<span class="eq"><code>maxDpbSlots</code> × 2</span>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoCapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoCapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoCapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_CAPABILITIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoCapabilitiesKHR-pNext-pNext" href="chap36.html#VUID-VkVideoCapabilitiesKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoCapabilitiesKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoDecodeAV1CapabilitiesKHR">VkVideoDecodeAV1CapabilitiesKHR</a>, <a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>, <a href="chap36.html#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a>, <a href="chap36.html#VkVideoDecodeH265CapabilitiesKHR">VkVideoDecodeH265CapabilitiesKHR</a>, <a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>, <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>, or <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoCapabilitiesKHR-sType-unique" href="chap36.html#VUID-VkVideoCapabilitiesKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoCapabilitiesKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>flags</code> are:</p>
</div>
<div id="VkVideoCapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoCapabilityFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoCapabilityFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</code> indicates that video
sessions support producing and consuming protected content.</p>
</li>
<li>
<p><a id="separate-reference-images"></a>
<code>VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</code> indicates
that the <a href="chap36.html#video-picture-resources">video picture resources</a> associated
with the <a href="chap36.html#dpb-slot">DPB slots</a> of a video session <strong class="purple">can</strong> be backed by
separate <code>VkImage</code> objects.
If this capability flag is not present, then all DPB slots of a video
session <strong class="purple">must</strong> be associated with video picture resources backed by the
same <code>VkImage</code> object (e.g. using different layers of the same
image).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoCapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoCapabilityFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoCapabilityFlagsKHR</code> is a bitmask type for setting a mask of zero
or more <a href="chap36.html#VkVideoCapabilityFlagBitsKHR">VkVideoCapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="video-format-capabilities"><a class="anchor" href="chap36.html#video-format-capabilities"></a>36.4.2. Video Format Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To enumerate the supported output, input and DPB image formats and
corresponding capabilities for a specific video profile, call:</p>
</div>
<div id="vkGetPhysicalDeviceVideoFormatPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkGetPhysicalDeviceVideoFormatPropertiesKHR</span><span class="p">(</span>
    <span class="n">VkPhysicalDevice</span>                            <span class="n">physicalDevice</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkPhysicalDeviceVideoFormatInfoKHR</span><span class="o">*</span>   <span class="n">pVideoFormatInfo</span><span class="p">,</span>
    <span class="kt">uint32_t</span><span class="o">*</span>                                   <span class="n">pVideoFormatPropertyCount</span><span class="p">,</span>
    <span class="n">VkVideoFormatPropertiesKHR</span><span class="o">*</span>                 <span class="n">pVideoFormatProperties</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device from which to query the
video format properties.</p>
</li>
<li>
<p><code>pVideoFormatInfo</code> is a pointer to a
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a> structure specifying the usage
and video profiles for which supported image formats and capabilities
are returned.</p>
</li>
<li>
<p><code>pVideoFormatPropertyCount</code> is a pointer to an integer related to
the number of video format properties available or queried, as described
below.</p>
</li>
<li>
<p><code>pVideoFormatProperties</code> is a pointer to an array of
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structures in which supported image
formats and capabilities are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pVideoFormatProperties</code> is <code>NULL</code>, then the number of video format
properties supported for the given <code>physicalDevice</code> is returned in
<code>pVideoFormatPropertyCount</code>.
Otherwise, <code>pVideoFormatPropertyCount</code> <strong class="purple">must</strong> point to a variable set by
the user to the number of elements in the <code>pVideoFormatProperties</code>
array, and on return the variable is overwritten with the number of values
actually written to <code>pVideoFormatProperties</code>.
If the value of <code>pVideoFormatPropertyCount</code> is less than the number of
video format properties supported, at most <code>pVideoFormatPropertyCount</code>
values will be written to <code>pVideoFormatProperties</code>, and
<code>VK_INCOMPLETE</code> will be returned instead of <code>VK_SUCCESS</code>, to
indicate that not all the available values were returned.</p>
</div>
<div class="paragraph">
<p>Video format properties are always queried with respect to a specific set of
video profiles.
These are specified by chaining the <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a>
structure to <code>pVideoFormatInfo</code>.</p>
</div>
<div class="paragraph">
<p>For most use cases, the images are used by a single video session and a
single video profile is provided.
For a use case such as video transcoding, where a decode session output
image <strong class="purple">can</strong> be used as encode input in one or more encode sessions, multiple
video profiles corresponding to the video sessions that will share the image
<strong class="purple">must</strong> be provided.</p>
</div>
<div class="paragraph">
<p>If any of the <a href="chap36.html#video-profiles">video profiles</a> specified via
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a>::<code>pProfiles</code> are not supported, then
this command returns one of the <a href="chap36.html#video-profile-error-codes">video-profile-specific error codes</a>.
Furthermore, if <a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code>
includes any image usage flags not supported by the specified video
profiles, then this command returns
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>This command also returns <code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code> if
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> does not include
the appropriate flags as dictated by the decode capability flags returned in
<a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> for any of the profiles
specified in the <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure provided in the
<code>pNext</code> chain of <code>pVideoFormatInfo</code>.</p>
</div>
<div class="paragraph">
<p>If the decode capability flags include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> but not
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>, then in
order to query video format properties for decode DPB and output usage,
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> <strong class="purple">must</strong> include
both <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code> and
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>.
Otherwise, the call will fail with
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>If the decode capability flags include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code> but not
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code>, then in
order to query video format properties for decode DPB usage,
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> <strong class="purple">must</strong> include
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code>, but not
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>.
Otherwise, the call will fail with
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.
Similarly, to query video format properties for decode output usage,
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> <strong class="purple">must</strong> include
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>, but not
<code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code>.
Otherwise, the call will fail with
<code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div class="paragraph">
<p>The <code>imageUsage</code> member of the <a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>
structure specifies the expected video usage flags that the returned video
formats <strong class="purple">must</strong> support.
Correspondingly, the <code>imageUsageFlags</code> member of each
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structure returned will contain at least
the same set of image usage flags.</p>
</div>
<div class="paragraph">
<p>If the implementation supports using video input, output, or DPB images of a
particular format in operations other than video decode/encode then the
<code>imageUsageFlags</code> member of the corresponding
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structure returned will include additional
image usage flags indicating that.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For most use cases, only decode or encode related usage flags are going to
be specified.
For a use case such as transcode, if the image were to be shared between
decode and encode session(s), then both decode and encode related usage
flags <strong class="purple">can</strong> be set.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Multiple <code>VkVideoFormatPropertiesKHR</code> entries <strong class="purple">may</strong> be returned with the
same <code>format</code> member with different <code>componentMapping</code>,
<code>imageType</code>, or <code>imageTiling</code> values, as described later.</p>
</div>
<div class="paragraph">
<p>In addition, a different set of <code>VkVideoFormatPropertiesKHR</code> entries
<strong class="purple">may</strong> be returned depending on the <code>imageUsage</code> member of the
<code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure, even for the same set of
video profiles, for example, based on whether encode input, encode DPB,
decode output, and/or decode DPB usage is requested.</p>
</div>
<div class="paragraph">
<p>The application <strong class="purple">can</strong> select the parameters returned in the
<code>VkVideoFormatPropertiesKHR</code> entries and use compatible parameters when
creating the input, output, and DPB images.
The implementation will report all image creation and usage flags that are
valid for images used with the requested video profiles but applications
<strong class="purple">should</strong> create images only with those that are necessary for the particular
use case.</p>
</div>
<div class="paragraph">
<p>Before creating an image, the application <strong class="purple">can</strong> obtain the complete set of
supported image format features by calling
<a href="chap41.html#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a> using parameters derived
from the members of one of the reported <code>VkVideoFormatPropertiesKHR</code>
entries and adding the same <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure to the
<code>pNext</code> chain of <a href="chap41.html#VkPhysicalDeviceImageFormatInfo2">VkPhysicalDeviceImageFormatInfo2</a>.</p>
</div>
<div class="paragraph">
<p>The following applies to all <code>VkVideoFormatPropertiesKHR</code> entries
returned by <code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap40.html#vkGetPhysicalDeviceFormatProperties2">vkGetPhysicalDeviceFormatProperties2</a> <strong class="purple">must</strong> succeed when called
with <code>VkVideoFormatPropertiesKHR</code>::<code>format</code></p>
</li>
<li>
<p>If <code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code> is
<code>VK_IMAGE_TILING_OPTIMAL</code>, then the <code>optimalTilingFeatures</code>
returned by <a href="chap40.html#vkGetPhysicalDeviceFormatProperties2">vkGetPhysicalDeviceFormatProperties2</a> <strong class="purple">must</strong> include all
format features required by the image usage flags reported in
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code> for the format,
as indicated in the <a href="chap40.html#format-feature-dependent-usage-flags">Format
Feature Dependent Usage Flags</a> section.</p>
</li>
<li>
<p>If <code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code> is
<code>VK_IMAGE_TILING_LINEAR</code>, then the <code>linearTilingFeatures</code>
returned by <a href="chap40.html#vkGetPhysicalDeviceFormatProperties2">vkGetPhysicalDeviceFormatProperties2</a> <strong class="purple">must</strong> include all
format features required by the image usage flags reported in
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code> for the format,
as indicated in the <a href="chap40.html#format-feature-dependent-usage-flags">Format
Feature Dependent Usage Flags</a> section.</p>
</li>
<li>
<p><a href="chap41.html#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a> <strong class="purple">must</strong> succeed when
called with a <a href="chap41.html#VkPhysicalDeviceImageFormatInfo2">VkPhysicalDeviceImageFormatInfo2</a> structure
containing the following information:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>pNext</code> chain including the same
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure used to call
<code>vkGetPhysicalDeviceVideoFormatPropertiesKHR</code>.</p>
</li>
<li>
<p><code>format</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>format</code>.</p>
</li>
<li>
<p><code>type</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageType</code>.</p>
</li>
<li>
<p><code>tiling</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageTiling</code>.</p>
</li>
<li>
<p><code>usage</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageUsageFlags</code>.</p>
</li>
<li>
<p><code>flags</code> set to the value of
<code>VkVideoFormatPropertiesKHR</code>::<code>imageCreateFlags</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>componentMapping</code> member of <code>VkVideoFormatPropertiesKHR</code>
defines the ordering of the Y′C<sub>B</sub>C<sub>R</sub> color channels from the perspective of
the video codec operations specified in <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a>.
For example, if the implementation produces video decode output with the
format <code>VK_FORMAT_G8_B8R8_2PLANE_420_UNORM</code> where the blue and red
chrominance channels are swapped then the <code>componentMapping</code> member of
the corresponding <code>VkVideoFormatPropertiesKHR</code> structure will have the
following member values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="n">components</span><span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">VK_COMPONENT_SWIZZLE_B</span><span class="p">;</span>        <span class="c1">// Cb component</span>
<span class="n">components</span><span class="p">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">VK_COMPONENT_SWIZZLE_IDENTITY</span><span class="p">;</span> <span class="c1">// Y component</span>
<span class="n">components</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">VK_COMPONENT_SWIZZLE_R</span><span class="p">;</span>        <span class="c1">// Cr component</span>
<span class="n">components</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">VK_COMPONENT_SWIZZLE_IDENTITY</span><span class="p">;</span> <span class="c1">// unused, defaults to 1.0</span></code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812" href="chap36.html#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pNext-06812</span><br>

The <code>pNext</code> chain of <code>pVideoFormatInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with <code>profileCount</code>
greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-physicalDevice-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkPhysicalDevice">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatInfo-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatInfo-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatInfo-parameter</span><br>
 <code>pVideoFormatInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatPropertyCount-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatPropertyCount-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatPropertyCount-parameter</span><br>
 <code>pVideoFormatPropertyCount</code> <strong class="purple">must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatProperties-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatProperties-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoFormatPropertiesKHR-pVideoFormatProperties-parameter</span><br>
 If the value referenced by <code>pVideoFormatPropertyCount</code> is not <code>0</code>, and <code>pVideoFormatProperties</code> is not <code>NULL</code>, <code>pVideoFormatProperties</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pVideoFormatPropertyCount</code> <a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_IMAGE_USAGE_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceVideoFormatInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkPhysicalDeviceVideoFormatInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkPhysicalDeviceVideoFormatInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>      <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>          <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkImageUsageFlags</span>    <span class="n">imageUsage</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkPhysicalDeviceVideoFormatInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>imageUsage</code> is a bitmask of <a href="chap12.html#VkImageUsageFlagBits">VkImageUsageFlagBits</a> specifying
the intended usage of the video images.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-sType" href="chap36.html#VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_VIDEO_FORMAT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-pNext-pNext" href="chap36.html#VUID-VkPhysicalDeviceVideoFormatInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-unique" href="chap36.html#VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-parameter" href="chap36.html#VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-parameter"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-parameter</span><br>
 <code>imageUsage</code> <strong class="purple">must</strong> be a valid combination of <a href="chap12.html#VkImageUsageFlagBits">VkImageUsageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-requiredbitmask" href="chap36.html#VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-requiredbitmask"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoFormatInfoKHR-imageUsage-requiredbitmask</span><br>
 <code>imageUsage</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoFormatPropertiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoFormatPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoFormatPropertiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>       <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                 <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkFormat</span>              <span class="n">format</span><span class="p">;</span>
    <span class="n">VkComponentMapping</span>    <span class="n">componentMapping</span><span class="p">;</span>
    <span class="n">VkImageCreateFlags</span>    <span class="n">imageCreateFlags</span><span class="p">;</span>
    <span class="n">VkImageType</span>           <span class="n">imageType</span><span class="p">;</span>
    <span class="n">VkImageTiling</span>         <span class="n">imageTiling</span><span class="p">;</span>
    <span class="n">VkImageUsageFlags</span>     <span class="n">imageUsageFlags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoFormatPropertiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>format</code> is a <a href="chap40.html#VkFormat">VkFormat</a> that specifies the format that <strong class="purple">can</strong> be
used with the specified video profiles and image usages.</p>
</li>
<li>
<p><code>componentMapping</code> defines the color channel order used for the
format.
<code>format</code> along with <code>componentMapping</code> describe how the color
channels are ordered when producing video decoder output or are expected
to be ordered in video encoder input, when applicable.
If the <code>format</code> reported does not require component swizzling then
all members of <code>componentMapping</code> will be set to
<code>VK_COMPONENT_SWIZZLE_IDENTITY</code>.</p>
</li>
<li>
<p><code>imageCreateFlags</code> is a bitmask of <a href="chap12.html#VkImageCreateFlagBits">VkImageCreateFlagBits</a>
specifying the supported image creation flags for the format.</p>
</li>
<li>
<p><code>imageType</code> is a <a href="chap12.html#VkImageType">VkImageType</a> that specifies the image type the
format <strong class="purple">can</strong> be used with.</p>
</li>
<li>
<p><code>imageTiling</code> is a <a href="chap12.html#VkImageTiling">VkImageTiling</a> that specifies the image
tiling the format <strong class="purple">can</strong> be used with.</p>
</li>
<li>
<p><code>imageUsageFlags</code> is a bitmask of <a href="chap12.html#VkImageUsageFlagBits">VkImageUsageFlagBits</a>
specifying the supported image usage flags for the format.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoFormatPropertiesKHR-sType-sType" href="chap36.html#VUID-VkVideoFormatPropertiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoFormatPropertiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_FORMAT_PROPERTIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoFormatPropertiesKHR-pNext-pNext" href="chap36.html#VUID-VkVideoFormatPropertiesKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoFormatPropertiesKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-session"><a class="anchor" href="chap36.html#video-session"></a>36.5. Video Sessions</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Video sessions are objects that represent and maintain the state needed to
perform video decode or encode operations using a specific video profile.</p>
</div>
<div class="paragraph">
<p>In case of video encode profiles this includes the current
<a href="chap36.html#encode-rate-control">rate control</a> configuration and the currently set
<a href="chap36.html#encode-quality-level">video encode quality level</a>.</p>
</div>
<div class="paragraph">
<p>Video sessions are represented by <code>VkVideoSessionKHR</code> handles:</p>
</div>
<div id="VkVideoSessionKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VK_DEFINE_NON_DISPATCHABLE_HANDLE</span><span class="p">(</span><span class="n">VkVideoSessionKHR</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="video-session-creation"><a class="anchor" href="chap36.html#video-session-creation"></a>36.5.1. Creating a Video Session</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a video session object, call:</p>
</div>
<div id="vkCreateVideoSessionKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkCreateVideoSessionKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoSessionCreateInfoKHR</span><span class="o">*</span>          <span class="n">pCreateInfo</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">,</span>
    <span class="n">VkVideoSessionKHR</span><span class="o">*</span>                          <span class="n">pVideoSession</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the video session.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>
structure containing parameters to be used to create the video session.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pVideoSession</code> is a pointer to a <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle in
which the resulting video session object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting video session object is said to be created with the video
codec operation specified in
<code>pCreateInfo-&gt;pVideoProfile-&gt;videoCodecOperation</code>.</p>
</div>
<div class="paragraph">
<p>The name and version of the codec-specific Video Std header to be used with
the video session is specified by the <a href="chap37.html#VkExtensionProperties">VkExtensionProperties</a> structure
pointed to by <code>pCreateInfo-&gt;pStdHeaderVersion</code>.
If a non-existent or unsupported Video Std header version is specified in
<code>pCreateInfo-&gt;pStdHeaderVersion-&gt;specVersion</code>, then this command returns
<code>VK_ERROR_VIDEO_STD_VERSION_NOT_SUPPORTED_KHR</code>.</p>
</div>
<div id="video-session-uninitialized" class="paragraph">
<p>Video session objects are created in <em>uninitialized</em> state.
In order to transition the video session into <em>initial</em> state, the
application <strong class="purple">must</strong> issue a <a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command with
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> including
<code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>.</p>
</div>
<div class="paragraph">
<p>Video session objects also maintain the
<a href="chap36.html#dpb-state-and-backing-store">state</a> of the DPB.
The number of DPB slots usable with the created video session is specified
in <code>pCreateInfo-&gt;maxDpbSlots</code>, and each slot is initially in the
<a href="chap36.html#dpb-slot-states">inactive state</a>.</p>
</div>
<div class="paragraph">
<p>Each <a href="chap36.html#dpb-slot">DPB slot</a> maintained by the created video session <strong class="purple">can</strong>
refer to a <a href="chap36.html#reference-picture">reference picture</a> representing a video
frame.</p>
</div>
<div id="decode-h264-interlaced-support" class="paragraph">
<p>In addition, if the <code>videoCodecOperation</code> member of the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure pointed to by
<code>pCreateInfo-&gt;pVideoProfile</code> is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pictureLayout</code> member of the <a href="chap36.html#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>
structure provided in the <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain is
not <code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_PROGRESSIVE_KHR</code>, then the
created video session supports <em>interlaced</em> frames and each <a href="chap36.html#dpb-slot">DPB
slot</a> maintained by the created video session <strong class="purple">can</strong> instead refer to
separate top field and bottom field <a href="chap36.html#reference-picture">reference pictures</a>
that together <strong class="purple">can</strong> represent a full video frame.
In this case, it is up to the application, driven by the video content,
whether it associates any individual DPB slot with separate top and/or
bottom field pictures or a single picture representing a full frame.</p>
</div>
<div class="paragraph">
<p>The created video session <strong class="purple">can</strong> be used to perform video coding operations
using video frames up to the maximum size specified in
<code>pCreateInfo-&gt;maxCodedExtent</code>.
The minimum frame size allowed is implicitly derived from
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minCodedExtent</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified by <code>pCreateInfo-&gt;pVideoProfile</code>.
Accordingly, the created video session is said to be created with a
<code>minCodedExtent</code> equal to that.</p>
</div>
<div class="paragraph">
<p>In case of video session objects created with a video encode operation,
implementations <strong class="purple">may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-device-parameter" href="chap36.html#VUID-vkCreateVideoSessionKHR-device-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-pCreateInfo-parameter" href="chap36.html#VUID-vkCreateVideoSessionKHR-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-pAllocator-parameter" href="chap36.html#VUID-vkCreateVideoSessionKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionKHR-pVideoSession-parameter" href="chap36.html#VUID-vkCreateVideoSessionKHR-pVideoSession-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionKHR-pVideoSession-parameter</span><br>
 <code>pVideoSession</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_STD_VERSION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoSessionCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoSessionCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                 <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                     <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                        <span class="n">queueFamilyIndex</span><span class="p">;</span>
    <span class="n">VkVideoSessionCreateFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoProfileInfoKHR</span><span class="o">*</span>    <span class="n">pVideoProfile</span><span class="p">;</span>
    <span class="n">VkFormat</span>                        <span class="n">pictureFormat</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>                      <span class="n">maxCodedExtent</span><span class="p">;</span>
    <span class="n">VkFormat</span>                        <span class="n">referencePictureFormat</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                        <span class="n">maxDpbSlots</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                        <span class="n">maxActiveReferencePictures</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkExtensionProperties</span><span class="o">*</span>    <span class="n">pStdHeaderVersion</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoSessionCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is the index of the queue family the created
video session will be used with.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoSessionCreateFlagBitsKHR">VkVideoSessionCreateFlagBitsKHR</a>
specifying creation flags.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structure specifying the video profile the created video session will be
used with.</p>
</li>
<li>
<p><code>pictureFormat</code> is the image format the created video session will
be used with.
If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode
operation, then <code>pictureFormat</code> is the image format of
<a href="chap36.html#decode-output-picture">decode output pictures</a> usable with the
created video session.
If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation, then <code>pictureFormat</code> is the image format of
<a href="chap36.html#encode-input-picture">encode input pictures</a> usable with the created
video session.</p>
</li>
<li>
<p><code>maxCodedExtent</code> is the maximum width and height of the coded frames
the created video session will be used with.</p>
</li>
<li>
<p><code>referencePictureFormat</code> is the image format of
<a href="chap36.html#reference-picture">reference pictures</a> stored in the <a href="chap36.html#dpb">DPB</a> the
created video session will be used with.</p>
</li>
<li>
<p><code>maxDpbSlots</code> is the maximum number of <a href="chap36.html#dpb-slot">DPB Slots</a> that
<strong class="purple">can</strong> be used with the created video session.</p>
</li>
<li>
<p><code>maxActiveReferencePictures</code> is the maximum number of
<a href="chap36.html#active-reference-pictures">active reference pictures</a> that <strong class="purple">can</strong> be
used in a single video coding operation using the created video session.</p>
</li>
<li>
<p><code>pStdHeaderVersion</code> is a pointer to a <a href="chap37.html#VkExtensionProperties">VkExtensionProperties</a>
structure requesting the Video Std header version to use for the
<code>videoCodecOperation</code> specified in <code>pVideoProfile</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-protectedMemory-07189</span><br>

If the <a href="chap38.html#features-protectedMemory"><code>protectedMemory</code></a> feature is
not enabled or if <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>flags</code> does not
include <code>VK_VIDEO_CAPABILITY_PROTECTED_CONTENT_BIT_KHR</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified by <code>pVideoProfile</code>, then <code>flags</code> <strong class="purple">must</strong> not include
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-flags-08371" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-flags-08371"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-flags-08371</span><br>

If <code>flags</code> includes
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, then
<a href="chap38.html#features-videoMaintenance1"><code>videoMaintenance1</code></a> <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-04845</span><br>

<code>pVideoProfile</code> <strong class="purple">must</strong> be a <a href="chap36.html#video-profile-support">supported video
profile</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04847</span><br>

<code>maxDpbSlots</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>maxDpbSlots</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxActiveReferencePictures-04849</span><br>

<code>maxActiveReferencePictures</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>maxActiveReferencePictures</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxDpbSlots-04850</span><br>

If either <code>maxDpbSlots</code> or <code>maxActiveReferencePictures</code> is <code>0</code>,
then both <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-maxCodedExtent-04851</span><br>

<code>maxCodedExtent</code> <strong class="purple">must</strong> be between
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minCodedExtent</code> and
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>maxCodedExtent</code>, inclusive, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-04852" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-04852"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-04852</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode operation
and <code>maxActiveReferencePictures</code> is greater than <code>0</code>, then
<code>referencePictureFormat</code> <strong class="purple">must</strong> be one of the supported decode DPB
formats, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code>, and with a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-06814" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-06814"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-06814</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation and <code>maxActiveReferencePictures</code> is greater than <code>0</code>, then
<code>referencePictureFormat</code> <strong class="purple">must</strong> be one of the supported decode DPB
formats, as returned by then <code>referencePictureFormat</code> <strong class="purple">must</strong> be one
of the supported encode DPB formats, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code>, and with a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04853" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04853"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04853</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies a decode
operation, then <code>pictureFormat</code> <strong class="purple">must</strong> be one of the supported decode
output formats, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code>, and with a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04854" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04854"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pictureFormat-04854</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> specifies an encode
operation, then <code>pictureFormat</code> <strong class="purple">must</strong> be one of the supported encode
input formats, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> in
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code> when called with the
<code>imageUsage</code> member of its <code>pVideoFormatInfo</code> parameter
containing <code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code>, and with a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure specified in the <code>pNext</code>
chain of its <code>pVideoFormatInfo</code> parameter whose <code>pProfiles</code>
member contains an element matching <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07190</span><br>

<code>pStdHeaderVersion-&gt;extensionName</code> <strong class="purple">must</strong> match
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>stdHeaderVersion.extensionName</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-07191</span><br>

<code>pStdHeaderVersion-&gt;specVersion</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>stdHeaderVersion.specVersion</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile specified by <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-08251" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-08251"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-08251</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and the <code>pNext</code>
chain of this structure includes a
<a href="chap36.html#VkVideoEncodeH264SessionCreateInfoKHR">VkVideoEncodeH264SessionCreateInfoKHR</a> structure, then its
<code>maxLevelIdc</code> member <strong class="purple">must</strong> be less than or equal to
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxLevelIdc</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified in <code>pVideoProfile</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-08252" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-08252"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-08252</span><br>

If <code>pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the <code>pNext</code>
chain of this structure includes a
<a href="chap36.html#VkVideoEncodeH265SessionCreateInfoKHR">VkVideoEncodeH265SessionCreateInfoKHR</a> structure, then its
<code>maxLevelIdc</code> member <strong class="purple">must</strong> be less than or equal to
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxLevelIdc</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified in <code>pVideoProfile</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264SessionCreateInfoKHR">VkVideoEncodeH264SessionCreateInfoKHR</a> or <a href="chap36.html#VkVideoEncodeH265SessionCreateInfoKHR">VkVideoEncodeH265SessionCreateInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-flags-parameter" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoSessionCreateFlagBitsKHR">VkVideoSessionCreateFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-parameter" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pVideoProfile-parameter</span><br>
 <code>pVideoProfile</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pictureFormat-parameter" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pictureFormat-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pictureFormat-parameter</span><br>
 <code>pictureFormat</code> <strong class="purple">must</strong> be a valid <a href="chap40.html#VkFormat">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-parameter" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-referencePictureFormat-parameter</span><br>
 <code>referencePictureFormat</code> <strong class="purple">must</strong> be a valid <a href="chap40.html#VkFormat">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-parameter" href="chap36.html#VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-parameter"></a> <span class="vuid">VUID-VkVideoSessionCreateInfoKHR-pStdHeaderVersion-parameter</span><br>
 <code>pStdHeaderVersion</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap37.html#VkExtensionProperties">VkExtensionProperties</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>flags</code>
are:</p>
</div>
<div id="VkVideoSessionCreateFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoSessionCreateFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_encode_queue</span>
    <span class="n">VK_VIDEO_SESSION_CREATE_ALLOW_ENCODE_PARAMETER_OPTIMIZATIONS_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_maintenance1</span>
    <span class="n">VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoSessionCreateFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code> specifies that
the video session uses protected video content.</p>
</li>
<li>
<p><a id="encode-optimizing-overrides"></a>
<code>VK_VIDEO_SESSION_CREATE_ALLOW_ENCODE_PARAMETER_OPTIMIZATIONS_BIT_KHR</code>
specifies that the implementation is allowed to
<a href="chap36.html#encode-overrides">override</a> video session parameters and other
codec-specific encoding parameters to optimize video encode operations
based on the use case information specified in the
<a href="chap36.html#video-profiles">video profile</a> and the used
<a href="chap36.html#encode-quality-level">video encode quality level</a>.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Not specifying
<code>VK_VIDEO_SESSION_CREATE_ALLOW_ENCODE_PARAMETER_OPTIMIZATIONS_BIT_KHR</code>
does not guarantee that the implementation will not do any codec-specific
parameter overrides, as certain overrides are necessary for the correct
operation of the video encoder implementation due to limitations to the
available encoding tools on that implementation.
This flag, however, enables the implementation to apply further optimizing
overrides.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code> specifies that
queries within video coding scopes using the created video session are
<a href="chap36.html#video-inline-queries">executed inline</a> with video coding operations.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoSessionCreateFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoSessionCreateFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoSessionCreateFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoSessionCreateFlagBitsKHR">VkVideoSessionCreateFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="video-session-destruction"><a class="anchor" href="chap36.html#video-session-destruction"></a>36.5.2. Destroying a Video Session</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a video session, call:</p>
</div>
<div id="vkDestroyVideoSessionKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="kt">void</span> <span class="nf">vkDestroyVideoSessionKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkVideoSessionKHR</span>                           <span class="n">videoSession</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07192" href="chap36.html#VUID-vkDestroyVideoSessionKHR-videoSession-07192"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07192</span><br>

All submitted commands that refer to <code>videoSession</code> <strong class="purple">must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07193" href="chap36.html#VUID-vkDestroyVideoSessionKHR-videoSession-07193"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07193</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>videoSession</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-07194" href="chap36.html#VUID-vkDestroyVideoSessionKHR-videoSession-07194"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-07194</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>videoSession</code>
was created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-device-parameter" href="chap36.html#VUID-vkDestroyVideoSessionKHR-device-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-parameter" href="chap36.html#VUID-vkDestroyVideoSessionKHR-videoSession-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-parameter</span><br>
 If <code>videoSession</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>videoSession</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-pAllocator-parameter" href="chap36.html#VUID-vkDestroyVideoSessionKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionKHR-videoSession-parent" href="chap36.html#VUID-vkDestroyVideoSessionKHR-videoSession-parent"></a> <span class="vuid">VUID-vkDestroyVideoSessionKHR-videoSession-parent</span><br>
 If <code>videoSession</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>videoSession</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="video-session-memory-association"><a class="anchor" href="chap36.html#video-session-memory-association"></a>36.5.3. Video Session Memory Association</h4>
<div class="paragraph">
<p>After creating a video session object, and before the object <strong class="purple">can</strong> be used to
record video coding operations into command buffers using it, the
application <strong class="purple">must</strong> allocate and bind device memory to the video session.
Device memory is allocated separately (see <a href="chap11.html#memory-device">Device Memory</a>) and then
associated with the video session.</p>
</div>
<div class="paragraph">
<p>Video sessions <strong class="purple">may</strong> have multiple memory bindings identified by unique
unsigned integer values.
Appropriate device memory <strong class="purple">must</strong> be bound to each such memory binding before
using the video session to record command buffer commands with it.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the memory requirements for a video session object, call:</p>
</div>
<div id="vkGetVideoSessionMemoryRequirementsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkGetVideoSessionMemoryRequirementsKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkVideoSessionKHR</span>                           <span class="n">videoSession</span><span class="p">,</span>
    <span class="kt">uint32_t</span><span class="o">*</span>                                   <span class="n">pMemoryRequirementsCount</span><span class="p">,</span>
    <span class="n">VkVideoSessionMemoryRequirementsKHR</span><span class="o">*</span>        <span class="n">pMemoryRequirements</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to query.</p>
</li>
<li>
<p><code>pMemoryRequirementsCount</code> is a pointer to an integer related to the
number of memory binding requirements available or queried, as described
below.</p>
</li>
<li>
<p><code>pMemoryRequirements</code> is <code>NULL</code> or a pointer to an array of
<a href="chap36.html#VkVideoSessionMemoryRequirementsKHR">VkVideoSessionMemoryRequirementsKHR</a> structures in which the memory
binding requirements of the video session are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pMemoryRequirements</code> is <code>NULL</code>, then the number of memory bindings
required for the video session is returned in
<code>pMemoryRequirementsCount</code>.
Otherwise, <code>pMemoryRequirementsCount</code> <strong class="purple">must</strong> point to a variable set by
the user with the number of elements in the <code>pMemoryRequirements</code> array,
and on return the variable is overwritten with the number of memory binding
requirements actually written to <code>pMemoryRequirements</code>.
If <code>pMemoryRequirementsCount</code> is less than the number of memory bindings
required for the video session, then at most <code>pMemoryRequirementsCount</code>
elements will be written to <code>pMemoryRequirements</code>, and
<code>VK_INCOMPLETE</code> will be returned, instead of <code>VK_SUCCESS</code>, to
indicate that not all required memory binding requirements were returned.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-device-parameter" href="chap36.html#VUID-vkGetVideoSessionMemoryRequirementsKHR-device-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parameter" href="chap36.html#VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirementsCount-parameter" href="chap36.html#VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirementsCount-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirementsCount-parameter</span><br>
 <code>pMemoryRequirementsCount</code> <strong class="purple">must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirements-parameter" href="chap36.html#VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirements-parameter"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-pMemoryRequirements-parameter</span><br>
 If the value referenced by <code>pMemoryRequirementsCount</code> is not <code>0</code>, and <code>pMemoryRequirements</code> is not <code>NULL</code>, <code>pMemoryRequirements</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pMemoryRequirementsCount</code> <a href="chap36.html#VkVideoSessionMemoryRequirementsKHR">VkVideoSessionMemoryRequirementsKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parent" href="chap36.html#VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parent"></a> <span class="vuid">VUID-vkGetVideoSessionMemoryRequirementsKHR-videoSession-parent</span><br>
 <code>videoSession</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<p>None</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionMemoryRequirementsKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoSessionMemoryRequirementsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoSessionMemoryRequirementsKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>         <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                   <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                <span class="n">memoryBindIndex</span><span class="p">;</span>
    <span class="n">VkMemoryRequirements</span>    <span class="n">memoryRequirements</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoSessionMemoryRequirementsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>memoryBindIndex</code> is the index of the memory binding.</p>
</li>
<li>
<p><code>memoryRequirements</code> is a <a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure in
which the requested memory binding requirements for the binding index
specified by <code>memoryBindIndex</code> are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionMemoryRequirementsKHR-sType-sType" href="chap36.html#VUID-VkVideoSessionMemoryRequirementsKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionMemoryRequirementsKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_MEMORY_REQUIREMENTS_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionMemoryRequirementsKHR-pNext-pNext" href="chap36.html#VUID-VkVideoSessionMemoryRequirementsKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionMemoryRequirementsKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To attach memory to a video session object, call:</p>
</div>
<div id="vkBindVideoSessionMemoryKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkBindVideoSessionMemoryKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkVideoSessionKHR</span>                           <span class="n">videoSession</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">bindSessionMemoryInfoCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkBindVideoSessionMemoryInfoKHR</span><span class="o">*</span>      <span class="n">pBindSessionMemoryInfos</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session.</p>
</li>
<li>
<p><code>videoSession</code> is the video session to be bound with device memory.</p>
</li>
<li>
<p><code>bindSessionMemoryInfoCount</code> is the number of elements in
<code>pBindSessionMemoryInfos</code>.</p>
</li>
<li>
<p><code>pBindSessionMemoryInfos</code> is a pointer to an array of
<code>bindSessionMemoryInfoCount</code> <a href="chap36.html#VkBindVideoSessionMemoryInfoKHR">VkBindVideoSessionMemoryInfoKHR</a>
structures specifying memory regions to be bound to specific memory
bindings of the video session.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The valid usage statements below refer to the <a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a>
structure corresponding to a specific element of
<code>pBindSessionMemoryInfos</code>, which is defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>memoryBindIndex</code> member of the element of
<code>pBindSessionMemoryInfos</code> in question matches the
<code>memoryBindIndex</code> member of one of the elements returned in
<code>pMemoryRequirements</code> when
<a href="chap36.html#vkGetVideoSessionMemoryRequirementsKHR">vkGetVideoSessionMemoryRequirementsKHR</a> is called with the same
<code>videoSession</code> and with <code>pMemoryRequirementsCount</code> equal to
<code>bindSessionMemoryInfoCount</code>, then the <code>memoryRequirements</code>
member of that element of <code>pMemoryRequirements</code> is the
<a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure corresponding to the element of
<code>pBindSessionMemoryInfos</code> in question.</p>
</li>
<li>
<p>Otherwise the element of <code>pBindSessionMemoryInfos</code> in question is
said to not have a corresponding <a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-07195" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-videoSession-07195"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-07195</span><br>

The memory binding of <code>videoSession</code> identified by the
<code>memoryBindIndex</code> member of any element of
<code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> not already be backed by a memory
object</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-memoryBindIndex-07196</span><br>

The <code>memoryBindIndex</code> member of each element of
<code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> be unique within
<code>pBindSessionMemoryInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07197</span><br>

Each element of <code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> have a corresponding
<a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07198</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure, then the <code>memory</code> member of
that element of <code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> have been allocated
using one of the memory types allowed in the <code>memoryTypeBits</code> member
of the corresponding <a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07199</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure, then the <code>memoryOffset</code> member
of that element of <code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> be an integer
multiple of the <code>alignment</code> member of the corresponding
<a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-07200</span><br>

If an element of <code>pBindSessionMemoryInfos</code> has a corresponding
<a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a> structure, then the <code>memorySize</code> member
of that element of <code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> equal the
<code>size</code> member of the corresponding <a href="chap12.html#VkMemoryRequirements">VkMemoryRequirements</a>
structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-device-parameter" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-device-parameter"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-parameter" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-videoSession-parameter"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-parameter" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-parameter"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-pBindSessionMemoryInfos-parameter</span><br>
 <code>pBindSessionMemoryInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>bindSessionMemoryInfoCount</code> valid <a href="chap36.html#VkBindVideoSessionMemoryInfoKHR">VkBindVideoSessionMemoryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-bindSessionMemoryInfoCount-arraylength" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-bindSessionMemoryInfoCount-arraylength"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-bindSessionMemoryInfoCount-arraylength</span><br>
 <code>bindSessionMemoryInfoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkBindVideoSessionMemoryKHR-videoSession-parent" href="chap36.html#VUID-vkBindVideoSessionMemoryKHR-videoSession-parent"></a> <span class="vuid">VUID-vkBindVideoSessionMemoryKHR-videoSession-parent</span><br>
 <code>videoSession</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>videoSession</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBindVideoSessionMemoryInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkBindVideoSessionMemoryInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkBindVideoSessionMemoryInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">memoryBindIndex</span><span class="p">;</span>
    <span class="n">VkDeviceMemory</span>     <span class="n">memory</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>       <span class="n">memoryOffset</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>       <span class="n">memorySize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkBindVideoSessionMemoryInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>memoryBindIndex</code> is the memory binding index to bind memory to.</p>
</li>
<li>
<p><code>memory</code> is the allocated device memory to be bound to the video
session’s memory binding with index <code>memoryBindIndex</code>.</p>
</li>
<li>
<p><code>memoryOffset</code> is the start offset of the region of <code>memory</code>
which is to be bound.</p>
</li>
<li>
<p><code>memorySize</code> is the size in bytes of the region of <code>memory</code>,
starting from <code>memoryOffset</code> bytes, to be bound.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201" href="chap36.html#VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memoryOffset-07201</span><br>

<code>memoryOffset</code> <strong class="purple">must</strong> be less than the size of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202" href="chap36.html#VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memorySize-07202</span><br>

<code>memorySize</code> <strong class="purple">must</strong> be less than or equal to the size of <code>memory</code>
minus <code>memoryOffset</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-sType-sType" href="chap36.html#VUID-VkBindVideoSessionMemoryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_BIND_VIDEO_SESSION_MEMORY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-pNext-pNext" href="chap36.html#VUID-VkBindVideoSessionMemoryInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkBindVideoSessionMemoryInfoKHR-memory-parameter" href="chap36.html#VUID-VkBindVideoSessionMemoryInfoKHR-memory-parameter"></a> <span class="vuid">VUID-VkBindVideoSessionMemoryInfoKHR-memory-parameter</span><br>
 <code>memory</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkDeviceMemory">VkDeviceMemory</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-profile-compatibility"><a class="anchor" href="chap36.html#video-profile-compatibility"></a>36.6. Video Profile Compatibility</h3>
<div class="paragraph">
<p>Resources and query pools used with a particular video session <strong class="purple">must</strong> be
compatible with the <a href="chap36.html#video-profiles">video profile</a> the video session was
created with.</p>
</div>
<div class="paragraph">
<p>A <a href="chap12.html#VkBuffer">VkBuffer</a> is compatible with a video profile if it was created with
the <a href="chap12.html#VkBufferCreateInfo">VkBufferCreateInfo</a>::<code>pNext</code> chain including a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with its <code>pProfiles</code> member
containing an element matching the <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure
chain describing the video profile, and
<a href="chap12.html#VkBufferCreateInfo">VkBufferCreateInfo</a>::<code>usage</code> including at least one bit specific to
video coding usage.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_BUFFER_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <a href="chap12.html#VkBuffer">VkBuffer</a> is also compatible with a video profile if it was created
with <a href="chap12.html#VkBufferCreateInfo">VkBufferCreateInfo</a>::<code>flags</code> including
<code>VK_BUFFER_CREATE_VIDEO_PROFILE_INDEPENDENT_BIT_KHR</code>.</p>
</div>
<div class="paragraph">
<p>A <a href="chap12.html#VkImage">VkImage</a> is compatible with a video profile if it was created with
the <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>pNext</code> chain including a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with its <code>pProfiles</code> member
containing an element matching the <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure
chain describing the video profile, and <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>usage</code>
including at least one bit specific to video coding usage.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <a href="chap12.html#VkImage">VkImage</a> is also compatible with a video profile if all of the
following conditions are true for the <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a> structure the
image was created with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code> included
<code>VK_IMAGE_CREATE_VIDEO_PROFILE_INDEPENDENT_BIT_KHR</code>.</p>
</li>
<li>
<p>The list of <a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a> structures, obtained by
calling <a href="chap36.html#vkGetPhysicalDeviceVideoFormatPropertiesKHR">vkGetPhysicalDeviceVideoFormatPropertiesKHR</a> with
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>imageUsage</code> equal to the
<a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>usage</code> the image was created with and the
<a href="chap36.html#VkPhysicalDeviceVideoFormatInfoKHR">VkPhysicalDeviceVideoFormatInfoKHR</a>::<code>pNext</code> chain including a
<a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure with its <code>pProfiles</code>
member containing a single array element specifying the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure chain describing the video profile
in question, contains an element for which all of the following
conditions are true with respect to the <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>
structure the image was created with:</p>
<div class="ulist">
<ul>
<li>
<p><a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>format</code> equals
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>format</code>.</p>
</li>
<li>
<p><a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code> only contains bits also set in
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>imageCreateFlags</code>.</p>
</li>
<li>
<p><a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>imageType</code> equals
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>imageType</code>.</p>
</li>
<li>
<p><a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>tiling</code> equals
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>imageTiling</code>.</p>
</li>
<li>
<p><a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>usage</code> only contains bits also set in
<a href="chap36.html#VkVideoFormatPropertiesKHR">VkVideoFormatPropertiesKHR</a>::<code>imageUsageFlags</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>While some of these rules allow creating buffer or image resources that <strong class="purple">may</strong>
be compatible with any video profile, applications <strong class="purple">should</strong> still prefer to
include the specific video profiles the buffer or image resource is expected
to be used with (through a <a href="chap36.html#VkVideoProfileListInfoKHR">VkVideoProfileListInfoKHR</a> structure
included in the <code>pNext</code> chain of the corresponding create info
structure) whenever the information about the complete set of video profiles
is available at resource creation time, to enable the implementation to
optimize the created resource for the specific use case.
In the absence of that information, the implementation <strong class="purple">may</strong> have to make
conservative decisions about the memory requirements or representation of
the resource.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>A <a href="chap12.html#VkImageView">VkImageView</a> is compatible with a video profile if the <a href="chap12.html#VkImage">VkImage</a>
it was created from is also compatible with that video profile.</p>
</div>
<div class="paragraph">
<p>A <a href="chap17.html#VkQueryPool">VkQueryPool</a> is compatible with a video profile if it was created
with the <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>pNext</code> chain including a
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure chain describing the same video
profile, and <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>queryType</code> having one of the
following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code></p>
</li>
<li>
<p><code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="video-session-parameters"><a class="anchor" href="chap36.html#video-session-parameters"></a>36.7. Video Session Parameters</h3>
<div class="paragraph">
<p>Video session parameters objects <strong class="purple">can</strong> store preprocessed codec-specific
parameters used with a compatible video session, and enable reducing the
number of parameters needed to be provided and processed by the
implementation while recording video coding operations into command buffers.</p>
</div>
<div class="paragraph">
<p>Parameters stored in such objects are <em>immutable</em> to facilitate the
concurrent use of the stored parameters in multiple threads.
At the same time, new parameters <strong class="purple">can</strong> be added to existing objects using the
<a href="chap36.html#vkUpdateVideoSessionParametersKHR">vkUpdateVideoSessionParametersKHR</a> command.</p>
</div>
<div class="paragraph">
<p>In order to support concurrent use of the stored immutable parameters while
also allowing the video session parameters object to be extended with new
parameters, each video session parameters object maintains an <em>update
sequence counter</em> that is set to <code>0</code> at object creation time and <strong class="purple">must</strong> be
incremented by each subsequent update operation.</p>
</div>
<div class="paragraph">
<p>Certain video sequences that adhere to particular video compression
standards permit updating previously supplied parameters.
If a parameter update is necessary, the application has the following
options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cache the set of parameters on the application side and create a new
video session parameters object adding all the parameters with
appropriate changes, as necessary; or</p>
</li>
<li>
<p>Create a new video session parameters object providing only the updated
parameters and the previously used object as the template, which ensures
that parameters not specified at creation time will be copied unmodified
from the template object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The actual types of parameters that <strong class="purple">can</strong> be stored and the capacity for
individual parameter types, and the methods of initializing, updating, and
referring to individual parameters are specific to the video codec operation
the video session parameters object was created with.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> these are defined
in the <a href="chap36.html#decode-h264-parameter-sets">H.264 Decode Parameter Sets</a>
section.</p>
</li>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> these are defined
in the <a href="chap36.html#decode-h265-parameter-sets">H.265 Decode Parameter Sets</a>
section.</p>
</li>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code> these are defined
in the <a href="chap36.html#decode-av1-parameter-sets">AV1 Decode Parameter Sets</a> section.</p>
</li>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> these are defined
in the <a href="chap36.html#encode-h264-parameter-sets">H.264 Encode Parameter Sets</a>
section.</p>
</li>
<li>
<p>For <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> these are defined
in the <a href="chap36.html#encode-h265-parameter-sets">H.265 Encode Parameter Sets</a>
section.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Video session parameters objects created with an encode operation are
further specialized based on the <a href="chap36.html#encode-quality-level">video encode quality
level</a> the video session parameters are used with, as implementations <strong class="purple">may</strong>
apply different sets of <a href="chap36.html#encode-overrides">parameter overrides</a> depending
on the used quality level.
This enables implementations to store the potentially optimized set of
parameters in these objects, further limiting the necessary processing
required while recording video encode operations into command buffers.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Video session parameters are represented by
<code>VkVideoSessionParametersKHR</code> handles:</p>
</div>
<div id="VkVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VK_DEFINE_NON_DISPATCHABLE_HANDLE</span><span class="p">(</span><span class="n">VkVideoSessionParametersKHR</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creating-video-session-parameters"><a class="anchor" href="chap36.html#creating-video-session-parameters"></a>36.7.1. Creating Video Session Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a video session parameters object, call:</p>
</div>
<div id="vkCreateVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkCreateVideoSessionParametersKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoSessionParametersCreateInfoKHR</span><span class="o">*</span> <span class="n">pCreateInfo</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">,</span>
    <span class="n">VkVideoSessionParametersKHR</span><span class="o">*</span>                <span class="n">pVideoSessionParameters</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the video session
parameters object.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> structure containing
parameters to be used to create the video session parameters object.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pVideoSessionParameters</code> is a pointer to a
<a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle in which the resulting video
session parameters object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting video session parameters object is said to be created with the
video codec operation <code>pCreateInfo-&gt;videoSession</code> was created with.</p>
</div>
<div class="paragraph">
<p>Video session parameters objects created with an encode operation are always
created with respect to a <a href="chap36.html#encode-quality-level">video encode quality
level</a>.
By default, the created video session parameters objects are created with
quality level zero, unless otherwise specified by including a
<a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a> structure in the
<code>pCreateInfo-&gt;pNext</code> chain, in which case the video session parameters
object is created with the quality level specified in
<a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>::<code>qualityLevel</code>.</p>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then it will be used as a template for constructing
the new video session parameters object.
This happens by first adding any parameters according to the additional
creation parameters provided in the <code>pCreateInfo-&gt;pNext</code> chain, followed
by adding any parameters from the template object that have a key that does
not match the key of any of the already added parameters.</p>
</div>
<div class="paragraph">
<p>For video session parameters objects created with an encode operation, the
template object specified in
<code>pCreateInfo-&gt;videoSessionParametersTemplate</code> <strong class="purple">must</strong> have been created
with the same <a href="chap36.html#encode-quality-level">video encode quality level</a> as the
newly created object.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that codec-specific parameters stored in video session parameters
objects <strong class="purple">can</strong> only be reused across different video encode quality levels by
re-specifying them, as previously created video session parameters against
other quality levels <strong class="purple">cannot</strong> be used as template because the original
codec-specific parameters (before the implementation <strong class="purple">may</strong> have applied
<a href="chap36.html#encode-overrides">parameter overrides</a>) <strong class="purple">may</strong> no longer be available in
them for the purposes of constructing the derived object.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
created video session parameters object will initially contain the following
sets of parameter entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH264SequenceParameterSet</code> structures representing
<a href="chap36.html#decode-h264-sps">H.264 SPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH264SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH264SequenceParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>seq_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH264PictureParameterSet</code> structures representing
<a href="chap36.html#decode-h264-pps">H.264 PPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH264PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH264PictureParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
created video session parameters object will initially contain the following
sets of parameter entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH265VideoParameterSet</code> structures representing
<a href="chap36.html#decode-h265-vps">H.265 VPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265VideoParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdVPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265VideoParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>vps_video_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH265SequenceParameterSet</code> structures representing
<a href="chap36.html#decode-h265-sps">H.265 SPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265SequenceParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH265PictureParameterSet</code> structures representing
<a href="chap36.html#decode-h265-pps">H.265 PPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265PictureParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the
created video session parameters object will contain a single
<a href="chap36.html#decode-av1-sequence-header">AV1 sequence header</a> represented by a
<code>StdVideoAV1SequenceHeader</code> structure specified through the
<code>pStdSequenceHeader</code> member of the
<a href="chap36.html#VkVideoDecodeAV1SessionParametersCreateInfoKHR">VkVideoDecodeAV1SessionParametersCreateInfoKHR</a> structure provided in
the <code>pCreateInfo-&gt;pNext</code> chain.
As such video session parameters objects <strong class="purple">can</strong> only contain a single
<a href="chap36.html#decode-av1-sequence-header">AV1 sequence header</a>, it is not possible to
use a previously created object as a template or subsequently update the
created video session parameters object.</p>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the
created video session parameters object will initially contain the following
sets of parameter entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH264SequenceParameterSet</code> structures representing
<a href="chap36.html#encode-h264-sps">H.264 SPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH264SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH264SequenceParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>seq_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH264PictureParameterSet</code> structures representing
<a href="chap36.html#encode-h264-pps">H.264 PPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH264PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH264PictureParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pCreateInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the
created video session parameters object will initially contain the following
sets of parameter entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH265VideoParameterSet</code> structures representing
<a href="chap36.html#encode-h265-vps">H.265 VPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265VideoParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdVPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265VideoParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>vps_video_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH265SequenceParameterSet</code> structures representing
<a href="chap36.html#encode-h265-sps">H.265 SPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265SequenceParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>StdVideoH265PictureParameterSet</code> structures representing
<a href="chap36.html#encode-h265-pps">H.265 PPS</a> entries, as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pCreateInfo-&gt;pNext</code> chain is not <code>NULL</code>, then the
set of <code>StdVideoH265PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added first;</p>
</li>
<li>
<p>If <code>pCreateInfo-&gt;videoSessionParametersTemplate</code> is not
<code>VK_NULL_HANDLE</code>, then each <code>StdVideoH265PictureParameterSet</code>
entry stored in it is copied to the created video session parameters
object if the created object does not already contain such an entry
with the same <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of video session parameters objects created with a video encode
operation, implementations <strong class="purple">may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-device-parameter" href="chap36.html#VUID-vkCreateVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-pCreateInfo-parameter" href="chap36.html#VUID-vkCreateVideoSessionParametersKHR-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-pAllocator-parameter" href="chap36.html#VUID-vkCreateVideoSessionParametersKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateVideoSessionParametersKHR-pVideoSessionParameters-parameter" href="chap36.html#VUID-vkCreateVideoSessionParametersKHR-pVideoSessionParameters-parameter"></a> <span class="vuid">VUID-vkCreateVideoSessionParametersKHR-pVideoSessionParameters-parameter</span><br>
 <code>pVideoSessionParameters</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INITIALIZATION_FAILED</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionParametersCreateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoSessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoSessionParametersCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoSessionParametersCreateFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkVideoSessionParametersKHR</span>               <span class="n">videoSessionParametersTemplate</span><span class="p">;</span>
    <span class="n">VkVideoSessionKHR</span>                         <span class="n">videoSession</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoSessionParametersCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>videoSessionParametersTemplate</code> is <code>VK_NULL_HANDLE</code> or a valid
handle to a <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object used as a template
for constructing the new video session parameters object.</p>
</li>
<li>
<p><code>videoSession</code> is the video session object against which the video
session parameters object is going to be created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Limiting values are defined below that are referenced by the relevant valid
usage statements of this structure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then let
<code>StdVideoH264SequenceParameterSet spsAddList[]</code> be the list of
<a href="chap36.html#decode-h264-sps">H.264 SPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH264SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added to <code>spsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH264SequenceParameterSet</code> entry stored in it with
<code>seq_parameter_set_id</code> not matching any of the entries already in
<code>spsAddList</code> is added to <code>spsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then let
<code>StdVideoH264PictureParameterSet ppsAddList[]</code> be the list of
<a href="chap36.html#decode-h264-pps">H.264 PPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH264PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added to <code>ppsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH264PictureParameterSet</code> entry stored in it with
<code>seq_parameter_set_id</code> or <code>pic_parameter_set_id</code> not matching
any of the entries already in <code>ppsAddList</code> is added to
<code>ppsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265VideoParameterSet vpsAddList[]</code> be the list of
<a href="chap36.html#decode-h265-vps">H.265 VPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265VideoParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdVPSs</code> are added to <code>vpsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265VideoParameterSet</code> entry stored in it with
<code>vps_video_parameter_set_id</code> not matching any of the entries
already in <code>vpsAddList</code> is added to <code>vpsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265SequenceParameterSet spsAddList[]</code> be the list of
<a href="chap36.html#decode-h265-sps">H.265 SPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added to <code>spsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265SequenceParameterSet</code> entry stored in it with
<code>sps_video_parameter_set_id</code> or <code>sps_seq_parameter_set_id</code> not
matching any of the entries already in <code>spsAddList</code> is added to
<code>spsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265PictureParameterSet ppsAddList[]</code> be the list of
<a href="chap36.html#decode-h265-pps">H.265 PPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added to <code>ppsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265PictureParameterSet</code> entry stored in it with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, or
<code>pps_pic_parameter_set_id</code> not matching any of the entries already
in <code>ppsAddList</code> is added to <code>ppsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with an encode operation, then let
<code>uint32_t qualityLevel</code> be the <a href="chap36.html#encode-quality-level">video encode
quality level</a> of the created video session parameters object, defined
as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pNext</code> chain of this structure includes a
<a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a> structure, then
<code>qualityLevel</code> is equal to
<a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>::<code>qualityLevel</code>.</p>
</li>
<li>
<p>Otherwise <code>qualityLevel</code> is <code>0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then let
<code>StdVideoH264SequenceParameterSet spsAddList[]</code> be the list of
<a href="chap36.html#encode-h264-sps">H.264 SPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH264SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added to <code>spsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH264SequenceParameterSet</code> entry stored in it with
<code>seq_parameter_set_id</code> not matching any of the entries already in
<code>spsAddList</code> is added to <code>spsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then let
<code>StdVideoH264PictureParameterSet ppsAddList[]</code> be the list of
<a href="chap36.html#encode-h264-pps">H.264 PPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH264PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added to <code>ppsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH264PictureParameterSet</code> entry stored in it with
<code>seq_parameter_set_id</code> or <code>pic_parameter_set_id</code> not matching
any of the entries already in <code>ppsAddList</code> is added to
<code>ppsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265VideoParameterSet vpsAddList[]</code> be the list of
<a href="chap36.html#encode-h265-vps">H.265 VPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265VideoParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdVPSs</code> are added to <code>vpsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265VideoParameterSet</code> entry stored in it with
<code>vps_video_parameter_set_id</code> not matching any of the entries
already in <code>vpsAddList</code> is added to <code>vpsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265SequenceParameterSet spsAddList[]</code> be the list of
<a href="chap36.html#encode-h265-sps">H.265 SPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265SequenceParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdSPSs</code> are added to <code>spsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265SequenceParameterSet</code> entry stored in it with
<code>sps_video_parameter_set_id</code> or <code>sps_seq_parameter_set_id</code> not
matching any of the entries already in <code>spsAddList</code> is added to
<code>spsAddList</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>videoSession</code> was created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then let
<code>StdVideoH265PictureParameterSet ppsAddList[]</code> be the list of
<a href="chap36.html#encode-h265-pps">H.265 PPS</a> entries to add to the created video
session parameters object, defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
provided in the <code>pNext</code> chain is not <code>NULL</code>, then the set of
<code>StdVideoH265PictureParameterSet</code> entries specified in
<code>pParametersAddInfo-&gt;pStdPPSs</code> are added to <code>ppsAddList</code>;</p>
</li>
<li>
<p>If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>,
then each <code>StdVideoH265PictureParameterSet</code> entry stored in it with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, or
<code>pps_pic_parameter_set_id</code> not matching any of the entries already
in <code>ppsAddList</code> is added to <code>ppsAddList</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-04855</span><br>

If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code>, it
<strong class="purple">must</strong> have been created against <code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-08310" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-08310"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-08310</span><br>

If <code>videoSessionParametersTemplate</code> is not <code>VK_NULL_HANDLE</code> and
<code>videoSession</code> was created with an encode operation, then
<code>qualityLevel</code> <strong class="purple">must</strong> equal the <a href="chap36.html#encode-quality-level">video encode
quality</a> level <code>videoSessionParametersTemplate</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07203" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07203"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07203</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07204" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07204"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07204</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the number of
elements of <code>spsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdSPSCount</code> specified in the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07205" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07205"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07205</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the number of
elements of <code>ppsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdPPSCount</code> specified in the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07206" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07206"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07206</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07207" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07207"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07207</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the number of
elements of <code>vpsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdVPSCount</code> specified in the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07208" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07208"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07208</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the number of
elements of <code>spsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdSPSCount</code> specified in the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07209" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07209"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07209</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the number of
elements of <code>ppsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdPPSCount</code> specified in the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-09258" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-09258"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-09258</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then
<code>videoSessionParametersTemplate</code> <strong class="purple">must</strong> be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-09259" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-09259"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-09259</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeAV1SessionParametersCreateInfoKHR">VkVideoDecodeAV1SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07210" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07210"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07210</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04839" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04839"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04839</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the number of
elements of <code>spsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdSPSCount</code> specified in the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04840" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04840"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04840</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the number of
elements of <code>ppsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdPPSCount</code> specified in the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07211" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07211"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-07211</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04841" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04841"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04841</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the number of
elements of <code>vpsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdVPSCount</code> specified in the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04842" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04842"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04842</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the number of
elements of <code>spsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdSPSCount</code> specified in the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04843" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04843"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-04843</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the number of
elements of <code>ppsAddList</code> <strong class="purple">must</strong> be less than or equal to the
<code>maxStdPPSCount</code> specified in the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure included
in the <code>pNext</code> chain</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-08319" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-08319"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-08319</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then
<code>num_tile_columns_minus1</code> <strong class="purple">must</strong> be less than
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxTiles.width</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile <code>videoSession</code> was created with, for each element of
<code>ppsAddList</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-08320" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-08320"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-08320</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then
<code>num_tile_rows_minus1</code> <strong class="purple">must</strong> be less than
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxTiles.height</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile <code>videoSession</code> was created with, for each element of
<code>ppsAddList</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoDecodeAV1SessionParametersCreateInfoKHR">VkVideoDecodeAV1SessionParametersCreateInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a>, or <a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-flags-zerobitmask" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parameter" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parameter"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parameter</span><br>
 If <code>videoSessionParametersTemplate</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>videoSessionParametersTemplate</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-parameter" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-parameter"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parent" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parent"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-videoSessionParametersTemplate-parent</span><br>
 If <code>videoSessionParametersTemplate</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersCreateInfoKHR-commonparent" href="chap36.html#VUID-VkVideoSessionParametersCreateInfoKHR-commonparent"></a> <span class="vuid">VUID-VkVideoSessionParametersCreateInfoKHR-commonparent</span><br>
 Both of <code>videoSession</code>, and <code>videoSessionParametersTemplate</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoSessionParametersCreateFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoSessionParametersCreateFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoSessionParametersCreateFlagsKHR</code> is a bitmask type for setting a
mask, but is currently reserved for future use.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="destroying-video-session-parameters"><a class="anchor" href="chap36.html#destroying-video-session-parameters"></a>36.7.2. Destroying Video Session Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a video session parameters object, call:</p>
</div>
<div id="vkDestroyVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="kt">void</span> <span class="nf">vkDestroyVideoSessionParametersKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkVideoSessionParametersKHR</span>                 <span class="n">videoSessionParameters</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the video session
parameters object.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the video session parameters object to
destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07212</span><br>

All submitted commands that refer to <code>videoSessionParameters</code> <strong class="purple">must</strong>
have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07213</span><br>

If <code>VkAllocationCallbacks</code> were provided when
<code>videoSessionParameters</code> was created, a compatible set of callbacks
<strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-07214</span><br>

If no <code>VkAllocationCallbacks</code> were provided when
<code>videoSessionParameters</code> was created, <code>pAllocator</code> <strong class="purple">must</strong> be
<code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-device-parameter" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parameter" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parameter</span><br>
 If <code>videoSessionParameters</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>videoSessionParameters</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-pAllocator-parameter" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parent" href="chap36.html#VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parent"></a> <span class="vuid">VUID-vkDestroyVideoSessionParametersKHR-videoSessionParameters-parent</span><br>
 If <code>videoSessionParameters</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>videoSessionParameters</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="video-session-parameters-update"><a class="anchor" href="chap36.html#video-session-parameters-update"></a>36.7.3. Updating Video Session Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To update video session parameters object with new parameters, call:</p>
</div>
<div id="vkUpdateVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="n">VkResult</span> <span class="nf">vkUpdateVideoSessionParametersKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkVideoSessionParametersKHR</span>                 <span class="n">videoSessionParameters</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoSessionParametersUpdateInfoKHR</span><span class="o">*</span> <span class="n">pUpdateInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that updates the video session
parameters.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the video session parameters object to
update.</p>
</li>
<li>
<p><code>pUpdateInfo</code> is a pointer to a
<a href="chap36.html#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a> structure specifying the
parameter update information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After a successful call to this command, the
<a href="chap36.html#video-session-parameters">update sequence counter</a> of
<code>videoSessionParameters</code> is changed to the value specified in
<code>pUpdateInfo-&gt;updateSequenceCount</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As each update issued to a video session parameters object needs to specify
the next available update sequence count value, concurrent updates of the
same video session parameters object are inherently disallowed.
However, recording video coding operations to command buffers referring to
parameters previously added to the video session parameters object is
allowed, even if there is a concurrent update in progress adding some new
entries to the object.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If <code>videoSessionParameters</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pUpdateInfo-&gt;pNext</code> chain includes a
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure, then this
command adds the following parameter entries to
<code>videoSessionParameters</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="chap36.html#decode-h264-sps">H.264 SPS</a> entries specified in
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#decode-h264-pps">H.264 PPS</a> entries specified in
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>videoSessionParameters</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pUpdateInfo-&gt;pNext</code> chain includes a
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then this
command adds the following parameter entries to
<code>videoSessionParameters</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="chap36.html#decode-h265-vps">H.265 VPS</a> entries specified in
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdVPSs</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#decode-h265-sps">H.265 SPS</a> entries specified in
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#decode-h265-pps">H.265 PPS</a> entries specified in
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>videoSessionParameters</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and the
<code>pUpdateInfo-&gt;pNext</code> chain includes a
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure, then this
command adds the following parameter entries to
<code>videoSessionParameters</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="chap36.html#encode-h264-sps">H.264 SPS</a> entries specified in
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#encode-h264-pps">H.264 PPS</a> entries specified in
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>videoSessionParameters</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the
<code>pUpdateInfo-&gt;pNext</code> chain includes a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure, then this
command adds the following parameter entries to
<code>videoSessionParameters</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="chap36.html#encode-h265-vps">H.265 VPS</a> entries specified in
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdVPSs</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#encode-h265-sps">H.265 SPS</a> entries specified in
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#encode-h265-pps">H.265 PPS</a> entries specified in
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of video session parameters objects created with a video encode
operation, implementations <strong class="purple">may</strong> return the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error if any of the
specified Video Std parameters do not adhere to the syntactic or semantic
requirements of the used video compression standard, or if values derived
from parameters according to the rules defined by the used video compression
standard do not adhere to the capabilities of the video compression standard
or the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">should</strong> not rely on the
<code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code> error being returned by any
command as a means to verify Video Std parameters, as implementations are
not required to report the error in any specific set of cases.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-07215</span><br>

<code>pUpdateInfo-&gt;updateSequenceCount</code> <strong class="purple">must</strong> equal the current
<a href="chap36.html#video-session-parameters">update sequence counter</a> of
<code>videoSessionParameters</code> plus one</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07216" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07216"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07216</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching any of the elements of
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07217" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07217"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07217</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
number of <code>StdVideoH264SequenceParameterSet</code> entries already stored
in it plus the value of the <code>stdSPSCount</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a>::<code>maxStdSPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07218" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07218"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07218</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH264PictureParameterSet</code> entry with both
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching any
of the elements of
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07219" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07219"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07219</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
number of <code>StdVideoH264PictureParameterSet</code> entries already stored in
it plus the value of the <code>stdPPSCount</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a>::<code>maxStdPPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07220" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07220"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07220</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching any of the elements of
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07221" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07221"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07221</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265VideoParameterSet</code> entries already stored in
it plus the value of the <code>stdVPSCount</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdVPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07222" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07222"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07222</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH265SequenceParameterSet</code> entry with both
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching any of the elements of
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07223" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07223"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07223</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265SequenceParameterSet</code> entries already stored
in it plus the value of the <code>stdSPSCount</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdSPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07224" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07224"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07224</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> all matching any of the elements of
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07225" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07225"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07225</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265PictureParameterSet</code> entries already stored in
it plus the value of the <code>stdPPSCount</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdPPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-09260" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-09260"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-09260</span><br>

<code>videoSessionParameters</code> <strong class="purple">must</strong> not have been created with the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07226" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07226"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07226</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching any of the elements of
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06441" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06441"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06441</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the
number of <code>StdVideoH264SequenceParameterSet</code> entries already stored
in it plus the value of the <code>stdSPSCount</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a>::<code>maxStdSPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07227" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07227"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07227</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH264PictureParameterSet</code> entry with both
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching any
of the elements of
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06442" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06442"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06442</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the
number of <code>StdVideoH264PictureParameterSet</code> entries already stored in
it plus the value of the <code>stdPPSCount</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a>::<code>maxStdPPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07228" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07228"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07228</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching any of the elements of
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06443" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06443"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06443</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265VideoParameterSet</code> entries already stored in
it plus the value of the <code>stdVPSCount</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdVPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07229" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07229"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07229</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH265SequenceParameterSet</code> entry with both
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching any of the elements of
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06444" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06444"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06444</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265SequenceParameterSet</code> entries already stored
in it plus the value of the <code>stdSPSCount</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdSPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07230" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07230"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-07230</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not already contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> all matching any of the elements of
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06445" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06445"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-06445</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the
number of <code>StdVideoH265PictureParameterSet</code> entries already stored in
it plus the value of the <code>stdPPSCount</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure included in
the <code>pUpdateInfo-&gt;pNext</code> chain <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a>::<code>maxStdPPSCount</code>
<code>videoSessionParameters</code> was created with</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-08321" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-08321"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-08321</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure, then
<code>num_tile_columns_minus1</code> <strong class="purple">must</strong> be less than
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxTiles.width</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile <code>videoSessionParameters</code> was created with, for each element
of <a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-08322" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-08322"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-08322</span><br>

If <code>videoSessionParameters</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the
<code>pNext</code> chain of <code>pUpdateInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure, then
<code>num_tile_rows_minus1</code> <strong class="purple">must</strong> be less than
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxTiles.height</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile <code>videoSessionParameters</code> was created with, for each element
of <a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a>::<code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-device-parameter" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parameter" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parameter</span><br>
 <code>videoSessionParameters</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-parameter" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-parameter"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-pUpdateInfo-parameter</span><br>
 <code>pUpdateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parent" href="chap36.html#VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parent"></a> <span class="vuid">VUID-vkUpdateVideoSessionParametersKHR-videoSessionParameters-parent</span><br>
 <code>videoSessionParameters</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_VIDEO_STD_PARAMETERS_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoSessionParametersUpdateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoSessionParametersUpdateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoSessionParametersUpdateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">updateSequenceCount</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoSessionParametersUpdateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>updateSequenceCount</code> is the new <a href="chap36.html#video-session-parameters">update
sequence count</a> to set for the video session parameters object.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoSessionParametersUpdateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoSessionParametersUpdateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoSessionParametersUpdateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_SESSION_PARAMETERS_UPDATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersUpdateInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoSessionParametersUpdateInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoSessionParametersUpdateInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a>, or <a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoSessionParametersUpdateInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoSessionParametersUpdateInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoSessionParametersUpdateInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-coding-scope"><a class="anchor" href="chap36.html#video-coding-scope"></a>36.8. Video Coding Scope</h3>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> record video coding commands for a video session only
within a video coding scope.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin a video coding scope, call:</p>
</div>
<div id="vkCmdBeginVideoCodingKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="kt">void</span> <span class="nf">vkCmdBeginVideoCodingKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoBeginCodingInfoKHR</span><span class="o">*</span>            <span class="n">pBeginInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pBeginInfo</code> is a pointer to a <a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a>
structure specifying the parameters of the video coding scope, including
the video session and video session parameters object to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After beginning a video coding scope, the video session object specified in
<code>pBeginInfo-&gt;videoSession</code> is <em>bound</em> to the command buffer, and the
command buffer is ready to record video coding operations.
Similarly, if <code>pBeginInfo-&gt;videoSessionParameters</code> is not
<code>VK_NULL_HANDLE</code>, it is also <em>bound</em> to the command buffer, and video
coding operations <strong class="purple">can</strong> refer to the codec-specific parameters stored in it.</p>
</div>
<div id="bound-reference-picture-resources" class="paragraph">
<p>This command also establishes the set of <em>bound reference picture resources</em>
that <strong class="purple">can</strong> be used as <a href="chap36.html#reconstructed-picture">reconstructed pictures</a> or
<a href="chap36.html#reference-picture">reference pictures</a> within the video coding scope.
Each element of this set consists of a <a href="chap36.html#video-picture-resources">video
picture resource</a> and the <a href="chap36.html#dpb-slot">DPB slot</a> index associated with it,
if there is one.</p>
</div>
<div class="paragraph">
<p>The set of bound reference picture resources is immutable within a video
coding scope, however, the DPB slot index associated with any of the bound
reference picture resources <strong class="purple">can</strong> change during the video coding scope in
response to video coding operations.</p>
</div>
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures provided as the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> are interpreted by this command as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>slotIndex</code> is non-negative and <code>pPictureResource</code> is not
<code>NULL</code>, then the <a href="chap36.html#video-picture-resources">video picture resource</a>
defined by the <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure pointed to
by <code>pPictureResource</code> is added to the set of bound reference picture
resources and is associated with the DPB slot index specified in
<code>slotIndex</code>.</p>
</li>
<li>
<p>If <code>slotIndex</code> is non-negative and <code>pPictureResource</code> is <code>NULL</code>,
then the DPB slot with index <code>slotIndex</code> is <a href="chap36.html#dpb-slot-states">deactivated</a> by this command.</p>
</li>
<li>
<p>If <code>slotIndex</code> is negative and <code>pPictureResource</code> is not <code>NULL</code>,
then the <a href="chap36.html#video-picture-resources">video picture resource</a> defined by
the <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure pointed to by
<code>pPictureResource</code> is added to the set of bound reference picture
resources without an associated DPB slot.
Such a picture resource <strong class="purple">can</strong> be subsequently used as a
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> to associate it with a
DPB slot.</p>
</li>
<li>
<p>If <code>slotIndex</code> is negative and <code>pPictureResource</code> is <code>NULL</code>,
then the element is ignored.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It is possible for multiple bound reference picture resources to be
associated with the same DPB slot index, or for a single bound reference
picture to refer to multiple separate reference pictures.
For example, in case of an <a href="chap36.html#decode-h264-profile">H.264 decode profile</a> with
<a href="chap36.html#decode-h264-interlaced-support">interlaced frame support</a> a single DPB
slot can refer to two separate pictures for the top and bottom fields.
Depending on the picture layout used by the <a href="chap36.html#decode-h264-profile">H.264
decode profile</a>, the following special cases <strong class="purple">may</strong> arise:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the picture layout is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>,
then the top and bottom field pictures are physically co-located in the
same video picture resource with even scanlines corresponding to the top
field and odd scanlines corresponding to the bottom field, respectively.</p>
</li>
<li>
<p>If the picture layout is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>,
then the top and bottom field pictures are stored in separate video
picture resources (in separate subregions of the same image layer, in
separate layers of the same image, or in entirely separate images),
hence two elements of
<a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a>::<code>pReferenceSlots</code> <strong class="purple">can</strong> contain the
same <code>slotIndex</code> but specify different video picture resources in
their <code>pPictureResource</code> members.</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>All non-negative <code>slotIndex</code> values specified in the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> identify DPB slots of the video
session that are in the <a href="chap36.html#dpb-slot-states">active state</a> at the time this
command is executed on the device.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The application does not have to specify an entry in
<code>pBeginInfo-&gt;pReferenceSlots</code> corresponding to all active DPB slots of
the video session, but only for those which are intended to be used in the
video coding scope.
This way the application can avoid any potential runtime cost associated
with binding the corresponding picture resources to the command buffer.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>In case of a video encode session, the application is also responsible for
providing information about the current <a href="chap36.html#encode-rate-control-state">rate
control state</a> configured for the video session by including an instance of
the <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure in the <code>pNext</code> chain
of <code>pBeginInfo</code>.
If no <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> is included, then the presence
of an empty <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure is implied which
indicates that the current <a href="chap36.html#encode-rate-control-modes">rate control mode</a>
is <code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code>.
The specified state <strong class="purple">must</strong> <a href="chap36.html#encode-rate-control-state-matching">match</a> the
effective rate control state configured for the video session at the time
the recorded command is executed on the device.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Including an instance of the <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure
in the <code>pNext</code> chain of <code>pBeginInfo</code> does not change the rate
control state configured for the video session, but only specifies the
expected rate control state configured at the time the recorded command is
executed on the device which allows the implementation to have information
about the configured rate control state at command buffer recording time.
In order to change the current rate control state of a video session, the
application has to issue an appropriate <a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a>
command as described in the <a href="chap36.html#video-coding-control">Video Coding Control</a>
and <a href="chap36.html#encode-rate-control-state">Rate Control State</a> sections.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07231</span><br>

The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from
<strong class="purple">must</strong> support the video codec operation <code>pBeginInfo-&gt;videoSession</code>
was created with, as returned by
<a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="chap5.html#VkQueueFamilyVideoPropertiesKHR">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-None-07232" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-None-07232"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-None-07232</span><br>

There <strong class="purple">must</strong> be no <a href="chap17.html#queries-operation-active">active</a> queries</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07233</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pBeginInfo-&gt;videoSession</code> <strong class="purple">must</strong> not have been created with
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07234</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pBeginInfo-&gt;videoSession</code> <strong class="purple">must</strong> have been created with
<code>VK_VIDEO_SESSION_CREATE_PROTECTED_CONTENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07235</span><br>

If <code>commandBuffer</code> is an unprotected command buffer,
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
and the <code>pPictureResource</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not <code>NULL</code>, then
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong class="purple">must</strong> not
specify an image view created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-07236</span><br>

If <code>commandBuffer</code> is a protected command buffer
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
and the <code>pPictureResource</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not <code>NULL</code>, then
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong class="purple">must</strong> specify
an image view created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-slotIndex-07239</span><br>

If the <code>slotIndex</code> member of any element of
<code>pBeginInfo-&gt;pReferenceSlots</code> is not negative, then it <strong class="purple">must</strong> specify
the index of a DPB slot that is in the <a href="chap36.html#dpb-slot-states">active state</a>
in <code>pBeginInfo-&gt;videoSession</code> at the time the command is executed on
the device</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pPictureResource-07265</span><br>

Each video picture resource specified by any non-<code>NULL</code>
<code>pPictureResource</code> member specified in the elements of
<code>pBeginInfo-&gt;pReferenceSlots</code> for which <code>slotIndex</code> is not
negative <strong class="purple">must</strong> <a href="chap36.html#video-picture-resource-matching">match</a> one of the
video picture resources currently associated with the DPB slot index of
<code>pBeginInfo-&gt;videoSession</code> specified by <code>slotIndex</code> at the time
the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08253" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08253"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08253</span><br>

If <code>pBeginInfo-&gt;videoSession</code> was created with a video encode
operation and the <code>pNext</code> chain of <code>pBeginInfo</code> does not include
an instance of the <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure, then
the <a href="chap36.html#encode-rate-control-modes">rate control mode</a> configured for
<code>pBeginInfo-&gt;videoSession</code> at the time the command is executed on
the device <strong class="purple">must</strong> be <code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08254" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08254"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08254</span><br>

If <code>pBeginInfo-&gt;videoSession</code> was created with a video encode
operation and the <code>pNext</code> chain of <code>pBeginInfo</code> includes an
instance of the <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure, then it
<strong class="purple">must</strong> <a href="chap36.html#encode-rate-control-state-matching">match</a> the rate control
state configured for <code>pBeginInfo-&gt;videoSession</code> at the time the
command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08255" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08255"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08255</span><br>

If <code>pBeginInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the
current <a href="chap36.html#encode-rate-control-modes">rate control mode</a> is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>requiresGopRemainingFrames</code>
is <code>VK_TRUE</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
<code>pBeginInfo-&gt;videoSession</code> was created with, then the <code>pNext</code>
chain of <code>pBeginInfo</code> <strong class="purple">must</strong> include an instance of the
<a href="chap36.html#VkVideoEncodeH264GopRemainingFrameInfoKHR">VkVideoEncodeH264GopRemainingFrameInfoKHR</a> with its
<code>useGopRemainingFrames</code> member set to <code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08256" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08256"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-08256</span><br>

If <code>pBeginInfo-&gt;videoSession</code> was created with the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the
current <a href="chap36.html#encode-rate-control-modes">rate control mode</a> is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>requiresGopRemainingFrames</code>
is <code>VK_TRUE</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
<code>pBeginInfo-&gt;videoSession</code> was created with, then the <code>pNext</code>
chain of <code>pBeginInfo</code> <strong class="purple">must</strong> include an instance of the
<a href="chap36.html#VkVideoEncodeH265GopRemainingFrameInfoKHR">VkVideoEncodeH265GopRemainingFrameInfoKHR</a> with its
<code>useGopRemainingFrames</code> member set to <code>VK_TRUE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-parameter" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-parameter" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-parameter"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-pBeginInfo-parameter</span><br>
 <code>pBeginInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-recording" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-commandBuffer-cmdpool" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-renderpass" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-renderpass"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-videocoding" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-videocoding"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginVideoCodingKHR-bufferlevel" href="chap36.html#VUID-vkCmdBeginVideoCodingKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdBeginVideoCodingKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap36.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoBeginCodingInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoBeginCodingInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoBeginCodingFlagsKHR</span>            <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkVideoSessionKHR</span>                     <span class="n">videoSession</span><span class="p">;</span>
    <span class="n">VkVideoSessionParametersKHR</span>           <span class="n">videoSessionParameters</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                              <span class="n">referenceSlotCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoReferenceSlotInfoKHR</span><span class="o">*</span>    <span class="n">pReferenceSlots</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoBeginCodingInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>videoSession</code> is the video session object to be bound for the
processing of the video commands.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is <code>VK_NULL_HANDLE</code> or a handle of a
<a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> object to be used for the processing
of the video commands.
If <code>VK_NULL_HANDLE</code>, then no video session parameters object is
bound for the duration of the video coding scope.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of elements in the
<code>pReferenceSlots</code> array.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is a pointer to an array of
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures specifying the information
used to determine the set of <a href="chap36.html#bound-reference-picture-resources">bound
reference picture resources</a> for the video coding scope and their
initial association with <a href="chap36.html#dpb-slot">DPB slot</a> indices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Limiting values are defined below that are referenced by the relevant valid
usage statements of this structure.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>VkOffset2D codedOffsetGranularity</code> be the minimum alignment
requirement for the coded offset of video picture resources.
Unless otherwise defined, the value of the <code>x</code> and <code>y</code> members
of <code>codedOffsetGranularity</code> are <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>videoSession</code> was created with an <a href="chap36.html#decode-h264-profile">H.264
decode profile</a> with a
<a href="chap36.html#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>::<code>pictureLayout</code> of
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>,
then <code>codedOffsetGranularity</code> is equal to
<a href="chap36.html#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a>::<code>fieldOffsetGranularity</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for that
video profile.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07237" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-07237"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07237</span><br>

<code>videoSession</code> <strong class="purple">must</strong> have memory bound to all of its memory bindings
returned by <a href="chap36.html#vkGetVideoSessionMemoryRequirementsKHR">vkGetVideoSessionMemoryRequirementsKHR</a> for
<code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-04856</span><br>

Each non-negative <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>::<code>slotIndex</code>
specified in the elements of <code>pReferenceSlots</code> <strong class="purple">must</strong> be less than
the <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when
<code>videoSession</code> was created</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07238</span><br>

Each video picture resource corresponding to any non-<code>NULL</code>
<code>pPictureResource</code> member specified in the elements of
<code>pReferenceSlots</code> <strong class="purple">must</strong> be <a href="chap36.html#video-picture-resource-uniqueness">unique</a> within <code>pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07240</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong class="purple">must</strong> be
<a href="chap36.html#video-profile-compatibility">compatible</a> with the video profile
<code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07241</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then the format of the image view
specified in <code>pPictureResource-&gt;imageViewBinding</code> for that element
<strong class="purple">must</strong> match the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>referencePictureFormat</code>
<code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07242</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then its <code>codedOffset</code> member
<strong class="purple">must</strong> be an integer multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pPictureResource-07243</span><br>

If the <code>pPictureResource</code> member of any element of
<code>pReferenceSlots</code> is not <code>NULL</code>, then its <code>codedExtent</code> member
<strong class="purple">must</strong> be between <code>minCodedExtent</code> and <code>maxCodedExtent</code>,
inclusive, <code>videoSession</code> was created with</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-flags-07244" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-flags-07244"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-flags-07244</span><br>

If <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_CAPABILITY_SEPARATE_REFERENCE_IMAGES_BIT_KHR</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
<code>videoSession</code> was created with, then
<code>pPictureResource-&gt;imageViewBinding</code> of all elements of
<code>pReferenceSlots</code> with a non-<code>NULL</code> <code>pPictureResource</code> member
<strong class="purple">must</strong> specify image views created from the same image</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-07245" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-slotIndex-07245"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-07245</span><br>

If <code>videoSession</code> was created with a decode operation and the
<code>slotIndex</code> member of any element of <code>pReferenceSlots</code> is not
negative, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-slotIndex-07246" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-slotIndex-07246"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-slotIndex-07246</span><br>

If <code>videoSession</code> was created with an encode operation and the
<code>slotIndex</code> member of any element of <code>pReferenceSlots</code> is not
negative, then the image view specified in
<code>pPictureResource-&gt;imageViewBinding</code> for that element <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_DPB_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07247" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-07247"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07247</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07248" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-07248"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07248</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-09261" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-09261"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-09261</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07249" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-07249"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07249</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-07250" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-07250"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-07250</span><br>

If <code>videoSession</code> was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then
<code>videoSessionParameters</code> <strong class="purple">must</strong> not be <code>VK_NULL_HANDLE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-04857</span><br>

If <code>videoSessionParameters</code> is not <code>VK_NULL_HANDLE</code>, it <strong class="purple">must</strong>
have been created with <code>videoSession</code> specified in
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>videoSession</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_BEGIN_CODING_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264GopRemainingFrameInfoKHR">VkVideoEncodeH264GopRemainingFrameInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH265GopRemainingFrameInfoKHR">VkVideoEncodeH265GopRemainingFrameInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>, or <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-flags-zerobitmask" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSession-parameter" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSession-parameter"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSession-parameter</span><br>
 <code>videoSession</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionKHR">VkVideoSessionKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parameter" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parameter</span><br>
 If <code>videoSessionParameters</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>videoSessionParameters</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-pReferenceSlots-parameter" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-pReferenceSlots-parameter"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-pReferenceSlots-parameter</span><br>
 If <code>referenceSlotCount</code> is not <code>0</code>, <code>pReferenceSlots</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>referenceSlotCount</code> valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parent" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parent"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-videoSessionParameters-parent</span><br>
 If <code>videoSessionParameters</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>videoSession</code></p>
</li>
<li>
<p><a id="VUID-VkVideoBeginCodingInfoKHR-commonparent" href="chap36.html#VUID-VkVideoBeginCodingInfoKHR-commonparent"></a> <span class="vuid">VUID-VkVideoBeginCodingInfoKHR-commonparent</span><br>
 Both of <code>videoSession</code>, and <code>videoSessionParameters</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoBeginCodingFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoBeginCodingFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoBeginCodingFlagsKHR</code> is a bitmask type for setting a mask, but
is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoReferenceSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoReferenceSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoReferenceSlotInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                             <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                 <span class="n">slotIndex</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoPictureResourceInfoKHR</span><span class="o">*</span>    <span class="n">pPictureResource</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoReferenceSlotInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>slotIndex</code> is the index of the <a href="chap36.html#dpb-slot">DPB slot</a> or a negative
integer value.</p>
</li>
<li>
<p><code>pPictureResource</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure describing the
<a href="chap36.html#video-picture-resources">video picture resource</a> associated with the
DPB slot index specified by <code>slotIndex</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoReferenceSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_REFERENCE_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoReferenceSlotInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoDecodeAV1DpbSlotInfoKHR">VkVideoDecodeAV1DpbSlotInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH265DpbSlotInfoKHR">VkVideoDecodeH265DpbSlotInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH264DpbSlotInfoKHR">VkVideoEncodeH264DpbSlotInfoKHR</a>, or <a href="chap36.html#VkVideoEncodeH265DpbSlotInfoKHR">VkVideoEncodeH265DpbSlotInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoReferenceSlotInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoReferenceSlotInfoKHR-pPictureResource-parameter" href="chap36.html#VUID-VkVideoReferenceSlotInfoKHR-pPictureResource-parameter"></a> <span class="vuid">VUID-VkVideoReferenceSlotInfoKHR-pPictureResource-parameter</span><br>
 If <code>pPictureResource</code> is not <code>NULL</code>, <code>pPictureResource</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To end a video coding scope, call:</p>
</div>
<div id="vkCmdEndVideoCodingKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="kt">void</span> <span class="nf">vkCmdEndVideoCodingKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoEndCodingInfoKHR</span><span class="o">*</span>              <span class="n">pEndCodingInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pEndCodingInfo</code> is a pointer to a <a href="chap36.html#VkVideoEndCodingInfoKHR">VkVideoEndCodingInfoKHR</a>
structure specifying the parameters for ending the video coding scope.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After ending a video coding scope, the video session object, the optional
video session parameters object, and all
<a href="chap36.html#bound-reference-picture-resources">reference picture resources</a>
previously bound by the corresponding <a href="chap36.html#vkCmdBeginVideoCodingKHR">vkCmdBeginVideoCodingKHR</a> command
are <em>unbound</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-None-07251" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-None-07251"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-None-07251</span><br>

There <strong class="purple">must</strong> be no <a href="chap17.html#queries-operation-active">active</a> queries</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-commandBuffer-parameter" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-pEndCodingInfo-parameter" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-pEndCodingInfo-parameter"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-pEndCodingInfo-parameter</span><br>
 <code>pEndCodingInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoEndCodingInfoKHR">VkVideoEndCodingInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-commandBuffer-recording" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-commandBuffer-cmdpool" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-renderpass" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-renderpass"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-videocoding" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-videocoding"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdEndVideoCodingKHR-bufferlevel" href="chap36.html#VUID-vkCmdEndVideoCodingKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdEndVideoCodingKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap36.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEndCodingInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEndCodingInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEndCodingInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>             <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                 <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEndCodingFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEndCodingInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEndCodingInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEndCodingInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEndCodingInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_END_CODING_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEndCodingInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEndCodingInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEndCodingInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEndCodingInfoKHR-flags-zerobitmask" href="chap36.html#VUID-VkVideoEndCodingInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoEndCodingInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEndCodingFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEndCodingFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEndCodingFlagsKHR</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-coding-control"><a class="anchor" href="chap36.html#video-coding-control"></a>36.9. Video Coding Control</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To apply dynamic controls to the currently bound video session object, call:</p>
</div>
<div id="vkCmdControlVideoCodingKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="kt">void</span> <span class="nf">vkCmdControlVideoCodingKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoCodingControlInfoKHR</span><span class="o">*</span>          <span class="n">pCodingControlInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pCodingControlInfo</code> is a pointer to a
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure specifying the control
parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The control parameters provided in this call are applied to the video
session at the time the command executes on the device and are in effect
until a subsequent call to this command with the same video session bound
changes the corresponding control parameters.</p>
</div>
<div class="paragraph">
<p>A newly created video session <strong class="purple">must</strong> be reset before performing video coding
operations using it by including <code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>
in <code>pCodingControlInfo-&gt;flags</code>.
The reset operation also returns all DPB slots of the video session to the
<a href="chap36.html#dpb-slot-states">inactive state</a>.
Correspondingly, any DPB slot index associated with the
<a href="chap36.html#bound-reference-picture-resources">bound reference picture resources</a> is
removed.</p>
</div>
<div class="paragraph">
<p>For encode sessions, the reset operation returns <a href="chap36.html#encode-rate-control">rate
control</a> configuration to implementation default settings and sets the
<a href="chap36.html#encode-quality-level">video encode quality level</a> to zero.</p>
</div>
<div class="paragraph">
<p>After video coding operations are performed using a video session, the reset
operation <strong class="purple">can</strong> be used to return the video session to the same <em>initial</em>
state as after the reset of a newly created video session.
This <strong class="purple">can</strong> be used, for example, when different video sequences are needed to
be processed with the same video session object.</p>
</div>
<div class="paragraph">
<p>If <code>pCodingControlInfo-&gt;flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, then the command
replaces the <a href="chap36.html#encode-rate-control">rate control</a> configuration maintained
by the video session with the configuration specified in the
<a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure included in the
<code>pCodingControlInfo-&gt;pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>If <code>pCodingControlInfo-&gt;flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR</code>, then the command
changes the current <a href="chap36.html#encode-quality-level">video encode quality level</a> to
the value specified in the <code>qualityLevel</code> member of the
<a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a> structure included in the
<code>pCodingControlInfo-&gt;pNext</code> chain.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-flags-07017" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-flags-07017"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-flags-07017</span><br>

If <code>pCodingControlInfo-&gt;flags</code> does not include
<code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code>, then the bound video
session <strong class="purple">must</strong> not be in <a href="chap36.html#video-session-uninitialized">uninitialized</a>
state at the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-08243" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-08243"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-08243</span><br>

If the bound video session was not created with an encode operation,
then <code>pCodingControlInfo-&gt;flags</code> <strong class="purple">must</strong> not include
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code> or
<code>VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-commandBuffer-parameter" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-parameter" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-parameter"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-pCodingControlInfo-parameter</span><br>
 <code>pCodingControlInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-commandBuffer-recording" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-commandBuffer-cmdpool" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-renderpass" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-renderpass"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-videocoding" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-videocoding"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdControlVideoCodingKHR-bufferlevel" href="chap36.html#VUID-vkCmdControlVideoCodingKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdControlVideoCodingKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap36.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoCodingControlInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoCodingControlInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoCodingControlInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                 <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                     <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoCodingControlFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoCodingControlInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoCodingControlFlagsKHR">VkVideoCodingControlFlagsKHR</a>
specifying control flags.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-07018" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-flags-07018"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-07018</span><br>

If <code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, then the
<code>pNext</code> chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>
structure</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-08349" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-flags-08349"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-08349</span><br>

If <code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR</code>, then the
<code>pNext</code> chain <strong class="purple">must</strong> include a <a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>
structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_CODING_CONTROL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>, <a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>, or <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-parameter" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoCodingControlFlagBitsKHR">VkVideoCodingControlFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkVideoCodingControlInfoKHR-flags-requiredbitmask" href="chap36.html#VUID-VkVideoCodingControlInfoKHR-flags-requiredbitmask"></a> <span class="vuid">VUID-VkVideoCodingControlInfoKHR-flags-requiredbitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code>,
specifying the video coding control parameters to be modified, are:</p>
</div>
<div id="VkVideoCodingControlFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoCodingControlFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_encode_queue</span>
    <span class="n">VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_encode_queue</span>
    <span class="n">VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoCodingControlFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_RESET_BIT_KHR</code> indicates a request for the
bound video session to be reset before other coding control parameters
are applied.</p>
</li>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code> indicates that
the coding control parameters include video encode rate control
parameters (see <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>).</p>
</li>
<li>
<p><code>VK_VIDEO_CODING_CONTROL_ENCODE_QUALITY_LEVEL_BIT_KHR</code> indicates
that the coding control parameters include video encode quality level
parameters (see <a href="chap36.html#VkVideoEncodeQualityLevelInfoKHR">VkVideoEncodeQualityLevelInfoKHR</a>).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoCodingControlFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoCodingControlFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoCodingControlFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoCodingControlFlagBitsKHR">VkVideoCodingControlFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-inline-queries"><a class="anchor" href="chap36.html#video-inline-queries"></a>36.10. Inline Queries</h3>
<div class="paragraph">
<p>If a video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, beginning queries
using commands such as <a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a> within a video coding scope is
not allowed.
Instead, queries are executed inline by including an instance of the
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure in the <code>pNext</code> chain of the
parameters of one of the video coding commands, with its <code>queryPool</code>
member set to a valid <code>VkQueryPool</code> handle.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoInlineQueryInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoInlineQueryInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_maintenance1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoInlineQueryInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkQueryPool</span>        <span class="n">queryPool</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">firstQuery</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">queryCount</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoInlineQueryInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>queryPool</code> is <code>VK_NULL_HANDLE</code> or a valid handle to a
<a href="chap17.html#VkQueryPool">VkQueryPool</a> object that will manage the results of the queries.</p>
</li>
<li>
<p><code>firstQuery</code> is the query index within the query pool that will
contain the query results for the first video coding operation.
The query results of subsequent video coding operations will be
contained by subsequent query indices.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to execute.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In practice, if <code>queryPool</code> is not <code>VK_NULL_HANDLE</code>, then
<code>queryCount</code> will always have to match the number of video coding
operations issued by the video coding command this structure is specified
to, meaning that using inline queries in a video coding command will always
execute a query for each issued video coding operation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be included in the <code>pNext</code> chain of the input
parameter structure of video coding commands.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pNext</code> chain of the <code>pDecodeInfo</code> parameter of the
<a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a> command to execute a query for each video
decode operation issued by the command.</p>
</li>
<li>
<p>In the <code>pNext</code> chain of the <code>pEncodeInfo</code> parameter of the
<a href="chap36.html#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> command to execute a query for each video
encode operation issued by the command.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoInlineQueryInfoKHR-queryPool-08372" href="chap36.html#VUID-VkVideoInlineQueryInfoKHR-queryPool-08372"></a> <span class="vuid">VUID-VkVideoInlineQueryInfoKHR-queryPool-08372</span><br>

If <code>queryPool</code> is not <code>VK_NULL_HANDLE</code>, then <code>firstQuery</code>
<strong class="purple">must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-VkVideoInlineQueryInfoKHR-queryPool-08373" href="chap36.html#VUID-VkVideoInlineQueryInfoKHR-queryPool-08373"></a> <span class="vuid">VUID-VkVideoInlineQueryInfoKHR-queryPool-08373</span><br>

If <code>queryPool</code> is not <code>VK_NULL_HANDLE</code>, then the sum of
<code>firstQuery</code> and <code>queryCount</code> <strong class="purple">must</strong> be less than or equal to the
number of queries in <code>queryPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoInlineQueryInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoInlineQueryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoInlineQueryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_INLINE_QUERY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoInlineQueryInfoKHR-queryPool-parameter" href="chap36.html#VUID-VkVideoInlineQueryInfoKHR-queryPool-parameter"></a> <span class="vuid">VUID-VkVideoInlineQueryInfoKHR-queryPool-parameter</span><br>
 If <code>queryPool</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-decode-operations"><a class="anchor" href="chap36.html#video-decode-operations"></a>36.11. Video Decode Operations</h3>
<div id="decode-output-picture" class="paragraph">
<p>Video decode operations consume compressed video data from a video bitstream
buffer and zero or more reference pictures, and produce a <em>decode output
picture</em> and an optional <a href="chap36.html#reconstructed-picture">reconstructed picture</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Such decode output pictures can be shared with the <a href="chap36.html#dpb">Decoded Picture
Buffer</a>, and can also be used
as the <a href="chap36.html#encode-input-picture">input</a> of video encode operations,
with graphics or compute operations,
or with <a href="chap30.html">Window System Integration</a> APIs,
depending on the capabilities of the implementation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Video decode operations <strong class="purple">may</strong> access the following resources in the
<code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code> stage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The source video bitstream buffer range and the image subregions
corresponding to the list of <a href="chap36.html#decode-active-reference-picture-info">active reference pictures</a> with access
<code>VK_ACCESS_2_VIDEO_DECODE_READ_BIT_KHR</code>.</p>
</li>
<li>
<p>The image subregions corresponding to the target
<a href="chap36.html#decode-output-picture-info">decode output picture</a> and
<a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a> with access
<code>VK_ACCESS_2_VIDEO_DECODE_WRITE_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The image subresource of each <a href="chap36.html#video-picture-resources">video picture
resource</a> accessed by the video decode operation is specified using a
corresponding <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.
Each such image subresource <strong class="purple">must</strong> be in the appropriate image layout as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the image subresource is used in the video decode operation only as
<a href="chap36.html#decode-output-picture">decode output picture</a>, then it <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DST_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video decode operation both as
<a href="chap36.html#decode-output-picture">decode output picture</a> and
<a href="chap36.html#reconstructed-picture">reconstructed picture</a>, then it <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video decode operation only as
<a href="chap36.html#reconstructed-picture">reconstructed picture</a>, then it <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video decode operation as a
<a href="chap36.html#reference-picture">reference picture</a>, then it <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout.</p>
</li>
</ul>
</div>
<div id="decode-unsuccessful" class="paragraph">
<p>A video decode operation <strong class="purple">may</strong> complete unsuccessfully.
In this case the <a href="chap36.html#decode-output-picture">decode output picture</a> will have
undefined contents.
Similarly, if <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a> is requested,
the <a href="chap36.html#reconstructed-picture">reconstructed picture</a> will also have
undefined contents, and the activated DPB slot will have an
<a href="chap36.html#dpb-slot-states">invalid picture reference</a>.</p>
</div>
<div class="sect3">
<h4 id="decode-codec-specific-semantics"><a class="anchor" href="chap36.html#decode-codec-specific-semantics"></a>36.11.1. Codec-Specific Semantics</h4>
<div class="paragraph">
<p>The following aspects of video decode operations are codec-specific:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The interpretation of the contents of the source video bitstream buffer
range.</p>
</li>
<li>
<p>The construction and interpretation of the list of
<a href="chap36.html#decode-active-reference-picture-info">active reference pictures</a> and
the interpretation of the picture data referred to by the corresponding
image subregions.</p>
</li>
<li>
<p>The construction and interpretation of information related to the
<a href="chap36.html#decode-output-picture-info">decode output picture</a> and the generation
of picture data to the corresponding image subregion.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a>.</p>
</li>
<li>
<p>The construction and interpretation of information related to the
optional <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a> and
the generation of picture data to the corresponding image subregion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These codec-specific behaviors are defined for each video codec operation
separately.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the
codec-specific aspects of the video decoding process are performed as
defined in the <a href="chap36.html#decode-h264">H.264 Decode Operations</a> section.</p>
</li>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the
codec-specific aspects of the video decoding process are performed as
defined in the <a href="chap36.html#decode-h265">H.265 Decode Operations</a> section.</p>
</li>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the
codec-specific aspects of the video decoding process are performed as
defined in the <a href="chap36.html#decode-av1">AV1 Decode Operations</a> section.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="decode-operation-steps"><a class="anchor" href="chap36.html#decode-operation-steps"></a>36.11.2. Video Decode Operation Steps</h4>
<div class="paragraph">
<p>Each video decode operation performs the following steps in the
<code>VK_PIPELINE_STAGE_2_VIDEO_DECODE_BIT_KHR</code> stage:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reads the encoded video data from the source video bitstream buffer
range.</p>
</li>
<li>
<p>Performs picture reconstruction of the encoded video data according to
the <a href="chap36.html#decode-codec-specific-semantics">codec-specific semantics</a>,
applying any prediction data read from the <a href="chap36.html#active-reference-pictures">active reference pictures</a> in the process;</p>
</li>
<li>
<p>Writes the decoded picture data to the <a href="chap36.html#decode-output-picture">decode
output picture</a>, and optionally to the <a href="chap36.html#reconstructed-picture">reconstructed picture</a>, if one is specified and is different from the
decode output picture, according to the
<a href="chap36.html#decode-codec-specific-semantics">codec-specific semantics</a>;</p>
</li>
<li>
<p>If <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a> is requested, the
<a href="chap36.html#dpb-slot">DPB slot index</a> specified in the
<a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture information</a>
is <a href="chap36.html#dpb-slot-states">activated</a> with the
<a href="chap36.html#reconstructed-picture">reconstructed picture</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture information</a>
is provided, the specified <a href="chap36.html#dpb-slot">DPB slot</a> index is associated with
the corresponding <a href="chap36.html#bound-reference-picture-resources">bound reference
picture resource</a>, indifferent of whether <a href="chap36.html#decode-ref-pic-setup">reference
picture setup</a> is requested.</p>
</div>
</div>
<div class="sect3">
<h4 id="_capabilities"><a class="anchor" href="chap36.html#_capabilities"></a>36.11.3. Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> with
<code>pVideoProfile-&gt;videoCodecOperation</code> specifying a decode operation, the
<code>VkVideoDecodeCapabilitiesKHR</code> structure <strong class="purple">must</strong> be included in the
<code>pNext</code> chain of the <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure to retrieve
capabilities specific to video decoding.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeCapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                    <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                              <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoDecodeCapabilityFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeCapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoDecodeCapabilityFlagBitsKHR">VkVideoDecodeCapabilityFlagBitsKHR</a>
describing the supported video decoding capabilities.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeCapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeCapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeCapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code>,
indicating the decoding capabilities supported, are:</p>
</div>
<div id="VkVideoDecodeCapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoDecodeCapabilityFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoDecodeCapabilityFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code>
indicates support for using the same video picture resource as the
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> and
<a href="chap36.html#decode-output-picture">decode output picture</a> in a video decode
operation.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>
indicates support for using distinct video picture resources as the
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> and
<a href="chap36.html#decode-output-picture">decode output picture</a> in a video decode
operation.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Some video profiles allow using distinct video picture resources as the
reconstructed picture and decode output picture in specific video decode
operations even when the video decode profile does not support
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>.
Even if the implementation only reports coincide, the decode output picture
for <a href="chap36.html#decode-av1-film-grain">film grain</a> enabled frames must be a different
video picture resource from the reconstructed picture because film grain is
applied outside of the coding loop.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations are only <strong class="purple">required</strong> to support one of
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> and
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>.
Accordingly, applications <strong class="purple">should</strong> handle both cases to maximize portability.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If both <code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> and
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code> are
supported, an application can choose to create separate images for decode
DPB and decode output.
E.g. in cases when linear tiling is preferred (and supported) for the decode
output picture and the DPB requires optimal tiling, this avoids the need for
a separate copy at the expense of additional memory bandwidth requirements
during decoding.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeCapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoDecodeCapabilityFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeCapabilityFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="chap36.html#VkVideoDecodeCapabilityFlagBitsKHR">VkVideoDecodeCapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_video_decode_commands"><a class="anchor" href="chap36.html#_video_decode_commands"></a>36.11.4. Video Decode Commands</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To launch video decode operations, call:</p>
</div>
<div id="vkCmdDecodeVideoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="kt">void</span> <span class="nf">vkCmdDecodeVideoKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoDecodeInfoKHR</span><span class="o">*</span>                 <span class="n">pDecodeInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pDecodeInfo</code> is a pointer to a <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure
specifying the parameters of the video decode operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call issues one or more video decode operations.
The implicit parameter <code>opCount</code> corresponds to the number of video
decode operations issued by the command.
After calling this command, the
<a href="chap17.html#queries-operation-active-query-index">active query index</a> of each
<a href="chap17.html#queries-operation-active">active</a> query is incremented by <code>opCount</code>.</p>
</div>
<div class="paragraph">
<p>Currently each call to this command results in the issue of a single video
decode operation.</p>
</div>
<div class="paragraph">
<p>If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code> and the <code>pNext</code>
chain of <code>pDecodeInfo</code> includes a <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>
structure with its <code>queryPool</code> member specifying a valid
<code>VkQueryPool</code> handle, then this command will execute a query for each
video decode operation issued by it.</p>
</div>
<div id="decode-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>The list of <a href="chap36.html#active-reference-pictures">active reference pictures</a> used by
a video decode operation is a list of image subregions used as the source of
<a href="chap36.html#reference-picture">reference picture</a> data and related parameters, and is
derived from the <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures provided as
the elements of the <code>pDecodeInfo-&gt;pReferenceSlots</code> array.
For each element of <code>pDecodeInfo-&gt;pReferenceSlots</code>, one or more elements
are added to the active reference picture list, as defined by the
<a href="chap36.html#decode-codec-specific-semantics">codec-specific semantics</a>.
Each element of this list contains the following information:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the
<a href="chap36.html#video-picture-resources">video picture resource</a> used as the reference
picture.</p>
</li>
<li>
<p>The <a href="chap36.html#dpb-slot">DPB slot</a> index the reference picture is associated
with.</p>
</li>
<li>
<p>The codec-specific reference information related to the reference
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>Information related to the optional <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> used by a video decode operation is derived from the
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure pointed to by
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code>, if not <code>NULL</code>, as defined by the
<a href="chap36.html#decode-codec-specific-semantics">codec-specific semantics</a>, and consists
of the following:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the
<a href="chap36.html#video-picture-resources">video picture resource</a> used as the
reconstructed picture.</p>
</li>
<li>
<p>The <a href="chap36.html#dpb-slot">DPB slot</a> index to use for picture reconstruction.</p>
</li>
<li>
<p>The codec-specific reference information related to the reconstructed
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-ref-pic-setup" class="paragraph">
<p>Specifying a valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure in
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is always required, unless the video
session was created with <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlot</code>
equal to zero.
However, the DPB slot identified by
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code> is only
<a href="chap36.html#dpb-slot-states">activated</a> with the <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> specified in
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> if reference
picture setup is requested according to the
<a href="chap36.html#decode-codec-specific-semantics">codec-specific semantics</a>.</p>
</div>
<div class="paragraph">
<p>If reconstructed picture information is specified, and
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> refers to a
<a href="chap36.html#video-picture-resources">video picture resource</a> different than that of
the <a href="chap36.html#decode-output-picture">decode output picture</a>, but reference picture
setup is not requested, the contents of the <a href="chap36.html#video-picture-resources">video
picture resource</a> corresponding to the reconstructed picture will be
undefined after the video decode operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Some implementations may always output the reconstructed picture or use it
as temporary storage during the video decode operation even when the
reconstructed picture is not marked for future reference.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="decode-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>Information related to the <a href="chap36.html#decode-output-picture">decode output picture</a>
used by a video decode operation is derived from
<code>pDecodeInfo-&gt;dstPictureResource</code> and any codec-specific parameters
provided in the <code>pDecodeInfo-&gt;pNext</code> chain, as defined by the
<a href="chap36.html#decode-codec-specific-semantics">codec-specific semantics</a>, and consists
of the following:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the
<a href="chap36.html#video-picture-resources">video picture resource</a> used as the decode
output picture.</p>
</li>
<li>
<p>The codec-specific picture information related to the decode output
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Several limiting values are defined below that are referenced by the
relevant valid usage statements of this command.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>uint32_t activeReferencePictureCount</code> be the size of the list of
active reference pictures used by the video decode operation.
Unless otherwise defined, <code>activeReferencePictureCount</code> is set to
the value of <code>pDecodeInfo-&gt;referenceSlotCount</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session was created with an <a href="chap36.html#decode-h264-profile">H.264 decode profile</a>, then let <code>activeReferencePictureCount</code> be
the value of <code>pDecodeInfo-&gt;referenceSlotCount</code> plus the number of
elements of the <code>pDecodeInfo-&gt;pReferenceSlots</code> array that have a
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure included in their
<code>pNext</code> chain with both
<code>pStdReferenceInfo-&gt;flags.top_field_flag</code> and
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> set.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that the elements of <code>pDecodeInfo-&gt;pReferenceSlots</code> that
include both a top and bottom field reference are counted as two separate
active reference pictures, as described in the
<a href="chap36.html#decode-h264-active-reference-picture-info">active reference picture list
construction rules for H.264 decode operations</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>VkOffset2D codedOffsetGranularity</code> be the minimum alignment
requirement for the coded offset of video picture resources.
Unless otherwise defined, the value of the <code>x</code> and <code>y</code> members
of <code>codedOffsetGranularity</code> are <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session was created with an <a href="chap36.html#decode-h264-profile">H.264 decode profile</a> with a
<a href="chap36.html#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>::<code>pictureLayout</code> of
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>,
then <code>codedOffsetGranularity</code> is equal to
<a href="chap36.html#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a>::<code>fieldOffsetGranularity</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for that
video profile.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>uint32_t dpbFrameUseCount[]</code> be an array of size <code>maxDpbSlots</code>,
where <code>maxDpbSlots</code> is the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> the bound video
session was created with, with each element indicating the number of
times a frame associated with the corresponding DPB slot index is
referred to by the video coding operation.
Let the initial value of each element of the array be <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>dpbFrameUseCount[i]</code> is incremented by one, where <code>i</code> equals
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.
If the bound video session object was created with an
<a href="chap36.html#decode-h264-profile">H.264 decode profile</a>, then
<code>dpbFrameUseCount[i]</code> is decremented by one if either
<code>pStdReferenceInfo-&gt;flags.top_field_flag</code> or
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pNext</code> chain.</p>
</li>
<li>
<p>For each element of <code>pDecodeInfo-&gt;pReferenceSlots</code>,
<code>dpbFrameUseCount[i]</code> is incremented by one, where <code>i</code> equals the
<code>slotIndex</code> member of the corresponding element.
If the bound video session object was created with an
<a href="chap36.html#decode-h264-profile">H.264 decode profile</a>, then
<code>dpbFrameUseCount[i]</code> is decremented by one if either
<code>pStdReferenceInfo-&gt;flags.top_field_flag</code> or
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the <code>pNext</code>
chain of the corresponding element of
<code>pDecodeInfo-&gt;pReferenceSlots</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>uint32_t dpbTopFieldUseCount[]</code> and <code>uint32_t
dpbBottomFieldUseCount[]</code> be arrays of size <code>maxDpbSlots</code>, where
<code>maxDpbSlots</code> is the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> the bound video
session was created with, with each element indicating the number of
times the top field or the bottom field, respectively, associated with
the corresponding DPB slot index is referred to by the video coding
operation.
Let the initial value of each element of the arrays be <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session object was created with an
<a href="chap36.html#decode-h264-profile">H.264 decode profile</a> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then perform the
following:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set in the
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pNext</code> chain, then
<code>dpbTopFieldUseCount[i]</code> is incremented by one, where <code>i</code> equals
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pNext</code> chain, then
<code>dpbBottomFieldUseCount[i]</code> is incremented by one, where <code>i</code>
equals <code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the bound video session object was created with an
<a href="chap36.html#decode-h264-profile">H.264 decode profile</a>, then perform the
following for each element of <code>pDecodeInfo-&gt;pReferenceSlots</code>:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set in the
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the <code>pNext</code>
chain of the element, then <code>dpbTopFieldUseCount[i]</code> is incremented by
one, where <code>i</code> equals the <code>slotIndex</code> member of the element.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set in the
<a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure in the <code>pNext</code>
chain of the element, then <code>dpbBottomFieldUseCount[i]</code> is incremented
by one, where <code>i</code> equals the <code>slotIndex</code> member of the
element.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-None-08249" href="chap36.html#VUID-vkCmdDecodeVideoKHR-None-08249"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-None-08249</span><br>

The bound video session <strong class="purple">must</strong> have been created with a decode operation</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-None-07011" href="chap36.html#VUID-vkCmdDecodeVideoKHR-None-07011"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-None-07011</span><br>

The bound video session <strong class="purple">must</strong> not be in <a href="chap36.html#video-session-uninitialized">uninitialized</a> state at the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-opCount-07134" href="chap36.html#VUID-vkCmdDecodeVideoKHR-opCount-07134"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-opCount-07134</span><br>

For each <a href="chap17.html#queries-operation-active">active</a> query, the
<a href="chap17.html#queries-operation-active-query-index">active query index</a>
corresponding to the query type of that query plus <code>opCount</code> <strong class="purple">must</strong>
be less than or equal to the
<a href="chap17.html#queries-operation-last-activatable-query-index">last activatable query
index</a> corresponding to the query type of that query plus one</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-08365" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-08365"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-08365</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, and the
<code>pNext</code> chain of <code>pDecodeInfo</code> includes a
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure with its <code>queryPool</code>
member specifying a valid <code>VkQueryPool</code> handle, then
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>::queryCount <strong class="purple">must</strong> equal <code>opCount</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-08366" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-08366"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-08366</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, and the
<code>pNext</code> chain of <code>pDecodeInfo</code> includes a
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure with its <code>queryPool</code>
member specifying a valid <code>VkQueryPool</code> handle, then all the queries
used by the command, as specified by the <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>
structure, <strong class="purple">must</strong> be <em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-queryType-08367" href="chap36.html#VUID-vkCmdDecodeVideoKHR-queryType-08367"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-queryType-08367</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, then the
<code>queryType</code> used to create the <code>queryPool</code> specified in the
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure included in the <code>pNext</code>
chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-queryPool-08368" href="chap36.html#VUID-vkCmdDecodeVideoKHR-queryPool-08368"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-queryPool-08368</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, then the
<code>queryPool</code> specified in the <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>
structure included in the <code>pNext</code> chain of <code>pDecodeInfo</code> <strong class="purple">must</strong>
have been created with a <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure included
in the <code>pNext</code> chain of <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the
one specified in <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code>
the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-queryType-08369" href="chap36.html#VUID-vkCmdDecodeVideoKHR-queryType-08369"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-queryType-08369</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, and the
<code>queryType</code> used to create the <code>queryPool</code> specified in the
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure included in the <code>pNext</code>
chain of <code>pDecodeInfo</code> is
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> have been created with
a queue family index that supports <a href="chap17.html#queries-result-status-only">result
status queries</a>, as indicated by
<a href="chap5.html#VkQueueFamilyQueryResultStatusPropertiesKHR">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07135" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07135"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07135</span><br>

<code>pDecodeInfo-&gt;srcBuffer</code> <strong class="purple">must</strong> be <a href="chap36.html#video-profile-compatibility">compatible</a> with the video profile the bound video session was created
with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07136" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-07136"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07136</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;srcBuffer</code> <strong class="purple">must</strong> not be a protected buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07137" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-07137"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07137</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;srcBuffer</code> <strong class="purple">must</strong> be a protected buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07138" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07138"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07138</span><br>

<code>pDecodeInfo-&gt;srcBufferOffset</code> <strong class="purple">must</strong> be an integer multiple of
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferOffsetAlignment</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
video profile the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07139" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07139"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07139</span><br>

<code>pDecodeInfo-&gt;srcBufferRange</code> <strong class="purple">must</strong> be an integer multiple of
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferSizeAlignment</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07140" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07140"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07140</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code> and
<a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then the video picture
resources specified by <code>pDecodeInfo-&gt;dstPictureResource</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong> not
<a href="chap36.html#video-picture-resource-matching">match</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07141" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07141"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07141</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code> and none of the
following is true:</p>
<div class="ulist">
<ul>
<li>
<p><a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> includes
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with</p>
</li>
<li>
<p>the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code> and
<a href="chap36.html#VkVideoDecodeAV1ProfileInfoKHR">VkVideoDecodeAV1ProfileInfoKHR</a>::<code>filmGrainSupport</code> set to
<code>VK_TRUE</code>, and <a href="chap36.html#decode-av1-film-grain">film grain</a> is enabled for
the decoded picture</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>then the video picture resources specified by
    <code>pDecodeInfo-&gt;dstPictureResource</code> and
    <code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong>
    <a href="chap36.html#video-picture-resource-matching">match</a></p>
</div>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07142" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07142"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07142</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong class="purple">must</strong> be
<a href="chap36.html#video-profile-compatibility">compatible</a> with the video profile the
bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07143" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07143"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07143</span><br>

The format of <code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code>
<strong class="purple">must</strong> match the <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pictureFormat</code>
the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07144" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07144"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07144</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.codedOffset</code> <strong class="purple">must</strong> be an integer
multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07145" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07145"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07145</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.codedExtent</code> <strong class="purple">must</strong> be between
<code>minCodedExtent</code> and <code>maxCodedExtent</code>, inclusive, the bound
video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07146" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07146"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07146</span><br>

<code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong class="purple">must</strong> have been
created with <code>VK_IMAGE_USAGE_VIDEO_DECODE_DST_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07147" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-07147"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07147</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong class="purple">must</strong> not
have been created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-07148" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-07148"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-07148</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pDecodeInfo-&gt;dstPictureResource.imageViewBinding</code> <strong class="purple">must</strong> have
been created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-08376" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-08376"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-08376</span><br>

<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong> not be <code>NULL</code> unless the
bound video session was created with
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> equal to zero</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07170" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07170"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07170</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code> <strong class="purple">must</strong> be less than the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when the
bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07173" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07173"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07173</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource-&gt;codedOffset</code>
<strong class="purple">must</strong> be an integer multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07149" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07149"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07149</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong>
<a href="chap36.html#video-picture-resource-matching">match</a> one of the
<a href="chap36.html#bound-reference-picture-resources">bound reference picture resource</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-activeReferencePictureCount-07150" href="chap36.html#VUID-vkCmdDecodeVideoKHR-activeReferencePictureCount-07150"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-activeReferencePictureCount-07150</span><br>

<code>activeReferencePictureCount</code> <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxActiveReferencePictures</code>
specified when the bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-slotIndex-07256" href="chap36.html#VUID-vkCmdDecodeVideoKHR-slotIndex-07256"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-slotIndex-07256</span><br>

The <code>slotIndex</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> be less than the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when the
bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-codedOffset-07257" href="chap36.html#VUID-vkCmdDecodeVideoKHR-codedOffset-07257"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-codedOffset-07257</span><br>

The <code>codedOffset</code> member of the <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a>
structure pointed to by the <code>pPictureResource</code> member of each
element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> be an integer
multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07151" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07151"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07151</span><br>

The <code>pPictureResource</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
<a href="chap36.html#video-picture-resource-matching">match</a> one of the
<a href="chap36.html#bound-reference-picture-resources">bound reference picture resource</a>
associated with the DPB slot index specified in the <code>slotIndex</code>
member of that element</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07264" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07264"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07264</span><br>

Each video picture resource corresponding to the <code>pPictureResource</code>
member specified in the elements of <code>pDecodeInfo-&gt;pReferenceSlots</code>
<strong class="purple">must</strong> be <a href="chap36.html#video-picture-resource-uniqueness">unique</a> within
<code>pDecodeInfo-&gt;pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-dpbFrameUseCount-07176" href="chap36.html#VUID-vkCmdDecodeVideoKHR-dpbFrameUseCount-07176"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-dpbFrameUseCount-07176</span><br>

All elements of <code>dpbFrameUseCount</code> <strong class="purple">must</strong> be less than or equal to
<code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-dpbTopFieldUseCount-07177" href="chap36.html#VUID-vkCmdDecodeVideoKHR-dpbTopFieldUseCount-07177"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-dpbTopFieldUseCount-07177</span><br>

All elements of <code>dpbTopFieldUseCount</code> <strong class="purple">must</strong> be less than or equal to
<code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-dpbBottomFieldUseCount-07178" href="chap36.html#VUID-vkCmdDecodeVideoKHR-dpbBottomFieldUseCount-07178"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-dpbBottomFieldUseCount-07178</span><br>

All elements of <code>dpbBottomFieldUseCount</code> <strong class="purple">must</strong> be less than or equal
to <code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07252" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07252"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07252</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is <code>NULL</code> or
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> does not
<a href="chap36.html#video-image-subresource-reference">refer</a> to the same image
subresource as <code>pDecodeInfo-&gt;dstPictureResource</code>, then the image
subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to by
<code>pDecodeInfo-&gt;dstPictureResource</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DST_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07253" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07253"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07253</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code>
<a href="chap36.html#video-image-subresource-reference">refers</a> to the same image
subresource as <code>pDecodeInfo-&gt;dstPictureResource</code>, then the image
subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to by
<code>pDecodeInfo-&gt;dstPictureResource</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07254" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07254"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07254</span><br>

If <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the image
subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to by
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pPictureResource-07255" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pPictureResource-07255"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pPictureResource-07255</span><br>

The image subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to
by the <code>pPictureResource</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_DECODE_DPB_KHR</code> layout at the time the video
decode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07152" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-07152"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07152</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-None-07258" href="chap36.html#VUID-vkCmdDecodeVideoKHR-None-07258"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-None-07258</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> but was not created
with <a href="chap36.html#decode-h264-interlaced-support">interlaced frame support</a>, then
the <a href="chap36.html#decode-h264-output-picture-info">decode output picture</a> <strong class="purple">must</strong>
represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pSliceOffsets-07153" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pSliceOffsets-07153"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pSliceOffsets-07153</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then all elements of
the <code>pSliceOffsets</code> member of the
<a href="chap36.html#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> be less than
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH264SequenceParameterSet-07154" href="chap36.html#VUID-vkCmdDecodeVideoKHR-StdVideoH264SequenceParameterSet-07154"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH264SequenceParameterSet-07154</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> that is
provided in the <code>pStdPictureInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH264PictureParameterSet-07155" href="chap36.html#VUID-vkCmdDecodeVideoKHR-StdVideoH264PictureParameterSet-07155"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH264PictureParameterSet-07155</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH264PictureParameterSet</code> entry with
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> and
<code>StdVideoDecodeH264PictureInfo</code>::<code>pic_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="chap36.html#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07156" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07156"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07156</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07259" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07259"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07259</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> but was not created
with <a href="chap36.html#decode-h264-interlaced-support">interlaced frame support</a>, and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<a href="chap36.html#decode-h264-reconstructed-picture-info">reconstructed picture</a> <strong class="purple">must</strong>
represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07157" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-07157"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07157</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07260" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07260"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07260</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> but was not created
with <a href="chap36.html#decode-h264-interlaced-support">interlaced frame support</a>, then
each <a href="chap36.html#decode-h264-active-reference-picture-info">active reference
picture</a> corresponding to the elements of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07261" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07261"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07261</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and the
<a href="chap36.html#decode-h264-output-picture-info">decode output picture</a> represents a
frame, then the <a href="chap36.html#decode-h264-reconstructed-picture-info">reconstructed
picture</a> <strong class="purple">must</strong> also represent a frame</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07262" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07262"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07262</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and the
<a href="chap36.html#decode-h264-output-picture-info">decode output picture</a> represents a
top field, then the
<a href="chap36.html#decode-h264-reconstructed-picture-info">reconstructed picture</a> <strong class="purple">must</strong>
also represent a top field</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07263" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07263"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07263</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and the
<a href="chap36.html#decode-h264-output-picture-info">decode output picture</a> represents a
bottom field, then the <a href="chap36.html#decode-h264-reconstructed-picture-info">reconstructed picture</a> <strong class="purple">must</strong> also represent a bottom field</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07266" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07266"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07266</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and an
<a href="chap36.html#decode-h264-active-reference-picture-info">active reference picture</a>
corresponding to any element of <code>pDecodeInfo-&gt;pReferenceSlots</code>
represents a frame, then the DPB slot index of the bound video session
specified by the <code>slotIndex</code> member of that element <strong class="purple">must</strong> be
currently associated with a frame picture
<a href="chap36.html#video-picture-resource-matching">matching</a> the video picture resource
specified by the <code>pPictureResource</code> member of the same element at
the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07267" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07267"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07267</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and an
<a href="chap36.html#decode-h264-active-reference-picture-info">active reference picture</a>
corresponding to any element of <code>pDecodeInfo-&gt;pReferenceSlots</code>
represents a top field, then the DPB slot index of the bound video
session specified by the <code>slotIndex</code> member of that element <strong class="purple">must</strong> be
currently associated with a top field picture
<a href="chap36.html#video-picture-resource-matching">matching</a> the video picture resource
specified by the <code>pPictureResource</code> member of the same element at
the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07268" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07268"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07268</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and an
<a href="chap36.html#decode-h264-active-reference-picture-info">active reference picture</a>
corresponding to any element of <code>pDecodeInfo-&gt;pReferenceSlots</code>
represents a bottom field, then the DPB slot index of the bound video
session specified by the <code>slotIndex</code> member of that element <strong class="purple">must</strong> be
currently associated with a bottom field picture
<a href="chap36.html#video-picture-resource-matching">matching</a> the video picture resource
specified by the <code>pPictureResource</code> member of the same element at
the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07158" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-07158"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07158</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pSliceSegmentOffsets-07159" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pSliceSegmentOffsets-07159"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pSliceSegmentOffsets-07159</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then all elements of
the <code>pSliceSegmentOffsets</code> member of the
<a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> be less than
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH265VideoParameterSet-07160" href="chap36.html#VUID-vkCmdDecodeVideoKHR-StdVideoH265VideoParameterSet-07160"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH265VideoParameterSet-07160</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>
that is provided in the <code>pStdPictureInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH265SequenceParameterSet-07161" href="chap36.html#VUID-vkCmdDecodeVideoKHR-StdVideoH265SequenceParameterSet-07161"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH265SequenceParameterSet-07161</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH265SequenceParameterSet</code> entry with
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code> and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-StdVideoH265PictureParameterSet-07162" href="chap36.html#VUID-vkCmdDecodeVideoKHR-StdVideoH265PictureParameterSet-07162"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-StdVideoH265PictureParameterSet-07162</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> matching
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>,
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>, and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_pic_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07163" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07163"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-07163</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeH265DpbSlotInfoKHR">VkVideoDecodeH265DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-07164" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-07164"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-07164</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeH265DpbSlotInfoKHR">VkVideoDecodeH265DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-filmGrainSupport-09248" href="chap36.html#VUID-vkCmdDecodeVideoKHR-filmGrainSupport-09248"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-filmGrainSupport-09248</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code> and
<a href="chap36.html#VkVideoDecodeAV1ProfileInfoKHR">VkVideoDecodeAV1ProfileInfoKHR</a>::<code>filmGrainSupport</code> set to
<code>VK_FALSE</code>, then <a href="chap36.html#decode-av1-film-grain">film grain</a> <strong class="purple">must</strong> not be
enabled for the decoded picture</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-09249" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-09249"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-09249</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>,
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, and
<a href="chap36.html#decode-av1-film-grain">film grain</a> is enabled for the decoded picture,
then the video picture resources specified by
<code>pDecodeInfo-&gt;dstPictureResource</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong> not
<a href="chap36.html#video-picture-resource-matching">match</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-09250" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-09250"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-09250</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-frameHeaderOffset-09251" href="chap36.html#VUID-vkCmdDecodeVideoKHR-frameHeaderOffset-09251"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-frameHeaderOffset-09251</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the
<code>frameHeaderOffset</code> member of the
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> be less than the minimum of
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pTileOffsets-09253" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pTileOffsets-09253"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pTileOffsets-09253</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then all elements of
the <code>pTileOffsets</code> member of the
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> be less than
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pTileOffsets-09252" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pTileOffsets-09252"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pTileOffsets-09252</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then for each element
<span class="eq">i</span> of the <code>pTileOffsets</code> and <code>pTileSizes</code> members of the
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> the sum of <code>pTileOffsets</code>[i]
and <code>pTileSizes</code>[i] <strong class="purple">must</strong> be less than or equal to
<code>pDecodeInfo-&gt;srcBufferRange</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-09254" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-09254"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-09254</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code> and
<code>pDecodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pDecodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeAV1DpbSlotInfoKHR">VkVideoDecodeAV1DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pNext-09255" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pNext-09255"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pNext-09255</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoDecodeAV1DpbSlotInfoKHR">VkVideoDecodeAV1DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-referenceNameSlotIndices-09262" href="chap36.html#VUID-vkCmdDecodeVideoKHR-referenceNameSlotIndices-09262"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-referenceNameSlotIndices-09262</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then each element of
the <code>referenceNameSlotIndices</code> array member of the
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code> <strong class="purple">must</strong> either be negative or <strong class="purple">must</strong>
equal the <code>slotIndex</code> member of one of the elements of
<code>pDecodeInfo-&gt;pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-slotIndex-09263" href="chap36.html#VUID-vkCmdDecodeVideoKHR-slotIndex-09263"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-slotIndex-09263</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, then the
<code>slotIndex</code> member of each element of
<code>pDecodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> equal one of the elements of
the <code>referenceNameSlotIndices</code> array member of the
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pDecodeInfo</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-parameter" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-pDecodeInfo-parameter" href="chap36.html#VUID-vkCmdDecodeVideoKHR-pDecodeInfo-parameter"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-pDecodeInfo-parameter</span><br>
 <code>pDecodeInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-recording" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-commandBuffer-cmdpool" href="chap36.html#VUID-vkCmdDecodeVideoKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support decode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-renderpass" href="chap36.html#VUID-vkCmdDecodeVideoKHR-renderpass"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-videocoding" href="chap36.html#VUID-vkCmdDecodeVideoKHR-videocoding"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdDecodeVideoKHR-bufferlevel" href="chap36.html#VUID-vkCmdDecodeVideoKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdDecodeVideoKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap36.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoDecodeFlagsKHR</span>                 <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkBuffer</span>                              <span class="n">srcBuffer</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                          <span class="n">srcBufferOffset</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                          <span class="n">srcBufferRange</span><span class="p">;</span>
    <span class="n">VkVideoPictureResourceInfoKHR</span>         <span class="n">dstPictureResource</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoReferenceSlotInfoKHR</span><span class="o">*</span>    <span class="n">pSetupReferenceSlot</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                              <span class="n">referenceSlotCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoReferenceSlotInfoKHR</span><span class="o">*</span>    <span class="n">pReferenceSlots</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>srcBuffer</code> is the source video bitstream buffer to read the encoded
bitstream from.</p>
</li>
<li>
<p><code>srcBufferOffset</code> is the starting offset in bytes from the start of
<code>srcBuffer</code> to read the encoded bitstream from.</p>
</li>
<li>
<p><code>srcBufferRange</code> is the size in bytes of the encoded bitstream to
decode from <code>srcBuffer</code>, starting from <code>srcBufferOffset</code>.</p>
</li>
<li>
<p><code>dstPictureResource</code> is the video picture resource to use as the
<a href="chap36.html#decode-output-picture">decode output picture</a>.</p>
</li>
<li>
<p><code>pSetupReferenceSlot</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure specifying the
<a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture information</a>.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of elements in the
<code>pReferenceSlots</code> array.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is <code>NULL</code> or a pointer to an array of
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures describing the DPB slots
and corresponding <a href="chap36.html#reference-picture">reference picture</a> resources to
use in this video decode operation (the set of
<a href="chap36.html#active-reference-pictures">active reference pictures</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBuffer-07165" href="chap36.html#VUID-VkVideoDecodeInfoKHR-srcBuffer-07165"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBuffer-07165</span><br>

<code>srcBuffer</code> <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_VIDEO_DECODE_SRC_BIT_KHR</code> set</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBufferOffset-07166" href="chap36.html#VUID-VkVideoDecodeInfoKHR-srcBufferOffset-07166"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBufferOffset-07166</span><br>

<code>srcBufferOffset</code> <strong class="purple">must</strong> be less than the size of <code>srcBuffer</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBufferRange-07167" href="chap36.html#VUID-VkVideoDecodeInfoKHR-srcBufferRange-07167"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBufferRange-07167</span><br>

<code>srcBufferRange</code> <strong class="purple">must</strong> be less than or equal to the size of
<code>srcBuffer</code> minus <code>srcBufferOffset</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07168" href="chap36.html#VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07168"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07168</span><br>

If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, then its <code>slotIndex</code>
member <strong class="purple">must</strong> not be negative</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07169" href="chap36.html#VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07169"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-07169</span><br>

If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, then its
<code>pPictureResource</code> <strong class="purple">must</strong> not be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-slotIndex-07171" href="chap36.html#VUID-VkVideoDecodeInfoKHR-slotIndex-07171"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-slotIndex-07171</span><br>

The <code>slotIndex</code> member of each element of <code>pReferenceSlots</code>
<strong class="purple">must</strong> not be negative</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pPictureResource-07172" href="chap36.html#VUID-VkVideoDecodeInfoKHR-pPictureResource-07172"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pPictureResource-07172</span><br>

The <code>pPictureResource</code> member of each element of
<code>pReferenceSlots</code> <strong class="purple">must</strong> not be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoDecodeInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a>, <a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a>, or <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoDecodeInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-flags-zerobitmask" href="chap36.html#VUID-VkVideoDecodeInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-srcBuffer-parameter" href="chap36.html#VUID-VkVideoDecodeInfoKHR-srcBuffer-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-srcBuffer-parameter</span><br>
 <code>srcBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-dstPictureResource-parameter" href="chap36.html#VUID-VkVideoDecodeInfoKHR-dstPictureResource-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-dstPictureResource-parameter</span><br>
 <code>dstPictureResource</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-parameter" href="chap36.html#VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pSetupReferenceSlot-parameter</span><br>
 If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, <code>pSetupReferenceSlot</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeInfoKHR-pReferenceSlots-parameter" href="chap36.html#VUID-VkVideoDecodeInfoKHR-pReferenceSlots-parameter"></a> <span class="vuid">VUID-VkVideoDecodeInfoKHR-pReferenceSlots-parameter</span><br>
 If <code>referenceSlotCount</code> is not <code>0</code>, <code>pReferenceSlots</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>referenceSlotCount</code> valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoDecodeFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeFlagsKHR</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-h264"><a class="anchor" href="chap36.html#decode-h264"></a>36.12. H.264 Decode Operations</h3>
<div class="paragraph">
<p>Video decode operations using an <a href="chap36.html#decode-h264-profile">H.264 decode
profile</a> <strong class="purple">can</strong> be used to decode elementary video stream sequences compliant
to the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="chap1.html">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="chap36.html#decode-operation-steps">video
decode operation steps</a> with the codec-specific semantics defined in
section 8 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoH264SequenceParameterSet</code> structure corresponding to
the <a href="chap36.html#decode-h264-active-sps">active SPS</a> specifying the
<a href="chap36.html#decode-h264-sps">H.264 sequence parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH264PictureParameterSet</code> structure corresponding to the
<a href="chap36.html#decode-h264-active-pps">active PPS</a> specifying the <a href="chap36.html#decode-h264-pps">H.264 picture parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH264PictureInfo</code> structure specifying the
<a href="chap36.html#decode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH264ReferenceInfo</code> structures specifying the
<a href="chap36.html#decode-h264-reference-info">H.264 reference information</a>
corresponding to the optional <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> and any <a href="chap36.html#active-reference-pictures">active reference
pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The contents of the provided video bitstream buffer range are
interpreted as defined in the <a href="chap36.html#decode-h264-bitstream-data-access">H.264
Decode Bitstream Data Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="chap36.html#video-picture-resources">video picture resources</a>
corresponding to the used <a href="chap36.html#decode-h264-active-reference-picture-info">active reference pictures</a>, <a href="chap36.html#decode-h264-output-picture-info">decode
output picture</a>, and optional <a href="chap36.html#decode-h264-reconstructed-picture-info">reconstructed picture</a> is accessed as defined in the
<a href="chap36.html#decode-h264-picture-data-access">H.264 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a> is made
according to the parameters specified in the
<a href="chap36.html#decode-h264-ref-pic-setup">H.264 picture information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters and the bitstream adhere to the syntactic and semantic
requirements defined in the corresponding sections of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>, as described above, and the <a href="chap36.html#dpb-slot">DPB slots</a>
associated with the <a href="chap36.html#active-reference-pictures">active reference pictures</a>
all refer to <a href="chap36.html#dpb-slot-states">valid picture references</a>, then the video
decode operation will complete successfully.
Otherwise, the video decode operation <strong class="purple">may</strong> complete
<a href="chap36.html#decode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect3">
<h4 id="decode-h264-bitstream-data-access"><a class="anchor" href="chap36.html#decode-h264-bitstream-data-access"></a>36.12.1. H.264 Decode Bitstream Data Access</h4>
<div class="paragraph">
<p>If the target <a href="chap36.html#decode-h264-output-picture-info">decode output picture</a> is a
frame, then the video bitstream buffer range <strong class="purple">should</strong> contain a VCL NAL unit
comprised of the slice headers and data of a picture representing an entire
frame, as defined in sections 7.3.3 and 7.3.4, and this data is interpreted
as defined in sections 7.4.3 and 7.4.4 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>If the target <a href="chap36.html#decode-h264-output-picture-info">decode output picture</a> is a
field, then the video bitstream buffer range should contain a VCL NAL unit
comprised of the slice headers and data of a picture representing a field,
as defined in sections 7.3.3 and 7.3.4, and this data is interpreted as
defined in sections 7.4.3 and 7.4.4 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>The offsets provided in
<a href="chap36.html#VkVideoDecodeH264PictureInfoKHR">VkVideoDecodeH264PictureInfoKHR</a>::<code>pSliceOffsets</code> <strong class="purple">should</strong> specify
the starting offsets corresponding to each slice header within the video
bitstream buffer range.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-h264-picture-data-access"><a class="anchor" href="chap36.html#decode-h264-picture-data-access"></a>36.12.2. H.264 Decode Picture Data Access</h4>
<div class="paragraph">
<p>The effective <code>imageOffset</code> and <code>imageExtent</code> corresponding to a
<a href="chap36.html#decode-output-picture">decode output picture</a>,
<a href="chap36.html#reference-picture">reference picture</a>, or
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> used in video decode
operations with an <a href="chap36.html#decode-h264-profile">H.264 decode profile</a> are defined
as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>imageOffset</code> is <span class="eq">(<code>codedOffset.x</code>,<code>codedOffset.y</code>)</span> and
<code>imageExtent</code> is <span class="eq">(<code>codedExtent.width</code>,
<code>codedExtent.height</code>)</span>, if the picture represents a frame.</p>
</li>
<li>
<p><code>imageOffset</code> is <span class="eq">(<code>codedOffset.x</code>,<code>codedOffset.y</code>)</span> and
<code>imageExtent</code> is <span class="eq">(<code>codedExtent.width</code>,
<code>codedExtent.height</code>)</span>, if the picture represents a field and the
picture layout of the used <a href="chap36.html#decode-h264-profile">H.264 decode profile</a>
is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>.</p>
</li>
<li>
<p><code>imageOffset</code> is <span class="eq">(<code>codedOffset.x</code>,<code>codedOffset.y</code>)</span> and
<code>imageExtent</code> is <span class="eq">(<code>codedExtent.width</code>,
<code>codedExtent.height</code> / 2)</span>, if the picture represents a field and
the picture layout of the used <a href="chap36.html#decode-h264-profile">H.264 decode
profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedOffset</code> and <code>codedExtent</code> are the members of the
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>However, accesses to image data within a video picture resource happen at
the granularity indicated by
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="chap36.html#video-profiles">video profile</a>.
This means that the complete image subregion accessed by video coding
operations using an <a href="chap36.html#decode-h264-profile">H.264 decode profile</a> for the
video picture resource is defined as the set of texels within the coordinate
range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([<code>startX</code>,<code>endX</code>),[<code>startY</code>,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>startX</code></span> equals <code>imageOffset.x</code> rounded down to the
nearest integer multiple of <code>pictureAccessGranularity.width</code>;</p>
</li>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>imageOffset.x</code> + 
<code>imageExtent.width</code></span> rounded up to the nearest integer multiple of
<code>pictureAccessGranularity.width</code> and clamped to the width of the
image subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to by
the corresponding <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">startY</span> equals <code>imageOffset.y</code> rounded down to the nearest
integer multiple of <code>pictureAccessGranularity.height</code>;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>imageOffset.y</code> + 
<code>imageExtent.height</code></span> rounded up to the nearest integer multiple of
<code>pictureAccessGranularity.height</code> and clamped to the height of the
image subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to by
the corresponding <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of video decode operations using an <a href="chap36.html#decode-h264-profile">H.264
decode profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>, is an access to the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
specified below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code>)</span>, if the accessed picture represents a frame.</p>
</li>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code> × 2)</span>, if the accessed picture represents a
top field and the picture layout of the used <a href="chap36.html#decode-h264-profile">H.264
decode profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>.</p>
</li>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code> × 2 +  1)</span>, if the accessed picture
represents a bottom field and the picture layout of the used
<a href="chap36.html#decode-h264-profile">H.264 decode profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>.</p>
</li>
<li>
<p><span class="eq">(<code>x</code>,<code>y</code>)</span>, if the accessed picture represents a top field
and the picture layout of the used <a href="chap36.html#decode-h264-profile">H.264 decode
profile</a> is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
<li>
<p><span class="eq">(<code>codedOffset.x</code> +  <code>x</code>,<code>codedOffset.y</code> + 
<code>y</code>)</span>, if the accessed picture represents a bottom field and the
picture layout of the used <a href="chap36.html#decode-h264-profile">H.264 decode profile</a>
is
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedOffset</code> is the member of the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-h264-profile"><a class="anchor" href="chap36.html#decode-h264-profile"></a>36.12.3. H.264 Decode Profile</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting H.264 video decode operations is specified by
setting <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code> and adding a
<code>VkVideoDecodeH264ProfileInfoKHR</code> structure to the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH264ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH264ProfileInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                              <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                  <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoH264ProfileIdc</span>                       <span class="n">stdProfileIdc</span><span class="p">;</span>
    <span class="n">VkVideoDecodeH264PictureLayoutFlagBitsKHR</span>    <span class="n">pictureLayout</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264ProfileInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH264ProfileIdc</code> value specifying
the H.264 codec profile IDC, as defined in section A.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
<li>
<p><code>pictureLayout</code> is a <a href="chap36.html#VkVideoDecodeH264PictureLayoutFlagBitsKHR">VkVideoDecodeH264PictureLayoutFlagBitsKHR</a>
value specifying the picture layout used by the H.264 video sequence to
be decoded.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264ProfileInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH264ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_PROFILE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264ProfileInfoKHR-pictureLayout-parameter" href="chap36.html#VUID-VkVideoDecodeH264ProfileInfoKHR-pictureLayout-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264ProfileInfoKHR-pictureLayout-parameter</span><br>
 If <code>pictureLayout</code> is not <code>0</code>, <code>pictureLayout</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoDecodeH264PictureLayoutFlagBitsKHR">VkVideoDecodeH264PictureLayoutFlagBitsKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The H.264 video decode picture layout flags are defined as follows:</p>
</div>
<div id="VkVideoDecodeH264PictureLayoutFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoDecodeH264PictureLayoutFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_PROGRESSIVE_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264PictureLayoutFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_PROGRESSIVE_KHR</code> specifies
support for progressive content.
This flag has the value <code>0</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>
specifies support for or use of a picture layout for interlaced content
where all lines belonging to the top field are decoded to the
even-numbered lines within the picture resource, and all lines belonging
to the bottom field are decoded to the odd-numbered lines within the
picture resource.</p>
</li>
<li>
<p><code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>
specifies support for or use of a picture layout for interlaced content
where all lines belonging to a field are grouped together in a single
image subregion, and the two fields comprising the frame <strong class="purple">can</strong> be stored
in separate image subregions of the same image subresource or in
separate image subresources.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoDecodeH264PictureLayoutFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoDecodeH264PictureLayoutFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoDecodeH264PictureLayoutFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="chap36.html#VkVideoDecodeH264PictureLayoutFlagBitsKHR">VkVideoDecodeH264PictureLayoutFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_264_decode_capabilities"><a class="anchor" href="chap36.html#_h_264_decode_capabilities"></a>36.12.4. H.264 Decode Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="chap36.html#decode-h264-profile">H.264 decode profile</a>, the
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include a
<code>VkVideoDecodeH264CapabilitiesKHR</code> structure that will be filled with
the profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH264CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH264CapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>         <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                   <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoH264LevelIdc</span>    <span class="n">maxLevelIdc</span><span class="p">;</span>
    <span class="n">VkOffset2D</span>              <span class="n">fieldOffsetGranularity</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264CapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH264LevelIdc</code> value indicating the
maximum H.264 level supported by the profile, where enum constant
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
<li>
<p><code>fieldOffsetGranularity</code> is the minimum alignment for
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a>::<code>codedOffset</code> specified for a
<a href="chap36.html#video-picture-resources">video picture resource</a> when using the
picture layout
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264CapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH264CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="decode-h264-parameter-sets"><a class="anchor" href="chap36.html#decode-h264-parameter-sets"></a>36.12.5. H.264 Decode Parameter Sets</h4>
<div class="paragraph">
<p><a href="chap36.html#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>
<strong class="purple">can</strong> contain the following types of parameters:</p>
</div>
<div class="paragraph">
<p><a id="decode-h264-sps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.264 Sequence Parameter Sets (SPS)</dt>
<dd>
<p>Represented by <code>StdVideoH264SequenceParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p><code>seq_parameter_set_id</code> is used as the key of the SPS entry;</p>
</li>
<li>
<p><code>level_idc</code> is one of the enum constants
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.seq_scaling_matrix_present_flag</code> is set, then the
<code>StdVideoH264ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>scaling_list_present_mask</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>seq_scaling_list_present_flag[i]</code> as defined in section
7.4.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>use_default_scaling_matrix_mask</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>UseDefaultScalingMatrix4x4Flag[i]</code>, when <span class="eq">i
&lt; 6</span>, or corresponds to <code>UseDefaultScalingMatrix8x8Flag[i-6]</code>,
otherwise, as defined in section 7.3.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p><code>ScalingList4x4</code> and <code>ScalingList8x8</code> correspond to the
identically named syntax elements defined in section 7.3.2.1 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vui_parameters_present_flag</code> is set, then
<code>pSequenceParameterSetVui</code> is a pointer to a
<code>StdVideoH264SequenceParameterSetVui</code> structure that is interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> or
<code>flags.vcl_hrd_parameters_present_flag</code> is set, then the
<code>StdVideoH264HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoH264HrdParameters</code> are interpreted as
defined in section E.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264SequenceParameterSetVui</code> are
interpreted as defined in section E.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264SequenceParameterSet</code> are
interpreted as defined in section 7.4.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="decode-h264-pps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.264 Picture Parameter Sets (PPS)</dt>
<dd>
<p>Represented by <code>StdVideoH264PictureParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p>the pair constructed from <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code> is used as the key of the PPS entry;</p>
</li>
<li>
<p>if <code>flags.pic_scaling_matrix_present_flag</code> is set, then the
<code>StdVideoH264ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>scaling_list_present_mask</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>pic_scaling_list_present_flag[i]</code> as defined in section
7.4.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>use_default_scaling_matrix_mask</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>UseDefaultScalingMatrix4x4Flag[i]</code>, when <span class="eq">i
&lt; 6</span>, or corresponds to <code>UseDefaultScalingMatrix8x8Flag[i-6]</code>,
otherwise, as defined in section 7.3.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p><code>ScalingList4x4</code> and <code>ScalingList8x8</code> correspond to the
identically named syntax elements defined in section 7.3.2.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264PictureParameterSet</code> are
interpreted as defined in section 7.4.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="chap36.html#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, the
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include
a <code>VkVideoDecodeH264SessionParametersCreateInfoKHR</code> structure specifying
the capacity and initial contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH264SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoDecodeH264SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH264SessionParametersCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                        <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                            <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdSPSCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoDecodeH264SessionParametersAddInfoKHR</span><span class="o">*</span>    <span class="n">pParametersAddInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264SessionParametersCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of <a href="chap36.html#decode-h264-sps">H.264
SPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of <a href="chap36.html#decode-h264-pps">H.264
PPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure specifying
H.264 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoDecodeH264SessionParametersAddInfoKHR">VkVideoDecodeH264SessionParametersAddInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH264SessionParametersAddInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoDecodeH264SessionParametersAddInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH264SessionParametersAddInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                            <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdSPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH264SequenceParameterSet</span><span class="o">*</span>    <span class="n">pStdSPSs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH264PictureParameterSet</span><span class="o">*</span>     <span class="n">pStdPPSs</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264SessionParametersAddInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of elements in the <code>pStdSPSs</code> array.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH264SequenceParameterSet</code> structures describing the
<a href="chap36.html#decode-h264-sps">H.264 SPS</a> entries to add.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of elements in the <code>pStdPPSs</code> array.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH264PictureParameterSet</code> structures describing the
<a href="chap36.html#decode-h264-pps">H.264 PPS</a> entries to add.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH264SessionParametersCreateInfoKHR">VkVideoDecodeH264SessionParametersCreateInfoKHR</a> structure
specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> used to create a
<a href="chap36.html#video-session-parameters">video session parameters</a> object.
In this case, if the video codec operation the video session parameters
object is created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then it defines the
set of initial parameters to add to the created object (see
<a href="chap36.html#creating-video-session-parameters">Creating Video Session
Parameters</a>).</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a>.
In this case, if the video codec operation the
<a href="chap36.html#video-session-parameters">video session parameters</a> object to be
updated was created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, then it defines the
set of parameters to add to it (see
<a href="chap36.html#video-session-parameters-update">Updating Video Session Parameters</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04825" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04825"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04825</span><br>

The <code>seq_parameter_set_id</code> member of each
<code>StdVideoH264SequenceParameterSet</code> structure specified in the
elements of <code>pStdSPSs</code> <strong class="purple">must</strong> be unique within <code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04826" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04826"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-None-04826</span><br>

The pair constructed from the <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code> members of each
<code>StdVideoH264PictureParameterSet</code> structure specified in the elements
of <code>pStdPPSs</code> <strong class="purple">must</strong> be unique within <code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_SESSION_PARAMETERS_ADD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, <code>pStdSPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH264SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter" href="chap36.html#VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, <code>pStdPPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH264PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_264_decoding_parameters"><a class="anchor" href="chap36.html#_h_264_decoding_parameters"></a>36.12.6. H.264 Decoding Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH264PictureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH264PictureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                             <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoDecodeH264PictureInfo</span><span class="o">*</span>    <span class="n">pStdPictureInfo</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">sliceCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span>                         <span class="n">pSliceOffsets</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264PictureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoDecodeH264PictureInfo</code> structure specifying
<a href="chap36.html#decode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p><code>sliceCount</code> is the number of elements in <code>pSliceOffsets</code>.</p>
</li>
<li>
<p><code>pSliceOffsets</code> is a pointer to an array of <code>sliceCount</code> offsets
specifying the start offset of the slices of the picture within the
video bitstream buffer range specified in <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="chap36.html#decode-h264">H.264
decode operation</a>.</p>
</div>
<div id="decode-h264-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a>,
the information related to the <a href="chap36.html#decode-output-picture-info">decode output
picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.field_pic_flag</code> is not set, then the
picture represents a frame.</p>
</li>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.field_pic_flag</code> is set, then the picture
represents a field.
Specifically:</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.bottom_field_flag</code> is not set, then the
picture represents the top field of the frame.</p>
</li>
<li>
<p>If <code>pStdPictureInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture represents the bottom field of the frame.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-h264-picture-data-access">H.264 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decode output picture is associated with the
<a href="chap36.html#decode-h264-picture-info">H.264 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h264-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH264PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p><code>flags.is_intra</code> as defined in section 3.73 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.is_reference</code> as defined in section 3.136 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.complementary_field_pair</code> as defined in section 3.35 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> are used to
identify the active parameter sets, as described below;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 7.4.3 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h264-ref-pic-setup" class="paragraph">
<p>Reference picture setup is controlled by the value of
<code>StdVideoDecodeH264PictureInfo</code>::<code>flags.is_reference</code>.
If it is set and a <a href="chap36.html#decode-reconstructed-picture-info">reconstructed
picture</a> is specified, then the latter is used as the target of picture
reconstruction to <a href="chap36.html#dpb-slot-states">activate</a> the <a href="chap36.html#dpb-slot">DPB slot</a>
specified in <code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.
If <code>StdVideoDecodeH264PictureInfo</code>::<code>flags.is_reference</code> is not set,
but a <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a> is
specified, then the corresponding picture reference associated with the
<a href="chap36.html#dpb-slot">DPB slot</a> is invalidated, as described in the
<a href="chap36.html#dpb-slot-states">DPB Slot States</a> section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH264PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are used to select the active parameter sets to use
from the bound video session parameters object, as follows:</p>
<div class="ulist">
<ul>
<li>
<p><a id="decode-h264-active-sps"></a> The <em>active SPS</em> is the
<a href="chap36.html#decode-h264-sps">SPS</a> identified by the key specified in
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="decode-h264-active-pps"></a> The <em>active PPS</em> is the
<a href="chap36.html#decode-h264-pps">PPS</a> identified by the key specified by the pair
constructed from
<code>StdVideoDecodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> and
<code>StdVideoDecodeH264PictureInfo</code>::<code>pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH264PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-pStdPictureInfo-parameter" href="chap36.html#VUID-VkVideoDecodeH264PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoDecodeH264PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-pSliceOffsets-parameter" href="chap36.html#VUID-VkVideoDecodeH264PictureInfoKHR-pSliceOffsets-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-pSliceOffsets-parameter</span><br>
 <code>pSliceOffsets</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>sliceCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264PictureInfoKHR-sliceCount-arraylength" href="chap36.html#VUID-VkVideoDecodeH264PictureInfoKHR-sliceCount-arraylength"></a> <span class="vuid">VUID-VkVideoDecodeH264PictureInfoKHR-sliceCount-arraylength</span><br>
 <code>sliceCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH264DpbSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH264DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH264DpbSlotInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                               <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoDecodeH264ReferenceInfo</span><span class="o">*</span>    <span class="n">pStdReferenceInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH264DpbSlotInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoDecodeH264ReferenceInfo</code> structure specifying
<a href="chap36.html#decode-h264-reference-info">H.264 reference information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="chap36.html#decode-h264">H.264
decode operation</a>.</p>
</div>
<div id="decode-h264-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>, one or two elements are
added to the list of <a href="chap36.html#decode-active-reference-picture-info">active reference
pictures</a> used by the video decode operation for each element of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If neither <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> nor
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture is added as a frame reference to the list of active reference
pictures.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set, then the
picture is added as a top field reference to the list of active
reference pictures.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture is added as a bottom field reference to the list of active
reference pictures.</p>
</li>
<li>
<p>For each added reference picture, the corresponding image subregion used
is determined according to the <a href="chap36.html#decode-h264-picture-data-access">H.264
Decode Picture Data Access</a> section.</p>
</li>
<li>
<p>Each added reference picture is associated with the <a href="chap36.html#dpb-slot">DPB
slot</a> index specified in the <code>slotIndex</code> member of the
corresponding element of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>Each added reference picture is associated with the
<a href="chap36.html#decode-h264-reference-info">H.264 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When both the top and bottom field of an interlaced frame currently
associated with a DPB slot is intended to be used as an active reference
picture and both fields are stored in the same image subregion (which is the
case when using
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_INTERLEAVED_LINES_BIT_KHR</code>
which stores the two fields at even and odd scanlines of the same image
subregion), both references have to be provided through a single
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure that has both
<code>flags.top_field_flag</code> and <code>flags.bottom_field_flag</code> set in the
<code>StdVideoDecodeH264ReferenceInfo</code> structure pointed to by the
<code>pStdReferenceInfo</code> member of the <a href="chap36.html#VkVideoDecodeH264DpbSlotInfoKHR">VkVideoDecodeH264DpbSlotInfoKHR</a>
structure included in the corresponding <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>
structure’s <code>pNext</code> chain.
However, this approach can only be used when both fields are stored in the
same image subregion.
If that is not the case (e.g. when using
<code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code>
which requires separate <code>codedOffset</code> values for the two fields and also
allows storing the two fields of a frame in separate image layers or
entirely separate images), then a separate <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>
structure needs to be provided for referencing the two fields, each only
setting one of <code>flags.top_field_flag</code> or <code>flags.bottom_field_flag</code>,
and providing the appropriate video picture resource information in
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a>::<code>pPictureResource</code>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="decode-h264-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>If neither <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> nor
<code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture represents a frame.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.top_field_flag</code> is set, then the
picture represents a field, specifically, the top field of the frame.</p>
</li>
<li>
<p>If <code>pStdReferenceInfo-&gt;flags.bottom_field_flag</code> is set, then the
picture represents a field, specifically, the bottom field of the frame.</p>
</li>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-h264-picture-data-access">H.264 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>If <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a> is requested, then
the reconstructed picture is used to <a href="chap36.html#dpb-slot-states">activate</a> the
<a href="chap36.html#dpb-slot">DPB slot</a> with the index specified in
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="chap36.html#decode-h264-reference-info">H.264 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h264-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH264ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.top_field_flag</code> is used to indicate whether the reference is
used as top field reference;</p>
</li>
<li>
<p><code>flags.bottom_field_flag</code> is used to indicate whether the reference
is used as bottom field reference;</p>
</li>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as “used for long-term reference” as defined in
section 8.2.5.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.is_non_existing</code> is used to indicate whether the picture is
marked as “non-existing” as defined in section 8.2.5.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH264DpbSlotInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH264DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH264DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H264_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="chap36.html#VUID-VkVideoDecodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoDecodeH264ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="decode-h264-requirements"><a class="anchor" href="chap36.html#decode-h264-requirements"></a>36.12.7. H.264 Decode Requirements</h4>
<div class="paragraph">
<p>This section describes the <strong class="purple">required</strong> H.264 decoding capabilities for
physical devices that have at least one queue family that supports the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H264_BIT_KHR</code>, as
returned by <a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="chap5.html#VkQueueFamilyVideoPropertiesKHR">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. Required <a href="chap36.html#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_h264std_decode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. Required Video Capabilities</caption>
<colgroup>
<col style="width: 58.3333%;">
<col style="width: 23.3333%;">
<col style="width: 18.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Capability</th>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Requirement Type<sup>1</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferOffsetAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferSizeAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pictureAccessGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxDpbSlots</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxActiveReferencePictures</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> or
                <code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoDecodeH264CapabilitiesKHR">VkVideoDecodeH264CapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxLevelIdc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STD_VIDEO_H264_LEVEL_IDC_1_0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fieldOffsetGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(0,0) except for profiles using <code>VK_VIDEO_DECODE_H264_PICTURE_LAYOUT_INTERLACED_SEPARATE_PLANES_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The <strong>Requirement Type</strong> column specifies the requirement is either the
minimum value all implementations <strong class="purple">must</strong> support, the maximum value all
implementations <strong class="purple">must</strong> support, or the exact value all implementations
<strong class="purple">must</strong> support.
For bitmasks a minimum value is the least bits all implementations <strong class="purple">must</strong>
set, but they <strong class="purple">may</strong> have additional bits set beyond this minimum.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-h265"><a class="anchor" href="chap36.html#decode-h265"></a>36.13. H.265 Decode Operations</h3>
<div class="paragraph">
<p>Video decode operations using an <a href="chap36.html#decode-h265-profile">H.265 decode
profile</a> <strong class="purple">can</strong> be used to decode elementary video stream sequences compliant
to the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="chap1.html">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="chap36.html#decode-operation-steps">video
decode operation steps</a> with the codec-specific semantics defined in
section 8 of <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoH265VideoParameterSet</code> structure corresponding to the
<a href="chap36.html#decode-h265-active-vps">active VPS</a> specifying the <a href="chap36.html#decode-h265-vps">H.265 video parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH265SequenceParameterSet</code> structure corresponding to
the <a href="chap36.html#decode-h265-active-sps">active SPS</a> specifying the
<a href="chap36.html#decode-h265-sps">H.265 sequence parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH265PictureParameterSet</code> structure corresponding to the
<a href="chap36.html#decode-h265-active-pps">active PPS</a> specifying the <a href="chap36.html#decode-h265-pps">H.265 picture parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH265PictureInfo</code> structure specifying the
<a href="chap36.html#decode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeH265ReferenceInfo</code> structures specifying the
<a href="chap36.html#decode-h265-reference-info">H.265 reference information</a>
corresponding to the optional <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> and any <a href="chap36.html#active-reference-pictures">active reference
pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The contents of the provided video bitstream buffer range are
interpreted as defined in the <a href="chap36.html#decode-h265-bitstream-data-access">H.265
Decode Bitstream Data Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="chap36.html#video-picture-resources">video picture resources</a>
corresponding to the used <a href="chap36.html#decode-h265-active-reference-picture-info">active reference pictures</a>, <a href="chap36.html#decode-h265-output-picture-info">decode
output picture</a>, and optional <a href="chap36.html#decode-h265-reconstructed-picture-info">reconstructed picture</a> is accessed as defined in the
<a href="chap36.html#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a> is made
according to the parameters specified in the
<a href="chap36.html#decode-h265-ref-pic-setup">H.265 picture information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters and the bitstream adhere to the syntactic and semantic
requirements defined in the corresponding sections of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>, as described above, and the <a href="chap36.html#dpb-slot">DPB slots</a>
associated with the <a href="chap36.html#active-reference-pictures">active reference pictures</a>
all refer to <a href="chap36.html#dpb-slot-states">valid picture references</a>, then the video
decode operation will complete successfully.
Otherwise, the video decode operation <strong class="purple">may</strong> complete
<a href="chap36.html#decode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect3">
<h4 id="decode-h265-bitstream-data-access"><a class="anchor" href="chap36.html#decode-h265-bitstream-data-access"></a>36.13.1. H.265 Decode Bitstream Data Access</h4>
<div class="paragraph">
<p>The video bitstream buffer range <strong class="purple">should</strong> contain a VCL NAL unit comprised of
the slice segment headers and data of a picture representing a frame, as
defined in sections 7.3.6 and 7.3.8, and this data is interpreted as defined
in sections 7.4.7 and 7.4.9 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>The offsets provided in
<a href="chap36.html#VkVideoDecodeH265PictureInfoKHR">VkVideoDecodeH265PictureInfoKHR</a>::<code>pSliceSegmentOffsets</code> <strong class="purple">should</strong>
specify the starting offsets corresponding to each slice segment header
within the video bitstream buffer range.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-h265-picture-data-access"><a class="anchor" href="chap36.html#decode-h265-picture-data-access"></a>36.13.2. H.265 Decode Picture Data Access</h4>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="chap36.html#video-profiles">video profile</a>.
Accordingly, the complete image subregion of a
<a href="chap36.html#decode-output-picture">decode output picture</a>,
<a href="chap36.html#reference-picture">reference picture</a>, or
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> accessed by video coding
operations using an <a href="chap36.html#decode-h265-profile">H.265 decode profile</a> is defined
as the set of texels within the coordinate range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([0,<code>endX</code>),[0,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>codedExtent.width</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.width</code> and
clamped to the width of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>codedExtent.height</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.height</code> and
clamped to the height of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedExtent</code> is the member of the
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>In case of video decode operations using an <a href="chap36.html#decode-h265-profile">H.265
decode profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>, is an access to the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-h265-profile"><a class="anchor" href="chap36.html#decode-h265-profile"></a>36.13.3. H.265 Decode Profile</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting H.265 video decode operations is specified by
setting <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code> and adding a
<code>VkVideoDecodeH265ProfileInfoKHR</code> structure to the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH265ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH265ProfileInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoH265ProfileIdc</span>    <span class="n">stdProfileIdc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH265ProfileInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH265ProfileIdc</code> value specifying
the H.265 codec profile IDC, as defined in section A.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265ProfileInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH265ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_PROFILE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_265_decode_capabilities"><a class="anchor" href="chap36.html#_h_265_decode_capabilities"></a>36.13.4. H.265 Decode Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="chap36.html#decode-h265-profile">H.265 decode profile</a>, the
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include a
<code>VkVideoDecodeH265CapabilitiesKHR</code> structure that will be filled with
the profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH265CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH265CapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>         <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                   <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoH265LevelIdc</span>    <span class="n">maxLevelIdc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH265CapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH265LevelIdc</code> value indicating the
maximum H.265 level supported by the profile, where enum constant
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265CapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH265CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="decode-h265-parameter-sets"><a class="anchor" href="chap36.html#decode-h265-parameter-sets"></a>36.13.5. H.265 Decode Parameter Sets</h4>
<div class="paragraph">
<p><a href="chap36.html#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>
<strong class="purple">can</strong> contain the following types of parameters:</p>
</div>
<div class="paragraph">
<p><a id="decode-h265-vps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.265 Video Parameter Sets (VPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265VideoParameterSet</code> structures and interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>vps_video_parameter_set_id</code> is used as the key of the VPS entry;</p>
</li>
<li>
<p>the <code>max_latency_increase_plus1</code>, <code>max_dec_pic_buffering_minus1</code>,
and <code>max_num_reorder_pics</code> members of the
<code>StdVideoH265DecPicBufMgr</code> structure pointed to by <code>pDecPicBufMgr</code>
correspond to <code>vps_max_latency_increase_plus1</code>,
<code>vps_max_dec_pic_buffering_minus1</code>, and <code>vps_max_num_reorder_pics</code>,
respectively, as defined in section 7.4.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>the <code>StdVideoH265HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_general_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_general_flag[i]</code> as defined in
section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_within_cvs_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_within_cvs_flag[i]</code> as defined
in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.low_delay_hrd_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>low_delay_hrd_flag[i]</code> as defined in section E.3.2 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersNal</code> is a pointer to an array of
<span class="eq"><code>vps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>vps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265VideoParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vcl_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersVcl</code> is a pointer to an array of
<span class="eq"><code>vps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>vps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265VideoParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265HrdParameters</code> are interpreted as
defined in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>StdVideoH265ProfileTierLevel</code> structure pointed to by
<code>pProfileTierLevel</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>general_level_idc</code> is one of the enum constants
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ProfileTierLevel</code> are interpreted
as defined in section 7.4.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265VideoParameterSet</code> are interpreted
as defined in section 7.4.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="decode-h265-sps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.265 Sequence Parameter Sets (SPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265SequenceParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p>the pair constructed from <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code> is used as the key of the SPS entry;</p>
</li>
<li>
<p>the <code>StdVideoH265ProfileTierLevel</code> structure pointed to by
<code>pProfileTierLevel</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>general_level_idc</code> is one of the enum constants
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ProfileTierLevel</code> are interpreted
as defined in section 7.4.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>max_latency_increase_plus1</code>, <code>max_dec_pic_buffering_minus1</code>,
and <code>max_num_reorder_pics</code> members of the
<code>StdVideoH265DecPicBufMgr</code> structure pointed to by <code>pDecPicBufMgr</code>
correspond to <code>sps_max_latency_increase_plus1</code>,
<code>sps_max_dec_pic_buffering_minus1</code>, and <code>sps_max_num_reorder_pics</code>,
respectively, as defined in section 7.4.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.sps_scaling_list_data_present_flag</code> is set, then the
<code>StdVideoH265ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ScalingList4x4</code>, <code>ScalingList8x8</code>, <code>ScalingList16x16</code>, and
<code>ScalingList32x32</code> correspond to <code>ScalingList[0]</code>, <code>ScalingList[1]</code>,
<code>ScalingList[2]</code>, and <code>ScalingList[3]</code>, respectively, as defined in
section 7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>ScalingListDCCoef16x16</code> and <code>ScalingListDCCoef32x32</code> correspond
to <code>scaling_list_dc_coef_minus8[0]</code> and
<code>scaling_list_dc_coef_minus8[1]</code>, respectively, as defined in section
7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>pShortTermRefPicSet</code> is a pointer to an array of
<code>num_short_term_ref_pic_sets</code> number of
<code>StdVideoH265ShortTermRefPicSet</code> structures where each element is
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>used_by_curr_pic_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_flag[i]</code> as defined in section 7.4.8
of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>use_delta_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>use_delta_flag[i]</code> as defined in section 7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>used_by_curr_pic_s0_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_s0_flag[i]</code> as defined in section
7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>used_by_curr_pic_s1_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_s1_flag[i]</code> as defined in section
7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ShortTermRefPicSet</code> are
interpreted as defined in section 7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.long_term_ref_pics_present_flag</code> is set then the
<code>StdVideoH265LongTermRefPicsSps</code> structure pointed to by
<code>pLongTermRefPicsSps</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>used_by_curr_pic_lt_sps_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_lt_sps_flag[i]</code> as defined in section
7.4.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265LongTermRefPicsSps</code> are
interpreted as defined in section 7.4.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vui_parameters_present_flag</code> is set, then the
<code>StdVideoH265SequenceParameterSetVui</code> structure pointed to by
<code>pSequenceParameterSetVui</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p>the <code>StdVideoH265HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.fixed_pic_rate_general_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_general_flag[i]</code> as defined in
section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_within_cvs_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_within_cvs_flag[i]</code> as defined
in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.low_delay_hrd_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>low_delay_hrd_flag[i]</code> as defined in section E.3.2 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersNal</code> is a pointer to an array of
<span class="eq"><code>sps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>sps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265SequenceParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vcl_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersVcl</code> is a pointer to an array of
<span class="eq"><code>sps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>sps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265SequenceParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265HrdParameters</code> are interpreted as
defined in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>pSequenceParameterSetVui</code> are interpreted as
defined in section E.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.sps_palette_predictor_initializer_present_flag</code> is set,
then the <code>PredictorPaletteEntries</code> member of the
<code>StdVideoH265PredictorPaletteEntries</code> structure pointed to by
<code>pPredictorPaletteEntries</code> is interpreted as defined in section
7.4.9.13 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265SequenceParameterSet</code> are
interpreted as defined in section 7.4.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="decode-h265-pps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.265 Picture Parameter Sets (PPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265PictureParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p>the triplet constructed from <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code> is used
as the key of the PPS entry;</p>
</li>
<li>
<p>if <code>flags.pps_scaling_list_data_present_flag</code> is set, then the
<code>StdVideoH265ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ScalingList4x4</code>, <code>ScalingList8x8</code>, <code>ScalingList16x16</code>, and
<code>ScalingList32x32</code> correspond to <code>ScalingList[0]</code>, <code>ScalingList[1]</code>,
<code>ScalingList[2]</code>, and <code>ScalingList[3]</code>, respectively, as defined in
section 7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>ScalingListDCCoef16x16</code> and <code>ScalingListDCCoef32x32</code> correspond
to <code>scaling_list_dc_coef_minus8[0]</code> and
<code>scaling_list_dc_coef_minus8[1]</code>, respectively, as defined in section
7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.pps_palette_predictor_initializer_present_flag</code> is set,
then the <code>PredictorPaletteEntries</code> member of the
<code>StdVideoH265PredictorPaletteEntries</code> structure pointed to by
<code>pPredictorPaletteEntries</code> is interpreted as defined in section
7.4.9.13 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265PictureParameterSet</code> are
interpreted as defined in section 7.4.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="chap36.html#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, the
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include
a <code>VkVideoDecodeH265SessionParametersCreateInfoKHR</code> structure specifying
the capacity and initial contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeH265SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoDecodeH265SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH265SessionParametersCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                        <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                            <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdVPSCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdSPSCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoDecodeH265SessionParametersAddInfoKHR</span><span class="o">*</span>    <span class="n">pParametersAddInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH265SessionParametersCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdVPSCount</code> is the maximum number of <a href="chap36.html#decode-h265-vps">H.265
VPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of <a href="chap36.html#decode-h265-sps">H.265
SPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of <a href="chap36.html#decode-h265-pps">H.265
PPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure specifying
H.265 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoDecodeH265SessionParametersAddInfoKHR">VkVideoDecodeH265SessionParametersAddInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH265SessionParametersAddInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoDecodeH265SessionParametersAddInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH265SessionParametersAddInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                            <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdVPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH265VideoParameterSet</span><span class="o">*</span>       <span class="n">pStdVPSs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdSPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH265SequenceParameterSet</span><span class="o">*</span>    <span class="n">pStdSPSs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH265PictureParameterSet</span><span class="o">*</span>     <span class="n">pStdPPSs</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH265SessionParametersAddInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdVPSCount</code> is the number of elements in the <code>pStdVPSs</code> array.</p>
</li>
<li>
<p><code>pStdVPSs</code> is a pointer to an array of
<code>StdVideoH265VideoParameterSet</code> structures describing the
<a href="chap36.html#decode-h265-vps">H.265 VPS</a> entries to add.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of elements in the <code>pStdSPSs</code> array.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH265SequenceParameterSet</code> structures describing the
<a href="chap36.html#decode-h265-sps">H.265 SPS</a> entries to add.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of elements in the <code>pStdPPSs</code> array.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH265PictureParameterSet</code> structures describing the
<a href="chap36.html#decode-h265-pps">H.265 PPS</a> entries to add.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoDecodeH265SessionParametersCreateInfoKHR">VkVideoDecodeH265SessionParametersCreateInfoKHR</a> structure
specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> used to create a
<a href="chap36.html#video-session-parameters">video session parameters</a> object.
In this case, if the video codec operation the video session parameters
object is created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then it defines the
set of initial parameters to add to the created object (see
<a href="chap36.html#creating-video-session-parameters">Creating Video Session
Parameters</a>).</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a>.
In this case, if the video codec operation the
<a href="chap36.html#video-session-parameters">video session parameters</a> object to be
updated was created with is
<code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, then it defines the
set of parameters to add to it (see
<a href="chap36.html#video-session-parameters-update">Updating Video Session Parameters</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04833" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04833"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04833</span><br>

The <code>vps_video_parameter_set_id</code> member of each
<code>StdVideoH265VideoParameterSet</code> structure specified in the elements
of <code>pStdVPSs</code> <strong class="purple">must</strong> be unique within <code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04834" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04834"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04834</span><br>

The pair constructed from the <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code> members of each
<code>StdVideoH265SequenceParameterSet</code> structure specified in the
elements of <code>pStdSPSs</code> <strong class="purple">must</strong> be unique within <code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04835" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04835"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-None-04835</span><br>

The triplet constructed from the <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code>
members of each <code>StdVideoH265PictureParameterSet</code> structure specified
in the elements of <code>pStdPPSs</code> <strong class="purple">must</strong> be unique within <code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_SESSION_PARAMETERS_ADD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter</span><br>
 If <code>stdVPSCount</code> is not <code>0</code>, <code>pStdVPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdVPSCount</code> <code>StdVideoH265VideoParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, <code>pStdSPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH265SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter" href="chap36.html#VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, <code>pStdPPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH265PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_265_decoding_parameters"><a class="anchor" href="chap36.html#_h_265_decoding_parameters"></a>36.13.6. H.265 Decoding Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH265PictureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH265PictureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                             <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoDecodeH265PictureInfo</span><span class="o">*</span>    <span class="n">pStdPictureInfo</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">sliceSegmentCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span>                         <span class="n">pSliceSegmentOffsets</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH265PictureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoDecodeH265PictureInfo</code> structure specifying
<a href="chap36.html#decode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p><code>sliceSegmentCount</code> is the number of elements in
<code>pSliceSegmentOffsets</code>.</p>
</li>
<li>
<p><code>pSliceSegmentOffsets</code> is a pointer to an array of
<code>sliceSegmentCount</code> offsets specifying the start offset of the slice
segments of the picture within the video bitstream buffer range
specified in <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="chap36.html#decode-h265">H.265
decode operation</a>.</p>
</div>
<div id="decode-h265-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a>,
the information related to the <a href="chap36.html#decode-output-picture-info">decode output
picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decode output picture is associated with the
<a href="chap36.html#decode-h265-picture-info">H.265 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH265PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.IrapPicFlag</code> as defined in section 3.73 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.IdrPicFlag</code> as defined in section 3.67 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.IsReference</code> as defined in section 3.132 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> are used to identify the active parameter
sets, as described below;</p>
</li>
<li>
<p><code>PicOrderCntVal</code> as defined in section 8.3.1 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>NumBitsForSTRefPicSetInSlice</code> is the number of bits used in
<code>st_ref_pic_set</code> when <code>short_term_ref_pic_set_sps_flag</code> is <code>0</code>, or <code>0</code>
otherwise, as defined in sections 7.4.7 and 7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>NumDeltaPocsOfRefRpsIdx</code> is the value of <code>NumDeltaPocs[RefRpsIdx]</code>
when <code>short_term_ref_pic_set_sps_flag</code> is <code>1</code>, or <code>0</code> otherwise, as
defined in sections 7.4.7 and 7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
<li>
<p><code>RefPicSetStCurrBefore</code>, <code>RefPicSetStCurrAfter</code>, and
<code>RefPicSetLtCurr</code> are interpreted as defined in section 8.3.2 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a> where each element of these
arrays either identifies an
<a href="chap36.html#decode-active-reference-picture-info">active reference picture</a> using
its <a href="chap36.html#dpb-slot">DPB slot</a> index or contains the value
<code>STD_VIDEO_H265_NO_REFERENCE_PICTURE</code> to indicate “no reference
picture”;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.3.2 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-ref-pic-setup" class="paragraph">
<p>Reference picture setup is controlled by the value of
<code>StdVideoDecodeH265PictureInfo</code>::<code>flags.IsReference</code>.
If it is set and a <a href="chap36.html#decode-reconstructed-picture-info">reconstructed
picture</a> is specified, then the latter is used as the target of picture
reconstruction to <a href="chap36.html#dpb-slot-states">activate</a> the corresponding
<a href="chap36.html#dpb-slot">DPB slot</a>.
If <code>StdVideoDecodeH265PictureInfo</code>::<code>flags.IsReference</code> is not set,
but a <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a> is
specified, then the corresponding picture reference associated with the
<a href="chap36.html#dpb-slot">DPB slot</a> is invalidated, as described in the
<a href="chap36.html#dpb-slot-states">DPB Slot States</a> section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH265PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are used to select the active parameter sets to use
from the bound video session parameters object, as follows:</p>
<div class="ulist">
<ul>
<li>
<p><a id="decode-h265-active-vps"></a> The <em>active VPS</em> is the
<a href="chap36.html#decode-h265-vps">VPS</a> identified by the key specified in
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="decode-h265-active-sps"></a> The <em>active SPS</em> is the
<a href="chap36.html#decode-h265-sps">SPS</a> identified by the key specified by the pair
constructed from
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code> and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="decode-h265-active-pps"></a> The <em>active PPS</em> is the
<a href="chap36.html#decode-h265-pps">PPS</a> identified by the key specified by the triplet
constructed from
<code>StdVideoDecodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>,
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>, and
<code>StdVideoDecodeH265PictureInfo</code>::<code>pps_pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH265PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-pStdPictureInfo-parameter" href="chap36.html#VUID-VkVideoDecodeH265PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoDecodeH265PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-pSliceSegmentOffsets-parameter" href="chap36.html#VUID-VkVideoDecodeH265PictureInfoKHR-pSliceSegmentOffsets-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-pSliceSegmentOffsets-parameter</span><br>
 <code>pSliceSegmentOffsets</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>sliceSegmentCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265PictureInfoKHR-sliceSegmentCount-arraylength" href="chap36.html#VUID-VkVideoDecodeH265PictureInfoKHR-sliceSegmentCount-arraylength"></a> <span class="vuid">VUID-VkVideoDecodeH265PictureInfoKHR-sliceSegmentCount-arraylength</span><br>
 <code>sliceSegmentCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeH265DpbSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeH265DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeH265DpbSlotInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                               <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoDecodeH265ReferenceInfo</span><span class="o">*</span>    <span class="n">pStdReferenceInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeH265DpbSlotInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoDecodeH265ReferenceInfo</code> structure specifying reference
picture information described in section 8.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="chap36.html#decode-h265">H.265
decode operation</a>.</p>
</div>
<div id="decode-h265-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>, one element is added to
the list of <a href="chap36.html#decode-active-reference-picture-info">active reference
pictures</a> used by the video decode operation for each element of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reference picture is associated with the <a href="chap36.html#dpb-slot">DPB slot</a> index
specified in the <code>slotIndex</code> member of the corresponding element of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>The reference picture is associated with the
<a href="chap36.html#decode-h265-reference-info">H.265 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-h265-picture-data-access">H.265 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>If <a href="chap36.html#decode-h265-ref-pic-setup">reference picture setup</a> is requested,
then the reconstructed picture is used to <a href="chap36.html#dpb-slot-states">activate</a>
the <a href="chap36.html#dpb-slot">DPB slot</a> with the index specified in
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="chap36.html#decode-h265-reference-info">H.265 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-h265-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeH265ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as “used for long-term reference” as defined in
section 8.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.unused_for_reference</code> is used to indicate whether the picture
is marked as “unused for reference” as defined in section 8.3.2 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeH265DpbSlotInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeH265DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeH265DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_H265_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="chap36.html#VUID-VkVideoDecodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoDecodeH265ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="decode-h265-requirements"><a class="anchor" href="chap36.html#decode-h265-requirements"></a>36.13.7. H.265 Decode Requirements</h4>
<div class="paragraph">
<p>This section describes the <strong class="purple">required</strong> H.265 decoding capabilities for
physical devices that have at least one queue family that supports the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_H265_BIT_KHR</code>, as
returned by <a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="chap5.html#VkQueueFamilyVideoPropertiesKHR">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. Required <a href="chap36.html#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_h265std_decode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. Required Video Capabilities</caption>
<colgroup>
<col style="width: 58.3333%;">
<col style="width: 23.3333%;">
<col style="width: 18.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Capability</th>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Requirement Type<sup>1</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferOffsetAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferSizeAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pictureAccessGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxDpbSlots</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxActiveReferencePictures</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> or
                <code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoDecodeH265CapabilitiesKHR">VkVideoDecodeH265CapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxLevelIdc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STD_VIDEO_H265_LEVEL_IDC_1_0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The <strong>Requirement Type</strong> column specifies the requirement is either the
minimum value all implementations <strong class="purple">must</strong> support, the maximum value all
implementations <strong class="purple">must</strong> support, or the exact value all implementations
<strong class="purple">must</strong> support.
For bitmasks a minimum value is the least bits all implementations <strong class="purple">must</strong>
set, but they <strong class="purple">may</strong> have additional bits set beyond this minimum.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="decode-av1"><a class="anchor" href="chap36.html#decode-av1"></a>36.14. AV1 Decode Operations</h3>
<div class="paragraph">
<p>Video decode operations using an <a href="chap36.html#decode-av1-profile">AV1 decode profile</a>
<strong class="purple">can</strong> be used to decode elementary video stream sequences compliant with the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="chap1.html">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="chap36.html#decode-operation-steps">video
decode operation steps</a> with the codec-specific semantics defined in
section 7 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoAV1SequenceHeader</code> structure stored in the bound video
session parameters object specifying the
<a href="chap36.html#decode-av1-active-sequence-header">active sequence header</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeAV1PictureInfo</code> structure specifying the
<a href="chap36.html#decode-av1-picture-info">AV1 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoDecodeAV1ReferenceInfo</code> structures specifying the
<a href="chap36.html#decode-av1-reference-info">AV1 reference information</a> corresponding
to the optional <a href="chap36.html#reconstructed-picture">reconstructed picture</a> and any
<a href="chap36.html#active-reference-pictures">active reference pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The contents of the provided video bitstream buffer range are
interpreted as defined in the <a href="chap36.html#decode-av1-bitstream-data-access">AV1
Decode Bitstream Data Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="chap36.html#video-picture-resources">video picture resources</a>
corresponding to the used <a href="chap36.html#decode-av1-active-reference-picture-info">active reference pictures</a>, <a href="chap36.html#decode-av1-output-picture-info">decode
output picture</a>, and optional <a href="chap36.html#decode-av1-reconstructed-picture-info">reconstructed picture</a> is accessed as defined in the
<a href="chap36.html#decode-av1-picture-data-access">AV1 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#decode-ref-pic-setup">reference picture setup</a> is made
according to the parameters specified in the
<a href="chap36.html#decode-av1-ref-pic-setup">AV1 picture information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters and the bitstream adhere to the syntactic and semantic
requirements defined in the corresponding sections of the <a href="chap2.html#aomedia-av1">AV1
Specification</a>, as described above, and the <a href="chap36.html#dpb-slot">DPB slots</a>
associated with the <a href="chap36.html#active-reference-pictures">active reference pictures</a>
all refer to <a href="chap36.html#dpb-slot-states">valid picture references</a>, then the video
decode operation will complete successfully.
Otherwise, the video decode operation <strong class="purple">may</strong> complete
<a href="chap36.html#decode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect3">
<h4 id="decode-av1-bitstream-data-access"><a class="anchor" href="chap36.html#decode-av1-bitstream-data-access"></a>36.14.1. AV1 Decode Bitstream Data Access</h4>
<div class="paragraph">
<p>The video bitstream buffer range <strong class="purple">should</strong> contain one or more frame OBUs,
comprised of a frame header OBU and tile group OBU, that together represent
an entire frame, as defined in sections 5.10, 5.9, and 5.11, and this data
is interpreted as defined in sections 6.9, 6.8, and 6.10 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>, respectively.</p>
</div>
<div class="paragraph">
<p>The offset specified in
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a>::<code>frameHeaderOffset</code> <strong class="purple">should</strong>
specify the starting offset of the frame header OBU of the frame.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When the tiles of the frame are encoded into multiple tile groups, each
frame OBU has a separate frame header OBU but their content is expected to
match per the requirements of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>.
Accordingly, the offset specified in <code>frameHeaderOffset</code> <strong class="purple">can</strong> be the
offset of any of the otherwise identical frame header OBUs when multiple
tile groups are present.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The offsets and sizes provided in
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a>::<code>pTileOffsets</code> and
<a href="chap36.html#VkVideoDecodeAV1PictureInfoKHR">VkVideoDecodeAV1PictureInfoKHR</a>::<code>pTileSizes</code>, respectively,
<strong class="purple">should</strong> specify the starting offsets and sizes corresponding to each tile
within the video bitstream buffer range.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-av1-picture-data-access"><a class="anchor" href="chap36.html#decode-av1-picture-data-access"></a>36.14.2. AV1 Decode Picture Data Access</h4>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="chap36.html#video-profiles">video profile</a>.
Accordingly, the complete image subregion of a
<a href="chap36.html#decode-output-picture">decode output picture</a>,
<a href="chap36.html#reference-picture">reference picture</a>, or
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> accessed by video coding
operations using an <a href="chap36.html#decode-av1-profile">AV1 decode profile</a> is defined as
the set of texels within the coordinate range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([0,<code>endX</code>),[0,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>codedExtent.width</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.width</code> and
clamped to the width of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>codedExtent.height</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.height</code> and
clamped to the height of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedExtent</code> is the member of the
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>In case of video decode operations using an <a href="chap36.html#decode-av1-profile">AV1 decode
profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="chap2.html#aomedia-av1">AV1
Specification</a>, is an access to the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-av1-reference-names"><a class="anchor" href="chap36.html#decode-av1-reference-names"></a>36.14.3. AV1 Reference Names and Semantics</h4>
<div class="paragraph">
<p>Individual reference frames used in the decoding process have different
semantics, as defined in section 6.10.24 of the <a href="chap2.html#aomedia-av1">AV1
Specification</a>.
The AV1 semantics associated with a reference picture are indicated by the
corresponding enumeration constant defined in the Video Std enumeration type
<code>StdVideoAV1ReferenceName</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_INTRA_FRAME</code> identifies the reference
used for intra coding (<code>INTRA_FRAME</code>), as defined in sections 2 and
7.11.2 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
</li>
<li>
<p>All other enumeration constants refer to forward or backward references
used for inter coding, as defined in sections 2 and 7.11.3 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>:</p>
<div class="ulist">
<ul>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_LAST_FRAME</code> identifies the
<code>LAST_FRAME</code> reference</p>
</li>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_LAST2_FRAME</code> identifies the
<code>LAST2_FRAME</code> reference</p>
</li>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_LAST3_FRAME</code> identifies the
<code>LAST3_FRAME</code> reference</p>
</li>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_GOLDEN_FRAME</code> identifies the
<code>GOLDEN_FRAME</code> reference</p>
</li>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_BWDREF_FRAME</code> identifies the
<code>BWDREF_FRAME</code> reference</p>
</li>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_ALTREF2_FRAME</code> identifies the
<code>ALTREF2_FRAME</code> reference</p>
</li>
<li>
<p><code>STD_VIDEO_AV1_REFERENCE_NAME_ALTREF_FRAME</code> identifies the
<code>ALTREF_FRAME</code> reference</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>These enumeration constants are not directly used in any APIs but are used
to indirectly index into certain Video Std and Vulkan API parameter arrays.</p>
</div>
</div>
<div class="sect3">
<h4 id="decode-av1-profile"><a class="anchor" href="chap36.html#decode-av1-profile"></a>36.14.4. AV1 Decode Profile</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting AV1 video decode operations is specified by
setting <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code> and adding a
<code>VkVideoDecodeAV1ProfileInfoKHR</code> structure to the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeAV1ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeAV1ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_av1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeAV1ProfileInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoAV1Profile</span>    <span class="n">stdProfile</span><span class="p">;</span>
    <span class="n">VkBool32</span>              <span class="n">filmGrainSupport</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeAV1ProfileInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfile</code> is a <code>StdVideoAV1Profile</code> value specifying the AV1
codec profile, as defined in section A.2 of the <a href="chap2.html#aomedia-av1">AV1
Specification</a>.</p>
</li>
<li>
<p><a id="decode-av1-film-grain-support"></a> <code>filmGrainSupport</code> specifies
whether AV1 film grain, as defined in section 7.8.3 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>, <strong class="purple">can</strong> be used with the video profile.
When this member is set to <code>VK_TRUE</code>, video session objects created
against the video profile will be able to decode pictures that have
<a href="chap36.html#decode-av1-film-grain">film grain</a> enabled.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Enabling <code>filmGrainSupport</code> <strong class="purple">may</strong> increase the memory requirements of
video sessions and/or video picture resources on some implementations.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeAV1ProfileInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeAV1ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeAV1ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_AV1_PROFILE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_av1_decode_capabilities"><a class="anchor" href="chap36.html#_av1_decode_capabilities"></a>36.14.5. AV1 Decode Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="chap36.html#decode-av1-profile">AV1 decode profile</a>, the
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include a
<code>VkVideoDecodeAV1CapabilitiesKHR</code> structure that will be filled with the
profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeAV1CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeAV1CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_av1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeAV1CapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>     <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoAV1Level</span>    <span class="n">maxLevel</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeAV1CapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxLevel</code> is a <code>StdVideoAV1Level</code> value specifying the maximum
AV1 level supported by the profile, as defined in section A.3 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeAV1CapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeAV1CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeAV1CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_AV1_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="decode-av1-parameter-sets"><a class="anchor" href="chap36.html#decode-av1-parameter-sets"></a>36.14.6. AV1 Decode Parameter Sets</h4>
<div class="paragraph">
<p><a href="chap36.html#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>
contain a single instance of the following parameter set:</p>
</div>
<div class="paragraph">
<p><a id="decode-av1-sequence-header"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">AV1 Sequence Header</dt>
<dd>
<p>Represented by <code>StdVideoAV1SequenceHeader</code> structures and interpreted as
follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p>the <code>StdVideoAV1ColorConfig</code> structure pointed to by
<code>pColorConfig</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1ColorConfig</code> are interpreted as
defined in section 6.4.2 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.timing_info_present_flag</code> is set, then the
<code>StdVideoAV1TimingInfo</code> structure pointed to by <code>pTimingInfo</code> is
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1TimingInfo</code> are interpreted as
defined in section 6.4.3 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoAV1SequenceHeader</code> are interpreted as
defined in section 6.4 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="chap36.html#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, the
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include
a <code>VkVideoDecodeAV1SessionParametersCreateInfoKHR</code> structure specifying
the contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoDecodeAV1SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoDecodeAV1SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_av1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeAV1SessionParametersCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                     <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                         <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoAV1SequenceHeader</span><span class="o">*</span>    <span class="n">pStdSequenceHeader</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeAV1SessionParametersCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdSequenceHeader</code> is a pointer to a
<code>StdVideoAV1SequenceHeader</code> structure describing the
<a href="chap36.html#decode-av1-sequence-header">AV1 sequence header</a> entry to store in the
created object.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As AV1 video session parameters objects will only ever contain a single AV1
sequence header, this has to be specified at object creation time and such
video session parameters objects cannot be updated using the
<a href="chap36.html#vkUpdateVideoSessionParametersKHR">vkUpdateVideoSessionParametersKHR</a> command.
When a new AV1 sequence header is decoded from the input video bitstream the
application needs to create a new video session parameters object to store
it.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeAV1SessionParametersCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeAV1SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeAV1SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_AV1_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeAV1SessionParametersCreateInfoKHR-pStdSequenceHeader-parameter" href="chap36.html#VUID-VkVideoDecodeAV1SessionParametersCreateInfoKHR-pStdSequenceHeader-parameter"></a> <span class="vuid">VUID-VkVideoDecodeAV1SessionParametersCreateInfoKHR-pStdSequenceHeader-parameter</span><br>
 <code>pStdSequenceHeader</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoAV1SequenceHeader</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_av1_decoding_parameters"><a class="anchor" href="chap36.html#_av1_decoding_parameters"></a>36.14.7. AV1 Decoding Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeAV1PictureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeAV1PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_av1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeAV1PictureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                        <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                            <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoDecodeAV1PictureInfo</span><span class="o">*</span>    <span class="n">pStdPictureInfo</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                <span class="n">referenceNameSlotIndices</span><span class="p">[</span><span class="n">VK_MAX_VIDEO_AV1_REFERENCES_PER_FRAME_KHR</span><span class="p">];</span>
    <span class="kt">uint32_t</span>                               <span class="n">frameHeaderOffset</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                               <span class="n">tileCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span>                        <span class="n">pTileOffsets</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span>                        <span class="n">pTileSizes</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeAV1PictureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoDecodeAV1PictureInfo</code> structure specifying
<a href="chap36.html#decode-av1-picture-info">AV1 picture information</a>.</p>
</li>
<li>
<p><code>referenceNameSlotIndices</code> is an array of seven
(<code>VK_MAX_VIDEO_AV1_REFERENCES_PER_FRAME_KHR</code>, which is equal to the
Video Std definition <code>STD_VIDEO_AV1_REFS_PER_FRAME</code>) signed integer
values specifying the index of the <a href="chap36.html#dpb-slot">DPB slot</a> or a negative
integer value for each <a href="chap36.html#decode-av1-reference-names">AV1 reference name</a>
used for inter coding.
In particular, the DPB slot index for the AV1 reference name <code>frame</code>
is specified in <code>referenceNameSlotIndices</code>[<code>frame</code> -
<code>STD_VIDEO_AV1_REFERENCE_NAME_LAST_FRAME</code>].</p>
</li>
<li>
<p><code>frameHeaderOffset</code> is the byte offset of the AV1 frame header OBU,
as defined in section 5.9 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>,
within the video bitstream buffer range specified in
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
<li>
<p><code>tileCount</code> is the number of elements in <code>pTileOffsets</code> and
<code>pTileSizes</code>.</p>
</li>
<li>
<p><code>pTileOffsets</code> is a pointer to an array of <code>tileCount</code> integers
specifying the byte offset of the tiles of the picture within the video
bitstream buffer range specified in <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
<li>
<p><code>pTileSizes</code> is a pointer to an array of <code>tileCount</code> integers
specifying the byte size of the tiles of the picture within the video
bitstream buffer range specified in <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="chap36.html#decode-av1">AV1
decode operation</a>.</p>
</div>
<div id="decode-av1-output-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Decode Output Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdDecodeVideoKHR">vkCmdDecodeVideoKHR</a>,
the information related to the <a href="chap36.html#decode-output-picture-info">decode output
picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-av1-picture-data-access">AV1 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The decode output picture is associated with the
<a href="chap36.html#decode-av1-picture-info">AV1 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-av1-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeAV1PictureInfo</code> structure pointed to by
<code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code>, <code>reserved1</code>, and <code>reserved2</code> are used only
for padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><a id="decode-av1-film-grain"></a> <code>flags.apply_grain</code> indicates that film
grain is enabled for the decoded picture, as defined in section 6.8.20
of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>tg_start</code> and <code>tg_end</code> are interpreted as defined in section
6.10.1 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>OrderHint</code>, <code>OrderHints</code>, and <code>expectedFrameId</code> are
interpreted as defined in section 6.8.2 of the <a href="chap2.html#aomedia-av1">AV1
Specification</a>;</p>
</li>
<li>
<p>the <code>StdVideoAV1TileInfo</code> structure pointed to by <code>pTileInfo</code> is
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>pMiColStarts</code> is a pointer to an array of <code>TileCols</code> number of
unsigned integers that corresponds to <code>MiColStarts</code> defined in
section 6.8.14 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>pMiRowStarts</code> is a pointer to an array of <code>TileRows</code> number of
unsigned integers that corresponds to <code>MiRowStarts</code> defined in
section 6.8.14 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>pWidthInSbsMinus1</code> is a pointer to an array of <code>TileCols</code> number
of unsigned integers that corresponds to <code>width_in_sbs_minus_1</code>
defined in section 6.8.14 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>pHeightInSbsMinus1</code> is a pointer to an array of <code>TileRows</code>
number of unsigned integers that corresponds to
<code>height_in_sbs_minus_1</code> defined in section 6.8.14 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1TileInfo</code> are interpreted as
defined in section 6.8.14 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>StdVideoAV1Quantization</code> structure pointed to by
<code>pQuantization</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1Quantization</code> are interpreted as
defined in section 6.8.11 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.segmentation_enabled</code> is set, then the
<code>StdVideoAV1Segmentation</code> structure pointed to by <code>pSegmentation</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p>the elements of <code>FeatureEnabled</code> are bitmasks where bit index
<span class="eq">j</span> of element <span class="eq">i</span> corresponds to <code>FeatureEnabled[i][j]</code> as
defined in section 6.8.13 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>FeatureData</code> is interpreted as defined in section 6.8.13 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>StdVideoAV1LoopFilter</code> structure pointed to by <code>pLoopFilter</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>update_ref_delta</code> is a bitmask where bit index <span class="eq">i</span> is
interpreted as the value of <code>update_ref_delta</code> corresponding to
element <span class="eq">i</span> of <code>loop_filter_ref_deltas</code> as defined in section
6.8.10 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>update_mode_delta</code> is a bitmask where bit index <span class="eq">i</span> is
interpreted as the value of <code>update_mode_delta</code> corresponding to
element <span class="eq">i</span> of <code>loop_filter_mode_deltas</code> as defined in section
6.8.10 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1LoopFilter</code> are interpreted as
defined in section 6.8.10 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.enable_cdef</code> is set in the
<a href="chap36.html#decode-av1-active-sequence-header">active sequence header</a>, then the
members of the <code>StdVideoAV1CDEF</code> structure pointed to by <code>pCDEF</code>
are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cdef_y_sec_strength</code> and <code>cdef_uv_sec_strength</code> are the
bitstream values of the corresponding syntax elements defined in
section 5.9.19 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1CDEF</code> are interpreted as defined in
section 6.10.14 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>StdVideoAV1LoopRestoration</code> structure pointed to by
<code>pLoopRestoration</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>LoopRestorationSize</code>[<code>plane</code>] is interpreted as
<span class="eq">log2(<code>size</code>) - 5</span>, where <code>size</code> is the value of
<code>LoopRestorationSize</code>[<code>plane</code>] as defined in section 6.10.15 of
the <a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1LoopRestoration</code> are defined as in
section 6.10.15 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the members of the <code>StdVideoAV1GlobalMotion</code> structure provided in
<code>global_motion</code> are interpreted as defined in section 7.10 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.film_grain_params_present</code> is set in the
<a href="chap36.html#decode-av1-active-sequence-header">active sequence header</a>, then the
<code>StdVideoAV1FilmGrain</code> structure pointed to by <code>pFilmGrain</code> is
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoAV1FilmGrain</code> are interpreted as
defined in section 6.8.20 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members are interpreted as defined in section 6.8 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When <a href="chap36.html#decode-av1-film-grain">film grain is enabled</a> for the decoded frame,
the <code>flags.update_grain</code> and <code>film_grain_params_ref_idx</code> values
specified in <code>StdVideoAV1FilmGrain</code> are ignored by AV1 decode operations
and the <code>load_grain_params</code> function, as defined in section 6.8.20 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>, is not executed.
Instead, the application is responsible for specifying the effective film
grain parameters for the frame in <code>StdVideoAV1FilmGrain</code>.</p>
</div>
<div class="paragraph">
<p>When <a href="chap36.html#decode-av1-film-grain">film grain is enabled</a> for the decoded frame,
the application is required to specify a different decode output picture
resource in <a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>dstPictureResource</code> compared to
the reconstructed picture specified in
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;pPictureResource</code> even
if the implementation does not report support for
<code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code> in
<a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a>::<code>flags</code> for the video decode
profile.</p>
</div>
<div id="decode-av1-ref-pic-setup" class="paragraph">
<p>Reference picture setup is controlled by the value of
<code>StdVideoDecodeAV1PictureInfo</code>::<code>refresh_frame_flags</code>.
If it is not zero and a <a href="chap36.html#decode-reconstructed-picture-info">reconstructed
picture</a> is specified, then the latter is used as the target of picture
reconstruction to <a href="chap36.html#dpb-slot-states">activate</a> the <a href="chap36.html#dpb-slot">DPB slot</a>
specified in <code>pDecodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.
If <code>StdVideoDecodeAV1PictureInfo</code>::<code>refresh_frame_flags</code> is zero, but
a <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a> is specified,
then the corresponding picture reference associated with the <a href="chap36.html#dpb-slot">DPB
slot</a> is invalidated, as described in the <a href="chap36.html#dpb-slot-states">DPB Slot
States</a> section.</p>
</div>
<div id="decode-av1-active-sequence-header" class="dlist">
<dl>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The <em>active sequence header</em> is the <a href="chap36.html#decode-av1-sequence-header">AV1
sequence header</a> stored in the bound video session parameters object.</p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeAV1PictureInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeAV1PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeAV1PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_AV1_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeAV1PictureInfoKHR-pStdPictureInfo-parameter" href="chap36.html#VUID-VkVideoDecodeAV1PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeAV1PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoDecodeAV1PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeAV1PictureInfoKHR-pTileOffsets-parameter" href="chap36.html#VUID-VkVideoDecodeAV1PictureInfoKHR-pTileOffsets-parameter"></a> <span class="vuid">VUID-VkVideoDecodeAV1PictureInfoKHR-pTileOffsets-parameter</span><br>
 <code>pTileOffsets</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>tileCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeAV1PictureInfoKHR-pTileSizes-parameter" href="chap36.html#VUID-VkVideoDecodeAV1PictureInfoKHR-pTileSizes-parameter"></a> <span class="vuid">VUID-VkVideoDecodeAV1PictureInfoKHR-pTileSizes-parameter</span><br>
 <code>pTileSizes</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>tileCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeAV1PictureInfoKHR-tileCount-arraylength" href="chap36.html#VUID-VkVideoDecodeAV1PictureInfoKHR-tileCount-arraylength"></a> <span class="vuid">VUID-VkVideoDecodeAV1PictureInfoKHR-tileCount-arraylength</span><br>
 <code>tileCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoDecodeAV1DpbSlotInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoDecodeAV1DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_decode_av1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoDecodeAV1DpbSlotInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                          <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                              <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoDecodeAV1ReferenceInfo</span><span class="o">*</span>    <span class="n">pStdReferenceInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoDecodeAV1DpbSlotInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoDecodeAV1ReferenceInfo</code> structure specifying
<a href="chap36.html#decode-av1-reference-info">AV1 reference information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="chap36.html#decode-av1">AV1 decode
operation</a>.</p>
</div>
<div id="decode-av1-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>, one element is added to
the list of <a href="chap36.html#decode-active-reference-picture-info">active reference
pictures</a> used by the video decode operation for each element of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-av1-picture-data-access">AV1 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reference picture is associated with the <a href="chap36.html#dpb-slot">DPB slot</a> index
specified in the <code>slotIndex</code> member of the corresponding element of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>The reference picture is associated with the
<a href="chap36.html#decode-av1-reference-info">AV1 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-av1-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="chap36.html#decode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#decode-av1-picture-data-access">AV1 Decode Picture Data Access</a>
section.</p>
</li>
<li>
<p>If <a href="chap36.html#decode-av1-ref-pic-setup">reference picture setup</a> is requested,
then the reconstructed picture is used to <a href="chap36.html#dpb-slot-states">activate</a>
the <a href="chap36.html#dpb-slot">DPB slot</a> with the index specified in
<a href="chap36.html#VkVideoDecodeInfoKHR">VkVideoDecodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="chap36.html#decode-av1-reference-info">AV1 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="decode-av1-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoDecodeAV1ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>flags.disable_frame_end_update_cdf</code> is interpreted as defined in
section 6.8.2 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>flags.segmentation_enabled</code> is interpreted as defined in section
6.8.13 of the <a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>frame_type</code> is interpreted as defined in section 6.8.2 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>RefFrameSignBias</code> is a bitmask where bit index <span class="eq">i</span> corresponds
to <code>RefFrameSignBias[i]</code> as defined in section 6.8.2 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>OrderHint</code> is interpreted as defined in section 6.8.2 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>;</p>
</li>
<li>
<p><code>SavedOrderHints</code> is interpreted as defined in section 7.20 of the
<a href="chap2.html#aomedia-av1">AV1 Specification</a>.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When the AV1 reference information is provided for the reconstructed
picture, certain parameters (e.g. <code>frame_type</code>) are specified both in the
<a href="chap36.html#decode-av1-picture-info">AV1 picture information</a> and in the AV1 reference
information.
This is necessary because unlike the AV1 picture information, which is only
used for the purposes of the video decode operation in question, the AV1
reference information specified for the reconstructed picture <strong class="purple">may</strong> be
associated with the activated DPB slot, meaning that some implementations
<strong class="purple">may</strong> maintain it as part of the <a href="chap36.html#reference-metadata">reference picture
metadata</a> corresponding to the video picture resource associated with the
DPB slot.
When the AV1 reference information is provided for an active reference
picture, the specified parameters correspond to the parameters specified
when the DPB slot was activated (set up) with the reference picture, as
usual, in order to communicate these parameters for implementations that do
not maintain any subset of these parameters as part of the DPB slot’s
<a href="chap36.html#reference-metadata">reference picture metadata</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoDecodeAV1DpbSlotInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoDecodeAV1DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoDecodeAV1DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_DECODE_AV1_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoDecodeAV1DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="chap36.html#VUID-VkVideoDecodeAV1DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoDecodeAV1DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoDecodeAV1ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="decode-av1-requirements"><a class="anchor" href="chap36.html#decode-av1-requirements"></a>36.14.8. AV1 Decode Requirements</h4>
<div class="paragraph">
<p>This section describes the <strong class="purple">required</strong> AV1 decoding capabilities for physical
devices that have at least one queue family that supports the video codec
operation <code>VK_VIDEO_CODEC_OPERATION_DECODE_AV1_BIT_KHR</code>, as returned by
<a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="chap5.html#VkQueueFamilyVideoPropertiesKHR">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. Required <a href="chap36.html#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_av1std_decode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. Required Video Capabilities</caption>
<colgroup>
<col style="width: 58.3333%;">
<col style="width: 23.3333%;">
<col style="width: 18.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Capability</th>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Requirement Type<sup>1</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferOffsetAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferSizeAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pictureAccessGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxDpbSlots</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxActiveReferencePictures</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoDecodeCapabilitiesKHR">VkVideoDecodeCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_COINCIDE_BIT_KHR</code> or
                <code>VK_VIDEO_DECODE_CAPABILITY_DPB_AND_OUTPUT_DISTINCT_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoDecodeAV1CapabilitiesKHR">VkVideoDecodeAV1CapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxLevel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STD_VIDEO_AV1_LEVEL_2_0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The <strong>Requirement Type</strong> column specifies the requirement is either the
minimum value all implementations <strong class="purple">must</strong> support, the maximum value all
implementations <strong class="purple">must</strong> support, or the exact value all implementations
<strong class="purple">must</strong> support.
For bitmasks a minimum value is the least bits all implementations <strong class="purple">must</strong>
set, but they <strong class="purple">may</strong> have additional bits set beyond this minimum.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="video-encode-operations"><a class="anchor" href="chap36.html#video-encode-operations"></a>36.15. Video Encode Operations</h3>
<div id="encode-input-picture" class="paragraph">
<p>Video encode operations consume an <em>encode input picture</em> and zero or more
reference pictures, and produce compressed video data to a video bitstream
buffer and an optional <a href="chap36.html#reconstructed-picture">reconstructed picture</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Such encode input pictures can be used
as the <a href="chap36.html#decode-output-picture">output</a> of video decode operations,
with graphics or compute operations,
or with <a href="chap30.html">Window System Integration</a> APIs,
depending on the capabilities of the implementation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Video encode operations <strong class="purple">may</strong> access the following resources in the
<code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code> stage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The image subregions corresponding to the source
<a href="chap36.html#encode-input-picture-info">encode input picture</a> and
<a href="chap36.html#encode-active-reference-picture-info">active reference pictures</a> with
access <code>VK_ACCESS_2_VIDEO_ENCODE_READ_BIT_KHR</code>.</p>
</li>
<li>
<p>The destination video bitstream buffer range and the optional
<a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture</a> with access
<code>VK_ACCESS_2_VIDEO_ENCODE_WRITE_BIT_KHR</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The image subresource of each <a href="chap36.html#video-picture-resources">video picture
resource</a> accessed by the video encode operation is specified using a
corresponding <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure.
Each such image subresource <strong class="purple">must</strong> be in the appropriate image layout as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the image subresource is used in the video encode operation as an
<a href="chap36.html#encode-input-picture">encode input picture</a>, then it <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_SRC_KHR</code> layout.</p>
</li>
<li>
<p>If the image subresource is used in the video encode operation as a
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> or <a href="chap36.html#reference-picture">reference picture</a>, then it <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DPB_KHR</code> layout.</p>
</li>
</ul>
</div>
<div id="encode-unsuccessful" class="paragraph">
<p>A video encode operation <strong class="purple">may</strong> complete unsuccessfully.
In this case the target video bitstream buffer will have undefined
contents.
Similarly, if <a href="chap36.html#encode-ref-pic-setup">reference picture setup</a> is requested,
the <a href="chap36.html#reconstructed-picture">reconstructed-picture</a> will also have
undefined contents, and the activated DPB slot will have an
<a href="chap36.html#dpb-slot-states">invalid picture reference</a>.</p>
</div>
<div class="paragraph">
<p>If a video encode operation completes successfully and the codec-specific
parameters provided by the application adhere to the syntactic and semantic
requirements defined in the corresponding video compression standard, then
the target video bitstream buffer will contain compressed video data after
the execution of the video encode operation according to the respective
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>.</p>
</div>
<div class="sect3">
<h4 id="encode-codec-specific-semantics"><a class="anchor" href="chap36.html#encode-codec-specific-semantics"></a>36.15.1. Codec-Specific Semantics</h4>
<div class="paragraph">
<p>The following aspects of video encode operations are codec-specific:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The compressed video data written to the target video bitstream buffer
range.</p>
</li>
<li>
<p>The construction and interpretation of the list of
<a href="chap36.html#encode-active-reference-picture-info">active reference pictures</a> and
the interpretation of the picture data referred to by the corresponding
image subregions.</p>
</li>
<li>
<p>The construction and interpretation of information related to the
<a href="chap36.html#encode-input-picture-info">encode input picture</a> and the
interpretation of the picture data referred to by the corresponding
image subregion.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#encode-ref-pic-setup">reference picture setup</a>.</p>
</li>
<li>
<p>The construction and interpretation of information related to the
optional <a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture</a> and
the generation of picture data to the corresponding image subregion.</p>
</li>
<li>
<p>Certain aspects of <a href="chap36.html#encode-rate-control">rate control</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These codec-specific behaviors are defined for each video codec operation
separately.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the
codec-specific aspects of the video encoding process are performed as
defined in the <a href="chap36.html#encode-h264">H.264 Encode Operations</a> section.</p>
</li>
<li>
<p>If the used video codec operation is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the
codec-specific aspects of the video encoding process are performed as
defined in the <a href="chap36.html#encode-h265">H.265 Encode Operations</a> section.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="encode-overrides"><a class="anchor" href="chap36.html#encode-overrides"></a>Video Encode Parameter Overrides</h5>
<div class="paragraph">
<p>Implementations supporting video encode operations for any particular video
codec operation often support only a subset of the available encoding tools
defined by the corresponding video compression standards.
Accordingly, certain implementation-dependent limitations <strong class="purple">may</strong> apply to
codec-specific parameters provided through the structures defined in the
Video Std headers corresponding to the used video codec operation.</p>
</div>
<div class="paragraph">
<p>Exposing all of these restrictions on particular codec-specific parameter
values or combinations thereof in the form of application-queryable
capabilities is impractical, hence this specification allows implementations
to <em>override</em> the value of any of the codec-specific parameters, unless
otherwise specified, as long as all of the following conditions are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the application-provided codec-specific parameters adhere to the
syntactic and semantic requirements and rules defined by the used video
compression standard, and thus would be usable to produce a video
bitstream compliant with that standard, then the codec-specific
parameters resulting from the process of implementation overrides <strong class="purple">must</strong>
also adhere to the same requirements and rules, and any video bitstream
produced using the overridden parameters <strong class="purple">must</strong> also be compliant.</p>
</li>
<li>
<p>The overridden codec-specific parameter values <strong class="purple">must</strong> not have an impact
on the codec-independent behaviors defined for video encode operations.</p>
</li>
<li>
<p>The implementation <strong class="purple">must</strong> not override any codec-specific parameters
specified to a command that <strong class="purple">may</strong> cause application-provided
codec-specific parameters specified to subsequent commands to no longer
adhere to the semantic requirements and rules defined by the used video
compression standard, unless the implementation also overrides those
parameters to adhere to any such requirements and rules.</p>
</li>
<li>
<p>The overridden codec-specific parameter values <strong class="purple">must</strong> not have an impact
on the codec-specific picture data access semantics.</p>
</li>
<li>
<p>The overridden codec-specific parameter values <strong class="purple">may</strong> change the contents
of the codec-specific bitstream elements produced by video encode
operations or otherwise retrieved by the application (e.g. using the
<a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a> command) but <strong class="purple">must</strong> still
adhere to the codec-specific semantics defined for that video codec
operation, including, but not limited to, the number, type, and order of
the encoded codec-specific bitstream elements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides codec-specific parameter overrides performed for
implementation-dependent reasons, applications <strong class="purple">can</strong> enable the
implementation to apply additional <a href="chap36.html#encode-optimizing-overrides">optimizing
overrides</a> that <strong class="purple">may</strong> improve the efficiency or performance of video
encoding operations.
However, implementations <strong class="purple">must</strong> meet the conditions listed above even in case
of such optimizing overrides.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Unless the application opts in for optimizing overrides, implementations are
not expected to override any of the codec-specific parameters, except when
such overrides are necessary for the correct operation of video encoder
implementation due to limitations to the available encoding tools on that
implementation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-operation-steps"><a class="anchor" href="chap36.html#encode-operation-steps"></a>36.15.2. Video Encode Operation Steps</h4>
<div class="paragraph">
<p>Each video encode operation performs the following steps in the
<code>VK_PIPELINE_STAGE_2_VIDEO_ENCODE_BIT_KHR</code> stage:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reads the input picture data from the <a href="chap36.html#encode-input-picture">encode
input picture</a>;</p>
</li>
<li>
<p>Determine derived encoding quality parameters according to the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a> and the
current <a href="chap36.html#encode-rate-control">rate control</a> state;</p>
</li>
<li>
<p>Compresses the input picture data according to the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>, applying
any prediction data read from the <a href="chap36.html#active-reference-pictures">active
reference pictures</a> and rate control restrictions in the process;</p>
</li>
<li>
<p>Writes the encoded bitstream data to the destination video bitstream
buffer range;</p>
</li>
<li>
<p>Performs picture reconstruction of the encoded video data according to
the <a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>,
applying any prediction data read from the <a href="chap36.html#active-reference-pictures">active reference pictures</a> in the process, if a
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> is specified and
<a href="chap36.html#encode-ref-pic-setup">reference picture setup</a> is requested;</p>
</li>
<li>
<p>If <a href="chap36.html#encode-ref-pic-setup">reference picture setup</a> is requested, the
<a href="chap36.html#dpb-slot">DPB slot index</a> specified in the
<a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture information</a>
is <a href="chap36.html#dpb-slot-states">activated</a> with the
<a href="chap36.html#reconstructed-picture">reconstructed picture</a>;</p>
</li>
<li>
<p>Writes the reconstructed picture data to the <a href="chap36.html#reconstructed-picture">reconstructed picture</a>, if one is specified, according to the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When <a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture information</a>
is provided, the specified <a href="chap36.html#dpb-slot">DPB slot</a> index is associated with
the corresponding <a href="chap36.html#bound-reference-picture-resources">bound reference
picture resource</a>, indifferent of whether <a href="chap36.html#encode-ref-pic-setup">reference
picture setup</a> is requested.</p>
</div>
</div>
<div class="sect3">
<h4 id="_capabilities_2"><a class="anchor" href="chap36.html#_capabilities_2"></a>36.15.3. Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> with
<code>pVideoProfile-&gt;videoCodecOperation</code> specifying an encode operation, the
<a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a> structure <strong class="purple">must</strong> be included in the
<code>pNext</code> chain of the <a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a> structure to retrieve
capabilities specific to video encoding.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeCapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeCapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeCapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                                   <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeCapabilityFlagsKHR</span>         <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkVideoEncodeRateControlModeFlagsKHR</span>    <span class="n">rateControlModes</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">maxRateControlLayers</span><span class="p">;</span>
    <span class="kt">uint64_t</span>                                <span class="n">maxBitrate</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">maxQualityLevels</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>                              <span class="n">encodeInputPictureGranularity</span><span class="p">;</span>
    <span class="n">VkVideoEncodeFeedbackFlagsKHR</span>           <span class="n">supportedEncodeFeedbackFlags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeCapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoEncodeCapabilityFlagBitsKHR">VkVideoEncodeCapabilityFlagBitsKHR</a>
describing supported encoding features.</p>
</li>
<li>
<p><code>rateControlModes</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a> indicating supported
<a href="chap36.html#encode-rate-control-modes">rate control modes</a>.</p>
</li>
<li>
<p><code>maxRateControlLayers</code> indicates the maximum number of
<a href="chap36.html#encode-rate-control-layers">rate control layers</a> supported.</p>
</li>
<li>
<p><code>maxBitrate</code> indicates the maximum supported bitrate.</p>
</li>
<li>
<p><code>maxQualityLevels</code> indicates the number of discrete
<a href="chap36.html#encode-quality-level">video encode quality levels</a> supported.
Implementations <strong class="purple">must</strong> support at least one quality level.</p>
</li>
<li>
<p><code>encodeInputPictureGranularity</code> indicates the granularity at which
<a href="chap36.html#encode-input-picture">encode input picture</a> data is encoded and <strong class="purple">may</strong>
indicate a texel granularity up to the size of the codec-specific coding
block size.
This capability does not impose any valid usage constraints on the
application, however, depending on the contents of the encode input
picture, it <strong class="purple">may</strong> have effects on the encoded bitstream, as described in
more detail below.</p>
</li>
<li>
<p><code>supportedEncodeFeedbackFlags</code> is a bitmask of
<a href="chap17.html#VkVideoEncodeFeedbackFlagBitsKHR">VkVideoEncodeFeedbackFlagBitsKHR</a> values specifying the supported
flags for <a href="chap17.html#queries-video-encode-feedback">video encode feedback
queries</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">must</strong> include support for at least
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BUFFER_OFFSET_BIT_KHR</code> and
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BYTES_WRITTEN_BIT_KHR</code> in
<code>supportedEncodeFeedbackFlags</code>.</p>
</div>
<div class="paragraph">
<p><code>encodeInputPictureGranularity</code> provides information about the way
<a href="chap36.html#encode-input-picture">encode input picture</a> data is used as input to video
encode operations.
In particular, some implementations <strong class="purple">may</strong> not be able to limit the set of
texels used to encode the output video bitstream to the image subregion
specified in the <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding
to the encode input picture (i.e. to the resolution of the image data to
encode specified in its <code>codedExtent</code> member).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For example, the application requests the coded extent to be 1920x1080, but
the implementation is only able to source the encode input picture data at
the granularity of the codec-specific coding block size which is 16x16
pixels (or as otherwise indicated in <code>encodeInputPictureGranularity</code>).
In this example, the content is horizontally aligned with the coding block
size, but not vertically aligned with it.
Thus encoding of the last row of coding blocks will be impacted by the
contents of the input image at texel rows 1080 to 1087 (the latter being the
next row which is vertically aligned with the coding block size, assuming a
zero-based texel row index).</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If <code>codedExtent</code> rounded up to the next integer multiple of
<code>encodeInputPictureGranularity</code> is greater than the extent of the image
subresource specified for the <a href="chap36.html#encode-input-picture">encode input picture</a>,
then the texel values corresponding to texel coordinates outside of the
bounds of the image subresource <strong class="purple">may</strong> be undefined.
However, implementations <strong class="purple">should</strong> use well-defined default values for such
texels in order to maximize the encoding efficiency for the last coding
block row/column, and/or to ensure consistent encoding results across
repeated encoding of the same input content.
Nonetheless, the values used for such texels <strong class="purple">must</strong> not have an effect on
whether the video encode operation produces a compliant bitstream, and <strong class="purple">must</strong>
not have any other effects on the encoded picture data beyond what <strong class="purple">may</strong>
otherwise result from using these texel values as input to any compression
algorithm, as defined in the used video compression standard.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>While not required, it is generally a good practice for applications to make
sure that the image subresource used for the encode input picture has an
extent that is an integer multiple of the codec-specific coding block size
(or at least <code>encodeInputPictureGranularity</code>) and that this padding area
is filled with known values in order to improve encoding efficiency,
portability, and reproducibility.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeCapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeCapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeCapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>flags</code>,
indicating the encoding tools supported, are:</p>
</div>
<div id="VkVideoEncodeCapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeCapabilityFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_CAPABILITY_PRECEDING_EXTERNALLY_ENCODED_BYTES_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_CAPABILITY_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_DETECTION_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeCapabilityFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_CAPABILITY_PRECEDING_EXTERNALLY_ENCODED_BYTES_BIT_KHR</code>
indicates that the implementation supports the use of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>precedingExternallyEncodedBytes</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_CAPABILITY_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_DETECTION_BIT_KHR</code>
indicates that the implementation is able to detect and report when the
destination video bitstream buffer range provided by the application is
not sufficiently large to fit the encoded bitstream data produced by a
video encode operation by reporting the
<code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code>
<a href="chap17.html#query-result-status-codes">query result status code</a>.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Some implementations <strong class="purple">may</strong> not be able to reliably detect insufficient
bitstream buffer range conditions in all situations.
Such implementations will not report support for the
<code>VK_VIDEO_ENCODE_CAPABILITY_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_DETECTION_BIT_KHR</code>
encode capability flag for the video profile, but <strong class="purple">may</strong> still report the
<code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code> query
result status code in certain cases.
Applications <strong class="purple">should</strong> always check for the specific query result status code
<code>VK_QUERY_RESULT_STATUS_INSUFFICIENT_BITSTREAM_BUFFER_RANGE_KHR</code> even
when this encode capability flag is not supported by the implementation for
the video profile in question.
However, applications <strong class="purple">must</strong> not assume that a different negative query
result status code indicating an unsuccessful completion of a video encode
operation is not the result of an insufficient bitstream buffer condition
unless this encode capability flag is supported.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeCapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeCapabilityFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeCapabilityFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="chap36.html#VkVideoEncodeCapabilityFlagBitsKHR">VkVideoEncodeCapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-quality-level"><a class="anchor" href="chap36.html#encode-quality-level"></a>36.15.4. Video Encode Quality Levels</h4>
<div class="paragraph">
<p>Implementations <strong class="purple">can</strong> support more than one video encode quality levels for a
video encode profile, which control the number and type of
implementation-specific encoding tools and algorithms utilized in the
encoding process.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Generally, using higher video encode quality levels <strong class="purple">may</strong> produce higher
quality video streams at the cost of additional processing time.
However, as the final quality of an encoded picture depends on the contents
of the <a href="chap36.html#encode-input-picture">encode input picture</a>, the contents of the
<a href="chap36.html#active-reference-pictures">active reference pictures</a>, the codec-specific
encode parameters, and the particular implementation-specific tools used
corresponding to the individual video encode quality levels, there are no
guarantees that using a higher video encode quality level will always
produce a higher quality encoded picture for any given set of inputs.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query properties for a specific video encode quality level supported by a
video encode profile, call:</p>
</div>
<div id="vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="n">VkResult</span> <span class="nf">vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR</span><span class="p">(</span>
    <span class="n">VkPhysicalDevice</span>                            <span class="n">physicalDevice</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</span><span class="o">*</span> <span class="n">pQualityLevelInfo</span><span class="p">,</span>
    <span class="n">VkVideoEncodeQualityLevelPropertiesKHR</span><span class="o">*</span>     <span class="n">pQualityLevelProperties</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the physical device to query the video encode
quality level properties for.</p>
</li>
<li>
<p><code>pQualityLevelInfo</code> is a pointer to a
<a href="chap36.html#VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</a> structure
specifying the video encode profile and quality level to query
properties for.</p>
</li>
<li>
<p><code>pQualityLevelProperties</code> is a pointer to a
<a href="chap36.html#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a> structure in which the
properties are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-08257" href="chap36.html#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-08257"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-08257</span><br>

If <code>pQualityLevelInfo-&gt;pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pQualityLevelProperties</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH264QualityLevelPropertiesKHR">VkVideoEncodeH264QualityLevelPropertiesKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-08258" href="chap36.html#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-08258"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-08258</span><br>

If <code>pQualityLevelInfo-&gt;pVideoProfile-&gt;videoCodecOperation</code> is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pQualityLevelProperties</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH265QualityLevelPropertiesKHR">VkVideoEncodeH265QualityLevelPropertiesKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-physicalDevice-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkPhysicalDevice">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelInfo-parameter</span><br>
 <code>pQualityLevelInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelProperties-parameter" href="chap36.html#VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelProperties-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR-pQualityLevelProperties-parameter</span><br>
 <code>pQualityLevelProperties</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap36.html#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_OPERATION_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_FORMAT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PICTURE_LAYOUT_NOT_SUPPORTED_KHR</code></p>
</li>
<li>
<p><code>VK_ERROR_VIDEO_PROFILE_CODEC_NOT_SUPPORTED_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                 <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                     <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoProfileInfoKHR</span><span class="o">*</span>    <span class="n">pVideoProfile</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                        <span class="n">qualityLevel</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pVideoProfile</code> is a pointer to a <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>
structure specifying the video profile to query the video encode quality
level properties for.</p>
</li>
<li>
<p><code>qualityLevel</code> is the video encode quality level to query properties
for.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-08259" href="chap36.html#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-08259"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-08259</span><br>

<code>pVideoProfile</code> <strong class="purple">must</strong> be a <a href="chap36.html#video-profile-support">supported video
profile</a></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-08260" href="chap36.html#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-08260"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-08260</span><br>

<code>pVideoProfile-&gt;videoCodecOperation</code> <strong class="purple">must</strong> specify an encode
operation</p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-qualityLevel-08261" href="chap36.html#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-qualityLevel-08261"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-qualityLevel-08261</span><br>

<code>qualityLevel</code> <strong class="purple">must</strong> be less than
<a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>maxQualityLevels</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile
specified in <code>pVideoProfile</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-sType-sType" href="chap36.html#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_VIDEO_ENCODE_QUALITY_LEVEL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pNext-pNext" href="chap36.html#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-parameter" href="chap36.html#VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-parameter"></a> <span class="vuid">VUID-VkPhysicalDeviceVideoEncodeQualityLevelInfoKHR-pVideoProfile-parameter</span><br>
 <code>pVideoProfile</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeQualityLevelPropertiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeQualityLevelPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeQualityLevelPropertiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                            <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeRateControlModeFlagBitsKHR</span>    <span class="n">preferredRateControlMode</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">preferredRateControlLayerCount</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeQualityLevelPropertiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>preferredRateControlMode</code> is a
<a href="chap36.html#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a> value indicating the
preferred <a href="chap36.html#encode-rate-control-modes">rate control mode</a> to use with
the video encode quality level.</p>
</li>
<li>
<p><code>preferredRateControlLayerCount</code> indicates the preferred number of
<a href="chap36.html#encode-rate-control-layers">rate control layers</a> to use with the video
encode quality level.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_QUALITY_LEVEL_PROPERTIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelPropertiesKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeQualityLevelPropertiesKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelPropertiesKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264QualityLevelPropertiesKHR">VkVideoEncodeH264QualityLevelPropertiesKHR</a> or <a href="chap36.html#VkVideoEncodeH265QualityLevelPropertiesKHR">VkVideoEncodeH265QualityLevelPropertiesKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-unique" href="chap36.html#VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelPropertiesKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeQualityLevelInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeQualityLevelInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeQualityLevelInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">qualityLevel</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeQualityLevelInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>qualityLevel</code> is the used video encode quality level.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>
to specify the video encode quality level to use for a video session
parameters object created for a video encode session.
If no instance of this structure is included in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>, then the video session
parameters object is created with a video encode quality level of zero.</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> to change
the video encode quality level state of the bound video session.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelInfoKHR-qualityLevel-08311" href="chap36.html#VUID-VkVideoEncodeQualityLevelInfoKHR-qualityLevel-08311"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelInfoKHR-qualityLevel-08311</span><br>

<code>qualityLevel</code> <strong class="purple">must</strong> be less than
<a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>maxQualityLevels</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeQualityLevelInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeQualityLevelInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeQualityLevelInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_QUALITY_LEVEL_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrieving_encoded_session_parameters"><a class="anchor" href="chap36.html#_retrieving_encoded_session_parameters"></a>36.15.5. Retrieving Encoded Session Parameters</h4>
<div class="paragraph">
<p>Any codec-specific parameters stored in video session parameters objects
<strong class="purple">may</strong> need to be separately encoded and included in the final video bitstream
data, depending on the used video compression standard.
In such cases the application <strong class="purple">must</strong> call the
<a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a> command to retrieve the encoded
parameter data from the used video session parameters object in order to be
able to produce a compliant video bitstream.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This is needed because implementations <strong class="purple">may</strong> have changed some of the
codec-specific parameters stored in the video session parameters object, as
defined in the <a href="chap36.html#encode-overrides">Video Encode Parameter Overrides</a>
section.
In addition, the <a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a> command enables
the application to retrieve the encoded parameter data without having to
encode these codec-specific parameters manually.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Encoded parameter data <strong class="purple">can</strong> be retrieved from a video session parameters
object created with a video encode operation using the command:</p>
</div>
<div id="vkGetEncodedVideoSessionParametersKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="n">VkResult</span> <span class="nf">vkGetEncodedVideoSessionParametersKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeSessionParametersGetInfoKHR</span><span class="o">*</span> <span class="n">pVideoSessionParametersInfo</span><span class="p">,</span>
    <span class="n">VkVideoEncodeSessionParametersFeedbackInfoKHR</span><span class="o">*</span> <span class="n">pFeedbackInfo</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span>                                     <span class="n">pDataSize</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span>                                       <span class="n">pData</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the video session
parameters object.</p>
</li>
<li>
<p><code>pVideoSessionParametersInfo</code> is a pointer to a
<a href="chap36.html#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure specifying the
parameters of the encoded parameter data to retrieve.</p>
</li>
<li>
<p><code>pFeedbackInfo</code> is either <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoEncodeSessionParametersFeedbackInfoKHR">VkVideoEncodeSessionParametersFeedbackInfoKHR</a> structure in which
feedback about the requested parameter data is returned.</p>
</li>
<li>
<p><code>pDataSize</code> is a pointer to a <code>size_t</code> value related to the
amount of encode parameter data returned, as described below.</p>
</li>
<li>
<p><code>pData</code> is either <code>NULL</code> or a pointer to a buffer to write the
encoded parameter data to.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>pData</code> is <code>NULL</code>, then the size of the encoded parameter data, in
bytes, that <strong class="purple">can</strong> be retrieved is returned in <code>pDataSize</code>.
Otherwise, <code>pDataSize</code> <strong class="purple">must</strong> point to a variable set by the application
to the size of the buffer, in bytes, pointed to by <code>pData</code>, and on
return the variable is overwritten with the number of bytes actually written
to <code>pData</code>.
If <code>pDataSize</code> is less than the size of the encoded parameter data that
<strong class="purple">can</strong> be retrieved, then no data will be written to <code>pData</code>, zero will be
written to <code>pDataSize</code>, and <code>VK_INCOMPLETE</code> will be returned instead
of <code>VK_SUCCESS</code>, to indicate that no encoded parameter data was
returned.</p>
</div>
<div class="paragraph">
<p>If <code>pFeedbackInfo</code> is not <code>NULL</code> then the members of the
<a href="chap36.html#VkVideoEncodeSessionParametersFeedbackInfoKHR">VkVideoEncodeSessionParametersFeedbackInfoKHR</a> structure and any
additional structures included in its <code>pNext</code> chain that are applicable
to the video session parameters object specified in
<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> will be filled
with feedback about the requested parameter data on all successful calls to
this command.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This includes the cases when <code>pData</code> is <code>NULL</code> or when
<code>VK_INCOMPLETE</code> is returned by the command, and enables the application
to determine whether the implementation <a href="chap36.html#encode-overrides">overrode</a> any of
the requested video session parameters without actually needing to retrieve
the encoded parameter data itself.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08359" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08359"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08359</span><br>

<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> <strong class="purple">must</strong> have
been created with an encode operation</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08262" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08262"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08262</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pVideoSessionParametersInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08263" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08263"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08263</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then for the
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a> structure included in
the <code>pNext</code> chain of <code>pVideoSessionParametersInfo</code>, if its
<code>writeStdSPS</code> member is <code>VK_TRUE</code>, then
<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> <strong class="purple">must</strong> contain
a <code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a>::<code>stdSPSId</code></p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08264" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08264"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08264</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then for the
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a> structure included in
the <code>pNext</code> chain of <code>pVideoSessionParametersInfo</code>, if its
<code>writeStdPPS</code> member is <code>VK_TRUE</code>, then
<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> <strong class="purple">must</strong> contain
a <code>StdVideoH264PictureParameterSet</code> entry with
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a>::<code>stdSPSId</code> and
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a>::<code>stdPPSId</code>,
respectively</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08265" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08265"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08265</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pVideoSessionParametersInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08266" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08266"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08266</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then for the
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a> structure included in
the <code>pNext</code> chain of <code>pVideoSessionParametersInfo</code>, if its
<code>writeStdVPS</code> member is <code>VK_TRUE</code>, then
<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> <strong class="purple">must</strong> contain
a <code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>stdVPSId</code></p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08267" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08267"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08267</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then for the
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a> structure included in
the <code>pNext</code> chain of <code>pVideoSessionParametersInfo</code>, if its
<code>writeStdSPS</code> member is <code>VK_TRUE</code>, then
<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> <strong class="purple">must</strong> contain
a <code>StdVideoH265SequenceParameterSet</code> entry with
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>stdVPSId</code> and
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>stdSPSId</code>,
respectively</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08268" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08268"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-08268</span><br>

If <code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> was created
with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then for the
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a> structure included in
the <code>pNext</code> chain of <code>pVideoSessionParametersInfo</code>, if its
<code>writeStdPPS</code> member is <code>VK_TRUE</code>, then
<code>pVideoSessionParametersInfo-&gt;videoSessionParameters</code> <strong class="purple">must</strong> contain
a <code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> matching
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>stdVPSId</code>,
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>stdSPSId</code>, and
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>stdPPSId</code>,
respectively</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-device-parameter" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-device-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-parameter" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pVideoSessionParametersInfo-parameter</span><br>
 <code>pVideoSessionParametersInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pFeedbackInfo-parameter" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pFeedbackInfo-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pFeedbackInfo-parameter</span><br>
 If <code>pFeedbackInfo</code> is not <code>NULL</code>, <code>pFeedbackInfo</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap36.html#VkVideoEncodeSessionParametersFeedbackInfoKHR">VkVideoEncodeSessionParametersFeedbackInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pDataSize-parameter" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pDataSize-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pDataSize-parameter</span><br>
 <code>pDataSize</code> <strong class="purple">must</strong> be a valid pointer to a <code>size_t</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetEncodedVideoSessionParametersKHR-pData-parameter" href="chap36.html#VUID-vkGetEncodedVideoSessionParametersKHR-pData-parameter"></a> <span class="vuid">VUID-vkGetEncodedVideoSessionParametersKHR-pData-parameter</span><br>
 If the value referenced by <code>pDataSize</code> is not <code>0</code>, and <code>pData</code> is not <code>NULL</code>, <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>pDataSize</code> bytes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_INCOMPLETE</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeSessionParametersGetInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeSessionParametersGetInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeSessionParametersGetInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                    <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoSessionParametersKHR</span>    <span class="n">videoSessionParameters</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeSessionParametersGetInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>videoSessionParameters</code> is the <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a>
object to retrieve encoded parameter data from.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Depending on the used video encode operation, additional codec-specific
structures <strong class="purple">may</strong> need to be included in the <code>pNext</code> chain of this
structure to identify the specific video session parameters to retrieve
encoded parameter data for, as described in the corresponding sections.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_SESSION_PARAMETERS_GET_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeSessionParametersGetInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a> or <a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersGetInfoKHR-videoSessionParameters-parameter" href="chap36.html#VUID-VkVideoEncodeSessionParametersGetInfoKHR-videoSessionParameters-parameter"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersGetInfoKHR-videoSessionParameters-parameter</span><br>
 <code>videoSessionParameters</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoSessionParametersKHR">VkVideoSessionParametersKHR</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeSessionParametersFeedbackInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeSessionParametersFeedbackInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeSessionParametersFeedbackInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>              <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">hasOverrides</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeSessionParametersFeedbackInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>hasOverrides</code> indicates whether any of the requested parameter data
were <a href="chap36.html#encode-overrides">overridden</a> by the implementation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Depending on the used video encode operation, additional codec-specific
structures <strong class="purple">can</strong> be be included in the <code>pNext</code> chain of this structure to
capture codec-specific feedback information about the requested parameter
data, as described in the corresponding sections.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_SESSION_PARAMETERS_FEEDBACK_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264SessionParametersFeedbackInfoKHR">VkVideoEncodeH264SessionParametersFeedbackInfoKHR</a> or <a href="chap36.html#VkVideoEncodeH265SessionParametersFeedbackInfoKHR">VkVideoEncodeH265SessionParametersFeedbackInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeSessionParametersFeedbackInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="video-encode-commands"><a class="anchor" href="chap36.html#video-encode-commands"></a>36.15.6. Video Encode Commands</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To launch video encode operations, call:</p>
</div>
<div id="vkCmdEncodeVideoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="kt">void</span> <span class="nf">vkCmdEncodeVideoKHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeInfoKHR</span><span class="o">*</span>                 <span class="n">pEncodeInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer in which to record the
command.</p>
</li>
<li>
<p><code>pEncodeInfo</code> is a pointer to a <a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure
specifying the parameters of the video encode operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call issues one or more video encode operations.
The implicit parameter <code>opCount</code> corresponds to the number of video
encode operations issued by the command.
After calling this command, the
<a href="chap17.html#queries-operation-active-query-index">active query index</a> of each
<a href="chap17.html#queries-operation-active">active</a> query is incremented by <code>opCount</code>.</p>
</div>
<div class="paragraph">
<p>Currently each call to this command results in the issue of a single video
encode operation.</p>
</div>
<div class="paragraph">
<p>If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code> and the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>
structure with its <code>queryPool</code> member specifying a valid
<code>VkQueryPool</code> handle, then this command will execute a query for each
video encode operation issued by it.</p>
</div>
<div id="encode-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>The list of <a href="chap36.html#active-reference-pictures">active reference pictures</a> used by
a video encode operation is a list of image subregions used as the source of
<a href="chap36.html#reference-picture">reference picture</a> data and related parameters, and is
derived from the <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures provided as
the elements of the <code>pEncodeInfo-&gt;pReferenceSlots</code> array.
For each element of <code>pEncodeInfo-&gt;pReferenceSlots</code>, one or more elements
are added to the active reference picture list, as defined by the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>.
Each element of this list contains the following information:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the
<a href="chap36.html#video-picture-resources">video picture resource</a> used as the reference
picture.</p>
</li>
<li>
<p>The <a href="chap36.html#dpb-slot">DPB slot</a> index the reference picture is associated
with.</p>
</li>
<li>
<p>The codec-specific reference information related to the reference
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>Information related to the optional <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> used by a video encode operation is derived from the
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure pointed to by
<code>pEncodeInfo-&gt;pSetupReferenceSlot</code>, if not <code>NULL</code>, as defined by the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>, and consists
of the following:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the
<a href="chap36.html#video-picture-resources">video picture resource</a> used as the
reconstructed picture.</p>
</li>
<li>
<p>The <a href="chap36.html#dpb-slot">DPB slot</a> index to use for picture reconstruction.</p>
</li>
<li>
<p>The codec-specific reference information related to the reconstructed
picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-ref-pic-setup" class="paragraph">
<p>Specifying a valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure in
<code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is always required, unless the video
session was created with <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlot</code>
equal to zero.
However, the DPB slot identified by
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code> is only
<a href="chap36.html#dpb-slot-states">activated</a> with the <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> specified in
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> if reference
picture setup is requested according to the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>.</p>
</div>
<div class="paragraph">
<p>If reconstructed picture information is specified, but reference picture
setup is not requested, according to the codec-specific semantics, the
contents of the <a href="chap36.html#video-picture-resources">video picture resource</a>
corresponding to the reconstructed picture will be undefined after the
video encode operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Some implementations may always output the reconstructed picture or use it
as temporary storage during the video encode operation even when the
reconstructed picture is not marked for future reference.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="encode-input-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Encode Input Picture Information</dt>
<dd>
<p>Information related to the <a href="chap36.html#encode-input-picture">encode input picture</a>
used by a video encode operation is derived from
<code>pEncodeInfo-&gt;srcPictureResource</code> and any codec-specific parameters
provided in the <code>pEncodeInfo-&gt;pNext</code> chain, as defined by the
<a href="chap36.html#encode-codec-specific-semantics">codec-specific semantics</a>, and consists
of the following:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion within the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the
<a href="chap36.html#video-picture-resources">video picture resource</a> used as the encode
input picture.</p>
</li>
<li>
<p>The codec-specific picture information related to the encoded picture.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Several limiting values are defined below that are referenced by the
relevant valid usage statements of this command.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <code>uint32_t activeReferencePictureCount</code> be the size of the list of
active reference pictures used by the video encode operation.
Unless otherwise defined, <code>activeReferencePictureCount</code> is set to
the value of <code>pEncodeInfo-&gt;referenceSlotCount</code>.</p>
</li>
<li>
<p>Let <code>VkOffset2D codedOffsetGranularity</code> be the minimum alignment
requirement for the coded offset of video picture resources.
Unless otherwise defined, the value of the <code>x</code> and <code>y</code> members
of <code>codedOffsetGranularity</code> are <code>0</code>.</p>
</li>
<li>
<p>Let <code>uint32_t dpbFrameUseCount[]</code> be an array of size <code>maxDpbSlots</code>,
where <code>maxDpbSlots</code> is the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> the bound video
session was created with, with each element indicating the number of
times a frame associated with the corresponding DPB slot index is
referred to by the video coding operation.
Let the initial value of each element of the array be <code>0</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>dpbFrameUseCount[i]</code> is incremented by one, where <code>i</code> equals
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>For each element of <code>pEncodeInfo-&gt;pReferenceSlots</code>,
<code>dpbFrameUseCount[i]</code> is incremented by one, where <code>i</code> equals the
<code>slotIndex</code> member of the corresponding element.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Let <code>VkExtent2D maxCodingBlockSize</code> be the maximum codec-specific coding
block size that <strong class="purple">may</strong> be used by the video encode operation.</p>
<div class="ulist">
<ul>
<li>
<p>If the bound video session object was created with an
<a href="chap36.html#encode-h264-profile">H.264 encode profile</a>, then let
<code>maxCodingBlockSize</code> be equal to the size of an H.264 macroblock,
i.e. <code>{16,16}</code>.</p>
</li>
<li>
<p>If the bound video session object was created with an
<a href="chap36.html#encode-h265-profile">H.265 encode profile</a>, then let
<code>maxCodingBlockSize</code> be equal to the maximum H.265 coding block
size that <strong class="purple">may</strong> be used by the video encode operation derived as the
maximum of the CTB sizes corresponding to the
<a href="chap36.html#VkVideoEncodeH265CtbSizeFlagBitsKHR">VkVideoEncodeH265CtbSizeFlagBitsKHR</a> bits set in
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>ctbSizes</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
bound video session was created with.</p>
</li>
<li>
<p>Otherwise, <code>maxCodingBlockSize</code> is undefined.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>maxCodingBlockSize</code> is defined, then let <code>VkExtent2D
minCodingBlockExtent</code> be the coded extent of the
<a href="chap36.html#encode-input-picture">encode input picture</a> expressed in terms of
codec-specific coding blocks, assuming the maximum size of such coding
blocks, as defined by <code>maxCodingBlockSize</code>, calculated from the
value of the <code>codedExtent</code> member of
<code>pEncodeInfo-&gt;srcPictureResource</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>minCodingBlockExtent.width</code> = (<code>codedExtent.width</code><br>
<code>maxCodingBlockSize.width</code> - 1) / <code>maxCodingBlockSize.width</code></span></p>
</li>
<li>
<p><span class="eq"><code>minCodingBlockExtent.height</code> = (<code>codedExtent.height</code><br>
<code>maxCodingBlockSize.height</code> - 1) / <code>maxCodingBlockSize.height</code></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>If the bound video session object was created with an
<a href="chap36.html#encode-h264-profile">H.264 encode profile</a>, then:</p>
<div class="ulist">
<ul>
<li>
<p>Let <code>StdVideoH264PictureType h264PictureType</code> be the picture type of
the encoded picture set to the value of
<code>pStdPictureInfo-&gt;primary_pic_type</code> specified in the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pEncodeInfo-&gt;pNext</code> chain.</p>
</li>
<li>
<p>Let <code>StdVideoH264PictureType h264L0PictureTypes[]</code> and
<code>StdVideoH264PictureType h264L1PictureTypes[]</code> be the picture types of
the reference pictures in the L0 and L1 reference lists, respectively.
If <code>pStdPictureInfo-&gt;pRefLists</code> specified in the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pEncodeInfo-&gt;pNext</code> chain is not <code>NULL</code>, then for each reference
index specified in the elements of the
<code>pStdPictureInfo-&gt;pRefLists-&gt;RefPicList0</code> and
<code>pStdPictureInfo-&gt;pRefLists-&gt;RefPicList1</code> arrays, if the reference
index is not <code>STD_VIDEO_H264_NO_REFERENCE_PICTURE</code>,
<code>pStdReferenceInfo-&gt;primary_pic_type</code> is added to
<code>h264L0PictureTypes</code> or <code>h264L1PictureTypes</code>, respectively,
where <code>pStdReferenceInfo</code> is the member of the
<a href="chap36.html#VkVideoEncodeH264DpbSlotInfoKHR">VkVideoEncodeH264DpbSlotInfoKHR</a> structure included in the
<code>pNext</code> chain of the element of <code>pEncodeInfo-&gt;pReferenceSlots</code>
for which <code>slotIndex</code> equals the reference index in question.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the bound video session object was created with an
<a href="chap36.html#encode-h264-profile">H.265 encode profile</a>, then:</p>
<div class="ulist">
<ul>
<li>
<p>Let <code>StdVideoH265PictureType h265PictureType</code> be the picture type of
the encoded picture set to the value of <code>pStdPictureInfo-&gt;pic_type</code>
specified in the <a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure
included in the <code>pEncodeInfo-&gt;pNext</code> chain.</p>
</li>
<li>
<p>Let <code>StdVideoH265PictureType h265L0PictureTypes[]</code> and
<code>StdVideoH265PictureType h265L1PictureTypes[]</code> be the picture types of
the reference pictures in the L0 and L1 reference lists, respectively.
If <code>pStdPictureInfo-&gt;pRefLists</code> specified in the
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pEncodeInfo-&gt;pNext</code> chain is not <code>NULL</code>, then for each reference
index specified in the elements of the
<code>pStdPictureInfo-&gt;pRefLists-&gt;RefPicList0</code> and
<code>pStdPictureInfo-&gt;pRefLists-&gt;RefPicList1</code> arrays, if the reference
index is not <code>STD_VIDEO_H265_NO_REFERENCE_PICTURE</code>,
<code>pStdReferenceInfo-&gt;pic_type</code> is added to <code>h265L0PictureTypes</code>
or <code>h265L1PictureTypes</code>, respectively, where
<code>pStdReferenceInfo</code> is the member of the
<a href="chap36.html#VkVideoEncodeH265DpbSlotInfoKHR">VkVideoEncodeH265DpbSlotInfoKHR</a> structure included in the
<code>pNext</code> chain of the element of <code>pEncodeInfo-&gt;pReferenceSlots</code>
for which <code>slotIndex</code> equals the reference index in question.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-None-08250" href="chap36.html#VUID-vkCmdEncodeVideoKHR-None-08250"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-None-08250</span><br>

The bound video session <strong class="purple">must</strong> have been created with an encode operation</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-None-07012" href="chap36.html#VUID-vkCmdEncodeVideoKHR-None-07012"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-None-07012</span><br>

The bound video session <strong class="purple">must</strong> not be in <a href="chap36.html#video-session-uninitialized">uninitialized</a> state at the time the command is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-None-08318" href="chap36.html#VUID-vkCmdEncodeVideoKHR-None-08318"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-None-08318</span><br>

The bound video session parameters object <strong class="purple">must</strong> have been created with
the currently set <a href="chap36.html#encode-quality-level">video encode quality level</a>
for the bound video session at the time the command is executed on the
device</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-opCount-07174" href="chap36.html#VUID-vkCmdEncodeVideoKHR-opCount-07174"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-opCount-07174</span><br>

For each <a href="chap17.html#queries-operation-active">active</a> query, the
<a href="chap17.html#queries-operation-active-query-index">active query index</a>
corresponding to the query type of that query plus <code>opCount</code> <strong class="purple">must</strong>
be less than or equal to the
<a href="chap17.html#queries-operation-last-activatable-query-index">last activatable query
index</a> corresponding to the query type of that query plus one</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08360" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08360"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08360</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, and the
<code>pNext</code> chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure with its <code>queryPool</code>
member specifying a valid <code>VkQueryPool</code> handle, then
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>::queryCount <strong class="purple">must</strong> equal <code>opCount</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08361" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08361"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08361</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, and the
<code>pNext</code> chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure with its <code>queryPool</code>
member specifying a valid <code>VkQueryPool</code> handle, then all the queries
used by the command, as specified by the <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>
structure, <strong class="purple">must</strong> be <em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-queryType-08362" href="chap36.html#VUID-vkCmdEncodeVideoKHR-queryType-08362"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-queryType-08362</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, then the
<code>queryType</code> used to create the <code>queryPool</code> specified in the
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure included in the <code>pNext</code>
chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> or
<code>VK_QUERY_TYPE_VIDEO_ENCODE_FEEDBACK_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-queryPool-08363" href="chap36.html#VUID-vkCmdEncodeVideoKHR-queryPool-08363"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-queryPool-08363</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, then the
<code>queryPool</code> specified in the <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a>
structure included in the <code>pNext</code> chain of <code>pEncodeInfo</code> <strong class="purple">must</strong>
have been created with a <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure included
in the <code>pNext</code> chain of <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the
one specified in <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code>
the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-queryType-08364" href="chap36.html#VUID-vkCmdEncodeVideoKHR-queryType-08364"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-queryType-08364</span><br>

If the bound video session was created with
<code>VK_VIDEO_SESSION_CREATE_INLINE_QUERIES_BIT_KHR</code>, and the
<code>queryType</code> used to create the <code>queryPool</code> specified in the
<a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a> structure included in the <code>pNext</code>
chain of <code>pEncodeInfo</code> is
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> have been created with
a queue family index that supports <a href="chap17.html#queries-result-status-only">result
status queries</a>, as indicated by
<a href="chap5.html#VkQueueFamilyQueryResultStatusPropertiesKHR">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08201" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08201"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08201</span><br>

<code>pEncodeInfo-&gt;dstBuffer</code> <strong class="purple">must</strong> be <a href="chap36.html#video-profile-compatibility">compatible</a> with the video profile the bound video session was created
with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-08202" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-08202"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-08202</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pEncodeInfo-&gt;dstBuffer</code> <strong class="purple">must</strong> not be a protected buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-08203" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-08203"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-08203</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pEncodeInfo-&gt;dstBuffer</code> <strong class="purple">must</strong> be a protected buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08204" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08204"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08204</span><br>

<code>pEncodeInfo-&gt;dstBufferOffset</code> <strong class="purple">must</strong> be an integer multiple of
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferOffsetAlignment</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
video profile the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08205" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08205"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08205</span><br>

<code>pEncodeInfo-&gt;dstBufferRange</code> <strong class="purple">must</strong> be an integer multiple of
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>minBitstreamBufferSizeAlignment</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08206" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08206"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08206</span><br>

<code>pEncodeInfo-&gt;srcPictureResource.imageViewBinding</code> <strong class="purple">must</strong> be
<a href="chap36.html#video-profile-compatibility">compatible</a> with the video profile the
bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08207" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08207"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08207</span><br>

The format of <code>pEncodeInfo-&gt;srcPictureResource.imageViewBinding</code>
<strong class="purple">must</strong> match the <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pictureFormat</code>
the bound video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08208" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08208"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08208</span><br>

<code>pEncodeInfo-&gt;srcPictureResource.codedOffset</code> <strong class="purple">must</strong> be an integer
multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08209" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08209"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08209</span><br>

<code>pEncodeInfo-&gt;srcPictureResource.codedExtent</code> <strong class="purple">must</strong> be between
<code>minCodedExtent</code> and <code>maxCodedExtent</code>, inclusive, the bound
video session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08210" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08210"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08210</span><br>

<code>pEncodeInfo-&gt;srcPictureResource.imageViewBinding</code> <strong class="purple">must</strong> have been
created with <code>VK_IMAGE_USAGE_VIDEO_ENCODE_SRC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-08211" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-08211"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-08211</span><br>

If <code>commandBuffer</code> is an unprotected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pEncodeInfo-&gt;srcPictureResource.imageViewBinding</code> <strong class="purple">must</strong> not
have been created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-08212" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-08212"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-08212</span><br>

If <code>commandBuffer</code> is a protected command buffer and
<a href="chap5.html#limits-protectedNoFault"><code>protectedNoFault</code></a> is not supported,
then <code>pEncodeInfo-&gt;srcPictureResource.imageViewBinding</code> <strong class="purple">must</strong> have
been created from a protected image</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08377" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08377"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08377</span><br>

<code>pEncodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong> not be <code>NULL</code> unless the
bound video session was created with
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> equal to zero</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08213" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08213"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08213</span><br>

If <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code> <strong class="purple">must</strong> be less than the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when the
bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08214" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08214"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08214</span><br>

If <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource-&gt;codedOffset</code>
<strong class="purple">must</strong> be an integer multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08215" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08215"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08215</span><br>

If <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong>
<a href="chap36.html#video-picture-resource-matching">match</a> one of the
<a href="chap36.html#bound-reference-picture-resources">bound reference picture resource</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-activeReferencePictureCount-08216" href="chap36.html#VUID-vkCmdEncodeVideoKHR-activeReferencePictureCount-08216"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-activeReferencePictureCount-08216</span><br>

<code>activeReferencePictureCount</code> <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxActiveReferencePictures</code>
specified when the bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-slotIndex-08217" href="chap36.html#VUID-vkCmdEncodeVideoKHR-slotIndex-08217"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-slotIndex-08217</span><br>

The <code>slotIndex</code> member of each element of
<code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> be less than the
<a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>maxDpbSlots</code> specified when the
bound video session was created</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-codedOffset-08218" href="chap36.html#VUID-vkCmdEncodeVideoKHR-codedOffset-08218"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-codedOffset-08218</span><br>

The <code>codedOffset</code> member of the <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a>
structure pointed to by the <code>pPictureResource</code> member of each
element of <code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> be an integer
multiple of <code>codedOffsetGranularity</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pPictureResource-08219" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pPictureResource-08219"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pPictureResource-08219</span><br>

The <code>pPictureResource</code> member of each element of
<code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
<a href="chap36.html#video-picture-resource-matching">match</a> one of the
<a href="chap36.html#bound-reference-picture-resources">bound reference picture resource</a>
associated with the DPB slot index specified in the <code>slotIndex</code>
member of that element</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pPictureResource-08220" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pPictureResource-08220"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pPictureResource-08220</span><br>

Each video picture resource corresponding to the <code>pPictureResource</code>
member specified in the elements of <code>pEncodeInfo-&gt;pReferenceSlots</code>
<strong class="purple">must</strong> be <a href="chap36.html#video-picture-resource-uniqueness">unique</a> within
<code>pEncodeInfo-&gt;pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-dpbFrameUseCount-08221" href="chap36.html#VUID-vkCmdEncodeVideoKHR-dpbFrameUseCount-08221"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-dpbFrameUseCount-08221</span><br>

All elements of <code>dpbFrameUseCount</code> <strong class="purple">must</strong> be less than or equal to
<code>1</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08222" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08222"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08222</span><br>

The image subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to
by <code>pEncodeInfo-&gt;srcPictureResource</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_SRC_KHR</code> layout at the time the video
encode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08223" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08223"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08223</span><br>

If <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the image
subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to by
<code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;pPictureResource</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DPB_KHR</code> layout at the time the video
encode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pPictureResource-08224" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pPictureResource-08224"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pPictureResource-08224</span><br>

The image subresource <a href="chap36.html#video-image-subresource-reference">referred</a> to
by the <code>pPictureResource</code> member of each element of
<code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> be in the
<code>VK_IMAGE_LAYOUT_VIDEO_ENCODE_DPB_KHR</code> layout at the time the video
encode operation is executed on the device</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08225" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08225"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08225</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-StdVideoH264SequenceParameterSet-08226" href="chap36.html#VUID-vkCmdEncodeVideoKHR-StdVideoH264SequenceParameterSet-08226"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-StdVideoH264SequenceParameterSet-08226</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH264SequenceParameterSet</code> entry with
<code>seq_parameter_set_id</code> matching
<code>StdVideoEncodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> that is
provided in the <code>pStdPictureInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-StdVideoH264PictureParameterSet-08227" href="chap36.html#VUID-vkCmdEncodeVideoKHR-StdVideoH264PictureParameterSet-08227"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-StdVideoH264PictureParameterSet-08227</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH264PictureParameterSet</code> entry with
<code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> matching
<code>StdVideoEncodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> and
<code>StdVideoEncodeH264PictureInfo</code>::<code>pic_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08228" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08228"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08228</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoEncodeH264DpbSlotInfoKHR">VkVideoEncodeH264DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08229" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08229"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08229</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoEncodeH264DpbSlotInfoKHR">VkVideoEncodeH264DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-constantQp-08269" href="chap36.html#VUID-vkCmdEncodeVideoKHR-constantQp-08269"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-constantQp-08269</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and the current
<a href="chap36.html#encode-rate-control-modes">rate control mode</a> is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, then
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>constantQp</code> <strong class="purple">must</strong> be zero
for each element of the <code>pNaluSliceEntries</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-constantQp-08270" href="chap36.html#VUID-vkCmdEncodeVideoKHR-constantQp-08270"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-constantQp-08270</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and the current
<a href="chap36.html#encode-rate-control-modes">rate control mode</a> is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, then
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>constantQp</code> <strong class="purple">must</strong> be
between <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>minQp</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxQp</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
bound video session was created with, for each element of the
<code>pNaluSliceEntries</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-constantQp-08271" href="chap36.html#VUID-vkCmdEncodeVideoKHR-constantQp-08271"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-constantQp-08271</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_SLICE_CONSTANT_QP_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>constantQp</code> <strong class="purple">must</strong> have the
same value for each element of the <code>pNaluSliceEntries</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-naluSliceEntryCount-08302" href="chap36.html#VUID-vkCmdEncodeVideoKHR-naluSliceEntryCount-08302"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-naluSliceEntryCount-08302</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then the
<code>naluSliceEntryCount</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> be less than or equal to
<code>minCodingBlockExtent.width</code> multiplied by
<code>minCodingBlockExtent.height</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-naluSliceEntryCount-08312" href="chap36.html#VUID-vkCmdEncodeVideoKHR-naluSliceEntryCount-08312"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-naluSliceEntryCount-08312</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_ROW_UNALIGNED_SLICE_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then the
<code>naluSliceEntryCount</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> be less than or equal to
<code>minCodingBlockExtent.height</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08352" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08352"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08352</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure, and
<code>pEncodeInfo-&gt;referenceSlotCount</code> is greater than zero, then
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code>
<strong class="purple">must</strong> not be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08339" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08339"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08339</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure, and
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code>
is not <code>NULL</code>, then each element of the <code>RefPicList0</code> and
<code>RefPicList1</code> array members of the
<code>StdVideoEncodeH264ReferenceListsInfo</code> structure pointed to by
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code>
<strong class="purple">must</strong> either be <code>STD_VIDEO_H264_NO_REFERENCE_PICTURE</code> or <strong class="purple">must</strong> equal
the <code>slotIndex</code> member of one of the elements of
<code>pEncodeInfo-&gt;pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08353" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08353"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08353</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure, and
<code>pEncodeInfo-&gt;referenceSlotCount</code> is greater than zero, then the
<code>slotIndex</code> member of each element of
<code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> equal one of the elements of
the <code>RefPicList0</code> or <code>RefPicList1</code> array members of the
<code>StdVideoEncodeH264ReferenceListsInfo</code> structure pointed to by
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-maxPPictureL0ReferenceCount-08340" href="chap36.html#VUID-vkCmdEncodeVideoKHR-maxPPictureL0ReferenceCount-08340"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-maxPPictureL0ReferenceCount-08340</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxPPictureL0ReferenceCount</code>
is zero, as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a>
for the video profile the bound video session was created with, then
<code>h264PictureType</code> and each element of <code>h264L0PictureTypes</code> and
<code>h264L1PictureTypes</code> <strong class="purple">must</strong> not be <code>STD_VIDEO_H264_PICTURE_TYPE_P</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-maxBPictureL0ReferenceCount-08341" href="chap36.html#VUID-vkCmdEncodeVideoKHR-maxBPictureL0ReferenceCount-08341"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-maxBPictureL0ReferenceCount-08341</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxBPictureL0ReferenceCount</code>
and <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxL1ReferenceCount</code>
are both zero, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
bound video session was created with, then <code>h264PictureType</code> and
each element of <code>h264L0PictureTypes</code> and <code>h264L1PictureTypes</code>
<strong class="purple">must</strong> not be <code>STD_VIDEO_H264_PICTURE_TYPE_B</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-flags-08342" href="chap36.html#VUID-vkCmdEncodeVideoKHR-flags-08342"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-flags-08342</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then each element of
<code>h264L0PictureTypes</code> <strong class="purple">must</strong> not be <code>STD_VIDEO_H264_PICTURE_TYPE_B</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-flags-08343" href="chap36.html#VUID-vkCmdEncodeVideoKHR-flags-08343"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-flags-08343</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then each element of
<code>h264L1PictureTypes</code> <strong class="purple">must</strong> not be <code>STD_VIDEO_H264_PICTURE_TYPE_B</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08230" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08230"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08230</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> include a
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-StdVideoH265VideoParameterSet-08231" href="chap36.html#VUID-vkCmdEncodeVideoKHR-StdVideoH265VideoParameterSet-08231"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-StdVideoH265VideoParameterSet-08231</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH265VideoParameterSet</code> entry with
<code>vps_video_parameter_set_id</code> matching
<code>StdVideoEncodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>
that is provided in the <code>pStdPictureInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-StdVideoH265SequenceParameterSet-08232" href="chap36.html#VUID-vkCmdEncodeVideoKHR-StdVideoH265SequenceParameterSet-08232"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-StdVideoH265SequenceParameterSet-08232</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH265SequenceParameterSet</code> entry with
<code>sps_video_parameter_set_id</code> and <code>sps_seq_parameter_set_id</code>
matching
<code>StdVideoEncodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code> and
<code>StdVideoEncodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-StdVideoH265PictureParameterSet-08233" href="chap36.html#VUID-vkCmdEncodeVideoKHR-StdVideoH265PictureParameterSet-08233"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-StdVideoH265PictureParameterSet-08233</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the bound video
session parameters object <strong class="purple">must</strong> contain a
<code>StdVideoH265PictureParameterSet</code> entry with
<code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> matching
<code>StdVideoEncodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>,
<code>StdVideoEncodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>, and
<code>StdVideoEncodeH265PictureInfo</code>::<code>pps_pic_parameter_set_id</code>,
respectively, that are provided in the <code>pStdPictureInfo</code> member of
the <a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08234" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08234"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-08234</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<code>pEncodeInfo-&gt;pSetupReferenceSlot</code> is not <code>NULL</code>, then the
<code>pNext</code> chain of <code>pEncodeInfo-&gt;pSetupReferenceSlot</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoEncodeH265DpbSlotInfoKHR">VkVideoEncodeH265DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08235" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08235"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08235</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the <code>pNext</code>
chain of each element of <code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong>
include a <a href="chap36.html#VkVideoEncodeH265DpbSlotInfoKHR">VkVideoEncodeH265DpbSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-constantQp-08272" href="chap36.html#VUID-vkCmdEncodeVideoKHR-constantQp-08272"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-constantQp-08272</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the current
<a href="chap36.html#encode-rate-control-modes">rate control mode</a> is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, then
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>constantQp</code> <strong class="purple">must</strong>
be zero for each element of the <code>pNaluSliceSegmentEntries</code> member of
the <a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-constantQp-08273" href="chap36.html#VUID-vkCmdEncodeVideoKHR-constantQp-08273"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-constantQp-08273</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and the current
<a href="chap36.html#encode-rate-control-modes">rate control mode</a> is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, then
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>constantQp</code> <strong class="purple">must</strong>
be between <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>minQp</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxQp</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
bound video session was created with, for each element of the
<code>pNaluSliceSegmentEntries</code> member of the
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-constantQp-08274" href="chap36.html#VUID-vkCmdEncodeVideoKHR-constantQp-08274"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-constantQp-08274</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_SLICE_SEGMENT_CONSTANT_QP_BIT_KHR</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
video profile the bound video session was created with, then
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>constantQp</code> <strong class="purple">must</strong>
have the same value for each element of the
<code>pNaluSliceSegmentEntries</code> member of the
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-naluSliceSegmentEntryCount-08307" href="chap36.html#VUID-vkCmdEncodeVideoKHR-naluSliceSegmentEntryCount-08307"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-naluSliceSegmentEntryCount-08307</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then the
<code>naluSliceSegmentEntryCount</code> member of the
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> be less than or equal to
<code>minCodingBlockExtent.width</code> multiplied by
<code>minCodingBlockExtent.height</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-naluSliceSegmentEntryCount-08313" href="chap36.html#VUID-vkCmdEncodeVideoKHR-naluSliceSegmentEntryCount-08313"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-naluSliceSegmentEntryCount-08313</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_ROW_UNALIGNED_SLICE_SEGMENT_BIT_KHR</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
video profile the bound video session was created with, then the
<code>naluSliceSegmentEntryCount</code> member of the
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure included in the
<code>pNext</code> chain of <code>pEncodeInfo</code> <strong class="purple">must</strong> be less than or equal to
<code>minCodingBlockExtent.height</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08354" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08354"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08354</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure, and
<code>pEncodeInfo-&gt;referenceSlotCount</code> is greater than zero, then
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code>
<strong class="purple">must</strong> not be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08344" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08344"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08344</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure, and
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code>
is not <code>NULL</code>, then each element of the <code>RefPicList0</code> and
<code>RefPicList1</code> array members of the
<code>StdVideoEncodeH265ReferenceListsInfo</code> structure pointed to by
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code>
<strong class="purple">must</strong> either be <code>STD_VIDEO_H265_NO_REFERENCE_PICTURE</code> or <strong class="purple">must</strong> equal
the <code>slotIndex</code> member of one of the elements of
<code>pEncodeInfo-&gt;pReferenceSlots</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pNext-08355" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pNext-08355"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pNext-08355</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the <code>pNext</code>
chain of <code>pEncodeInfo</code> includes a
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure, and
<code>pEncodeInfo-&gt;referenceSlotCount</code> is greater than zero, then the
<code>slotIndex</code> member of each element of
<code>pEncodeInfo-&gt;pReferenceSlots</code> <strong class="purple">must</strong> equal one of the elements of
the <code>RefPicList0</code> or <code>RefPicList1</code> array members of the
<code>StdVideoEncodeH265ReferenceListsInfo</code> structure pointed to by
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a>::<code>pStdPictureInfo-&gt;pRefLists</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-maxPPictureL0ReferenceCount-08345" href="chap36.html#VUID-vkCmdEncodeVideoKHR-maxPPictureL0ReferenceCount-08345"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-maxPPictureL0ReferenceCount-08345</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxPPictureL0ReferenceCount</code>
is zero, as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a>
for the video profile the bound video session was created with, then
<code>h265PictureType</code> and each element of <code>h265L0PictureTypes</code> and
<code>h265L1PictureTypes</code> <strong class="purple">must</strong> not be <code>STD_VIDEO_H265_PICTURE_TYPE_P</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-maxBPictureL0ReferenceCount-08346" href="chap36.html#VUID-vkCmdEncodeVideoKHR-maxBPictureL0ReferenceCount-08346"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-maxBPictureL0ReferenceCount-08346</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxBPictureL0ReferenceCount</code>
and <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxL1ReferenceCount</code>
are both zero, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile the
bound video session was created with, then <code>h265PictureType</code> and
each element of <code>h265L0PictureTypes</code> and <code>h265L1PictureTypes</code>
<strong class="purple">must</strong> not be <code>STD_VIDEO_H265_PICTURE_TYPE_B</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-flags-08347" href="chap36.html#VUID-vkCmdEncodeVideoKHR-flags-08347"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-flags-08347</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then each element of
<code>h265L0PictureTypes</code> <strong class="purple">must</strong> not be <code>STD_VIDEO_H264_PICTURE_TYPE_B</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-flags-08348" href="chap36.html#VUID-vkCmdEncodeVideoKHR-flags-08348"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-flags-08348</span><br>

If the bound video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code> does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_KHR</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video
profile the bound video session was created with, then each element of
<code>h265L1PictureTypes</code> <strong class="purple">must</strong> not be <code>STD_VIDEO_H265_PICTURE_TYPE_B</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-parameter" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-pEncodeInfo-parameter" href="chap36.html#VUID-vkCmdEncodeVideoKHR-pEncodeInfo-parameter"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-pEncodeInfo-parameter</span><br>
 <code>pEncodeInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-recording" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-commandBuffer-cmdpool" href="chap36.html#VUID-vkCmdEncodeVideoKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-renderpass" href="chap36.html#VUID-vkCmdEncodeVideoKHR-renderpass"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-videocoding" href="chap36.html#VUID-vkCmdEncodeVideoKHR-videocoding"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called inside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdEncodeVideoKHR-bufferlevel" href="chap36.html#VUID-vkCmdEncodeVideoKHR-bufferlevel"></a> <span class="vuid">VUID-vkCmdEncodeVideoKHR-bufferlevel</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a primary <code>VkCommandBuffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap36.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeFlagsKHR</span>                 <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkBuffer</span>                              <span class="n">dstBuffer</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                          <span class="n">dstBufferOffset</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>                          <span class="n">dstBufferRange</span><span class="p">;</span>
    <span class="n">VkVideoPictureResourceInfoKHR</span>         <span class="n">srcPictureResource</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoReferenceSlotInfoKHR</span><span class="o">*</span>    <span class="n">pSetupReferenceSlot</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                              <span class="n">referenceSlotCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoReferenceSlotInfoKHR</span><span class="o">*</span>    <span class="n">pReferenceSlots</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                              <span class="n">precedingExternallyEncodedBytes</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is a pointer to a structure extending this structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>dstBuffer</code> is the destination video bitstream buffer to write the
encoded bitstream to.</p>
</li>
<li>
<p><code>dstBufferOffset</code> is the starting offset in bytes from the start of
<code>dstBuffer</code> to write the encoded bitstream to.</p>
</li>
<li>
<p><code>dstBufferRange</code> is the maximum bitstream size in bytes that <strong class="purple">can</strong> be
written to <code>dstBuffer</code>, starting from <code>dstBufferOffset</code>.</p>
</li>
<li>
<p><code>srcPictureResource</code> is the video picture resource to use as the
<a href="chap36.html#encode-input-picture">encode input picture</a>.</p>
</li>
<li>
<p><code>pSetupReferenceSlot</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure specifying the
<a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture information</a>.</p>
</li>
<li>
<p><code>referenceSlotCount</code> is the number of elements in the
<code>pReferenceSlots</code> array.</p>
</li>
<li>
<p><code>pReferenceSlots</code> is <code>NULL</code> or a pointer to an array of
<a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures describing the DPB slots
and corresponding <a href="chap36.html#reference-picture">reference picture</a> resources to
use in this video encode operation (the set of
<a href="chap36.html#active-reference-pictures">active reference pictures</a>).</p>
</li>
<li>
<p><code>precedingExternallyEncodedBytes</code> is the number of bytes externally
encoded by the application to the video bitstream and is used to update
the internal state of the implementation’s <a href="chap36.html#encode-rate-control">rate
control</a> algorithm to account for the bitrate budget consumed by these
externally encoded bytes.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-dstBuffer-08236" href="chap36.html#VUID-VkVideoEncodeInfoKHR-dstBuffer-08236"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-dstBuffer-08236</span><br>

<code>dstBuffer</code> <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_VIDEO_ENCODE_DST_BIT_KHR</code> set</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-dstBufferOffset-08237" href="chap36.html#VUID-VkVideoEncodeInfoKHR-dstBufferOffset-08237"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-dstBufferOffset-08237</span><br>

<code>dstBufferOffset</code> <strong class="purple">must</strong> be less than the size of <code>dstBuffer</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-dstBufferRange-08238" href="chap36.html#VUID-VkVideoEncodeInfoKHR-dstBufferRange-08238"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-dstBufferRange-08238</span><br>

<code>dstBufferRange</code> <strong class="purple">must</strong> be less than or equal to the size of
<code>dstBuffer</code> minus <code>dstBufferOffset</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-08239" href="chap36.html#VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-08239"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-08239</span><br>

If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, then its <code>slotIndex</code>
member <strong class="purple">must</strong> not be negative</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-08240" href="chap36.html#VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-08240"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-08240</span><br>

If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, then its
<code>pPictureResource</code> <strong class="purple">must</strong> not be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-slotIndex-08241" href="chap36.html#VUID-VkVideoEncodeInfoKHR-slotIndex-08241"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-slotIndex-08241</span><br>

The <code>slotIndex</code> member of each element of <code>pReferenceSlots</code>
<strong class="purple">must</strong> not be negative</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pPictureResource-08242" href="chap36.html#VUID-VkVideoEncodeInfoKHR-pPictureResource-08242"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pPictureResource-08242</span><br>

The <code>pPictureResource</code> member of each element of
<code>pReferenceSlots</code> <strong class="purple">must</strong> not be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>, <a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a>, or <a href="chap36.html#VkVideoInlineQueryInfoKHR">VkVideoInlineQueryInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoEncodeInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-flags-zerobitmask" href="chap36.html#VUID-VkVideoEncodeInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-dstBuffer-parameter" href="chap36.html#VUID-VkVideoEncodeInfoKHR-dstBuffer-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-dstBuffer-parameter</span><br>
 <code>dstBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-srcPictureResource-parameter" href="chap36.html#VUID-VkVideoEncodeInfoKHR-srcPictureResource-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-srcPictureResource-parameter</span><br>
 <code>srcPictureResource</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-parameter" href="chap36.html#VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pSetupReferenceSlot-parameter</span><br>
 If <code>pSetupReferenceSlot</code> is not <code>NULL</code>, <code>pSetupReferenceSlot</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeInfoKHR-pReferenceSlots-parameter" href="chap36.html#VUID-VkVideoEncodeInfoKHR-pReferenceSlots-parameter"></a> <span class="vuid">VUID-VkVideoEncodeInfoKHR-pReferenceSlots-parameter</span><br>
 If <code>referenceSlotCount</code> is not <code>0</code>, <code>pReferenceSlots</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>referenceSlotCount</code> valid <a href="chap36.html#VkVideoReferenceSlotInfoKHR">VkVideoReferenceSlotInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="chap36.html#VkVideoEncodeFlagsKHR">VkVideoEncodeFlagsKHR</a> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="encode-rate-control"><a class="anchor" href="chap36.html#encode-rate-control"></a>36.16. Video Encode Rate Control</h3>
<div class="paragraph">
<p>The size of the encoded bitstream data produced by video encode operations
is a function of the following set of constraints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The capabilities of the compression algorithms defined and employed by
the used video compression standard;</p>
</li>
<li>
<p>Restrictions imposed by the selected <a href="chap36.html#video-profiles">video profile</a>
according to the rules defined by the used video compression standard;</p>
</li>
<li>
<p>Further restrictions imposed by the <a href="chap36.html#video-coding-capabilities">capabilities</a> supported by the implementation for the selected
<a href="chap36.html#video-profiles">video profile</a>;</p>
</li>
<li>
<p>The image data in the <a href="chap36.html#encode-input-picture">encode input picture</a> and
the set of <a href="chap36.html#active-reference-pictures">active reference pictures</a> (as
these affect the effectiveness of the compression algorithms employed by
the video encode operations);</p>
</li>
<li>
<p>The set of codec-specific and codec-independent encoding parameters
provided by the application.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These also inherently define the set of decoder capabilities required for
reconstructing and processing the picture data in the encoded bitstream.</p>
</div>
<div id="encode-bitrate" class="paragraph">
<p>Video coding uses <em>bitrate</em> as the quantitative metric associated with
encoded bitstream data size which expresses the rate at which video
bitstream data <strong class="purple">can</strong> be transferred or processed, measured in number of bits
per second.
This bitrate is both a function of the encoded bitstream data size of the
encoded pictures as well as the <em>frame rate</em> used by the video sequence.</p>
</div>
<div class="paragraph">
<p>Rate control algorithms are used by video encode operations to enable
adjusting encoding parameters to achieve a target bitrate, or otherwise
directly or indirectly control the bitrate of the generated video bitstream
data.
These algorithms are usually not defined by the used video compression
standard, although some video compression standards do provide non-normative
guidelines for implementations.</p>
</div>
<div class="paragraph">
<p>Accordingly, this specification does not mandate implementations to produce
identical encoded bitstream data outputs in response to video encode
operations, however, it does define a set of codec-independent and
codec-specific parameters that enable the application to control the
behavior of the rate control algorithms supported by the implementation.
Some of these parameters guarantee certain implementation behavior while
others provide guidance for implementations to apply various rate control
heuristics.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications need to make sure that they configure rate control parameters
appropriately and that they follow the promises made to the implementation
through parameters providing guidance for the implementation’s rate control
algorithms and heuristics in order to be able to get the desired rate
control behavior and to be able to hit the set bitrate targets.
In addition, the behavior of rate control may also differ across
implementations even if the capabilities of the used video profile match
between those implementations.
This may happen due to implementations applying different rate control
algorithms or heuristics internally, and thus even the same set of guidance
parameter values may have different effects on the rate control behavior
across implementations.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="encode-rate-control-modes"><a class="anchor" href="chap36.html#encode-rate-control-modes"></a>36.16.1. Rate Control Modes</h4>
<div class="paragraph">
<p>After a video session is reset to the <a href="chap36.html#video-session-uninitialized">initial
state</a>, the default behavior and parameters of video encode rate control
are entirely implementation-dependent and the application <strong class="purple">cannot</strong> affect the
bitrate or quality parameters of the encoded bitstream data produced by
video encode operations unless the application changes the rate control
configuration of the video session, as described in the
<a href="chap36.html#video-coding-control">Video Coding Control</a> section.</p>
</div>
<div class="paragraph">
<p>For each supported <a href="chap36.html#video-profiles">video profile</a>, the implementation <strong class="purple">may</strong>
expose a set of <em>rate control modes</em> that are available for use by the
application when encoding bitstreams targeting that video profile.
These modes allow using different rate control algorithms that fall into one
of the following two categories:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Per-operation rate control</p>
</li>
<li>
<p>Stream-level rate control</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In case of <em>per-operation rate control</em>, the bitrate of the generated video
bitstream data is indirectly controlled by quality, size, or other encoding
parameters specified by the application for each individual video encode
operation.</p>
</div>
<div class="paragraph">
<p>In case of <em>stream-level rate control</em>, the application <strong class="purple">can</strong> directly
specify target bitrates besides other encoding parameters to control the
behavior of the rate control algorithm used by the implementation across
multiple video encode operations.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The rate control modes are defined with the following enums:</p>
</div>
<div id="VkVideoEncodeRateControlModeFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeRateControlModeFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeRateControlModeFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> specifies the use of
implementation-specific rate control.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code> specifies that
rate control is disabled and the application will specify per-operation
rate control parameters controlling the encoding quality.
In this mode implementations will encode pictures independently of the
output bitrate of prior video encode operations.</p>
<div class="ulist">
<ul>
<li>
<p>When using an <a href="chap36.html#encode-h264-profile">H.264 encode profile</a>,
implementations will use the QP value specified in
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>constantQp</code> to control
the quality of the encoded picture.</p>
</li>
<li>
<p>When using an <a href="chap36.html#encode-h265-profile">H.265 encode profile</a>,
implementations will use the QP value specified in
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>constantQp</code> to
control the quality of the encoded picture.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> specifies the use of
constant bitrate (CBR) rate control mode.
In this mode the implementation will attempt to produce the encoded
bitstream at a constant bitrate while conforming to the constraints of
other rate control parameters.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code> specifies the use of
variable bitrate (VBR) rate control mode.
In this mode the implementation will produce the encoded bitstream at a
variable bitrate according to the constraints of other rate control
parameters.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeRateControlModeFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeRateControlModeFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeRateControlModeFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="chap36.html#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-leaky-bucket-model"><a class="anchor" href="chap36.html#encode-leaky-bucket-model"></a>36.16.2. Leaky Bucket Model</h4>
<div class="paragraph">
<p>Video encoding implementations use the <em>leaky bucket model</em> for stream-level
rate control.
The leaky bucket is a concept referring to the interface between the video
encoder and the consumer (for example, a network connection), where the
video encoder produces encoded bitstream data corresponding to the encoded
pictures and adds them in the leaky bucket while its content are drained by
the consumer.</p>
</div>
<div class="paragraph">
<p>Analogously, a similar leaky bucket is considered to exist at the input
interface of a video decoder, into which encoded bitstream data is
continuously added and is subsequently consumed by the video decoder.
It is desirable to avoid overflowing or underflowing this leaky bucked
because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In case of an underflow, the video decoder will be unable to consume
encoded bitstream data in order to decode pictures (and optionally
display them).</p>
</li>
<li>
<p>In case of an overflow, the leaky bucket will be unable to accommodate
more encoded bitstream data and such data <strong class="purple">may</strong> need to be thrown away,
leading to the loss of the corresponding encoded pictures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These requirements <strong class="purple">can</strong> be satisfied by imposing various constraints on the
encoder-side leaky bucket to avoid its overflow or underflow, depending on
the used rate control algorithm and codec parameters.
However, enumerating these constraints is outside the scope of this
specification.</p>
</div>
<div class="paragraph">
<p>The term <em>virtual buffer</em> is often used as an alternative to refer to the
leaky bucket.</p>
</div>
<div class="paragraph">
<p>This virtual buffer model is defined by the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The bitrate (<code>R</code>) at which the encoded bitstream is expected to be
processed.</p>
</li>
<li>
<p>The size (<code>B</code>) of the virtual buffer.</p>
</li>
<li>
<p>The initial occupancy (<code>F</code>) of the virtual buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this model the virtual buffer is used to smooth out fluctuations in the
bitrate of the encoded bitstream over time without experiencing buffer
overflow or underflow, as long as the bitrate of the encoded stream does not
diverge from the target bitrate for extended periods of time.</p>
</div>
<div class="paragraph">
<p>This buffering <strong class="purple">may</strong> inherently impose a processing delay, as the goal of the
model is to enable decoders maintain a consistent processing rate of an
encoded bitstream with varying data rate.</p>
</div>
<div class="paragraph">
<p>The initial or start-up delay (<code>D</code>) is computed as:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>D</code> = <code>F</code> / <code>R</code></span></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications need to configure the virtual buffer with sufficient size to
avoid or minimize buffer overflows and underflows while also keeping it
small enough to meet their latency goals.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="encode-rate-control-layers"><a class="anchor" href="chap36.html#encode-rate-control-layers"></a>36.16.3. Rate Control Layers</h4>
<div class="paragraph">
<p>Some video compression standards and <a href="chap36.html#video-profiles">video profiles</a> allow
associating encoded pictures with specific <em>video coding layers</em>.
The name, identification, and semantics associated with such video coding
layers are defined by the corresponding video compression standards.</p>
</div>
<div class="paragraph">
<p>Analogously, stream-level rate control <strong class="purple">can</strong> be configured to use one or more
<em>rate control layers</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a single rate control layer is configured, it is applied to all
encoded pictures, regardless of the picture’s video coding layer.
In this case the distribution of the available bitrate budget across
video coding layers is implementation-dependent.</p>
</li>
<li>
<p>When multiple rate control layers are configured, each rate control
layer is applied to the corresponding video coding layer, i.e. only
across encoded pictures pertaining to the corresponding video coding
layer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Individual rate control layers are identified using <em>layer indices</em> between
zero and <code>N-1</code>, where <code>N</code> is the number of active rate control layers.</p>
</div>
<div class="paragraph">
<p>Rate control layers are only applicable when using
<a href="chap36.html#encode-rate-control-modes">stream-level rate control modes</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-rate-control-state"><a class="anchor" href="chap36.html#encode-rate-control-state"></a>36.16.4. Rate Control State</h4>
<div class="paragraph">
<p>Rate control state is maintained by the implementation in the
<a href="chap36.html#video-session">video session</a> objects and its parameters are specified
using an instance of the <code>VkVideoEncodeRateControlInfoKHR</code> structure.
The complete rate control state of a video session is defined by the
following set of parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The values of the members of the <a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>
structure used to configure the rate control state.</p>
</li>
<li>
<p>The values of the members of any
<a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structures specified in
<a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a>::<code>pLayers</code> used to configure
the state of individual <a href="chap36.html#encode-rate-control-layers">rate control
layers</a>.</p>
</li>
<li>
<p>If the video session was created with an <a href="chap36.html#encode-h264-profile">H.264
encode profile</a>:</p>
<div class="ulist">
<ul>
<li>
<p>The values of the members of the
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a> structure, if one is
specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> used to configure the rate
control state.</p>
</li>
<li>
<p>The values of the members of any
<a href="chap36.html#VkVideoEncodeH264RateControlLayerInfoKHR">VkVideoEncodeH264RateControlLayerInfoKHR</a> structures included in
the <code>pNext</code> chain of a <a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a>
structure used to configure the state of a rate control layer.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the video session was created with an <a href="chap36.html#encode-h265-profile">H.265
encode profile</a>:</p>
<div class="ulist">
<ul>
<li>
<p>The values of the members of the
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a> structure, if one is
specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> used to configure the rate
control state.</p>
</li>
<li>
<p>The values of the members of any
<a href="chap36.html#VkVideoEncodeH265RateControlLayerInfoKHR">VkVideoEncodeH265RateControlLayerInfoKHR</a> structures included in
the <code>pNext</code> chain of a <a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a>
structure used to configure the state of a rate control layer.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="encode-rate-control-state-matching" class="paragraph">
<p>Two rate control states match if all the parameters listed above match
between them.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeRateControlInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeRateControlInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeRateControlInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                    <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeRateControlFlagsKHR</span>               <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkVideoEncodeRateControlModeFlagBitsKHR</span>        <span class="n">rateControlMode</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">layerCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeRateControlLayerInfoKHR</span><span class="o">*</span>    <span class="n">pLayers</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">virtualBufferSizeInMs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">initialVirtualBufferSizeInMs</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeRateControlInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>rateControlMode</code> is a <a href="chap36.html#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a>
value specifying the <a href="chap36.html#encode-rate-control-modes">rate control mode</a>.</p>
</li>
<li>
<p><code>layerCount</code> specifies the number of <a href="chap36.html#encode-rate-control-layers">rate control layers</a> to use.</p>
</li>
<li>
<p><code>pLayers</code> is a pointer to an array of <code>layerCount</code>
<a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structures, each specifying
the rate control configuration of the corresponding rate control layer.</p>
</li>
<li>
<p><code>virtualBufferSizeInMs</code> is the size in milliseconds of the virtual
buffer used by the implementation’s rate control algorithm for the
<a href="chap36.html#encode-leaky-bucket-model">leaky bucket model</a>, with respect to the
average bitrate of the stream calculated by summing the values of the
<code>averageBitrate</code> members of the elements of the <code>pLayers</code> array.</p>
</li>
<li>
<p><code>initialVirtualBufferSizeInMs</code> is the initial occupancy in
milliseconds of the virtual buffer used by the implementation’s rate
control algorithm for the <a href="chap36.html#encode-leaky-bucket-model">leaky bucket
model</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>layerCount</code> is zero then the values of <code>virtualBufferSizeInMs</code>
and <code>initialVirtualBufferSizeInMs</code> are ignored.</p>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> to specify
the current rate control state expected to be configured when beginning
a <a href="chap36.html#video-coding-scope">video coding scope</a>.</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> to change
the rate control configuration of the bound video session.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Including this structure in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> and including
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code> in
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> enables updating the rate
control configuration of the bound video session.
This replaces the entire rate control configuration of the bound video
session and <strong class="purple">may</strong> reset the state of all enabled rate control layers to an
initial state according to the codec-specific rate control semantics defined
in the corresponding sections listed below.</p>
</div>
<div class="paragraph">
<p>When <code>layerCount</code> is greater than one, multiple
<a href="chap36.html#encode-rate-control-layers">rate control layers</a> are configured, and each
rate control layer is applied to the corresponding video coding layer
identified by the index of the corresponding element of <code>pLayer</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then this index
specifies the H.264 temporal layer ID of the video coding layer the rate
control layer is applied to.</p>
</li>
<li>
<p>If the video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then this index
specifies the H.265 temporal ID of the video coding layer the rate
control layer is applied to.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional structures providing codec-specific rate control parameters <strong class="purple">can</strong>
be included in the <code>pNext</code> chain of <code>VkVideoCodingControlInfoKHR</code>
depending on the <a href="chap36.html#video-profiles">video profile</a> the bound video session
was created.
For further details see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap36.html#video-coding-control">Video Coding Control</a></p>
</li>
<li>
<p><a href="chap36.html#encode-h264-rate-control">H.264 Encode Rate Control</a></p>
</li>
<li>
<p><a href="chap36.html#encode-h265-rate-control">H.265 Encode Rate Control</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The new rate control configuration takes effect when the corresponding
<a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> is executed on the device, and only impacts
video encode operations that follow in execution order.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08248" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08248"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08248</span><br>

If <code>rateControlMode</code> is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>, then
<code>layerCount</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08275" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08275"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08275</span><br>

If <code>rateControlMode</code> is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code> or
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>, then
<code>layerCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08244" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08244"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08244</span><br>

If <code>rateControlMode</code> is not
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DEFAULT_KHR</code>, then it <strong class="purple">must</strong>
specify one of the bits included in
<a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>rateControlModes</code>, as returned
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08245" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08245"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08245</span><br>

<code>layerCount</code> member <strong class="purple">must</strong> be less than or equal to
<a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>maxRateControlLayers</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used
video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-pLayers-08276" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-pLayers-08276"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-pLayers-08276</span><br>

For each element of <code>pLayers</code>, its <code>averageBitrate</code> member <strong class="purple">must</strong>
be between <code>1</code> and <a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>maxBitrate</code>,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-pLayers-08277" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-pLayers-08277"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-pLayers-08277</span><br>

For each element of <code>pLayers</code>, its <code>maxBitrate</code> member <strong class="purple">must</strong> be
between <code>1</code> and <a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a>::<code>maxBitrate</code>, as
returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used
video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08356" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08356"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08356</span><br>

If <code>rateControlMode</code> is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_CBR_BIT_KHR</code>, then for each
element of <code>pLayers</code>, its <code>averageBitrate</code> member <strong class="purple">must</strong> equal
its <code>maxBitrate</code> member</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08278" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08278"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-08278</span><br>

If <code>rateControlMode</code> is
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_VBR_BIT_KHR</code>, then for each
element of <code>pLayers</code>, its <code>averageBitrate</code> member <strong class="purple">must</strong> be less
than or equal to its <code>maxBitrate</code> member</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08357" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08357"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08357</span><br>

If <code>layerCount</code> is not zero, then <code>virtualBufferSizeInMs</code> <strong class="purple">must</strong>
be greater than zero</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08358" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08358"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-layerCount-08358</span><br>

If <code>layerCount</code> is not zero, then <code>initialVirtualBufferSizeInMs</code>
<strong class="purple">must</strong> be less than <code>virtualBufferSizeInMs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-videoCodecOperation-07022" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-videoCodecOperation-07022"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-videoCodecOperation-07022</span><br>

If the <code>videoCodecOperation</code> of the used video profile is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the <code>pNext</code>
chain this structure is included in also includes an instance of the
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a> structure, and
<code>layerCount</code> is greater than <code>1</code>, then <code>layerCount</code> <strong class="purple">must</strong> equal
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>temporalLayerCount</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-videoCodecOperation-07025" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-videoCodecOperation-07025"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-videoCodecOperation-07025</span><br>

If the <code>videoCodecOperation</code> of the used video profile is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the <code>pNext</code>
chain this structure is included in also includes an instance of the
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a> structure, and
<code>layerCount</code> is greater than <code>1</code>, then <code>layerCount</code> <strong class="purple">must</strong> equal
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>subLayerCount</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_RATE_CONTROL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-flags-zerobitmask" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-parameter" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-parameter"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-rateControlMode-parameter</span><br>
 If <code>rateControlMode</code> is not <code>0</code>, <code>rateControlMode</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeRateControlModeFlagBitsKHR">VkVideoEncodeRateControlModeFlagBitsKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlInfoKHR-pLayers-parameter" href="chap36.html#VUID-VkVideoEncodeRateControlInfoKHR-pLayers-parameter"></a> <span class="vuid">VUID-VkVideoEncodeRateControlInfoKHR-pLayers-parameter</span><br>
 If <code>layerCount</code> is not <code>0</code>, <code>pLayers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>layerCount</code> valid <a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeRateControlFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeRateControlFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeRateControlFlagsKHR</code> is a bitmask type for setting a mask,
but currently reserved for future use.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_rate_control_layer_state"><a class="anchor" href="chap36.html#_rate_control_layer_state"></a>Rate Control Layer State</h5>
<div class="paragraph">
<p>The configuration of individual rate control layers is specified using an
instance of the <code>VkVideoEncodeRateControlLayerInfoKHR</code> structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeRateControlLayerInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeRateControlLayerInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_queue</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeRateControlLayerInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint64_t</span>           <span class="n">averageBitrate</span><span class="p">;</span>
    <span class="kt">uint64_t</span>           <span class="n">maxBitrate</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">frameRateNumerator</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">frameRateDenominator</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeRateControlLayerInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is a pointer to a structure extending this structure.</p>
</li>
<li>
<p><code>averageBitrate</code> is the average <a href="chap36.html#encode-bitrate">bitrate</a> to be
targeted by the implementation’s rate control algorithm.</p>
</li>
<li>
<p><code>maxBitrate</code> is the peak <a href="chap36.html#encode-bitrate">bitrate</a> to be targeted
by the implementation’s rate control algorithm.</p>
</li>
<li>
<p><code>frameRateNumerator</code> is the numerator of the frame rate assumed by
the implementation’s rate control algorithm.</p>
</li>
<li>
<p><code>frameRateDenominator</code> is the denominator of the frame rate assumed
by the implementation’s rate control algorithm.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The ability of the implementation’s rate control algorithm to be able to
match the requested average and/or peak bitrates <strong class="purple">may</strong> be limited by the set
of other codec-independent and codec-specific rate control parameters
specified by the application, the input content, as well as the application
conforming to the rate control guidance provided to the implementation, as
described <a href="chap36.html#encode-rate-control">earlier</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Additional structures providing codec-specific rate control parameters <strong class="purple">can</strong>
be included in the <code>pNext</code> chain of
<code>VkVideoEncodeRateControlLayerInfoKHR</code> depending on the
<a href="chap36.html#video-profiles">video profile</a> the bound video session was created with.
For further details see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap36.html#video-coding-control">Video Coding Control</a></p>
</li>
<li>
<p><a href="chap36.html#encode-h264-rate-control">H.264 Encode Rate Control</a></p>
</li>
<li>
<p><a href="chap36.html#encode-h265-rate-control">H.265 Encode Rate Control</a></p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-frameRateNumerator-08350" href="chap36.html#VUID-VkVideoEncodeRateControlLayerInfoKHR-frameRateNumerator-08350"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-frameRateNumerator-08350</span><br>

<code>frameRateNumerator</code> <strong class="purple">must</strong> be greater than zero</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-frameRateDenominator-08351" href="chap36.html#VUID-VkVideoEncodeRateControlLayerInfoKHR-frameRateDenominator-08351"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-frameRateDenominator-08351</span><br>

<code>frameRateDenominator</code> <strong class="purple">must</strong> be greater than zero</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_RATE_CONTROL_LAYER_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeRateControlLayerInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap36.html#VkVideoEncodeH264RateControlLayerInfoKHR">VkVideoEncodeH264RateControlLayerInfoKHR</a> or <a href="chap36.html#VkVideoEncodeH265RateControlLayerInfoKHR">VkVideoEncodeH265RateControlLayerInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-unique" href="chap36.html#VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-unique"></a> <span class="vuid">VUID-VkVideoEncodeRateControlLayerInfoKHR-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="encode-h264"><a class="anchor" href="chap36.html#encode-h264"></a>36.17. H.264 Encode Operations</h3>
<div class="paragraph">
<p>Video encode operations using an <a href="chap36.html#encode-h264-profile">H.264 encode
profile</a> <strong class="purple">can</strong> be used to encode elementary video stream sequences compliant
to the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="chap1.html">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="chap36.html#encode-operation-steps">video
encode operation steps</a> with the codec-specific semantics defined in
section 8 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoH264SequenceParameterSet</code> structure corresponding to
the <a href="chap36.html#encode-h264-active-sps">active SPS</a> specifying the
<a href="chap36.html#encode-h264-sps">H.264 sequence parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH264PictureParameterSet</code> structure corresponding to the
<a href="chap36.html#encode-h264-active-pps">active PPS</a> specifying the <a href="chap36.html#encode-h264-pps">H.264 picture parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoEncodeH264PictureInfo</code> structure specifying the
<a href="chap36.html#encode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoEncodeH264SliceHeader</code> structures specifying the
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a> for
each encoded H.264 slice.</p>
</li>
<li>
<p>The <code>StdVideoEncodeH264ReferenceInfo</code> structures specifying the
<a href="chap36.html#encode-h264-reference-info">H.264 reference information</a>
corresponding to the optional <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> and any <a href="chap36.html#active-reference-pictures">active reference
pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The encoded bitstream data is written to the destination video bitstream
buffer range as defined in the
<a href="chap36.html#encode-h264-bitstream-data-access">H.264 Encode Bitstream Data
Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="chap36.html#video-picture-resources">video picture resources</a>
corresponding to the used <a href="chap36.html#encode-input-picture">encode input
picture</a>, <a href="chap36.html#active-reference-pictures">active reference pictures</a>, and
optional <a href="chap36.html#reconstructed-picture">reconstructed picture</a> is accessed as
defined in the <a href="chap36.html#encode-h264-picture-data-access">H.264 Encode Picture
Data Access</a> section.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#encode-ref-pic-setup">reference picture setup</a> is made
according to the parameters specified in the
<a href="chap36.html#encode-h264-ref-pic-setup">H.264 picture information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters adhere to the syntactic and semantic requirements defined
in the corresponding sections of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>, as described above, and the <a href="chap36.html#dpb-slot">DPB slots</a>
associated with the <a href="chap36.html#active-reference-pictures">active reference pictures</a>
all refer to <a href="chap36.html#dpb-slot-states">valid picture references</a>, then the video
encode operation will complete successfully.
Otherwise, the video encode operation <strong class="purple">may</strong> complete
<a href="chap36.html#encode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect3">
<h4 id="encode-h264-overrides"><a class="anchor" href="chap36.html#encode-h264-overrides"></a>36.17.1. H.264 Encode Parameter Overrides</h4>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> override, unless otherwise specified, any of the H.264
encode parameters specified in the following Video Std structures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH264SequenceParameterSet</code></p>
</li>
<li>
<p><code>StdVideoH264PictureParameterSet</code></p>
</li>
<li>
<p><code>StdVideoEncodeH264PictureInfo</code></p>
</li>
<li>
<p><code>StdVideoEncodeH264SliceHeader</code></p>
</li>
<li>
<p><code>StdVideoEncodeH264ReferenceInfo</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All such H.264 encode parameter overrides <strong class="purple">must</strong> fulfill the conditions
defined in the <a href="chap36.html#encode-overrides">Video Encode Parameter Overrides</a>
section.</p>
</div>
<div class="paragraph">
<p>In addition, implementations <strong class="purple">must</strong> not override any of the following H.264
encode parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoEncodeH264PictureInfo</code>::<code>primary_pic_type</code></p>
</li>
<li>
<p><code>StdVideoEncodeH264SliceHeader</code>::<code>slice_type</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of H.264 encode parameters stored in
<a href="chap36.html#encode-h264-parameter-sets">video session parameters</a> objects,
applications need to use the <a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>
command to determine whether any implementation overrides happened.
If the query indicates that implementation overrides were applied, then the
application needs to retrieve and use the encoded H.264 parameter sets in
the bitstream in order to be able to produce a compliant H.264 video
bitstream using the H.264 encode parameters stored in the video session
parameters object.</p>
</div>
<div class="paragraph">
<p>In case of any H.264 encode parameters stored in the encoded bitstream
produced by video encode operations, if the implementation supports the
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_HAS_OVERRIDES_BIT_KHR</code>
<a href="chap17.html#queries-video-encode-feedback">video encode feedback query</a> flag, the
application <strong class="purple">can</strong> use such queries to retrieve feedback about whether any
implementation overrides have been applied to those H.264 encode parameters.</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-bitstream-data-access"><a class="anchor" href="chap36.html#encode-h264-bitstream-data-access"></a>36.17.2. H.264 Encode Bitstream Data Access</h4>
<div class="paragraph">
<p>Each video encode operation writes one or more VCL NAL units comprising of
slice headers and data of the encoded picture, in the format defined in
sections 7.3.3 and 7.3.4, according to the semantics defined in sections
7.4.3 and 7.4.4 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>,
respectively.
The number of VCL NAL units written is specified by
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>naluSliceEntryCount</code>.</p>
</div>
<div class="paragraph">
<p>In addition, if
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>generatePrefixNalu</code> is set to
<code>VK_TRUE</code> for the video encode operation, then an additional prefix NAL
unit is written before each VCL NAL unit corresponding to individual slices
in the format defined in section 7.3.2.12, according to the semantics
defined in section 7.4.2.12 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>,
respectively.</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-picture-data-access"><a class="anchor" href="chap36.html#encode-h264-picture-data-access"></a>36.17.3. H.264 Encode Picture Data Access</h4>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="chap36.html#video-profiles">video profile</a>.
Accordingly, the complete image subregion of a <a href="chap36.html#encode-input-picture">encode
input picture</a>, <a href="chap36.html#reference-picture">reference picture</a>, or
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> accessed by video coding
operations using an <a href="chap36.html#encode-h264-profile">H.264 encode profile</a> is defined
as the set of texels within the coordinate range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([0,<code>endX</code>),[0,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>codedExtent.width</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.width</code> and
clamped to the width of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>codedExtent.height</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.height</code> and
clamped to the height of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedExtent</code> is the member of the
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>In case of video encode operations using an <a href="chap36.html#encode-h264-profile">H.264
encode profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>, is an access to the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>.</p>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> choose not to access some or all texels within
particular <a href="chap36.html#reference-picture">reference pictures</a> available to a video
encode operation (e.g. due to <a href="chap36.html#encode-overrides">video encode parameter
overrides</a> restricting the effective set of used reference pictures, or if
the encoding algorithm chooses not to use certain subregions of the
reference picture data for sample prediction).</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-frame-picture-slice"><a class="anchor" href="chap36.html#encode-h264-frame-picture-slice"></a>36.17.4. H.264 Frame, Picture, and Slice</h4>
<div class="paragraph">
<p>H.264 pictures are partitioned into slices, as defined in section 6.3 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</div>
<div class="paragraph">
<p>Video encode operations using an <a href="chap36.html#encode-h264-profile">H.264 encode
profile</a> <strong class="purple">can</strong> encode slices of different types, as defined in section 7.4.3
of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>, by specifying the
corresponding enumeration constant value in
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_type</code> in the
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a> from the
Video Std enumeration type <code>StdVideoH264SliceType</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="encode-h264-p-slice"></a> <code>STD_VIDEO_H264_SLICE_TYPE_P</code> indicates that
the slice is a <em>P slice</em> as defined in section 3.109 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
<li>
<p><a id="encode-h264-b-slice"></a> <code>STD_VIDEO_H264_SLICE_TYPE_B</code> indicates that
the slice is a <em>B slice</em> as defined in section 3.9 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
<li>
<p><a id="encode-h264-i-slice"></a> <code>STD_VIDEO_H264_SLICE_TYPE_I</code> indicates that
the slice is an <em>I slice</em> as defined in section 3.66 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pictures constructed from such slices <strong class="purple">can</strong> be of different types, as defined
in section 7.4.2.4 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.
Video encode operations using an <a href="chap36.html#encode-h264-profile">H.264 encode
profile</a> <strong class="purple">can</strong> encode pictures of a specific type by specifying the
corresponding enumeration constant value in
<code>StdVideoEncodeH264PictureInfo</code>::<code>primary_pic_type</code> in the
<a href="chap36.html#encode-h264-picture-info">H.264 picture information</a> from the Video Std
enumeration type <code>StdVideoH264PictureType</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="encode-h264-p-pic"></a> <code>STD_VIDEO_H264_PICTURE_TYPE_P</code> indicates that
the picture is a <em>P picture</em>.
A frame consisting of a P picture is also referred to as a <em>P frame</em>.</p>
</li>
<li>
<p><a id="encode-h264-b-pic"></a> <code>STD_VIDEO_H264_PICTURE_TYPE_B</code> indicates that
the picture is a <em>B picture</em>.
A frame consisting of a B picture is also referred to as a <em>B frame</em>.</p>
</li>
<li>
<p><a id="encode-h264-i-pic"></a> <code>STD_VIDEO_H264_PICTURE_TYPE_I</code> indicates that
the picture is an <em>I picture</em>.
A frame consisting of an I picture is also referred to as an <em>I frame</em>.</p>
</li>
<li>
<p><a id="encode-h264-idr-pic"></a> <code>STD_VIDEO_H264_PICTURE_TYPE_IDR</code> indicates
that the picture is a special type of I picture called an <em>IDR picture</em>
as defined in section 3.69 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>.
A frame consisting of an IDR picture is also referred to as an <em>IDR
frame</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-profile"><a class="anchor" href="chap36.html#encode-h264-profile"></a>36.17.5. H.264 Encode Profile</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting H.264 video encode operations is specified by
setting <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code> and adding a
<code>VkVideoEncodeH264ProfileInfoKHR</code> structure to the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH264ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264ProfileInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoH264ProfileIdc</span>    <span class="n">stdProfileIdc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264ProfileInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH264ProfileIdc</code> value specifying
the H.264 codec profile IDC, as defined in section A.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264ProfileInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_PROFILE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_264_encode_capabilities"><a class="anchor" href="chap36.html#_h_264_encode_capabilities"></a>36.17.6. H.264 Encode Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="chap36.html#encode-h264-profile">H.264 encode profile</a>, the
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include a
<code>VkVideoEncodeH264CapabilitiesKHR</code> structure that will be filled with
the profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH264CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264CapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                        <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                                  <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264CapabilityFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="n">StdVideoH264LevelIdc</span>                   <span class="n">maxLevelIdc</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                               <span class="n">maxSliceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                               <span class="n">maxPPictureL0ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                               <span class="n">maxBPictureL0ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                               <span class="n">maxL1ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                               <span class="n">maxTemporalLayerCount</span><span class="p">;</span>
    <span class="n">VkBool32</span>                               <span class="n">expectDyadicTemporalLayerPattern</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                <span class="n">minQp</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                <span class="n">maxQp</span><span class="p">;</span>
    <span class="n">VkBool32</span>                               <span class="n">prefersGopRemainingFrames</span><span class="p">;</span>
    <span class="n">VkBool32</span>                               <span class="n">requiresGopRemainingFrames</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264StdFlagsKHR</span>           <span class="n">stdSyntaxFlags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264CapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoEncodeH264CapabilityFlagBitsKHR">VkVideoEncodeH264CapabilityFlagBitsKHR</a>
indicating supported H.264 encoding capabilities.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH264LevelIdc</code> value indicating the
maximum H.264 level supported by the profile, where enum constant
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
<li>
<p><code>maxSliceCount</code> indicates the maximum number of slices that <strong class="purple">can</strong> be
encoded for a single picture.
Further restrictions <strong class="purple">may</strong> apply to the number of slices that <strong class="purple">can</strong> be
encoded for a single picture depending on other capabilities and
codec-specific rules.</p>
</li>
<li>
<p><code>maxPPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for <a href="chap36.html#encode-h264-p-pic">P pictures</a>.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As implementations <strong class="purple">may</strong> <a href="chap36.html#encode-overrides">override</a> the reference lists,
<code>maxPPictureL0ReferenceCount</code> does not limit the number of elements that
the application <strong class="purple">can</strong> specify in the L0 reference list for P pictures.
However, if <code>maxPPictureL0ReferenceCount</code> is zero, then the use of P
pictures is not allowed.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><code>maxBPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for <a href="chap36.html#encode-h264-b-pic">B pictures</a>.</p>
</li>
<li>
<p><code>maxL1ReferenceCount</code> indicates the maximum number of reference
pictures the implementation supports in the reference list L1 if
encoding of <a href="chap36.html#encode-h264-b-pic">B pictures</a> is supported.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As implementations <strong class="purple">may</strong> <a href="chap36.html#encode-overrides">override</a> the reference lists,
<code>maxBPictureL0ReferenceCount</code> and <code>maxL1ReferenceCount</code> does not
limit the number of elements that the application <strong class="purple">can</strong> specify in the L0 and
L1 reference lists for B pictures.
However, if <code>maxBPictureL0ReferenceCount</code> and <code>maxL1ReferenceCount</code>
are both zero, then the use of B pictures is not allowed.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><code>maxTemporalLayerCount</code> indicates the maximum number of H.264
temporal layers supported by the implementation.</p>
</li>
<li>
<p><code>expectDyadicTemporalLayerPattern</code> indicates that the
implementation’s rate control algorithms expect the application to use a
<a href="chap36.html#encode-h264-layer-pattern-dyadic">dyadic temporal layer pattern</a> when
encoding multiple temporal layers.</p>
</li>
<li>
<p><code>minQp</code> indicates the minimum QP value supported.</p>
</li>
<li>
<p><code>maxQp</code> indicates the maximum QP value supported.</p>
</li>
<li>
<p><code>prefersGopRemainingFrames</code> indicates that the implementation’s rate
control algorithm prefers the application to specify the number of
frames of each type <a href="chap36.html#encode-h264-gop-remaining-frames">remaining</a> in
the current <a href="chap36.html#encode-h264-gop">group of pictures</a> when beginning a
<a href="chap36.html#video-coding-scope">video coding scope</a>.</p>
</li>
<li>
<p><code>requiresGopRemainingFrames</code> indicates that the implementation’s
rate control algorithm requires the application to specify the number of
frames of each type <a href="chap36.html#encode-h264-gop-remaining-frames">remaining</a> in
the current <a href="chap36.html#encode-h264-gop">group of pictures</a> when beginning a
<a href="chap36.html#video-coding-scope">video coding scope</a>.</p>
</li>
<li>
<p><code>stdSyntaxFlags</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH264StdFlagBitsKHR">VkVideoEncodeH264StdFlagBitsKHR</a> indicating capabilities related to
H.264 syntax elements.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264CapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, indicating the H.264
encoding capabilities supported, are:</p>
</div>
<div id="VkVideoEncodeH264CapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH264CapabilityFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_HRD_COMPLIANCE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_ROW_UNALIGNED_SLICE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_DIFFERENT_SLICE_TYPE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_PER_SLICE_CONSTANT_QP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_CAPABILITY_GENERATE_PREFIX_NALU_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264CapabilityFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_HRD_COMPLIANCE_BIT_KHR</code> indicates
whether the implementation <strong class="purple">may</strong> be able to generate HRD compliant
bitstreams if any of the <code>nal_hrd_parameters_present_flag</code> or
<code>vcl_hrd_parameters_present_flag</code> members of
<code>StdVideoH264SpsVuiFlags</code> are set to <code>1</code> in the
<a href="chap36.html#encode-h264-active-sps">active SPS</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_KHR</code>
indicates that if <code>StdVideoH264PpsFlags</code>::<code>weighted_pred_flag</code> is
set to <code>1</code> or
<code>StdVideoH264PictureParameterSet</code>::<code>weighted_bipred_idc</code> is set to
<code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_EXPLICIT</code> in the
<a href="chap36.html#encode-h264-active-pps">active PPS</a> when encoding a
<a href="chap36.html#encode-h264-p-pic">P picture</a> or <a href="chap36.html#encode-h264-b-pic">B picture</a>,
respectively, then the implementation is able to internally decide
syntax for <code>pred_weight_table</code>, as defined in section 7.4.3.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>, and the application is not
<strong class="purple">required</strong> to provide a weight table in the
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_ROW_UNALIGNED_SLICE_BIT_KHR</code>
indicates that each slice in a frame with multiple slices may begin or
finish at any offset in a macroblock row.
If not supported, all slices in the frame <strong class="purple">must</strong> begin at the start of a
macroblock row (and hence each slice <strong class="purple">must</strong> finish at the end of a
macroblock row).</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_DIFFERENT_SLICE_TYPE_BIT_KHR</code>
indicates that when a frame is encoded with multiple slices, the
implementation allows encoding each slice with a different
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_type</code> specified in the
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a>.
If not supported, all slices of the frame <strong class="purple">must</strong> be encoded with the same
<code>slice_type</code> which corresponds to the picture type of the frame.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_KHR</code>
indicates support for using a <a href="chap36.html#encode-h264-b-pic">B frame</a> as L0
reference, as specified in
<code>StdVideoEncodeH264ReferenceListsInfo</code>::<code>RefPicList0</code> in the
<a href="chap36.html#encode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_KHR</code>
indicates support for using a <a href="chap36.html#encode-h264-b-pic">B frame</a> as L1
reference, as specified in
<code>StdVideoEncodeH264ReferenceListsInfo</code>::<code>RefPicList1</code> in the
<a href="chap36.html#encode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</code>
indicates support for specifying different QP values in the members of
<a href="chap36.html#VkVideoEncodeH264QpKHR">VkVideoEncodeH264QpKHR</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_SLICE_CONSTANT_QP_BIT_KHR</code>
indicates support for specifying different constant QP values for each
slice.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_CAPABILITY_GENERATE_PREFIX_NALU_BIT_KHR</code>
indicates support for generating prefix NAL units by setting
<a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a>::<code>generatePrefixNalu</code> to
<code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH264CapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH264CapabilityFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH264CapabilityFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="chap36.html#VkVideoEncodeH264CapabilityFlagBitsKHR">VkVideoEncodeH264CapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>stdSyntaxFlags</code>, indicating the
capabilities related to the H.264 syntax elements, are:</p>
</div>
<div id="VkVideoEncodeH264StdFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH264StdFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_QPPRIME_Y_ZERO_TRANSFORM_BYPASS_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_SCALING_MATRIX_PRESENT_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_CHROMA_QP_INDEX_OFFSET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_SECOND_CHROMA_QP_INDEX_OFFSET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_PIC_INIT_QP_MINUS26_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_WEIGHTED_PRED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_EXPLICIT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_IMPLICIT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_TRANSFORM_8X8_MODE_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_DIRECT_SPATIAL_MV_PRED_FLAG_UNSET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000400</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_UNSET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000800</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00001000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_DIRECT_8X8_INFERENCE_FLAG_UNSET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00002000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00004000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_DISABLED_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00008000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_ENABLED_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_PARTIAL_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00020000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_SLICE_QP_DELTA_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00080000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_STD_DIFFERENT_SLICE_QP_DELTA_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00100000</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264StdFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264SpsFlags</code>::<code>separate_colour_plane_flag</code> in the
<a href="chap36.html#encode-h264-sps">SPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_QPPRIME_Y_ZERO_TRANSFORM_BYPASS_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264SpsFlags</code>::<code>qpprime_y_zero_transform_bypass_flag</code> in
the <a href="chap36.html#encode-h264-sps">SPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SCALING_MATRIX_PRESENT_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided values for
<code>StdVideoH264SpsFlags</code>::<code>seq_scaling_matrix_present_flag</code> in the
<a href="chap36.html#encode-h264-sps">SPS</a> and
<code>StdVideoH264PpsFlags</code>::<code>pic_scaling_matrix_present_flag</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when any of those values are <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_CHROMA_QP_INDEX_OFFSET_BIT_KHR</code> indicates
whether the implementation supports using the application-provided value
for <code>StdVideoH264PictureParameterSet</code>::<code>chroma_qp_index_offset</code> in
the <a href="chap36.html#encode-h264-pps">PPS</a> when that value is non-zero.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SECOND_CHROMA_QP_INDEX_OFFSET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264PictureParameterSet</code>::<code>second_chroma_qp_index_offset</code>
in the <a href="chap36.html#encode-h264-pps">PPS</a> when that value is non-zero.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_PIC_INIT_QP_MINUS26_BIT_KHR</code> indicates
whether the implementation supports using the application-provided value
for <code>StdVideoH264PictureParameterSet</code>::<code>pic_init_qp_minus26</code> in
the <a href="chap36.html#encode-h264-pps">PPS</a> when that value is non-zero.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_WEIGHTED_PRED_FLAG_SET_BIT_KHR</code> indicates
whether the implementation supports using the application-provided value
for <code>StdVideoH264PpsFlags</code>::<code>weighted_pred_flag</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_EXPLICIT_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264PictureParameterSet</code>::<code>weighted_bipred_idc</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is
<code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_EXPLICIT</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_WEIGHTED_BIPRED_IDC_IMPLICIT_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264PictureParameterSet</code>::<code>weighted_bipred_idc</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is
<code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_IMPLICIT</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_TRANSFORM_8X8_MODE_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264PpsFlags</code>::<code>transform_8x8_mode_flag</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DIRECT_SPATIAL_MV_PRED_FLAG_UNSET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH264SliceHeaderFlags</code>::<code>direct_spatial_mv_pred_flag</code>
in the <a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a>
when that value is <code>0</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_UNSET_BIT_KHR</code>
indicates whether the implementation supports CAVLC entropy coding, as
defined in section 9.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>,
and thus supports using the application-provided value for
<code>StdVideoH264PpsFlags</code>::<code>entropy_coding_mode_flag</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is <code>0</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_ENTROPY_CODING_MODE_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports CABAC entropy coding, as
defined in section 9.3 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>,
and thus supports using the application-provided value for
<code>StdVideoH264PpsFlags</code>::<code>entropy_coding_mode_flag</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DIRECT_8X8_INFERENCE_FLAG_UNSET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264SpsFlags</code>::<code>direct_8x8_inference_flag</code> in the
<a href="chap36.html#encode-h264-sps">SPS</a> when that value is <code>0</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH264PpsFlags</code>::<code>constrained_intra_pred_flag</code> in the
<a href="chap36.html#encode-h264-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_DISABLED_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>disable_deblocking_filter_idc</code>
in the <a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a>
when that value is
<code>STD_VIDEO_H264_DISABLE_DEBLOCKING_FILTER_IDC_DISABLED</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_ENABLED_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>disable_deblocking_filter_idc</code>
in the <a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a>
when that value is
<code>STD_VIDEO_H264_DISABLE_DEBLOCKING_FILTER_IDC_ENABLED</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DEBLOCKING_FILTER_PARTIAL_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>disable_deblocking_filter_idc</code>
in the <a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a>
when that value is
<code>STD_VIDEO_H264_DISABLE_DEBLOCKING_FILTER_IDC_PARTIAL</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_SLICE_QP_DELTA_BIT_KHR</code> indicates whether
the implementation supports using the application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_qp_delta</code> in the
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a> when
that value is identical across the slices of the encoded frame.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_STD_DIFFERENT_SLICE_QP_DELTA_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH264SliceHeader</code>::<code>slice_qp_delta</code> in the
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a> when
that value is different across the slices of the encoded frame.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These capability flags provide information to the application about specific
H.264 syntax element values that the implementation supports without having
to <a href="chap36.html#encode-h264-overrides">override</a> them and do not otherwise restrict the
values that the application <strong class="purple">can</strong> specify for any of the mentioned H.264
syntax elements.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH264StdFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH264StdFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH264StdFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoEncodeH264StdFlagBitsKHR">VkVideoEncodeH264StdFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_264_encode_quality_level_properties"><a class="anchor" href="chap36.html#_h_264_encode_quality_level_properties"></a>36.17.7. H.264 Encode Quality Level Properties</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR">vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR</a>
with <code>pVideoProfile-&gt;videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the
<a href="chap36.html#VkVideoEncodeH264QualityLevelPropertiesKHR">VkVideoEncodeH264QualityLevelPropertiesKHR</a> structure <strong class="purple">must</strong> be included
in the <code>pNext</code> chain of the <a href="chap36.html#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a>
structure to retrieve additional video encode quality level properties
specific to H.264 encoding.</p>
</div>
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH264QualityLevelPropertiesKHR">VkVideoEncodeH264QualityLevelPropertiesKHR</a> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH264QualityLevelPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264QualityLevelPropertiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                                   <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264RateControlFlagsKHR</span>    <span class="n">preferredRateControlFlags</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredGopFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredIdrPeriod</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredConsecutiveBFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredTemporalLayerCount</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264QpKHR</span>                  <span class="n">preferredConstantQp</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredMaxL0ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredMaxL1ReferenceCount</span><span class="p">;</span>
    <span class="n">VkBool32</span>                                <span class="n">preferredStdEntropyCodingModeFlag</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264QualityLevelPropertiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>preferredRateControlFlags</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH264RateControlFlagBitsKHR">VkVideoEncodeH264RateControlFlagBitsKHR</a> values indicating the
preferred flags to use for
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>flags</code>.</p>
</li>
<li>
<p><code>preferredGopFrameCount</code> indicates the preferred value to use for
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>gopFrameCount</code>.</p>
</li>
<li>
<p><code>preferredIdrPeriod</code> indicates the preferred value to use for
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>idrPeriod</code>.</p>
</li>
<li>
<p><code>preferredConsecutiveBFrameCount</code> indicates the preferred value to
use for
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>consecutiveBFrameCount</code>.</p>
</li>
<li>
<p><code>preferredTemporalLayerCount</code> indicates the preferred value to use
for <a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>temporalLayerCount</code>.</p>
</li>
<li>
<p><code>preferredConstantQp</code> indicates the preferred values to use for
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>constantQp</code> for each
picture type when using <a href="chap36.html#encode-rate-control-modes">rate control mode</a>
<code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>preferredMaxL0ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L0.</p>
</li>
<li>
<p><code>preferredMaxL1ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L1.</p>
</li>
<li>
<p><code>preferredStdEntropyCodingModeFlag</code> indicates the preferred value to
use for <code>entropy_coding_mode_flag</code> in <code>StdVideoH264PpsFlags</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264QualityLevelPropertiesKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264QualityLevelPropertiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264QualityLevelPropertiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_QUALITY_LEVEL_PROPERTIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_264_encode_session"><a class="anchor" href="chap36.html#_h_264_encode_session"></a>36.17.8. H.264 Encode Session</h4>
<div class="paragraph">
<p>Additional parameters can be specified when creating a video session with an
H.264 encode profile by including an instance of the
<a href="chap36.html#VkVideoEncodeH264SessionCreateInfoKHR">VkVideoEncodeH264SessionCreateInfoKHR</a> structure in the <code>pNext</code>
chain of <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionCreateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264SessionCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264SessionCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>             <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>                <span class="n">useMaxLevelIdc</span><span class="p">;</span>
    <span class="n">StdVideoH264LevelIdc</span>    <span class="n">maxLevelIdc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264SessionCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMaxLevelIdc</code> indicates whether the value of <code>maxLevelIdc</code>
should be used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the value
of <code>maxLevelIdc</code> and uses the value of
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxLevelIdc</code>, as reported
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH264LevelIdc</code> value specifying the
upper bound on the H.264 level for the video bitstreams produced by the
created video session, where enum constant
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264SessionCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_CREATE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-parameter-sets"><a class="anchor" href="chap36.html#encode-h264-parameter-sets"></a>36.17.9. H.264 Encode Parameter Sets</h4>
<div class="paragraph">
<p><a href="chap36.html#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>
<strong class="purple">can</strong> contain the following types of parameters:</p>
</div>
<div class="paragraph">
<p><a id="encode-h264-sps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.264 Sequence Parameter Sets (SPS)</dt>
<dd>
<p>Represented by <code>StdVideoH264SequenceParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p><code>seq_parameter_set_id</code> is used as the key of the SPS entry;</p>
</li>
<li>
<p><code>level_idc</code> is one of the enum constants
<code>STD_VIDEO_H264_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.264 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.3 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.seq_scaling_matrix_present_flag</code> is set, then the
<code>StdVideoH264ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>scaling_list_present_mask</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>seq_scaling_list_present_flag[i]</code> as defined in section
7.4.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>use_default_scaling_matrix_mask</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>UseDefaultScalingMatrix4x4Flag[i]</code>, when <span class="eq">i
&lt; 6</span>, or corresponds to <code>UseDefaultScalingMatrix8x8Flag[i-6]</code>,
otherwise, as defined in section 7.3.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p><code>ScalingList4x4</code> and <code>ScalingList8x8</code> correspond to the
identically named syntax elements defined in section 7.3.2.1 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vui_parameters_present_flag</code> is set, then
<code>pSequenceParameterSetVui</code> is a pointer to a
<code>StdVideoH264SequenceParameterSetVui</code> structure that is interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> or
<code>flags.vcl_hrd_parameters_present_flag</code> is set, then the
<code>StdVideoH264HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoH264HrdParameters</code> are interpreted as
defined in section E.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264SequenceParameterSetVui</code> are
interpreted as defined in section E.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264SequenceParameterSet</code> are
interpreted as defined in section 7.4.2.1 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="encode-h264-pps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.264 Picture Parameter Sets (PPS)</dt>
<dd>
<p>Represented by <code>StdVideoH264PictureParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p>the pair constructed from <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code> is used as the key of the PPS entry;</p>
</li>
<li>
<p>if <code>flags.pic_scaling_matrix_present_flag</code> is set, then the
<code>StdVideoH264ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>scaling_list_present_mask</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>pic_scaling_list_present_flag[i]</code> as defined in section
7.4.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>use_default_scaling_matrix_mask</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>UseDefaultScalingMatrix4x4Flag[i]</code>, when <span class="eq">i
&lt; 6</span>, or corresponds to <code>UseDefaultScalingMatrix8x8Flag[i-6]</code>,
otherwise, as defined in section 7.3.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p><code>ScalingList4x4</code> and <code>ScalingList8x8</code> correspond to the
identically named syntax elements defined in section 7.3.2.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH264PictureParameterSet</code> are
interpreted as defined in section 7.4.2.2 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> override any of these parameters according to the
semantics defined in the <a href="chap36.html#encode-overrides">Video Encode Parameter
Overrides</a> section before storing the resulting H.264 parameter sets into
the video session parameters object.
Applications need to use the <a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>
command to determine whether any implementation overrides happened and to
retrieve the encoded H.264 parameter sets in order to be able to produce a
compliant H.264 video bitstream.</p>
</div>
<div class="paragraph">
<p>Such H.264 parameter set overrides <strong class="purple">may</strong> also have cascading effects on the
implementation overrides applied to the encoded bitstream produced by video
encode operations.
If the implementation supports the
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_HAS_OVERRIDES_BIT_KHR</code>
<a href="chap17.html#queries-video-encode-feedback">video encode feedback query</a> flag, then the
application <strong class="purple">can</strong> use such queries to retrieve feedback about whether any
implementation overrides have been applied to the encoded bitstream.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="chap36.html#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, the
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include
a <code>VkVideoEncodeH264SessionParametersCreateInfoKHR</code> structure specifying
the capacity and initial contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264SessionParametersCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                        <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                            <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdSPSCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeH264SessionParametersAddInfoKHR</span><span class="o">*</span>    <span class="n">pParametersAddInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264SessionParametersCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of <a href="chap36.html#encode-h264-sps">H.264
SPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of <a href="chap36.html#encode-h264-pps">H.264
PPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure specifying
H.264 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersCreateInfoKHR-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoEncodeH264SessionParametersAddInfoKHR">VkVideoEncodeH264SessionParametersAddInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersAddInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersAddInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264SessionParametersAddInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                            <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdSPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH264SequenceParameterSet</span><span class="o">*</span>    <span class="n">pStdSPSs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH264PictureParameterSet</span><span class="o">*</span>     <span class="n">pStdPPSs</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264SessionParametersAddInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of elements in the <code>pStdSPSs</code> array.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH264SequenceParameterSet</code> structures describing the
<a href="chap36.html#encode-h264-sps">H.264 SPS</a> entries to add.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of elements in the <code>pStdPPSs</code> array.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH264PictureParameterSet</code> structures describing the
<a href="chap36.html#encode-h264-pps">H.264 PPS</a> entries to add.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH264SessionParametersCreateInfoKHR">VkVideoEncodeH264SessionParametersCreateInfoKHR</a> structure
specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> used to create a
<a href="chap36.html#video-session-parameters">video session parameters</a> object.
In this case, if the video codec operation the video session parameters
object is created with is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then it defines the
set of initial parameters to add to the created object (see
<a href="chap36.html#creating-video-session-parameters">Creating Video Session
Parameters</a>).</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a>.
In this case, if the video codec operation the
<a href="chap36.html#video-session-parameters">video session parameters</a> object to be
updated was created with is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, then it defines the
set of parameters to add to it (see
<a href="chap36.html#video-session-parameters-update">Updating Video Session Parameters</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-None-04837" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-None-04837"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-None-04837</span><br>

The <code>seq_parameter_set_id</code> member of each
<code>StdVideoH264SequenceParameterSet</code> structure specified in the
elements of <code>pStdSPSs</code> <strong class="purple">must</strong> be unique within <code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-None-04838" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-None-04838"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-None-04838</span><br>

The pair constructed from the <code>seq_parameter_set_id</code> and
<code>pic_parameter_set_id</code> members of each
<code>StdVideoH264PictureParameterSet</code> structure specified in the elements
of <code>pStdPPSs</code> <strong class="purple">must</strong> be unique within <code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_ADD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, and <code>pStdSPSs</code> is not <code>NULL</code>, <code>pStdSPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH264SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersAddInfoKHR-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, and <code>pStdPPSs</code> is not <code>NULL</code>, <code>pStdPPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH264PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersGetInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersGetInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264SessionParametersGetInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">writeStdSPS</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">writeStdPPS</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">stdSPSId</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">stdPPSId</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264SessionParametersGetInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>writeStdSPS</code> indicates whether the encoded <a href="chap36.html#encode-h264-sps">H.264
sequence parameter set</a> identified by <code>stdSPSId</code> is requested to be
retrieved.</p>
</li>
<li>
<p><code>writeStdPPS</code> indicates whether the encoded <a href="chap36.html#encode-h264-pps">H.264
picture parameter set</a> identified by the pair constructed from
<code>stdSPSId</code> and <code>stdPPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>stdSPSId</code> specifies the H.264 sequence parameter set ID used to
identify the retrieved H.264 sequence and/or picture parameter set(s).</p>
</li>
<li>
<p><code>stdPPSId</code> specifies the H.264 picture parameter set ID used to
identify the retrieved H.264 picture parameter set when
<code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure passed to
<a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>, the command will write encoded
parameter data to the output buffer in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <a href="chap36.html#encode-h264-sps">H.264 sequence parameter set</a> identified by
<code>stdSPSId</code>, if <code>writeStdSPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#encode-h264-pps">H.264 picture parameter set</a> identified by the
pair constructed from <code>stdSPSId</code> and <code>stdPPSId</code>, if
<code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersGetInfoKHR-writeStdSPS-08279" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersGetInfoKHR-writeStdSPS-08279"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersGetInfoKHR-writeStdSPS-08279</span><br>

At least one of <code>writeStdSPS</code> and <code>writeStdPPS</code> <strong class="purple">must</strong> be set to
<code>VK_TRUE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersGetInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersGetInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersGetInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_GET_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264SessionParametersFeedbackInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH264SessionParametersFeedbackInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264SessionParametersFeedbackInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>              <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">hasStdSPSOverrides</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">hasStdPPSOverrides</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264SessionParametersFeedbackInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>hasStdSPSOverrides</code> indicates whether any of the parameters of the
requested <a href="chap36.html#encode-h264-sps">H.264 sequence parameter set</a>, if one was
requested via
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a>::<code>writeStdSPS</code>,
were <a href="chap36.html#encode-overrides">overridden</a> by the implementation.</p>
</li>
<li>
<p><code>hasStdPPSOverrides</code> indicates whether any of the parameters of the
requested <a href="chap36.html#encode-h264-pps">H.264 picture parameter set</a>, if one was
requested via
<a href="chap36.html#VkVideoEncodeH264SessionParametersGetInfoKHR">VkVideoEncodeH264SessionParametersGetInfoKHR</a>::<code>writeStdPPS</code>,
were <a href="chap36.html#encode-overrides">overridden</a> by the implementation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264SessionParametersFeedbackInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264SessionParametersFeedbackInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264SessionParametersFeedbackInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_SESSION_PARAMETERS_FEEDBACK_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_264_encoding_parameters"><a class="anchor" href="chap36.html#_h_264_encoding_parameters"></a>36.17.10. H.264 Encoding Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH264PictureInfoKHR">VkVideoEncodeH264PictureInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264PictureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                             <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                 <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                    <span class="n">naluSliceEntryCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeH264NaluSliceInfoKHR</span><span class="o">*</span>    <span class="n">pNaluSliceEntries</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoEncodeH264PictureInfo</span><span class="o">*</span>        <span class="n">pStdPictureInfo</span><span class="p">;</span>
    <span class="n">VkBool32</span>                                    <span class="n">generatePrefixNalu</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264PictureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>naluSliceEntryCount</code> is the number of elements in
<code>pNaluSliceEntries</code>.</p>
</li>
<li>
<p><code>pNaluSliceEntries</code> is a pointer to an array of
<code>naluSliceEntryCount</code> <a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>
structures specifying the parameters of the individual H.264 slices to
encode for the input picture.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoEncodeH264PictureInfo</code> structure specifying
<a href="chap36.html#encode-h264-picture-info">H.264 picture information</a>.</p>
</li>
<li>
<p><code>generatePrefixNalu</code> controls whether prefix NALUs are generated
before slice NALUs into the target bitstream, as defined in sections
7.3.2.12 and 7.4.2.12 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="chap36.html#encode-h264">H.264
encode operation</a>.</p>
</div>
<div id="encode-h264-input-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Encode Input Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a>,
the information related to the <a href="chap36.html#encode-input-picture-info">encode input
picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#encode-h264-picture-data-access">H.264 Encode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The encode input picture is associated with the
<a href="chap36.html#encode-h264-picture-info">H.264 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h264-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH264PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>flags.IdrPicFlag</code> as defined in section 7.4.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>flags.is_reference</code> as defined in section 3.136 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>seq_parameter_set_id</code> and <code>pic_parameter_set_id</code> are used to
identify the active parameter sets, as described below;</p>
</li>
<li>
<p><code>primary_pic_type</code> as defined in section 7.4.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>PicOrderCnt</code> as defined in section 8.2 of the <a href="chap2.html#itu-t-h264">ITU-T
H.264 Specification</a>;</p>
</li>
<li>
<p><code>temporal_id</code> as defined in section G.7.4.1.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p>if <code>pRefLists</code> is not <code>NULL</code>, then it is a pointer to a
<code>StdVideoEncodeH264ReferenceListsInfo</code> structure that is interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>ref_pic_list_modification_flag_l0</code> and
<code>ref_pic_list_modification_flag_l1</code> as defined in section 7.4.3.1 of
the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>num_ref_idx_l0_active_minus1</code> and <code>num_ref_idx_l1_active_minus1</code>
as defined in section 7.4.3 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>;</p>
</li>
<li>
<p><code>RefPicList0</code> and <code>RefPicList1</code> as defined in section 8.2.4 of
the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a> where each element of
these arrays either identifies an
<a href="chap36.html#encode-active-reference-picture-info">active reference picture</a> using
its <a href="chap36.html#dpb-slot">DPB slot</a> index or contains the value
<code>STD_VIDEO_H264_NO_REFERENCE_PICTURE</code> to indicate “no reference
picture”;</p>
</li>
<li>
<p>if <code>refList0ModOpCount</code> is not zero, then
<code>pRefList0ModOperations</code> is a pointer to an array of
<code>refList0ModOpCount</code> number of
<code>StdVideoEncodeH264RefListModEntry</code> structures specifying the
modification parameters for the reference list L0 as defined in section
7.4.3.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p>if <code>refList1ModOpCount</code> is not zero, then
<code>pRefList1ModOperations</code> is a pointer to an array of
<code>refList1ModOpCount</code> number of
<code>StdVideoEncodeH264RefListModEntry</code> structures specifying the
modification parameters for the reference list L1 as defined in section
7.4.3.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p>if <code>refPicMarkingOpCount</code> is not zero, then
<code>refPicMarkingOperations</code> is a pointer to an array of
<code>refPicMarkingOpCount</code> number of
<code>StdVideoEncodeH264RefPicMarkingEntry</code> structures specifying the
reference picture marking parameters as defined in section 7.4.3.3 of
the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members are interpreted as defined in section 7.4.3 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h264-ref-pic-setup" class="paragraph">
<p>Reference picture setup is controlled by the value of
<code>StdVideoEncodeH264PictureInfo</code>::<code>flags.is_reference</code>.
If it is set and a <a href="chap36.html#encode-reconstructed-picture-info">reconstructed
picture</a> is specified, then the latter is used as the target of picture
reconstruction to <a href="chap36.html#dpb-slot-states">activate</a> the <a href="chap36.html#dpb-slot">DPB slot</a>
specified in <code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.
If <code>StdVideoEncodeH264PictureInfo</code>::<code>flags.is_reference</code> is not set,
but a <a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture</a> is
specified, then the corresponding picture reference associated with the
<a href="chap36.html#dpb-slot">DPB slot</a> is invalidated, as described in the
<a href="chap36.html#dpb-slot-states">DPB Slot States</a> section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH264PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are used to select the active parameter sets to use
from the bound video session parameters object, as follows:</p>
<div class="ulist">
<ul>
<li>
<p><a id="encode-h264-active-sps"></a> The <em>active SPS</em> is the
<a href="chap36.html#encode-h264-sps">SPS</a> identified by the key specified in
<code>StdVideoEncodeH264PictureInfo</code>::<code>seq_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="encode-h264-active-pps"></a> The <em>active PPS</em> is the
<a href="chap36.html#encode-h264-pps">PPS</a> identified by the key specified by the pair
constructed from
<code>StdVideoEncodeH264PictureInfo</code>::<code>seq_parameter_set_id</code> and
<code>StdVideoEncodeH264PictureInfo</code>::<code>pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h264-weighted-pred" class="paragraph">
<p>H.264 encoding uses <em>explicit weighted sample prediction</em> for a slice, as
defined in section 8.4.2.3 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>,
if any of the following conditions are true for the active
<a href="chap36.html#encode-h264-pps">PPS</a> and the <code>pStdSliceHeader</code> member of the
corresponding element of <code>pNaluSliceEntries</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pStdSliceHeader-&gt;slice_type</code> is <code>STD_VIDEO_H264_SLICE_TYPE_P</code>
and <code>weighted_pred_flag</code> is enabled in the active PPS.</p>
</li>
<li>
<p><code>pStdSliceHeader-&gt;slice_type</code> is <code>STD_VIDEO_H264_SLICE_TYPE_B</code>
and <code>weighted_bipred_idc</code> in the active PPS equals
<code>STD_VIDEO_H264_WEIGHTED_BIPRED_IDC_EXPLICIT</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-naluSliceEntryCount-08301" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-naluSliceEntryCount-08301"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-naluSliceEntryCount-08301</span><br>

<code>naluSliceEntryCount</code> <strong class="purple">must</strong> be between <code>1</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxSliceCount</code>, inclusive,
as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the
used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-flags-08304" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-flags-08304"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-flags-08304</span><br>

If <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_GENERATE_PREFIX_NALU_BIT_KHR</code>, then
<code>generatePrefixNalu</code> <strong class="purple">must</strong> be <code>VK_FALSE</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-flags-08314" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-flags-08314"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-flags-08314</span><br>

If <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_KHR</code>
and the slice corresponding to any element of <code>pNaluSliceEntries</code>
uses <a href="chap36.html#encode-h264-weighted-pred">explicit weighted sample prediction</a>,
then
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>pStdSliceHeader-&gt;pWeightTable</code>
<strong class="purple">must</strong> not be <code>NULL</code> for that element of <code>pNaluSliceEntries</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-flags-08315" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-flags-08315"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-flags-08315</span><br>

If <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_DIFFERENT_SLICE_TYPE_BIT_KHR</code>, then
<a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a>::<code>pStdSliceHeader-&gt;slice_type</code>
<strong class="purple">must</strong> be identical for all elements of <code>pNaluSliceEntries</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-pNaluSliceEntries-parameter" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-pNaluSliceEntries-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-pNaluSliceEntries-parameter</span><br>
 <code>pNaluSliceEntries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>naluSliceEntryCount</code> valid <a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-pStdPictureInfo-parameter" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoEncodeH264PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264PictureInfoKHR-naluSliceEntryCount-arraylength" href="chap36.html#VUID-VkVideoEncodeH264PictureInfoKHR-naluSliceEntryCount-arraylength"></a> <span class="vuid">VUID-VkVideoEncodeH264PictureInfoKHR-naluSliceEntryCount-arraylength</span><br>
 <code>naluSliceEntryCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH264NaluSliceInfoKHR">VkVideoEncodeH264NaluSliceInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264NaluSliceInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264NaluSliceInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                             <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                 <span class="n">constantQp</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoEncodeH264SliceHeader</span><span class="o">*</span>    <span class="n">pStdSliceHeader</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264NaluSliceInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>constantQp</code> is the QP to use for the slice if the current
<a href="chap36.html#encode-rate-control-modes">rate control mode</a> configured for the video
session is <code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>pStdSliceHeader</code> is a pointer to a
<code>StdVideoEncodeH264SliceHeader</code> structure specifying
<a href="chap36.html#encode-h264-slice-header-params">H.264 slice header parameters</a> for
the slice.</p>
</li>
</ul>
</div>
<div id="encode-h264-slice-header-params" class="dlist">
<dl>
<dt class="hdlist1">Std Slice Header Parameters</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH264SliceHeader</code> structure pointed to
by <code>pStdSliceHeader</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p>if <code>pWeightTable</code> is not <code>NULL</code>, then it is a pointer to a
<code>StdVideoEncodeH264WeightTable</code> that is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p>all other members of <code>StdVideoEncodeH264WeightTable</code> are interpreted
as defined in section 7.4.3.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members are interpreted as defined in section 7.4.3 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264NaluSliceInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264NaluSliceInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264NaluSliceInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_NALU_SLICE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264NaluSliceInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeH264NaluSliceInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeH264NaluSliceInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264NaluSliceInfoKHR-pStdSliceHeader-parameter" href="chap36.html#VUID-VkVideoEncodeH264NaluSliceInfoKHR-pStdSliceHeader-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264NaluSliceInfoKHR-pStdSliceHeader-parameter</span><br>
 <code>pStdSliceHeader</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoEncodeH264SliceHeader</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH264DpbSlotInfoKHR">VkVideoEncodeH264DpbSlotInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264DpbSlotInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                               <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoEncodeH264ReferenceInfo</span><span class="o">*</span>    <span class="n">pStdReferenceInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264DpbSlotInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoEncodeH264ReferenceInfo</code> structure specifying
<a href="chap36.html#encode-h264-reference-info">H.264 reference information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="chap36.html#encode-h264">H.264
encode operation</a>.</p>
</div>
<div id="encode-h264-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code>, one element is added to
the list of <a href="chap36.html#encode-active-reference-picture-info">active reference
pictures</a> used by the video encode operation for each element of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#encode-h264-picture-data-access">H.264 Encode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reference picture is associated with the <a href="chap36.html#dpb-slot">DPB slot</a> index
specified in the <code>slotIndex</code> member of the corresponding element of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>The reference picture is associated with the
<a href="chap36.html#encode-h264-reference-info">H.264 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h264-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#encode-h264-picture-data-access">H.264 Encode Picture Data Access</a>
section.</p>
</li>
<li>
<p>If <a href="chap36.html#encode-h264-ref-pic-setup">reference picture setup</a> is requested,
then the reconstructed picture is used to <a href="chap36.html#dpb-slot-states">activate</a>
the <a href="chap36.html#dpb-slot">DPB slot</a> with the index specified in
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="chap36.html#encode-h264-reference-info">H.264 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h264-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH264ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as “used for long-term reference” as defined in
section 8.2.5.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>primary_pic_type</code> as defined in section 7.4.2 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>long_term_pic_num</code> and <code>long_term_frame_idx</code> as defined in
section 7.4.3 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p><code>temporal_id</code> as defined in section G.7.4.1.1 of the <a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>;</p>
</li>
<li>
<p>all other members are interpreted as defined in section 8.2 of the
<a href="chap2.html#itu-t-h264">ITU-T H.264 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264DpbSlotInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="chap36.html#VUID-VkVideoEncodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoEncodeH264ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-rate-control"><a class="anchor" href="chap36.html#encode-h264-rate-control"></a>36.17.11. H.264 Encode Rate Control</h4>
<div class="sect4">
<h5 id="encode-h264-gop"><a class="anchor" href="chap36.html#encode-h264-gop"></a>Group of Pictures</h5>
<div class="paragraph">
<p>In case of H.264 encoding it is common practice to follow a regular pattern
of different picture types in display order when encoding subsequent frames.
This pattern is referred to as the <em>group of pictures</em> (GOP).</p>
</div>
<div id="encode-h264-regular-gop" class="paragraph">
<p>A regular GOP is defined by the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of frames in the GOP;</p>
</li>
<li>
<p>The number of consecutive B frames between I and/or P frames in display
order.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>GOPs are further classified as <em>open</em> and <em>closed</em> GOPs.</p>
</div>
<div class="paragraph">
<p>Frame types in an open GOP follow each other in display order according to
the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The first frame is always an I frame.</p>
</li>
<li>
<p>This is followed by a number of consecutive B frames, as defined above.</p>
</li>
<li>
<p>If the number of frames in the GOP is not reached yet, then the next
frame is a P frame and the algorithm continues from step 2.</p>
</li>
</ol>
</div>
<div id="encode-h264-open-gop" class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="641px" height="192px" viewBox="-0.5 -0.5 641 192" style="background-color: rgb(255, 255, 255);"><defs></defs><g><rect x="80" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 81px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="95" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="50" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 51px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="65" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><rect x="110" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 111px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="125" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="140" y="80" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="155" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="170" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="185" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="200" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="215" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="230" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 231px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="245" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="260" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="275" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="290" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="305" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="320" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 321px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="335" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="350" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 351px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="365" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="380" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="395" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="410" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 411px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="425" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="440" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 441px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="455" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="500" y="80" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 501px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="515" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="530" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 531px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="545" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="470" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="485" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="560" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="575" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 139.31 80 L 139 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path><path d="M 499.31 80 L 500 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path><path d="M 146.37 60 L 493.63 60" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 141.12 60 L 148.12 56.5 L 146.37 60 L 148.12 63.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 498.88 60 L 491.88 63.5 L 493.63 60 L 491.88 56.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 70px; margin-left: 309px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">GOP frame count</div></div></div></foreignObject><text x="309" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">GOP frame count</text></switch></g><path d="M 170 140 L 169.52 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path><path d="M 176.37 130 L 253.63 130" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 171.12 130 L 178.12 126.5 L 176.37 130 L 178.12 133.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 258.88 130 L 251.88 133.5 L 253.63 130 L 251.88 126.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 130px; margin-left: 335px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">consecutive B-frame count</div></div></div></foreignObject><text x="335" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">consecutive B-frame count</text></switch></g><path d="M 260 140 L 260 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 26. H.264 open GOP</div>
</div>
<div id="encode-h264-idr-period" class="paragraph">
<p>In case of a closed GOP, an <a href="chap36.html#encode-h264-idr-pic">IDR frame</a> is used at a
certain period.</p>
</div>
<div id="encode-h264-closed-gop" class="imageblock text-center">
<div class="content">
<svg version="1.1" width="641px" height="192px" viewBox="-0.5 -0.5 641 192" style="background-color: rgb(255, 255, 255);" id="svg216" sodipodi:docname="h26x_closed_gop.svg" inkscape:version="1.2.2 (732a01da63, 2022-12-09, custom)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <sodipodi:namedview id="namedview218" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" inkscape:showpageshadow="2" inkscape:pageopacity="0.0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="2.0436817" inkscape:cx="389.98244" inkscape:cy="40.612977" inkscape:window-width="1920" inkscape:window-height="1043" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="g206"></sodipodi:namedview>
  <defs id="defs18"></defs>
  <g id="g206">
    <path d="M 139.6 80 L 139.6 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path20"></path>
    <path d="M 500 80 L 500.48 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path22"></path>
    <path d="M 140 140 L 140 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path24"></path>
    <path d="M 320 140 L 320 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path26"></path>
    <path d="M 146.37 130 L 313.63 130" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke" id="path28"></path>
    <path d="M 141.12 130 L 148.12 126.5 L 146.37 130 L 148.12 133.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path30"></path>
    <path d="M 318.88 130 L 311.88 133.5 L 313.63 130 L 311.88 126.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path32"></path>
    <g transform="translate(-0.5 -0.5)" id="g38">
      <switch id="switch36">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 120px; margin-left: 225px;">
            <xhtml:div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">GOP frame count</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="225" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" id="text34">GOP frame count</text>
      </switch>
    </g>
    <path d="M 146.37 60 L 493.63 60" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke" id="path40"></path>
    <path d="M 141.12 60 L 148.12 56.5 L 146.37 60 L 148.12 63.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path42"></path>
    <path d="M 498.88 60 L 491.88 63.5 L 493.63 60 L 491.88 56.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path44"></path>
    <g transform="translate(-0.5 -0.5)" id="g50">
      <switch id="switch48">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 70px; margin-left: 309px;">
            <xhtml:div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">IDR period</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="309" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" id="text46">IDR period</text>
      </switch>
    </g>
    <rect x="80" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all" id="rect62"></rect>
    <g transform="translate(-0.5 -0.5)" id="g68">
      <switch id="switch66">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 81px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="95" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text64">B</text>
      </switch>
    </g>
    <rect x="50" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all" id="rect70"></rect>
    <g transform="translate(-0.5 -0.5)" id="g76">
      <switch id="switch74">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 51px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="65" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text72">...</text>
      </switch>
    </g>
    <rect x="110" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all" id="rect78"></rect>
    <g transform="translate(-0.5 -0.5)" id="g84">
      <switch id="switch82">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 111px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="125" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text80">B</text>
      </switch>
    </g>
    <rect x="140" y="80" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect86"></rect>
    <g transform="translate(-0.5 -0.5)" id="g92">
      <switch id="switch90">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 141px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">IDR</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="155" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text88">IDR</text>
      </switch>
    </g>
    <rect x="170" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect94"></rect>
    <g transform="translate(-0.5 -0.5)" id="g100">
      <switch id="switch98">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 171px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="185" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text96">B</text>
      </switch>
    </g>
    <rect x="200" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect102"></rect>
    <g transform="translate(-0.5 -0.5)" id="g108">
      <switch id="switch106">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 201px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="215" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text104">B</text>
      </switch>
    </g>
    <rect x="230" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect110"></rect>
    <g transform="translate(-0.5 -0.5)" id="g116">
      <switch id="switch114">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 231px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="245" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text112">P</text>
      </switch>
    </g>
    <rect x="260" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect118"></rect>
    <g transform="translate(-0.5 -0.5)" id="g124">
      <switch id="switch122">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 261px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="275" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text120">B</text>
      </switch>
    </g>
    <rect x="290" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect126"></rect>
    <g transform="translate(-0.5 -0.5)" id="g132">
      <switch id="switch130">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 291px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="305" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text128">B</text>
      </switch>
    </g>
    <rect x="350" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect134"></rect>
    <g transform="translate(-0.5 -0.5)" id="g140">
      <switch id="switch138">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 351px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="365" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text136">B</text>
      </switch>
    </g>
    <rect x="410" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect142"></rect>
    <g transform="translate(-0.5 -0.5)" id="g148">
      <switch id="switch146">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 411px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="425" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text144">P</text>
      </switch>
    </g>
    <rect x="380" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect150"></rect>
    <g transform="translate(-0.5 -0.5)" id="g156">
      <switch id="switch154">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 381px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="395" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text152">B</text>
      </switch>
    </g>
    <rect x="440" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect158"></rect>
    <g transform="translate(-0.5 -0.5)" id="g164">
      <switch id="switch162">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 441px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="455" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text160">B</text>
      </switch>
    </g>
    <rect x="500" y="80" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all" id="rect166"></rect>
    <g transform="translate(-0.5 -0.5)" id="g172">
      <switch id="switch170">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 501px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">IDR</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="515" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text168">IDR</text>
      </switch>
    </g>
    <rect x="530" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all" id="rect174"></rect>
    <g transform="translate(-0.5 -0.5)" id="g180">
      <switch id="switch178">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 531px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="545" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text176">B</text>
      </switch>
    </g>
    <rect x="560" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all" id="rect182"></rect>
    <g transform="translate(-0.5 -0.5)" id="g188">
      <switch id="switch186">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 561px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="575" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text184">...</text>
      </switch>
    </g>
    <rect x="320" y="80" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect190"></rect>
    <g transform="translate(-0.5 -0.5)" id="g196">
      <switch id="switch194">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 321px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="335" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text192">I</text>
      </switch>
    </g>
    <rect x="470.03387" y="79.997772" width="30" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" id="rect158-0"></rect>
    <g transform="translate(30.240538,-0.39011911)" id="g164-8">
      <switch id="switch162-6">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 441px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="455" y="99" fill="#000000" font-family="'Roboto Mono'" font-size="14px" text-anchor="middle" id="text160-2">B</text>
      </switch>
    </g>
  </g>
  <switch id="switch214">
    <g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" id="g208"></g>
    <a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank" id="a212">
      <text text-anchor="middle" font-size="10px" x="50%" y="100%" id="text210">Text is not SVG - cannot display</text>
    </a>
  </switch>
</svg>
</div>
<div class="title">Figure 27. H.264 closed GOP</div>
</div>
<div class="paragraph">
<p>It is also typical for H.264 encoding to use specific reference picture
usage patterns across the frames of the GOP.
The two most common reference patterns used are as follows:</p>
</div>
<div id="encode-h264-ref-pattern-flat" class="dlist">
<dl>
<dt class="hdlist1">Flat Reference Pattern</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Each P frame uses the last non-B frame, in display order, as reference.</p>
</li>
<li>
<p>Each B frame uses the last non-B frame, in display order, as its
backward reference, and uses the next non-B frame, in display order, as
its forward reference.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="641px" height="221px" viewBox="-0.5 -0.5 641 221" style="background-color: rgb(255, 255, 255);"><defs></defs><g><rect x="80" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 81px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="95" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="50" y="100" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 51px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="65" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><rect x="110" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 111px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="125" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="140" y="100" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="155" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><path d="M 177.5 100 Q 177.51 80.03 170 80.03 Q 162.49 80.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 158.99 91.88 L 162.5 93.63 L 165.99 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 192.5 130 Q 192.49 170.03 230 170.03 Q 267.51 170.03 267.5 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.12 L 271 138.12 L 267.5 136.37 L 264 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="170" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="185" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 207.5 100 Q 207.51 70.03 185 70.03 Q 162.49 70.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 159 91.88 L 162.5 93.63 L 166 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 222.5 130 Q 222.49 160.03 245 160.03 Q 267.51 160.03 267.5 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.12 L 271 138.12 L 267.5 136.37 L 264 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="200" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="215" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 237.5 100 Q 237.51 60.03 200 60.03 Q 162.49 60.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 159 91.88 L 162.5 93.63 L 166 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 252.5 130 Q 252.49 150.03 260 150.03 Q 267.51 150.03 267.5 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.12 L 271.01 138.12 L 267.5 136.37 L 264.01 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="230" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 231px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="245" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 267.5 100 Q 267.51 50.03 215 50.03 Q 162.49 50.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 159 91.88 L 162.5 93.63 L 166 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="260" y="100" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="275" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="290" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="305" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="320" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 321px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="335" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="350" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 351px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="365" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="380" y="100" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="395" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="410" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 411px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="425" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="440" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 441px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="455" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="500" y="100" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 501px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="515" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="530" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 531px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="545" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="470" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="485" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="560" y="100" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="575" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 297.5 100 Q 296.49 100.03 296.49 90.03 Q 296.49 80.03 289.49 80.03 Q 282.49 80.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 278.99 91.88 L 282.5 93.63 L 285.99 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 327.5 100 Q 327.51 70.03 305 70.03 Q 282.49 70.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 279 91.88 L 282.5 93.63 L 286 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 357.5 100 Q 357.51 60.03 320 60.03 Q 282.49 60.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 279 91.88 L 282.5 93.63 L 286 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 387.5 100 Q 387.51 50.03 335 50.03 Q 282.49 50.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 279 91.88 L 282.5 93.63 L 286 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 417 100 Q 416.03 80.03 409.03 80.03 Q 402.03 80.03 402.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402 98.88 L 398.51 91.88 L 402.01 93.63 L 405.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 447 100 Q 447 70.03 424.51 70.03 Q 402.03 70.03 402.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402 98.88 L 398.51 91.88 L 402.01 93.63 L 405.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 477 100 Q 477 60.03 439.51 60.03 Q 402.03 60.03 402 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402 98.88 L 398.51 91.88 L 402 93.63 L 405.51 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 312 130 Q 312.03 170.03 349.51 170.03 Q 387 170.03 387 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.12 L 390.5 138.12 L 387 136.37 L 383.5 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 342 130 Q 342.03 160.03 364.51 160.03 Q 387 160.03 387 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.12 L 390.5 138.12 L 387 136.37 L 383.5 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 372 130 Q 372.03 150.03 379.51 150.03 Q 387 150.03 387 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.12 L 390.5 138.12 L 387 136.37 L 383.5 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 433 130 Q 433 170.03 470.51 170.03 Q 508.03 170.03 508 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 508 131.12 L 511.51 138.12 L 508 136.37 L 504.51 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 463 130 Q 463 160.03 485.51 160.03 Q 508.03 160.03 508.01 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 508 131.12 L 511.51 138.11 L 508.01 136.37 L 504.51 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 493 130 Q 493 150.03 500.51 150.03 Q 508.03 150.03 508.01 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 508 131.12 L 511.51 138.11 L 508.01 136.37 L 504.51 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 28. H.264 flat reference pattern</div>
</div>
<div id="encode-h264-ref-pattern-dyadic" class="dlist">
<dl>
<dt class="hdlist1">Dyadic Reference Pattern</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Each P frame uses the last non-B frame, in display order, as reference.</p>
</li>
<li>
<p>The following algorithm is applied to the sequence of consecutive B
frames between I and/or P frames in display order:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The B frame in the middle of this sequence uses the frame preceding the
sequence as its backward reference, and uses the frame following the
sequence as its forward reference.</p>
</li>
<li>
<p>The algorithm is executed recursively for the following frame sequences:</p>
<div class="ulist">
<ul>
<li>
<p>The B frames of the original sequence preceding the frame in the
middle, if any.</p>
</li>
<li>
<p>The B frames of the original sequence following the frame in the
middle, if any.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="641px" height="212px" viewBox="-0.5 -0.5 641 212" style="background-color: rgb(255, 255, 255);"><defs></defs><g><rect x="80" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 81px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="95" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="50" y="99.97" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 51px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="65" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><rect x="110" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 111px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="125" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="140" y="99.97" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="155" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><path d="M 177.5 99.97 Q 177.51 79.97 170 79.97 Q 162.49 79.97 162.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.85 L 158.99 91.85 L 162.5 93.6 L 165.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 192.5 129.97 Q 192.49 150.03 200 150.03 Q 207.51 150.03 207.5 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 207.5 131.09 L 211.01 138.09 L 207.5 136.34 L 204.01 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="170" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="185" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 207.5 99.97 Q 207.51 69.97 185 69.97 Q 162.49 69.97 162.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.85 L 159 91.85 L 162.5 93.6 L 166 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 222.5 129.97 Q 222.49 159.97 245 159.97 Q 267.51 159.97 267.5 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.09 L 271 138.09 L 267.5 136.34 L 264 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="200" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="215" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 252.5 129.97 Q 252.49 149.97 260 149.97 Q 267.51 149.97 267.5 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.09 L 271.01 138.09 L 267.5 136.34 L 264.01 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 237.5 99.97 Q 237.51 80.03 230 80.03 Q 222.49 80.03 222.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 222.5 98.85 L 218.99 91.85 L 222.5 93.6 L 225.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="230" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 231px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="245" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 267.5 99.97 Q 267.51 49.97 215 49.97 Q 162.49 49.97 162.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.85 L 159 91.85 L 162.5 93.6 L 166 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="260" y="99.97" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="275" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="290" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="305" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="320" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 321px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="335" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="350" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 351px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="365" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="380" y="99.97" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="395" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="410" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 411px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="425" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="440" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 441px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="455" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="500" y="99.97" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 501px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="515" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="530" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 531px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="545" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="470" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="485" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="560" y="99.97" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="575" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 297.5 99.97 Q 296.49 100.03 296.49 89.97 Q 296.49 79.91 289.49 79.91 Q 282.49 79.91 282.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.85 L 278.99 91.85 L 282.5 93.6 L 285.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 327.5 99.97 Q 327.51 69.91 305 69.91 Q 282.49 69.91 282.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.85 L 279 91.85 L 282.5 93.6 L 286 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 357.5 99.97 Q 357.51 79.97 350 79.97 Q 342.49 79.97 342.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 342.5 98.85 L 338.99 91.85 L 342.5 93.6 L 345.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 387.5 99.97 Q 387.51 49.91 335 49.91 Q 282.49 49.91 282.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.85 L 279 91.85 L 282.5 93.6 L 286 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 417.49 99.94 Q 416.49 99.91 416.49 89.91 Q 416.49 79.91 409.49 79.91 Q 402.49 79.91 402.49 93.57" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402.49 98.82 L 398.99 91.82 L 402.49 93.57 L 405.99 91.82 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 447.49 99.94 Q 447.51 69.91 425 69.91 Q 402.49 69.91 402.49 93.57" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402.49 98.82 L 398.99 91.82 L 402.49 93.57 L 405.99 91.82 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 477.49 99.94 Q 477.51 79.91 470 79.91 Q 462.49 79.91 462.49 93.57" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 462.49 98.82 L 458.99 91.82 L 462.49 93.57 L 465.99 91.82 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 312 129.97 Q 312.03 149.97 319.51 149.97 Q 327 149.97 327 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 327 131.09 L 330.5 138.09 L 327 136.34 L 323.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 342 129.97 Q 342.03 159.91 364.51 159.91 Q 387 159.91 387 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.09 L 390.5 138.09 L 387 136.34 L 383.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 372 129.97 Q 372.03 149.91 379.51 149.91 Q 387 149.91 387 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.09 L 390.5 138.09 L 387 136.34 L 383.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 432 129.97 Q 432.03 149.97 439.51 149.97 Q 447 149.97 447 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 447 131.09 L 450.5 138.09 L 447 136.34 L 443.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 462 129.97 Q 462.03 159.91 484.51 159.91 Q 507 159.91 507 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 507 131.09 L 510.5 138.09 L 507 136.34 L 503.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 492 129.97 Q 492.03 149.91 499.51 149.91 Q 507 149.91 507 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 507 131.09 L 510.5 138.09 L 507 136.34 L 503.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 29. H.264 dyadic reference pattern</div>
</div>
<div class="paragraph">
<p>The application <strong class="purple">can</strong> provide guidance to the implementation’s rate control
algorithm about the structure of the GOP used by the application.
Any such guidance about the GOP and its structure does not mandate that
specific GOP structure to be used by the application, as the picture type of
individual encoded pictures is still application-controlled, however, any
deviation from the provided guidance <strong class="purple">may</strong> result in undesired rate control
behavior including, but not limited, to the implementation not being able to
conform to the expected average or target bitrates, or other rate control
parameters specified by the application.</p>
</div>
<div class="paragraph">
<p>When an H.264 encode session is used to encode multiple temporal layers, it
is also common practice to follow a regular pattern for the H.264 temporal
ID for the encoded pictures in display order when encoding subsequent
frames.
This pattern is referred to as the <em>temporal GOP</em>.
The most common temporal layer pattern used is as follows:</p>
</div>
<div id="encode-h264-layer-pattern-dyadic" class="dlist">
<dl>
<dt class="hdlist1">Dyadic Temporal Layer Pattern</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The number of frames in the temporal GOP is <span class="eq">2<sup>n-1</sup></span>, where <span class="eq">n</span>
is the number of temporal layers.</p>
</li>
<li>
<p>The <span class="eq">i</span><sup>th</sup> frame in the temporal GOP uses temporal ID <span class="eq">t</span>, if
and only if the index of the least significant bit set in <span class="eq">i</span> equals
<span class="eq">n-t-1</span>, except for the first frame, which is the only frame in the
temporal GOP using temporal ID zero.</p>
</li>
<li>
<p>The <span class="eq">i</span><sup>th</sup> frame in the temporal GOP uses the <span class="eq">r</span><sup>th</sup> frame as
reference, where <span class="eq">r</span> is calculated from <span class="eq">i</span> by clearing the
least significant bit set in it, except for the first frame in the
temporal GOP, which uses the first frame of the previous temporal GOP,
if any, as reference.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="649px" height="321px" viewBox="-0.5 -0.5 649 321"><defs></defs><g><rect x="120" y="180" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><rect x="90" y="180" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 195px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="100" y="199" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="90" y="140" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 155px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="100" y="159" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><rect x="90" y="100" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 115px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="100" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><rect x="90" y="60" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 75px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="100" y="79" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><rect x="50" y="50" width="40" height="160" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)rotate(-90 70 130)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 130px; margin-left: -9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Temporal Layer</div></div></div></foreignObject><text x="70" y="135" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">Temporal Layer</text></switch></g><rect x="120" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 121px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="130" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="150" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 151px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="160" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><rect x="180" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="190" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><rect x="210" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 211px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="220" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><rect x="240" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 241px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="250" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">4</text></switch></g><rect x="270" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 271px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">5</div></div></div></foreignObject><text x="280" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">5</text></switch></g><rect x="300" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 301px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">6</div></div></div></foreignObject><text x="310" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">6</text></switch></g><rect x="330" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 331px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">7</div></div></div></foreignObject><text x="340" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">7</text></switch></g><rect x="120" y="240" width="470" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 255px; margin-left: 121px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Temporal GOP Index</div></div></div></foreignObject><text x="355" y="260" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">Temporal GOP Index</text></switch></g><path d="M 150 75 Q 130.03 75.03 130.03 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 130.03 178.88 L 126.53 171.88 L 130.03 173.63 L 133.53 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="150" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 180 115.03 Q 130.03 115.03 130 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 130 178.88 L 126.5 171.88 L 130 173.63 L 133.5 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="180" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 210 75.03 Q 190.03 75.03 190.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 190 98.88 L 186.51 91.88 L 190.01 93.63 L 193.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="210" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 240 155.03 Q 130.03 155.03 130.01 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 130 178.88 L 126.51 171.88 L 130.01 173.63 L 133.51 171.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="240" y="140" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 270 75.03 Q 250.03 75.03 250 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 250 138.88 L 246.5 131.88 L 250 133.63 L 253.5 131.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="270" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 300 115.03 Q 250.03 115.03 250.01 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 250 138.88 L 246.51 131.88 L 250.01 133.63 L 253.51 131.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="300" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 330 75.03 Q 310.03 75.03 310.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 310 98.88 L 306.51 91.88 L 310.01 93.63 L 313.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="330" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 360 195 L 146.37 195" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 141.12 195 L 148.12 191.5 L 146.37 195 L 148.12 198.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="360" y="180" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 390 75 Q 370.03 75.03 370.03 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370.03 178.88 L 366.53 171.88 L 370.03 173.63 L 373.53 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="390" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 420 115.03 Q 370.03 115.03 370 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370 178.88 L 366.5 171.88 L 370 173.63 L 373.5 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="420" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 450 75.03 Q 429.97 75.03 429.99 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 430 98.88 L 426.49 91.89 L 429.99 93.63 L 433.49 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="450" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 480 155.03 Q 370.03 155.03 370.01 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370 178.88 L 366.51 171.88 L 370.01 173.63 L 373.51 171.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="480" y="140" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 510 75.03 Q 489.97 75.03 490 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 490 138.88 L 486.5 131.88 L 490 133.63 L 493.5 131.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="510" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 540 115.03 Q 489.97 115.03 489.99 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 490 138.88 L 486.49 131.89 L 489.99 133.63 L 493.49 131.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="540" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 570 75.03 Q 549.97 75.03 549.99 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 550 98.88 L 546.49 91.89 L 549.99 93.63 L 553.49 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="570" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 590 195 L 386.33 194.7" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 381.08 194.69 L 388.09 191.2 L 386.33 194.7 L 388.08 198.2 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="360" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 361px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="370" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="390" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 391px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="400" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><rect x="420" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 421px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="430" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><rect x="450" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 451px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="460" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><rect x="480" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 481px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="490" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">4</text></switch></g><rect x="510" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 511px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">5</div></div></div></foreignObject><text x="520" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">5</text></switch></g><rect x="540" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 541px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">6</div></div></div></foreignObject><text x="550" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">6</text></switch></g><rect x="570" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 571px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">7</div></div></div></foreignObject><text x="580" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">7</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 30. H.264 dyadic temporal layer pattern</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Multi-layer rate control and multi-layer coding are typically used for
streaming cases where low latency is expected, hence B pictures with forward
prediction are usually not used.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264RateControlInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264RateControlInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264RateControlInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                             <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264RateControlFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">gopFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">idrPeriod</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">consecutiveBFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">temporalLayerCount</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264RateControlInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH264RateControlFlagBitsKHR">VkVideoEncodeH264RateControlFlagBitsKHR</a> specifying H.264 rate
control flags.</p>
</li>
<li>
<p><code>gopFrameCount</code> is the number of frames within a <a href="chap36.html#encode-h264-gop">group of pictures (GOP)</a> intended to be used by the application.
If it is set to 0, the rate control algorithm <strong class="purple">may</strong> assume an
implementation-dependent GOP length.
If it is set to <code>UINT32_MAX</code>, the GOP length is treated as infinite.</p>
</li>
<li>
<p><code>idrPeriod</code> is the interval, in terms of number of frames, between
two <a href="chap36.html#encode-h264-idr-pic">IDR frames</a> (see <a href="chap36.html#encode-h264-idr-period">IDR
period</a>).
If it is set to 0, the rate control algorithm <strong class="purple">may</strong> assume an
implementation-dependent IDR period.
If it is set to <code>UINT32_MAX</code>, the IDR period is treated as infinite.</p>
</li>
<li>
<p><code>consecutiveBFrameCount</code> is the number of consecutive B frames
between I and/or P frames within the <a href="chap36.html#encode-h264-gop">GOP</a>.</p>
</li>
<li>
<p><code>temporalLayerCount</code> specifies the number of H.264 temporal layers
that the application intends to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an instance of this structure is included in the <code>pNext</code> chain of
the <a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure passed to the
<a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command, and
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, the parameters in
this structure are used as guidance for the implementation’s rate control
algorithm (see <a href="chap36.html#video-coding-control">Video Coding Control</a>).</p>
</div>
<div class="paragraph">
<p>If <code>flags</code> includes
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</code>, then
the rate control state is reset to an initial state to meet HRD compliance
requirements.
Otherwise the new rate control state <strong class="purple">may</strong> be applied without a reset
depending on the implementation and the specified rate control parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It would be possible to infer the picture type to be used when encoding a
frame, on the basis of the values provided for <code>consecutiveBFrameCount</code>,
<code>idrPeriod</code>, and <code>gopFrameCount</code>, but this inferred picture type
will not be used by implementations to override the picture type provided to
the video encode operation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08280" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08280"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08280</span><br>

If <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_HRD_COMPLIANCE_BIT_KHR</code>, then
<code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08281" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08281"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08281</span><br>

If <code>flags</code> contains
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</code>
or
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</code>,
then it <strong class="purple">must</strong> also contain
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REGULAR_GOP_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08282" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08282"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08282</span><br>

If <code>flags</code> contains
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</code>,
then it <strong class="purple">must</strong> not also contain
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08283" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08283"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-flags-08283</span><br>

If <code>flags</code> contains
<code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REGULAR_GOP_BIT_KHR</code>, then
<code>gopFrameCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-idrPeriod-08284" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-idrPeriod-08284"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-idrPeriod-08284</span><br>

If <code>idrPeriod</code> is not <code>0</code>, then it <strong class="purple">must</strong> be greater than or equal to
<code>gopFrameCount</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-consecutiveBFrameCount-08285" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-consecutiveBFrameCount-08285"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-consecutiveBFrameCount-08285</span><br>

If <code>consecutiveBFrameCount</code> is not <code>0</code>, then it <strong class="purple">must</strong> be less than
<code>gopFrameCount</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_RATE_CONTROL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlInfoKHR-flags-parameter" href="chap36.html#VUID-VkVideoEncodeH264RateControlInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoEncodeH264RateControlFlagBitsKHR">VkVideoEncodeH264RateControlFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in
<a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a>::<code>flags</code>, specifying H.264
rate control flags, are:</p>
</div>
<div id="VkVideoEncodeH264RateControlFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH264RateControlFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H264_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_RATE_CONTROL_REGULAR_GOP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H264_RATE_CONTROL_TEMPORAL_LAYER_PATTERN_DYADIC_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264RateControlFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</code>
specifies that rate control <strong class="purple">should</strong> attempt to produce an HRD compliant
bitstream, as defined in annex C of the <a href="chap2.html#itu-t-h264">ITU-T H.264
Specification</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REGULAR_GOP_BIT_KHR</code> specifies
that the application intends to use a <a href="chap36.html#encode-h264-regular-gop">regular
GOP structure</a> according to the parameters specified in the
<code>gopFrameCount</code>, <code>idrPeriod</code>, and <code>consecutiveBFrameCount</code>
members of the <a href="chap36.html#VkVideoEncodeH264RateControlInfoKHR">VkVideoEncodeH264RateControlInfoKHR</a> structure.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</code>
specifies that the application intends to follow a
<a href="chap36.html#encode-h264-ref-pattern-flat">flat reference pattern</a> in the GOP.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</code>
specifies that the application intends to follow a
<a href="chap36.html#encode-h264-ref-pattern-dyadic">dyadic reference pattern</a> in the GOP.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H264_RATE_CONTROL_TEMPORAL_LAYER_PATTERN_DYADIC_BIT_KHR</code>
specifies that the application intends to follow a
<a href="chap36.html#encode-h264-layer-pattern-dyadic">dyadic temporal layer pattern</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH264RateControlFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH264RateControlFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH264RateControlFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="chap36.html#VkVideoEncodeH264RateControlFlagBitsKHR">VkVideoEncodeH264RateControlFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="encode-h264-rate-control-layer"><a class="anchor" href="chap36.html#encode-h264-rate-control-layer"></a>Rate Control Layers</h5>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264RateControlLayerInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264RateControlLayerInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264RateControlLayerInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">useMinQp</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264QpKHR</span>           <span class="n">minQp</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">useMaxQp</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264QpKHR</span>           <span class="n">maxQp</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">useMaxFrameSize</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH264FrameSizeKHR</span>    <span class="n">maxFrameSize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264RateControlLayerInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMinQp</code> indicates whether the QP values determined by rate
control will be clamped to the lower bounds on the QP values specified
in <code>minQp</code>.</p>
</li>
<li>
<p><code>minQp</code> specifies the lower bounds on the QP values, for each
picture type, that the implementation’s rate control algorithm will use
when <code>useMinQp</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>useMaxQp</code> indicates whether the QP values determined by rate
control will be clamped to the upper bounds on the QP values specified
in <code>maxQp</code>.</p>
</li>
<li>
<p><code>maxQp</code> specifies the upper bounds on the QP values, for each
picture type, that the implementation’s rate control algorithm will use
when <code>useMaxQp</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>useMaxFrameSize</code> indicates whether the implementation’s rate
control algorithm <strong class="purple">should</strong> use the values specified in <code>maxFrameSize</code>
as the upper bounds on the encoded frame size for each picture type.</p>
</li>
<li>
<p><code>maxFrameSize</code> specifies the upper bounds on the encoded frame size,
for each picture type, when <code>useMaxFrameSize</code> is set to
<code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When used, the values in <code>minQp</code> and <code>maxQp</code> guarantee that the
effective QP values used by the implementation will respect those lower and
upper bounds, respectively.
However, limiting the range of QP values that the implementation is able to
use will also limit the capabilities of the implementation’s rate control
algorithm to comply to other constraints.
In particular, the implementation <strong class="purple">may</strong> not be able to comply to the
following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The average and/or peak <a href="chap36.html#encode-bitrate">bitrate</a> values to be used for
the encoded bitstream specified in the <code>averageBitrate</code> and
<code>maxBitrate</code> members of the
<a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structure.</p>
</li>
<li>
<p>The upper bounds on the encoded frame size, for each picture type,
specified in the <code>maxFrameSize</code> member of
<code>VkVideoEncodeH264RateControlLayerInfoKHR</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In general, applications need to configure rate control parameters
appropriately in order to be able to get the desired rate control behavior,
as described in the <a href="chap36.html#encode-rate-control">Video Encode Rate Control</a>
section.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When an instance of this structure is included in the <code>pNext</code> chain of a
<a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structure specified in one of the
elements of the <code>pLayers</code> array member of the
<a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure passed to the
<a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command,
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, and the bound
video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, it specifies the
H.264-specific rate control parameters of the rate control layer
corresponding to that element of <code>pLayers</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08286" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08286"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08286</span><br>

If <code>useMinQp</code> is <code>VK_TRUE</code>, then the <code>qpI</code>, <code>qpP</code>, and
<code>qpB</code> members of <code>minQp</code> <strong class="purple">must</strong> all be between
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>minQp</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxQp</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMaxQp-08287" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMaxQp-08287"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMaxQp-08287</span><br>

If <code>useMaxQp</code> is <code>VK_TRUE</code>, then the <code>qpI</code>, <code>qpP</code>, and
<code>qpB</code> members of <code>maxQp</code> <strong class="purple">must</strong> all be between
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>minQp</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>maxQp</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08288" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08288"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08288</span><br>

If <code>useMinQp</code> is <code>VK_TRUE</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</code>,
then the <code>qpI</code>, <code>qpP</code>, and <code>qpB</code> members of <code>minQp</code>
<strong class="purple">must</strong> all specify the same value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMaxQp-08289" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMaxQp-08289"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMaxQp-08289</span><br>

If <code>useMaxQp</code> is <code>VK_TRUE</code> and
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H264_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</code>,
then the <code>qpI</code>, <code>qpP</code>, and <code>qpB</code> members of <code>maxQp</code>
<strong class="purple">must</strong> all specify the same value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08374" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08374"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-useMinQp-08374</span><br>

If <code>useMinQp</code> and <code>useMaxQp</code> are both <code>VK_TRUE</code>, then the
<code>qpI</code>, <code>qpP</code>, and <code>qpB</code> members of <code>minQp</code> <strong class="purple">must</strong> all be
less than or equal to the respective members of <code>maxQp</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_RATE_CONTROL_LAYER_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-minQp-parameter" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-minQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-minQp-parameter</span><br>
 <code>minQp</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeH264QpKHR">VkVideoEncodeH264QpKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-maxQp-parameter" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-maxQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-maxQp-parameter</span><br>
 <code>maxQp</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeH264QpKHR">VkVideoEncodeH264QpKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH264RateControlLayerInfoKHR-maxFrameSize-parameter" href="chap36.html#VUID-VkVideoEncodeH264RateControlLayerInfoKHR-maxFrameSize-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH264RateControlLayerInfoKHR-maxFrameSize-parameter</span><br>
 <code>maxFrameSize</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeH264FrameSizeKHR">VkVideoEncodeH264FrameSizeKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264QpKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264QpKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264QpKHR</span> <span class="p">{</span>
    <span class="kt">int32_t</span>    <span class="n">qpI</span><span class="p">;</span>
    <span class="kt">int32_t</span>    <span class="n">qpP</span><span class="p">;</span>
    <span class="kt">int32_t</span>    <span class="n">qpB</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264QpKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>qpI</code> is the QP to be used for <a href="chap36.html#encode-h264-i-pic">I pictures</a>.</p>
</li>
<li>
<p><code>qpP</code> is the QP to be used for <a href="chap36.html#encode-h264-p-pic">P pictures</a>.</p>
</li>
<li>
<p><code>qpB</code> is the QP to be used for <a href="chap36.html#encode-h264-b-pic">B pictures</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264FrameSizeKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264FrameSizeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264FrameSizeKHR</span> <span class="p">{</span>
    <span class="kt">uint32_t</span>    <span class="n">frameISize</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">framePSize</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">frameBSize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264FrameSizeKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>frameISize</code> is the size in bytes to be used for
<a href="chap36.html#encode-h264-i-pic">I pictures</a>.</p>
</li>
<li>
<p><code>framePSize</code> is the size in bytes to be used for
<a href="chap36.html#encode-h264-p-pic">P pictures</a>.</p>
</li>
<li>
<p><code>frameBSize</code> is the size in bytes to be used for
<a href="chap36.html#encode-h264-b-pic">B pictures</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="encode-h264-gop-remaining-frames"><a class="anchor" href="chap36.html#encode-h264-gop-remaining-frames"></a>GOP Remaining Frames</h5>
<div class="paragraph">
<p>Besides session level rate control configuration, the application <strong class="purple">can</strong>
specify the number of frames per frame type remaining in the
<a href="chap36.html#encode-h264-gop">group of pictures (GOP)</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH264GopRemainingFrameInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH264GopRemainingFrameInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h264</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH264GopRemainingFrameInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">useGopRemainingFrames</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">gopRemainingI</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">gopRemainingP</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">gopRemainingB</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH264GopRemainingFrameInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useGopRemainingFrames</code> indicates whether the implementation’s rate
control algorithm <strong class="purple">should</strong> use the values specified in
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code>.
If <code>useGopRemainingFrames</code> is <code>VK_FALSE</code>, then the values of
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code> are
ignored.</p>
</li>
<li>
<p><code>gopRemainingI</code> specifies the number of <a href="chap36.html#encode-h264-i-pic">I
frames</a> the implementation’s rate control algorithm <strong class="purple">should</strong> assume to
be remaining in the <a href="chap36.html#encode-h264-gop">GOP</a> prior to executing the video
encode operation.</p>
</li>
<li>
<p><code>gopRemainingP</code> specifies the number of <a href="chap36.html#encode-h264-p-pic">P
frames</a> the implementation’s rate control algorithm <strong class="purple">should</strong> assume to
be remaining in the <a href="chap36.html#encode-h264-gop">GOP</a> prior to executing the video
encode operation.</p>
</li>
<li>
<p><code>gopRemainingB</code> specifies the number of <a href="chap36.html#encode-h264-b-pic">B
frames</a> the implementation’s rate control algorithm <strong class="purple">should</strong> assume to
be remaining in the <a href="chap36.html#encode-h264-gop">GOP</a> prior to executing the video
encode operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Setting <code>useGopRemainingFrames</code> to <code>VK_TRUE</code> and including this
structure in the <code>pNext</code> chain of <a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> is
only mandatory if the
<a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>requiresGopRemainingFrames</code>
reported for the used <a href="chap36.html#video-profiles">video profile</a> is <code>VK_TRUE</code>.
However, implementations <strong class="purple">may</strong> use these remaining frame counts, when
specified, even when it is not required.
In particular, when the application does not use a
<a href="chap36.html#encode-h264-regular-gop">regular GOP structure</a>, these values <strong class="purple">may</strong> provide
additional guidance for the implementation’s rate control algorithm.</p>
</div>
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a>::<code>prefersGopRemainingFrames</code>
capability is also used to indicate that the implementation’s rate control
algorithm <strong class="purple">may</strong> operate more accurately if the application specifies the
remaining frame counts using this structure.</p>
</div>
<div class="paragraph">
<p>As with other rate control guidance values, if the effective order and
number of frames encoded by the application are not in line with the
remaining frame counts specified in this structure at any given point, then
the behavior of the implementation’s rate control algorithm <strong class="purple">may</strong> deviate
from the one expected by the application.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH264GopRemainingFrameInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH264GopRemainingFrameInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH264GopRemainingFrameInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H264_GOP_REMAINING_FRAME_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-h264-requirements"><a class="anchor" href="chap36.html#encode-h264-requirements"></a>36.17.12. H.264 Encode Requirements</h4>
<div class="paragraph">
<p>This section described the <strong class="purple">required</strong> H.264 encoding capabilities for
physical devices that have at least one queue family that supports the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H264_BIT_KHR</code>, as
returned by <a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="chap5.html#VkQueueFamilyVideoPropertiesKHR">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. Required <a href="chap36.html#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_h264std_encode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. Required Video Capabilities</caption>
<colgroup>
<col style="width: 58.3333%;">
<col style="width: 23.3333%;">
<col style="width: 18.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Capability</th>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Requirement Type<sup>1</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferOffsetAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferSizeAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pictureAccessGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxDpbSlots</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxActiveReferencePictures</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rateControlModes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxBitrate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxQualityLevels</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>encodeInputPictureGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>supportedEncodeFeedbackFlags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BUFFER_OFFSET_BIT_KHR</code><br>
                                       <code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BYTES_WRITTEN_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoEncodeH264CapabilitiesKHR">VkVideoEncodeH264CapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxLevelIdc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STD_VIDEO_H264_LEVEL_IDC_1_0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxSliceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxPPictureL0ReferenceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxBPictureL0ReferenceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxL1ReferenceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxTemporalLayerCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expectDyadicTemporalLayerPattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minQp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxQp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>prefersGopRemainingFrames</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requiresGopRemainingFrames</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stdSyntaxFlags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The <strong>Requirement Type</strong> column specifies the requirement is either the
minimum value all implementations <strong class="purple">must</strong> support, the maximum value all
implementations <strong class="purple">must</strong> support, or the exact value all implementations
<strong class="purple">must</strong> support.
For bitmasks a minimum value is the least bits all implementations <strong class="purple">must</strong>
set, but they <strong class="purple">may</strong> have additional bits set beyond this minimum.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="encode-h265"><a class="anchor" href="chap36.html#encode-h265"></a>36.18. H.265 Encode Operations</h3>
<div class="paragraph">
<p>Video encode operations using an <a href="chap36.html#encode-h265-profile">H.265 encode
profile</a> <strong class="purple">can</strong> be used to encode elementary video stream sequences compliant
to the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Refer to the <a href="chap1.html">Preamble</a> for information on how the Khronos
Intellectual Property Rights Policy relates to normative references to
external materials not created by Khronos.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This process is performed according to the <a href="chap36.html#encode-operation-steps">video
encode operation steps</a> with the codec-specific semantics defined in
section 8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a> as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Syntax elements, derived values, and other parameters are applied from
the following structures:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>StdVideoH265VideoParameterSet</code> structure corresponding to the
<a href="chap36.html#encode-h265-active-vps">active VPS</a> specifying the <a href="chap36.html#encode-h265-vps">H.265 video parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH265SequenceParameterSet</code> structure corresponding to
the <a href="chap36.html#encode-h265-active-sps">active SPS</a> specifying the
<a href="chap36.html#encode-h265-sps">H.265 sequence parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoH265PictureParameterSet</code> structure corresponding to the
<a href="chap36.html#encode-h265-active-pps">active PPS</a> specifying the <a href="chap36.html#encode-h265-pps">H.265 picture parameter set</a>.</p>
</li>
<li>
<p>The <code>StdVideoEncodeH265PictureInfo</code> structure specifying the
<a href="chap36.html#encode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p>The <code>StdVideoEncodeH265SliceSegmentHeader</code> structures specifying the
<a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a> for each encoded H.265 slice segment.</p>
</li>
<li>
<p>The <code>StdVideoEncodeH265ReferenceInfo</code> structures specifying the
<a href="chap36.html#encode-h265-reference-info">H.265 reference information</a>
corresponding to the optional <a href="chap36.html#reconstructed-picture">reconstructed
picture</a> and any <a href="chap36.html#active-reference-pictures">active reference
pictures</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The encoded bitstream data is written to the destination video bitstream
buffer range as defined in the
<a href="chap36.html#encode-h265-bitstream-data-access">H.265 Encode Bitstream Data
Access</a> section.</p>
</li>
<li>
<p>Picture data in the <a href="chap36.html#video-picture-resources">video picture resources</a>
corresponding to the used <a href="chap36.html#encode-input-picture">encode input
picture</a>, <a href="chap36.html#active-reference-pictures">active reference pictures</a>, and
optional <a href="chap36.html#reconstructed-picture">reconstructed picture</a> is accessed as
defined in the <a href="chap36.html#encode-h265-picture-data-access">H.265 Encode Picture
Data Access</a> section.</p>
</li>
<li>
<p>The decision on <a href="chap36.html#encode-ref-pic-setup">reference picture setup</a> is made
according to the parameters specified in the
<a href="chap36.html#encode-h265-ref-pic-setup">H.265 picture information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the parameters adhere to the syntactic and semantic requirements defined
in the corresponding sections of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>, as described above, and the <a href="chap36.html#dpb-slot">DPB slots</a>
associated with the <a href="chap36.html#active-reference-pictures">active reference pictures</a>
all refer to <a href="chap36.html#dpb-slot-states">valid picture references</a>, then the video
encode operation will complete successfully.
Otherwise, the video encode operation <strong class="purple">may</strong> complete
<a href="chap36.html#encode-unsuccessful">unsuccessfully</a>.</p>
</div>
<div class="sect3">
<h4 id="encode-h265-overrides"><a class="anchor" href="chap36.html#encode-h265-overrides"></a>36.18.1. H.265 Encode Parameter Overrides</h4>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> override, unless otherwise specified, any of the H.265
encode parameters specified in the following Video Std structures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoH265VideoParameterSet</code></p>
</li>
<li>
<p><code>StdVideoH265SequenceParameterSet</code></p>
</li>
<li>
<p><code>StdVideoH265PictureParameterSet</code></p>
</li>
<li>
<p><code>StdVideoEncodeH265PictureInfo</code></p>
</li>
<li>
<p><code>StdVideoEncodeH265SliceSegmentHeader</code></p>
</li>
<li>
<p><code>StdVideoEncodeH265ReferenceInfo</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All such H.265 encode parameter overrides <strong class="purple">must</strong> fulfill the conditions
defined in the <a href="chap36.html#encode-overrides">Video Encode Parameter Overrides</a>
section.</p>
</div>
<div class="paragraph">
<p>In addition, implementations <strong class="purple">must</strong> not override any of the following H.265
encode parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StdVideoEncodeH265PictureInfo</code>::<code>pic_type</code></p>
</li>
<li>
<p><code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_type</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case of H.265 encode parameters stored in
<a href="chap36.html#encode-h265-parameter-sets">video session parameters</a> objects,
applications need to use the <a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>
command to determine whether any implementation overrides happened.
If the query indicates that implementation overrides were applied, then the
application needs to retrieve and use the encoded H.265 parameter sets in
the bitstream in order to be able to produce a compliant H.265 video
bitstream using the H.265 encode parameters stored in the video session
parameters object.</p>
</div>
<div class="paragraph">
<p>In case of any H.265 encode parameters stored in the encoded bitstream
produced by video encode operations, if the implementation supports the
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_HAS_OVERRIDES_BIT_KHR</code>
<a href="chap17.html#queries-video-encode-feedback">video encode feedback query</a> flag, the
application <strong class="purple">can</strong> use such queries to retrieve feedback about whether any
implementation overrides have been applied to those H.265 encode parameters.</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-bitstream-data-access"><a class="anchor" href="chap36.html#encode-h265-bitstream-data-access"></a>36.18.2. H.265 Encode Bitstream Data Access</h4>
<div class="paragraph">
<p>Each video encode operation writes one or more VCL NAL units comprising of
slice segment headers and data of the encoded picture, in the format defined
in sections 7.3.6 and 7.3.8, according to the semantics defined in sections
7.4.7 and 7.4.9 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>,
respectively.
The number of VCL NAL units written is specified by
<a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a>::<code>naluSliceSegmentEntryCount</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-picture-data-access"><a class="anchor" href="chap36.html#encode-h265-picture-data-access"></a>36.18.3. H.265 Encode Picture Data Access</h4>
<div class="paragraph">
<p>Accesses to image data within a video picture resource happen at the
granularity indicated by
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pictureAccessGranularity</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used <a href="chap36.html#video-profiles">video profile</a>.
Accordingly, the complete image subregion of a <a href="chap36.html#encode-input-picture">encode
input picture</a>, <a href="chap36.html#reference-picture">reference picture</a>, or
<a href="chap36.html#reconstructed-picture">reconstructed picture</a> accessed by video coding
operations using an <a href="chap36.html#encode-h265-profile">H.265 encode profile</a> is defined
as the set of texels within the coordinate range:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">([0,<code>endX</code>),[0,<code>endY</code>))</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="eq"><code>endX</code></span> equals <span class="eq"><code>codedExtent.width</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.width</code> and
clamped to the width of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
<li>
<p><span class="eq">endY</span> equals <span class="eq"><code>codedExtent.height</code></span> rounded up to the
nearest integer multiple of <code>pictureAccessGranularity.height</code> and
clamped to the height of the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>codedExtent</code> is the member of the
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure corresponding to the picture.</p>
</div>
<div class="paragraph">
<p>In case of video encode operations using an <a href="chap36.html#encode-h265-profile">H.265
encode profile</a>, any access to a picture at the coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>, as defined by the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>, is an access to the image subresource
<a href="chap36.html#video-image-subresource-reference">referred</a> to by the corresponding
<a href="chap36.html#VkVideoPictureResourceInfoKHR">VkVideoPictureResourceInfoKHR</a> structure at the texel coordinates
<span class="eq">(<code>x</code>,<code>y</code>)</span>.</p>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> choose not to access some or all texels within
particular <a href="chap36.html#reference-picture">reference pictures</a> available to a video
encode operation (e.g. due to <a href="chap36.html#encode-overrides">video encode parameter
overrides</a> restricting the effective set of used reference pictures, or if
the encoding algorithm chooses not to use certain subregions of the
reference picture data for sample prediction).</p>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-frame-picture-slice-type"><a class="anchor" href="chap36.html#encode-h265-frame-picture-slice-type"></a>36.18.4. H.265 Frame, Picture, Slice Segments, and Tiles</h4>
<div class="paragraph">
<p>H.265 pictures consist of one or more slices, slice segments, and tiles, as
defined in section 6.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</div>
<div class="paragraph">
<p>Video encode operations using an <a href="chap36.html#encode-h265-profile">H.265 encode
profile</a> <strong class="purple">can</strong> encode slice segments of different types, as defined in
section 7.4.7.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>, by
specifying the corresponding enumeration constant value in
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_type</code> in the
<a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a> from the Video Std enumeration type <code>StdVideoH265SliceType</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="encode-h265-b-slice"></a> <code>STD_VIDEO_H265_SLICE_TYPE_B</code> indicates that
the slice segment is part of a <em>B slice</em> as defined in section 3.12 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
<li>
<p><a id="encode-h265-p-slice"></a> <code>STD_VIDEO_H265_SLICE_TYPE_P</code> indicates that
the slice segment is part of a <em>P slice</em> as defined in section 3.111 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
<li>
<p><a id="encode-h265-i-slice"></a> <code>STD_VIDEO_H265_SLICE_TYPE_I</code> indicates that
the slice segment is part of an <em>I slice</em> as defined in section 3.74 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pictures constructed from such slice segments <strong class="purple">can</strong> be of different types, as
defined in section 7.4.3.5 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.
Video encode operations using an <a href="chap36.html#encode-h265-profile">H.265 encode
profile</a> <strong class="purple">can</strong> encode pictures of a specific type by specifying the
corresponding enumeration constant value in
<code>StdVideoEncodeH265PictureInfo</code>::<code>pic_type</code> in the
<a href="chap36.html#encode-h265-picture-info">H.265 picture information</a> from the Video Std
enumeration type <code>StdVideoH265PictureType</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="encode-h265-p-pic"></a> <code>STD_VIDEO_H265_PICTURE_TYPE_P</code> indicates that
the picture is a <em>P picture</em>.
A frame consisting of a P picture is also referred to as a <em>P frame</em>.</p>
</li>
<li>
<p><a id="encode-h265-b-pic"></a> <code>STD_VIDEO_H265_PICTURE_TYPE_B</code> indicates that
the picture is a <em>B picture</em>.
A frame consisting of a B picture is also referred to as a <em>B frame</em>.</p>
</li>
<li>
<p><a id="encode-h265-i-pic"></a> <code>STD_VIDEO_H265_PICTURE_TYPE_I</code> indicates that
the picture is an <em>I picture</em>.
A frame consisting of an I picture is also referred to as an <em>I frame</em>.</p>
</li>
<li>
<p><a id="encode-h265-idr-pic"></a> <code>STD_VIDEO_H265_PICTURE_TYPE_IDR</code> indicates
that the picture is a special type of I picture called an <em>IDR picture</em>
as defined in section 3.67 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>.
A frame consisting of an IDR picture is also referred to as an <em>IDR
frame</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-profile"><a class="anchor" href="chap36.html#encode-h265-profile"></a>36.18.5. H.265 Encode Profile</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A video profile supporting H.265 video encode operations is specified by
setting <a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>videoCodecOperation</code> to
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code> and adding a
<code>VkVideoEncodeH265ProfileInfoKHR</code> structure to the
<a href="chap36.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a>::<code>pNext</code> chain.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH265ProfileInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265ProfileInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265ProfileInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">StdVideoH265ProfileIdc</span>    <span class="n">stdProfileIdc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265ProfileInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdProfileIdc</code> is a <code>StdVideoH265ProfileIdc</code> value specifying
the H.265 codec profile IDC, as defined in section A.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265ProfileInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265ProfileInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265ProfileInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_PROFILE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_265_encode_capabilities"><a class="anchor" href="chap36.html#_h_265_encode_capabilities"></a>36.18.6. H.265 Encode Capabilities</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> to query the
capabilities for an <a href="chap36.html#encode-h265-profile">H.265 encode profile</a>, the
<a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include a
<code>VkVideoEncodeH265CapabilitiesKHR</code> structure that will be filled with
the profile-specific capabilities.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH265CapabilitiesKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265CapabilitiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265CapabilitiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                                          <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265CapabilityFlagsKHR</span>            <span class="n">flags</span><span class="p">;</span>
    <span class="n">StdVideoH265LevelIdc</span>                           <span class="n">maxLevelIdc</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">maxSliceSegmentCount</span><span class="p">;</span>
    <span class="n">VkExtent2D</span>                                     <span class="n">maxTiles</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265CtbSizeFlagsKHR</span>               <span class="n">ctbSizes</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265TransformBlockSizeFlagsKHR</span>    <span class="n">transformBlockSizes</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">maxPPictureL0ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">maxBPictureL0ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">maxL1ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                       <span class="n">maxSubLayerCount</span><span class="p">;</span>
    <span class="n">VkBool32</span>                                       <span class="n">expectDyadicTemporalSubLayerPattern</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                        <span class="n">minQp</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                        <span class="n">maxQp</span><span class="p">;</span>
    <span class="n">VkBool32</span>                                       <span class="n">prefersGopRemainingFrames</span><span class="p">;</span>
    <span class="n">VkBool32</span>                                       <span class="n">requiresGopRemainingFrames</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265StdFlagsKHR</span>                   <span class="n">stdSyntaxFlags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265CapabilitiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap36.html#VkVideoEncodeH265CapabilityFlagBitsKHR">VkVideoEncodeH265CapabilityFlagBitsKHR</a>
indicating supported H.265 encoding capabilities.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH265LevelIdc</code> value indicating the
maximum H.265 level supported by the profile, where enum constant
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
<li>
<p><code>maxSliceSegmentCount</code> indicates the maximum number of slice
segments that <strong class="purple">can</strong> be encoded for a single picture.
Further restrictions <strong class="purple">may</strong> apply to the number of slice segments that
<strong class="purple">can</strong> be encoded for a single picture depending on other capabilities and
codec-specific rules.</p>
</li>
<li>
<p><code>maxTiles</code> indicates the maximum number of H.265 tile columns and
rows, as defined in sections 3.175 and 3.176 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a> that <strong class="purple">can</strong> be encoded for a single picture.
Further restrictions <strong class="purple">may</strong> apply to the number of H.265 tiles that <strong class="purple">can</strong>
be encoded for a single picture depending on other capabilities and
codec-specific rules.</p>
</li>
<li>
<p><code>ctbSizes</code> is a bitmask of <a href="chap36.html#VkVideoEncodeH265CtbSizeFlagBitsKHR">VkVideoEncodeH265CtbSizeFlagBitsKHR</a>
describing the supported CTB sizes.</p>
</li>
<li>
<p><code>transformBlockSizes</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH265TransformBlockSizeFlagBitsKHR">VkVideoEncodeH265TransformBlockSizeFlagBitsKHR</a> describing the
supported transform block sizes.</p>
</li>
<li>
<p><code>maxPPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for <a href="chap36.html#encode-h265-p-pic">P pictures</a>.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As implementations <strong class="purple">may</strong> <a href="chap36.html#encode-overrides">override</a> the reference lists,
<code>maxPPictureL0ReferenceCount</code> does not limit the number of elements that
the application <strong class="purple">can</strong> specify in the L0 reference list for P pictures.
However, if <code>maxPPictureL0ReferenceCount</code> is zero, then the use of P
pictures is not allowed.
In case of H.265 encoding, backward-only predictive pictures <strong class="purple">can</strong> be encoded
even if P pictures are not supported, as the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a> supports <em>generalized P &amp; B frames</em> (also known as low delay
B frames) whereas B frames <strong class="purple">can</strong> refer to past frames through both the L0 and
L1 reference lists.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><code>maxBPictureL0ReferenceCount</code> indicates the maximum number of
reference pictures the implementation supports in the reference list L0
for <a href="chap36.html#encode-h265-b-pic">B pictures</a>.</p>
</li>
<li>
<p><code>maxL1ReferenceCount</code> indicates the maximum number of reference
pictures the implementation supports in the reference list L1 if
encoding of <a href="chap36.html#encode-h265-b-pic">B pictures</a> is supported.</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As implementations <strong class="purple">may</strong> <a href="chap36.html#encode-overrides">override</a> the reference lists,
<code>maxBPictureL0ReferenceCount</code> and <code>maxL1ReferenceCount</code> does not
limit the number of elements that the application <strong class="purple">can</strong> specify in the L0 and
L1 reference lists for B pictures.
However, if <code>maxBPictureL0ReferenceCount</code> and <code>maxL1ReferenceCount</code>
are both zero, then the use of B pictures is not allowed.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><code>maxSubLayerCount</code> indicates the maximum number of H.265 sub-layers
supported by the implementation.</p>
</li>
<li>
<p><code>expectDyadicTemporalSubLayerPattern</code> indicates that the
implementation’s rate control algorithms expect the application to use a
<a href="chap36.html#encode-h265-layer-pattern-dyadic">dyadic temporal sub-layer pattern</a>
when encoding multiple temporal sub-layers.</p>
</li>
<li>
<p><code>minQp</code> indicates the minimum QP value supported.</p>
</li>
<li>
<p><code>maxQp</code> indicates the maximum QP value supported.</p>
</li>
<li>
<p><code>prefersGopRemainingFrames</code> indicates that the implementation’s rate
control algorithm prefers the application to specify the number of
frames of each type <a href="chap36.html#encode-h265-gop-remaining-frames">remaining</a> in
the current <a href="chap36.html#encode-h265-gop">group of pictures</a> when beginning a
<a href="chap36.html#video-coding-scope">video coding scope</a>.</p>
</li>
<li>
<p><code>requiresGopRemainingFrames</code> indicates that the implementation’s
rate control algorithm requires the application to specify the number of
frames of each type <a href="chap36.html#encode-h265-gop-remaining-frames">remaining</a> in
the current <a href="chap36.html#encode-h265-gop">group of pictures</a> when beginning a
<a href="chap36.html#video-coding-scope">video coding scope</a>.</p>
</li>
<li>
<p><code>stdSyntaxFlags</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH265StdFlagBitsKHR">VkVideoEncodeH265StdFlagBitsKHR</a> indicating capabilities related to
H.265 syntax elements.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265CapabilitiesKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265CapabilitiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265CapabilitiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_CAPABILITIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, indicating the H.265
encoding capabilities supported, are:</p>
</div>
<div id="VkVideoEncodeH265CapabilityFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH265CapabilityFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_HRD_COMPLIANCE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_ROW_UNALIGNED_SLICE_SEGMENT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_DIFFERENT_SLICE_SEGMENT_TYPE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_PER_SLICE_SEGMENT_CONSTANT_QP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_TILES_PER_SLICE_SEGMENT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_SLICE_SEGMENTS_PER_TILE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265CapabilityFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_HRD_COMPLIANCE_BIT_KHR</code> indicates
if the implementation <strong class="purple">may</strong> be able to generate HRD compliant bitstreams
if any of the <code>nal_hrd_parameters_present_flag</code>,
<code>vcl_hrd_parameters_present_flag</code>, or
<code>sub_pic_hrd_params_present_flag</code> members of
<code>StdVideoH265HrdFlags</code> are set to <code>1</code> in the HRD parameters of the
<a href="chap36.html#encode-h265-active-vps">active VPS</a> or <a href="chap36.html#encode-h265-active-sps">active
SPS</a>, or if
<code>StdVideoH265SpsVuiFlags</code>::<code>vui_hrd_parameters_present_flag</code> is
set to <code>1</code> in the <a href="chap36.html#encode-h265-active-sps">active SPS</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_KHR</code>
indicates that if the <code>weighted_pred_flag</code> or the
<code>weighted_bipred_flag</code> member of <code>StdVideoH265PpsFlags</code> is set to
<code>1</code> in the <a href="chap36.html#encode-h265-active-pps">active PPS</a> when encoding a
<a href="chap36.html#encode-h265-p-pic">P picture</a> or <a href="chap36.html#encode-h265-b-pic">B picture</a>,
respectively, then the implementation is able to internally decide
syntax for <code>pred_weight_table</code>, as defined in section 7.4.7.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>, and the application is not
<strong class="purple">required</strong> to provide a weight table in the
<a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_ROW_UNALIGNED_SLICE_SEGMENT_BIT_KHR</code>
indicates that each slice segment in a frame with a single or multiple
tiles per slice may begin or finish at any offset in a CTB row.
If not supported, all slice segments in such a frame <strong class="purple">must</strong> begin at the
start of a CTB row (and hence each slice segment <strong class="purple">must</strong> finish at the end
of a CTB row).
Also indicates that each slice segment in a frame with multiple slices
per tile may begin or finish at any offset within the enclosing tile’s
CTB row.
If not supported, slice segments in such a frame <strong class="purple">must</strong> begin at the
start of the enclosing tile’s CTB row (and hence each slice segment
<strong class="purple">must</strong> finish at the end of the enclosing tile’s CTB row).</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_DIFFERENT_SLICE_SEGMENT_TYPE_BIT_KHR</code>
indicates that when a frame is encoded with multiple slice segments, the
implementation allows encoding each slice segment with a different
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_type</code> specified in
the <a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a>.
If not supported, all slice segments of the frame <strong class="purple">must</strong> be encoded with
the same <code>slice_type</code> which corresponds to the picture type of the
frame.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L0_LIST_BIT_KHR</code>
indicates support for using a <a href="chap36.html#encode-h265-b-pic">B frame</a> as L0
reference, as specified in
<code>StdVideoEncodeH265ReferenceListsInfo</code>::<code>RefPicList0</code> in the
<a href="chap36.html#encode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_B_FRAME_IN_L1_LIST_BIT_KHR</code>
indicates support for using a <a href="chap36.html#encode-h265-b-pic">B frame</a> as L1
reference, as specified in
<code>StdVideoEncodeH265ReferenceListsInfo</code>::<code>RefPicList1</code> in the
<a href="chap36.html#encode-h265-picture-info">H.265 picture information</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</code>
indicates support for specifying different QP values in the members of
<a href="chap36.html#VkVideoEncodeH265QpKHR">VkVideoEncodeH265QpKHR</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_SLICE_SEGMENT_CONSTANT_QP_BIT_KHR</code>
indicates support for specifying different constant QP values for each
slice segment.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_TILES_PER_SLICE_SEGMENT_BIT_KHR</code>
indicates if encoding multiple tiles per slice segment, as defined in
section 6.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>, is
supported.
If this capability flag is not present, then the implementation is only
able to encode a single tile for each slice segment.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_SLICE_SEGMENTS_PER_TILE_BIT_KHR</code>
indicates if encoding multiple slice segments per tile, as defined in
section 6.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>, is
supported.
If this capability flag is not present, then the implementation is only
able to encode a single slice segment for each tile.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265CapabilityFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH265CapabilityFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265CapabilityFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="chap36.html#VkVideoEncodeH265CapabilityFlagBitsKHR">VkVideoEncodeH265CapabilityFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>stdSyntaxFlags</code>, indicating the
capabilities related to the H.265 syntax elements, are:</p>
</div>
<div id="VkVideoEncodeH265StdFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH265StdFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_SAMPLE_ADAPTIVE_OFFSET_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_SCALING_LIST_DATA_PRESENT_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_PCM_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_SPS_TEMPORAL_MVP_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_INIT_QP_MINUS26_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_WEIGHTED_PRED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_WEIGHTED_BIPRED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_LOG2_PARALLEL_MERGE_LEVEL_MINUS2_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_SIGN_DATA_HIDING_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000400</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_UNSET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000800</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_PPS_SLICE_CHROMA_QP_OFFSETS_PRESENT_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00001000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_TRANSQUANT_BYPASS_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00002000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00004000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_ENTROPY_CODING_SYNC_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00008000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_DEBLOCKING_FILTER_OVERRIDE_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENTS_ENABLED_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00020000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENT_FLAG_SET_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00040000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_SLICE_QP_DELTA_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00080000</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_STD_DIFFERENT_SLICE_QP_DELTA_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00100000</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265StdFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SEPARATE_COLOR_PLANE_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265SpsFlags</code>::<code>separate_colour_plane_flag</code> in the
<a href="chap36.html#encode-h265-sps">SPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SAMPLE_ADAPTIVE_OFFSET_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265SpsFlags</code>::<code>sample_adaptive_offset_enabled_flag</code> in
the <a href="chap36.html#encode-h265-sps">SPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SCALING_LIST_DATA_PRESENT_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for the <code>scaling_list_enabled_flag</code> and
<code>sps_scaling_list_data_present_flag</code> members of
<code>StdVideoH265SpsFlags</code> in the <a href="chap36.html#encode-h265-sps">SPS</a>, and the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>pps_scaling_list_data_present_flag</code> in
the <a href="chap36.html#encode-h265-pps">PPS</a> when those values are <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_PCM_ENABLED_FLAG_SET_BIT_KHR</code> indicates
whether the implementation supports using the application-provided value
for <code>StdVideoH265SpsFlags</code>::<code>pcm_enable_flag</code> in the
<a href="chap36.html#encode-h265-sps">SPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SPS_TEMPORAL_MVP_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265SpsFlags</code>::<code>sps_temporal_mvp_enabled_flag</code> in the
<a href="chap36.html#encode-h265-sps">SPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_INIT_QP_MINUS26_BIT_KHR</code> indicates whether
the implementation supports using the application-provided value for
<code>StdVideoH265PictureParameterSet</code>::<code>init_qp_minus26</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is non-zero.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_WEIGHTED_PRED_FLAG_SET_BIT_KHR</code> indicates
whether the implementation supports using the application-provided value
for <code>StdVideoH265PpsFlags</code>::<code>weighted_pred_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_WEIGHTED_BIPRED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>weighted_bipred_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_LOG2_PARALLEL_MERGE_LEVEL_MINUS2_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PictureParameterSet</code>::<code>log2_parallel_merge_level_minus2</code>
in the <a href="chap36.html#encode-h265-pps">PPS</a> when that value is non-zero.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SIGN_DATA_HIDING_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>sign_data_hiding_enabled_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>transform_skip_enabled_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_TRANSFORM_SKIP_ENABLED_FLAG_UNSET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>transform_skip_enabled_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>0</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_PPS_SLICE_CHROMA_QP_OFFSETS_PRESENT_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>pps_slice_chroma_qp_offsets_present_flag</code>
in the <a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_TRANSQUANT_BYPASS_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>transquant_bypass_enabled_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_CONSTRAINED_INTRA_PRED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>constrained_intra_pred_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_ENTROPY_CODING_SYNC_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>entropy_coding_sync_enabled_flag</code> in the
<a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DEBLOCKING_FILTER_OVERRIDE_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>deblocking_filter_override_enabled_flag</code>
in the <a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENTS_ENABLED_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoH265PpsFlags</code>::<code>dependent_slice_segments_enabled_flag</code> in
the <a href="chap36.html#encode-h265-pps">PPS</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DEPENDENT_SLICE_SEGMENT_FLAG_SET_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>dependent_slice_segment_flag</code>
in the <a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment
header parameters</a> when that value is <code>1</code>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_SLICE_QP_DELTA_BIT_KHR</code> indicates whether
the implementation supports using the application-provided value for
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_qp_delta</code> in the
<a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a> when that value is identical across the slice segments of
the encoded frame.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_STD_DIFFERENT_SLICE_QP_DELTA_BIT_KHR</code>
indicates whether the implementation supports using the
application-provided value for
<code>StdVideoEncodeH265SliceSegmentHeader</code>::<code>slice_qp_delta</code> in the
<a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a> when that value is different across the slice segments of
the encoded frame.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These capability flags provide information to the application about specific
H.265 syntax element values that the implementation supports without having
to <a href="chap36.html#encode-h265-overrides">override</a> them and do not otherwise restrict the
values that the application <strong class="purple">can</strong> specify for any of the mentioned H.265
syntax elements.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265StdFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH265StdFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265StdFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="chap36.html#VkVideoEncodeH265StdFlagBitsKHR">VkVideoEncodeH265StdFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>ctbSizes</code>, indicating the CTB
sizes supported by the implementation, are:</p>
</div>
<div id="VkVideoEncodeH265CtbSizeFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH265CtbSizeFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CTB_SIZE_16_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CTB_SIZE_32_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_CTB_SIZE_64_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265CtbSizeFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CTB_SIZE_16_BIT_KHR</code> specifies that a CTB size
of 16x16 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CTB_SIZE_32_BIT_KHR</code> specifies that a CTB size
of 32x32 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_CTB_SIZE_64_BIT_KHR</code> specifies that a CTB size
of 64x64 is supported.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265CtbSizeFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH265CtbSizeFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265CtbSizeFlagsKHR</code> is a bitmask type for setting a mask
of zero or more <a href="chap36.html#VkVideoEncodeH265CtbSizeFlagBitsKHR">VkVideoEncodeH265CtbSizeFlagBitsKHR</a>.</p>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">must</strong> support at least one of
<code>VkVideoEncodeH265CtbSizeFlagBitsKHR</code>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>transformBlockSizes</code>,
indicating the transform block sizes supported by the implementation, are:</p>
</div>
<div id="VkVideoEncodeH265TransformBlockSizeFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH265TransformBlockSizeFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_4_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_8_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_16_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_32_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265TransformBlockSizeFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_4_BIT_KHR</code> specifies that
a transform block size of 4x4 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_8_BIT_KHR</code> specifies that
a transform block size of 8x8 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_16_BIT_KHR</code> specifies
that a transform block size of 16x16 is supported.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_TRANSFORM_BLOCK_SIZE_32_BIT_KHR</code> specifies
that a transform block size of 32x32 is supported.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265TransformBlockSizeFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH265TransformBlockSizeFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265TransformBlockSizeFlagsKHR</code> is a bitmask type for
setting a mask of zero or more
<a href="chap36.html#VkVideoEncodeH265TransformBlockSizeFlagBitsKHR">VkVideoEncodeH265TransformBlockSizeFlagBitsKHR</a>.</p>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">must</strong> support at least one of
<code>VkVideoEncodeH265TransformBlockSizeFlagBitsKHR</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_265_encode_quality_level_properties"><a class="anchor" href="chap36.html#_h_265_encode_quality_level_properties"></a>36.18.7. H.265 Encode Quality Level Properties</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When calling <a href="chap36.html#vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR">vkGetPhysicalDeviceVideoEncodeQualityLevelPropertiesKHR</a>
with <code>pVideoProfile-&gt;videoCodecOperation</code> specified as
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the
<a href="chap36.html#VkVideoEncodeH265QualityLevelPropertiesKHR">VkVideoEncodeH265QualityLevelPropertiesKHR</a> structure <strong class="purple">must</strong> be included
in the <code>pNext</code> chain of the <a href="chap36.html#VkVideoEncodeQualityLevelPropertiesKHR">VkVideoEncodeQualityLevelPropertiesKHR</a>
structure to retrieve additional video encode quality level properties
specific to H.265 encoding.</p>
</div>
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH265QualityLevelPropertiesKHR">VkVideoEncodeH265QualityLevelPropertiesKHR</a> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH265QualityLevelPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265QualityLevelPropertiesKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>                                   <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265RateControlFlagsKHR</span>    <span class="n">preferredRateControlFlags</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredGopFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredIdrPeriod</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredConsecutiveBFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredSubLayerCount</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265QpKHR</span>                  <span class="n">preferredConstantQp</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredMaxL0ReferenceCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">preferredMaxL1ReferenceCount</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265QualityLevelPropertiesKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>preferredRateControlFlags</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH265RateControlFlagBitsKHR">VkVideoEncodeH265RateControlFlagBitsKHR</a> values indicating the
preferred flags to use for
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>flags</code>.</p>
</li>
<li>
<p><code>preferredGopFrameCount</code> indicates the preferred value to use for
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>gopFrameCount</code>.</p>
</li>
<li>
<p><code>preferredIdrPeriod</code> indicates the preferred value to use for
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>idrPeriod</code>.</p>
</li>
<li>
<p><code>preferredConsecutiveBFrameCount</code> indicates the preferred value to
use for
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>consecutiveBFrameCount</code>.</p>
</li>
<li>
<p><code>preferredSubLayerCount</code> indicates the preferred value to use for
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>subLayerCount</code>.</p>
</li>
<li>
<p><code>preferredConstantQp</code> indicates the preferred values to use for
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>constantQp</code> for
each picture type when using <a href="chap36.html#encode-rate-control-modes">rate control
mode</a> <code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>preferredMaxL0ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L0.</p>
</li>
<li>
<p><code>preferredMaxL1ReferenceCount</code> indicates the preferred maximum
number of reference pictures to use in the reference list L1.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265QualityLevelPropertiesKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265QualityLevelPropertiesKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265QualityLevelPropertiesKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_QUALITY_LEVEL_PROPERTIES_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_265_encode_session"><a class="anchor" href="chap36.html#_h_265_encode_session"></a>36.18.8. H.265 Encode Session</h4>
<div class="paragraph">
<p>Additional parameters can be specified when creating a video session with an
H.265 encode profile by including an instance of the
<a href="chap36.html#VkVideoEncodeH265SessionCreateInfoKHR">VkVideoEncodeH265SessionCreateInfoKHR</a> structure in the <code>pNext</code>
chain of <a href="chap36.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionCreateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265SessionCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265SessionCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>             <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>                <span class="n">useMaxLevelIdc</span><span class="p">;</span>
    <span class="n">StdVideoH265LevelIdc</span>    <span class="n">maxLevelIdc</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265SessionCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMaxLevelIdc</code> indicates whether the value of <code>maxLevelIdc</code>
should be used by the implementation.
When it is set to <code>VK_FALSE</code>, the implementation ignores the value
of <code>maxLevelIdc</code> and uses the value of
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxLevelIdc</code>, as reported
by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the video profile.</p>
</li>
<li>
<p><code>maxLevelIdc</code> is a <code>StdVideoH265LevelIdc</code> value specifying the
upper bound on the H.265 level for the video bitstreams produced by the
created video session, where enum constant
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifies H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265SessionCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_CREATE_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-parameter-sets"><a class="anchor" href="chap36.html#encode-h265-parameter-sets"></a>36.18.9. H.265 Encode Parameter Sets</h4>
<div class="paragraph">
<p><a href="chap36.html#video-session-parameters">Video session parameters</a> objects created with
the video codec operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>
<strong class="purple">can</strong> contain the following types of parameters:</p>
</div>
<div class="paragraph">
<p><a id="encode-h265-vps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.265 Video Parameter Sets (VPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265VideoParameterSet</code> structures and interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>vps_video_parameter_set_id</code> is used as the key of the VPS entry;</p>
</li>
<li>
<p>the <code>max_latency_increase_plus1</code>, <code>max_dec_pic_buffering_minus1</code>,
and <code>max_num_reorder_pics</code> members of the
<code>StdVideoH265DecPicBufMgr</code> structure pointed to by <code>pDecPicBufMgr</code>
correspond to <code>vps_max_latency_increase_plus1</code>,
<code>vps_max_dec_pic_buffering_minus1</code>, and <code>vps_max_num_reorder_pics</code>,
respectively, as defined in section 7.4.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>the <code>StdVideoH265HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_general_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_general_flag[i]</code> as defined in
section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_within_cvs_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_within_cvs_flag[i]</code> as defined
in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.low_delay_hrd_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>low_delay_hrd_flag[i]</code> as defined in section E.3.2 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersNal</code> is a pointer to an array of
<span class="eq"><code>vps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>vps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265VideoParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vcl_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersVcl</code> is a pointer to an array of
<span class="eq"><code>vps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>vps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265VideoParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265HrdParameters</code> are interpreted as
defined in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>StdVideoH265ProfileTierLevel</code> structure pointed to by
<code>pProfileTierLevel</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>general_level_idc</code> is one of the enum constants
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ProfileTierLevel</code> are interpreted
as defined in section 7.4.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265VideoParameterSet</code> are interpreted
as defined in section 7.4.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="encode-h265-sps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.265 Sequence Parameter Sets (SPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265SequenceParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code> and <code>reserved2</code> are used only for padding purposes and
are otherwise ignored;</p>
</li>
<li>
<p>the pair constructed from <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code> is used as the key of the SPS entry;</p>
</li>
<li>
<p>the <code>StdVideoH265ProfileTierLevel</code> structure pointed to by
<code>pProfileTierLevel</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>general_level_idc</code> is one of the enum constants
<code>STD_VIDEO_H265_LEVEL_IDC_&lt;major&gt;_&lt;minor&gt;</code> identifying the H.265 level
<code>&lt;major&gt;.&lt;minor&gt;</code> as defined in section A.4 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ProfileTierLevel</code> are interpreted
as defined in section 7.4.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>the <code>max_latency_increase_plus1</code>, <code>max_dec_pic_buffering_minus1</code>,
and <code>max_num_reorder_pics</code> members of the
<code>StdVideoH265DecPicBufMgr</code> structure pointed to by <code>pDecPicBufMgr</code>
correspond to <code>sps_max_latency_increase_plus1</code>,
<code>sps_max_dec_pic_buffering_minus1</code>, and <code>sps_max_num_reorder_pics</code>,
respectively, as defined in section 7.4.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.sps_scaling_list_data_present_flag</code> is set, then the
<code>StdVideoH265ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ScalingList4x4</code>, <code>ScalingList8x8</code>, <code>ScalingList16x16</code>, and
<code>ScalingList32x32</code> correspond to <code>ScalingList[0]</code>, <code>ScalingList[1]</code>,
<code>ScalingList[2]</code>, and <code>ScalingList[3]</code>, respectively, as defined in
section 7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>ScalingListDCCoef16x16</code> and <code>ScalingListDCCoef32x32</code> correspond
to <code>scaling_list_dc_coef_minus8[0]</code> and
<code>scaling_list_dc_coef_minus8[1]</code>, respectively, as defined in section
7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>pShortTermRefPicSet</code> is a pointer to an array of
<code>num_short_term_ref_pic_sets</code> number of
<code>StdVideoH265ShortTermRefPicSet</code> structures where each element is
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>used_by_curr_pic_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_flag[i]</code> as defined in section 7.4.8
of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>use_delta_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>use_delta_flag[i]</code> as defined in section 7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>used_by_curr_pic_s0_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_s0_flag[i]</code> as defined in section
7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>used_by_curr_pic_s1_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_s1_flag[i]</code> as defined in section
7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265ShortTermRefPicSet</code> are
interpreted as defined in section 7.4.8 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.long_term_ref_pics_present_flag</code> is set then the
<code>StdVideoH265LongTermRefPicsSps</code> structure pointed to by
<code>pLongTermRefPicsSps</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>used_by_curr_pic_lt_sps_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_lt_sps_flag[i]</code> as defined in section
7.4.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265LongTermRefPicsSps</code> are
interpreted as defined in section 7.4.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vui_parameters_present_flag</code> is set, then the
<code>StdVideoH265SequenceParameterSetVui</code> structure pointed to by
<code>pSequenceParameterSetVui</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p>the <code>StdVideoH265HrdParameters</code> structure pointed to by
<code>pHrdParameters</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.fixed_pic_rate_general_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_general_flag[i]</code> as defined in
section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.fixed_pic_rate_within_cvs_flag</code> is a bitmask where bit index
<span class="eq">i</span> corresponds to <code>fixed_pic_rate_within_cvs_flag[i]</code> as defined
in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.low_delay_hrd_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>low_delay_hrd_flag[i]</code> as defined in section E.3.2 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>flags.nal_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersNal</code> is a pointer to an array of
<span class="eq"><code>sps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>sps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265SequenceParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.vcl_hrd_parameters_present_flag</code> is set, then
<code>pSubLayerHrdParametersVcl</code> is a pointer to an array of
<span class="eq"><code>sps_max_sub_layers_minus1</code> + 1</span> number of
<code>StdVideoH265SubLayerHrdParameters</code> structures where
<code>sps_max_sub_layers_minus1</code> is the corresponding member of the
encompassing <code>StdVideoH265SequenceParameterSet</code> structure and each
element is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>cbr_flag</code> is a bitmask where bit index <span class="eq">i</span> corresponds to
<code>cbr_flag[i]</code> as defined in section E.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of the <code>StdVideoH265SubLayerHrdParameters</code>
structure are interpreted as defined in section E.3.3 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>StdVideoH265HrdParameters</code> are interpreted as
defined in section E.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members of <code>pSequenceParameterSetVui</code> are interpreted as
defined in section E.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.sps_palette_predictor_initializer_present_flag</code> is set,
then the <code>PredictorPaletteEntries</code> member of the
<code>StdVideoH265PredictorPaletteEntries</code> structure pointed to by
<code>pPredictorPaletteEntries</code> is interpreted as defined in section
7.4.9.13 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265SequenceParameterSet</code> are
interpreted as defined in section 7.4.3.1 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a id="encode-h265-pps"></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">H.265 Picture Parameter Sets (PPS)</dt>
<dd>
<p>Represented by <code>StdVideoH265PictureParameterSet</code> structures and
interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>reserved1</code>, <code>reserved2</code>, and <code>reserved3</code> are used only for
padding purposes and are otherwise ignored;</p>
</li>
<li>
<p>the triplet constructed from <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code> is used
as the key of the PPS entry;</p>
</li>
<li>
<p>if <code>flags.pps_scaling_list_data_present_flag</code> is set, then the
<code>StdVideoH265ScalingLists</code> structure pointed to by <code>pScalingLists</code>
is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>ScalingList4x4</code>, <code>ScalingList8x8</code>, <code>ScalingList16x16</code>, and
<code>ScalingList32x32</code> correspond to <code>ScalingList[0]</code>, <code>ScalingList[1]</code>,
<code>ScalingList[2]</code>, and <code>ScalingList[3]</code>, respectively, as defined in
section 7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>ScalingListDCCoef16x16</code> and <code>ScalingListDCCoef32x32</code> correspond
to <code>scaling_list_dc_coef_minus8[0]</code> and
<code>scaling_list_dc_coef_minus8[1]</code>, respectively, as defined in section
7.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.pps_palette_predictor_initializer_present_flag</code> is set,
then the <code>PredictorPaletteEntries</code> member of the
<code>StdVideoH265PredictorPaletteEntries</code> structure pointed to by
<code>pPredictorPaletteEntries</code> is interpreted as defined in section
7.4.9.13 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoH265PictureParameterSet</code> are
interpreted as defined in section 7.4.3.3 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> override any of these parameters according to the
semantics defined in the <a href="chap36.html#encode-overrides">Video Encode Parameter
Overrides</a> section before storing the resulting H.265 parameter sets into
the video session parameters object.
Applications need to use the <a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>
command to determine whether any implementation overrides happened and to
retrieve the encoded H.265 parameter sets in order to be able to produce a
compliant H.265 video bitstream.</p>
</div>
<div class="paragraph">
<p>Such H.265 parameter set overrides <strong class="purple">may</strong> also have cascading effects on the
implementation overrides applied to the encoded bitstream produced by video
encode operations.
If the implementation supports the
<code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_HAS_OVERRIDES_BIT_KHR</code>
<a href="chap17.html#queries-video-encode-feedback">video encode feedback query</a> flag, then the
application <strong class="purple">can</strong> use such queries to retrieve feedback about whether any
implementation overrides have been applied to the encoded bitstream.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a <a href="chap36.html#video-session-parameters">video session parameters</a> object is
created with the codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, the
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a>::<code>pNext</code> chain <strong class="purple">must</strong> include
a <code>VkVideoEncodeH265SessionParametersCreateInfoKHR</code> structure specifying
the capacity and initial contents of the object.</p>
</div>
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersCreateInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265SessionParametersCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                        <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                            <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdVPSCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdSPSCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                               <span class="n">maxStdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeH265SessionParametersAddInfoKHR</span><span class="o">*</span>    <span class="n">pParametersAddInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265SessionParametersCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>maxStdVPSCount</code> is the maximum number of <a href="chap36.html#encode-h265-vps">H.265
VPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdSPSCount</code> is the maximum number of <a href="chap36.html#encode-h265-sps">H.265
SPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>maxStdPPSCount</code> is the maximum number of <a href="chap36.html#encode-h265-pps">H.265
PPS</a> entries the created <code>VkVideoSessionParametersKHR</code> <strong class="purple">can</strong>
contain.</p>
</li>
<li>
<p><code>pParametersAddInfo</code> is <code>NULL</code> or a pointer to a
<a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure specifying
H.265 parameters to add upon object creation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersCreateInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersCreateInfoKHR-pParametersAddInfo-parameter</span><br>
 If <code>pParametersAddInfo</code> is not <code>NULL</code>, <code>pParametersAddInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap36.html#VkVideoEncodeH265SessionParametersAddInfoKHR">VkVideoEncodeH265SessionParametersAddInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersAddInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersAddInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265SessionParametersAddInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                            <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdVPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH265VideoParameterSet</span><span class="o">*</span>       <span class="n">pStdVPSs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdSPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH265SequenceParameterSet</span><span class="o">*</span>    <span class="n">pStdSPSs</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                   <span class="n">stdPPSCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoH265PictureParameterSet</span><span class="o">*</span>     <span class="n">pStdPPSs</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265SessionParametersAddInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>stdVPSCount</code> is the number of elements in the <code>pStdVPSs</code> array.</p>
</li>
<li>
<p><code>pStdVPSs</code> is a pointer to an array of
<code>StdVideoH265VideoParameterSet</code> structures describing the
<a href="chap36.html#encode-h265-vps">H.265 VPS</a> entries to add.</p>
</li>
<li>
<p><code>stdSPSCount</code> is the number of elements in the <code>pStdSPSs</code> array.</p>
</li>
<li>
<p><code>pStdSPSs</code> is a pointer to an array of
<code>StdVideoH265SequenceParameterSet</code> structures describing the
<a href="chap36.html#encode-h265-sps">H.265 SPS</a> entries to add.</p>
</li>
<li>
<p><code>stdPPSCount</code> is the number of elements in the <code>pStdPPSs</code> array.</p>
</li>
<li>
<p><code>pStdPPSs</code> is a pointer to an array of
<code>StdVideoH265PictureParameterSet</code> structures describing the
<a href="chap36.html#encode-h265-pps">H.265 PPS</a> entries to add.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure <strong class="purple">can</strong> be specified in the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <code>pParametersAddInfo</code> member of the
<a href="chap36.html#VkVideoEncodeH265SessionParametersCreateInfoKHR">VkVideoEncodeH265SessionParametersCreateInfoKHR</a> structure
specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoSessionParametersCreateInfoKHR">VkVideoSessionParametersCreateInfoKHR</a> used to create a
<a href="chap36.html#video-session-parameters">video session parameters</a> object.
In this case, if the video codec operation the video session parameters
object is created with is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then it defines the
set of initial parameters to add to the created object (see
<a href="chap36.html#creating-video-session-parameters">Creating Video Session
Parameters</a>).</p>
</li>
<li>
<p>In the <code>pNext</code> chain of <a href="chap36.html#VkVideoSessionParametersUpdateInfoKHR">VkVideoSessionParametersUpdateInfoKHR</a>.
In this case, if the video codec operation the
<a href="chap36.html#video-session-parameters">video session parameters</a> object to be
updated was created with is
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, then it defines the
set of parameters to add to it (see
<a href="chap36.html#video-session-parameters-update">Updating Video Session Parameters</a>).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_ADD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdVPSs-parameter</span><br>
 If <code>stdVPSCount</code> is not <code>0</code>, and <code>pStdVPSs</code> is not <code>NULL</code>, <code>pStdVPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdVPSCount</code> <code>StdVideoH265VideoParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdSPSs-parameter</span><br>
 If <code>stdSPSCount</code> is not <code>0</code>, and <code>pStdSPSs</code> is not <code>NULL</code>, <code>pStdSPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdSPSCount</code> <code>StdVideoH265SequenceParameterSet</code> values</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-pStdPPSs-parameter</span><br>
 If <code>stdPPSCount</code> is not <code>0</code>, and <code>pStdPPSs</code> is not <code>NULL</code>, <code>pStdPPSs</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>stdPPSCount</code> <code>StdVideoH265PictureParameterSet</code> values</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06438" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06438"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06438</span><br>

The <code>vps_video_parameter_set_id</code> member of each
<code>StdVideoH265VideoParameterSet</code> structure specified in the elements
of <code>pStdVPSs</code> <strong class="purple">must</strong> be unique within <code>pStdVPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06439" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06439"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06439</span><br>

The pair constructed from the <code>sps_video_parameter_set_id</code> and
<code>sps_seq_parameter_set_id</code> members of each
<code>StdVideoH265SequenceParameterSet</code> structure specified in the
elements of <code>pStdSPSs</code> <strong class="purple">must</strong> be unique within <code>pStdSPSs</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06440" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06440"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersAddInfoKHR-None-06440</span><br>

The triplet constructed from the <code>sps_video_parameter_set_id</code>,
<code>pps_seq_parameter_set_id</code>, and <code>pps_pic_parameter_set_id</code>
members of each <code>StdVideoH265PictureParameterSet</code> structure specified
in the elements of <code>pStdPPSs</code> <strong class="purple">must</strong> be unique within <code>pStdPPSs</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersGetInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersGetInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265SessionParametersGetInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">writeStdVPS</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">writeStdSPS</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">writeStdPPS</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">stdVPSId</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">stdSPSId</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">stdPPSId</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265SessionParametersGetInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>writeStdVPS</code> indicates whether the encoded <a href="chap36.html#encode-h265-vps">H.265
video parameter set</a> identified by <code>stdVPSId</code> is requested to be
retrieved.</p>
</li>
<li>
<p><code>writeStdSPS</code> indicates whether the encoded <a href="chap36.html#encode-h265-sps">H.265
sequence parameter set</a> identified by the pair constructed from
<code>stdVPSId</code> and <code>stdSPSId</code> is requested to be retrieved.</p>
</li>
<li>
<p><code>writeStdPPS</code> indicates whether the encoded <a href="chap36.html#encode-h265-pps">H.265
picture parameter set</a> identified by the triplet constructed from
<code>stdVPSId</code>, <code>stdSPSId</code>, and <code>stdPPSId</code> is requested to be
retrieved.</p>
</li>
<li>
<p><code>stdVPSId</code> specifies the H.265 video parameter set ID used to
identify the retrieved H.265 video, sequence, and/or picture parameter
set(s).</p>
</li>
<li>
<p><code>stdSPSId</code> specifies the H.265 sequence parameter set ID used to
identify the retrieved H.265 sequence and/or picture parameter set(s)
when <code>writeStdSPS</code> and/or <code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>stdPPSId</code> specifies the H.265 picture parameter set ID used to
identify the retrieved H.265 picture parameter set when
<code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeSessionParametersGetInfoKHR">VkVideoEncodeSessionParametersGetInfoKHR</a> structure passed to
<a href="chap36.html#vkGetEncodedVideoSessionParametersKHR">vkGetEncodedVideoSessionParametersKHR</a>, the command will write encoded
parameter data to the output buffer in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <a href="chap36.html#encode-h265-vps">H.265 video parameter set</a> identified by
<code>stdVPSId</code>, if <code>writeStdVPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#encode-h265-sps">H.265 sequence parameter set</a> identified by the
pair constructed from <code>stdVPSId</code> and <code>stdSPSId</code>, if
<code>writeStdSPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p>The <a href="chap36.html#encode-h265-pps">H.265 picture parameter set</a> identified by the
triplet constructed from <code>stdVPSId</code>, <code>stdSPSId</code>, and
<code>stdPPSId</code>, if <code>writeStdPPS</code> is set to <code>VK_TRUE</code>.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersGetInfoKHR-writeStdVPS-08290" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersGetInfoKHR-writeStdVPS-08290"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersGetInfoKHR-writeStdVPS-08290</span><br>

At least one of <code>writeStdVPS</code>, <code>writeStdSPS</code>, and
<code>writeStdPPS</code> <strong class="purple">must</strong> be set to <code>VK_TRUE</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersGetInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersGetInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersGetInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_GET_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265SessionParametersFeedbackInfoKHR</code> structure is
defined as:</p>
</div>
<div id="VkVideoEncodeH265SessionParametersFeedbackInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265SessionParametersFeedbackInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="kt">void</span><span class="o">*</span>              <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">hasStdVPSOverrides</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">hasStdSPSOverrides</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">hasStdPPSOverrides</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265SessionParametersFeedbackInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>hasStdVPSOverrides</code> indicates whether any of the parameters of the
requested <a href="chap36.html#encode-h265-vps">H.265 video parameter set</a>, if one was
requested via
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>writeStdVPS</code>,
were <a href="chap36.html#encode-overrides">overridden</a> by the implementation.</p>
</li>
<li>
<p><code>hasStdSPSOverrides</code> indicates whether any of the parameters of the
requested <a href="chap36.html#encode-h265-sps">H.265 sequence parameter set</a>, if one was
requested via
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>writeStdSPS</code>,
were <a href="chap36.html#encode-overrides">overridden</a> by the implementation.</p>
</li>
<li>
<p><code>hasStdPPSOverrides</code> indicates whether any of the parameters of the
requested <a href="chap36.html#encode-h265-pps">H.265 picture parameter set</a>, if one was
requested via
<a href="chap36.html#VkVideoEncodeH265SessionParametersGetInfoKHR">VkVideoEncodeH265SessionParametersGetInfoKHR</a>::<code>writeStdPPS</code>,
were <a href="chap36.html#encode-overrides">overridden</a> by the implementation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265SessionParametersFeedbackInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265SessionParametersFeedbackInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265SessionParametersFeedbackInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_SESSION_PARAMETERS_FEEDBACK_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_h_265_encoding_parameters"><a class="anchor" href="chap36.html#_h_265_encoding_parameters"></a>36.18.10. H.265 Encoding Parameters</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH265PictureInfoKHR">VkVideoEncodeH265PictureInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265PictureInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265PictureInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                        <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                           <span class="n">naluSliceSegmentEntryCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">VkVideoEncodeH265NaluSliceSegmentInfoKHR</span><span class="o">*</span>    <span class="n">pNaluSliceSegmentEntries</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoEncodeH265PictureInfo</span><span class="o">*</span>               <span class="n">pStdPictureInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265PictureInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>naluSliceSegmentEntryCount</code> is the number of elements in
<code>pNaluSliceSegmentEntries</code>.</p>
</li>
<li>
<p><code>pNaluSliceSegmentEntries</code> is a pointer to an array of
<code>naluSliceSegmentEntryCount</code>
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a> structures specifying the
parameters of the individual H.265 slice segments to encode for the
input picture.</p>
</li>
<li>
<p><code>pStdPictureInfo</code> is a pointer to a
<code>StdVideoEncodeH265PictureInfo</code> structure specifying
<a href="chap36.html#encode-h265-picture-info">H.265 picture information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a> to
specify the codec-specific picture information for an <a href="chap36.html#encode-h265">H.265
encode operation</a>.</p>
</div>
<div id="encode-h265-input-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Encode Input Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a> structure passed to <a href="chap36.html#vkCmdEncodeVideoKHR">vkCmdEncodeVideoKHR</a>,
the information related to the <a href="chap36.html#encode-input-picture-info">encode input
picture</a> is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#encode-h265-picture-data-access">H.265 Encode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The encode input picture is associated with the
<a href="chap36.html#encode-h265-picture-info">H.265 picture information</a> provided in
<code>pStdPictureInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h265-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Std Picture Information</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH265PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p><code>flags.is_reference</code> as defined in section 3.132 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.IrapPicFlag</code> as defined in section 3.73 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as “used for long-term reference” as defined in
section 8.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.discardable_flag</code> and <code>cross_layer_bla_flag</code> as defined in
section F.7.4.7.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>pic_type</code> as defined in section 7.4.3.5 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p><code>sps_video_parameter_set_id</code>, <code>pps_seq_parameter_set_id</code>, and
<code>pps_pic_parameter_set_id</code> are used to identify the active parameter
sets, as described below;</p>
</li>
<li>
<p><code>PicOrderCntVal</code> as defined in section 8.3.1 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>TemporalId</code> as defined in section 7.4.2.2 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p>if <code>pRefLists</code> is not <code>NULL</code>, then it is a pointer to a
<code>StdVideoEncodeH265ReferenceListsInfo</code> structure that is interpreted
as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>ref_pic_list_modification_flag_l0</code> and
<code>ref_pic_list_modification_flag_l1</code> as defined in section 7.4.7.2 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>num_ref_idx_l0_active_minus1</code> and <code>num_ref_idx_l1_active_minus1</code>
as defined in section 7.4.7.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
<li>
<p><code>RefPicList0</code> and <code>RefPicList1</code> as defined in section 8.3.4 of
the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a> where each element of
these arrays either identifies an
<a href="chap36.html#encode-active-reference-picture-info">active reference picture</a> using
its <a href="chap36.html#dpb-slot">DPB slot</a> index or contains the value
<code>STD_VIDEO_H265_NO_REFERENCE_PICTURE</code> to indicate “no reference
picture”;</p>
</li>
<li>
<p><code>list_entry_l0</code> and <code>list_entry_l1</code> as defined in section 7.4.7.2
of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>if <code>flags.short_term_ref_pic_set_sps_flag</code> is set, then the
<code>StdVideoH265ShortTermRefPicSet</code> structure pointed to by
<code>pShortTermRefPicSet</code> is interpreted as defined for the elements of
the <code>pShortTermRefPicSet</code> array specified in <a href="chap36.html#encode-h265-sps">H.265
sequence parameter sets</a>.</p>
</li>
<li>
<p>if <code>flags.long_term_ref_pics_present_flag</code> is set in the
<a href="chap36.html#encode-h265-active-sps">active SPS</a>, then the
<code>StdVideoEncodeH265LongTermRefPics</code> structure pointed to by
<code>pLongTermRefPics</code> is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>used_by_curr_pic_lt_flag</code> is a bitmask where bit index <span class="eq">i</span>
corresponds to <code>used_by_curr_pic_lt_flag[i]</code> as defined in section
7.4.7.1 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoEncodeH265LongTermRefPics</code> are
interpreted as defined in section 7.4.7.1 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members are interpreted as defined in section 7.4.7.1 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h265-ref-pic-setup" class="paragraph">
<p>Reference picture setup is controlled by the value of
<code>StdVideoEncodeH265PictureInfo</code>::<code>flags.is_reference</code>.
If it is set and a <a href="chap36.html#encode-reconstructed-picture-info">reconstructed
picture</a> is specified, then the latter is used as the target of picture
reconstruction to <a href="chap36.html#dpb-slot-states">activate</a> the <a href="chap36.html#dpb-slot">DPB slot</a>
specified in <code>pEncodeInfo-&gt;pSetupReferenceSlot-&gt;slotIndex</code>.
If <code>StdVideoEncodeH265PictureInfo</code>::<code>flags.is_reference</code> is not set,
but a <a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture</a> is
specified, then the corresponding picture reference associated with the
<a href="chap36.html#dpb-slot">DPB slot</a> is invalidated, as described in the
<a href="chap36.html#dpb-slot-states">DPB Slot States</a> section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Active Parameter Sets</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH265PictureInfo</code> structure pointed to
by <code>pStdPictureInfo</code> are used to select the active parameter sets to use
from the bound video session parameters object, as follows:</p>
<div class="ulist">
<ul>
<li>
<p><a id="encode-h265-active-vps"></a> The <em>active VPS</em> is the
<a href="chap36.html#encode-h265-vps">VPS</a> identified by the key specified in
<code>StdVideoEncodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="encode-h265-active-sps"></a> The <em>active SPS</em> is the
<a href="chap36.html#encode-h265-sps">SPS</a> identified by the key specified by the pair
constructed from
<code>StdVideoEncodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code> and
<code>StdVideoEncodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>.</p>
</li>
<li>
<p><a id="encode-h265-active-pps"></a> The <em>active PPS</em> is the
<a href="chap36.html#encode-h265-pps">PPS</a> identified by the key specified by the triplet
constructed from
<code>StdVideoEncodeH265PictureInfo</code>::<code>sps_video_parameter_set_id</code>,
<code>StdVideoEncodeH265PictureInfo</code>::<code>pps_seq_parameter_set_id</code>, and
<code>StdVideoEncodeH265PictureInfo</code>::<code>pps_pic_parameter_set_id</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h265-weighted-pred" class="paragraph">
<p>H.265 encoding uses <em>explicit weighted sample prediction</em> for a slice
segment, as defined in section 8.5.3.3.4 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>, if any of the following conditions are true for the active
<a href="chap36.html#encode-h265-pps">PPS</a> and the <code>pStdSliceSegmentHeader</code> member of the
corresponding element of <code>pNaluSliceSegmentEntries</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pStdSliceSegmentHeader-&gt;slice_type</code> is
<code>STD_VIDEO_H265_SLICE_TYPE_P</code> and <code>weighted_pred_flag</code> is enabled
in the active PPS.</p>
</li>
<li>
<p><code>pStdSliceSegmentHeader-&gt;slice_type</code> is
<code>STD_VIDEO_H265_SLICE_TYPE_B</code> and <code>weighted_bipred_flag</code> is
enabled in the active PPS.</p>
</li>
</ul>
</div>
<div id="encode-h265-tile-count" class="paragraph">
<p>The number of H.265 tiles, as defined in section 3.174 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>, is derived from the
<code>num_tile_columns_minus1</code> and <code>num_tile_rows_minus1</code> members of the
active <a href="chap36.html#encode-h265-pps">PPS</a> as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq">(<code>num_tile_columns_minus1</code> +  1) ×
(<code>num_tile_rows_minus1</code> +  1)</span></p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-naluSliceSegmentEntryCount-08306" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-naluSliceSegmentEntryCount-08306"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-naluSliceSegmentEntryCount-08306</span><br>

<code>naluSliceSegmentEntryCount</code> <strong class="purple">must</strong> be between <code>1</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxSliceSegmentCount</code>,
inclusive, as returned by <a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a>
for the used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-flags-08323" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-flags-08323"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-flags-08323</span><br>

If <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_TILES_PER_SLICE_SEGMENT_BIT_KHR</code>,
then <code>naluSliceSegmentEntryCount</code> <strong class="purple">must</strong> be greater than or equal to
the <a href="chap36.html#encode-h265-tile-count">number of H.265 tiles in the picture</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-flags-08324" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-flags-08324"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-flags-08324</span><br>

If <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_MULTIPLE_SLICE_SEGMENTS_PER_TILE_BIT_KHR</code>,
then <code>naluSliceSegmentEntryCount</code> <strong class="purple">must</strong> be less than or equal to the
<a href="chap36.html#encode-h265-tile-count">number of H.265 tiles in the picture</a></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-flags-08316" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-flags-08316"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-flags-08316</span><br>

If <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_PREDICTION_WEIGHT_TABLE_GENERATED_BIT_KHR</code>
and the slice segment corresponding to any element of
<code>pNaluSliceSegmentEntries</code> uses <a href="chap36.html#encode-h265-weighted-pred">explicit
weighted sample prediction</a>, then
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>pStdSliceSegmentHeader-&gt;pWeightTable</code>
<strong class="purple">must</strong> not be <code>NULL</code> for that element of <code>pNaluSliceSegmentEntries</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-flags-08317" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-flags-08317"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-flags-08317</span><br>

If <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_DIFFERENT_SLICE_SEGMENT_TYPE_BIT_KHR</code>,
then
<a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a>::<code>pStdSliceSegmentHeader-&gt;slice_type</code>
<strong class="purple">must</strong> be identical for all elements of <code>pNaluSliceSegmentEntries</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_PICTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-pNaluSliceSegmentEntries-parameter" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-pNaluSliceSegmentEntries-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-pNaluSliceSegmentEntries-parameter</span><br>
 <code>pNaluSliceSegmentEntries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>naluSliceSegmentEntryCount</code> valid <a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-pStdPictureInfo-parameter" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-pStdPictureInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-pStdPictureInfo-parameter</span><br>
 <code>pStdPictureInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoEncodeH265PictureInfo</code> value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265PictureInfoKHR-naluSliceSegmentEntryCount-arraylength" href="chap36.html#VUID-VkVideoEncodeH265PictureInfoKHR-naluSliceSegmentEntryCount-arraylength"></a> <span class="vuid">VUID-VkVideoEncodeH265PictureInfoKHR-naluSliceSegmentEntryCount-arraylength</span><br>
 <code>naluSliceSegmentEntryCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH265NaluSliceSegmentInfoKHR">VkVideoEncodeH265NaluSliceSegmentInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265NaluSliceSegmentInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265NaluSliceSegmentInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                                <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                    <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">int32_t</span>                                        <span class="n">constantQp</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoEncodeH265SliceSegmentHeader</span><span class="o">*</span>    <span class="n">pStdSliceSegmentHeader</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265NaluSliceSegmentInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>constantQp</code> is the QP to use for the slice segment if the current
<a href="chap36.html#encode-rate-control-modes">rate control mode</a> configured for the video
session is <code>VK_VIDEO_ENCODE_RATE_CONTROL_MODE_DISABLED_BIT_KHR</code>.</p>
</li>
<li>
<p><code>pStdSliceSegmentHeader</code> is a pointer to a
<code>StdVideoEncodeH265SliceSegmentHeader</code> structure specifying
<a href="chap36.html#encode-h265-slice-segment-header-params">H.265 slice segment header
parameters</a> for the slice segment.</p>
</li>
</ul>
</div>
<div id="encode-h265-slice-segment-header-params" class="dlist">
<dl>
<dt class="hdlist1">Std Slice Segment Header Parameters</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH265SliceSegmentHeader</code> structure
pointed to by <code>pStdSliceSegmentHeader</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> and <code>reserved1</code> are used only for padding
purposes and are otherwise ignored;</p>
</li>
<li>
<p>if <code>pWeightTable</code> is not <code>NULL</code>, then it is a pointer to a
<code>StdVideoEncodeH265WeightTable</code> that is interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.luma_weight_l0_flag</code>, <code>flags.chroma_weight_l0_flag</code>,
<code>flags.luma_weight_l1_flag</code>, and <code>flags.chroma_weight_l1_flag</code>
are bitmasks where bit index <span class="eq">i</span> corresponds to
<code>luma_weight_l0_flag[i]</code>, <code>chroma_weight_l0_flag[i]</code>,
<code>luma_weight_l1_flag[i]</code>, and <code>chroma_weight_l1_flag[i]</code>, respectively,
as defined in section 7.4.7.3 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
<li>
<p>all other members of <code>StdVideoEncodeH265WeightTable</code> are interpreted
as defined in section 7.4.7.3 of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>all other members are interpreted as defined in section 7.4.7.1 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_NALU_SLICE_SEGMENT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-pNext-pNext" href="chap36.html#VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-pStdSliceSegmentHeader-parameter" href="chap36.html#VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-pStdSliceSegmentHeader-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265NaluSliceSegmentInfoKHR-pStdSliceSegmentHeader-parameter</span><br>
 <code>pStdSliceSegmentHeader</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoEncodeH265SliceSegmentHeader</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH265DpbSlotInfoKHR">VkVideoEncodeH265DpbSlotInfoKHR</a> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265DpbSlotInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265DpbSlotInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                               <span class="n">pNext</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">StdVideoEncodeH265ReferenceInfo</span><span class="o">*</span>    <span class="n">pStdReferenceInfo</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265DpbSlotInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pStdReferenceInfo</code> is a pointer to a
<code>StdVideoEncodeH265ReferenceInfo</code> structure specifying
<a href="chap36.html#encode-h265-reference-info">H.265 reference information</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, if not <code>NULL</code>, and
the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code> to specify the
codec-specific reference picture information for an <a href="chap36.html#encode-h265">H.265
encode operation</a>.</p>
</div>
<div id="encode-h265-active-reference-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Active Reference Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of the elements of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code>, one element is added to
the list of <a href="chap36.html#encode-active-reference-picture-info">active reference
pictures</a> used by the video encode operation for each element of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code> as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#encode-h265-picture-data-access">H.265 Encode Picture Data Access</a>
section.</p>
</li>
<li>
<p>The reference picture is associated with the <a href="chap36.html#dpb-slot">DPB slot</a> index
specified in the <code>slotIndex</code> member of the corresponding element of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pReferenceSlots</code>.</p>
</li>
<li>
<p>The reference picture is associated with the
<a href="chap36.html#encode-h265-reference-info">H.265 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h265-reconstructed-picture-info" class="dlist">
<dl>
<dt class="hdlist1">Reconstructed Picture Information</dt>
<dd>
<p>When this structure is specified in the <code>pNext</code> chain of
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pSetupReferenceSlot</code>, the information
related to the <a href="chap36.html#encode-reconstructed-picture-info">reconstructed picture</a>
is defined as follows:</p>
<div class="ulist">
<ul>
<li>
<p>The image subregion used is determined according to the
<a href="chap36.html#encode-h265-picture-data-access">H.265 Encode Picture Data Access</a>
section.</p>
</li>
<li>
<p>If <a href="chap36.html#encode-h265-ref-pic-setup">reference picture setup</a> is requested,
then the reconstructed picture is used to <a href="chap36.html#dpb-slot-states">activate</a>
the <a href="chap36.html#dpb-slot">DPB slot</a> with the index specified in
<a href="chap36.html#VkVideoEncodeInfoKHR">VkVideoEncodeInfoKHR</a>::<code>pSetupReferenceSlot-&gt;slotIndex</code>.</p>
</li>
<li>
<p>The reconstructed picture is associated with the
<a href="chap36.html#encode-h265-reference-info">H.265 reference information</a> provided in
<code>pStdReferenceInfo</code>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="encode-h265-reference-info" class="dlist">
<dl>
<dt class="hdlist1">Std Reference Information</dt>
<dd>
<p>The members of the <code>StdVideoEncodeH265ReferenceInfo</code> structure pointed to
by <code>pStdReferenceInfo</code> are interpreted as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>flags.reserved</code> is used only for padding purposes and is otherwise
ignored;</p>
</li>
<li>
<p><code>flags.used_for_long_term_reference</code> is used to indicate whether the
picture is marked as “used for long-term reference” as defined in
section 8.3.2 of the <a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>flags.unused_for_reference</code> is used to indicate whether the picture
is marked as “unused for reference” as defined in section 8.3.2 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>pic_type</code> as defined in section 7.4.3.5 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>;</p>
</li>
<li>
<p><code>PicOrderCntVal</code> as defined in section 8.3.1 of the
<a href="chap2.html#itu-t-h265">ITU-T H.265 Specification</a>;</p>
</li>
<li>
<p><code>TemporalId</code> as defined in section 7.4.2.2 of the <a href="chap2.html#itu-t-h265">ITU-T
H.265 Specification</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265DpbSlotInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265DpbSlotInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265DpbSlotInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_DPB_SLOT_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter" href="chap36.html#VUID-VkVideoEncodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265DpbSlotInfoKHR-pStdReferenceInfo-parameter</span><br>
 <code>pStdReferenceInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>StdVideoEncodeH265ReferenceInfo</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-rate-control"><a class="anchor" href="chap36.html#encode-h265-rate-control"></a>36.18.11. H.265 Encode Rate Control</h4>
<div class="sect4">
<h5 id="encode-h265-gop"><a class="anchor" href="chap36.html#encode-h265-gop"></a>Group of Pictures</h5>
<div class="paragraph">
<p>In case of H.265 encoding it is common practice to follow a regular pattern
of different picture types in display order when encoding subsequent frames.
This pattern is referred to as the <em>group of pictures</em> (GOP).</p>
</div>
<div id="encode-h265-regular-gop" class="paragraph">
<p>A regular GOP is defined by the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of frames in the GOP;</p>
</li>
<li>
<p>The number of consecutive B frames between I and/or P frames in display
order.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>GOPs are further classified as <em>open</em> and <em>closed</em> GOPs.</p>
</div>
<div class="paragraph">
<p>Frame types in an open GOP follow each other in display order according to
the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The first frame is always an I frame.</p>
</li>
<li>
<p>This is followed by a number of consecutive B frames, as defined above.</p>
</li>
<li>
<p>If the number of frames in the GOP is not reached yet, then the next
frame is a P frame and the algorithm continues from step 2.</p>
</li>
</ol>
</div>
<div id="encode-h265-open-gop" class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="641px" height="192px" viewBox="-0.5 -0.5 641 192" style="background-color: rgb(255, 255, 255);"><defs></defs><g><rect x="80" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 81px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="95" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="50" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 51px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="65" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><rect x="110" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 111px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="125" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="140" y="80" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="155" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="170" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="185" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="200" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="215" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="230" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 231px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="245" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="260" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="275" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="290" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="305" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="320" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 321px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="335" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="350" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 351px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="365" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="380" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="395" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="410" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 411px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="425" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="440" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 441px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="455" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="500" y="80" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 501px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="515" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="530" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 531px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="545" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="470" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="485" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="560" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="575" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 139.31 80 L 139 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path><path d="M 499.31 80 L 500 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path><path d="M 146.37 60 L 493.63 60" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 141.12 60 L 148.12 56.5 L 146.37 60 L 148.12 63.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 498.88 60 L 491.88 63.5 L 493.63 60 L 491.88 56.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 70px; margin-left: 309px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">GOP frame count</div></div></div></foreignObject><text x="309" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">GOP frame count</text></switch></g><path d="M 170 140 L 169.52 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path><path d="M 176.37 130 L 253.63 130" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 171.12 130 L 178.12 126.5 L 176.37 130 L 178.12 133.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 258.88 130 L 251.88 133.5 L 253.63 130 L 251.88 126.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 130px; margin-left: 335px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">consecutive B-frame count</div></div></div></foreignObject><text x="335" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">consecutive B-frame count</text></switch></g><path d="M 260 140 L 260 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"></path></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 31. H.265 open GOP</div>
</div>
<div id="encode-h265-idr-period" class="paragraph">
<p>In case of a closed GOP, an <a href="chap36.html#encode-h265-idr-pic">IDR frame</a> is used at a
certain period.</p>
</div>
<div id="encode-h265-closed-gop" class="imageblock text-center">
<div class="content">
<svg version="1.1" width="641px" height="192px" viewBox="-0.5 -0.5 641 192" style="background-color: rgb(255, 255, 255);" id="svg216" sodipodi:docname="h26x_closed_gop.svg" inkscape:version="1.2.2 (732a01da63, 2022-12-09, custom)" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <sodipodi:namedview id="namedview218" pagecolor="#ffffff" bordercolor="#000000" borderopacity="0.25" inkscape:showpageshadow="2" inkscape:pageopacity="0.0" inkscape:pagecheckerboard="0" inkscape:deskcolor="#d1d1d1" showgrid="false" inkscape:zoom="2.0436817" inkscape:cx="389.98244" inkscape:cy="40.612977" inkscape:window-width="1920" inkscape:window-height="1043" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="1" inkscape:current-layer="g206"></sodipodi:namedview>
  <defs id="defs18"></defs>
  <g id="g206">
    <path d="M 139.6 80 L 139.6 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path20"></path>
    <path d="M 500 80 L 500.48 50" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path22"></path>
    <path d="M 140 140 L 140 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path24"></path>
    <path d="M 320 140 L 320 110" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke" id="path26"></path>
    <path d="M 146.37 130 L 313.63 130" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke" id="path28"></path>
    <path d="M 141.12 130 L 148.12 126.5 L 146.37 130 L 148.12 133.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path30"></path>
    <path d="M 318.88 130 L 311.88 133.5 L 313.63 130 L 311.88 126.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path32"></path>
    <g transform="translate(-0.5 -0.5)" id="g38">
      <switch id="switch36">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 120px; margin-left: 225px;">
            <xhtml:div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">GOP frame count</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="225" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" id="text34">GOP frame count</text>
      </switch>
    </g>
    <path d="M 146.37 60 L 493.63 60" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke" id="path40"></path>
    <path d="M 141.12 60 L 148.12 56.5 L 146.37 60 L 148.12 63.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path42"></path>
    <path d="M 498.88 60 L 491.88 63.5 L 493.63 60 L 491.88 56.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all" id="path44"></path>
    <g transform="translate(-0.5 -0.5)" id="g50">
      <switch id="switch48">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 70px; margin-left: 309px;">
            <xhtml:div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">IDR period</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="309" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" id="text46">IDR period</text>
      </switch>
    </g>
    <rect x="80" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all" id="rect62"></rect>
    <g transform="translate(-0.5 -0.5)" id="g68">
      <switch id="switch66">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 81px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="95" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text64">B</text>
      </switch>
    </g>
    <rect x="50" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all" id="rect70"></rect>
    <g transform="translate(-0.5 -0.5)" id="g76">
      <switch id="switch74">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 51px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="65" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text72">...</text>
      </switch>
    </g>
    <rect x="110" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all" id="rect78"></rect>
    <g transform="translate(-0.5 -0.5)" id="g84">
      <switch id="switch82">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 111px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="125" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text80">B</text>
      </switch>
    </g>
    <rect x="140" y="80" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect86"></rect>
    <g transform="translate(-0.5 -0.5)" id="g92">
      <switch id="switch90">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 141px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">IDR</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="155" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text88">IDR</text>
      </switch>
    </g>
    <rect x="170" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect94"></rect>
    <g transform="translate(-0.5 -0.5)" id="g100">
      <switch id="switch98">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 171px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="185" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text96">B</text>
      </switch>
    </g>
    <rect x="200" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect102"></rect>
    <g transform="translate(-0.5 -0.5)" id="g108">
      <switch id="switch106">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 201px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="215" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text104">B</text>
      </switch>
    </g>
    <rect x="230" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect110"></rect>
    <g transform="translate(-0.5 -0.5)" id="g116">
      <switch id="switch114">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 231px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="245" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text112">P</text>
      </switch>
    </g>
    <rect x="260" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect118"></rect>
    <g transform="translate(-0.5 -0.5)" id="g124">
      <switch id="switch122">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 261px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="275" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text120">B</text>
      </switch>
    </g>
    <rect x="290" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect126"></rect>
    <g transform="translate(-0.5 -0.5)" id="g132">
      <switch id="switch130">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 291px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="305" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text128">B</text>
      </switch>
    </g>
    <rect x="350" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect134"></rect>
    <g transform="translate(-0.5 -0.5)" id="g140">
      <switch id="switch138">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 351px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="365" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text136">B</text>
      </switch>
    </g>
    <rect x="410" y="80" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect142"></rect>
    <g transform="translate(-0.5 -0.5)" id="g148">
      <switch id="switch146">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 411px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="425" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text144">P</text>
      </switch>
    </g>
    <rect x="380" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect150"></rect>
    <g transform="translate(-0.5 -0.5)" id="g156">
      <switch id="switch154">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 381px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="395" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text152">B</text>
      </switch>
    </g>
    <rect x="440" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect158"></rect>
    <g transform="translate(-0.5 -0.5)" id="g164">
      <switch id="switch162">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 441px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="455" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text160">B</text>
      </switch>
    </g>
    <rect x="500" y="80" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all" id="rect166"></rect>
    <g transform="translate(-0.5 -0.5)" id="g172">
      <switch id="switch170">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 501px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">IDR</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="515" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text168">IDR</text>
      </switch>
    </g>
    <rect x="530" y="80" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all" id="rect174"></rect>
    <g transform="translate(-0.5 -0.5)" id="g180">
      <switch id="switch178">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 531px;">
            <xhtml:div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="545" y="99" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" id="text176">B</text>
      </switch>
    </g>
    <rect x="560" y="80" width="30" height="30" fill="none" stroke="none" pointer-events="all" id="rect182"></rect>
    <g transform="translate(-0.5 -0.5)" id="g188">
      <switch id="switch186">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 561px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="575" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text184">...</text>
      </switch>
    </g>
    <rect x="320" y="80" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all" id="rect190"></rect>
    <g transform="translate(-0.5 -0.5)" id="g196">
      <switch id="switch194">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 321px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="335" y="99" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold" id="text192">I</text>
      </switch>
    </g>
    <rect x="470.03387" y="79.997772" width="30" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" id="rect158-0"></rect>
    <g transform="translate(30.240538,-0.39011911)" id="g164-8">
      <switch id="switch162-6">
        <foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;">
          <xhtml:div style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 95px; margin-left: 441px;">
            <xhtml:div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;">
              <xhtml:div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</xhtml:div>
            </xhtml:div>
          </xhtml:div>
        </foreignObject>
        <text x="455" y="99" fill="#000000" font-family="'Roboto Mono'" font-size="14px" text-anchor="middle" id="text160-2">B</text>
      </switch>
    </g>
  </g>
  <switch id="switch214">
    <g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" id="g208"></g>
    <a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank" id="a212">
      <text text-anchor="middle" font-size="10px" x="50%" y="100%" id="text210">Text is not SVG - cannot display</text>
    </a>
  </switch>
</svg>
</div>
<div class="title">Figure 32. H.265 closed GOP</div>
</div>
<div class="paragraph">
<p>It is also typical for H.265 encoding to use specific reference picture
usage patterns across the frames of the GOP.
The two most common reference patterns used are as follows:</p>
</div>
<div id="encode-h265-ref-pattern-flat" class="dlist">
<dl>
<dt class="hdlist1">Flat Reference Pattern</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Each P frame uses the last non-B frame, in display order, as reference.</p>
</li>
<li>
<p>Each B frame uses the last non-B frame, in display order, as its
backward reference, and uses the next non-B frame, in display order, as
its forward reference.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="641px" height="221px" viewBox="-0.5 -0.5 641 221" style="background-color: rgb(255, 255, 255);"><defs></defs><g><rect x="80" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 81px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="95" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="50" y="100" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 51px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="65" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><rect x="110" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 111px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="125" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="140" y="100" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="155" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><path d="M 177.5 100 Q 177.51 80.03 170 80.03 Q 162.49 80.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 158.99 91.88 L 162.5 93.63 L 165.99 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 192.5 130 Q 192.49 170.03 230 170.03 Q 267.51 170.03 267.5 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.12 L 271 138.12 L 267.5 136.37 L 264 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="170" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="185" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 207.5 100 Q 207.51 70.03 185 70.03 Q 162.49 70.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 159 91.88 L 162.5 93.63 L 166 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 222.5 130 Q 222.49 160.03 245 160.03 Q 267.51 160.03 267.5 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.12 L 271 138.12 L 267.5 136.37 L 264 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="200" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="215" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 237.5 100 Q 237.51 60.03 200 60.03 Q 162.49 60.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 159 91.88 L 162.5 93.63 L 166 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 252.5 130 Q 252.49 150.03 260 150.03 Q 267.51 150.03 267.5 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.12 L 271.01 138.12 L 267.5 136.37 L 264.01 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="230" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 231px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="245" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 267.5 100 Q 267.51 50.03 215 50.03 Q 162.49 50.03 162.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.88 L 159 91.88 L 162.5 93.63 L 166 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="260" y="100" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="275" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="290" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="305" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="320" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 321px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="335" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="350" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 351px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="365" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="380" y="100" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="395" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="410" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 411px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="425" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="440" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 441px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="455" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="500" y="100" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 501px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="515" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="530" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 531px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="545" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="470" y="100" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="485" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="560" y="100" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="575" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 297.5 100 Q 296.49 100.03 296.49 90.03 Q 296.49 80.03 289.49 80.03 Q 282.49 80.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 278.99 91.88 L 282.5 93.63 L 285.99 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 327.5 100 Q 327.51 70.03 305 70.03 Q 282.49 70.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 279 91.88 L 282.5 93.63 L 286 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 357.5 100 Q 357.51 60.03 320 60.03 Q 282.49 60.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 279 91.88 L 282.5 93.63 L 286 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 387.5 100 Q 387.51 50.03 335 50.03 Q 282.49 50.03 282.5 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.88 L 279 91.88 L 282.5 93.63 L 286 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 417 100 Q 416.03 80.03 409.03 80.03 Q 402.03 80.03 402.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402 98.88 L 398.51 91.88 L 402.01 93.63 L 405.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 447 100 Q 447 70.03 424.51 70.03 Q 402.03 70.03 402.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402 98.88 L 398.51 91.88 L 402.01 93.63 L 405.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 477 100 Q 477 60.03 439.51 60.03 Q 402.03 60.03 402 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402 98.88 L 398.51 91.88 L 402 93.63 L 405.51 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 312 130 Q 312.03 170.03 349.51 170.03 Q 387 170.03 387 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.12 L 390.5 138.12 L 387 136.37 L 383.5 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 342 130 Q 342.03 160.03 364.51 160.03 Q 387 160.03 387 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.12 L 390.5 138.12 L 387 136.37 L 383.5 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 372 130 Q 372.03 150.03 379.51 150.03 Q 387 150.03 387 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.12 L 390.5 138.12 L 387 136.37 L 383.5 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 433 130 Q 433 170.03 470.51 170.03 Q 508.03 170.03 508 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 508 131.12 L 511.51 138.12 L 508 136.37 L 504.51 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 463 130 Q 463 160.03 485.51 160.03 Q 508.03 160.03 508.01 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 508 131.12 L 511.51 138.11 L 508.01 136.37 L 504.51 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 493 130 Q 493 150.03 500.51 150.03 Q 508.03 150.03 508.01 136.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 508 131.12 L 511.51 138.11 L 508.01 136.37 L 504.51 138.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 33. H.265 flat reference pattern</div>
</div>
<div id="encode-h265-ref-pattern-dyadic" class="dlist">
<dl>
<dt class="hdlist1">Dyadic Reference Pattern</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Each P frame uses the last non-B frame, in display order, as reference.</p>
</li>
<li>
<p>The following algorithm is applied to the sequence of consecutive B
frames between I and/or P frames in display order:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The B frame in the middle of this sequence uses the frame preceding the
sequence as its backward reference, and uses the frame following the
sequence as its forward reference.</p>
</li>
<li>
<p>The algorithm is executed recursively for the following frame sequences:</p>
<div class="ulist">
<ul>
<li>
<p>The B frames of the original sequence preceding the frame in the
middle, if any.</p>
</li>
<li>
<p>The B frames of the original sequence following the frame in the
middle, if any.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="641px" height="212px" viewBox="-0.5 -0.5 641 212" style="background-color: rgb(255, 255, 255);"><defs></defs><g><rect x="80" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 81px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="95" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="50" y="99.97" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 51px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="65" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><rect x="110" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 111px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="125" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="140" y="99.97" width="30" height="30" fill="#b3b3b3" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="155" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><path d="M 177.5 99.97 Q 177.51 79.97 170 79.97 Q 162.49 79.97 162.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.85 L 158.99 91.85 L 162.5 93.6 L 165.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 192.5 129.97 Q 192.49 150.03 200 150.03 Q 207.51 150.03 207.5 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 207.5 131.09 L 211.01 138.09 L 207.5 136.34 L 204.01 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="170" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 171px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="185" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 207.5 99.97 Q 207.51 69.97 185 69.97 Q 162.49 69.97 162.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.85 L 159 91.85 L 162.5 93.6 L 166 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 222.5 129.97 Q 222.49 159.97 245 159.97 Q 267.51 159.97 267.5 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.09 L 271 138.09 L 267.5 136.34 L 264 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="200" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 201px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="215" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 252.5 129.97 Q 252.49 149.97 260 149.97 Q 267.51 149.97 267.5 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 267.5 131.09 L 271.01 138.09 L 267.5 136.34 L 264.01 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 237.5 99.97 Q 237.51 80.03 230 80.03 Q 222.49 80.03 222.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 222.5 98.85 L 218.99 91.85 L 222.5 93.6 L 225.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="230" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 231px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="245" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><path d="M 267.5 99.97 Q 267.51 49.97 215 49.97 Q 162.49 49.97 162.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 162.5 98.85 L 159 91.85 L 162.5 93.6 L 166 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="260" y="99.97" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="275" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="290" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 291px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="305" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="320" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 321px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="335" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="350" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 351px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="365" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="380" y="99.97" width="30" height="30" fill="#e6e6e6" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">P</div></div></div></foreignObject><text x="395" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">P</text></switch></g><rect x="410" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 411px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="425" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="440" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 441px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="455" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="500" y="99.97" width="30" height="30" fill="#e6e6e6" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 501px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">I</div></div></div></foreignObject><text x="515" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">I</text></switch></g><rect x="530" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="#808080" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 531px;"><div data-drawio-colors="color: #808080; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(128, 128, 128); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="545" y="119" fill="#808080" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="470" y="99.97" width="30" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">B</div></div></div></foreignObject><text x="485" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle">B</text></switch></g><rect x="560" y="99.97" width="30" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 115px; margin-left: 561px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: &quot;Roboto Mono&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">...</div></div></div></foreignObject><text x="575" y="119" fill="rgb(0, 0, 0)" font-family="Roboto Mono" font-size="14px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 297.5 99.97 Q 296.49 100.03 296.49 89.97 Q 296.49 79.91 289.49 79.91 Q 282.49 79.91 282.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.85 L 278.99 91.85 L 282.5 93.6 L 285.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 327.5 99.97 Q 327.51 69.91 305 69.91 Q 282.49 69.91 282.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.85 L 279 91.85 L 282.5 93.6 L 286 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 357.5 99.97 Q 357.51 79.97 350 79.97 Q 342.49 79.97 342.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 342.5 98.85 L 338.99 91.85 L 342.5 93.6 L 345.99 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 387.5 99.97 Q 387.51 49.91 335 49.91 Q 282.49 49.91 282.5 93.6" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 282.5 98.85 L 279 91.85 L 282.5 93.6 L 286 91.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 417.49 99.94 Q 416.49 99.91 416.49 89.91 Q 416.49 79.91 409.49 79.91 Q 402.49 79.91 402.49 93.57" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402.49 98.82 L 398.99 91.82 L 402.49 93.57 L 405.99 91.82 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 447.49 99.94 Q 447.51 69.91 425 69.91 Q 402.49 69.91 402.49 93.57" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 402.49 98.82 L 398.99 91.82 L 402.49 93.57 L 405.99 91.82 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 477.49 99.94 Q 477.51 79.91 470 79.91 Q 462.49 79.91 462.49 93.57" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 462.49 98.82 L 458.99 91.82 L 462.49 93.57 L 465.99 91.82 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 312 129.97 Q 312.03 149.97 319.51 149.97 Q 327 149.97 327 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 327 131.09 L 330.5 138.09 L 327 136.34 L 323.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 342 129.97 Q 342.03 159.91 364.51 159.91 Q 387 159.91 387 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.09 L 390.5 138.09 L 387 136.34 L 383.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 372 129.97 Q 372.03 149.91 379.51 149.91 Q 387 149.91 387 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 387 131.09 L 390.5 138.09 L 387 136.34 L 383.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 432 129.97 Q 432.03 149.97 439.51 149.97 Q 447 149.97 447 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 447 131.09 L 450.5 138.09 L 447 136.34 L 443.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 462 129.97 Q 462.03 159.91 484.51 159.91 Q 507 159.91 507 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 507 131.09 L 510.5 138.09 L 507 136.34 L 503.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><path d="M 492 129.97 Q 492.03 149.91 499.51 149.91 Q 507 149.91 507 136.34" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 507 131.09 L 510.5 138.09 L 507 136.34 L 503.5 138.09 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 34. H.265 dyadic reference pattern</div>
</div>
<div class="paragraph">
<p>The application <strong class="purple">can</strong> provide guidance to the implementation’s rate control
algorithm about the structure of the GOP used by the application.
Any such guidance about the GOP and its structure does not mandate that
specific GOP structure to be used by the application, as the picture type of
individual encoded pictures is still application-controlled, however, any
deviation from the provided guidance <strong class="purple">may</strong> result in undesired rate control
behavior including, but not limited, to the implementation not being able to
conform to the expected average or target bitrates, or other rate control
parameters specified by the application.</p>
</div>
<div class="paragraph">
<p>When an H.265 encode session is used to encode multiple temporal sub-layers,
it is also common practice to follow a regular pattern for the H.265
temporal ID for the encoded pictures in display order when encoding
subsequent frames.
This pattern is referred to as the <em>temporal GOP</em>.
The most common temporal layer pattern used is as follows:</p>
</div>
<div id="encode-h265-layer-pattern-dyadic" class="dlist">
<dl>
<dt class="hdlist1">Dyadic Temporal Sub-Layer Pattern</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The number of frames in the temporal GOP is <span class="eq">2<sup>n-1</sup></span>, where <span class="eq">n</span>
is the number of temporal sub-layers.</p>
</li>
<li>
<p>The <span class="eq">i</span><sup>th</sup> frame in the temporal GOP uses temporal ID <span class="eq">t</span>, if
and only if the index of the least significant bit set in <span class="eq">i</span> equals
<span class="eq">n-t-1</span>, except for the first frame, which is the only frame in the
temporal GOP using temporal ID zero.</p>
</li>
<li>
<p>The <span class="eq">i</span><sup>th</sup> frame in the temporal GOP uses the <span class="eq">r</span><sup>th</sup> frame as
reference, where <span class="eq">r</span> is calculated from <span class="eq">i</span> by clearing the
least significant bit set in it, except for the first frame in the
temporal GOP, which uses the first frame of the previous temporal GOP,
if any, as reference.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="649px" height="321px" viewBox="-0.5 -0.5 649 321"><defs></defs><g><rect x="120" y="180" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><rect x="90" y="180" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 195px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="100" y="199" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="90" y="140" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 155px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="100" y="159" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><rect x="90" y="100" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 115px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="100" y="119" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><rect x="90" y="60" width="20" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 75px; margin-left: 91px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="100" y="79" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><rect x="50" y="50" width="40" height="160" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)rotate(-90 70 130)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 130px; margin-left: -9px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Temporal Layer</div></div></div></foreignObject><text x="70" y="135" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">Temporal Layer</text></switch></g><rect x="120" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 121px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="130" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="150" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 151px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="160" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><rect x="180" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 181px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="190" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><rect x="210" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 211px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="220" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><rect x="240" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 241px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="250" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">4</text></switch></g><rect x="270" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 271px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">5</div></div></div></foreignObject><text x="280" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">5</text></switch></g><rect x="300" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 301px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">6</div></div></div></foreignObject><text x="310" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">6</text></switch></g><rect x="330" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 331px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">7</div></div></div></foreignObject><text x="340" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">7</text></switch></g><rect x="120" y="240" width="470" height="30" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 255px; margin-left: 121px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Temporal GOP Index</div></div></div></foreignObject><text x="355" y="260" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="16px" text-anchor="middle">Temporal GOP Index</text></switch></g><path d="M 150 75 Q 130.03 75.03 130.03 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 130.03 178.88 L 126.53 171.88 L 130.03 173.63 L 133.53 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="150" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 180 115.03 Q 130.03 115.03 130 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 130 178.88 L 126.5 171.88 L 130 173.63 L 133.5 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="180" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 210 75.03 Q 190.03 75.03 190.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 190 98.88 L 186.51 91.88 L 190.01 93.63 L 193.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="210" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 240 155.03 Q 130.03 155.03 130.01 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 130 178.88 L 126.51 171.88 L 130.01 173.63 L 133.51 171.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="240" y="140" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 270 75.03 Q 250.03 75.03 250 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 250 138.88 L 246.5 131.88 L 250 133.63 L 253.5 131.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="270" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 300 115.03 Q 250.03 115.03 250.01 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 250 138.88 L 246.51 131.88 L 250.01 133.63 L 253.51 131.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="300" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 330 75.03 Q 310.03 75.03 310.01 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 310 98.88 L 306.51 91.88 L 310.01 93.63 L 313.51 91.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="330" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 360 195 L 146.37 195" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 141.12 195 L 148.12 191.5 L 146.37 195 L 148.12 198.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="360" y="180" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 390 75 Q 370.03 75.03 370.03 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370.03 178.88 L 366.53 171.88 L 370.03 173.63 L 373.53 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="390" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 420 115.03 Q 370.03 115.03 370 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370 178.88 L 366.5 171.88 L 370 173.63 L 373.5 171.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="420" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 450 75.03 Q 429.97 75.03 429.99 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 430 98.88 L 426.49 91.89 L 429.99 93.63 L 433.49 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="450" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 480 155.03 Q 370.03 155.03 370.01 173.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 370 178.88 L 366.51 171.88 L 370.01 173.63 L 373.51 171.89 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="480" y="140" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 510 75.03 Q 489.97 75.03 490 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 490 138.88 L 486.5 131.88 L 490 133.63 L 493.5 131.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="510" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 540 115.03 Q 489.97 115.03 489.99 133.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 490 138.88 L 486.49 131.89 L 489.99 133.63 L 493.49 131.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="540" y="100" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 570 75.03 Q 549.97 75.03 549.99 93.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 550 98.88 L 546.49 91.89 L 549.99 93.63 L 553.49 91.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="570" y="60" width="20" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"></rect><path d="M 590 195 L 386.33 194.7" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M 381.08 194.69 L 388.09 191.2 L 386.33 194.7 L 388.08 198.2 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"></path><rect x="360" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 361px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">0</div></div></div></foreignObject><text x="370" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">0</text></switch></g><rect x="390" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 391px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="400" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><rect x="420" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 421px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="430" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><rect x="450" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 451px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="460" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><rect x="480" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 481px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="490" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">4</text></switch></g><rect x="510" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 511px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">5</div></div></div></foreignObject><text x="520" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">5</text></switch></g><rect x="540" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 541px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">6</div></div></div></foreignObject><text x="550" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">6</text></switch></g><rect x="570" y="220" width="20" height="20" fill="none" stroke="none" pointer-events="all"></rect><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 230px; margin-left: 571px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">7</div></div></div></foreignObject><text x="580" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">7</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>
</div>
<div class="title">Figure 35. H.265 dyadic temporal sub-layer pattern</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Multi-layer rate control and multi-layer coding are typically used for
streaming cases where low latency is expected, hence B pictures with forward
prediction are usually not used.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265RateControlInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265RateControlInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265RateControlInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                         <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                             <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265RateControlFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">gopFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">idrPeriod</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">consecutiveBFrameCount</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                                <span class="n">subLayerCount</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265RateControlInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="chap36.html#VkVideoEncodeH265RateControlFlagBitsKHR">VkVideoEncodeH265RateControlFlagBitsKHR</a> specifying H.265 rate
control flags.</p>
</li>
<li>
<p><code>gopFrameCount</code> is the number of frames within a <a href="chap36.html#encode-h265-gop">group of pictures (GOP)</a> intended to be used by the application.
If it is set to 0, the rate control algorithm <strong class="purple">may</strong> assume an
implementation-dependent GOP length.
If it is set to <code>UINT32_MAX</code>, the GOP length is treated as infinite.</p>
</li>
<li>
<p><code>idrPeriod</code> is the interval, in terms of number of frames, between
two <a href="chap36.html#encode-h265-idr-pic">IDR frames</a> (see <a href="chap36.html#encode-h265-idr-period">IDR
period</a>).
If it is set to 0, the rate control algorithm <strong class="purple">may</strong> assume an
implementation-dependent IDR period.
If it is set to <code>UINT32_MAX</code>, the IDR period is treated as infinite.</p>
</li>
<li>
<p><code>consecutiveBFrameCount</code> is the number of consecutive B frames
between I and/or P frames within the <a href="chap36.html#encode-h265-gop">GOP</a>.</p>
</li>
<li>
<p><code>temporalLayerCount</code> specifies the number of H.265 sub-layers that
the application intends to use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an instance of this structure is included in the <code>pNext</code> chain of
the <a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a> structure passed to the
<a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command, and
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, the parameters in
this structure are used as guidance for the implementation’s rate control
algorithm (see <a href="chap36.html#video-coding-control">Video Coding Control</a>).</p>
</div>
<div class="paragraph">
<p>If <code>flags</code> includes
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</code>, then
the rate control state is reset to an initial state to meet HRD compliance
requirements.
Otherwise the new rate control state <strong class="purple">may</strong> be applied without a reset
depending on the implementation and the specified rate control parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It would be possible to infer the picture type to be used when encoding a
frame, on the basis of the values provided for <code>consecutiveBFrameCount</code>,
<code>idrPeriod</code>, and <code>gopFrameCount</code>, but this inferred picture type
will not be used by implementations to override the picture type provided to
the video encode operation.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08291" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08291"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08291</span><br>

If <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_HRD_COMPLIANCE_BIT_KHR</code>, then
<code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08292" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08292"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08292</span><br>

If <code>flags</code> contains
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</code>
or
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</code>,
then it <strong class="purple">must</strong> also contain
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REGULAR_GOP_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08293" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08293"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08293</span><br>

If <code>flags</code> contains
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</code>,
then it <strong class="purple">must</strong> not also contain
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08294" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08294"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-flags-08294</span><br>

If <code>flags</code> contains
<code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REGULAR_GOP_BIT_KHR</code>, then
<code>gopFrameCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-idrPeriod-08295" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-idrPeriod-08295"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-idrPeriod-08295</span><br>

If <code>idrPeriod</code> is not <code>0</code>, then it <strong class="purple">must</strong> be greater than or equal to
<code>gopFrameCount</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-consecutiveBFrameCount-08296" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-consecutiveBFrameCount-08296"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-consecutiveBFrameCount-08296</span><br>

If <code>consecutiveBFrameCount</code> is not <code>0</code>, then it <strong class="purple">must</strong> be less than
<code>gopFrameCount</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_RATE_CONTROL_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlInfoKHR-flags-parameter" href="chap36.html#VUID-VkVideoEncodeH265RateControlInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap36.html#VkVideoEncodeH265RateControlFlagBitsKHR">VkVideoEncodeH265RateControlFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in
<a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a>::<code>flags</code>, specifying H.265
rate control flags, are:</p>
</div>
<div id="VkVideoEncodeH265RateControlFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkVideoEncodeH265RateControlFlagBitsKHR</span> <span class="p">{</span>
    <span class="n">VK_VIDEO_ENCODE_H265_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_RATE_CONTROL_REGULAR_GOP_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_VIDEO_ENCODE_H265_RATE_CONTROL_TEMPORAL_SUB_LAYER_PATTERN_DYADIC_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265RateControlFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_ATTEMPT_HRD_COMPLIANCE_BIT_KHR</code>
specifies that rate control <strong class="purple">should</strong> attempt to produce an HRD compliant
bitstream, as defined in annex C of the <a href="chap2.html#itu-t-h265">ITU-T H.265
Specification</a>.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REGULAR_GOP_BIT_KHR</code> specifies
that the application intends to use a <a href="chap36.html#encode-h265-regular-gop">regular
GOP structure</a> according to the parameters specified in the
<code>gopFrameCount</code>, <code>idrPeriod</code>, and <code>consecutiveBFrameCount</code>
members of the <a href="chap36.html#VkVideoEncodeH265RateControlInfoKHR">VkVideoEncodeH265RateControlInfoKHR</a> structure.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_FLAT_BIT_KHR</code>
specifies that the application intends to follow a
<a href="chap36.html#encode-h265-ref-pattern-flat">flat reference pattern</a> in the GOP.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_REFERENCE_PATTERN_DYADIC_BIT_KHR</code>
specifies that the application intends to follow a
<a href="chap36.html#encode-h265-ref-pattern-dyadic">dyadic reference pattern</a> in the GOP.</p>
</li>
<li>
<p><code>VK_VIDEO_ENCODE_H265_RATE_CONTROL_TEMPORAL_SUB_LAYER_PATTERN_DYADIC_BIT_KHR</code>
specifies that the application intends to follow a
<a href="chap36.html#encode-h265-layer-pattern-dyadic">dyadic temporal sub-layer pattern</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkVideoEncodeH265RateControlFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkVideoEncodeH265RateControlFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkVideoEncodeH265RateControlFlagsKHR</code> is a bitmask type for setting a
mask of zero or more <a href="chap36.html#VkVideoEncodeH265RateControlFlagBitsKHR">VkVideoEncodeH265RateControlFlagBitsKHR</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="encode-h265-rate-control-layer"><a class="anchor" href="chap36.html#encode-h265-rate-control-layer"></a>Rate Control Layers</h5>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265RateControlLayerInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265RateControlLayerInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265RateControlLayerInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">useMinQp</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265QpKHR</span>           <span class="n">minQp</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">useMaxQp</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265QpKHR</span>           <span class="n">maxQp</span><span class="p">;</span>
    <span class="n">VkBool32</span>                         <span class="n">useMaxFrameSize</span><span class="p">;</span>
    <span class="n">VkVideoEncodeH265FrameSizeKHR</span>    <span class="n">maxFrameSize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265RateControlLayerInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useMinQp</code> indicates whether the QP values determined by rate
control will be clamped to the lower bounds on the QP values specified
in <code>minQp</code>.</p>
</li>
<li>
<p><code>minQp</code> specifies the lower bounds on the QP values, for each
picture type, that the implementation’s rate control algorithm will use
when <code>useMinQp</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>useMaxQp</code> indicates whether the QP values determined by rate
control will be clamped to the upper bounds on the QP values specified
in <code>maxQp</code>.</p>
</li>
<li>
<p><code>maxQp</code> specifies the upper bounds on the QP values, for each
picture type, that the implementation’s rate control algorithm will use
when <code>useMaxQp</code> is set to <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>useMaxFrameSize</code> indicates whether the implementation’s rate
control algorithm <strong class="purple">should</strong> use the values specified in <code>maxFrameSize</code>
as the upper bounds on the encoded frame size for each picture type.</p>
</li>
<li>
<p><code>maxFrameSize</code> specifies the upper bounds on the encoded frame size,
for each picture type, when <code>useMaxFrameSize</code> is set to
<code>VK_TRUE</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When used, the values in <code>minQp</code> and <code>maxQp</code> guarantee that the
effective QP values used by the implementation will respect those lower and
upper bounds, respectively.
However, limiting the range of QP values that the implementation is able to
use will also limit the capabilities of the implementation’s rate control
algorithm to comply to other constraints.
In particular, the implementation <strong class="purple">may</strong> not be able to comply to the
following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The average and/or peak <a href="chap36.html#encode-bitrate">bitrate</a> values to be used for
the encoded bitstream specified in the <code>averageBitrate</code> and
<code>maxBitrate</code> members of the
<a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structure.</p>
</li>
<li>
<p>The upper bounds on the encoded frame size, for each picture type,
specified in the <code>maxFrameSize</code> member of
<code>VkVideoEncodeH265RateControlLayerInfoKHR</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In general, applications need to configure rate control parameters
appropriately in order to be able to get the desired rate control behavior,
as described in the <a href="chap36.html#encode-rate-control">Video Encode Rate Control</a>
section.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When an instance of this structure is included in the <code>pNext</code> chain of a
<a href="chap36.html#VkVideoEncodeRateControlLayerInfoKHR">VkVideoEncodeRateControlLayerInfoKHR</a> structure specified in one of the
elements of the <code>pLayers</code> array member of the
<a href="chap36.html#VkVideoEncodeRateControlInfoKHR">VkVideoEncodeRateControlInfoKHR</a> structure passed to the
<a href="chap36.html#vkCmdControlVideoCodingKHR">vkCmdControlVideoCodingKHR</a> command,
<a href="chap36.html#VkVideoCodingControlInfoKHR">VkVideoCodingControlInfoKHR</a>::<code>flags</code> includes
<code>VK_VIDEO_CODING_CONTROL_ENCODE_RATE_CONTROL_BIT_KHR</code>, and the bound
video session was created with the video codec operation
<code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, it specifies the
H.265-specific rate control parameters of the rate control layer
corresponding to that element of <code>pLayers</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08297" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08297"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08297</span><br>

If <code>useMinQp</code> is <code>VK_TRUE</code>, then the <code>qpI</code>, <code>qpP</code>, and
<code>qpB</code> members of <code>minQp</code> <strong class="purple">must</strong> all be between
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>minQp</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxQp</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMaxQp-08298" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMaxQp-08298"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMaxQp-08298</span><br>

If <code>useMaxQp</code> is <code>VK_TRUE</code>, then the <code>qpI</code>, <code>qpP</code>, and
<code>qpB</code> members of <code>maxQp</code> <strong class="purple">must</strong> all be between
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>minQp</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>maxQp</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video profile</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08299" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08299"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08299</span><br>

If <code>useMinQp</code> is <code>VK_TRUE</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</code>,
then the <code>qpI</code>, <code>qpP</code>, and <code>qpB</code> members of <code>minQp</code>
<strong class="purple">must</strong> all specify the same value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMaxQp-08300" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMaxQp-08300"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMaxQp-08300</span><br>

If <code>useMaxQp</code> is <code>VK_TRUE</code> and
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>flags</code>, as returned by
<a href="chap36.html#vkGetPhysicalDeviceVideoCapabilitiesKHR">vkGetPhysicalDeviceVideoCapabilitiesKHR</a> for the used video
profile, does not include
<code>VK_VIDEO_ENCODE_H265_CAPABILITY_PER_PICTURE_TYPE_MIN_MAX_QP_BIT_KHR</code>,
then the <code>qpI</code>, <code>qpP</code>, and <code>qpB</code> members of <code>maxQp</code>
<strong class="purple">must</strong> all specify the same value</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08375" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08375"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-useMinQp-08375</span><br>

If <code>useMinQp</code> and <code>useMaxQp</code> are both <code>VK_TRUE</code>, then the
<code>qpI</code>, <code>qpP</code>, and <code>qpB</code> members of <code>minQp</code> <strong class="purple">must</strong> all be
less than or equal to the respective members of <code>maxQp</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_RATE_CONTROL_LAYER_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-minQp-parameter" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-minQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-minQp-parameter</span><br>
 <code>minQp</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeH265QpKHR">VkVideoEncodeH265QpKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-maxQp-parameter" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-maxQp-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-maxQp-parameter</span><br>
 <code>maxQp</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeH265QpKHR">VkVideoEncodeH265QpKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkVideoEncodeH265RateControlLayerInfoKHR-maxFrameSize-parameter" href="chap36.html#VUID-VkVideoEncodeH265RateControlLayerInfoKHR-maxFrameSize-parameter"></a> <span class="vuid">VUID-VkVideoEncodeH265RateControlLayerInfoKHR-maxFrameSize-parameter</span><br>
 <code>maxFrameSize</code> <strong class="purple">must</strong> be a valid <a href="chap36.html#VkVideoEncodeH265FrameSizeKHR">VkVideoEncodeH265FrameSizeKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265QpKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265QpKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265QpKHR</span> <span class="p">{</span>
    <span class="kt">int32_t</span>    <span class="n">qpI</span><span class="p">;</span>
    <span class="kt">int32_t</span>    <span class="n">qpP</span><span class="p">;</span>
    <span class="kt">int32_t</span>    <span class="n">qpB</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265QpKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>qpI</code> is the QP to be used for <a href="chap36.html#encode-h265-i-pic">I pictures</a>.</p>
</li>
<li>
<p><code>qpP</code> is the QP to be used for <a href="chap36.html#encode-h265-p-pic">P pictures</a>.</p>
</li>
<li>
<p><code>qpB</code> is the QP to be used for <a href="chap36.html#encode-h265-b-pic">B pictures</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265FrameSizeKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265FrameSizeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265FrameSizeKHR</span> <span class="p">{</span>
    <span class="kt">uint32_t</span>    <span class="n">frameISize</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">framePSize</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">frameBSize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265FrameSizeKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>frameISize</code> is the size in bytes to be used for
<a href="chap36.html#encode-h265-i-pic">I frames</a>.</p>
</li>
<li>
<p><code>framePSize</code> is the size in bytes to be used for
<a href="chap36.html#encode-h265-p-pic">P frames</a>.</p>
</li>
<li>
<p><code>frameBSize</code> is the size in bytes to be used for
<a href="chap36.html#encode-h265-b-pic">B frames</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="encode-h265-gop-remaining-frames"><a class="anchor" href="chap36.html#encode-h265-gop-remaining-frames"></a>GOP Remaining Frames</h5>
<div class="paragraph">
<p>Besides session level rate control configuration, the application <strong class="purple">can</strong>
specify the number of frames per frame type remaining in the
<a href="chap36.html#encode-h265-gop">group of pictures (GOP)</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkVideoEncodeH265GopRemainingFrameInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkVideoEncodeH265GopRemainingFrameInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_encode_h265</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkVideoEncodeH265GopRemainingFrameInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkBool32</span>           <span class="n">useGopRemainingFrames</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">gopRemainingI</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">gopRemainingP</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">gopRemainingB</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkVideoEncodeH265GopRemainingFrameInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is a <a href="chap3.html#VkStructureType">VkStructureType</a> value identifying this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>useGopRemainingFrames</code> indicates whether the implementation’s rate
control algorithm <strong class="purple">should</strong> use the values specified in
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code>.
If <code>useGopRemainingFrames</code> is <code>VK_FALSE</code>, then the values of
<code>gopRemainingI</code>, <code>gopRemainingP</code>, and <code>gopRemainingB</code> are
ignored.</p>
</li>
<li>
<p><code>gopRemainingI</code> specifies the number of <a href="chap36.html#encode-h265-i-pic">I
frames</a> the implementation’s rate control algorithm <strong class="purple">should</strong> assume to
be remaining in the <a href="chap36.html#encode-h265-gop">GOP</a> prior to executing the video
encode operation.</p>
</li>
<li>
<p><code>gopRemainingP</code> specifies the number of <a href="chap36.html#encode-h265-p-pic">P
frames</a> the implementation’s rate control algorithm <strong class="purple">should</strong> assume to
be remaining in the <a href="chap36.html#encode-h265-gop">GOP</a> prior to executing the video
encode operation.</p>
</li>
<li>
<p><code>gopRemainingB</code> specifies the number of <a href="chap36.html#encode-h265-b-pic">B
frames</a> the implementation’s rate control algorithm <strong class="purple">should</strong> assume to
be remaining in the <a href="chap36.html#encode-h265-gop">GOP</a> prior to executing the video
encode operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Setting <code>useGopRemainingFrames</code> to <code>VK_TRUE</code> and including this
structure in the <code>pNext</code> chain of <a href="chap36.html#VkVideoBeginCodingInfoKHR">VkVideoBeginCodingInfoKHR</a> is
only mandatory if the
<a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>requiresGopRemainingFrames</code>
reported for the used <a href="chap36.html#video-profiles">video profile</a> is <code>VK_TRUE</code>.
However, implementations <strong class="purple">may</strong> use these remaining frame counts, when
specified, even when it is not required.
In particular, when the application does not use a
<a href="chap36.html#encode-h265-regular-gop">regular GOP structure</a>, these values <strong class="purple">may</strong> provide
additional guidance for the implementation’s rate control algorithm.</p>
</div>
<div class="paragraph">
<p>The <a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a>::<code>prefersGopRemainingFrames</code>
capability is also used to indicate that the implementation’s rate control
algorithm <strong class="purple">may</strong> operate more accurately if the application specifies the
remaining frame counts using this structure.</p>
</div>
<div class="paragraph">
<p>As with other rate control guidance values, if the effective order and
number of frames encoded by the application are not in line with the
remaining frame counts specified in this structure at any given point, then
the behavior of the implementation’s rate control algorithm <strong class="purple">may</strong> deviate
from the one expected by the application.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkVideoEncodeH265GopRemainingFrameInfoKHR-sType-sType" href="chap36.html#VUID-VkVideoEncodeH265GopRemainingFrameInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkVideoEncodeH265GopRemainingFrameInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_VIDEO_ENCODE_H265_GOP_REMAINING_FRAME_INFO_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="encode-h265-requirements"><a class="anchor" href="chap36.html#encode-h265-requirements"></a>36.18.12. H.265 Encode Requirements</h4>
<div class="paragraph">
<p>This section described the <strong class="purple">required</strong> H.265 encoding capabilities for
physical devices that have at least one queue family that supports the video
codec operation <code>VK_VIDEO_CODEC_OPERATION_ENCODE_H265_BIT_KHR</code>, as
returned by <a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> in
<a href="chap5.html#VkQueueFamilyVideoPropertiesKHR">VkQueueFamilyVideoPropertiesKHR</a>::<code>videoCodecOperations</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. Required <a href="chap36.html#video-std-header-version">Video Std Header Versions</a></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Std Header Name</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vulkan_video_codec_h265std_encode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. Required Video Capabilities</caption>
<colgroup>
<col style="width: 58.3333%;">
<col style="width: 23.3333%;">
<col style="width: 18.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Video Capability</th>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Requirement Type<sup>1</sup></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoCapabilitiesKHR">VkVideoCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferOffsetAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minBitstreamBufferSizeAlignment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pictureAccessGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxCodedExtent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxDpbSlots</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxActiveReferencePictures</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoEncodeCapabilitiesKHR">VkVideoEncodeCapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rateControlModes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxBitrate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxQualityLevels</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>encodeInputPictureGranularity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(64,64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>supportedEncodeFeedbackFlags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BUFFER_OFFSET_BIT_KHR</code><br>
                                       <code>VK_VIDEO_ENCODE_FEEDBACK_BITSTREAM_BYTES_WRITTEN_BIT_KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="chap36.html#VkVideoEncodeH265CapabilitiesKHR">VkVideoEncodeH265CapabilitiesKHR</a></strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxLevelIdc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STD_VIDEO_H265_LEVEL_IDC_1_0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxSliceSegmentCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxTiles</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1,1)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ctbSizes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">at least one bit set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>transformBlockSizes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">at least one bit set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxPPictureL0ReferenceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxBPictureL0ReferenceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxL1ReferenceCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxSubLayerCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expectDyadicTemporalSubLayerPattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minQp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxQp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>prefersGopRemainingFrames</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requiresGopRemainingFrames</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementation-dependent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stdSyntaxFlags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p>The <strong>Requirement Type</strong> column specifies the requirement is either the
minimum value all implementations <strong class="purple">must</strong> support, the maximum value all
implementations <strong class="purple">must</strong> support, or the exact value all implementations
<strong class="purple">must</strong> support.
For bitmasks a minimum value is the least bits all implementations <strong class="purple">must</strong>
set, but they <strong class="purple">may</strong> have additional bits set beyond this minimum.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div></div>

<nav>
  <a rel="prev" href="chap35.html" class="nav nav-prev" title="Previous page" aria-label="Previous page" aria-keyshortcuts="Left">
        <i class="fa fa-angle-left"></i>
     </a>
  <a rel="next" href="chap37.html" class="nav nav-next" title="Next page" aria-label="Next page" aria-keyshortcuts="Right">
        <i class="fa fa-angle-right"></i>
     </a>
  <div style="clear: both"></div>
</nav>
<div id="footer">
<div id="footer-text">
Version 1.2.281<br>
Last updated 2024-03-21 22:58:01 -0700
</div>
</div>



</body>
  <script>
  function isInViewport(ele) {
    const rect = ele.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
    );
  }
  function yPosition (ele) {
    const rect = ele.getBoundingClientRect();
    return (rect.top - 20); // 20px above
  }
  let curr = document.getElementsByClassName('current');
  if (!isInViewport(curr[curr.length - 1])) {
    document.getElementById('toc').scrollTo({
      top: yPosition(curr[0]),
      left: 0,
      behavior: 'smooth'
    });
  }

  /* For page navigation */
  function gotoPage(selector) {
    const button = document.querySelector(selector);
    if (button)
      window.location.href = button.href;
  }
  document.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowRight':
        e.preventDefault();
        gotoPage('.nav-next');
        break;
      case 'ArrowLeft':
        e.preventDefault();
        gotoPage('.nav-prev');
        break;
    }
  });
  </script>
  </html>