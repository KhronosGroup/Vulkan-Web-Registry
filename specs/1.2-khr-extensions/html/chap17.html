<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="author" content="The Khronos® Vulkan  Working Group">
<title>Vulkan® 1.2.241 - A Specification (with KHR extensions)</title>
<link rel="stylesheet" href="style0.css" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="style1.css" type="text/css">
<link rel="stylesheet" href="style2.css" type="text/css">

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin="" even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<!--ChunkedSearchJSMarker-->
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<link rel="stylesheet" href="style3.css" type="text/css">
<script>
    function hideElement(e){
        e.setAttribute("hidden", "");
        e.classList.add("hidden");
    }

    function unhideElement(e){
        e.classList.remove("hidden");
        e.removeAttribute("hidden");
    }

    function hideLoadableContent(){
        unhideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) hideElement(loadable);
    }

    function unhideLoadableContent(){
        hideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) unhideElement(loadable);
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
<link rel="stylesheet" href="asciidoctor-chunker.css" type="text/css"></head>
<body class="book toc2 toc-left">
<div style="text-align: center;">
    <span class="image"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgdmlld0JveD0iMCAwIDExNTAgMzI2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MS40MTQyMTsiPgogICAgPGcgaWQ9IkFydGJvYXJkMSIgdHJhbnNmb3JtPSJtYXRyaXgoMC45NTUxNSwwLDAsMC44ODgyODMsLTQwLjExNjMsLTMwLjIwMTYpIj4KICAgICAgICA8cmVjdCB4PSI0MiIgeT0iMzQiIHdpZHRoPSIxMjA0IiBoZWlnaHQ9IjM2NyIgc3R5bGU9ImZpbGw6bm9uZTsiLz4KICAgICAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLjA0Njk2LDAsMCwxLjEyNTc3LC00Ni45OTEzLC01MC40MzI1KSI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik03MjQuMSwzODUuMDZMNjgzLjUzLDM4NS4wNkM2ODMuNTMsMzg1LjA2IDY4My41MywyODYuMDkgNjgzLjUzLDI1NS40QzY5Ni40OSwyNjIuNjIgNzEzLjYyLDI3NS45NCA3MjQuMSwyODguNzJMNzI0LjEsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxnPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTM4MS43NSwzODUuMDZMMzMxLjE3LDM4NS4wNkwyNjUuMTYsMTgxLjAzTDMxMS4xNywxODEuMDNMMzU2LjYxLDMyNC40OEwzNTcuMTgsMzI0LjQ4TDQwMy4xOCwxODEuMDNMNDQ5LjQ3LDE4MS4wM0wzODEuNzUsMzg1LjA2WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNTg1LjUxLDM4NS4wNkw1NDYuOTMsMzg1LjA2TDU0Ni45MywzNjQuNDlMNTQ2LjA4LDM2NC40OUM1NDAuOTMsMzczLjA3IDUzNC4yNywzNzkuMjYgNTI2LjA3LDM4My4wN0M1MTcuODgsMzg2Ljg4IDUwOS41LDM4OC43OCA1MDAuOTIsMzg4Ljc4QzQ5MC4wNiwzODguNzggNDgxLjE2LDM4Ny4zNSA0NzQuMiwzODQuNUM0NjcuMjUsMzgxLjY1IDQ2MS43NywzNzcuNTkgNDU3Ljc3LDM3Mi4zNkM0NTMuNzYsMzY3LjEyIDQ1MC45NSwzNjAuNzQgNDQ5LjMzLDM1My4yMUM0NDcuNzIsMzQ1LjY5IDQ0Ni45MSwzMzcuMzUgNDQ2LjkxLDMyOC4yMUw0NDYuOTEsMjM3LjMzTDQ4Ny40OSwyMzcuMzNMNDg3LjQ5LDMyMC43N0M0ODcuNDksMzMyLjk2IDQ4OS40LDM0Mi4wNiA0OTMuMjEsMzQ4LjA2QzQ5Ny4wMiwzNTQuMDcgNTAzLjc4LDM1Ny4wNiA1MTMuNSwzNTcuMDZDNTI0LjU1LDM1Ny4wNiA1MzIuNTUsMzUzLjc4IDUzNy41LDM0Ny4yQzU0Mi40NiwzNDAuNjIgNTQ0LjkzLDMyOS44MSA1NDQuOTMsMzE0Ljc2TDU0NC45MywyMzcuMzJMNTg1LjUyLDIzNy4zMkw1ODUuNTIsMzg1LjA2TDU4NS41MSwzODUuMDZaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8cGF0aCBkPSJNNzMwLjg0LDI5Ni4xOUw3MzAuNzQsMjkwLjQ3TDc4MS44OSwyMzcuMzNMODI5LjkxLDIzNy4zM0w3NzQuMTgsMjkxLjYyTDgzNi4xOSwzODUuMDZMNzg3LjA0LDM4NS4wNkw3MzAuODQsMjk2LjE5WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik04NDMuNjIsMjgyLjc2Qzg0NC4xOSwyNzMuMjQgODQ2LjU4LDI2NS4zMyA4NTAuNzcsMjU5LjA0Qzg1NC45NiwyNTIuNzUgODYwLjI5LDI0Ny43MSA4NjYuNzcsMjQzLjlDODczLjI1LDI0MC4wOSA4ODAuNTQsMjM3LjM3IDg4OC42NCwyMzUuNzZDODk2LjczLDIzNC4xNCA5MDQuODgsMjMzLjMzIDkxMy4wNywyMzMuMzNDOTIwLjUsMjMzLjMzIDkyOC4wMiwyMzMuODUgOTM1LjY0LDIzNC45Qzk0My4yNywyMzUuOTUgOTUwLjIxLDIzOCA5NTYuNSwyNDEuMDVDOTYyLjc4LDI0NC4xIDk2Ny45MywyNDguMzQgOTcxLjk0LDI1My43NkM5NzUuOTQsMjU5LjE5IDk3Ny45NCwyNjYuMzggOTc3Ljk0LDI3NS4zNEw5NzcuOTQsMzUyLjIxQzk3Ny45NCwzNTguODggOTc4LjMyLDM2NS4yNyA5NzkuMDgsMzcxLjM2Qzk3OS44NCwzNzcuNDYgOTgxLjE4LDM4Mi4wMyA5ODMuMDksMzg1LjA4TDk0MS45NCwzODUuMDhDOTQxLjE4LDM4Mi44IDk0MC41NiwzODAuNDYgOTQwLjA4LDM3OC4wOEM5MzkuNjEsMzc1LjcgOTM5LjI3LDM3My4yOCA5MzkuMDgsMzcwLjc5QzkzMi42LDM3Ny40NyA5MjQuOTcsMzgyLjEzIDkxNi4yMSwzODQuOEM5MDcuNDUsMzg3LjQ2IDg5OC40OSwzODguOCA4ODkuMzUsMzg4LjhDODgyLjMsMzg4LjggODc1LjcyLDM4Ny45NCA4NjkuNjQsMzg2LjIzQzg2My41NCwzODQuNTIgODU4LjIsMzgxLjg1IDg1My42NCwzNzguMjNDODQ5LjA2LDM3NC42MSA4NDUuNDgsMzcwLjA0IDg0Mi45MiwzNjQuNTFDODQwLjM1LDM1OC45OSA4MzkuMDYsMzUyLjQyIDgzOS4wNiwzNDQuOEM4MzkuMDYsMzM2LjQyIDg0MC41NCwzMjkuNTEgODQzLjQ5LDMyNC4wOEM4NDYuNDUsMzE4LjY1IDg1MC4yNSwzMTQuMzIgODU0LjkzLDMxMS4wOEM4NTkuNiwzMDcuODQgODY0LjkzLDMwNS40MSA4NzAuOTMsMzAzLjc5Qzg3Ni45MywzMDIuMTcgODgyLjk4LDMwMC44OCA4ODkuMDcsMjk5LjkzQzg5NS4xNywyOTguOTkgOTAxLjE3LDI5OC4yMiA5MDcuMDgsMjk3LjY1QzkxMi45OSwyOTcuMDggOTE4LjIyLDI5Ni4yMiA5MjIuNzksMjk1LjA4QzkyNy4zNywyOTMuOTMgOTMwLjk4LDI5Mi4yNyA5MzMuNjUsMjkwLjA3QzkzNi4zMiwyODcuODggOTM3LjU2LDI4NC42OSA5MzcuMzcsMjgwLjVDOTM3LjM3LDI3Ni4xMiA5MzYuNjUsMjcyLjY0IDkzNS4yMiwyNzAuMDdDOTMzLjc5LDI2Ny41IDkzMS44OSwyNjUuNSA5MjkuNTEsMjY0LjA3QzkyNy4xMywyNjIuNjQgOTI0LjM3LDI2MS42OSA5MjEuMjIsMjYxLjIxQzkxOC4wNywyNjAuNzMgOTE0LjcsMjYwLjQ5IDkxMS4wOCwyNjAuNDlDOTAzLjA4LDI2MC40OSA4OTYuNzksMjYyLjIgODkyLjIyLDI2NS42NEM4ODcuNjUsMjY5LjA3IDg4NC45OCwyNzQuNzggODg0LjIyLDI4Mi43OUw4NDMuNjIsMjgyLjc5TDg0My42MiwyODIuNzZaTTkzNy4zNSwzMTIuNzdDOTM1LjYzLDMxNC4zIDkzMy40OSwzMTUuNDggOTMwLjkyLDMxNi4zNEM5MjguMzUsMzE3LjIxIDkyNS41OSwzMTcuOTIgOTIyLjYzLDMxOC40OUM5MTkuNjgsMzE5LjA2IDkxNi41OCwzMTkuNTQgOTEzLjM1LDMxOS45MkM5MTAuMTEsMzIwLjMgOTA2Ljg3LDMyMC43NyA5MDMuNjMsMzIxLjM1QzkwMC41OCwzMjEuOTIgODk3LjU4LDMyMi42OSA4OTQuNjMsMzIzLjYzQzg5MS42OCwzMjQuNTkgODg5LjEsMzI1Ljg3IDg4Ni45MSwzMjcuNDlDODg0LjcyLDMyOS4xMSA4ODIuOTYsMzMxLjE2IDg4MS42MiwzMzMuNjNDODgwLjI5LDMzNi4xMSA4NzkuNjIsMzM5LjI1IDg3OS42MiwzNDMuMDZDODc5LjYyLDM0Ni42OCA4ODAuMjksMzQ5LjczIDg4MS42MiwzNTIuMkM4ODIuOTYsMzU0LjY4IDg4NC43NywzNTYuNjMgODg3LjA1LDM1OC4wNkM4ODkuMzQsMzU5LjQ5IDg5MiwzNjAuNDkgODk1LjA1LDM2MS4wNkM4OTguMSwzNjEuNjMgOTAxLjI0LDM2MS45MSA5MDQuNDgsMzYxLjkxQzkxMi40OCwzNjEuOTEgOTE4LjY4LDM2MC41OCA5MjMuMDYsMzU3LjkyQzkyNy40NCwzNTUuMjUgOTMwLjY5LDM1Mi4wNiA5MzIuNzcsMzQ4LjM0QzkzNC44NiwzNDQuNjMgOTM2LjE2LDM0MC44NyA5MzYuNjIsMzM3LjA2QzkzNy4xLDMzMy4yNSA5MzcuMzMsMzMwLjIgOTM3LjM0LDMyNy45Mkw5MzcuMzQsMzEyLjc3TDkzNy4zNSwzMTIuNzdaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTEwMDQuMjEsMjM3LjMzTDEwNDIuOCwyMzcuMzNMMTA0Mi44LDI1Ny45TDEwNDMuNjUsMjU3LjlDMTA0OC43OSwyNDkuMzMgMTA1NS40NiwyNDMuMDkgMTA2My42NSwyMzkuMTlDMTA3MS44NCwyMzUuMjggMTA4MC4yMywyMzMuMzMgMTA4OC43OSwyMzMuMzNDMTA5OS42NiwyMzMuMzMgMTEwOC41NiwyMzQuODEgMTExNS41MiwyMzcuNzZDMTEyMi40NywyNDAuNzIgMTEyNy45NCwyNDQuODEgMTEzMS45NSwyNTAuMDVDMTEzNS45NSwyNTUuMjkgMTEzOC43NiwyNjEuNjcgMTE0MC4zOCwyNjkuMTlDMTE0MiwyNzYuNzIgMTE0Mi44MSwyODUuMDUgMTE0Mi44MSwyOTQuMkwxMTQyLjgxLDM4NS4wN0wxMTAyLjI0LDM4NS4wN0wxMTAyLjI0LDMwMS42M0MxMTAyLjI0LDI4OS40MyAxMTAwLjMzLDI4MC4zNCAxMDk2LjUzLDI3NC4zNEMxMDkyLjcxLDI2OC4zNCAxMDg1Ljk1LDI2NS4zNCAxMDc2LjIzLDI2NS4zNEMxMDY1LjE4LDI2NS4zNCAxMDU3LjE5LDI2OC42MyAxMDUyLjIzLDI3NS4yQzEwNDcuMjcsMjgxLjc2IDEwNDQuOCwyOTIuNTggMTA0NC44LDMwNy42M0wxMDQ0LjgsMzg1LjA3TDEwMDQuMjIsMzg1LjA3TDEwMDQuMjIsMjM3LjMzTDEwMDQuMjEsMjM3LjMzWiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik02MTIuMzcsMjExLjg0TDYxMi4zNywzODUuMDdMNjUyLjk1LDM4NS4wN0w2NTIuOTUsMjM0LjIxQzYzOS45MywyMjYuMjMgNjI2LjM2LDIxOC43NCA2MTIuMzcsMjExLjg0WiIgc3R5bGU9ImZpbGw6cmdiKDE3MiwyMiw0NCk7ZmlsbC1ydWxlOm5vbnplcm87Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOTguNDMsMjE5LjIxQzIyMS45NSwxNTAuMzIgMzYyLjU4LDEyNS4wNSA1MTIuNTgsMTYyLjc4QzYwMi41NSwxODUuNCA2NzYuMDcsMjI5LjI4IDcyNC4wOSwyNzIuNjdDNzAyLjMsMjE1LjEyIDU5Ni42NSwxMzMuMDggNDUxLjE4LDEwNC45NkMyODYuNyw3My4xNiAxMjQuNDcsMTAxLjExIDEwNC4zOSwxNzQuMUM4OS44OSwyMjYuODMgMTUzLjU3LDI4OC42IDI1Mi4wNSwzMzAuODRDMjA3LjgxLDI5NS4wMiAxODYuMjksMjU0Ljc4IDE5OC40MywyMTkuMjFaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTcyNC4xNiwyNDcuNjJMNzI0LjE2LDE4MS4wM0w2ODMuNTcsMTgxLjAzTDY4My41NywyMDEuMjVDNzAwLjg4LDIxNi43MSA3MTQuNjEsMjMyLjQ1IDcyNC4xNiwyNDcuNjJaIiBzdHlsZT0iZmlsbDpyZ2IoMTcyLDIyLDQ0KTtmaWxsLXJ1bGU6bm9uemVybzsiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS4wNDY5NiwwLDAsMS4xMjU3NywtNDYuOTkxMywtNTAuNDMyNSkiPgogICAgICAgICAgICA8cGF0aCBkPSJNMTIxNC45OCwzNjMuNDNDMTIxNC45OCwzNzUuNjkgMTIwNS4zNSwzODUuMzIgMTE5Mi44MywzODUuMzJDMTE4MC40MywzODUuMzIgMTE3MC41NCwzNzUuNjkgMTE3MC41NCwzNjMuNDNDMTE3MC41NCwzNTEuNDMgMTE4MC40MywzNDEuOCAxMTkyLjgzLDM0MS44QzEyMDUuMzUsMzQxLjggMTIxNC45OCwzNTEuNDMgMTIxNC45OCwzNjMuNDNaTTExNzYuMDgsMzYzLjQzQzExNzYuMDgsMzczLjA2IDExODMuMiwzODAuNyAxMTkyLjk2LDM4MC43QzEyMDIuNDUsMzgwLjcgMTIwOS40NCwzNzMuMDUgMTIwOS40NCwzNjMuNTZDMTIwOS40NCwzNTMuOTMgMTIwMi40NSwzNDYuMTUgMTE5Mi44MiwzNDYuMTVDMTE4My4yLDM0Ni4xNiAxMTc2LjA4LDM1My45NCAxMTc2LjA4LDM2My40M1pNMTE4OS4zOSwzNzQuNzdMMTE4NC4zOCwzNzQuNzdMMTE4NC4zOCwzNTMuMTRDMTE4Ni4zNiwzNTIuNzQgMTE4OS4xMywzNTIuNDggMTE5Mi42OSwzNTIuNDhDMTE5Ni43OCwzNTIuNDggMTE5OC42MiwzNTMuMTQgMTIwMC4yMSwzNTQuMDZDMTIwMS40LDM1NC45OCAxMjAyLjMyLDM1Ni43IDEyMDIuMzIsMzU4LjgxQzEyMDIuMzIsMzYxLjE4IDEyMDAuNDcsMzYzLjAzIDExOTcuODQsMzYzLjgyTDExOTcuODQsMzY0LjA4QzExOTkuOTUsMzY0Ljg3IDEyMDEuMTQsMzY2LjQ1IDEyMDEuOCwzNjkuMzVDMTIwMi40NiwzNzIuNjUgMTIwMi44NSwzNzMuOTcgMTIwMy4zOCwzNzQuNzZMMTE5Ny45NywzNzQuNzZDMTE5Ny4zMSwzNzMuOTcgMTE5Ni45MiwzNzEuOTkgMTE5Ni4yNiwzNjkuNDlDMTE5NS44NiwzNjcuMTIgMTE5NC41NSwzNjYuMDYgMTE5MS43OCwzNjYuMDZMMTE4OS40MSwzNjYuMDZMMTE4OS40MSwzNzQuNzdMMTE4OS4zOSwzNzQuNzdaTTExODkuNTMsMzYyLjUxTDExOTEuOSwzNjIuNTFDMTE5NC42NywzNjIuNTEgMTE5Ni45MSwzNjEuNTkgMTE5Ni45MSwzNTkuMzRDMTE5Ni45MSwzNTcuMzYgMTE5NS40NiwzNTYuMDQgMTE5Mi4yOSwzNTYuMDRDMTE5MC45NywzNTYuMDQgMTE5MC4wNSwzNTYuMTcgMTE4OS41MiwzNTYuM0wxMTg5LjUyLDM2Mi41MUwxMTg5LjUzLDM2Mi41MVoiIHN0eWxlPSJmaWxsOnJnYigxNzIsMjIsNDQpO2ZpbGwtcnVsZTpub256ZXJvOyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==" alt="Vulkan Logo" width="50%">
    </span>
</div>
<div id="header">
<h1>Vulkan<sup>®</sup> 1.2.241 - A Specification (with KHR extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan  Working Group</span><br>
<span id="revnumber">version 1.2.241,</span>
<span id="revdate">2023-02-16 10:14:37Z</span>
<br><span id="revremark">from git branch: github-main commit: 1b1c4dd43a35341c8c8e82ad985ed66d8beff5ba</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html">Titlepage</a></li><li><a href="chap1.html">1. Preamble</a></li>
<li><a href="chap2.html">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap2.html#introduction-conventions">2.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap3.html">3. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap3.html#fundamentals-host-environment">3.1. Host and Device Environment</a></li>
<li><a href="chap3.html#fundamentals-execmodel">3.2. Execution Model</a></li>
<li><a href="chap3.html#fundamentals-objectmodel-overview">3.3. Object Model</a></li>
<li><a href="chap3.html#fundamentals-abi">3.4. Application Binary Interface</a></li>
<li><a href="chap3.html#fundamentals-commandsyntax">3.5. Command Syntax and Duration</a></li>
<li><a href="chap3.html#fundamentals-threadingbehavior">3.6. Threading Behavior</a></li>
<li><a href="chap3.html#fundamentals-validusage">3.7. Valid Usage</a></li>
<li><a href="chap3.html#fundamentals-returncodes">3.8. <code>VkResult</code> Return Codes</a></li>
<li><a href="chap3.html#fundamentals-numerics">3.9. Numeric Representation and Computation</a></li>
<li><a href="chap3.html#fundamentals-fixedconv">3.10. Fixed-Point Data Conversions</a></li>
<li><a href="chap3.html#fundamentals-common-objects">3.11. Common Object Types</a></li>
<li><a href="chap3.html#fundamentals-api-name-aliases">3.12. API Name Aliases</a></li>
</ul>
</li>
<li><a href="chap4.html">4. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap4.html#initialization-functionpointers">4.1. Command Function Pointers</a></li>
<li><a href="chap4.html#initialization-instances">4.2. Instances</a></li>
</ul>
</li>
<li><a href="chap5.html">5. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap5.html#devsandqueues-physical-device-enumeration">5.1. Physical Devices</a></li>
<li><a href="chap5.html#devsandqueues-devices">5.2. Devices</a></li>
<li><a href="chap5.html#devsandqueues-queues">5.3. Queues</a></li>
</ul>
</li>
<li><a href="chap6.html">6. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap6.html#commandbuffers-lifecycle">6.1. Command Buffer Lifecycle</a></li>
<li><a href="chap6.html#commandbuffers-pools">6.2. Command Pools</a></li>
<li><a href="chap6.html#commandbuffer-allocation">6.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap6.html#commandbuffers-recording">6.4. Command Buffer Recording</a></li>
<li><a href="chap6.html#commandbuffers-submission">6.5. Command Buffer Submission</a></li>
<li><a href="chap6.html#commandbuffers-submission-progress">6.6. Queue Forward Progress</a></li>
<li><a href="chap6.html#commandbuffers-secondary">6.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap6.html#commandbuffers-devicemask">6.8. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap7.html">7. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap7.html#synchronization-dependencies">7.1. Execution and Memory Dependencies</a></li>
<li><a href="chap7.html#synchronization-implicit">7.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap7.html#synchronization-fences">7.3. Fences</a></li>
<li><a href="chap7.html#synchronization-semaphores">7.4. Semaphores</a></li>
<li><a href="chap7.html#synchronization-events">7.5. Events</a></li>
<li><a href="chap7.html#synchronization-pipeline-barriers">7.6. Pipeline Barriers</a></li>
<li><a href="chap7.html#synchronization-memory-barriers">7.7. Memory Barriers</a></li>
<li><a href="chap7.html#synchronization-wait-idle">7.8. Wait Idle Operations</a></li>
<li><a href="chap7.html#synchronization-submission-host-writes">7.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap7.html#synchronization-device-group">7.10. Synchronization and Multiple Physical Devices</a></li>
</ul>
</li>
<li><a href="chap8.html">8. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap8.html#renderpass-creation">8.1. Render Pass Creation</a></li>
<li><a href="chap8.html#renderpass-compatibility">8.2. Render Pass Compatibility</a></li>
<li><a href="chap8.html#_framebuffers">8.3. Framebuffers</a></li>
<li><a href="chap8.html#renderpass-commands">8.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="chap9.html">9. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap9.html#shader-modules">9.1. Shader Modules</a></li>
<li><a href="chap9.html#shaders-execution">9.2. Shader Execution</a></li>
<li><a href="chap9.html#shaders-execution-memory-ordering">9.3. Shader Memory Access Ordering</a></li>
<li><a href="chap9.html#shaders-inputs">9.4. Shader Inputs and Outputs</a></li>
<li><a href="chap9.html#shaders-vertex">9.5. Vertex Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-control">9.6. Tessellation Control Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-evaluation">9.7. Tessellation Evaluation Shaders</a></li>
<li><a href="chap9.html#shaders-geometry">9.8. Geometry Shaders</a></li>
<li><a href="chap9.html#shaders-fragment">9.9. Fragment Shaders</a></li>
<li><a href="chap9.html#shaders-compute">9.10. Compute Shaders</a></li>
<li><a href="chap9.html#shaders-ray-generation">9.11. Ray Generation Shaders</a></li>
<li><a href="chap9.html#shaders-intersection">9.12. Intersection Shaders</a></li>
<li><a href="chap9.html#shaders-any-hit">9.13. Any-Hit Shaders</a></li>
<li><a href="chap9.html#shaders-closest-hit">9.14. Closest Hit Shaders</a></li>
<li><a href="chap9.html#shaders-miss">9.15. Miss Shaders</a></li>
<li><a href="chap9.html#shaders-callable">9.16. Callable Shaders</a></li>
<li><a href="chap9.html#shaders-interpolation-decorations">9.17. Interpolation decorations</a></li>
<li><a href="chap9.html#shaders-staticuse">9.18. Static Use</a></li>
<li><a href="chap9.html#shaders-scope">9.19. Scope</a></li>
<li><a href="chap9.html#shaders-group-operations">9.20. Group Operations</a></li>
<li><a href="chap9.html#shaders-quad-operations">9.21. Quad Group Operations</a></li>
<li><a href="chap9.html#shaders-derivative-operations">9.22. Derivative Operations</a></li>
<li><a href="chap9.html#shaders-helper-invocations">9.23. Helper Invocations</a></li>
</ul>
</li>
<li><a href="chap10.html">10. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap10.html#pipelines-compute">10.1. Compute Pipelines</a></li>
<li><a href="chap10.html#pipelines-graphics">10.2. Graphics Pipelines</a></li>
<li><a href="chap10.html#pipelines-ray-tracing">10.3. Ray Tracing Pipelines</a></li>
<li><a href="chap10.html#pipelines-destruction">10.4. Pipeline Destruction</a></li>
<li><a href="chap10.html#pipelines-multiple">10.5. Multiple Pipeline Creation</a></li>
<li><a href="chap10.html#pipelines-pipeline-derivatives">10.6. Pipeline Derivatives</a></li>
<li><a href="chap10.html#pipelines-cache">10.7. Pipeline Cache</a></li>
<li><a href="chap10.html#pipelines-specialization-constants">10.8. Specialization Constants</a></li>
<li><a href="chap10.html#pipelines-library">10.9. Pipeline Libraries</a></li>
<li><a href="chap10.html#pipelines-binding">10.10. Pipeline Binding</a></li>
<li><a href="chap10.html#pipelines-dynamic-state">10.11. Dynamic State</a></li>
<li><a href="chap10.html#pipelines-shader-information">10.12. Pipeline Properties and Shader Information</a></li>
</ul>
</li>
<li><a href="chap11.html">11. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#memory-host">11.1. Host Memory</a></li>
<li><a href="chap11.html#memory-device">11.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap12.html">12. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap12.html#resources-buffers">12.1. Buffers</a></li>
<li><a href="chap12.html#resources-buffer-views">12.2. Buffer Views</a></li>
<li><a href="chap12.html#resources-images">12.3. Images</a></li>
<li><a href="chap12.html#resources-image-layouts">12.4. Image Layouts</a></li>
<li><a href="chap12.html#resources-image-views">12.5. Image Views</a></li>
<li><a href="chap12.html#resources-acceleration-structures">12.6. Acceleration Structures</a></li>
<li><a href="chap12.html#resources-association">12.7. Resource Memory Association</a></li>
<li><a href="chap12.html#resources-sharing">12.8. Resource Sharing Mode</a></li>
<li><a href="chap12.html#resources-memory-aliasing">12.9. Memory Aliasing</a></li>
</ul>
</li>
<li><a href="chap13.html">13. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap13.html#samplers-YCbCr-conversion">13.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> conversion</a></li>
</ul>
</li>
<li><a href="chap14.html">14. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap14.html#descriptorsets-types">14.1. Descriptor Types</a></li>
<li><a href="chap14.html#descriptorsets-sets">14.2. Descriptor Sets</a></li>
<li><a href="chap14.html#descriptorsets-physical-storage-buffer">14.3. Physical Storage Buffer Access</a></li>
</ul>
</li>
<li><a href="chap15.html">15. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap15.html#interfaces-iointerfaces">15.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap15.html#interfaces-vertexinput">15.2. Vertex Input Interface</a></li>
<li><a href="chap15.html#interfaces-fragmentoutput">15.3. Fragment Output Interface</a></li>
<li><a href="chap15.html#interfaces-inputattachment">15.4. Fragment Input Attachment Interface</a></li>
<li><a href="chap15.html#interfaces-raypipeline">15.5. Ray Tracing Pipeline Interface</a></li>
<li><a href="chap15.html#interfaces-resources">15.6. Shader Resource Interface</a></li>
<li><a href="chap15.html#interfaces-builtin-variables">15.7. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap16.html">16. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_image_operations_overview">16.1. Image Operations Overview</a></li>
<li><a href="chap16.html#_conversion_formulas">16.2. Conversion Formulas</a></li>
<li><a href="chap16.html#_texel_input_operations">16.3. Texel Input Operations</a></li>
<li><a href="chap16.html#_texel_output_operations">16.4. Texel Output Operations</a></li>
<li><a href="chap16.html#textures-normalized-operations">16.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#_unnormalized_texel_coordinate_operations">16.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-integer-coordinate-operations">16.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-sample-operations">16.8. Image Sample Operations</a></li>
<li><a href="chap16.html#textures-instructions">16.9. Image Operation Steps</a></li>
<li><a href="chap16.html#textures-queries">16.10. Image Query Instructions</a></li>
</ul>
</li>
<li class="current"><a href="chap17.html">17. Queries</a>
<ul class="sectlevel2">
<li class="current"><a href="chap17.html#queries-pools">17.1. Query Pools</a></li>
<li class="current"><a href="chap17.html#queries-operation">17.2. Query Operation</a></li>
<li class="current"><a href="chap17.html#queries-occlusion">17.3. Occlusion Queries</a></li>
<li class="current"><a href="chap17.html#queries-pipestats">17.4. Pipeline Statistics Queries</a></li>
<li class="current"><a href="chap17.html#queries-timestamps">17.5. Timestamp Queries</a></li>
<li class="current"><a href="chap17.html#queries-performance">17.6. Performance Queries</a></li>
<li class="current"><a href="chap17.html#queries-result-status-only">17.7. Result Status Queries</a></li>
<li class="current"><a href="chap17.html#queries-video-encode-bitstream-buffer-range">17.8. Video Encode Bitstream Buffer Range Queries</a></li>
</ul>
</li>
<li><a href="chap18.html">18. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#clears-outside">18.1. Clearing Images Outside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-inside">18.2. Clearing Images Inside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-values">18.3. Clear Values</a></li>
<li><a href="chap18.html#clears-filling-buffers">18.4. Filling Buffers</a></li>
<li><a href="chap18.html#clears-updating-buffers">18.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap19.html">19. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#copies-buffers">19.1. Copying Data Between Buffers</a></li>
<li><a href="chap19.html#copies-images">19.2. Copying Data Between Images</a></li>
<li><a href="chap19.html#copies-buffers-images">19.3. Copying Data Between Buffers and Images</a></li>
<li><a href="chap19.html#copies-imagescaling">19.4. Image Copies with Scaling</a></li>
<li><a href="chap19.html#copies-resolve">19.5. Resolving Multisample Images</a></li>
</ul>
</li>
<li><a href="chap20.html">20. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#drawing-primitive-topologies">20.1. Primitive Topologies</a></li>
<li><a href="chap20.html#drawing-primitive-order">20.2. Primitive Order</a></li>
<li><a href="chap20.html#drawing-primitive-shading">20.3. Programmable Primitive Shading</a></li>
</ul>
</li>
<li><a href="chap21.html">21. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap21.html#fxvertex-attrib">21.1. Vertex Attributes</a></li>
<li><a href="chap21.html#fxvertex-input">21.2. Vertex Input Description</a></li>
<li><a href="chap21.html#fxvertex-input-address-calculation">21.3. Vertex Input Address Calculation</a></li>
</ul>
</li>
<li><a href="chap22.html">22. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap22.html#_tessellator">22.1. Tessellator</a></li>
<li><a href="chap22.html#_tessellator_patch_discard">22.2. Tessellator Patch Discard</a></li>
<li><a href="chap22.html#tessellation-tessellator-spacing">22.3. Tessellator Spacing</a></li>
<li><a href="chap22.html#tessellation-primitive-order">22.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap22.html#tessellation-vertex-winding-order">22.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap22.html#tessellation-triangle-tessellation">22.6. Triangle Tessellation</a></li>
<li><a href="chap22.html#tessellation-quad-tessellation">22.7. Quad Tessellation</a></li>
<li><a href="chap22.html#tessellation-isoline-tessellation">22.8. Isoline Tessellation</a></li>
<li><a href="chap22.html#tessellation-point-mode">22.9. Tessellation Point Mode</a></li>
<li><a href="chap22.html#_tessellation_pipeline_state">22.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap23.html">23. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#geometry-input">23.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap23.html#geometry-output">23.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap23.html#geometry-invocations">23.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap23.html#geometry-ordering">23.4. Geometry Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap24.html">24. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap24.html#vertexpostproc-flatshading">24.1. Flat Shading</a></li>
<li><a href="chap24.html#vertexpostproc-clipping">24.2. Primitive Clipping</a></li>
<li><a href="chap24.html#vertexpostproc-clipping-shader-outputs">24.3. Clipping Shader Outputs</a></li>
<li><a href="chap24.html#vertexpostproc-coord-transform">24.4. Coordinate Transformations</a></li>
<li><a href="chap24.html#vertexpostproc-viewport">24.5. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap25.html">25. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap25.html#primsrast-discard">25.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap25.html#primsrast-order">25.2. Rasterization Order</a></li>
<li><a href="chap25.html#primsrast-multisampling">25.3. Multisampling</a></li>
<li><a href="chap25.html#primsrast-fragment-shading-rate">25.4. Fragment Shading Rates</a></li>
<li><a href="chap25.html#primsrast-sampleshading">25.5. Sample Shading</a></li>
<li><a href="chap25.html#primsrast-barycentric">25.6. Barycentric Interpolation</a></li>
<li><a href="chap25.html#primsrast-points">25.7. Points</a></li>
<li><a href="chap25.html#primsrast-lines">25.8. Line Segments</a></li>
<li><a href="chap25.html#primsrast-polygons">25.9. Polygons</a></li>
</ul>
</li>
<li><a href="chap26.html">26. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap26.html#fragops-scissor">26.1. Scissor Test</a></li>
<li><a href="chap26.html#fragops-samplemask">26.2. Sample Mask Test</a></li>
<li><a href="chap26.html#fragops-shader">26.3. Fragment Shading</a></li>
<li><a href="chap26.html#fragops-covg">26.4. Multisample Coverage</a></li>
<li><a href="chap26.html#fragops-ds-state">26.5. Depth and Stencil Operations</a></li>
<li><a href="chap26.html#fragops-dbt">26.6. Depth Bounds Test</a></li>
<li><a href="chap26.html#fragops-stencil">26.7. Stencil Test</a></li>
<li><a href="chap26.html#fragops-depth">26.8. Depth Test</a></li>
<li><a href="chap26.html#fragops-samplecount">26.9. Sample Counting</a></li>
<li><a href="chap26.html#fragops-coverage-reduction">26.10. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap27.html">27. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap27.html#framebuffer-blending">27.1. Blending</a></li>
<li><a href="chap27.html#framebuffer-logicop">27.2. Logical Operations</a></li>
<li><a href="chap27.html#framebuffer-color-write-mask">27.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap28.html">28. Dispatching Commands</a></li>
<li><a href="chap29.html">29. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap29.html#sparsememory-sparseresourcefeatures">29.1. Sparse Resource Features</a></li>
<li><a href="chap29.html#sparsememory-fully-resident">29.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-buffers">29.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-images">29.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-sparse-memory-aliasing">29.5. Sparse Memory Aliasing</a></li>
<li><a href="chap29.html#_sparse_resource_implementation_guidelines_informative">29.6. Sparse Resource Implementation Guidelines (Informative)</a></li>
<li><a href="chap29.html#sparsememory-resourceapi">29.7. Sparse Resource API</a></li>
</ul>
</li>
<li><a href="chap30.html">30. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap30.html#_wsi_platform">30.1. WSI Platform</a></li>
<li><a href="chap30.html#_wsi_surface">30.2. WSI Surface</a></li>
<li><a href="chap30.html#display">30.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap30.html#_querying_for_wsi_support">30.4. Querying for WSI Support</a></li>
<li><a href="chap30.html#_surface_queries">30.5. Surface Queries</a></li>
<li><a href="chap30.html#_device_group_queries">30.6. Device Group Queries</a></li>
<li><a href="chap30.html#present-wait">30.7. Present Wait</a></li>
<li><a href="chap30.html#_wsi_swapchain">30.8. WSI Swapchain</a></li>
</ul>
</li>
<li><a href="chap31.html">31. Deferred Host Operations</a>
<ul class="sectlevel2">
<li><a href="chap31.html#deferred-host-operations-requesting">31.1. Requesting Deferral</a></li>
<li><a href="chap31.html#_deferred_host_operations_api">31.2. Deferred Host Operations API</a></li>
</ul>
</li>
<li><a href="chap32.html">32. Acceleration Structures</a>
<ul class="sectlevel2">
<li><a href="chap32.html#acceleration-structure-def">32.1. Acceleration Structures</a></li>
<li><a href="chap32.html#host-acceleration-structure">32.2. Host Acceleration Structure Operations</a></li>
</ul>
</li>
<li><a href="chap33.html">33. Ray Traversal</a>
<ul class="sectlevel2">
<li><a href="chap33.html#ray-intersection-candidate-determination">33.1. Ray Intersection Candidate Determination</a></li>
<li><a href="chap33.html#ray-intersection-culling">33.2. Ray Intersection Culling</a></li>
<li><a href="chap33.html#ray-intersection-confirmation">33.3. Ray Intersection Confirmation</a></li>
<li><a href="chap33.html#ray-closest-hit-determination">33.4. Ray Closest Hit Determination</a></li>
<li><a href="chap33.html#ray-result-determination">33.5. Ray Result Determination</a></li>
</ul>
</li>
<li><a href="chap34.html">34. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="chap34.html#ray-tracing-shader-call">34.1. Shader Call Instructions</a></li>
<li><a href="chap34.html#ray-tracing-commands">34.2. Ray Tracing Commands</a></li>
<li><a href="chap34.html#shader-binding-table">34.3. Shader Binding Table</a></li>
<li><a href="chap34.html#ray-tracing-pipeline-stack">34.4. Ray Tracing Pipeline Stack</a></li>
<li><a href="chap34.html#ray-tracing-capture-replay">34.5. Ray Tracing Capture Replay</a></li>
</ul>
</li>
<li><a href="chap35.html">35. Video Coding</a>
<ul class="sectlevel2">
<li><a href="chap35.html#video-picture-resources">35.1. Video Picture Resources</a></li>
<li><a href="chap35.html#dpb">35.2. Decoded Picture Buffer</a></li>
<li><a href="chap35.html#video-profiles">35.3. Video Profiles</a></li>
<li><a href="chap35.html#video-capabilities">35.4. Video Capabilities</a></li>
<li><a href="chap35.html#video-session">35.5. Video Sessions</a></li>
<li><a href="chap35.html#video-profile-compatibility">35.6. Video Profile Compatibility</a></li>
<li><a href="chap35.html#video-session-parameters">35.7. Video Session Parameters</a></li>
<li><a href="chap35.html#video-coding-scope">35.8. Video Coding Scope</a></li>
<li><a href="chap35.html#video-coding-control">35.9. Video Coding Control</a></li>
<li><a href="chap35.html#video-decode-operations">35.10. Video Decode Operations</a></li>
<li><a href="chap35.html#decode-h264">35.11. H.264 Decode Operations</a></li>
<li><a href="chap35.html#decode-h265">35.12. H.265 Decode Operations</a></li>
<li><a href="chap35.html#video-encode-operations">35.13. Video Encode Operations</a></li>
</ul>
</li>
<li><a href="chap36.html">36. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap36.html#extendingvulkan-instanceanddevicefunctionality">36.1. Instance and Device Functionality</a></li>
<li><a href="chap36.html#extendingvulkan-coreversions">36.2. Core Versions</a></li>
<li><a href="chap36.html#extendingvulkan-layers">36.3. Layers</a></li>
<li><a href="chap36.html#extendingvulkan-extensions">36.4. Extensions</a></li>
<li><a href="chap36.html#extendingvulkan-extensions-extensiondependencies">36.5. Extension Dependencies</a></li>
<li><a href="chap36.html#_compatibility_guarantees_informative">36.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap37.html">37. Features</a>
<ul class="sectlevel2">
<li><a href="chap37.html#features-requirements">37.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap38.html">38. Limits</a>
<ul class="sectlevel2">
<li><a href="chap38.html#limits-minmax">38.1. Limit Requirements</a></li>
</ul>
</li>
<li><a href="chap39.html">39. Formats</a>
<ul class="sectlevel2">
<li><a href="chap39.html#formats-definition">39.1. Format Definition</a></li>
<li><a href="chap39.html#formats-properties">39.2. Format Properties</a></li>
<li><a href="chap39.html#features-required-format-support">39.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap40.html">40. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap40.html#capabilities-image">40.1. Additional Image Capabilities</a></li>
<li><a href="chap40.html#capabilities-buffer">40.2. Additional Buffer Capabilities</a></li>
<li><a href="chap40.html#capabilities-semaphore">40.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap40.html#capabilities-fence">40.4. Optional Fence Capabilities</a></li>
</ul>
</li>
<li><a href="chap41.html">41. Debugging</a></li>
<li><a href="chap42.html">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap42.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap42.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap42.html#spirvenv-module-validation">Validation Rules within a Module</a></li>
<li><a href="chap42.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap42.html#spirvenv-image-signedness">Signedness of SPIR-V Image Accesses</a></li>
<li><a href="chap42.html#spirvenv-format-type-matching">Image Format and Type Matching</a></li>
<li><a href="chap42.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats And Vulkan Formats</a></li>
</ul>
</li>
<li><a href="chap43.html">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap43.html#memory-model-agent">Agent</a></li>
<li><a href="chap43.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap43.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap43.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap43.html#memory-model-references">Reference</a></li>
<li><a href="chap43.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap43.html#shader-call-related">Shader Call Related</a></li>
<li><a href="chap43.html#shader-call-order">Shader Call Order</a></li>
<li><a href="chap43.html#memory-model-scope">Scope</a></li>
<li><a href="chap43.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap43.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap43.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap43.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap43.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap43.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap43.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap43.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap43.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap43.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap43.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap43.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap43.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap43.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap43.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap43.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap43.html#memory-model-acyclicity">Acyclicity</a></li>
<li><a href="chap43.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap43.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap43.html#memory-model-informative-descriptions">Descriptions (Informative)</a></li>
<li><a href="chap43.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
</ul>
</li>
<li><a href="chap44.html">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap44.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap44.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap44.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap45.html">Appendix D: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap45.html#versions-1.2">Version 1.2</a></li>
<li><a href="chap45.html#versions-1.1">Version 1.1</a></li>
<li><a href="chap45.html#versions-1.0">Version 1.0</a></li>
</ul>
</li>
<li><a href="chap46.html">Appendix E: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap46.html#_extension_dependencies">Extension Dependencies</a></li>
<li><a href="chap46.html#extension-appendices-list">List of Current Extensions</a></li>
<li><a href="chap46.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
<li><a href="chap46.html#deprecated-extension-appendices-list">List of Deprecated Extensions</a></li>
</ul>
</li>
<li><a href="chap47.html">Appendix F: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap47.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap47.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap47.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
<li><a href="chap47.html#boilerplate-video-std-headers">Video Std Headers</a></li>
</ul>
</li>
<li><a href="chap48.html">Appendix G: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap48.html#_repeatability">Repeatability</a></li>
<li><a href="chap48.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap48.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap48.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap49.html">Appendix H: Lexicon</a>
<ul class="sectlevel2">
<li><a href="chap49.html#glossary">Glossary</a></li>
<li><a href="chap49.html#lexicon-common-abbreviations">Common Abbreviations</a></li>
<li><a href="chap49.html#lexicon-video-abbreviations">Video-Specific Abbreviations</a></li>
<li><a href="chap49.html#lexicon-prefixes">Prefixes</a></li>
</ul>
</li>
<li><a href="chap50.html">Appendix I: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap50.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap50.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="loading_msg" class="hidden" hidden=""><p>Loading… please wait.</p></div>
<!--ChunkedSearchboxMarker-->
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
<div id="content" class="loadable"><div class="sect1">
<h2 id="queries"><a class="anchor" href="chap17.html"></a>17. Queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Queries</em> provide a mechanism to return information about the processing of
a sequence of Vulkan commands.
Query operations are asynchronous, and as such, their results are not
returned immediately.
Instead, their results, and their availability status are stored in a
<a href="chap17.html#queries-pools">Query Pool</a>.
The state of these queries <strong class="purple">can</strong> be read back on the host, or copied to a
buffer object on the device.</p>
</div>
<div class="paragraph">
<p>The supported query types are <a href="chap17.html#queries-occlusion">Occlusion Queries</a>,
<a href="chap17.html#queries-pipestats">Pipeline Statistics Queries</a>,
<a href="chap17.html#queries-result-status-only">Result Status Queries</a>,
<a href="chap17.html#queries-video-encode-bitstream-buffer-range">Video Encode Bitstream Buffer
Range Queries</a>,
and <a href="chap17.html#queries-timestamps">Timestamp Queries</a>.
<a href="chap17.html#queries-performance">Performance Queries</a> are supported if the associated
extension is available.</p>
</div>
<div class="paragraph">
<p>Several additional queries with specific purposes associated with ray
tracing are available if the corresponding extensions are supported, as
described for <a href="chap17.html#VkQueryType">VkQueryType</a>.</p>
</div>
<div class="sect2">
<h3 id="queries-pools"><a class="anchor" href="chap17.html#queries-pools"></a>17.1. Query Pools</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Queries are managed using <em>query pool</em> objects.
Each query pool is a collection of a specific number of queries of a
particular type.</p>
</div>
<div class="paragraph">
<p>Query pools are represented by <code>VkQueryPool</code> handles:</p>
</div>
<div id="VkQueryPool" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VK_DEFINE_NON_DISPATCHABLE_HANDLE</span><span class="p">(</span><span class="n">VkQueryPool</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a query pool, call:</p>
</div>
<div id="vkCreateQueryPool" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkCreateQueryPool</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkQueryPoolCreateInfo</span><span class="o">*</span>                <span class="n">pCreateInfo</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">,</span>
    <span class="n">VkQueryPool</span><span class="o">*</span>                                <span class="n">pQueryPool</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the query pool.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>
structure containing the number and type of queries to be managed by the
pool.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pQueryPool</code> is a pointer to a <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle in which the
resulting query pool object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateQueryPool-device-parameter" href="chap17.html#VUID-vkCreateQueryPool-device-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateQueryPool-pCreateInfo-parameter" href="chap17.html#VUID-vkCreateQueryPool-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateQueryPool-pAllocator-parameter" href="chap17.html#VUID-vkCreateQueryPool-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateQueryPool-pQueryPool-parameter" href="chap17.html#VUID-vkCreateQueryPool-pQueryPool-parameter"></a> <span class="vuid">VUID-vkCreateQueryPool-pQueryPool-parameter</span><br>
 <code>pQueryPool</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryPoolCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkQueryPoolCreateInfo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkQueryPoolCreateInfo</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                  <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                      <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkQueryPoolCreateFlags</span>           <span class="n">flags</span><span class="p">;</span>
    <span class="n">VkQueryType</span>                      <span class="n">queryType</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                         <span class="n">queryCount</span><span class="p">;</span>
    <span class="n">VkQueryPipelineStatisticFlags</span>    <span class="n">pipelineStatistics</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkQueryPoolCreateInfo</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries managed by the pool.</p>
</li>
<li>
<p><code>pipelineStatistics</code> is a bitmask of
<a href="chap17.html#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a> specifying which counters will be
returned in queries on the new pool, as described below in
<a href="chap17.html#queries-pipestats">Pipeline Statistics Queries</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pipelineStatistics</code> is ignored if <code>queryType</code> is not
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-00791" href="chap17.html#VUID-VkQueryPoolCreateInfo-queryType-00791"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-00791</span><br>

If the <a href="chap37.html#features-pipelineStatisticsQuery"><code>pipelineStatisticsQuery</code></a> feature is not enabled, <code>queryType</code>
<strong class="purple">must</strong> not be <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-00792" href="chap17.html#VUID-VkQueryPoolCreateInfo-queryType-00792"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-00792</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code>,
<code>pipelineStatistics</code> <strong class="purple">must</strong> be a valid combination of
<a href="chap17.html#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-03222" href="chap17.html#VUID-VkQueryPoolCreateInfo-queryType-03222"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-03222</span><br>

If <code>queryType</code> is <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the
<code>pNext</code> chain <strong class="purple">must</strong> include a
<a href="chap17.html#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryCount-02763" href="chap17.html#VUID-VkQueryPoolCreateInfo-queryCount-02763"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryCount-02763</span><br>

<code>queryCount</code> <strong class="purple">must</strong> be greater than 0</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-07133" href="chap17.html#VUID-VkQueryPoolCreateInfo-queryType-07133"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-07133</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</code>, then the
<code>pNext</code> chain <strong class="purple">must</strong> include a <a href="chap35.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure
with <code>videoCodecOperation</code> specifying an encode operation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-sType-sType" href="chap17.html#VUID-VkQueryPoolCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_POOL_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-pNext-pNext" href="chap17.html#VUID-VkQueryPoolCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-pNext-pNext</span><br>
 Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="chap17.html#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a>, <a href="chap35.html#VkVideoDecodeH264ProfileInfoKHR">VkVideoDecodeH264ProfileInfoKHR</a>, <a href="chap35.html#VkVideoDecodeH265ProfileInfoKHR">VkVideoDecodeH265ProfileInfoKHR</a>, <a href="chap35.html#VkVideoDecodeUsageInfoKHR">VkVideoDecodeUsageInfoKHR</a>, <a href="chap35.html#VkVideoEncodeUsageInfoKHR">VkVideoEncodeUsageInfoKHR</a>, or <a href="chap35.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-sType-unique" href="chap17.html#VUID-VkQueryPoolCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-flags-zerobitmask" href="chap17.html#VUID-VkQueryPoolCreateInfo-flags-zerobitmask"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolCreateInfo-queryType-parameter" href="chap17.html#VUID-VkQueryPoolCreateInfo-queryType-parameter"></a> <span class="vuid">VUID-VkQueryPoolCreateInfo-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryPoolCreateFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkQueryPoolCreateFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryPoolCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkQueryPoolPerformanceCreateInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkQueryPoolPerformanceCreateInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkQueryPoolPerformanceCreateInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">queueFamilyIndex</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">counterIndexCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint32_t</span><span class="o">*</span>    <span class="n">pCounterIndices</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkQueryPoolPerformanceCreateInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>queueFamilyIndex</code> is the queue family index to create this
performance query pool for.</p>
</li>
<li>
<p><code>counterIndexCount</code> is the length of the <code>pCounterIndices</code>
array.</p>
</li>
<li>
<p><code>pCounterIndices</code> is a pointer to an array of indices into the
<a href="chap5.html#vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR">vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR</a>::<code>pCounters</code>
to enable in this performance query pool.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-queueFamilyIndex-03236" href="chap17.html#VUID-VkQueryPoolPerformanceCreateInfoKHR-queueFamilyIndex-03236"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-queueFamilyIndex-03236</span><br>

<code>queueFamilyIndex</code> <strong class="purple">must</strong> be a valid queue family index of the device</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-performanceCounterQueryPools-03237" href="chap17.html#VUID-VkQueryPoolPerformanceCreateInfoKHR-performanceCounterQueryPools-03237"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-performanceCounterQueryPools-03237</span><br>

The <a href="chap37.html#features-performanceCounterQueryPools"><code>performanceCounterQueryPools</code></a> feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-03321" href="chap17.html#VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-03321"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-03321</span><br>

Each element of <code>pCounterIndices</code> <strong class="purple">must</strong> be in the range of counters
reported by
<code>vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR</code>
for the queue family specified in <code>queueFamilyIndex</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-sType-sType" href="chap17.html#VUID-VkQueryPoolPerformanceCreateInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_QUERY_POOL_PERFORMANCE_CREATE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-parameter" href="chap17.html#VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-parameter"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-pCounterIndices-parameter</span><br>
 <code>pCounterIndices</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>counterIndexCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-VkQueryPoolPerformanceCreateInfoKHR-counterIndexCount-arraylength" href="chap17.html#VUID-VkQueryPoolPerformanceCreateInfoKHR-counterIndexCount-arraylength"></a> <span class="vuid">VUID-VkQueryPoolPerformanceCreateInfoKHR-counterIndexCount-arraylength</span><br>
 <code>counterIndexCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the number of passes required to query a performance query pool on
a physical device, call:</p>
</div>
<div id="vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="kt">void</span> <span class="nf">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</span><span class="p">(</span>
    <span class="n">VkPhysicalDevice</span>                            <span class="n">physicalDevice</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkQueryPoolPerformanceCreateInfoKHR</span><span class="o">*</span>  <span class="n">pPerformanceQueryCreateInfo</span><span class="p">,</span>
    <span class="kt">uint32_t</span><span class="o">*</span>                                   <span class="n">pNumPasses</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the physical device whose queue
family performance query counter properties will be queried.</p>
</li>
<li>
<p><code>pPerformanceQueryCreateInfo</code> is a pointer to a
<code>VkQueryPoolPerformanceCreateInfoKHR</code> of the performance query that
is to be created.</p>
</li>
<li>
<p><code>pNumPasses</code> is a pointer to an integer related to the number of
passes required to query the performance query pool, as described below.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>pPerformanceQueryCreateInfo</code> member
<code>VkQueryPoolPerformanceCreateInfoKHR</code>::<code>queueFamilyIndex</code> <strong class="purple">must</strong> be a
queue family of <code>physicalDevice</code>.
The number of passes required to capture the counters specified in the
<code>pPerformanceQueryCreateInfo</code> member
<code>VkQueryPoolPerformanceCreateInfoKHR</code>::<code>pCounters</code> is returned in
<code>pNumPasses</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-physicalDevice-parameter" href="chap17.html#VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-physicalDevice-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-physicalDevice-parameter</span><br>
 <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkPhysicalDevice">VkPhysicalDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pPerformanceQueryCreateInfo-parameter" href="chap17.html#VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pPerformanceQueryCreateInfo-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pPerformanceQueryCreateInfo-parameter</span><br>
 <code>pPerformanceQueryCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap17.html#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pNumPasses-parameter" href="chap17.html#VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pNumPasses-parameter"></a> <span class="vuid">VUID-vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR-pNumPasses-parameter</span><br>
 <code>pNumPasses</code> <strong class="purple">must</strong> be a valid pointer to a <code>uint32_t</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a query pool, call:</p>
</div>
<div id="vkDestroyQueryPool" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkDestroyQueryPool</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the query pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-00793" href="chap17.html#VUID-vkDestroyQueryPool-queryPool-00793"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-00793</span><br>

All submitted commands that refer to <code>queryPool</code> <strong class="purple">must</strong> have
completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-00794" href="chap17.html#VUID-vkDestroyQueryPool-queryPool-00794"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-00794</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>queryPool</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-00795" href="chap17.html#VUID-vkDestroyQueryPool-queryPool-00795"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-00795</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>queryPool</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> verify that <code>queryPool</code> <strong class="purple">can</strong> be destroyed by checking
that <code>vkGetQueryPoolResults</code>() without the
<code>VK_QUERY_RESULT_PARTIAL_BIT</code> flag returns <code>VK_SUCCESS</code> for all
queries that are used in command buffers submitted for execution.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyQueryPool-device-parameter" href="chap17.html#VUID-vkDestroyQueryPool-device-parameter"></a> <span class="vuid">VUID-vkDestroyQueryPool-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-parameter" href="chap17.html#VUID-vkDestroyQueryPool-queryPool-parameter"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-parameter</span><br>
 If <code>queryPool</code> is not <a href="chap47.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-pAllocator-parameter" href="chap17.html#VUID-vkDestroyQueryPool-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyQueryPool-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyQueryPool-queryPool-parent" href="chap17.html#VUID-vkDestroyQueryPool-queryPool-parent"></a> <span class="vuid">VUID-vkDestroyQueryPool-queryPool-parent</span><br>
 If <code>queryPool</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queryPool</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>queryType</code>, specifying
the type of queries managed by the pool, are:</p>
</div>
<div id="VkQueryType" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkQueryType</span> <span class="p">{</span>
    <span class="n">VK_QUERY_TYPE_OCCLUSION</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_QUERY_TYPE_PIPELINE_STATISTICS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">VK_QUERY_TYPE_TIMESTAMP</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_queue</span>
    <span class="n">VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</span> <span class="o">=</span> <span class="mi">1000023000</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_performance_query</span>
    <span class="n">VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</span> <span class="o">=</span> <span class="mi">1000116000</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_acceleration_structure</span>
    <span class="n">VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</span> <span class="o">=</span> <span class="mi">1000150000</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_acceleration_structure</span>
    <span class="n">VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</span> <span class="o">=</span> <span class="mi">1000150001</span><span class="p">,</span>
<span class="cp">#ifdef VK_ENABLE_BETA_EXTENSIONS
</span>  <span class="c1">// Provided by VK_KHR_video_encode_queue</span>
    <span class="n">VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</span> <span class="o">=</span> <span class="mi">1000299000</span><span class="p">,</span>
<span class="cp">#endif
</span>  <span class="c1">// Provided by VK_KHR_ray_tracing_maintenance1</span>
    <span class="n">VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</span> <span class="o">=</span> <span class="mi">1000386000</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_ray_tracing_maintenance1</span>
    <span class="n">VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</span> <span class="o">=</span> <span class="mi">1000386001</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkQueryType</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_TYPE_OCCLUSION</code> specifies an <a href="chap17.html#queries-occlusion">occlusion query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> specifies a <a href="chap17.html#queries-pipestats">pipeline statistics query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_TIMESTAMP</code> specifies a <a href="chap17.html#queries-timestamps">timestamp query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> specifies a
<a href="chap17.html#queries-performance">performance query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> specifies
a <a href="chap32.html#acceleration-structure-copying">acceleration structure size query</a>
for use with <a href="chap32.html#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> or
<a href="chap32.html#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>
specifies a <a href="chap32.html#acceleration-structure-copying">serialization acceleration
structure size query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code> specifies an
<a href="chap32.html#acceleration-structure-copying">acceleration structure size query</a>
for use with <a href="chap32.html#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> or
<a href="chap32.html#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code>
specifies a <a href="chap32.html#serialized-as-header">serialization acceleration structure
pointer count query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> specifies a
<a href="chap17.html#queries-result-status-only">result status query</a>.</p>
</li>
<li>
<p><code>VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</code> specifies a
<a href="chap17.html#queries-video-encode-bitstream-buffer-range">video encode bitstream
range query</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="queries-operation"><a class="anchor" href="chap17.html#queries-operation"></a>17.2. Query Operation</h3>
<div class="paragraph">
<p>The operation of queries is controlled by the commands
<a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a>, <a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a>,
<a href="chap17.html#vkCmdResetQueryPool">vkCmdResetQueryPool</a>, <a href="chap17.html#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>,
<a href="chap17.html#vkCmdWriteTimestamp2KHR">vkCmdWriteTimestamp2KHR</a>,
and <a href="chap17.html#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a>.</p>
</div>
<div class="paragraph">
<p>In order for a <code>VkCommandBuffer</code> to record query management commands,
the queue family for which its <code>VkCommandPool</code> was created <strong class="purple">must</strong> support
the appropriate type of operations (graphics, compute) suitable for the
query type of a given query pool.</p>
</div>
<div class="paragraph">
<p>Each query in a query pool has a status that is either <em>unavailable</em> or
<em>available</em>, and also has state to store the numerical results of a query
operation of the type requested when the query pool was created.
Resetting a query via <a href="chap17.html#vkCmdResetQueryPool">vkCmdResetQueryPool</a>
or <a href="chap17.html#vkResetQueryPool">vkResetQueryPool</a>
sets the status to unavailable and makes the numerical results undefined.
A query is made available by the operation of <a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a>,
<a href="chap17.html#vkCmdWriteTimestamp2KHR">vkCmdWriteTimestamp2KHR</a>,
or <a href="chap17.html#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a>.
Both the availability status and numerical results <strong class="purple">can</strong> be retrieved by
calling either <a href="chap17.html#vkGetQueryPoolResults">vkGetQueryPoolResults</a> or
<a href="chap17.html#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>.</p>
</div>
<div class="paragraph">
<p>After query pool creation, each query <strong class="purple">must</strong> be reset before it is used.
Queries <strong class="purple">must</strong> also be reset between uses.</p>
</div>
<div class="paragraph">
<p>If a logical device includes multiple physical devices, then each command
that writes a query <strong class="purple">must</strong> execute on a single physical device, and any call
to <a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a> <strong class="purple">must</strong> execute the corresponding <a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a>
command on the same physical device.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a range of queries in a query pool on a queue, call:</p>
</div>
<div id="vkCmdResetQueryPool" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdResetQueryPool</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">firstQuery</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">queryCount</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the handle of the query pool managing the queries
being reset.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index to reset.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When executed on a queue, this command sets the status of query indices
<span class="eq">[<code>firstQuery</code>, <code>firstQuery</code> +  <code>queryCount</code> - 1]</span> to
unavailable.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>firstQuery</code> and <code>queryCount</code> that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>firstQuery</code> and <code>queryCount</code> that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="paragraph">
<p>If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command sets the status of
query indices <span class="eq">[<code>firstQuery</code>, <code>firstQuery</code> + 
<code>queryCount</code> - 1]</span> to unavailable for each pass of <code>queryPool</code>, as
indicated by a call to
<a href="chap17.html#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because <code>vkCmdResetQueryPool</code> resets all the passes of the indicated
queries, applications must not record a <code>vkCmdResetQueryPool</code> command
for a <code>queryPool</code> created with <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>
in a command buffer that needs to be submitted multiple times as indicated
by a call to <a href="chap17.html#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a>.
Otherwise applications will never be able to complete the recorded queries.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetQueryPool-firstQuery-00796" href="chap17.html#VUID-vkCmdResetQueryPool-firstQuery-00796"></a> <span class="vuid">VUID-vkCmdResetQueryPool-firstQuery-00796</span><br>

<code>firstQuery</code> <strong class="purple">must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-firstQuery-00797" href="chap17.html#VUID-vkCmdResetQueryPool-firstQuery-00797"></a> <span class="vuid">VUID-vkCmdResetQueryPool-firstQuery-00797</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong class="purple">must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-None-02841" href="chap17.html#VUID-vkCmdResetQueryPool-None-02841"></a> <span class="vuid">VUID-vkCmdResetQueryPool-None-02841</span><br>

All queries used by the command <strong class="purple">must</strong> not be active</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-firstQuery-02862" href="chap17.html#VUID-vkCmdResetQueryPool-firstQuery-02862"></a> <span class="vuid">VUID-vkCmdResetQueryPool-firstQuery-02862</span><br>

If <code>queryPool</code> was created with
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command <strong class="purple">must</strong> not be
recorded in a command buffer that, either directly or through secondary
command buffers, also contains begin commands for a query from the set
of queries <span class="eq">[<code>firstQuery</code>, <code>firstQuery</code> + 
<code>queryCount</code> - 1]</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commandBuffer-parameter" href="chap17.html#VUID-vkCmdResetQueryPool-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-queryPool-parameter" href="chap17.html#VUID-vkCmdResetQueryPool-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdResetQueryPool-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commandBuffer-recording" href="chap17.html#VUID-vkCmdResetQueryPool-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commandBuffer-cmdpool" href="chap17.html#VUID-vkCmdResetQueryPool-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, compute, decode, encode, or opticalflow operations</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-renderpass" href="chap17.html#VUID-vkCmdResetQueryPool-renderpass"></a> <span class="vuid">VUID-vkCmdResetQueryPool-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-videocoding" href="chap17.html#VUID-vkCmdResetQueryPool-videocoding"></a> <span class="vuid">VUID-vkCmdResetQueryPool-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdResetQueryPool-commonparent" href="chap17.html#VUID-vkCmdResetQueryPool-commonparent"></a> <span class="vuid">VUID-vkCmdResetQueryPool-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode<br>
Opticalflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To reset a range of queries in a query pool on the host, call:</p>
</div>
<div id="vkResetQueryPool" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_2</span>
<span class="kt">void</span> <span class="nf">vkResetQueryPool</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">firstQuery</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">queryCount</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the query pool.</p>
</li>
<li>
<p><code>queryPool</code> is the handle of the query pool managing the queries
being reset.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index to reset.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command sets the status of query indices <span class="eq">[<code>firstQuery</code>,
<code>firstQuery</code> +  <code>queryCount</code> - 1]</span> to unavailable.</p>
</div>
<div class="paragraph">
<p>If <code>queryPool</code> is <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> this command
sets the status of query indices <span class="eq">[<code>firstQuery</code>, <code>firstQuery</code>
+  <code>queryCount</code> - 1]</span> to unavailable for each pass.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetQueryPool-None-02665" href="chap17.html#VUID-vkResetQueryPool-None-02665"></a> <span class="vuid">VUID-vkResetQueryPool-None-02665</span><br>

The <a href="chap37.html#features-hostQueryReset"><code>hostQueryReset</code></a> feature <strong class="purple">must</strong> be
enabled</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-02666" href="chap17.html#VUID-vkResetQueryPool-firstQuery-02666"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-02666</span><br>

<code>firstQuery</code> <strong class="purple">must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-02667" href="chap17.html#VUID-vkResetQueryPool-firstQuery-02667"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-02667</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong class="purple">must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-02741" href="chap17.html#VUID-vkResetQueryPool-firstQuery-02741"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-02741</span><br>

Submitted commands that refer to the range specified by <code>firstQuery</code>
and <code>queryCount</code> in <code>queryPool</code> <strong class="purple">must</strong> have completed execution</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-firstQuery-02742" href="chap17.html#VUID-vkResetQueryPool-firstQuery-02742"></a> <span class="vuid">VUID-vkResetQueryPool-firstQuery-02742</span><br>

The range of queries specified by <code>firstQuery</code> and <code>queryCount</code>
in <code>queryPool</code> <strong class="purple">must</strong> not be in use by calls to
<a href="chap17.html#vkGetQueryPoolResults">vkGetQueryPoolResults</a> or <code>vkResetQueryPool</code> in other threads</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetQueryPool-device-parameter" href="chap17.html#VUID-vkResetQueryPool-device-parameter"></a> <span class="vuid">VUID-vkResetQueryPool-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-queryPool-parameter" href="chap17.html#VUID-vkResetQueryPool-queryPool-parameter"></a> <span class="vuid">VUID-vkResetQueryPool-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetQueryPool-queryPool-parent" href="chap17.html#VUID-vkResetQueryPool-queryPool-parent"></a> <span class="vuid">VUID-vkResetQueryPool-queryPool-parent</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Once queries are reset and ready for use, query commands <strong class="purple">can</strong> be issued to a
command buffer.
Occlusion queries and pipeline statistics queries count events - drawn
samples and pipeline stage invocations, respectively - resulting from
commands that are recorded between a <a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a> command and a
<a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a> command within a specified command buffer, effectively
scoping a set of drawing and/or dispatching commands.
Timestamp queries write timestamps to a query pool.
Performance queries record performance counters to a query pool.</p>
</div>
<div class="paragraph">
<p>A query <strong class="purple">must</strong> begin and end in the same command buffer, although if it is a
primary command buffer, and the <a href="chap37.html#features-inheritedQueries"><code>inheritedQueries</code></a> feature is enabled, it <strong class="purple">can</strong> execute secondary
command buffers during the query operation.
For a secondary command buffer to be executed while a query is active, it
<strong class="purple">must</strong> set the <code>occlusionQueryEnable</code>, <code>queryFlags</code>, and/or
<code>pipelineStatistics</code> members of <a href="chap6.html#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a> to
conservative values, as described in the <a href="chap6.html#commandbuffers-recording">Command
Buffer Recording</a> section.
A query <strong class="purple">must</strong> either begin and end inside the same subpass of a render pass
instance, or <strong class="purple">must</strong> both begin and end outside of a render pass instance
(i.e. contain entire render pass instances).</p>
</div>
<div class="paragraph">
<p>If queries are used while executing a render pass instance that has
multiview enabled, the query uses <span class="eq">N</span> consecutive query indices in the
query pool (starting at <code>query</code>) where <span class="eq">N</span> is the number of bits set
in the view mask in the subpass the query is used in.
How the numerical results of the query are distributed among the queries is
implementation-dependent.
For example, some implementations <strong class="purple">may</strong> write each view’s results to a
distinct query, while other implementations <strong class="purple">may</strong> write the total result to
the first query and write zero to the other queries.
However, the sum of the results in all the queries <strong class="purple">must</strong> accurately reflect
the total result of the query summed over all views.
Applications <strong class="purple">can</strong> sum the results from all the queries to compute the total
result.</p>
</div>
<div class="paragraph">
<p>Queries used with multiview rendering <strong class="purple">must</strong> not span subpasses, i.e. they
<strong class="purple">must</strong> begin and end in the same subpass.</p>
</div>
<div class="paragraph">
<p>A query <strong class="purple">must</strong> either begin and end inside the same video coding scope, or
<strong class="purple">must</strong> both begin and end outside of a video coding scope and <strong class="purple">must</strong> not
contain entire video coding scopes.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To begin a query, call:</p>
</div>
<div id="vkCmdBeginQuery" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdBeginQuery</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">query</span><span class="p">,</span>
    <span class="n">VkQueryControlFlags</span>                         <span class="n">flags</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>query</code> is the query index within the query pool that will contain
the results.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap17.html#VkQueryControlFlagBits">VkQueryControlFlagBits</a> specifying
constraints on the types of queries that <strong class="purple">can</strong> be performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <code>queryType</code> of the pool is <code>VK_QUERY_TYPE_OCCLUSION</code> and
<code>flags</code> contains <code>VK_QUERY_CONTROL_PRECISE_BIT</code>, an implementation
<strong class="purple">must</strong> return a result that matches the actual number of samples passed.
This is described in more detail in <a href="chap17.html#queries-occlusion">Occlusion Queries</a>.</p>
</div>
<div id="queries-operation-active" class="paragraph">
<p>After beginning a query, that query is considered <em>active</em> within the
command buffer it was called in until that same query is ended.
Queries active in a primary command buffer when secondary command buffers
are executed are considered active for those secondary command buffers.</p>
</div>
<div class="paragraph">
<p>Furthermore, if the query is started within a video coding scope, the
following command buffer states are initialized for the query type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="queries-operation-active-query-index"></a> The <em>active_query_index</em> is set
to the value specified by <code>query</code>.</p>
</li>
<li>
<p><a id="queries-operation-last-activatable-query-index"></a> The <em>last activatable
query index</em> is also set to the value specified by <code>query</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each <a href="chap35.html">video coding operation</a> stores a result to the query
corresponding to the current active query index, followed by incrementing
the active query index.
If the active query index gets incremented past the last activatable query
index, issuing any further video coding operations results in undefined
behavior.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In practice, this means that currently no more than a single video coding
operation <strong class="purple">must</strong> be issued between a begin and end query pair.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-00807" href="chap17.html#VUID-vkCmdBeginQuery-None-00807"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-00807</span><br>

All queries used by the command <strong class="purple">must</strong> be unavailable</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-02804" href="chap17.html#VUID-vkCmdBeginQuery-queryType-02804"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-02804</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong class="purple">must</strong> not be
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-04728" href="chap17.html#VUID-vkCmdBeginQuery-queryType-04728"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-04728</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong class="purple">must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-06741" href="chap17.html#VUID-vkCmdBeginQuery-queryType-06741"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-06741</span><br>

The <code>queryType</code> used to create <code>queryPool</code> <strong class="purple">must</strong> not be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_BOTTOM_LEVEL_POINTERS_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00800" href="chap17.html#VUID-vkCmdBeginQuery-queryType-00800"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00800</span><br>

If the <a href="chap37.html#features-occlusionQueryPrecise"><code>occlusionQueryPrecise</code></a>
feature is not enabled, or the <code>queryType</code> used to create
<code>queryPool</code> was not <code>VK_QUERY_TYPE_OCCLUSION</code>, <code>flags</code> <strong class="purple">must</strong>
not contain <code>VK_QUERY_CONTROL_PRECISE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-query-00802" href="chap17.html#VUID-vkCmdBeginQuery-query-00802"></a> <span class="vuid">VUID-vkCmdBeginQuery-query-00802</span><br>

<code>query</code> <strong class="purple">must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00803" href="chap17.html#VUID-vkCmdBeginQuery-queryType-00803"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00803</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_OCCLUSION</code>, the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00804" href="chap17.html#VUID-vkCmdBeginQuery-queryType-00804"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00804</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> and any of the
<code>pipelineStatistics</code> indicate graphics operations, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong>
support graphics operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-00805" href="chap17.html#VUID-vkCmdBeginQuery-queryType-00805"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-00805</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PIPELINE_STATISTICS</code> and any of the
<code>pipelineStatistics</code> indicate compute operations, the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong>
support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-01885" href="chap17.html#VUID-vkCmdBeginQuery-commandBuffer-01885"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-01885</span><br>

<code>commandBuffer</code> <strong class="purple">must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-query-00808" href="chap17.html#VUID-vkCmdBeginQuery-query-00808"></a> <span class="vuid">VUID-vkCmdBeginQuery-query-00808</span><br>

If called within a render pass instance, the sum of <code>query</code> and the
number of bits set in the current subpass’s view mask <strong class="purple">must</strong> be less than
or equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07126" href="chap17.html#VUID-vkCmdBeginQuery-queryType-07126"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07126</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then the <code>VkCommandPool</code>
that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> have been created with
a queue family index that supports <a href="chap17.html#queries-result-status-only">result
status queries</a>, as indicated by
<a href="chap5.html#VkQueueFamilyQueryResultStatusPropertiesKHR">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-07127" href="chap17.html#VUID-vkCmdBeginQuery-None-07127"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-07127</span><br>

If there is a bound video session, then there <strong class="purple">must</strong> be no
<a href="chap17.html#queries-operation-active">active</a> queries</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07128" href="chap17.html#VUID-vkCmdBeginQuery-queryType-07128"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07128</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> and there is a bound video
session, then <code>queryPool</code> <strong class="purple">must</strong> have been created with a
<a href="chap35.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure included in the <code>pNext</code> chain
of <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the one specified in
<a href="chap35.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code> the bound video
session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-04862" href="chap17.html#VUID-vkCmdBeginQuery-queryType-04862"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-04862</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</code>, then the
<code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong>
support <a href="chap35.html#video-encode-operations">video encode operations</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07129" href="chap17.html#VUID-vkCmdBeginQuery-queryType-07129"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07129</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</code>, then there
<strong class="purple">must</strong> be a bound video session</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07130" href="chap17.html#VUID-vkCmdBeginQuery-queryType-07130"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07130</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</code> and there is
a bound video session, then <code>queryPool</code> <strong class="purple">must</strong> have been created with
a <a href="chap35.html#VkVideoProfileInfoKHR">VkVideoProfileInfoKHR</a> structure included in the <code>pNext</code>
chain of <a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a> identical to the one specified in
<a href="chap35.html#VkVideoSessionCreateInfoKHR">VkVideoSessionCreateInfoKHR</a>::<code>pVideoProfile</code> the bound video
session was created with</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryType-07131" href="chap17.html#VUID-vkCmdBeginQuery-queryType-07131"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryType-07131</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code> or
<code>VK_QUERY_TYPE_VIDEO_ENCODE_BITSTREAM_BUFFER_RANGE_KHR</code>, then there
<strong class="purple">must</strong> be no bound video session</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-01922" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-01922"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-01922</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> that
differs from that of any queries that are
<a href="chap17.html#queries-operation-active">active</a> within <code>commandBuffer</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-07289" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-07289"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-07289</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then the
<a href="chap17.html#VkQueryPoolPerformanceCreateInfoKHR">VkQueryPoolPerformanceCreateInfoKHR</a>::<code>queueFamilyIndex</code>
<code>queryPool</code> was created with <strong class="purple">must</strong> equal the queue family index of
the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03223" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-03223"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03223</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <a href="chap17.html#profiling-lock">profiling lock</a> <strong class="purple">must</strong> have been held before <a href="chap6.html#vkBeginCommandBuffer">vkBeginCommandBuffer</a>
was called on <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03224" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-03224"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03224</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one of the counters used
to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_COMMAND_BUFFER_KHR</code>, the query begin
<strong class="purple">must</strong> be the first recorded command in <code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03225" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-03225"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03225</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one of the counters used
to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_RENDER_PASS_KHR</code>, the begin command
<strong class="purple">must</strong> not be recorded within a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-03226" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-03226"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-03226</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and another query pool with a
<code>queryType</code> <code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> has been used
within <code>commandBuffer</code>, its parent primary command buffer or
secondary command buffer recorded within the same parent primary command
buffer as <code>commandBuffer</code>, the
<a href="chap37.html#features-performanceCounterMultipleQueryPools"><code>performanceCounterMultipleQueryPools</code></a> feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-02863" href="chap17.html#VUID-vkCmdBeginQuery-None-02863"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-02863</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, this command <strong class="purple">must</strong> not be
recorded in a command buffer that, either directly or through secondary
command buffers, also contains a <code>vkCmdResetQueryPool</code> command
affecting the same query</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-parameter" href="chap17.html#VUID-vkCmdBeginQuery-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-queryPool-parameter" href="chap17.html#VUID-vkCmdBeginQuery-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdBeginQuery-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-flags-parameter" href="chap17.html#VUID-vkCmdBeginQuery-flags-parameter"></a> <span class="vuid">VUID-vkCmdBeginQuery-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap17.html#VkQueryControlFlagBits">VkQueryControlFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-recording" href="chap17.html#VUID-vkCmdBeginQuery-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commandBuffer-cmdpool" href="chap17.html#VUID-vkCmdBeginQuery-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBeginQuery-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-commonparent" href="chap17.html#VUID-vkCmdBeginQuery-commonparent"></a> <span class="vuid">VUID-vkCmdBeginQuery-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a>::<code>flags</code>, specifying
constraints on the types of queries that <strong class="purple">can</strong> be performed, are:</p>
</div>
<div id="VkQueryControlFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkQueryControlFlagBits</span> <span class="p">{</span>
    <span class="n">VK_QUERY_CONTROL_PRECISE_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkQueryControlFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_CONTROL_PRECISE_BIT</code> specifies the precision of
<a href="chap17.html#queries-occlusion">occlusion queries</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryControlFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkQueryControlFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryControlFlags</code> is a bitmask type for setting a mask of zero or
more <a href="chap17.html#VkQueryControlFlagBits">VkQueryControlFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To end a query after the set of desired drawing or dispatching commands is
executed, call:</p>
</div>
<div id="vkCmdEndQuery" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdEndQuery</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">query</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that is managing the results of the
query.</p>
</li>
<li>
<p><code>query</code> is the query index within the query pool where the result is
stored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command completes the query in <code>queryPool</code> identified by
<code>query</code>, and marks it as available.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the operation of this command.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQuery-None-01923" href="chap17.html#VUID-vkCmdEndQuery-None-01923"></a> <span class="vuid">VUID-vkCmdEndQuery-None-01923</span><br>

All queries used by the command <strong class="purple">must</strong> be
<a href="chap17.html#queries-operation-active">active</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-query-00810" href="chap17.html#VUID-vkCmdEndQuery-query-00810"></a> <span class="vuid">VUID-vkCmdEndQuery-query-00810</span><br>

<code>query</code> <strong class="purple">must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-01886" href="chap17.html#VUID-vkCmdEndQuery-commandBuffer-01886"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-01886</span><br>

<code>commandBuffer</code> <strong class="purple">must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-query-00812" href="chap17.html#VUID-vkCmdEndQuery-query-00812"></a> <span class="vuid">VUID-vkCmdEndQuery-query-00812</span><br>

If <code>vkCmdEndQuery</code> is called within a render pass instance, the sum
of <code>query</code> and the number of bits set in the current subpass’s view
mask <strong class="purple">must</strong> be less than or equal to the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-queryPool-03227" href="chap17.html#VUID-vkCmdEndQuery-queryPool-03227"></a> <span class="vuid">VUID-vkCmdEndQuery-queryPool-03227</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one or more of the
counters used to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_COMMAND_BUFFER_KHR</code>, the
<a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a> <strong class="purple">must</strong> be the last recorded command in
<code>commandBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-queryPool-03228" href="chap17.html#VUID-vkCmdEndQuery-queryPool-03228"></a> <span class="vuid">VUID-vkCmdEndQuery-queryPool-03228</span><br>

If <code>queryPool</code> was created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code> and one or more of the
counters used to create <code>queryPool</code> was
<code>VK_PERFORMANCE_COUNTER_SCOPE_RENDER_PASS_KHR</code>, the
<a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a> <strong class="purple">must</strong> not be recorded within a render pass instance</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-07007" href="chap17.html#VUID-vkCmdBeginQuery-None-07007"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-07007</span><br>

If called within a subpass of a render pass instance, the corresponding
<code>vkCmdBeginQuery</code>* command <strong class="purple">must</strong> have been called previously within
the same subpass</p>
</li>
<li>
<p><a id="VUID-vkCmdBeginQuery-None-07008" href="chap17.html#VUID-vkCmdBeginQuery-None-07008"></a> <span class="vuid">VUID-vkCmdBeginQuery-None-07008</span><br>

If called outside of a render pass instance, the corresponding
<code>vkCmdBeginQuery</code>* command <strong class="purple">must</strong> have been called outside of a
render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-parameter" href="chap17.html#VUID-vkCmdEndQuery-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-queryPool-parameter" href="chap17.html#VUID-vkCmdEndQuery-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdEndQuery-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-recording" href="chap17.html#VUID-vkCmdEndQuery-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commandBuffer-cmdpool" href="chap17.html#VUID-vkCmdEndQuery-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdEndQuery-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdEndQuery-commonparent" href="chap17.html#VUID-vkCmdEndQuery-commonparent"></a> <span class="vuid">VUID-vkCmdEndQuery-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action<br>
State</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="queries-operation-memorylayout" class="paragraph">
<p>An application <strong class="purple">can</strong> retrieve results either by requesting they be written
into application-provided memory, or by requesting they be copied into a
<code>VkBuffer</code>.
In either case, the layout in memory is defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first query’s result is written starting at the first byte requested
by the command, and each subsequent query’s result begins <code>stride</code>
bytes later.</p>
</li>
<li>
<p>Occlusion queries, pipeline statistics queries,
video encode bitstream buffer range queries,
and timestamp queries store results in a tightly packed array of
unsigned integers, either 32- or 64-bits as requested by the command,
storing the numerical results and, if requested, the availability
status.</p>
</li>
<li>
<p>Performance queries store results in a tightly packed array whose type
is determined by the <code>unit</code> member of the corresponding
<a href="chap5.html#VkPerformanceCounterKHR">VkPerformanceCounterKHR</a>.</p>
</li>
<li>
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is used, the final
element of each query’s result is an integer indicating whether the
query’s result is available, with any non-zero value indicating that it
is available.</p>
</li>
<li>
<p>If <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is used, the final element
of each query’s result is an integer value indicating that status of the
query result.
Positive values indicate success, negative values indicate failure, and
0 indicates that the result is not yet available.
Specific error codes are encoded in the <a href="chap17.html#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a>
enumeration.</p>
</li>
<li>
<p>Occlusion queries write one integer value - the number of samples
passed.
Pipeline statistics queries write one integer value for each bit that is
enabled in the <code>pipelineStatistics</code> when the pool is created, and
the statistics values are written in bit order starting from the least
significant bit.
Timestamp queries write one integer value.
Performance queries write one <a href="chap17.html#VkPerformanceCounterResultKHR">VkPerformanceCounterResultKHR</a> value
for each <a href="chap5.html#VkPerformanceCounterKHR">VkPerformanceCounterKHR</a> in the query.
Video encode bitstream buffer range queries write two integers; the
first integer is an offset into the bitstream buffer range where the
encoded video bitstream data was written, and the second integer is the
number of bytes written to the bitstream buffer.</p>
</li>
<li>
<p>If more than one query is retrieved and <code>stride</code> is not at least as
large as the size of the array of values corresponding to a single
query, the values written to memory are undefined.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve status and results for a set of queries, call:</p>
</div>
<div id="vkGetQueryPoolResults" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkGetQueryPoolResults</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">firstQuery</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">queryCount</span><span class="p">,</span>
    <span class="kt">size_t</span>                                      <span class="n">dataSize</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span>                                       <span class="n">pData</span><span class="p">,</span>
    <span class="n">VkDeviceSize</span>                                <span class="n">stride</span><span class="p">,</span>
    <span class="n">VkQueryResultFlags</span>                          <span class="n">flags</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the query pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool managing the queries containing the
desired results.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries to read.</p>
</li>
<li>
<p><code>dataSize</code> is the size in bytes of the buffer pointed to by
<code>pData</code>.</p>
</li>
<li>
<p><code>pData</code> is a pointer to a user-allocated buffer where the results
will be written</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>pData</code>.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap17.html#VkQueryResultFlagBits">VkQueryResultFlagBits</a> specifying how
and when results are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any results written for a query are written according to
<a href="chap17.html#queries-operation-memorylayout">a layout dependent on the query type</a>.</p>
</div>
<div class="paragraph">
<p>If no bits are set in <code>flags</code>, and all requested queries are in the
available state, results are written as an array of 32-bit unsigned integer
values.
Behavior when not all queries are available is described
<a href="chap17.html#queries-wait-bit-not-set">below</a>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set, results for all
queries in <code>queryPool</code> identified by <code>firstQuery</code> and
<code>queryCount</code> are copied to <code>pData</code>, along with an extra availability
value written directly after the results of each query and interpreted as an
unsigned integer.
A value of zero indicates that the results are not yet available, otherwise
the query is complete and results are available.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is set, results for all queries
in <code>queryPool</code> identified by <code>firstQuery</code> and <code>queryCount</code> are
copied to <code>pData</code>, along with an extra status value written directly
after the results of each query and interpreted as a signed integer.
A value of zero indicates that the results are not yet available.
Positive values indicate that the operations within the query completed
successfully, and the query results are valid.
Negative values indicate that the operations within the query completed
unsuccessfully.</p>
</div>
<div class="paragraph">
<p><a href="chap17.html#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> defines specific meaning for values returned
here, though implementations are free to return other values.</p>
</div>
<div class="paragraph">
<p>Results for any available query written by this command are final and
represent the final result of the query.
If <code>VK_QUERY_RESULT_PARTIAL_BIT</code> is set, then for any query that is
unavailable, an intermediate result between zero and the final result value
is written for that query.
Otherwise, any result written by this command is undefined.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_64_BIT</code> is set, results and availability
or status
values for all queries are written as an array of 64-bit values.
If the <code>queryPool</code> was created with
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, results for each query are
written as an array of the type indicated by
<a href="chap5.html#VkPerformanceCounterKHR">VkPerformanceCounterKHR</a>::<code>storage</code> for the counter being queried.
Otherwise, results and availability
or status
values are written as an array of 32-bit values.
If an unsigned integer query’s value overflows the result type, the value
<strong class="purple">may</strong> either wrap or saturate.
If a signed integer query’s value overflows the result type, the value is
undefined.
If a floating point query’s value is not representable as the result type,
the value is undefined.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WAIT_BIT</code> is set, this command defines an execution
dependency with any earlier commands that writes one of the identified
queries.
The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all instances of <a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a>,
<a href="chap17.html#vkCmdWriteTimestamp2KHR">vkCmdWriteTimestamp2KHR</a>,
and <a href="chap17.html#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a> that reference any query in <code>queryPool</code>
indicated by <code>firstQuery</code> and <code>queryCount</code>.
The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes the host operations of this command.</p>
</div>
<div id="queries-wait-bit-not-set" class="paragraph">
<p>If <code>VK_QUERY_RESULT_WAIT_BIT</code> is not set, <code>vkGetQueryPoolResults</code>
<strong class="purple">may</strong> return <code>VK_NOT_READY</code> if there are queries in the unavailable
state.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">must</strong> take care to ensure that use of the
<code>VK_QUERY_RESULT_WAIT_BIT</code> bit has the desired effect.</p>
</div>
<div class="paragraph">
<p>For example, if a query has been used previously and a command buffer
records the commands <code>vkCmdResetQueryPool</code>, <code>vkCmdBeginQuery</code>, and
<code>vkCmdEndQuery</code> for that query, then the query will remain in the
available state until
<code>vkResetQueryPool</code> is called or
the <code>vkCmdResetQueryPool</code> command executes on a queue.
Applications <strong class="purple">can</strong> use fences or events to ensure that a query has already
been reset before checking for its results or availability status.
Otherwise, a stale value could be returned from a previous use of the query.</p>
</div>
<div class="paragraph">
<p>The above also applies when <code>VK_QUERY_RESULT_WAIT_BIT</code> is used in
combination with <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>.
In this case, the returned availability status <strong class="purple">may</strong> reflect the result of a
previous use of the query unless
<code>vkResetQueryPool</code> is called or
the <code>vkCmdResetQueryPool</code> command has been executed since the last use
of the query.</p>
</div>
<div class="paragraph">
<p>A similar situation can arise with the
<code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> flag.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> double-buffer query pool usage, with a pool per frame, and
reset queries at the end of the frame in which they are read.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetQueryPoolResults-firstQuery-00813" href="chap17.html#VUID-vkGetQueryPoolResults-firstQuery-00813"></a> <span class="vuid">VUID-vkGetQueryPoolResults-firstQuery-00813</span><br>

<code>firstQuery</code> <strong class="purple">must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-02828" href="chap17.html#VUID-vkGetQueryPoolResults-flags-02828"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-02828</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is not set in <code>flags</code> and the
<code>queryType</code> used to create <code>queryPool</code> was not
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then <code>pData</code> and
<code>stride</code> <strong class="purple">must</strong> be multiples of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-00815" href="chap17.html#VUID-vkGetQueryPoolResults-flags-00815"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-00815</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is set in <code>flags</code> then <code>pData</code>
and <code>stride</code> <strong class="purple">must</strong> be multiples of <code>8</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-03229" href="chap17.html#VUID-vkGetQueryPoolResults-queryType-03229"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-03229</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then <code>pData</code> and
<code>stride</code> <strong class="purple">must</strong> be multiples of the size of
<a href="chap17.html#VkPerformanceCounterResultKHR">VkPerformanceCounterResultKHR</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-04519" href="chap17.html#VUID-vkGetQueryPoolResults-queryType-04519"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-04519</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, then <code>stride</code> <strong class="purple">must</strong> be
large enough to contain
<code>VkQueryPoolPerformanceCreateInfoKHR</code>::<code>counterIndexCount</code> used
to create <code>queryPool</code> times the size of
<a href="chap17.html#VkPerformanceCounterResultKHR">VkPerformanceCounterResultKHR</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-firstQuery-00816" href="chap17.html#VUID-vkGetQueryPoolResults-firstQuery-00816"></a> <span class="vuid">VUID-vkGetQueryPoolResults-firstQuery-00816</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong class="purple">must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-dataSize-00817" href="chap17.html#VUID-vkGetQueryPoolResults-dataSize-00817"></a> <span class="vuid">VUID-vkGetQueryPoolResults-dataSize-00817</span><br>

<code>dataSize</code> <strong class="purple">must</strong> be large enough to contain the result of each
query, as described <a href="chap17.html#queries-operation-memorylayout">here</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-00818" href="chap17.html#VUID-vkGetQueryPoolResults-queryType-00818"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-00818</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TIMESTAMP</code>, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_QUERY_RESULT_PARTIAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-03230" href="chap17.html#VUID-vkGetQueryPoolResults-queryType-03230"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-03230</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>,
<code>VK_QUERY_RESULT_PARTIAL_BIT</code> or <code>VK_QUERY_RESULT_64_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-03231" href="chap17.html#VUID-vkGetQueryPoolResults-queryType-03231"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-03231</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <code>queryPool</code> <strong class="purple">must</strong>
have been recorded once for each pass as retrieved via a call to
<a href="chap17.html#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryType-04810" href="chap17.html#VUID-vkGetQueryPoolResults-queryType-04810"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryType-04810</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then <code>flags</code> <strong class="purple">must</strong>
include <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-04811" href="chap17.html#VUID-vkGetQueryPoolResults-flags-04811"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-04811</span><br>

If <code>flags</code> includes <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>, then
it <strong class="purple">must</strong> not include <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetQueryPoolResults-device-parameter" href="chap17.html#VUID-vkGetQueryPoolResults-device-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryPool-parameter" href="chap17.html#VUID-vkGetQueryPoolResults-queryPool-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-pData-parameter" href="chap17.html#VUID-vkGetQueryPoolResults-pData-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-pData-parameter</span><br>
 <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-flags-parameter" href="chap17.html#VUID-vkGetQueryPoolResults-flags-parameter"></a> <span class="vuid">VUID-vkGetQueryPoolResults-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap17.html#VkQueryResultFlagBits">VkQueryResultFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-dataSize-arraylength" href="chap17.html#VUID-vkGetQueryPoolResults-dataSize-arraylength"></a> <span class="vuid">VUID-vkGetQueryPoolResults-dataSize-arraylength</span><br>
 <code>dataSize</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkGetQueryPoolResults-queryPool-parent" href="chap17.html#VUID-vkGetQueryPoolResults-queryPool-parent"></a> <span class="vuid">VUID-vkGetQueryPoolResults-queryPool-parent</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_NOT_READY</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="chap17.html#vkGetQueryPoolResults">vkGetQueryPoolResults</a>::<code>flags</code> and
<a href="chap17.html#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>::<code>flags</code>, specifying how and when
results are returned, are:</p>
</div>
<div id="VkQueryResultFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkQueryResultFlagBits</span> <span class="p">{</span>
    <span class="n">VK_QUERY_RESULT_64_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_QUERY_RESULT_WAIT_BIT</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_QUERY_RESULT_PARTIAL_BIT</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
  <span class="c1">// Provided by VK_KHR_video_queue</span>
    <span class="n">VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkQueryResultFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_RESULT_64_BIT</code> specifies the results will be written as an
array of 64-bit unsigned integer values.
If this bit is not set, the results will be written as an array of
32-bit unsigned integer values.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_WAIT_BIT</code> specifies that Vulkan will wait for each
query’s status to become available before retrieving its results.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> specifies that the
availability status accompanies the results.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_PARTIAL_BIT</code> specifies that returning partial
results is acceptable.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> specifies that the last value
returned in the query is a <a href="chap17.html#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> value.
See <a href="chap17.html#queries-result-status-only">result status query</a> for information
on how an application can determine whether the use of this flag bit is
supported.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryResultFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkQueryResultFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryResultFlags</code> is a bitmask type for setting a mask of zero or
more <a href="chap17.html#VkQueryResultFlagBits">VkQueryResultFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Specific status codes that <strong class="purple">can</strong> be returned from a query are:</p>
</div>
<div id="VkQueryResultStatusKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_video_queue</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkQueryResultStatusKHR</span> <span class="p">{</span>
    <span class="n">VK_QUERY_RESULT_STATUS_ERROR_KHR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">VK_QUERY_RESULT_STATUS_NOT_READY_KHR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">VK_QUERY_RESULT_STATUS_COMPLETE_KHR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkQueryResultStatusKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_RESULT_STATUS_NOT_READY_KHR</code> specifies that the query
result is not yet available.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_STATUS_ERROR_KHR</code> specifies that operations did not
complete successfully.</p>
</li>
<li>
<p><code>VK_QUERY_RESULT_STATUS_COMPLETE_KHR</code> specifies that operations
completed successfully and the query result is available.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy query statuses and numerical results directly to buffer memory,
call:</p>
</div>
<div id="vkCmdCopyQueryPoolResults" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdCopyQueryPoolResults</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">firstQuery</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">queryCount</span><span class="p">,</span>
    <span class="n">VkBuffer</span>                                    <span class="n">dstBuffer</span><span class="p">,</span>
    <span class="n">VkDeviceSize</span>                                <span class="n">dstOffset</span><span class="p">,</span>
    <span class="n">VkDeviceSize</span>                                <span class="n">stride</span><span class="p">,</span>
    <span class="n">VkQueryResultFlags</span>                          <span class="n">flags</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which this command will
be recorded.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool managing the queries containing the
desired results.</p>
</li>
<li>
<p><code>firstQuery</code> is the initial query index.</p>
</li>
<li>
<p><code>queryCount</code> is the number of queries.
<code>firstQuery</code> and <code>queryCount</code> together define a range of
queries.</p>
</li>
<li>
<p><code>dstBuffer</code> is a <a href="chap12.html#VkBuffer">VkBuffer</a> object that will receive the results
of the copy command.</p>
</li>
<li>
<p><code>dstOffset</code> is an offset into <code>dstBuffer</code>.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>dstBuffer</code>.
The required size of the backing memory for <code>dstBuffer</code> is
determined as described above for <a href="chap17.html#vkGetQueryPoolResults">vkGetQueryPoolResults</a>.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap17.html#VkQueryResultFlagBits">VkQueryResultFlagBits</a> specifying how
and when results are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any results written for a query are written according to
<a href="chap17.html#queries-operation-memorylayout">a layout dependent on the query type</a>.</p>
</div>
<div class="paragraph">
<p>Results for any query in <code>queryPool</code> identified by <code>firstQuery</code> and
<code>queryCount</code> that is available are copied to <code>dstBuffer</code>.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code> is set, results for all
queries in <code>queryPool</code> identified by <code>firstQuery</code> and
<code>queryCount</code> are copied to <code>dstBuffer</code>, along with an extra
availability value written directly after the results of each query and
interpreted as an unsigned integer.
A value of zero indicates that the results are not yet available, otherwise
the query is complete and results are available.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code> is set, results for all queries
in <code>queryPool</code> identified by <code>firstQuery</code> and <code>queryCount</code> are
copied to <code>dstBuffer</code>, along with an extra status value written directly
after the results of each query and interpreted as a signed integer.
A value of zero indicates that the results are not yet available.
Positive values indicate that the operations within the query completed
successfully, and the query results are valid.
Negative values indicate that the operations within the query completed
unsuccessfully.</p>
</div>
<div class="paragraph">
<p><a href="chap17.html#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> defines specific meaning for values returned
here, though implementations are free to return other values.</p>
</div>
<div class="paragraph">
<p>Results for any available query written by this command are final and
represent the final result of the query.
If <code>VK_QUERY_RESULT_PARTIAL_BIT</code> is set, then for any query that is
unavailable, an intermediate result between zero and the final result value
is written for that query.
Otherwise, any result written by this command is undefined.</p>
</div>
<div class="paragraph">
<p>If <code>VK_QUERY_RESULT_64_BIT</code> is set, results and availability
or status
values for all queries are written as an array of 64-bit values.
If the <code>queryPool</code> was created with
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, results for each query are
written as an array of the type indicated by
<a href="chap5.html#VkPerformanceCounterKHR">VkPerformanceCounterKHR</a>::<code>storage</code> for the counter being queried.
Otherwise, results and availability
or status
values are written as an array of 32-bit values.
If an unsigned integer query’s value overflows the result type, the value
<strong class="purple">may</strong> either wrap or saturate.
If a signed integer query’s value overflows the result type, the value is
undefined.
If a floating point query’s value is not representable as the result type,
the value is undefined.</p>
</div>
<div class="paragraph">
<p>This command defines an execution dependency between other query commands
that reference the same query.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
If <code>flags</code> does not include <code>VK_QUERY_RESULT_WAIT_BIT</code>,
<a href="chap17.html#vkCmdWriteTimestamp2KHR">vkCmdWriteTimestamp2KHR</a>,
<a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a>, and <a href="chap17.html#vkCmdWriteTimestamp">vkCmdWriteTimestamp</a> are excluded from this
scope.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands which reference the queries in <code>queryPool</code>
indicated by <code>query</code> that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The operation of this command happens after the first scope and happens
before the second scope.</p>
</div>
<div class="paragraph">
<p><code>vkCmdCopyQueryPoolResults</code> is considered to be a transfer operation,
and its writes to buffer memory <strong class="purple">must</strong> be synchronized using
<code>VK_PIPELINE_STAGE_TRANSFER_BIT</code> and <code>VK_ACCESS_TRANSFER_WRITE_BIT</code>
before using the results.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstOffset-00819" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-dstOffset-00819"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstOffset-00819</span><br>

<code>dstOffset</code> <strong class="purple">must</strong> be less than the size of <code>dstBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-firstQuery-00820" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-firstQuery-00820"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-firstQuery-00820</span><br>

<code>firstQuery</code> <strong class="purple">must</strong> be less than the number of queries in
<code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-firstQuery-00821" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-firstQuery-00821"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-firstQuery-00821</span><br>

The sum of <code>firstQuery</code> and <code>queryCount</code> <strong class="purple">must</strong> be less than or
equal to the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-00822" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-flags-00822"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-00822</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is not set in <code>flags</code> then
<code>dstOffset</code> and <code>stride</code> <strong class="purple">must</strong> be multiples of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-00823" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-flags-00823"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-00823</span><br>

If <code>VK_QUERY_RESULT_64_BIT</code> is set in <code>flags</code> then
<code>dstOffset</code> and <code>stride</code> <strong class="purple">must</strong> be multiples of <code>8</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-00824" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-dstBuffer-00824"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-00824</span><br>

<code>dstBuffer</code> <strong class="purple">must</strong> have enough storage, from <code>dstOffset</code>, to
contain the result of each query, as described
<a href="chap17.html#queries-operation-memorylayout">here</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-00825" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-dstBuffer-00825"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-00825</span><br>

<code>dstBuffer</code> <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_TRANSFER_DST_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-00826" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-dstBuffer-00826"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-00826</span><br>

If <code>dstBuffer</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-00827" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-queryType-00827"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-00827</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_TIMESTAMP</code>, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_QUERY_RESULT_PARTIAL_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-03232" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-queryType-03232"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-03232</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>,
<a href="chap38.html#VkPhysicalDevicePerformanceQueryPropertiesKHR">VkPhysicalDevicePerformanceQueryPropertiesKHR</a>::<code>allowCommandBufferQueryCopies</code>
<strong class="purple">must</strong> be <code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-03233" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-queryType-03233"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-03233</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, <code>flags</code> <strong class="purple">must</strong> not contain
<code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code>,
<code>VK_QUERY_RESULT_PARTIAL_BIT</code> or <code>VK_QUERY_RESULT_64_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-03234" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-queryType-03234"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-03234</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_PERFORMANCE_QUERY_KHR</code>, the <code>queryPool</code> <strong class="purple">must</strong>
have been submitted once for each pass as retrieved via a call to
<a href="chap17.html#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryType-06901" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-queryType-06901"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryType-06901</span><br>

If the <code>queryType</code> used to create <code>queryPool</code> was
<code>VK_QUERY_TYPE_RESULT_STATUS_ONLY_KHR</code>, then <code>flags</code> <strong class="purple">must</strong>
include <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-06902" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-flags-06902"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-06902</span><br>

If <code>flags</code> includes <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>, then
it <strong class="purple">must</strong> not include <code>VK_QUERY_RESULT_WITH_AVAILABILITY_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-None-07429" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-None-07429"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-None-07429</span><br>

All queries used by the command <strong class="purple">must</strong> not be active</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commandBuffer-parameter" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-queryPool-parameter" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-dstBuffer-parameter" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-dstBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-dstBuffer-parameter</span><br>
 <code>dstBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-flags-parameter" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-flags-parameter"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap17.html#VkQueryResultFlagBits">VkQueryResultFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commandBuffer-recording" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commandBuffer-cmdpool" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-renderpass" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-renderpass"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-videocoding" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-videocoding"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-videocoding</span><br>
 This command <strong class="purple">must</strong> only be called outside of a video coding scope</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyQueryPoolResults-commonparent" href="chap17.html#VUID-vkCmdCopyQueryPoolResults-commonparent"></a> <span class="vuid">VUID-vkCmdCopyQueryPoolResults-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>dstBuffer</code>, and <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="queries-operation-undefined" class="paragraph">
<p>Rendering operations such as clears, MSAA resolves, attachment load/store
operations, and blits <strong class="purple">may</strong> count towards the results of queries.
This behavior is implementation-dependent and <strong class="purple">may</strong> vary depending on the
path used within an implementation.
For example, some implementations have several types of clears, some of
which <strong class="purple">may</strong> include vertices and some not.</p>
</div>
</div>
<div class="sect2">
<h3 id="queries-occlusion"><a class="anchor" href="chap17.html#queries-occlusion"></a>17.3. Occlusion Queries</h3>
<div class="paragraph">
<p>Occlusion queries track the number of samples that pass the per-fragment
tests for a set of drawing commands.
As such, occlusion queries are only available on queue families supporting
graphics operations.
The application <strong class="purple">can</strong> then use these results to inform future rendering
decisions.
An occlusion query is begun and ended by calling <code>vkCmdBeginQuery</code> and
<code>vkCmdEndQuery</code>, respectively.
When an occlusion query begins, the count of passing samples always starts
at zero.
For each drawing command, the count is incremented as described in
<a href="chap26.html#fragops-samplecount">Sample Counting</a>.
If <code>flags</code> does not contain <code>VK_QUERY_CONTROL_PRECISE_BIT</code> an
implementation <strong class="purple">may</strong> generate any non-zero result value for the query if the
count of passing samples is non-zero.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Not setting <code>VK_QUERY_CONTROL_PRECISE_BIT</code> mode <strong class="purple">may</strong> be more efficient
on some implementations, and <strong class="purple">should</strong> be used where it is sufficient to know
a boolean result on whether any samples passed the per-fragment tests.
In this case, some implementations <strong class="purple">may</strong> only return zero or one, indifferent
to the actual number of samples passing the per-fragment tests.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When an occlusion query finishes, the result for that query is marked as
available.
The application <strong class="purple">can</strong> then either copy the result to a buffer (via
<code>vkCmdCopyQueryPoolResults</code>) or request it be put into host memory (via
<code>vkGetQueryPoolResults</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If occluding geometry is not drawn first, samples <strong class="purple">can</strong> pass the depth test,
but still not be visible in a final image.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="queries-pipestats"><a class="anchor" href="chap17.html#queries-pipestats"></a>17.4. Pipeline Statistics Queries</h3>
<div class="paragraph">
<p>Pipeline statistics queries allow the application to sample a specified set
of <code>VkPipeline</code> counters.
These counters are accumulated by Vulkan for a set of either drawing or
dispatching commands while a pipeline statistics query is active.
As such, pipeline statistics queries are available on queue families
supporting either graphics or compute operations.
The availability of pipeline statistics queries is indicated by the
<code>pipelineStatisticsQuery</code> member of the <code>VkPhysicalDeviceFeatures</code>
object (see <code>vkGetPhysicalDeviceFeatures</code> and <code>vkCreateDevice</code> for
detecting and requesting this query type on a <code>VkDevice</code>).</p>
</div>
<div class="paragraph">
<p>A pipeline statistics query is begun and ended by calling
<code>vkCmdBeginQuery</code> and <code>vkCmdEndQuery</code>, respectively.
When a pipeline statistics query begins, all statistics counters are set to
zero.
While the query is active, the pipeline type determines which set of
statistics are available, but these <strong class="purple">must</strong> be configured on the query pool
when it is created.
If a statistic counter is issued on a command buffer that does not support
the corresponding operation, the value of that counter is undefined after
the query has been made available.
At least one statistic counter relevant to the operations supported on the
recording command buffer <strong class="purple">must</strong> be enabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in
<a href="chap17.html#VkQueryPoolCreateInfo">VkQueryPoolCreateInfo</a>::<code>pipelineStatistics</code> for query pools and in
<a href="chap6.html#VkCommandBufferInheritanceInfo">VkCommandBufferInheritanceInfo</a>::<code>pipelineStatistics</code> for secondary
command buffers, individually enabling pipeline statistics counters, are:</p>
</div>
<div id="VkQueryPipelineStatisticFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkQueryPipelineStatisticFlagBits</span> <span class="p">{</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_VERTICES_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_PRIMITIVES_BIT</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_VERTEX_SHADER_INVOCATIONS_BIT</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_INVOCATIONS_BIT</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_PRIMITIVES_BIT</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_CLIPPING_INVOCATIONS_BIT</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_CLIPPING_PRIMITIVES_BIT</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_FRAGMENT_SHADER_INVOCATIONS_BIT</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_CONTROL_SHADER_PATCHES_BIT</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_EVALUATION_SHADER_INVOCATIONS_BIT</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
    <span class="n">VK_QUERY_PIPELINE_STATISTIC_COMPUTE_SHADER_INVOCATIONS_BIT</span> <span class="o">=</span> <span class="mh">0x00000400</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkQueryPipelineStatisticFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_VERTICES_BIT</code> specifies
that queries managed by the pool will count the number of vertices
processed by the <a href="chap20.html">input assembly</a> stage.
Vertices corresponding to incomplete primitives <strong class="purple">may</strong> contribute to the
count.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_INPUT_ASSEMBLY_PRIMITIVES_BIT</code>
specifies that queries managed by the pool will count the number of
primitives processed by the <a href="chap20.html">input assembly</a> stage.
If primitive restart is enabled, restarting the primitive topology has
no effect on the count.
Incomplete primitives <strong class="purple">may</strong> be counted.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_VERTEX_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
vertex shader invocations.
This counter’s value is incremented each time a vertex shader is
<a href="chap9.html#shaders-vertex-execution">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
geometry shader invocations.
This counter’s value is incremented each time a geometry shader is
<a href="chap9.html#shaders-geometry-execution">invoked</a>.
In the case of <a href="chap23.html#geometry-invocations">instanced geometry shaders</a>, the
geometry shader invocations count is incremented for each separate
instanced invocation.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_GEOMETRY_SHADER_PRIMITIVES_BIT</code>
specifies that queries managed by the pool will count the number of
primitives generated by geometry shader invocations.
The counter’s value is incremented each time the geometry shader emits a
primitive.
Restarting primitive topology using the SPIR-V instructions
<code>OpEndPrimitive</code> or <code>OpEndStreamPrimitive</code> has no effect on the
geometry shader output primitives count.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_CLIPPING_INVOCATIONS_BIT</code> specifies
that queries managed by the pool will count the number of primitives
processed by the <a href="chap24.html#vertexpostproc-clipping">Primitive Clipping</a> stage of
the pipeline.
The counter’s value is incremented each time a primitive reaches the
primitive clipping stage.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_CLIPPING_PRIMITIVES_BIT</code> specifies that
queries managed by the pool will count the number of primitives output
by the <a href="chap24.html#vertexpostproc-clipping">Primitive Clipping</a> stage of the
pipeline.
The counter’s value is incremented each time a primitive passes the
primitive clipping stage.
The actual number of primitives output by the primitive clipping stage
for a particular input primitive is implementation-dependent but <strong class="purple">must</strong>
satisfy the following conditions:</p>
<div class="ulist">
<ul>
<li>
<p>If at least one vertex of the input primitive lies inside the clipping
volume, the counter is incremented by one or more.</p>
</li>
<li>
<p>Otherwise, the counter is incremented by zero or more.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_FRAGMENT_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
fragment shader invocations.
The counter’s value is incremented each time the fragment shader is
<a href="chap26.html#fragops-shader">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_CONTROL_SHADER_PATCHES_BIT</code>
specifies that queries managed by the pool will count the number of
patches processed by the tessellation control shader.
The counter’s value is incremented once for each patch for which a
tessellation control shader is
<a href="chap9.html#shaders-tessellation-control-execution">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_TESSELLATION_EVALUATION_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
invocations of the tessellation evaluation shader.
The counter’s value is incremented each time the tessellation evaluation
shader is <a href="chap9.html#shaders-tessellation-evaluation-execution">invoked</a>.</p>
</li>
<li>
<p><code>VK_QUERY_PIPELINE_STATISTIC_COMPUTE_SHADER_INVOCATIONS_BIT</code>
specifies that queries managed by the pool will count the number of
compute shader invocations.
The counter’s value is incremented every time the compute shader is
invoked.
Implementations <strong class="purple">may</strong> skip the execution of certain compute shader
invocations or execute additional compute shader invocations for
implementation-dependent reasons as long as the results of rendering
otherwise remain unchanged.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These values are intended to measure relative statistics on one
implementation.
Various device architectures will count these values differently.
Any or all counters <strong class="purple">may</strong> be affected by the issues described in
<a href="chap17.html#queries-operation-undefined">Query Operation</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>For example, tile-based rendering devices <strong class="purple">may</strong> need to replay the scene
multiple times, affecting some of the counts.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If a pipeline has <code>rasterizerDiscardEnable</code> enabled, implementations
<strong class="purple">may</strong> discard primitives after the final
<a href="chap10.html#pipelines-graphics-subsets-pre-rasterization">pre-rasterization shader
stage</a>.
As a result, if <code>rasterizerDiscardEnable</code> is enabled, the clipping input
and output primitives counters <strong class="purple">may</strong> not be incremented.</p>
</div>
<div class="paragraph">
<p>When a pipeline statistics query finishes, the result for that query is
marked as available.
The application <strong class="purple">can</strong> copy the result to a buffer (via
<code>vkCmdCopyQueryPoolResults</code>), or request it be put into host memory (via
<code>vkGetQueryPoolResults</code>).</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkQueryPipelineStatisticFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkQueryPipelineStatisticFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkQueryPipelineStatisticFlags</code> is a bitmask type for setting a mask of
zero or more <a href="chap17.html#VkQueryPipelineStatisticFlagBits">VkQueryPipelineStatisticFlagBits</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="queries-timestamps"><a class="anchor" href="chap17.html#queries-timestamps"></a>17.5. Timestamp Queries</h3>
<div class="paragraph">
<p><em>Timestamps</em> provide applications with a mechanism for timing the execution
of commands.
A timestamp is an integer value generated by the <code>VkPhysicalDevice</code>.
Unlike other queries, timestamps do not operate over a range, and so do not
use <a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a> or <a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a>.
The mechanism is built around a set of commands that allow the application
to tell the <code>VkPhysicalDevice</code> to write timestamp values to a
<a href="chap17.html#queries-pools">query pool</a> and then either read timestamp values on the
host (using <a href="chap17.html#vkGetQueryPoolResults">vkGetQueryPoolResults</a>) or copy timestamp values to a
<code>VkBuffer</code> (using <a href="chap17.html#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a>).
The application <strong class="purple">can</strong> then compute differences between timestamps to
determine execution time.</p>
</div>
<div class="paragraph">
<p>The number of valid bits in a timestamp value is determined by the
<code>VkQueueFamilyProperties</code>::<code>timestampValidBits</code> property of the
queue on which the timestamp is written.
Timestamps are supported on any queue which reports a non-zero value for
<code>timestampValidBits</code> via <a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties">vkGetPhysicalDeviceQueueFamilyProperties</a>.
If the <a href="chap38.html#limits-timestampComputeAndGraphics"><code>timestampComputeAndGraphics</code></a> limit is <code>VK_TRUE</code>, timestamps are
supported by every queue family that supports either graphics or compute
operations (see <a href="chap5.html#VkQueueFamilyProperties">VkQueueFamilyProperties</a>).</p>
</div>
<div class="paragraph">
<p>The number of nanoseconds it takes for a timestamp value to be incremented
by 1 <strong class="purple">can</strong> be obtained from
<code>VkPhysicalDeviceLimits</code>::<code>timestampPeriod</code> after a call to
<code>vkGetPhysicalDeviceProperties</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To request a timestamp and write the value to memory, call:</p>
</div>
<div id="vkCmdWriteTimestamp2KHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_synchronization2</span>
<span class="kt">void</span> <span class="nf">vkCmdWriteTimestamp2KHR</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags2</span>                       <span class="n">stage</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">query</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>stage</code> specifies a stage of the pipeline.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the timestamp.</p>
</li>
<li>
<p><code>query</code> is the query within the query pool that will contain the
timestamp.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWriteTimestamp2KHR</code> is submitted to a queue, it defines an
execution dependency on commands that were submitted before it, and writes a
timestamp to a query pool.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations on the pipeline stage
specified by <code>stage</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the timestamp write operation.</p>
</div>
<div class="paragraph">
<p>When the timestamp value is written, the availability status of the query is
set to available.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If an implementation is unable to detect completion and latch the timer
immediately after <code>stage</code> has completed, it <strong class="purple">may</strong> instead do so at any
logically later stage.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Comparisons between timestamps are not meaningful if the timestamps are
written by commands submitted to different queues.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>An example of such a comparison is subtracting an older timestamp from a
newer one to determine the execution time of a sequence of commands.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If <code>vkCmdWriteTimestamp2KHR</code> is called while executing a render pass
instance that has multiview enabled, the timestamp uses <span class="eq">N</span> consecutive
query indices in the query pool (starting at <code>query</code>) where <span class="eq">N</span> is
the number of bits set in the view mask of the subpass the command is
executed in.
The resulting query values are determined by an implementation-dependent
choice of one of the following behaviors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first query is a timestamp value and (if more than one bit is set in
the view mask) zero is written to the remaining queries.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the difference
between the first query written by each command.</p>
</li>
<li>
<p>All <span class="eq">N</span> queries are timestamp values.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the sum of the
difference between corresponding queries written by each command.
The difference between corresponding queries <strong class="purple">may</strong> be the execution time
of a single view.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In either case, the application <strong class="purple">can</strong> sum the differences between all <span class="eq">N</span>
queries to determine the total execution time.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03929" href="chap17.html#VUID-vkCmdWriteTimestamp2-stage-03929"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03929</span><br>

If the <a href="chap37.html#features-geometryShader"><code>geometryShader</code></a> feature is not
enabled, <code>stage</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_2_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03930" href="chap17.html#VUID-vkCmdWriteTimestamp2-stage-03930"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03930</span><br>

If the <a href="chap37.html#features-tessellationShader"><code>tessellationShader</code></a> feature
is not enabled, <code>stage</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_2_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_2_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-07317" href="chap17.html#VUID-vkCmdWriteTimestamp2-stage-07317"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-07317</span><br>

If the <a href="chap37.html#features-attachmentFragmentShadingRate"><code>attachmentFragmentShadingRate</code></a> feature is not enabled,
<code>stage</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_2_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-synchronization2-03858" href="chap17.html#VUID-vkCmdWriteTimestamp2-synchronization2-03858"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-synchronization2-03858</span><br>

The <a href="chap37.html#features-synchronization2"><code>synchronization2</code></a> feature <strong class="purple">must</strong>
be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03859" href="chap17.html#VUID-vkCmdWriteTimestamp2-stage-03859"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03859</span><br>

<code>stage</code> <strong class="purple">must</strong> only include a single pipeline stage</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-03860" href="chap17.html#VUID-vkCmdWriteTimestamp2-stage-03860"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-03860</span><br>

<code>stage</code> <strong class="purple">must</strong> only include stages valid for the queue family that
was used to create the command pool that <code>commandBuffer</code> was
allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-queryPool-03861" href="chap17.html#VUID-vkCmdWriteTimestamp2-queryPool-03861"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-queryPool-03861</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-queryPool-03862" href="chap17.html#VUID-vkCmdWriteTimestamp2-queryPool-03862"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-queryPool-03862</span><br>

The query identified by <code>queryPool</code> and <code>query</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-timestampValidBits-03863" href="chap17.html#VUID-vkCmdWriteTimestamp2-timestampValidBits-03863"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-timestampValidBits-03863</span><br>

The command pool’s queue family <strong class="purple">must</strong> support a non-zero
<code>timestampValidBits</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-query-04903" href="chap17.html#VUID-vkCmdWriteTimestamp2-query-04903"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-query-04903</span><br>

<code>query</code> <strong class="purple">must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-None-03864" href="chap17.html#VUID-vkCmdWriteTimestamp2-None-03864"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-None-03864</span><br>

All queries used by the command <strong class="purple">must</strong> be unavailable</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-query-03865" href="chap17.html#VUID-vkCmdWriteTimestamp2-query-03865"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-query-03865</span><br>

If <code>vkCmdWriteTimestamp2KHR</code> is called within a render pass instance,
the sum of <code>query</code> and the number of bits set in the current
subpass’s view mask <strong class="purple">must</strong> be less than or equal to the number of queries
in <code>queryPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commandBuffer-parameter" href="chap17.html#VUID-vkCmdWriteTimestamp2-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-stage-parameter" href="chap17.html#VUID-vkCmdWriteTimestamp2-stage-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-stage-parameter</span><br>
 <code>stage</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits2">VkPipelineStageFlagBits2</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-queryPool-parameter" href="chap17.html#VUID-vkCmdWriteTimestamp2-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commandBuffer-recording" href="chap17.html#VUID-vkCmdWriteTimestamp2-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commandBuffer-cmdpool" href="chap17.html#VUID-vkCmdWriteTimestamp2-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support transfer, graphics, compute, decode, or encode operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp2-commonparent" href="chap17.html#VUID-vkCmdWriteTimestamp2-commonparent"></a> <span class="vuid">VUID-vkCmdWriteTimestamp2-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute<br>
Decode<br>
Encode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To request a timestamp and write the value to memory, call:</p>
</div>
<div id="vkCmdWriteTimestamp" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdWriteTimestamp</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlagBits</span>                     <span class="n">pipelineStage</span><span class="p">,</span>
    <span class="n">VkQueryPool</span>                                 <span class="n">queryPool</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">query</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pipelineStage</code> is a <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> value, specifying
a stage of the pipeline.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the timestamp.</p>
</li>
<li>
<p><code>query</code> is the query within the query pool that will contain the
timestamp.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWriteTimestamp</code> is submitted to a queue, it defines an
execution dependency on commands that were submitted before it, and writes a
timestamp to a query pool.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations on the pipeline stage
specified by <code>pipelineStage</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the timestamp write operation.</p>
</div>
<div class="paragraph">
<p>When the timestamp value is written, the availability status of the query is
set to available.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If an implementation is unable to detect completion and latch the timer
immediately after <code>stage</code> has completed, it <strong class="purple">may</strong> instead do so at any
logically later stage.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Comparisons between timestamps are not meaningful if the timestamps are
written by commands submitted to different queues.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>An example of such a comparison is subtracting an older timestamp from a
newer one to determine the execution time of a sequence of commands.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If <code>vkCmdWriteTimestamp</code> is called while executing a render pass
instance that has multiview enabled, the timestamp uses <span class="eq">N</span> consecutive
query indices in the query pool (starting at <code>query</code>) where <span class="eq">N</span> is
the number of bits set in the view mask of the subpass the command is
executed in.
The resulting query values are determined by an implementation-dependent
choice of one of the following behaviors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first query is a timestamp value and (if more than one bit is set in
the view mask) zero is written to the remaining queries.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the difference
between the first query written by each command.</p>
</li>
<li>
<p>All <span class="eq">N</span> queries are timestamp values.
If two timestamps are written in the same subpass, the sum of the
execution time of all views between those commands is the sum of the
difference between corresponding queries written by each command.
The difference between corresponding queries <strong class="purple">may</strong> be the execution time
of a single view.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In either case, the application <strong class="purple">can</strong> sum the differences between all <span class="eq">N</span>
queries to determine the total execution time.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04074" href="chap17.html#VUID-vkCmdWriteTimestamp-pipelineStage-04074"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04074</span><br>

<code>pipelineStage</code> <strong class="purple">must</strong> be a
<a href="chap7.html#synchronization-pipeline-stages-supported">valid stage</a> for the queue
family that was used to create the command pool that <code>commandBuffer</code>
was allocated from</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04075" href="chap17.html#VUID-vkCmdWriteTimestamp-pipelineStage-04075"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04075</span><br>

If the <a href="chap37.html#features-geometryShader"><code>geometryShader</code></a> feature is not
enabled, <code>pipelineStage</code> <strong class="purple">must</strong> not be
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-04076" href="chap17.html#VUID-vkCmdWriteTimestamp-pipelineStage-04076"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-04076</span><br>

If the <a href="chap37.html#features-tessellationShader"><code>tessellationShader</code></a> feature
is not enabled, <code>pipelineStage</code> <strong class="purple">must</strong> not be
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-fragmentShadingRate-07315" href="chap17.html#VUID-vkCmdWriteTimestamp-fragmentShadingRate-07315"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-fragmentShadingRate-07315</span><br>

If the <a href="chap37.html#features-attachmentFragmentShadingRate"><code>attachmentFragmentShadingRate</code></a> feature is not enabled,
<code>pipelineStage</code> <strong class="purple">must</strong> not be
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADING_RATE_ATTACHMENT_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-synchronization2-06489" href="chap17.html#VUID-vkCmdWriteTimestamp-synchronization2-06489"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-synchronization2-06489</span><br>

If the <a href="chap37.html#features-synchronization2"><code>synchronization2</code></a> feature is
not enabled, <code>pipelineStage</code> <strong class="purple">must</strong> not be
<code>VK_PIPELINE_STAGE_NONE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-queryPool-01416" href="chap17.html#VUID-vkCmdWriteTimestamp-queryPool-01416"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-queryPool-01416</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> of
<code>VK_QUERY_TYPE_TIMESTAMP</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-queryPool-00828" href="chap17.html#VUID-vkCmdWriteTimestamp-queryPool-00828"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-queryPool-00828</span><br>

The query identified by <code>queryPool</code> and <code>query</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-timestampValidBits-00829" href="chap17.html#VUID-vkCmdWriteTimestamp-timestampValidBits-00829"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-timestampValidBits-00829</span><br>

The command pool’s queue family <strong class="purple">must</strong> support a non-zero
<code>timestampValidBits</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-query-04904" href="chap17.html#VUID-vkCmdWriteTimestamp-query-04904"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-query-04904</span><br>

<code>query</code> <strong class="purple">must</strong> be less than the number of queries in <code>queryPool</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-None-00830" href="chap17.html#VUID-vkCmdWriteTimestamp-None-00830"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-None-00830</span><br>

All queries used by the command <strong class="purple">must</strong> be unavailable</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-query-00831" href="chap17.html#VUID-vkCmdWriteTimestamp-query-00831"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-query-00831</span><br>

If <code>vkCmdWriteTimestamp</code> is called within a render pass instance,
the sum of <code>query</code> and the number of bits set in the current
subpass’s view mask <strong class="purple">must</strong> be less than or equal to the number of queries
in <code>queryPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commandBuffer-parameter" href="chap17.html#VUID-vkCmdWriteTimestamp-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-pipelineStage-parameter" href="chap17.html#VUID-vkCmdWriteTimestamp-pipelineStage-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-pipelineStage-parameter</span><br>
 <code>pipelineStage</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-queryPool-parameter" href="chap17.html#VUID-vkCmdWriteTimestamp-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commandBuffer-recording" href="chap17.html#VUID-vkCmdWriteTimestamp-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commandBuffer-cmdpool" href="chap17.html#VUID-vkCmdWriteTimestamp-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support transfer, graphics, compute, decode, encode, or opticalflow operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteTimestamp-commonparent" href="chap17.html#VUID-vkCmdWriteTimestamp-commonparent"></a> <span class="vuid">VUID-vkCmdWriteTimestamp-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>queryPool</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap35.html#vkCmdBeginVideoCodingKHR">Video Coding Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap3.html#fundamentals-queueoperation-command-types">Command Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute<br>
Decode<br>
Encode<br>
Opticalflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="queries-performance"><a class="anchor" href="chap17.html#queries-performance"></a>17.6. Performance Queries</h3>
<div class="paragraph">
<p><em>Performance queries</em> provide applications with a mechanism for getting
performance counter information about the execution of command buffers,
render passes, and commands.</p>
</div>
<div class="paragraph">
<p>Each queue family advertises the performance counters that <strong class="purple">can</strong> be queried
on a queue of that family via a call to
<a href="chap5.html#vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR">vkEnumeratePhysicalDeviceQueueFamilyPerformanceQueryCountersKHR</a>.
Implementations <strong class="purple">may</strong> limit access to performance counters based on platform
requirements or only to specialized drivers for development purposes.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This may include no performance counters being enumerated, or a reduced set.
Please refer to platform-specific documentation for guidance on any such
restrictions.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Performance queries use the existing <a href="chap17.html#vkCmdBeginQuery">vkCmdBeginQuery</a> and
<a href="chap17.html#vkCmdEndQuery">vkCmdEndQuery</a> to control what command buffers, render passes, or
commands to get performance information for.</p>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> require multiple passes where the command buffer,
render passes, or commands being recorded are the same and are executed on
the same queue to record performance counter data.
This is achieved by submitting the same batch and providing a
<a href="chap6.html#VkPerformanceQuerySubmitInfoKHR">VkPerformanceQuerySubmitInfoKHR</a> structure containing a counter pass
index.
The number of passes required for a given performance query pool <strong class="purple">can</strong> be
queried via a call to
<a href="chap17.html#vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR">vkGetPhysicalDeviceQueueFamilyPerformanceQueryPassesKHR</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Command buffers created with
<code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> <strong class="purple">must</strong> not be re-submitted.
Changing command buffer usage bits <strong class="purple">may</strong> affect performance.
To avoid this, the application <strong class="purple">should</strong> re-record any command buffers with
the <code>VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT</code> when multiple counter
passes are required.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Performance counter results from a performance query pool <strong class="purple">can</strong> be obtained
with the command <a href="chap17.html#vkGetQueryPoolResults">vkGetQueryPoolResults</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPerformanceCounterResultKHR</code> union is defined as:</p>
</div>
<div id="VkPerformanceCounterResultKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="n">VkPerformanceCounterResultKHR</span> <span class="p">{</span>
    <span class="kt">int32_t</span>     <span class="n">int32</span><span class="p">;</span>
    <span class="kt">int64_t</span>     <span class="n">int64</span><span class="p">;</span>
    <span class="kt">uint32_t</span>    <span class="n">uint32</span><span class="p">;</span>
    <span class="kt">uint64_t</span>    <span class="n">uint64</span><span class="p">;</span>
    <span class="kt">float</span>       <span class="n">float32</span><span class="p">;</span>
    <span class="kt">double</span>      <span class="n">float64</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkPerformanceCounterResultKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>int32</code> is a 32-bit signed integer value.</p>
</li>
<li>
<p><code>int64</code> is a 64-bit signed integer value.</p>
</li>
<li>
<p><code>uint32</code> is a 32-bit unsigned integer value.</p>
</li>
<li>
<p><code>uint64</code> is a 64-bit unsigned integer value.</p>
</li>
<li>
<p><code>float32</code> is a 32-bit floating-point value.</p>
</li>
<li>
<p><code>float64</code> is a 64-bit floating-point value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Performance query results are returned in an array of
<code>VkPerformanceCounterResultKHR</code> unions containing the data associated
with each counter in the query, stored in the same order as the counters
supplied in <code>pCounterIndices</code> when creating the performance query.
The <a href="chap5.html#VkPerformanceCounterKHR">VkPerformanceCounterKHR</a>::<code>unit</code> enumeration specifies how to
parse the counter data.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="profiling-lock"><a class="anchor" href="chap17.html#profiling-lock"></a>17.6.1. Profiling Lock</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record and submit a command buffer containing a performance query pool
the profiling lock <strong class="purple">must</strong> be held.
The profiling lock <strong class="purple">must</strong> be acquired prior to any call to
<a href="chap6.html#vkBeginCommandBuffer">vkBeginCommandBuffer</a> that will be using a performance query pool.
The profiling lock <strong class="purple">must</strong> be held while any command buffer containing a
performance query pool is in the <em>recording</em>, <em>executable</em>, or <em>pending
state</em>.
To acquire the profiling lock, call:</p>
</div>
<div id="vkAcquireProfilingLockKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="n">VkResult</span> <span class="nf">vkAcquireProfilingLockKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAcquireProfilingLockInfoKHR</span><span class="o">*</span>        <span class="n">pInfo</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to profile.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <code>VkAcquireProfilingLockInfoKHR</code>
structure containing information about how the profiling is to be
acquired.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> allow multiple actors to hold the profiling lock
concurrently.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAcquireProfilingLockKHR-device-parameter" href="chap17.html#VUID-vkAcquireProfilingLockKHR-device-parameter"></a> <span class="vuid">VUID-vkAcquireProfilingLockKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkAcquireProfilingLockKHR-pInfo-parameter" href="chap17.html#VUID-vkAcquireProfilingLockKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkAcquireProfilingLockKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap17.html#VkAcquireProfilingLockInfoKHR">VkAcquireProfilingLockInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_TIMEOUT</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAcquireProfilingLockInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkAcquireProfilingLockInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkAcquireProfilingLockInfoKHR</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                   <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                       <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAcquireProfilingLockFlagsKHR</span>    <span class="n">flags</span><span class="p">;</span>
    <span class="kt">uint64_t</span>                          <span class="n">timeout</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkAcquireProfilingLockInfoKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>timeout</code> indicates how long the function waits, in nanoseconds, if
the profiling lock is not available.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAcquireProfilingLockInfoKHR-sType-sType" href="chap17.html#VUID-VkAcquireProfilingLockInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkAcquireProfilingLockInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACQUIRE_PROFILING_LOCK_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAcquireProfilingLockInfoKHR-pNext-pNext" href="chap17.html#VUID-VkAcquireProfilingLockInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAcquireProfilingLockInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAcquireProfilingLockInfoKHR-flags-zerobitmask" href="chap17.html#VUID-VkAcquireProfilingLockInfoKHR-flags-zerobitmask"></a> <span class="vuid">VUID-VkAcquireProfilingLockInfoKHR-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If <code>timeout</code> is 0, <code>vkAcquireProfilingLockKHR</code> will not block while
attempting to acquire the profiling lock.
If <code>timeout</code> is <code>UINT64_MAX</code>, the function will not return until the
profiling lock was acquired.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAcquireProfilingLockFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkAcquireProfilingLockFlagBitsKHR</span> <span class="p">{</span>
<span class="p">}</span> <span class="n">VkAcquireProfilingLockFlagBitsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAcquireProfilingLockFlagsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkAcquireProfilingLockFlagsKHR</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="chap17.html#VkAcquireProfilingLockFlagsKHR">VkAcquireProfilingLockFlagsKHR</a> is a bitmask type for setting a mask,
but is currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To release the profiling lock, call:</p>
</div>
<div id="vkReleaseProfilingLockKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_KHR_performance_query</span>
<span class="kt">void</span> <span class="nf">vkReleaseProfilingLockKHR</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to cease profiling on.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkReleaseProfilingLockKHR-device-03235" href="chap17.html#VUID-vkReleaseProfilingLockKHR-device-03235"></a> <span class="vuid">VUID-vkReleaseProfilingLockKHR-device-03235</span><br>

The profiling lock of <code>device</code> <strong class="purple">must</strong> have been held via a previous
successful call to <a href="chap17.html#vkAcquireProfilingLockKHR">vkAcquireProfilingLockKHR</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkReleaseProfilingLockKHR-device-parameter" href="chap17.html#VUID-vkReleaseProfilingLockKHR-device-parameter"></a> <span class="vuid">VUID-vkReleaseProfilingLockKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="queries-result-status-only"><a class="anchor" href="chap17.html#queries-result-status-only"></a>17.7. Result Status Queries</h3>
<div class="paragraph">
<p>Result status queries serve a single purpose: allowing the application to
determine whether a set of operations have completed successfully or not, as
indicated by the <a href="chap17.html#VkQueryResultStatusKHR">VkQueryResultStatusKHR</a> value written when retrieving
the result of a query using the <code>VK_QUERY_RESULT_WITH_STATUS_BIT_KHR</code>
flag.</p>
</div>
<div class="paragraph">
<p>Unlike other query types, result status queries do not track or maintain any
other data beyond the completion status, thus no other data is written when
retrieving their results.</p>
</div>
<div class="paragraph">
<p>Support for result status queries is indicated by
<a href="chap5.html#VkQueueFamilyQueryResultStatusPropertiesKHR">VkQueueFamilyQueryResultStatusPropertiesKHR</a>::<code>queryResultStatusSupport</code>
, as returned by <a href="chap5.html#vkGetPhysicalDeviceQueueFamilyProperties2">vkGetPhysicalDeviceQueueFamilyProperties2</a> for the
queue family in question.</p>
</div>
</div>
<div class="sect2">
<h3 id="queries-video-encode-bitstream-buffer-range"><a class="anchor" href="chap17.html#queries-video-encode-bitstream-buffer-range"></a>17.8. Video Encode Bitstream Buffer Range Queries</h3>
<div class="paragraph">
<p>Bitstream buffer range queries track the range of bytes written to the
bitstream buffer by a video coding operation.</p>
</div>
<div class="paragraph">
<p>When such a video coding operation is issued while a bitstream buffer range
query is active, two values are recorded for the query:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The offset into the bitstream buffer range used by the video encoding
operation where the bitstream data was written.
This offset is an additional offset from the start of the range
specified by the application.</p>
</li>
<li>
<p>The number of bytes written to the bitstream buffer.</p>
</li>
</ul>
</div>
</div>
</div>
</div></div>

<nav>
  <a rel="prev" href="chap16.html" class="nav nav-prev" title="Previous page" aria-label="Previous page" aria-keyshortcuts="Left">
        <i class="fa fa-angle-left"></i>
     </a>
  <a rel="next" href="chap18.html" class="nav nav-next" title="Next page" aria-label="Next page" aria-keyshortcuts="Right">
        <i class="fa fa-angle-right"></i>
     </a>
  <div style="clear: both"></div>
</nav>
<div id="footer">
<div id="footer-text">
Version 1.2.241<br>
Last updated 2023-02-16 01:34:18 -0800
</div>
</div>



</body>
  <script>
  function isInViewport(ele) {
    const rect = ele.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
    );
  }
  function yPosition (ele) {
    const rect = ele.getBoundingClientRect();
    return (rect.top - 20); // 20px above
  }
  let curr = document.getElementsByClassName('current');
  if (!isInViewport(curr[curr.length - 1])) {
    document.getElementById('toc').scrollTo({
      top: yPosition(curr[0]),
      left: 0,
      behavior: 'smooth'
    });
  }

  /* For page navigation */
  function gotoPage(selector) {
    const button = document.querySelector(selector);
    if (button)
      window.location.href = button.href;
  }
  document.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowRight':
        e.preventDefault();
        gotoPage('.nav-next');
        break;
      case 'ArrowLeft':
        e.preventDefault();
        gotoPage('.nav-prev');
        break;
    }
  });
  </script>
  </html>