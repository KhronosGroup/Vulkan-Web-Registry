<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="The Khronos® Vulkan Working Group">
<title>Vulkan® 1.0.93 - A Specification (with all registered Vulkan extensions)</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fff; color: #222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: black; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #0068b0; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Noto, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Noto, sans-serif; font-weight: normal; font-style: normal; color: black; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #4d4d4d; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #264357; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Noto, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #ddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #ddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #5e93b8; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #5e93b8; }

blockquote, blockquote p { line-height: 1.6; color: #333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #ddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: #fff; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: #eee; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f8; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; background-color: transparent; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.6; color: #264357; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #5e93b8; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #ddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Noto, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: black; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #fff; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #ddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 0 solid #ddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: black; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: black; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Noto, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddd; color: #5e93b8; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: black; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px hidden #666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eee; background-color: #264357; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: black; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #5e93b8; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #5e93b8; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: #eee; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.375em -0.75em; }

ul.inline > li { margin-left: 0.75em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px #fff; -webkit-box-shadow: 0 0 0 1px #ddd; box-shadow: 0 0 0 1px #ddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #29475c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #ddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eee; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<link rel="stylesheet" href="../katex/katex.min.css">
<script src="../katex/katex.min.js"></script>
<script src="../katex/contrib/auto-render.min.js"></script>
    <!-- Use KaTeX to render math once document is loaded, see
         https://github.com/Khan/KaTeX/tree/master/contrib/auto-render -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(
            document.body,
            {
                delimiters: [
                    { left: "$$", right: "$$", display: true},
                    { left: "\\[", right: "\\]", display: true},
                    { left: "$", right: "$", display: false},
                    { left: "\\(", right: "\\)", display: false}
                ]
            }
        );
    });
</script></head>
<body class="book toc2 toc-left" style="max-width: 100;">
<div id="header">
<h1>Vulkan<sup>®</sup> 1.0.93 - A Specification (with all registered Vulkan extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan Working Group</span><br>
<span id="revnumber">version 1.0.93,</span>
<span id="revdate">2018-11-18 11:11:27Z</span>
<br><span id="revremark">from git branch: github-master commit: 256a1ef66182b2d458148f2fdea183557ea3f507</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="chap1.html#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap1.html#introduction-conventions">1.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap2.html#fundamentals">2. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap2.html#fundamentals-host-environment">2.1. Host and Device Environment</a></li>
<li><a href="chap2.html#fundamentals-execmodel">2.2. Execution Model</a></li>
<li><a href="chap2.html#fundamentals-objectmodel-overview">2.3. Object Model</a></li>
<li><a href="chap2.html#fundamentals-abi">2.4. Application Binary Interface</a></li>
<li><a href="chap2.html#fundamentals-commandsyntax">2.5. Command Syntax and Duration</a></li>
<li><a href="chap2.html#fundamentals-threadingbehavior">2.6. Threading Behavior</a></li>
<li><a href="chap2.html#fundamentals-errors">2.7. Errors</a></li>
<li><a href="chap2.html#fundamentals-numerics">2.8. Numeric Representation and Computation</a></li>
<li><a href="chap2.html#fundamentals-fixedconv">2.9. Fixed-Point Data Conversions</a></li>
<li><a href="chap2.html#fundamentals-versionnum">2.10. API Version Numbers and Semantics</a></li>
<li><a href="chap2.html#fundamentals-common-objects">2.11. Common Object Types</a></li>
</ul>
</li>
<li><a href="chap3.html#initialization">3. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap3.html#initialization-functionpointers">3.1. Command Function Pointers</a></li>
<li><a href="chap3.html#initialization-instances">3.2. Instances</a></li>
</ul>
</li>
<li><a href="chap4.html#devsandqueues">4. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap4.html#devsandqueues-physical-device-enumeration">4.1. Physical Devices</a></li>
<li><a href="chap4.html#devsandqueues-devices">4.2. Devices</a></li>
<li><a href="chap4.html#devsandqueues-queues">4.3. Queues</a></li>
</ul>
</li>
<li><a href="chap5.html#commandbuffers">5. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap5.html#commandbuffers-lifecycle">5.1. Command Buffer Lifecycle</a></li>
<li><a href="chap5.html#commandbuffers-pools">5.2. Command Pools</a></li>
<li><a href="chap5.html#commandbuffer-allocation">5.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap5.html#commandbuffers-recording">5.4. Command Buffer Recording</a></li>
<li><a href="chap5.html#commandbuffers-submission">5.5. Command Buffer Submission</a></li>
<li><a href="chap5.html#commandbuffers-submission-progress">5.6. Queue Forward Progress</a></li>
<li><a href="chap5.html#commandbuffers-secondary">5.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap5.html#commandbuffers-devicemask">5.8. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap6.html#synchronization">6. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap6.html#synchronization-dependencies">6.1. Execution and Memory Dependencies</a></li>
<li><a href="chap6.html#synchronization-implicit">6.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap6.html#synchronization-fences">6.3. Fences</a></li>
<li><a href="chap6.html#synchronization-semaphores">6.4. Semaphores</a></li>
<li><a href="chap6.html#synchronization-events">6.5. Events</a></li>
<li><a href="chap6.html#synchronization-pipeline-barriers">6.6. Pipeline Barriers</a></li>
<li><a href="chap6.html#synchronization-memory-barriers">6.7. Memory Barriers</a></li>
<li><a href="chap6.html#synchronization-wait-idle">6.8. Wait Idle Operations</a></li>
<li><a href="chap6.html#synchronization-submission-host-writes">6.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap6.html#synchronization-device-group">6.10. Synchronization and Multiple Physical Devices</a></li>
<li><a href="chap6.html#calibrated-timestamps">6.11. Calibrated timestamps</a></li>
</ul>
</li>
<li><a href="chap7.html#renderpass">7. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap7.html#renderpass-creation">7.1. Render Pass Creation</a></li>
<li><a href="chap7.html#renderpass-compatibility">7.2. Render Pass Compatibility</a></li>
<li><a href="chap7.html#_framebuffers">7.3. Framebuffers</a></li>
<li><a href="chap7.html#renderpass-commands">7.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="chap8.html#shaders">8. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap8.html#shader-modules">8.1. Shader Modules</a></li>
<li><a href="chap8.html#shaders-execution">8.2. Shader Execution</a></li>
<li><a href="chap8.html#shaders-execution-memory-ordering">8.3. Shader Memory Access Ordering</a></li>
<li><a href="chap8.html#shaders-inputs">8.4. Shader Inputs and Outputs</a></li>
<li><a href="chap8.html#shaders-task">8.5. Task Shaders</a></li>
<li><a href="chap8.html#shaders-mesh">8.6. Mesh Shaders</a></li>
<li><a href="chap8.html#shaders-vertex">8.7. Vertex Shaders</a></li>
<li><a href="chap8.html#shaders-tessellation-control">8.8. Tessellation Control Shaders</a></li>
<li><a href="chap8.html#shaders-tessellation-evaluation">8.9. Tessellation Evaluation Shaders</a></li>
<li><a href="chap8.html#shaders-geometry">8.10. Geometry Shaders</a></li>
<li><a href="chap8.html#shaders-fragment">8.11. Fragment Shaders</a></li>
<li><a href="chap8.html#shaders-compute">8.12. Compute Shaders</a></li>
<li><a href="chap8.html#shaders-interpolation-decorations">8.13. Interpolation Decorations</a></li>
<li><a href="chap8.html#shaders-ray-generation">8.14. Ray Generation Shaders</a></li>
<li><a href="chap8.html#shaders-intersection">8.15. Intersection Shaders</a></li>
<li><a href="chap8.html#shaders-any-hit">8.16. Any Hit Shaders</a></li>
<li><a href="chap8.html#shaders-closest-hit">8.17. Closest Hit Shaders</a></li>
<li><a href="chap8.html#shaders-miss">8.18. Miss Shaders</a></li>
<li><a href="chap8.html#shaders-callable">8.19. Callable Shaders</a></li>
<li><a href="chap8.html#shaders-staticuse">8.20. Static Use</a></li>
<li><a href="chap8.html#shaders-invocationgroups">8.21. Invocation and Derivative Groups</a></li>
<li><a href="chap8.html#shaders-validation-cache">8.22. Validation Cache</a></li>
</ul>
</li>
<li><a href="chap9.html#pipelines">9. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap9.html#pipelines-compute">9.1. Compute Pipelines</a></li>
<li><a href="chap9.html#pipelines-graphics">9.2. Graphics Pipelines</a></li>
<li><a href="chap9.html#pipelines-destruction">9.3. Pipeline destruction</a></li>
<li><a href="chap9.html#pipelines-multiple">9.4. Multiple Pipeline Creation</a></li>
<li><a href="chap9.html#pipelines-pipeline-derivatives">9.5. Pipeline Derivatives</a></li>
<li><a href="chap9.html#pipelines-cache">9.6. Pipeline Cache</a></li>
<li><a href="chap9.html#pipelines-specialization-constants">9.7. Specialization Constants</a></li>
<li><a href="chap9.html#pipelines-binding">9.8. Pipeline Binding</a></li>
<li><a href="chap9.html#pipelines-dynamic-state">9.9. Dynamic State</a></li>
<li><a href="chap9.html#pipelines-shader-information">9.10. Pipeline Shader Information</a></li>
<li><a href="chap9.html#pipelines-raytracing">9.11. Ray Tracing Pipeline</a></li>
</ul>
</li>
<li><a href="#memory">10. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="#memory-host">10.1. Host Memory</a></li>
<li><a href="#memory-device">10.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap11.html#resources">11. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#resources-buffers">11.1. Buffers</a></li>
<li><a href="chap11.html#resources-buffer-views">11.2. Buffer Views</a></li>
<li><a href="chap11.html#resources-images">11.3. Images</a></li>
<li><a href="chap11.html#resources-image-layouts">11.4. Image Layouts</a></li>
<li><a href="chap11.html#resources-image-views">11.5. Image Views</a></li>
<li><a href="chap11.html#resources-association">11.6. Resource Memory Association</a></li>
<li><a href="chap11.html#resources-sharing">11.7. Resource Sharing Mode</a></li>
<li><a href="chap11.html#resources-memory-aliasing">11.8. Memory Aliasing</a></li>
<li><a href="chap11.html#resources-acceleration-structures">11.9. Acceleration Structures</a></li>
</ul>
</li>
<li><a href="chap12.html#samplers">12. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap12.html#samplers-YCbCr-conversion">12.1. Sampler Y’C<sub>B</sub>C<sub>R</sub> conversion</a></li>
</ul>
</li>
<li><a href="chap13.html#descriptorsets">13. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap13.html#descriptorsets-types">13.1. Descriptor Types</a></li>
<li><a href="chap13.html#descriptorsets-sets">13.2. Descriptor Sets</a></li>
</ul>
</li>
<li><a href="chap14.html#interfaces">14. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap14.html#interfaces-iointerfaces">14.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap14.html#interfaces-vertexinput">14.2. Vertex Input Interface</a></li>
<li><a href="chap14.html#interfaces-fragmentoutput">14.3. Fragment Output Interface</a></li>
<li><a href="chap14.html#interfaces-inputattachment">14.4. Fragment Input Attachment Interface</a></li>
<li><a href="chap14.html#interfaces-resources">14.5. Shader Resource Interface</a></li>
<li><a href="chap14.html#interfaces-builtin-variables">14.6. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap15.html#textures">15. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap15.html#_image_operations_overview">15.1. Image Operations Overview</a></li>
<li><a href="chap15.html#_conversion_formulas">15.2. Conversion Formulas</a></li>
<li><a href="chap15.html#_texel_input_operations">15.3. Texel Input Operations</a></li>
<li><a href="chap15.html#_texel_output_operations">15.4. Texel Output Operations</a></li>
<li><a href="chap15.html#_derivative_operations">15.5. Derivative Operations</a></li>
<li><a href="chap15.html#textures-normalized-operations">15.6. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap15.html#_unnormalized_texel_coordinate_operations">15.7. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap15.html#textures-integer-coordinate-operations">15.8. Integer Texel Coordinate Operations</a></li>
<li><a href="chap15.html#textures-sample-operations">15.9. Image Sample Operations</a></li>
<li><a href="chap15.html#textures-footprint">15.10. Texel Footprint Evaluation</a></li>
<li><a href="chap15.html#textures-instructions">15.11. Image Operation Steps</a></li>
</ul>
</li>
<li><a href="chap16.html#queries">16. Queries</a>
<ul class="sectlevel2">
<li><a href="chap16.html#queries-pools">16.1. Query Pools</a></li>
<li><a href="chap16.html#queries-operation">16.2. Query Operation</a></li>
<li><a href="chap16.html#queries-occlusion">16.3. Occlusion Queries</a></li>
<li><a href="chap16.html#queries-pipestats">16.4. Pipeline Statistics Queries</a></li>
<li><a href="chap16.html#queries-timestamps">16.5. Timestamp Queries</a></li>
<li><a href="chap16.html#queries-transform-feedback">16.6. Transform Feedback Queries</a></li>
</ul>
</li>
<li><a href="chap17.html#clears">17. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap17.html#clears-outside">17.1. Clearing Images Outside A Render Pass Instance</a></li>
<li><a href="chap17.html#clears-inside">17.2. Clearing Images Inside A Render Pass Instance</a></li>
<li><a href="chap17.html#clears-values">17.3. Clear Values</a></li>
<li><a href="chap17.html#clears-filling-buffers">17.4. Filling Buffers</a></li>
<li><a href="chap17.html#clears-updating-buffers">17.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap18.html#copies">18. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#_common_operation">18.1. Common Operation</a></li>
<li><a href="chap18.html#copies-buffers">18.2. Copying Data Between Buffers</a></li>
<li><a href="chap18.html#copies-images">18.3. Copying Data Between Images</a></li>
<li><a href="chap18.html#copies-buffers-images">18.4. Copying Data Between Buffers and Images</a></li>
<li><a href="chap18.html#copies-imagescaling">18.5. Image Copies with Scaling</a></li>
<li><a href="chap18.html#copies-resolve">18.6. Resolving Multisample Images</a></li>
<li><a href="chap18.html#copies-buffer-markers">18.7. Buffer Markers</a></li>
</ul>
</li>
<li><a href="chap19.html#drawing">19. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#drawing-primitive-topologies">19.1. Primitive Topologies</a></li>
<li><a href="chap19.html#drawing-primitive-order">19.2. Primitive Order</a></li>
<li><a href="chap19.html#drawing-primitive-shading">19.3. Programmable Primitive Shading</a></li>
<li><a href="chap19.html#drawing-conditional-rendering">19.4. Conditional Rendering</a></li>
<li><a href="chap19.html#drawing-mesh-shading">19.5. Programmable Mesh Shading</a></li>
</ul>
</li>
<li><a href="chap20.html#fxvertex">20. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap20.html#fxvertex-attrib">20.1. Vertex Attributes</a></li>
<li><a href="chap20.html#fxvertex-input">20.2. Vertex Input Description</a></li>
<li><a href="chap20.html#_vertex_attribute_divisor_in_instanced_rendering">20.3. Vertex Attribute Divisor in Instanced Rendering</a></li>
<li><a href="chap20.html#fxvertex-example">20.4. Example</a></li>
</ul>
</li>
<li><a href="chap21.html#tessellation">21. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap21.html#_tessellator">21.1. Tessellator</a></li>
<li><a href="chap21.html#_tessellator_patch_discard">21.2. Tessellator Patch Discard</a></li>
<li><a href="chap21.html#tessellation-tessellator-spacing">21.3. Tessellator Spacing</a></li>
<li><a href="chap21.html#tessellation-primitive-order">21.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap21.html#tessellation-triangle-tessellation">21.5. Triangle Tessellation</a></li>
<li><a href="chap21.html#tessellation-quad-tessellation">21.6. Quad Tessellation</a></li>
<li><a href="chap21.html#tessellation-isoline-tessellation">21.7. Isoline Tessellation</a></li>
<li><a href="chap21.html#_tessellation_pipeline_state">21.8. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap22.html#geometry">22. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap22.html#geometry-input">22.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap22.html#geometry-output">22.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap22.html#geometry-invocations">22.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap22.html#geometry-ordering">22.4. Geometry Shader Primitive Ordering</a></li>
<li><a href="chap22.html#geometry-passthrough">22.5. Geometry Shader Passthrough</a></li>
</ul>
</li>
<li><a href="chap23.html#mesh">23. Mesh Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#mesh-task-input">23.1. Task Shader Input</a></li>
<li><a href="chap23.html#mesh-task-output">23.2. Task Shader Output</a></li>
<li><a href="chap23.html#mesh-generation">23.3. Mesh Generation</a></li>
<li><a href="chap23.html#mesh-input">23.4. Mesh Shader Input</a></li>
<li><a href="chap23.html#mesh-output">23.5. Mesh Shader Output Primitives</a></li>
<li><a href="chap23.html#mesh-output-perview">23.6. Mesh Shader Per-View Outputs</a></li>
<li><a href="chap23.html#mesh-ordering">23.7. Mesh Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap24.html#vertexpostproc">24. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap24.html#vertexpostproc-transform-feedback">24.1. Transform Feedback</a></li>
<li><a href="chap24.html#vertexpostproc-viewport-swizzle">24.2. Viewport Swizzle</a></li>
<li><a href="chap24.html#vertexpostproc-flatshading">24.3. Flat Shading</a></li>
<li><a href="chap24.html#vertexpostproc-clipping">24.4. Primitive Clipping</a></li>
<li><a href="chap24.html#vertexpostproc-clipping-shader-outputs">24.5. Clipping Shader Outputs</a></li>
<li><a href="chap24.html#vertexpostproc-viewportwscaling">24.6. Controlling Viewport W Scaling</a></li>
<li><a href="chap24.html#vertexpostproc-coord-transform">24.7. Coordinate Transformations</a></li>
<li><a href="chap24.html#vertexpostproc-viewport">24.8. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap25.html#primsrast">25. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap25.html#primsrast-discard">25.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap25.html#primsrast-stream">25.2. Controlling the Vertex Stream Used for Rasterization</a></li>
<li><a href="chap25.html#primrast-order">25.3. Rasterization Order</a></li>
<li><a href="chap25.html#primsrast-multisampling">25.4. Multisampling</a></li>
<li><a href="chap25.html#primrast-samplelocations">25.5. Custom Sample Locations</a></li>
<li><a href="chap25.html#primsrast-shading-rate-image">25.6. Shading Rate Image</a></li>
<li><a href="chap25.html#primsrast-sampleshading">25.7. Sample Shading</a></li>
<li><a href="chap25.html#primsrast-barycentric">25.8. Barycentric Interpolation</a></li>
<li><a href="chap25.html#primsrast-points">25.9. Points</a></li>
<li><a href="chap25.html#primsrast-lines">25.10. Line Segments</a></li>
<li><a href="chap25.html#primsrast-polygons">25.11. Polygons</a></li>
</ul>
</li>
<li><a href="chap26.html#fragops">26. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap26.html#fragops-early">26.1. Early Per-Fragment Tests</a></li>
<li><a href="chap26.html#fragops-discard-rectangles">26.2. Discard Rectangles Test</a></li>
<li><a href="chap26.html#fragops-scissor">26.3. Scissor Test</a></li>
<li><a href="chap26.html#fragops-exclusive-scissor">26.4. Exclusive Scissor Test</a></li>
<li><a href="chap26.html#fragops-samplemask">26.5. Sample Mask</a></li>
<li><a href="chap26.html#fragops-early-mode">26.6. Early Fragment Test Mode</a></li>
<li><a href="chap26.html#fragops-late">26.7. Late Per-Fragment Tests</a></li>
<li><a href="chap26.html#fragops-mixed-attachment-samples">26.8. Mixed attachment samples</a></li>
<li><a href="chap26.html#fragops-covg">26.9. Multisample Coverage</a></li>
<li><a href="chap26.html#fragops-ds-state">26.10. Depth and Stencil Operations</a></li>
<li><a href="chap26.html#fragops-dbt">26.11. Depth Bounds Test</a></li>
<li><a href="chap26.html#fragops-stencil">26.12. Stencil Test</a></li>
<li><a href="chap26.html#fragops-depth">26.13. Depth Test</a></li>
<li><a href="chap26.html#fragops-rep-frag-test">26.14. Representative Fragment Test</a></li>
<li><a href="chap26.html#fragops-samplecount">26.15. Sample Counting</a></li>
<li><a href="chap26.html#fragops-coverage-to-color">26.16. Fragment Coverage To Color</a></li>
<li><a href="chap26.html#fragops-coverage-reduction">26.17. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap27.html#framebuffer">27. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap27.html#framebuffer-blending">27.1. Blending</a></li>
<li><a href="chap27.html#framebuffer-logicop">27.2. Logical Operations</a></li>
<li><a href="chap27.html#framebuffer-color-write-mask">27.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap28.html#dispatch">28. Dispatching Commands</a></li>
<li><a href="chap29.html#device-generated-commands">29. Device-Generated Commands</a>
<ul class="sectlevel2">
<li><a href="chap29.html#_features_and_limitations">29.1. Features and Limitations</a></li>
<li><a href="chap29.html#_binding_object_table">29.2. Binding Object Table</a></li>
<li><a href="chap29.html#indirectmdslayout">29.3. Indirect Commands Layout</a></li>
<li><a href="chap29.html#_indirect_commands_generation">29.4. Indirect Commands Generation</a></li>
</ul>
</li>
<li><a href="chap30.html#sparsememory">30. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap30.html#sparsememory-sparseresourcefeatures">30.1. Sparse Resource Features</a></li>
<li><a href="chap30.html#sparsememory-fully-resident">30.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap30.html#sparsememory-partially-resident-buffers">30.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap30.html#sparsememory-partially-resident-images">30.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap30.html#sparsememory-sparse-memory-aliasing">30.5. Sparse Memory Aliasing</a></li>
<li><a href="chap30.html#_sparse_resource_implementation_guidelines">30.6. Sparse Resource Implementation Guidelines</a></li>
<li><a href="chap30.html#sparsememory-resourceapi">30.7. Sparse Resource API</a></li>
<li><a href="chap30.html#sparsememory-examples">30.8. Examples</a></li>
</ul>
</li>
<li><a href="chap31.html#wsi">31. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap31.html#_wsi_platform">31.1. WSI Platform</a></li>
<li><a href="chap31.html#_wsi_surface">31.2. WSI Surface</a></li>
<li><a href="chap31.html#display">31.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap31.html#_querying_for_wsi_support">31.4. Querying for WSI Support</a></li>
<li><a href="chap31.html#_surface_queries">31.5. Surface Queries</a></li>
<li><a href="chap31.html#_device_group_queries">31.6. Device Group Queries</a></li>
<li><a href="chap31.html#_display_timing_queries">31.7. Display Timing Queries</a></li>
<li><a href="chap31.html#_wsi_swapchain">31.8. WSI Swapchain</a></li>
<li><a href="chap31.html#_hdr_metadata">31.9. Hdr Metadata</a></li>
</ul>
</li>
<li><a href="chap32.html#raytracing">32. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="chap32.html#raytracing-commands">32.1. Ray Tracing Commands</a></li>
<li><a href="chap32.html#shader-binding-table">32.2. Shader Binding Table</a></li>
<li><a href="chap32.html#acceleration-structure">32.3. Acceleration Structures</a></li>
</ul>
</li>
<li><a href="chap33.html#extended-functionality">33. Extended Functionality</a>
<ul class="sectlevel2">
<li><a href="chap33.html#extended-functionality-layers">33.1. Layers</a></li>
<li><a href="chap33.html#extended-functionality-extensions">33.2. Extensions</a></li>
<li><a href="chap33.html#extended-functionality-extensions-dependencies">33.3. Extension Dependencies</a></li>
<li><a href="chap33.html#extended-functionality-extensions-compatibility">33.4. Extension Compatibility</a></li>
</ul>
</li>
<li><a href="chap34.html#features">34. Features, Limits, and Formats</a>
<ul class="sectlevel2">
<li><a href="chap34.html#features-features">34.1. Features</a></li>
<li><a href="chap34.html#features-limits">34.2. Limits</a></li>
<li><a href="chap34.html#features-limits-multisample">34.3. Additional Multisampling Capabilities</a></li>
<li><a href="chap34.html#features-formats">34.4. Formats</a></li>
<li><a href="chap34.html#_additional_image_capabilities">34.5. Additional Image Capabilities</a></li>
<li><a href="chap34.html#_additional_buffer_capabilities">34.6. Additional Buffer Capabilities</a></li>
<li><a href="chap34.html#_optional_semaphore_capabilities">34.7. Optional Semaphore Capabilities</a></li>
<li><a href="chap34.html#_optional_fence_capabilities">34.8. Optional Fence Capabilities</a></li>
<li><a href="chap34.html#features-timestamp-calibration">34.9. Timestamp Calibration Capabilities</a></li>
</ul>
</li>
<li><a href="chap35.html#_debugging">35. Debugging</a>
<ul class="sectlevel2">
<li><a href="chap35.html#debugging-debug-utils">35.1. Debug Utilities</a></li>
<li><a href="chap35.html#debugging-debug-markers">35.2. Debug Markers</a></li>
<li><a href="chap35.html#debugging-debug-report-callbacks">35.3. Debug Report Callbacks</a></li>
<li><a href="chap35.html#_device_loss_debugging">35.4. Device Loss Debugging</a></li>
</ul>
</li>
<li><a href="chap36.html#spirvenv">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap36.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap36.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap36.html#spirvenv-module-validation">Validation Rules within a Module</a></li>
<li><a href="chap36.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap36.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats And Vulkan Formats</a></li>
</ul>
</li>
<li><a href="chap37.html#memory-model">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap37.html#memory-model-agent">Agent</a></li>
<li><a href="chap37.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap37.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap37.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap37.html#memory-model-references">Reference</a></li>
<li><a href="chap37.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap37.html#memory-model-scope">Scope</a></li>
<li><a href="chap37.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap37.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap37.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap37.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap37.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap37.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap37.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap37.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap37.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap37.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap37.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap37.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap37.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap37.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap37.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap37.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap37.html#memory-model-scoped-modification-order-coherence">Scoped Modification Order Coherence</a></li>
<li><a href="chap37.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap37.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap37.html#memory-model-informative-descriptions">Informative Descriptions</a></li>
<li><a href="chap37.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
</ul>
</li>
<li><a href="chap38.html#_compressed_image_formats">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap38.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap38.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap38.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap39.html#extensions">Appendix D: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap39.html#extension-appendices-list">List of Current Extensions</a></li>
<li><a href="chap39.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
<li><a href="chap39.html#deprecated-extension-appendices-list">List of Deprecated Extensions</a></li>
</ul>
</li>
<li><a href="chap40.html#boilerplate">Appendix E: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap40.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap40.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
</ul>
</li>
<li><a href="chap41.html#invariance">Appendix F: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap41.html#_repeatability">Repeatability</a></li>
<li><a href="chap41.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap41.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap41.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap42.html#glossary">Glossary</a></li>
<li><a href="chap43.html#_common_abbreviations">Common Abbreviations</a></li>
<li><a href="chap44.html#_prefixes">Prefixes</a></li>
<li><a href="chap45.html#credits">Appendix G: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap45.html#_working_group_contributors_to_vulkan_1_1_and_1_0">Working Group Contributors to Vulkan 1.1 and 1.0</a></li>
<li><a href="chap45.html#_working_group_contributors_to_vulkan_1_1">Working Group Contributors to Vulkan 1.1</a></li>
<li><a href="chap45.html#_working_group_contributors_to_vulkan_1_0">Working Group Contributors to Vulkan 1.0</a></li>
<li><a href="chap45.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content"><div class="sect1">
<h2 id="memory">10. Memory Allocation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vulkan memory is broken up into two categories, <em>host memory</em> and <em>device
memory</em>.</p>
</div>
<div class="sect2">
<h3 id="memory-host">10.1. Host Memory</h3>
<div class="paragraph">
<p>Host memory is memory needed by the Vulkan implementation for
non-device-visible storage.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This memory <strong class="purple">may</strong> be used to store the implementation’s representation and
state of Vulkan objects.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="memory-allocation" class="paragraph">
<p>Vulkan provides applications the opportunity to perform host memory
allocations on behalf of the Vulkan implementation.
If this feature is not used, the implementation will perform its own memory
allocations.
Since most memory allocations are off the critical path, this is not meant
as a performance feature.
Rather, this <strong class="purple">can</strong> be useful for certain embedded systems, for debugging
purposes (e.g. putting a guard page after all host allocations), or for
memory allocation logging.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Allocators are provided by the application as a pointer to a
<code>VkAllocationCallbacks</code> structure:</p>
</div>
<div id="VkAllocationCallbacks" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkAllocationCallbacks {
    <span class="directive">void</span>*                                   pUserData;
    PFN_vkAllocationFunction                pfnAllocation;
    PFN_vkReallocationFunction              pfnReallocation;
    PFN_vkFreeFunction                      pfnFree;
    PFN_vkInternalAllocationNotification    pfnInternalAllocation;
    PFN_vkInternalFreeNotification          pfnInternalFree;
} VkAllocationCallbacks;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is a value to be interpreted by the implementation of
the callbacks.
When any of the callbacks in <code>VkAllocationCallbacks</code> are called, the
Vulkan implementation will pass this value as the first parameter to the
callback.
This value <strong class="purple">can</strong> vary each time an allocator is passed into a command,
even when the same object takes an allocator in multiple commands.</p>
</li>
<li>
<p><code>pfnAllocation</code> is a pointer to an application-defined memory
allocation function of type <a href="#PFN_vkAllocationFunction">PFN_vkAllocationFunction</a>.</p>
</li>
<li>
<p><code>pfnReallocation</code> is a pointer to an application-defined memory
reallocation function of type <a href="#PFN_vkReallocationFunction">PFN_vkReallocationFunction</a>.</p>
</li>
<li>
<p><code>pfnFree</code> is a pointer to an application-defined memory free
function of type <a href="#PFN_vkFreeFunction">PFN_vkFreeFunction</a>.</p>
</li>
<li>
<p><code>pfnInternalAllocation</code> is a pointer to an application-defined
function that is called by the implementation when the implementation
makes internal allocations, and it is of type
<a href="#PFN_vkInternalAllocationNotification">PFN_vkInternalAllocationNotification</a>.</p>
</li>
<li>
<p><code>pfnInternalFree</code> is a pointer to an application-defined function
that is called by the implementation when the implementation frees
internal allocations, and it is of type
<a href="#PFN_vkInternalFreeNotification">PFN_vkInternalFreeNotification</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnAllocation-00632"></a>
<code>pfnAllocation</code> <strong class="purple">must</strong> be a valid pointer to a valid user-defined
<a href="#PFN_vkAllocationFunction">PFN_vkAllocationFunction</a></p>
</li>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnReallocation-00633"></a>
<code>pfnReallocation</code> <strong class="purple">must</strong> be a valid pointer to a valid user-defined
<a href="#PFN_vkReallocationFunction">PFN_vkReallocationFunction</a></p>
</li>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnFree-00634"></a>
<code>pfnFree</code> <strong class="purple">must</strong> be a valid pointer to a valid user-defined
<a href="#PFN_vkFreeFunction">PFN_vkFreeFunction</a></p>
</li>
<li>
<p><a id="VUID-VkAllocationCallbacks-pfnInternalAllocation-00635"></a>
If either of <code>pfnInternalAllocation</code> or <code>pfnInternalFree</code> is not
<code>NULL</code>, both <strong class="purple">must</strong> be valid callbacks</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnAllocation</code> is:</p>
</div>
<div id="PFN_vkAllocationFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span>* (VKAPI_PTR *PFN_vkAllocationFunction)(
    <span class="directive">void</span>*                                       pUserData,
    size_t                                      size,
    size_t                                      alignment,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>size</code> is the size in bytes of the requested allocation.</p>
</li>
<li>
<p><code>alignment</code> is the requested alignment of the allocation in bytes
and <strong class="purple">must</strong> be a power of two.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
<div id="vkAllocationFunction_return_rules" class="paragraph">
<p>If <code>pfnAllocation</code> is unable to allocate the requested memory, it <strong class="purple">must</strong>
return <code>NULL</code>.
If the allocation was successful, it <strong class="purple">must</strong> return a valid pointer to memory
allocation containing at least <code>size</code> bytes, and with the pointer value
being a multiple of <code>alignment</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Correct Vulkan operation <strong class="purple">cannot</strong> be assumed if the application does not
follow these rules.</p>
</div>
<div class="paragraph">
<p>For example, <code>pfnAllocation</code> (or <code>pfnReallocation</code>) could cause
termination of running Vulkan instance(s) on a failed allocation for
debugging purposes, either directly or indirectly.
In these circumstances, it <strong class="purple">cannot</strong> be assumed that any part of any affected
<a href="chap3.html#VkInstance">VkInstance</a> objects are going to operate correctly (even
<a href="chap3.html#vkDestroyInstance">vkDestroyInstance</a>), and the application <strong class="purple">must</strong> ensure it cleans up
properly via other means (e.g. process termination).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>pfnAllocation</code> returns <code>NULL</code>, and if the implementation is unable
to continue correct processing of the current command without the requested
allocation, it <strong class="purple">must</strong> treat this as a run-time error, and generate
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> at the appropriate time for the command in
which the condition was detected, as described in <a href="chap2.html#fundamentals-errorcodes">Return Codes</a>.</p>
</div>
<div class="paragraph">
<p>If the implementation is able to continue correct processing of the current
command without the requested allocation, then it <strong class="purple">may</strong> do so, and <strong class="purple">must</strong> not
generate <code>VK_ERROR_OUT_OF_HOST_MEMORY</code> as a result of this failed
allocation.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnReallocation</code> is:</p>
</div>
<div id="PFN_vkReallocationFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span>* (VKAPI_PTR *PFN_vkReallocationFunction)(
    <span class="directive">void</span>*                                       pUserData,
    <span class="directive">void</span>*                                       pOriginal,
    size_t                                      size,
    size_t                                      alignment,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>pOriginal</code> <strong class="purple">must</strong> be either <code>NULL</code> or a pointer previously returned
by <code>pfnReallocation</code> or <code>pfnAllocation</code> of the same allocator.</p>
</li>
<li>
<p><code>size</code> is the size in bytes of the requested allocation.</p>
</li>
<li>
<p><code>alignment</code> is the requested alignment of the allocation in bytes
and <strong class="purple">must</strong> be a power of two.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pfnReallocation</code> <strong class="purple">must</strong> return an allocation with enough space for
<code>size</code> bytes, and the contents of the original allocation from bytes
zero to <span class="eq">min(original size, new size) - 1</span> <strong class="purple">must</strong> be preserved in the
returned allocation.
If <code>size</code> is larger than the old size, the contents of the additional
space are undefined.
If satisfying these requirements involves creating a new allocation, then
the old allocation <strong class="purple">should</strong> be freed.</p>
</div>
<div class="paragraph">
<p>If <code>pOriginal</code> is <code>NULL</code>, then <code>pfnReallocation</code> <strong class="purple">must</strong> behave
equivalently to a call to <a href="#PFN_vkAllocationFunction">PFN_vkAllocationFunction</a> with the same
parameter values (without <code>pOriginal</code>).</p>
</div>
<div class="paragraph">
<p>If <code>size</code> is zero, then <code>pfnReallocation</code> <strong class="purple">must</strong> behave equivalently
to a call to <a href="#PFN_vkFreeFunction">PFN_vkFreeFunction</a> with the same <code>pUserData</code>
parameter value, and <code>pMemory</code> equal to <code>pOriginal</code>.</p>
</div>
<div class="paragraph">
<p>If <code>pOriginal</code> is non-<code>NULL</code>, the implementation <strong class="purple">must</strong> ensure that
<code>alignment</code> is equal to the <code>alignment</code> used to originally allocate
<code>pOriginal</code>.</p>
</div>
<div class="paragraph">
<p>If this function fails and <code>pOriginal</code> is non-<code>NULL</code> the application
<strong class="purple">must</strong> not free the old allocation.</p>
</div>
<div class="paragraph">
<p><code>pfnReallocation</code> <strong class="purple">must</strong> follow the same
<a href="#vkAllocationFunction_return_rules">rules for return values as
<code>PFN_vkAllocationFunction</code></a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnFree</code> is:</p>
</div>
<div id="PFN_vkFreeFunction" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkFreeFunction)(
    <span class="directive">void</span>*                                       pUserData,
    <span class="directive">void</span>*                                       pMemory);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>pMemory</code> is the allocation to be freed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pMemory</code> <strong class="purple">may</strong> be <code>NULL</code>, which the callback <strong class="purple">must</strong> handle safely.
If <code>pMemory</code> is non-<code>NULL</code>, it <strong class="purple">must</strong> be a pointer previously allocated
by <code>pfnAllocation</code> or <code>pfnReallocation</code>.
The application <strong class="purple">should</strong> free this memory.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnInternalAllocation</code> is:</p>
</div>
<div id="PFN_vkInternalAllocationNotification" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkInternalAllocationNotification)(
    <span class="directive">void</span>*                                       pUserData,
    size_t                                      size,
    VkInternalAllocationType                    allocationType,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>size</code> is the requested size of an allocation.</p>
</li>
<li>
<p><code>allocationType</code> is a <a href="#VkInternalAllocationType">VkInternalAllocationType</a> value
specifying the requested type of an allocation.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is a purely informational callback.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The type of <code>pfnInternalFree</code> is:</p>
</div>
<div id="PFN_vkInternalFreeNotification" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="directive">void</span> (VKAPI_PTR *PFN_vkInternalFreeNotification)(
    <span class="directive">void</span>*                                       pUserData,
    size_t                                      size,
    VkInternalAllocationType                    allocationType,
    VkSystemAllocationScope                     allocationScope);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pUserData</code> is the value specified for
<a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>::<code>pUserData</code> in the allocator specified
by the application.</p>
</li>
<li>
<p><code>size</code> is the requested size of an allocation.</p>
</li>
<li>
<p><code>allocationType</code> is a <a href="#VkInternalAllocationType">VkInternalAllocationType</a> value
specifying the requested type of an allocation.</p>
</li>
<li>
<p><code>allocationScope</code> is a <a href="#VkSystemAllocationScope">VkSystemAllocationScope</a> value
specifying the allocation scope of the lifetime of the allocation, as
described <a href="#memory-host-allocation-scope">here</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="memory-host-allocation-scope" class="paragraph">
<p>Each allocation has an <em>allocation scope</em> which defines its lifetime and
which object it is associated with.
Possible values passed to the <code>allocationScope</code> parameter of the
callback functions specified by <a href="#VkAllocationCallbacks">VkAllocationCallbacks</a>, indicating the
allocation scope, are:</p>
</div>
<div id="VkSystemAllocationScope" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkSystemAllocationScope {
    VK_SYSTEM_ALLOCATION_SCOPE_COMMAND = <span class="integer">0</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_OBJECT = <span class="integer">1</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_CACHE = <span class="integer">2</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_DEVICE = <span class="integer">3</span>,
    VK_SYSTEM_ALLOCATION_SCOPE_INSTANCE = <span class="integer">4</span>,
} VkSystemAllocationScope;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_COMMAND</code> specifies that the allocation
is scoped to the duration of the Vulkan command.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_OBJECT</code> specifies that the allocation is
scoped to the lifetime of the Vulkan object that is being created or
used.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_CACHE</code> specifies that the allocation is
scoped to the lifetime of a <code>VkPipelineCache</code>
or <code>VkValidationCacheEXT</code>
object.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_DEVICE</code> specifies that the allocation is
scoped to the lifetime of the Vulkan device.</p>
</li>
<li>
<p><code>VK_SYSTEM_ALLOCATION_SCOPE_INSTANCE</code> specifies that the allocation
is scoped to the lifetime of the Vulkan instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most Vulkan commands operate on a single object, or there is a sole object
that is being created or manipulated.
When an allocation uses an allocation scope of
<code>VK_SYSTEM_ALLOCATION_SCOPE_OBJECT</code> or
<code>VK_SYSTEM_ALLOCATION_SCOPE_CACHE</code>, the allocation is scoped to the
object being created or manipulated.</p>
</div>
<div class="paragraph">
<p>When an implementation requires host memory, it will make callbacks to the
application using the most specific allocator and allocation scope
available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an allocation is scoped to the duration of a command, the allocator
will use the <code>VK_SYSTEM_ALLOCATION_SCOPE_COMMAND</code> allocation scope.
The most specific allocator available is used: if the object being
created or manipulated has an allocator, that object’s allocator will be
used, else if the parent <code>VkDevice</code> has an allocator it will be
used, else if the parent <code>VkInstance</code> has an allocator it will be
used.
Else,</p>
</li>
<li>
<p>If an allocation is associated with an object of type
<code>VkValidationCacheEXT</code> or
<code>VkPipelineCache</code>, the allocator will use the
<code>VK_SYSTEM_ALLOCATION_SCOPE_CACHE</code> allocation scope.
The most specific allocator available is used (cache, else device, else
instance).
Else,</p>
</li>
<li>
<p>If an allocation is scoped to the lifetime of an object, that object is
being created or manipulated by the command, and that object’s type is
not <code>VkDevice</code> or <code>VkInstance</code>, the allocator will use an
allocation scope of <code>VK_SYSTEM_ALLOCATION_SCOPE_OBJECT</code>.
The most specific allocator available is used (object, else device, else
instance).
Else,</p>
</li>
<li>
<p>If an allocation is scoped to the lifetime of a device, the allocator
will use an allocation scope of <code>VK_SYSTEM_ALLOCATION_SCOPE_DEVICE</code>.
The most specific allocator available is used (device, else instance).
Else,</p>
</li>
<li>
<p>If the allocation is scoped to the lifetime of an instance and the
instance has an allocator, its allocator will be used with an allocation
scope of <code>VK_SYSTEM_ALLOCATION_SCOPE_INSTANCE</code>.</p>
</li>
<li>
<p>Otherwise an implementation will allocate memory through an alternative
mechanism that is unspecified.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Objects that are allocated from pools do not specify their own allocator.
When an implementation requires host memory for such an object, that memory
is sourced from the object’s parent pool’s allocator.</p>
</div>
<div class="paragraph">
<p>The application is not expected to handle allocating memory that is intended
for execution by the host due to the complexities of differing security
implementations across multiple platforms.
The implementation will allocate such memory internally and invoke an
application provided informational callback when these <em>internal
allocations</em> are allocated and freed.
Upon allocation of executable memory, <code>pfnInternalAllocation</code> will be
called.
Upon freeing executable memory, <code>pfnInternalFree</code> will be called.
An implementation will only call an informational callback for executable
memory allocations and frees.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>allocationType</code> parameter to the <code>pfnInternalAllocation</code> and
<code>pfnInternalFree</code> functions <strong class="purple">may</strong> be one of the following values:</p>
</div>
<div id="VkInternalAllocationType" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkInternalAllocationType {
    VK_INTERNAL_ALLOCATION_TYPE_EXECUTABLE = <span class="integer">0</span>,
} VkInternalAllocationType;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_INTERNAL_ALLOCATION_TYPE_EXECUTABLE</code> specifies that the
allocation is intended for execution by the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>An implementation <strong class="purple">must</strong> only make calls into an application-provided
allocator during the execution of an API command.
An implementation <strong class="purple">must</strong> only make calls into an application-provided
allocator from the same thread that called the provoking API command.
The implementation <strong class="purple">should</strong> not synchronize calls to any of the callbacks.
If synchronization is needed, the callbacks <strong class="purple">must</strong> provide it themselves.
The informational callbacks are subject to the same restrictions as the
allocation callbacks.</p>
</div>
<div class="paragraph">
<p>If an implementation intends to make calls through a
<code>VkAllocationCallbacks</code> structure between the time a <code>vkCreate*</code>
command returns and the time a corresponding <code>vkDestroy*</code> command
begins, that implementation <strong class="purple">must</strong> save a copy of the allocator before the
<code>vkCreate*</code> command returns.
The callback functions and any data structures they rely upon <strong class="purple">must</strong> remain
valid for the lifetime of the object they are associated with.</p>
</div>
<div class="paragraph">
<p>If an allocator is provided to a <code>vkCreate*</code> command, a <em>compatible</em>
allocator <strong class="purple">must</strong> be provided to the corresponding <code>vkDestroy*</code> command.
Two <code>VkAllocationCallbacks</code> structures are compatible if memory
allocated with <code>pfnAllocation</code> or <code>pfnReallocation</code> in each <strong class="purple">can</strong> be
freed with <code>pfnReallocation</code> or <code>pfnFree</code> in the other.
An allocator <strong class="purple">must</strong> not be provided to a <code>vkDestroy*</code> command if an
allocator was not provided to the corresponding <code>vkCreate*</code> command.</p>
</div>
<div class="paragraph">
<p>If a non-<code>NULL</code> allocator is used, the <code>pfnAllocation</code>,
<code>pfnReallocation</code> and <code>pfnFree</code> members <strong class="purple">must</strong> be non-<code>NULL</code> and
point to valid implementations of the callbacks.
An application <strong class="purple">can</strong> choose to not provide informational callbacks by setting
both <code>pfnInternalAllocation</code> and <code>pfnInternalFree</code> to <code>NULL</code>.
<code>pfnInternalAllocation</code> and <code>pfnInternalFree</code> <strong class="purple">must</strong> either both be
<code>NULL</code> or both be non-<code>NULL</code>.</p>
</div>
<div class="paragraph">
<p>If <code>pfnAllocation</code> or <code>pfnReallocation</code> fail, the implementation
<strong class="purple">may</strong> fail object creation and/or generate an
<code>VK_ERROR_OUT_OF_HOST_MEMORY</code> error, as appropriate.</p>
</div>
<div class="paragraph">
<p>Allocation callbacks <strong class="purple">must</strong> not call any Vulkan commands.</p>
</div>
<div class="paragraph">
<p>The following sets of rules define when an implementation is permitted to
call the allocator callbacks.</p>
</div>
<div class="paragraph">
<p><code>pfnAllocation</code> or <code>pfnReallocation</code> <strong class="purple">may</strong> be called in the following
situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allocations scoped to a <code>VkDevice</code> or <code>VkInstance</code> <strong class="purple">may</strong> be
allocated from any API command.</p>
</li>
<li>
<p>Allocations scoped to a command <strong class="purple">may</strong> be allocated from any API command.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkPipelineCache</code> <strong class="purple">may</strong> only be allocated
from:</p>
<div class="ulist">
<ul>
<li>
<p><code>vkCreatePipelineCache</code></p>
</li>
<li>
<p><code>vkMergePipelineCaches</code> for <code>dstCache</code></p>
</li>
<li>
<p><code>vkCreateGraphicsPipelines</code> for <code>pipelineCache</code></p>
</li>
<li>
<p><code>vkCreateComputePipelines</code> for <code>pipelineCache</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkValidationCacheEXT</code> <strong class="purple">may</strong> only be
allocated from:</p>
<div class="ulist">
<ul>
<li>
<p><code>vkCreateValidationCacheEXT</code></p>
</li>
<li>
<p><code>vkMergeValidationCachesEXT</code> for <code>dstCache</code></p>
</li>
<li>
<p><code>vkCreateShaderModule</code> for <code>validationCache</code> in
<code>VkShaderModuleValidationCacheCreateInfoEXT</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkDescriptorPool</code> <strong class="purple">may</strong> only be allocated
from:</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
<li>
<p><code>vkAllocateDescriptorSets</code> for the <code>descriptorPool</code> member of
its <code>pAllocateInfo</code> parameter</p>
</li>
<li>
<p><code>vkCreateDescriptorPool</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkCommandPool</code> <strong class="purple">may</strong> only be allocated from:</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
<li>
<p><code>vkCreateCommandPool</code></p>
</li>
<li>
<p><code>vkAllocateCommandBuffers</code> for the <code>commandPool</code> member of its
<code>pAllocateInfo</code> parameter</p>
</li>
<li>
<p>any <code>vkCmd*</code> command whose <code>commandBuffer</code> was allocated from
that <code>VkCommandPool</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to any other object <strong class="purple">may</strong> only be allocated in that
object’s <code>vkCreate*</code> command.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>pfnFree</code> <strong class="purple">may</strong> be called in the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allocations scoped to a <code>VkDevice</code> or <code>VkInstance</code> <strong class="purple">may</strong> be freed
from any API command.</p>
</li>
<li>
<p>Allocations scoped to a command <strong class="purple">must</strong> be freed by any API command which
allocates such memory.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkPipelineCache</code> <strong class="purple">may</strong> be freed from
<code>vkDestroyPipelineCache</code>.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkValidationCacheEXT</code> <strong class="purple">may</strong> be freed from
<code>vkDestroyValidationCacheEXT</code>.</p>
</li>
<li>
<p>Allocations scoped to a <code>VkDescriptorPool</code> <strong class="purple">may</strong> be freed from</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to a <code>VkCommandPool</code> <strong class="purple">may</strong> be freed from:</p>
<div class="ulist">
<ul>
<li>
<p>any command that takes the pool as a direct argument</p>
</li>
<li>
<p><code>vkResetCommandBuffer</code> whose <code>commandBuffer</code> was allocated from
that <code>VkCommandPool</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Allocations scoped to any other object <strong class="purple">may</strong> be freed in that object’s
<code>vkDestroy*</code> command.</p>
</li>
<li>
<p>Any command that allocates host memory <strong class="purple">may</strong> also free host memory of the
same scope.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="memory-device">10.2. Device Memory</h3>
<div class="paragraph">
<p><em>Device memory</em> is memory that is visible to the device — for example the
contents of the image or buffer objects, which <strong class="purple">can</strong> be natively used by the
device.</p>
</div>
<div class="paragraph">
<p>Memory properties of a physical device describe the memory heaps and memory
types available.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query memory properties, call:</p>
</div>
<div id="vkGetPhysicalDeviceMemoryProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetPhysicalDeviceMemoryProperties(
    VkPhysicalDevice                            physicalDevice,
    VkPhysicalDeviceMemoryProperties*           pMemoryProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the device to query.</p>
</li>
<li>
<p><code>pMemoryProperties</code> points to an instance of
<code>VkPhysicalDeviceMemoryProperties</code> structure in which the properties
are returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceMemoryProperties-physicalDevice-parameter"></a> <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <code>VkPhysicalDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceMemoryProperties-pMemoryProperties-parameter"></a> <code>pMemoryProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkPhysicalDeviceMemoryProperties</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceMemoryProperties</code> structure is defined as:</p>
</div>
<div id="VkPhysicalDeviceMemoryProperties" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPhysicalDeviceMemoryProperties {
    uint32_t        memoryTypeCount;
    VkMemoryType    memoryTypes[VK_MAX_MEMORY_TYPES];
    uint32_t        memoryHeapCount;
    VkMemoryHeap    memoryHeaps[VK_MAX_MEMORY_HEAPS];
} VkPhysicalDeviceMemoryProperties;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>memoryTypeCount</code> is the number of valid elements in the
<code>memoryTypes</code> array.</p>
</li>
<li>
<p><code>memoryTypes</code> is an array of <a href="#VkMemoryType">VkMemoryType</a> structures
describing the <em>memory types</em> that <strong class="purple">can</strong> be used to access memory
allocated from the heaps specified by <code>memoryHeaps</code>.</p>
</li>
<li>
<p><code>memoryHeapCount</code> is the number of valid elements in the
<code>memoryHeaps</code> array.</p>
</li>
<li>
<p><code>memoryHeaps</code> is an array of <a href="#VkMemoryHeap">VkMemoryHeap</a> structures
describing the <em>memory heaps</em> from which memory <strong class="purple">can</strong> be allocated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>VkPhysicalDeviceMemoryProperties</code> structure describes a number of
<em>memory heaps</em> as well as a number of <em>memory types</em> that <strong class="purple">can</strong> be used to
access memory allocated in those heaps.
Each heap describes a memory resource of a particular size, and each memory
type describes a set of memory properties (e.g. host cached vs uncached)
that <strong class="purple">can</strong> be used with a given memory heap.
Allocations using a particular memory type will consume resources from the
heap indicated by that memory type’s heap index.
More than one memory type <strong class="purple">may</strong> share each heap, and the heaps and memory
types provide a mechanism to advertise an accurate size of the physical
memory resources while allowing the memory to be used with a variety of
different properties.</p>
</div>
<div class="paragraph">
<p>The number of memory heaps is given by <code>memoryHeapCount</code> and is less
than or equal to <code>VK_MAX_MEMORY_HEAPS</code>.
Each heap is described by an element of the <code>memoryHeaps</code> array as a
<a href="#VkMemoryHeap">VkMemoryHeap</a> structure.
The number of memory types available across all memory heaps is given by
<code>memoryTypeCount</code> and is less than or equal to
<code>VK_MAX_MEMORY_TYPES</code>.
Each memory type is described by an element of the <code>memoryTypes</code> array
as a <a href="#VkMemoryType">VkMemoryType</a> structure.</p>
</div>
<div class="paragraph">
<p>At least one heap <strong class="purple">must</strong> include <code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code> in
<a href="#VkMemoryHeap">VkMemoryHeap</a>::<code>flags</code>.
If there are multiple heaps that all have similar performance
characteristics, they <strong class="purple">may</strong> all include
<code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code>.
In a unified memory architecture (UMA) system there is often only a single
memory heap which is considered to be equally “local” to the host and to
the device, and such an implementation <strong class="purple">must</strong> advertise the heap as
device-local.</p>
</div>
<div id="memory-device-bitmask-list" class="paragraph">
<p>Each memory type returned by <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a> <strong class="purple">must</strong>
have its <code>propertyFlags</code> set to one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code></p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> |<br>
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There <strong class="purple">must</strong> be at least one memory type with both the
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> and
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> bits set in its
<code>propertyFlags</code>.
There <strong class="purple">must</strong> be at least one memory type with the
<code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> bit set in its
<code>propertyFlags</code>.</p>
</div>
<div class="paragraph">
<p>For each pair of elements <strong>X</strong> and <strong>Y</strong> returned in <code>memoryTypes</code>, <strong>X</strong>
<strong class="purple">must</strong> be placed at a lower index position than <strong>Y</strong> if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either the set of bit flags returned in the <code>propertyFlags</code> member
of <strong>X</strong> is a strict subset of the set of bit flags returned in the
<code>propertyFlags</code> member of <strong>Y</strong>.</p>
</li>
<li>
<p>or the <code>propertyFlags</code> members of <strong>X</strong> and <strong>Y</strong> are equal, and <strong>X</strong>
belongs to a memory heap with greater performance (as determined in an
implementation-specific manner).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>There is no ordering requirement between <strong>X</strong> and <strong>Y</strong> elements for the case
their <code>propertyFlags</code> members are not in a subset relation.
That potentially allows more than one possible way to order the same set of
memory types.
Notice that the <a href="#memory-device-bitmask-list">list of all allowed memory
property flag combinations</a> is written in a valid order.
But if instead <code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> was before
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> |
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code>, the list would still be in a
valid order.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This ordering requirement enables applications to use a simple search loop
to select the desired memory type along the lines of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Find a memory in `memoryTypeBitsRequirement` that includes all of `requiredProperties`</span>
int32_t findProperties(<span class="directive">const</span> VkPhysicalDeviceMemoryProperties* pMemoryProperties,
                       uint32_t memoryTypeBitsRequirement,
                       VkMemoryPropertyFlags requiredProperties) {
    <span class="directive">const</span> uint32_t memoryCount = pMemoryProperties-&gt;memoryTypeCount;
    <span class="keyword">for</span> (uint32_t memoryIndex = <span class="integer">0</span>; memoryIndex &lt; memoryCount; ++memoryIndex) {
        <span class="directive">const</span> uint32_t memoryTypeBits = (<span class="integer">1</span> &lt;&lt; memoryIndex);
        <span class="directive">const</span> <span class="predefined-type">bool</span> isRequiredMemoryType = memoryTypeBitsRequirement &amp; memoryTypeBits;

        <span class="directive">const</span> VkMemoryPropertyFlags properties =
            pMemoryProperties-&gt;memoryTypes[memoryIndex].propertyFlags;
        <span class="directive">const</span> <span class="predefined-type">bool</span> hasRequiredProperties =
            (properties &amp; requiredProperties) == requiredProperties;

        <span class="keyword">if</span> (isRequiredMemoryType &amp;&amp; hasRequiredProperties)
            <span class="keyword">return</span> <span class="keyword">static_cast</span>&lt;int32_t&gt;(memoryIndex);
    }

    <span class="comment">// failed to find memory type</span>
    <span class="keyword">return</span> -<span class="integer">1</span>;
}

<span class="comment">// Try to find an optimal memory type, or if it does not exist try fallback memory type</span>
<span class="comment">// `device` is the VkDevice</span>
<span class="comment">// `image` is the VkImage that requires memory to be bound</span>
<span class="comment">// `memoryProperties` properties as returned by vkGetPhysicalDeviceMemoryProperties</span>
<span class="comment">// `requiredProperties` are the property flags that must be present</span>
<span class="comment">// `optimalProperties` are the property flags that are preferred by the application</span>
VkMemoryRequirements memoryRequirements;
vkGetImageMemoryRequirements(device, image, &amp;memoryRequirements);
int32_t memoryType =
    findProperties(&amp;memoryProperties, memoryRequirements.memoryTypeBits, optimalProperties);
<span class="keyword">if</span> (memoryType == -<span class="integer">1</span>) <span class="comment">// not found; try fallback properties</span>
    memoryType =
        findProperties(&amp;memoryProperties, memoryRequirements.memoryTypeBits, requiredProperties);</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query memory properties, call:</p>
</div>
<div id="vkGetPhysicalDeviceMemoryProperties2KHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetPhysicalDeviceMemoryProperties2KHR(
    VkPhysicalDevice                            physicalDevice,
    VkPhysicalDeviceMemoryProperties2*          pMemoryProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>physicalDevice</code> is the handle to the device to query.</p>
</li>
<li>
<p><code>pMemoryProperties</code> points to an instance of
<code>VkPhysicalDeviceMemoryProperties2</code> structure in which the
properties are returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkGetPhysicalDeviceMemoryProperties2</code> behaves similarly to
<a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a>, with the ability to return
extended information in a <code>pNext</code> chain of output structures.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetPhysicalDeviceMemoryProperties2-physicalDevice-parameter"></a> <code>physicalDevice</code> <strong class="purple">must</strong> be a valid <code>VkPhysicalDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetPhysicalDeviceMemoryProperties2-pMemoryProperties-parameter"></a> <code>pMemoryProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkPhysicalDeviceMemoryProperties2</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkPhysicalDeviceMemoryProperties2</code> structure is defined as:</p>
</div>
<div id="VkPhysicalDeviceMemoryProperties2" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkPhysicalDeviceMemoryProperties2 {
    VkStructureType                     sType;
    <span class="directive">void</span>*                               pNext;
    VkPhysicalDeviceMemoryProperties    memoryProperties;
} VkPhysicalDeviceMemoryProperties2;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkPhysicalDeviceMemoryProperties2KHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkPhysicalDeviceMemoryProperties2 VkPhysicalDeviceMemoryProperties2KHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memoryProperties</code> is a structure of type
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a> which is populated with the same
values as in <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkPhysicalDeviceMemoryProperties2-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_PHYSICAL_DEVICE_MEMORY_PROPERTIES_2</code></p>
</li>
<li>
<p><a id="VUID-VkPhysicalDeviceMemoryProperties2-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryHeap</code> structure is defined as:</p>
</div>
<div id="VkMemoryHeap" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryHeap {
    VkDeviceSize         size;
    VkMemoryHeapFlags    flags;
} VkMemoryHeap;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>size</code> is the total memory size in bytes in the heap.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkMemoryHeapFlagBits">VkMemoryHeapFlagBits</a> specifying
attribute flags for the heap.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="#VkMemoryHeap">VkMemoryHeap</a>::<code>flags</code>, indicating
attribute flags for the heap, are:</p>
</div>
<div id="VkMemoryHeapFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkMemoryHeapFlagBits {
    VK_MEMORY_HEAP_DEVICE_LOCAL_BIT = <span class="hex">0x00000001</span>,
    VK_MEMORY_HEAP_MULTI_INSTANCE_BIT = <span class="hex">0x00000002</span>,
    VK_MEMORY_HEAP_MULTI_INSTANCE_BIT_KHR = VK_MEMORY_HEAP_MULTI_INSTANCE_BIT,
} VkMemoryHeapFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code> specifies that the heap
corresponds to device local memory.
Device local memory <strong class="purple">may</strong> have different performance characteristics than
host local memory, and <strong class="purple">may</strong> support different memory property flags.</p>
</li>
<li>
<p><code>VK_MEMORY_HEAP_MULTI_INSTANCE_BIT</code> specifies that in a logical
device representing more than one physical device, there is a
per-physical device instance of the heap memory.
By default, an allocation from such a heap will be replicated to each
physical device’s instance of the heap.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryHeapFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryHeapFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryHeapFlags</code> is a bitmask type for setting a mask of zero or more
<a href="#VkMemoryHeapFlagBits">VkMemoryHeapFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryType</code> structure is defined as:</p>
</div>
<div id="VkMemoryType" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryType {
    VkMemoryPropertyFlags    propertyFlags;
    uint32_t                 heapIndex;
} VkMemoryType;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>heapIndex</code> describes which memory heap this memory type corresponds
to, and <strong class="purple">must</strong> be less than <code>memoryHeapCount</code> from the
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a> structure.</p>
</li>
<li>
<p><code>propertyFlags</code> is a bitmask of <a href="#VkMemoryPropertyFlagBits">VkMemoryPropertyFlagBits</a> of
properties for this memory type.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in <a href="#VkMemoryType">VkMemoryType</a>::<code>propertyFlags</code>,
indicating properties of a memory heap, are:</p>
</div>
<div id="VkMemoryPropertyFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkMemoryPropertyFlagBits {
    VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT = <span class="hex">0x00000001</span>,
    VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT = <span class="hex">0x00000002</span>,
    VK_MEMORY_PROPERTY_HOST_COHERENT_BIT = <span class="hex">0x00000004</span>,
    VK_MEMORY_PROPERTY_HOST_CACHED_BIT = <span class="hex">0x00000008</span>,
    VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT = <span class="hex">0x00000010</span>,
} VkMemoryPropertyFlagBits;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_MEMORY_PROPERTY_DEVICE_LOCAL_BIT</code> bit specifies that memory
allocated with this type is the most efficient for device access.
This property will be set if and only if the memory type belongs to a
heap with the <code>VK_MEMORY_HEAP_DEVICE_LOCAL_BIT</code> set.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> bit specifies that memory
allocated with this type <strong class="purple">can</strong> be mapped for host access using
<a href="#vkMapMemory">vkMapMemory</a>.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> bit specifies that the host
cache management commands <a href="#vkFlushMappedMemoryRanges">vkFlushMappedMemoryRanges</a> and
<a href="#vkInvalidateMappedMemoryRanges">vkInvalidateMappedMemoryRanges</a> are not needed to flush host writes
to the device or make device writes visible to the host, respectively.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> bit specifies that memory
allocated with this type is cached on the host.
Host memory accesses to uncached memory are slower than to cached
memory, however uncached memory is always host coherent.</p>
</li>
<li>
<p><code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> bit specifies that the
memory type only allows device access to the memory.
Memory types <strong class="purple">must</strong> not have both
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> and
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> set.
Additionally, the object’s backing memory <strong class="purple">may</strong> be provided by the
implementation lazily as specified in <a href="#memory-device-lazy_allocation">Lazily Allocated Memory</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryPropertyFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryPropertyFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryPropertyFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkMemoryPropertyFlagBits">VkMemoryPropertyFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A Vulkan device operates on data in device memory via memory objects that
are represented in the API by a <code>VkDeviceMemory</code> handle:</p>
</div>
<div id="VkDeviceMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VK_DEFINE_NON_DISPATCHABLE_HANDLE(VkDeviceMemory)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To allocate memory objects, call:</p>
</div>
<div id="vkAllocateMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkAllocateMemory(
    VkDevice                                    device,
    <span class="directive">const</span> VkMemoryAllocateInfo*                 pAllocateInfo,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator,
    VkDeviceMemory*                             pMemory);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>pAllocateInfo</code> is a pointer to an instance of the
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure describing parameters of the
allocation.
A successful returned allocation <strong class="purple">must</strong> use the requested parameters — no substitution is permitted by the implementation.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pMemory</code> is a pointer to a <a href="#VkDeviceMemory">VkDeviceMemory</a> handle in which
information about the allocated memory is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Allocations returned by <code>vkAllocateMemory</code> are guaranteed to meet any
alignment requirement of the implementation.
For example, if an implementation requires 128 byte alignment for images and
64 byte alignment for buffers, the device memory returned through this
mechanism would be 128-byte aligned.
This ensures that applications <strong class="purple">can</strong> correctly suballocate objects of
different types (with potentially different alignment requirements) in the
same memory object.</p>
</div>
<div class="paragraph">
<p>When memory is allocated, its contents are undefined.</p>
</div>
<div class="paragraph">
<p>The maximum number of valid memory allocations that <strong class="purple">can</strong> exist
simultaneously within a <a href="chap4.html#VkDevice">VkDevice</a> <strong class="purple">may</strong> be restricted by implementation-
or platform-dependent limits.
If a call to <a href="#vkAllocateMemory">vkAllocateMemory</a> would cause the total number of
allocations to exceed these limits, such a call will fail and <strong class="purple">must</strong> return
<code>VK_ERROR_TOO_MANY_OBJECTS</code>.
The
<a href="chap34.html#features-limits-maxMemoryAllocationCount"><code>maxMemoryAllocationCount</code></a>
feature describes the number of allocations that <strong class="purple">can</strong> exist simultaneously
before encountering these internal limits.</p>
</div>
<div class="paragraph">
<p>Some platforms <strong class="purple">may</strong> have a limit on the maximum size of a single allocation.
For example, certain systems <strong class="purple">may</strong> fail to create allocations with a size
greater than or equal to 4GB.
Such a limit is implementation-dependent, and if such a failure occurs then
the error <code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code> <strong class="purple">must</strong> be returned.
This limit is advertised in
<a href="chap34.html#VkPhysicalDeviceMaintenance3Properties">VkPhysicalDeviceMaintenance3Properties</a>::<code>maxMemoryAllocationSize</code>.</p>
</div>
<div class="paragraph">
<p>The cumulative memory size allocated to a heap <strong class="purple">can</strong> be limited by the size
of the specified heap.
In such cases, allocated memory is tracked on a per-device and per-heap
basis.
Some platforms allow overallocation into other heaps.
The overallocation behavior <strong class="purple">can</strong> be specified through the
<code><a href="chap39.html#VK_AMD_memory_overallocation_behavior">VK_AMD_memory_overallocation_behavior</a></code> extension.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocateInfo-01713"></a>
<code>pAllocateInfo</code>-&gt;<code>allocationSize</code> <strong class="purple">must</strong> be less than or equal
to
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a>::<code>memoryHeaps</code>[<code>pAllocateInfo</code>-&gt;<code>memoryTypeIndex</code>].<code>size</code>
as returned by <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a> for the
<a href="chap4.html#VkPhysicalDevice">VkPhysicalDevice</a> that <code>device</code> was created from.</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocateInfo-01714"></a>
<code>pAllocateInfo</code>-&gt;<code>memoryTypeIndex</code> <strong class="purple">must</strong> be less than
<a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a>::<code>memoryTypeCount</code> as
returned by <a href="#vkGetPhysicalDeviceMemoryProperties">vkGetPhysicalDeviceMemoryProperties</a> for the
<a href="chap4.html#VkPhysicalDevice">VkPhysicalDevice</a> that <code>device</code> was created from.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkAllocateMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocateInfo-parameter"></a> <code>pAllocateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkMemoryAllocateInfo</code> structure</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkAllocateMemory-pMemory-parameter"></a> <code>pMemory</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkDeviceMemory</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryAllocateInfo</code> structure is defined as:</p>
</div>
<div id="VkMemoryAllocateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryAllocateInfo {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkDeviceSize       allocationSize;
    uint32_t           memoryTypeIndex;
} VkMemoryAllocateInfo;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>allocationSize</code> is the size of the allocation in bytes</p>
</li>
<li>
<p><code>memoryTypeIndex</code> is an index identifying a memory type from the
<code>memoryTypes</code> array of the <a href="#VkPhysicalDeviceMemoryProperties">VkPhysicalDeviceMemoryProperties</a>
structure</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An instance of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure defines a memory
import operation if the <code>pNext</code> chain contains an instance of one of the
following structures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#VkImportMemoryWin32HandleInfoKHR">VkImportMemoryWin32HandleInfoKHR</a> with non-zero <code>handleType</code>
value</p>
</li>
<li>
<p><a href="#VkImportMemoryFdInfoKHR">VkImportMemoryFdInfoKHR</a> with a non-zero <code>handleType</code> value</p>
</li>
<li>
<p><a href="#VkImportMemoryHostPointerInfoEXT">VkImportMemoryHostPointerInfoEXT</a> with a non-zero <code>handleType</code>
value</p>
</li>
<li>
<p><a href="#VkImportAndroidHardwareBufferInfoANDROID">VkImportAndroidHardwareBufferInfoANDROID</a> with a non-<code>NULL</code>
<code>buffer</code> value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing memory <strong class="purple">must</strong> not modify the content of the memory.
Implementations <strong class="purple">must</strong> ensure that importing memory does not enable the
importing Vulkan instance to access any memory or resources in other Vulkan
instances other than that corresponding to the memory object imported.
Implementations <strong class="purple">must</strong> also ensure accessing imported memory which has not
been initialized does not allow the importing Vulkan instance to obtain data
from the exporting Vulkan instance or vice-versa.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>How exported and imported memory is isolated is left to the implementation,
but applications should be aware that such isolation <strong class="purple">may</strong> prevent
implementations from placing multiple exportable memory objects in the same
physical or virtual page.
Hence, applications <strong class="purple">should</strong> avoid creating many small external memory
objects whenever possible.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When performing a memory import operation, it is the responsibility of the
application to ensure the external handles meet all valid usage
requirements.
However, implementations <strong class="purple">must</strong> perform sufficient validation of external
handles to ensure that the operation results in a valid memory object which
will not cause program termination, device loss, queue stalls, or corruption
of other resources when used as allowed according to its allocation
parameters.
If the external handle provided does not meet these requirements, the
implementation <strong class="purple">must</strong> fail the memory import operation with the error code
<code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-00639"></a>
    If the <code>pNext</code> chain contains an instance of
    <code>VkExportMemoryAllocateInfo</code>, and any of the handle types specified
    in <code>VkExportMemoryAllocateInfo</code>::<code>handleTypes</code> require a
    dedicated allocation, as reported by
    <a href="#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a> in
    <code>VkExternalImageFormatProperties</code>::<code>externalMemoryProperties</code>::<code>externalMemoryFeatures</code>
    or
    <code>VkExternalBufferProperties</code>::<code>externalMemoryProperties</code>::<code>externalMemoryFeatures</code>,
    the <code>pNext</code> chain must contain an instance of
<a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a>
or
<a href="#VkDedicatedAllocationMemoryAllocateInfoNV">VkDedicatedAllocationMemoryAllocateInfoNV</a>
    with either its <code>image</code> or <code>buffer</code> field set to a value other
    than <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-00640"></a>
If the <code>pNext</code> chain contains an instance of
<a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a>, it <strong class="purple">must</strong> not contain an instance of
<a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a> or
<a href="#VkExportMemoryWin32HandleInfoNV">VkExportMemoryWin32HandleInfoNV</a>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-00641"></a>
If the <code>pNext</code> chain contains an instance of
<a href="#VkImportMemoryWin32HandleInfoKHR">VkImportMemoryWin32HandleInfoKHR</a>, it <strong class="purple">must</strong> not contain an instance
of <a href="#VkImportMemoryWin32HandleInfoNV">VkImportMemoryWin32HandleInfoNV</a>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-01742"></a>
If the parameters define an import operation, the external handle
specified was created by the Vulkan API, and the external handle type is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_FD_BIT_KHR</code>, then the values
of <code>allocationSize</code> and <code>memoryTypeIndex</code> <strong class="purple">must</strong> match those
specified when the memory object being imported was created.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-None-00643"></a>
If the parameters define an import operation and the external handle
specified was created by the Vulkan API, the device mask specified by
<a href="#VkMemoryAllocateFlagsInfo">VkMemoryAllocateFlagsInfo</a> <strong class="purple">must</strong> match that specified when the
memory object being imported was allocated.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-None-00644"></a>
If the parameters define an import operation and the external handle
specified was created by the Vulkan API, the list of physical devices
that comprise the logical device passed to <a href="#vkAllocateMemory">vkAllocateMemory</a> <strong class="purple">must</strong>
match the list of physical devices that comprise the logical device on
which the memory was originally allocated.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-memoryTypeIndex-00645"></a>
If the parameters define an import operation and the external handle is
an NT handle or a global share handle created outside of the Vulkan API,
the value of <code>memoryTypeIndex</code> <strong class="purple">must</strong> be one of those returned by
<a href="#vkGetMemoryWin32HandlePropertiesKHR">vkGetMemoryWin32HandlePropertiesKHR</a>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-01743"></a>
If the parameters define an import operation, the external handle was
created by the Vulkan API, and the external handle type is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT_KHR</code> or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT_KHR</code>, then the
values of <code>allocationSize</code> and <code>memoryTypeIndex</code> <strong class="purple">must</strong> match
those specified when the memory object being imported was created.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-00646"></a>
If the parameters define an import operation and the external handle
type is <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_KMT_BIT</code>, or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE_BIT</code>,
<code>allocationSize</code> <strong class="purple">must</strong> match the size reported in the memory
requirements of the <code>image</code> or <code>buffer</code> member of the instance
of <code>VkDedicatedAllocationMemoryAllocateInfoNV</code> included in the
<code>pNext</code> chain.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-00647"></a>
If the parameters define an import operation and the external handle
type is <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_HEAP_BIT</code>,
<code>allocationSize</code> <strong class="purple">must</strong> match the size specified when creating the
Direct3D 12 heap from which the external handle was extracted.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-memoryTypeIndex-00648"></a>
If the parameters define an import operation and the external handle is
a POSIX file descriptor created outside of the Vulkan API, the value of
<code>memoryTypeIndex</code> <strong class="purple">must</strong> be one of those returned by
<a href="#vkGetMemoryFdPropertiesKHR">vkGetMemoryFdPropertiesKHR</a>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-memoryTypeIndex-01744"></a>
If the parameters define an import operation and the external handle is
a host pointer, the value of <code>memoryTypeIndex</code> <strong class="purple">must</strong> be one of those
returned by <a href="#vkGetMemoryHostPointerPropertiesEXT">vkGetMemoryHostPointerPropertiesEXT</a></p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-01745"></a>
If the parameters define an import operation and the external handle is
a host pointer, <code>allocationSize</code> <strong class="purple">must</strong> be an integer multiple of
<code>VkPhysicalDeviceExternalMemoryHostPropertiesEXT</code>::<code>minImportedHostPointerAlignment</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-allocationSize-02383"></a>
If the parameters define an import operation and the external handle
type is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>,
<code>allocationSize</code> <strong class="purple">must</strong> be the size returned by
<a href="#vkGetAndroidHardwareBufferPropertiesANDROID">vkGetAndroidHardwareBufferPropertiesANDROID</a> for the Android
hardware buffer.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-02384"></a>
If the parameters define an import operation and the external handle
type is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>,
and the <code>pNext</code> chain does not contain an instance of
<a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> or
<code>VkMemoryDedicatedAllocateInfo</code>::<code>image</code> is
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the Android hardware buffer <strong class="purple">must</strong> have a
<code>AHardwareBuffer_Desc</code>::<code>format</code> of
<code>AHARDWAREBUFFER_FORMAT_BLOB</code> and a
<code>AHardwareBuffer_Desc</code>::<code>usage</code> that includes
<code>AHARDWAREBUFFER_USAGE_GPU_DATA_BUFFER</code>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-memoryTypeIndex-02385"></a>
If the parameters define an import operation and the external handle
type is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>,
<code>memoryTypeIndex</code> <strong class="purple">must</strong> be one of those returned by
<a href="#vkGetAndroidHardwareBufferPropertiesANDROID">vkGetAndroidHardwareBufferPropertiesANDROID</a> for the Android
hardware buffer.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-01874"></a>
If the parameters do not define an import operation, and the <code>pNext</code>
chain contains an instance of <code>VkExportMemoryAllocateInfo</code> with
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>
included in its <code>handleTypes</code> member, and the <code>pNext</code> contains
an instance of <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> with <code>image</code> not
equal to <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, then <code>allocationSize</code> <strong class="purple">must</strong> be <code>0</code>,
otherwise <code>allocationSize</code> <strong class="purple">must</strong> be greater than <code>0</code>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-02386"></a>
If the parameters define an import operation, the external handle is an
Android hardware buffer, and the <code>pNext</code> chain includes an instance
of <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> with <code>image</code> that is not
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the Android hardware buffer’s
<code>AHardwareBuffer</code>::<code>usage</code> <strong class="purple">must</strong> include at least one of
<code>AHARDWAREBUFFER_USAGE_GPU_COLOR_OUTPUT</code> or
<code>AHARDWAREBUFFER_USAGE_GPU_SAMPLED_IMAGE</code>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-02387"></a>
If the parameters define an import operation, the external handle is an
Android hardware buffer, and the <code>pNext</code> chain includes an instance
of <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> with <code>image</code> that is not
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the format of <code>image</code> <strong class="purple">must</strong> be
<code>VK_FORMAT_UNDEFINED</code> or the format returned by
<a href="#vkGetAndroidHardwareBufferPropertiesANDROID">vkGetAndroidHardwareBufferPropertiesANDROID</a> in
<a href="#VkAndroidHardwareBufferFormatPropertiesANDROID">VkAndroidHardwareBufferFormatPropertiesANDROID</a>::<code>format</code> for
the Android hardware buffer.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-02388"></a>
If the parameters define an import operation, the external handle is an
Android hardware buffer, and the <code>pNext</code> chain includes an instance
of <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> with <code>image</code> that is not
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the width, height, and array layer dimensions of
<code>image</code> and the Android hardware buffer’s <code>AHardwareBuffer_Desc</code>
<strong class="purple">must</strong> be identical.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-02389"></a>
If the parameters define an import operation, the external handle is an
Android hardware buffer, and the <code>pNext</code> chain includes an instance
of <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> with <code>image</code> that is not
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, and the Android hardware buffer’s
<code>AHardwareBuffer</code>::<code>usage</code> includes
<code>AHARDWAREBUFFER_USAGE_GPU_MIPMAP_COMPLETE</code>, the <code>image</code> <strong class="purple">must</strong>
either have a complete mipmap chain, or it <strong class="purple">must</strong> have exactly <code>1</code> mip
level.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-02390"></a>
If the parameters define an import operation, the external handle is an
Android hardware buffer, and the <code>pNext</code> chain includes an instance
of <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a> with <code>image</code> that is not
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, each bit set in the usage of <code>image</code> <strong class="purple">must</strong> be
listed in
<a href="#memory-external-android-hardware-buffer-usage">AHardwareBuffer Usage
Equivalence</a>, and if there is a corresponding
<code>AHARDWAREBUFFER_USAGE</code> bit listed that bit <strong class="purple">must</strong> be included in the
Android hardware buffer’s <code>AHardwareBuffer_Desc</code>::<code>usage</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-pNext-pNext"></a> Each <code>pNext</code> member of any structure (including this one) in the <code>pNext</code> chain <strong class="purple">must</strong> be either <code>NULL</code> or a pointer to a valid instance of <a href="#VkDedicatedAllocationMemoryAllocateInfoNV">VkDedicatedAllocationMemoryAllocateInfoNV</a>, <a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a>, <a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a>, <a href="#VkExportMemoryWin32HandleInfoKHR">VkExportMemoryWin32HandleInfoKHR</a>, <a href="#VkExportMemoryWin32HandleInfoNV">VkExportMemoryWin32HandleInfoNV</a>, <a href="#VkImportAndroidHardwareBufferInfoANDROID">VkImportAndroidHardwareBufferInfoANDROID</a>, <a href="#VkImportMemoryFdInfoKHR">VkImportMemoryFdInfoKHR</a>, <a href="#VkImportMemoryHostPointerInfoEXT">VkImportMemoryHostPointerInfoEXT</a>, <a href="#VkImportMemoryWin32HandleInfoKHR">VkImportMemoryWin32HandleInfoKHR</a>, <a href="#VkImportMemoryWin32HandleInfoNV">VkImportMemoryWin32HandleInfoNV</a>, <a href="#VkMemoryAllocateFlagsInfo">VkMemoryAllocateFlagsInfo</a>, or <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a></p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateInfo-sType-unique"></a> Each <code>sType</code> member in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain includes a <code>VkMemoryDedicatedAllocateInfo</code>
structure, then that structure includes a handle of the sole buffer or image
resource that the memory <strong class="purple">can</strong> be bound to.</p>
</div>
<div class="paragraph">
<p>The <code>VkMemoryDedicatedAllocateInfo</code> structure is defined as:</p>
</div>
<div id="VkMemoryDedicatedAllocateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryDedicatedAllocateInfo {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkImage            image;
    VkBuffer           buffer;
} VkMemoryDedicatedAllocateInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkMemoryDedicatedAllocateInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkMemoryDedicatedAllocateInfo VkMemoryDedicatedAllocateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>image</code> is <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> or a handle of an image which this
memory will be bound to.</p>
</li>
<li>
<p><code>buffer</code> is <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> or a handle of a buffer which this
memory will be bound to.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-01432"></a>
At least one of <code>image</code> and <code>buffer</code> <strong class="purple">must</strong> be
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-01433"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>VkMemoryAllocateInfo</code>::<code>allocationSize</code> <strong class="purple">must</strong> equal the
<code>VkMemoryRequirements</code>::<code>size</code> of the image</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-01434"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>image</code> <strong class="purple">must</strong> have been
created without <code>VK_IMAGE_CREATE_SPARSE_BINDING_BIT</code> set in
<code>VkImageCreateInfo</code>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-buffer-01435"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>VkMemoryAllocateInfo</code>::<code>allocationSize</code> <strong class="purple">must</strong> equal the
<code>VkMemoryRequirements</code>::<code>size</code> of the buffer</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-buffer-01436"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>buffer</code> <strong class="purple">must</strong> have
been created without <code>VK_BUFFER_CREATE_SPARSE_BINDING_BIT</code> set in
<a href="chap11.html#VkBufferCreateInfo">VkBufferCreateInfo</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-01876"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> defines a memory import operation with handle
type <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_KMT_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_HEAP_BIT</code>, or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE_BIT</code>, and the
external handle was created by the Vulkan API, then the memory being
imported <strong class="purple">must</strong> also be a dedicated image allocation and <code>image</code> must
be identical to the image associated with the imported memory.</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-buffer-01877"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> defines a memory import operation with handle
type <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_KMT_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_HEAP_BIT</code>, or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE_BIT</code>, and the
external handle was created by the Vulkan API, then the memory being
imported <strong class="purple">must</strong> also be a dedicated buffer allocation and <code>buffer</code>
must be identical to the buffer associated with the imported memory.</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-01878"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> defines a memory import operation with handle
type <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_FD_BIT</code>, the memory
being imported <strong class="purple">must</strong> also be a dedicated image allocation and
<code>image</code> must be identical to the image associated with the imported
memory.</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-buffer-01879"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> defines a memory import operation with handle
type <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_FD_BIT</code>, the memory
being imported <strong class="purple">must</strong> also be a dedicated buffer allocation and
<code>buffer</code> must be identical to the buffer associated with the
imported memory.</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-01797"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>image</code> <strong class="purple">must</strong> not have
been created with <code>VK_IMAGE_CREATE_DISJOINT_BIT</code> set in
<a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_DEDICATED_ALLOCATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-image-parameter"></a> If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>image</code> <strong class="purple">must</strong> be a valid <code>VkImage</code> handle</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-buffer-parameter"></a> If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>buffer</code> <strong class="purple">must</strong> be a valid <code>VkBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-VkMemoryDedicatedAllocateInfo-commonparent"></a> Both of <code>buffer</code>, and <code>image</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain includes a
<code>VkDedicatedAllocationMemoryAllocateInfoNV</code> structure, then that
structure includes a handle of the sole buffer or image resource that the
memory <strong class="purple">can</strong> be bound to.</p>
</div>
<div class="paragraph">
<p>The <code>VkDedicatedAllocationMemoryAllocateInfoNV</code> structure is defined as:</p>
</div>
<div id="VkDedicatedAllocationMemoryAllocateInfoNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkDedicatedAllocationMemoryAllocateInfoNV {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkImage            image;
    VkBuffer           buffer;
} VkDedicatedAllocationMemoryAllocateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>image</code> is <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> or a handle of an image which this
memory will be bound to.</p>
</li>
<li>
<p><code>buffer</code> is <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> or a handle of a buffer which this
memory will be bound to.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-image-00649"></a>
At least one of <code>image</code> and <code>buffer</code> <strong class="purple">must</strong> be
<a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-image-00650"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the image <strong class="purple">must</strong> have been
created with
<code>VkDedicatedAllocationImageCreateInfoNV</code>::<code>dedicatedAllocation</code>
equal to <code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-buffer-00651"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the buffer <strong class="purple">must</strong> have been
created with
<code>VkDedicatedAllocationBufferCreateInfoNV</code>::<code>dedicatedAllocation</code>
equal to <code>VK_TRUE</code></p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-image-00652"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>VkMemoryAllocateInfo</code>::<code>allocationSize</code> <strong class="purple">must</strong> equal the
<code>VkMemoryRequirements</code>::<code>size</code> of the image</p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-buffer-00653"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>,
<code>VkMemoryAllocateInfo</code>::<code>allocationSize</code> <strong class="purple">must</strong> equal the
<code>VkMemoryRequirements</code>::<code>size</code> of the buffer</p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-image-00654"></a>
If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> defines a memory import operation, the memory
being imported <strong class="purple">must</strong> also be a dedicated image allocation and
<code>image</code> <strong class="purple">must</strong> be identical to the image associated with the imported
memory.</p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-buffer-00655"></a>
If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a> and
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> defines a memory import operation, the memory
being imported <strong class="purple">must</strong> also be a dedicated buffer allocation and
<code>buffer</code> <strong class="purple">must</strong> be identical to the buffer associated with the
imported memory.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_DEDICATED_ALLOCATION_MEMORY_ALLOCATE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-image-parameter"></a> If <code>image</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>image</code> <strong class="purple">must</strong> be a valid <code>VkImage</code> handle</p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-buffer-parameter"></a> If <code>buffer</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>buffer</code> <strong class="purple">must</strong> be a valid <code>VkBuffer</code> handle</p>
</li>
<li>
<p><a id="VUID-VkDedicatedAllocationMemoryAllocateInfoNV-commonparent"></a> Both of <code>buffer</code>, and <code>image</code> that are valid handles <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <code>VkDevice</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When allocating memory that <strong class="purple">may</strong> be exported to another process or Vulkan
instance, add a <a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a> structure to the
<code>pNext</code> chain of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure, specifying
the handle types that <strong class="purple">may</strong> be exported.</p>
</div>
<div class="paragraph">
<p>The <a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a> structure is defined as:</p>
</div>
<div id="VkExportMemoryAllocateInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkExportMemoryAllocateInfo {
    VkStructureType                    sType;
    <span class="directive">const</span> <span class="directive">void</span>*                        pNext;
    VkExternalMemoryHandleTypeFlags    handleTypes;
} VkExportMemoryAllocateInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkExportMemoryAllocateInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkExportMemoryAllocateInfo VkExportMemoryAllocateInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>handleTypes</code> is a bitmask of
<a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> specifying one or more memory
handle types the application <strong class="purple">can</strong> export from the resulting allocation.
The application <strong class="purple">can</strong> request multiple handle types for the same
allocation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportMemoryAllocateInfo-handleTypes-00656"></a>
The bits in <code>handleTypes</code> <strong class="purple">must</strong> be supported and compatible, as
reported by <a href="chap34.html#VkExternalImageFormatProperties">VkExternalImageFormatProperties</a> or
<a href="chap34.html#VkExternalBufferProperties">VkExternalBufferProperties</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportMemoryAllocateInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_MEMORY_ALLOCATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkExportMemoryAllocateInfo-handleTypes-parameter"></a> <code>handleTypes</code> <strong class="purple">must</strong> be a valid combination of <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To specify additional attributes of NT handles exported from a memory
object, add the <a href="#VkExportMemoryWin32HandleInfoKHR">VkExportMemoryWin32HandleInfoKHR</a> structure to the
<code>pNext</code> chain of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure.
The <code>VkExportMemoryWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkExportMemoryWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkExportMemoryWin32HandleInfoKHR {
    VkStructureType               sType;
    <span class="directive">const</span> <span class="directive">void</span>*                   pNext;
    <span class="directive">const</span> SECURITY_ATTRIBUTES*    pAttributes;
    DWORD                         dwAccess;
    LPCWSTR                       name;
} VkExportMemoryWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>pAttributes</code> is a pointer to a Windows <code>SECURITY_ATTRIBUTES</code>
structure specifying security attributes of the handle.</p>
</li>
<li>
<p><code>dwAccess</code> is a <code>DWORD</code> specifying access rights of the handle.</p>
</li>
<li>
<p><code>name</code> is a NULL-terminated UTF-16 string to associate with the
underlying resource referenced by NT handles exported from the created
memory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this structure is not present, or if <code>pAttributes</code> is set to <code>NULL</code>,
default security descriptor values will be used, and child processes created
by the application will not inherit the handle, as described in the MSDN
documentation for “Synchronization Object Security and Access Rights”<sup>1</sup>.
Further, if the structure is not present, the access rights will be</p>
</div>
<div class="paragraph">
<p><code>DXGI_SHARED_RESOURCE_READ</code> | <code>DXGI_SHARED_RESOURCE_WRITE</code></p>
</div>
<div class="paragraph">
<p>for handles of the following types:</p>
</div>
<div class="paragraph">
<p><code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code></p>
</div>
<div class="paragraph">
<p>And</p>
</div>
<div class="paragraph">
<p><code>GENERIC_ALL</code></p>
</div>
<div class="paragraph">
<p>for handles of the following types:</p>
</div>
<div class="paragraph">
<p><code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_HEAP_BIT</code>
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE_BIT</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">1</dt>
<dd>
<p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686670.aspx" class="bare">https://msdn.microsoft.com/en-us/library/windows/desktop/ms686670.aspx</a></p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportMemoryWin32HandleInfoKHR-handleTypes-00657"></a>
If <a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a>::<code>handleTypes</code> does not include
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_HEAP_BIT</code>, or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE_BIT</code>,
<code>VkExportMemoryWin32HandleInfoKHR</code> <strong class="purple">must</strong> not be in the <code>pNext</code>
chain of <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportMemoryWin32HandleInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_MEMORY_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkExportMemoryWin32HandleInfoKHR-pAttributes-parameter"></a> If <code>pAttributes</code> is not <code>NULL</code>, <code>pAttributes</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>SECURITY_ATTRIBUTES</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import memory from a Windows handle, add a
<a href="#VkImportMemoryWin32HandleInfoKHR">VkImportMemoryWin32HandleInfoKHR</a> structure to the <code>pNext</code> chain of
the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure.</p>
</div>
<div class="paragraph">
<p>The <code>VkImportMemoryWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkImportMemoryWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImportMemoryWin32HandleInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkExternalMemoryHandleTypeFlagBits    handleType;
    HANDLE                                handle;
    LPCWSTR                               name;
} VkImportMemoryWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>handleType</code> specifies the type of <code>handle</code> or <code>name</code>.</p>
</li>
<li>
<p><code>handle</code> is the external handle to import, or <code>NULL</code>.</p>
</li>
<li>
<p><code>name</code> is a NULL-terminated UTF-16 string naming the underlying
memory resource to import, or <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing memory objects from Windows handles does not transfer ownership of
the handle to the Vulkan implementation.
For handle types defined as NT handles, the application <strong class="purple">must</strong> release
ownership using the <code>CloseHandle</code> system call when the handle is no
longer needed.</p>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> import the same underlying memory into multiple instances
of Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.
In all cases, each import operation <strong class="purple">must</strong> create a distinct
<code>VkDeviceMemory</code> object.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handleType-00658"></a>
If <code>handleType</code> is not <code>0</code>, it <strong class="purple">must</strong> be supported for import, as
reported by <a href="chap34.html#VkExternalImageFormatProperties">VkExternalImageFormatProperties</a> or
<a href="chap34.html#VkExternalBufferProperties">VkExternalBufferProperties</a>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handle-00659"></a>
The memory from which <code>handle</code> was exported, or the memory named by
<code>name</code> <strong class="purple">must</strong> have been created on the same underlying physical
device as <code>device</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handleType-00660"></a>
If <code>handleType</code> is not <code>0</code>, it <strong class="purple">must</strong> be defined as an NT handle or a
global share handle.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handleType-01439"></a>
If <code>handleType</code> is not
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_TEXTURE_BIT</code>,
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_HEAP_BIT</code>, or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D12_RESOURCE_BIT</code>, <code>name</code>
<strong class="purple">must</strong> be <code>NULL</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handleType-01440"></a>
If <code>handleType</code> is not <code>0</code> and <code>handle</code> is <code>NULL</code>, <code>name</code>
<strong class="purple">must</strong> name a valid memory resource of the type specified by
<code>handleType</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handleType-00661"></a>
If <code>handleType</code> is not <code>0</code> and <code>name</code> is <code>NULL</code>, <code>handle</code>
<strong class="purple">must</strong> be a valid handle of the type specified by <code>handleType</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handle-01441"></a>
if <code>handle</code> is not <code>NULL</code>, <code>name</code> must be <code>NULL</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handle-01518"></a>
If <code>handle</code> is not <code>NULL</code>, it <strong class="purple">must</strong> obey any requirements listed for
<code>handleType</code> in
<a href="chap34.html#external-memory-handle-types-compatibility">external memory handle
types compatibility</a>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-name-01519"></a>
If <code>name</code> is not <code>NULL</code>, it <strong class="purple">must</strong> obey any requirements listed for
<code>handleType</code> in
<a href="chap34.html#external-memory-handle-types-compatibility">external memory handle
types compatibility</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_MEMORY_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoKHR-handleType-parameter"></a> If <code>handleType</code> is not <code>0</code>, <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a Windows handle representing the underlying resources of a Vulkan
device memory object, call:</p>
</div>
<div id="vkGetMemoryWin32HandleKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryWin32HandleKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkMemoryGetWin32HandleInfoKHR*        pGetWin32HandleInfo,
    HANDLE*                                     pHandle);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the device memory being
exported.</p>
</li>
<li>
<p><code>pGetWin32HandleInfo</code> is a pointer to an instance of the
<a href="#VkMemoryGetWin32HandleInfoKHR">VkMemoryGetWin32HandleInfoKHR</a> structure containing parameters of
the export operation.</p>
</li>
<li>
<p><code>pHandle</code> will return the Windows handle representing the underlying
resources of the device memory object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For handle types defined as NT handles, the handles returned by
<code>vkGetMemoryWin32HandleKHR</code> are owned by the application.
To avoid leaking resources, the application <strong class="purple">must</strong> release ownership of them
using the <code>CloseHandle</code> system call when they are no longer needed.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleKHR-pGetWin32HandleInfo-parameter"></a> <code>pGetWin32HandleInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkMemoryGetWin32HandleInfoKHR</code> structure</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleKHR-pHandle-parameter"></a> <code>pHandle</code> <strong class="purple">must</strong> be a valid pointer to a <code>HANDLE</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryGetWin32HandleInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkMemoryGetWin32HandleInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryGetWin32HandleInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkDeviceMemory                        memory;
    VkExternalMemoryHandleTypeFlagBits    handleType;
} VkMemoryGetWin32HandleInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memory</code> is the memory object from which the handle will be
exported.</p>
</li>
<li>
<p><code>handleType</code> is the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the handle returned depend on the value of
<code>handleType</code>.
See <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> for a description of the
properties of the defined external memory handle types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-handleType-00662"></a>
<code>handleType</code> <strong class="purple">must</strong> have been included in
<a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a>::<code>handleTypes</code> when <code>memory</code>
was created.</p>
</li>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-handleType-00663"></a>
If <code>handleType</code> is defined as an NT handle,
<a href="#vkGetMemoryWin32HandleKHR">vkGetMemoryWin32HandleKHR</a> <strong class="purple">must</strong> be called no more than once for
each valid unique combination of <code>memory</code> and <code>handleType</code>.</p>
</li>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-handleType-00664"></a>
<code>handleType</code> <strong class="purple">must</strong> be defined as an NT handle or a global share
handle.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_GET_WIN32_HANDLE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-VkMemoryGetWin32HandleInfoKHR-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Windows memory handles compatible with Vulkan <strong class="purple">may</strong> also be created by
non-Vulkan APIs using methods beyond the scope of this specification.
To determine the correct parameters to use when importing such handles,
call:</p>
</div>
<div id="vkGetMemoryWin32HandlePropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryWin32HandlePropertiesKHR(
    VkDevice                                    device,
    VkExternalMemoryHandleTypeFlagBits          handleType,
    HANDLE                                      handle,
    VkMemoryWin32HandlePropertiesKHR*           pMemoryWin32HandleProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that will be importing <code>handle</code>.</p>
</li>
<li>
<p><code>handleType</code> is the type of the handle <code>handle</code>.</p>
</li>
<li>
<p><code>handle</code> is the handle which will be imported.</p>
</li>
<li>
<p><code>pMemoryWin32HandleProperties</code> will return properties of
<code>handle</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryWin32HandlePropertiesKHR-handle-00665"></a>
<code>handle</code> <strong class="purple">must</strong> be an external memory handle created outside of the
Vulkan API.</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandlePropertiesKHR-handleType-00666"></a>
<code>handleType</code> <strong class="purple">must</strong> not be one of the handle types defined as opaque.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryWin32HandlePropertiesKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandlePropertiesKHR-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandlePropertiesKHR-pMemoryWin32HandleProperties-parameter"></a> <code>pMemoryWin32HandleProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkMemoryWin32HandlePropertiesKHR</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryWin32HandlePropertiesKHR</code> structure returned is defined as:</p>
</div>
<div id="VkMemoryWin32HandlePropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryWin32HandlePropertiesKHR {
    VkStructureType    sType;
    <span class="directive">void</span>*              pNext;
    uint32_t           memoryTypeBits;
} VkMemoryWin32HandlePropertiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memoryTypeBits</code> is a bitmask containing one bit set for every
memory type which the specified windows handle <strong class="purple">can</strong> be imported as.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryWin32HandlePropertiesKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_WIN32_HANDLE_PROPERTIES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryWin32HandlePropertiesKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import memory from a POSIX file descriptor handle, add a
<a href="#VkImportMemoryFdInfoKHR">VkImportMemoryFdInfoKHR</a> structure to the <code>pNext</code> chain of the
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure.
The <code>VkImportMemoryFdInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkImportMemoryFdInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImportMemoryFdInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkExternalMemoryHandleTypeFlagBits    handleType;
    <span class="predefined-type">int</span>                                   fd;
} VkImportMemoryFdInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>handleType</code> specifies the handle type of <code>fd</code>.</p>
</li>
<li>
<p><code>fd</code> is the external handle to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing memory from a file descriptor transfers ownership of the file
descriptor from the application to the Vulkan implementation.
The application <strong class="purple">must</strong> not perform any operations on the file descriptor
after a successful import.</p>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> import the same underlying memory into multiple instances
of Vulkan, into the same instance from which it was exported, and multiple
times into a given Vulkan instance.
In all cases, each import operation <strong class="purple">must</strong> create a distinct
<code>VkDeviceMemory</code> object.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-handleType-00667"></a>
If <code>handleType</code> is not <code>0</code>, it <strong class="purple">must</strong> be supported for import, as
reported by <a href="chap34.html#VkExternalImageFormatProperties">VkExternalImageFormatProperties</a> or
<a href="chap34.html#VkExternalBufferProperties">VkExternalBufferProperties</a>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-fd-00668"></a>
The memory from which <code>fd</code> was exported <strong class="purple">must</strong> have been created on
the same underlying physical device as <code>device</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-handleType-00669"></a>
If <code>handleType</code> is not <code>0</code>, it <strong class="purple">must</strong> be defined as a POSIX file
descriptor handle.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-handleType-00670"></a>
If <code>handleType</code> is not <code>0</code>, <code>fd</code> <strong class="purple">must</strong> be a valid handle of the
type specified by <code>handleType</code>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-fd-01746"></a>
The memory represented by <code>fd</code> <strong class="purple">must</strong> have been created from a
physical device and driver that is compatible with <code>device</code> and
<code>handleType</code>, as described in
<a href="chap34.html#external-memory-handle-types-compatibility">External memory handle types compatibility</a>.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-fd-01520"></a>
<code>fd</code> <strong class="purple">must</strong> obey any requirements listed for <code>handleType</code> in
<a href="chap34.html#external-memory-handle-types-compatibility">external memory handle
types compatibility</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_MEMORY_FD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryFdInfoKHR-handleType-parameter"></a> If <code>handleType</code> is not <code>0</code>, <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export a POSIX file descriptor representing the underlying resources of a
Vulkan device memory object, call:</p>
</div>
<div id="vkGetMemoryFdKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryFdKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkMemoryGetFdInfoKHR*                 pGetFdInfo,
    <span class="predefined-type">int</span>*                                        pFd);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the device memory being
exported.</p>
</li>
<li>
<p><code>pGetFdInfo</code> is a pointer to an instance of the
<a href="#VkMemoryGetFdInfoKHR">VkMemoryGetFdInfoKHR</a> structure containing parameters of the export
operation.</p>
</li>
<li>
<p><code>pFd</code> will return a file descriptor representing the underlying
resources of the device memory object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call to <code>vkGetMemoryFdKHR</code> <strong class="purple">must</strong> create a new file descriptor and
transfer ownership of it to the application.
To avoid leaking resources, the application <strong class="purple">must</strong> release ownership of the
file descriptor using the <code>close</code> system call when it is no longer
needed, or by importing a Vulkan memory object from it.
Where supported by the operating system, the implementation <strong class="purple">must</strong> set the
file descriptor to be closed automatically when an <code>execve</code> system call
is made.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryFdKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryFdKHR-pGetFdInfo-parameter"></a> <code>pGetFdInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkMemoryGetFdInfoKHR</code> structure</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryFdKHR-pFd-parameter"></a> <code>pFd</code> <strong class="purple">must</strong> be a valid pointer to a <code>int</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryGetFdInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkMemoryGetFdInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryGetFdInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkDeviceMemory                        memory;
    VkExternalMemoryHandleTypeFlagBits    handleType;
} VkMemoryGetFdInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memory</code> is the memory object from which the handle will be
exported.</p>
</li>
<li>
<p><code>handleType</code> is the type of handle requested.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The properties of the file descriptor exported depend on the value of
<code>handleType</code>.
See <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> for a description of the
properties of the defined external memory handle types.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The size of the exported file <strong class="purple">may</strong> be larger than the size requested by
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a>::allocationSize.
If <code>handleType</code> is <code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_DMA_BUF_BIT_EXT</code>,
then the application <strong class="purple">can</strong> query the file’s actual size with
<a href="man:lseek(2)">lseek(2)</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryGetFdInfoKHR-handleType-00671"></a>
<code>handleType</code> <strong class="purple">must</strong> have been included in
<a href="#VkExportMemoryAllocateInfo">VkExportMemoryAllocateInfo</a>::<code>handleTypes</code> when <code>memory</code>
was created.</p>
</li>
<li>
<p><a id="VUID-VkMemoryGetFdInfoKHR-handleType-00672"></a>
<code>handleType</code> <strong class="purple">must</strong> be defined as a POSIX file descriptor handle.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryGetFdInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_GET_FD_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryGetFdInfoKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryGetFdInfoKHR-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-VkMemoryGetFdInfoKHR-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>POSIX file descriptor memory handles compatible with Vulkan <strong class="purple">may</strong> also be
created by non-Vulkan APIs using methods beyond the scope of this
specification.
To determine the correct parameters to use when importing such handles,
call:</p>
</div>
<div id="vkGetMemoryFdPropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryFdPropertiesKHR(
    VkDevice                                    device,
    VkExternalMemoryHandleTypeFlagBits          handleType,
    <span class="predefined-type">int</span>                                         fd,
    VkMemoryFdPropertiesKHR*                    pMemoryFdProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that will be importing <code>fd</code>.</p>
</li>
<li>
<p><code>handleType</code> is the type of the handle <code>fd</code>.</p>
</li>
<li>
<p><code>fd</code> is the handle which will be imported.</p>
</li>
<li>
<p><code>pMemoryFdProperties</code> will return properties of the handle <code>fd</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryFdPropertiesKHR-fd-00673"></a>
<code>fd</code> <strong class="purple">must</strong> be an external memory handle created outside of the
Vulkan API.</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryFdPropertiesKHR-handleType-00674"></a>
<code>handleType</code> <strong class="purple">must</strong> not be
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_FD_BIT_KHR</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryFdPropertiesKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryFdPropertiesKHR-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryFdPropertiesKHR-pMemoryFdProperties-parameter"></a> <code>pMemoryFdProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkMemoryFdPropertiesKHR</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryFdPropertiesKHR</code> structure returned is defined as:</p>
</div>
<div id="VkMemoryFdPropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryFdPropertiesKHR {
    VkStructureType    sType;
    <span class="directive">void</span>*              pNext;
    uint32_t           memoryTypeBits;
} VkMemoryFdPropertiesKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memoryTypeBits</code> is a bitmask containing one bit set for every
memory type which the specified file descriptor <strong class="purple">can</strong> be imported as.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import memory from a host pointer, add a
<a href="#VkImportMemoryHostPointerInfoEXT">VkImportMemoryHostPointerInfoEXT</a> structure to the <code>pNext</code> chain of
the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure.
The <code>VkImportMemoryHostPointerInfoEXT</code> structure is defined as:</p>
</div>
<div id="VkImportMemoryHostPointerInfoEXT" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImportMemoryHostPointerInfoEXT {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkExternalMemoryHandleTypeFlagBits    handleType;
    <span class="directive">void</span>*                                 pHostPointer;
} VkImportMemoryHostPointerInfoEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>handleType</code> specifies the handle type.</p>
</li>
<li>
<p><code>pHostPointer</code> is the host pointer to import from.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing memory from a host pointer shares ownership of the memory between
the host and the Vulkan implementation.
The application <strong class="purple">can</strong> continue to access the memory through the host pointer
but it is the application’s responsibility to synchronize device and
non-device access to the underlying memory as defined in
<a href="#memory-device-hostaccess">Host Access to Device Memory Objects</a>.</p>
</div>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> import the same underlying memory into multiple instances
of Vulkan and multiple times into a given Vulkan instance.
However, implementations <strong class="purple">may</strong> fail to import the same underlying memory
multiple times into a given physical device due to platform constraints.</p>
</div>
<div class="paragraph">
<p>Importing memory from a particular host pointer <strong class="purple">may</strong> not be possible due to
additional platform-specific restrictions beyond the scope of this
specification in which case the implementation <strong class="purple">must</strong> fail the memory import
operation with the error code <code>VK_ERROR_INVALID_EXTERNAL_HANDLE_KHR</code>.</p>
</div>
<div class="paragraph">
<p>The application <strong class="purple">must</strong> ensure that the imported memory range remains valid
and accessible for the lifetime of the imported memory object.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-handleType-01747"></a>
If <code>handleType</code> is not <code>0</code>, it <strong class="purple">must</strong> be supported for import, as
reported in <a href="chap34.html#VkExternalMemoryPropertiesKHR">VkExternalMemoryPropertiesKHR</a></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-handleType-01748"></a>
If <code>handleType</code> is not <code>0</code>, it <strong class="purple">must</strong> be
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_ALLOCATION_BIT_EXT</code> or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_MAPPED_FOREIGN_MEMORY_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-pHostPointer-01749"></a>
<code>pHostPointer</code> <strong class="purple">must</strong> be a pointer aligned to an integer multiple of
<code>VkPhysicalDeviceExternalMemoryHostPropertiesEXT</code>::<code>minImportedHostPointerAlignment</code></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-handleType-01750"></a>
If <code>handleType</code> is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_ALLOCATION_BIT_EXT</code>,
<code>pHostPointer</code> <strong class="purple">must</strong> be a pointer to <code>allocationSize</code> number of
bytes of host memory, where <code>allocationSize</code> is the member of the
<code>VkMemoryAllocateInfo</code> structure this structure is chained to</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-handleType-01751"></a>
If <code>handleType</code> is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_MAPPED_FOREIGN_MEMORY_BIT_EXT</code>,
<code>pHostPointer</code> <strong class="purple">must</strong> be a pointer to <code>allocationSize</code> number of
bytes of host mapped foreign memory, where <code>allocationSize</code> is the
member of the <code>VkMemoryAllocateInfo</code> structure this structure is
chained to</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_MEMORY_HOST_POINTER_INFO_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryHostPointerInfoEXT-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the correct parameters to use when importing host pointers,
call:</p>
</div>
<div id="vkGetMemoryHostPointerPropertiesEXT" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryHostPointerPropertiesEXT(
    VkDevice                                    device,
    VkExternalMemoryHandleTypeFlagBits          handleType,
    <span class="directive">const</span> <span class="directive">void</span>*                                 pHostPointer,
    VkMemoryHostPointerPropertiesEXT*           pMemoryHostPointerProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that will be importing
<code>pHostPointer</code>.</p>
</li>
<li>
<p><code>handleType</code> is the type of the handle <code>pHostPointer</code>.</p>
</li>
<li>
<p><code>pHostPointer</code> is the host pointer to import from.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-handleType-01752"></a>
<code>handleType</code> <strong class="purple">must</strong> be
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_ALLOCATION_BIT_EXT</code> or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_MAPPED_FOREIGN_MEMORY_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-pHostPointer-01753"></a>
<code>pHostPointer</code> <strong class="purple">must</strong> be a pointer aligned to an integer multiple of
<code>VkPhysicalDeviceExternalMemoryHostPropertiesEXT</code>::<code>minImportedHostPointerAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-handleType-01754"></a>
If <code>handleType</code> is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_ALLOCATION_BIT_EXT</code>,
<code>pHostPointer</code> <strong class="purple">must</strong> be a pointer to host memory</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-handleType-01755"></a>
If <code>handleType</code> is
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_MAPPED_FOREIGN_MEMORY_BIT_EXT</code>,
<code>pHostPointer</code> <strong class="purple">must</strong> be a pointer to host mapped foreign memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid <a href="chap34.html#VkExternalMemoryHandleTypeFlagBits">VkExternalMemoryHandleTypeFlagBits</a> value</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryHostPointerPropertiesEXT-pMemoryHostPointerProperties-parameter"></a> <code>pMemoryHostPointerProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkMemoryHostPointerPropertiesEXT</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryHostPointerPropertiesEXT</code> structure is defined as:</p>
</div>
<div id="VkMemoryHostPointerPropertiesEXT" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryHostPointerPropertiesEXT {
    VkStructureType    sType;
    <span class="directive">void</span>*              pNext;
    uint32_t           memoryTypeBits;
} VkMemoryHostPointerPropertiesEXT;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memoryTypeBits</code> is a bitmask containing one bit set for every
memory type which the specified host pointer <strong class="purple">can</strong> be imported as.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryHostPointerPropertiesEXT-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_HOST_POINTER_PROPERTIES_EXT</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryHostPointerPropertiesEXT-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import memory created outside of the current Vulkan instance from an
Android hardware buffer, add a
<code>VkImportAndroidHardwareBufferInfoANDROID</code> structure to the <code>pNext</code>
chain of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure.
The <code>VkImportAndroidHardwareBufferInfoANDROID</code> structure is defined as:</p>
</div>
<div id="VkImportAndroidHardwareBufferInfoANDROID" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImportAndroidHardwareBufferInfoANDROID {
    VkStructureType            sType;
    <span class="directive">const</span> <span class="directive">void</span>*                pNext;
    <span class="keyword">struct</span> AHardwareBuffer*    buffer;
} VkImportAndroidHardwareBufferInfoANDROID;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>buffer</code> is the Android hardware buffer to import.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#vkAllocateMemory">vkAllocateMemory</a> command succeeds, the implementation <strong class="purple">must</strong>
acquire a reference to the imported hardware buffer, which it <strong class="purple">must</strong> release
when the device memory object is freed.
If the command fails, the implementation <strong class="purple">must</strong> not retain a reference.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportAndroidHardwareBufferInfoANDROID-buffer-01880"></a>
If <code>buffer</code> is not <code>NULL</code>, Android hardware buffers <strong class="purple">must</strong> be
supported for import, as reported by
<a href="chap34.html#VkExternalImageFormatProperties">VkExternalImageFormatProperties</a> or
<a href="chap34.html#VkExternalBufferProperties">VkExternalBufferProperties</a>.</p>
</li>
<li>
<p><a id="VUID-VkImportAndroidHardwareBufferInfoANDROID-buffer-01881"></a>
If <code>buffer</code> is not <code>NULL</code>, it <strong class="purple">must</strong> be a valid Android hardware
buffer object with <code>AHardwareBuffer_Desc</code>::<code>format</code> and
<code>AHardwareBuffer_Desc</code>::<code>usage</code> compatible with Vulkan as
described in <a href="#memory-external-android-hardware-buffer">Android Hardware
Buffers</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportAndroidHardwareBufferInfoANDROID-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_ANDROID_HARDWARE_BUFFER_INFO_ANDROID</code></p>
</li>
<li>
<p><a id="VUID-VkImportAndroidHardwareBufferInfoANDROID-buffer-parameter"></a> <code>buffer</code> <strong class="purple">must</strong> be a valid pointer to a <code>AHardwareBuffer</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To export an Android hardware buffer representing the underlying resources
of a Vulkan device memory object, call:</p>
</div>
<div id="vkGetMemoryAndroidHardwareBufferANDROID" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryAndroidHardwareBufferANDROID(
    VkDevice                                    device,
    <span class="directive">const</span> VkMemoryGetAndroidHardwareBufferInfoANDROID* pInfo,
    <span class="keyword">struct</span> AHardwareBuffer**                    pBuffer);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that created the device memory being
exported.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to an instance of the
<a href="#VkMemoryGetAndroidHardwareBufferInfoANDROID">VkMemoryGetAndroidHardwareBufferInfoANDROID</a> structure containing
parameters of the export operation.</p>
</li>
<li>
<p><code>pBuffer</code> will return an Android hardware buffer representing the
underlying resources of the device memory object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each call to <code>vkGetMemoryAndroidHardwareBufferANDROID</code> <strong class="purple">must</strong> return an
Android hardware buffer with a new reference acquired in addition to the
reference held by the <a href="#VkDeviceMemory">VkDeviceMemory</a>.
To avoid leaking resources, the application <strong class="purple">must</strong> release the reference by
calling <code>AHardwareBuffer_release</code> when it is no longer needed.
When called with the same handle in
<a href="#VkMemoryGetAndroidHardwareBufferInfoANDROID">VkMemoryGetAndroidHardwareBufferInfoANDROID</a>::<code>memory</code>,
<code>vkGetMemoryAndroidHardwareBufferANDROID</code> <strong class="purple">must</strong> return the same Android
hardware buffer object.
If the device memory was created by importing an Android hardware buffer,
<code>vkGetMemoryAndroidHardwareBufferANDROID</code> <strong class="purple">must</strong> return that same Android
hardware buffer object.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryAndroidHardwareBufferANDROID-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryAndroidHardwareBufferANDROID-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkMemoryGetAndroidHardwareBufferInfoANDROID</code> structure</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryAndroidHardwareBufferANDROID-pBuffer-parameter"></a> <code>pBuffer</code> <strong class="purple">must</strong> be a valid pointer to a valid pointer to a <code>AHardwareBuffer</code> value</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryGetAndroidHardwareBufferInfoANDROID</code> structure is defined
as:</p>
</div>
<div id="VkMemoryGetAndroidHardwareBufferInfoANDROID" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryGetAndroidHardwareBufferInfoANDROID {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkDeviceMemory     memory;
} VkMemoryGetAndroidHardwareBufferInfoANDROID;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memory</code> is the memory object from which the Android hardware buffer
will be exported.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryGetAndroidHardwareBufferInfoANDROID-handleTypes-01882"></a>
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>
<strong class="purple">must</strong> have been included in
<a href="#VkExportMemoryAllocateInfoKHR">VkExportMemoryAllocateInfoKHR</a>::<code>handleTypes</code> when <code>memory</code>
was created.</p>
</li>
<li>
<p><a id="VUID-VkMemoryGetAndroidHardwareBufferInfoANDROID-pNext-01883"></a>
If the <code>pNext</code> chain of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> used to
allocate <code>memory</code> included a <a href="#VkMemoryDedicatedAllocateInfo">VkMemoryDedicatedAllocateInfo</a>
with non-<code>NULL</code> <code>image</code> member, then that <code>image</code> <strong class="purple">must</strong> already
be bound to <code>memory</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the memory parameters to use when importing an Android hardware
buffer, call:</p>
</div>
<div id="vkGetAndroidHardwareBufferPropertiesANDROID" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetAndroidHardwareBufferPropertiesANDROID(
    VkDevice                                    device,
    <span class="directive">const</span> <span class="keyword">struct</span> AHardwareBuffer*               buffer,
    VkAndroidHardwareBufferPropertiesANDROID*   pProperties);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that will be importing <code>buffer</code>.</p>
</li>
<li>
<p><code>buffer</code> is the Android hardware buffer which will be imported.</p>
</li>
<li>
<p><code>pProperties</code> will return properties of <code>buffer</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetAndroidHardwareBufferPropertiesANDROID-buffer-01884"></a>
<code>buffer</code> <strong class="purple">must</strong> be a valid Android hardware buffer object with at
least one of the <code>AHARDWAREBUFFER_USAGE_GPU_</code>* flags in its
<code>AHardwareBuffer_Desc</code>::<code>usage</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetAndroidHardwareBufferPropertiesANDROID-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetAndroidHardwareBufferPropertiesANDROID-buffer-parameter"></a> <code>buffer</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>AHardwareBuffer</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetAndroidHardwareBufferPropertiesANDROID-pProperties-parameter"></a> <code>pProperties</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkAndroidHardwareBufferPropertiesANDROID</code> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_INVALID_EXTERNAL_HANDLE_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAndroidHardwareBufferPropertiesANDROID</code> structure returned is
defined as:</p>
</div>
<div id="VkAndroidHardwareBufferPropertiesANDROID" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkAndroidHardwareBufferPropertiesANDROID {
    VkStructureType    sType;
    <span class="directive">void</span>*              pNext;
    VkDeviceSize       allocationSize;
    uint32_t           memoryTypeBits;
} VkAndroidHardwareBufferPropertiesANDROID;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>allocationSize</code> is the size of the external memory</p>
</li>
<li>
<p><code>memoryTypeBits</code> is a bitmask containing one bit set for every
memory type which the specified Android hardware buffer <strong class="purple">can</strong> be imported
as.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To obtain format properties of an Android hardware buffer, include an
instance of <code>VkAndroidHardwareBufferFormatPropertiesANDROID</code> in the
<code>pNext</code> chain of the <a href="#VkAndroidHardwareBufferPropertiesANDROID">VkAndroidHardwareBufferPropertiesANDROID</a>
instance passed to <a href="#vkGetAndroidHardwareBufferPropertiesANDROID">vkGetAndroidHardwareBufferPropertiesANDROID</a>.
This structure is defined as:</p>
</div>
<div id="VkAndroidHardwareBufferFormatPropertiesANDROID" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkAndroidHardwareBufferFormatPropertiesANDROID {
    VkStructureType                  sType;
    <span class="directive">void</span>*                            pNext;
    VkFormat                         format;
    uint64_t                         externalFormat;
    VkFormatFeatureFlags             formatFeatures;
    VkComponentMapping               samplerYcbcrConversionComponents;
    VkSamplerYcbcrModelConversion    suggestedYcbcrModel;
    VkSamplerYcbcrRange              suggestedYcbcrRange;
    VkChromaLocation                 suggestedXChromaOffset;
    VkChromaLocation                 suggestedYChromaOffset;
} VkAndroidHardwareBufferFormatPropertiesANDROID;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>format</code> is the Vulkan format corresponding to the Android hardware
buffer’s format, or <code>VK_FORMAT_UNDEFINED</code> if there is not an
equivalent Vulkan format.</p>
</li>
<li>
<p><code>externalFormat</code> is an implementation-defined external format
identifier for use with <a href="chap11.html#VkExternalFormatANDROID">VkExternalFormatANDROID</a>.
It <strong class="purple">must</strong> not be zero.</p>
</li>
<li>
<p><code>formatFeatures</code> describes the capabilities of this external format
when used with an image bound to memory imported from <code>buffer</code>.</p>
</li>
<li>
<p><code>samplerYcbcrConversionComponents</code> is the component swizzle that
<strong class="purple">should</strong> be used in <a href="chap12.html#VkSamplerYcbcrConversionCreateInfo">VkSamplerYcbcrConversionCreateInfo</a>.</p>
</li>
<li>
<p><code>suggestedYcbcrModel</code> is a suggested color model to use in the
<a href="chap12.html#VkSamplerYcbcrConversionCreateInfo">VkSamplerYcbcrConversionCreateInfo</a>.</p>
</li>
<li>
<p><code>suggestedYcbcrRange</code> is a suggested numerical value range to use in
<a href="chap12.html#VkSamplerYcbcrConversionCreateInfo">VkSamplerYcbcrConversionCreateInfo</a>.</p>
</li>
<li>
<p><code>suggestedXChromaOffset</code> is a suggested X chroma offset to use in
<a href="chap12.html#VkSamplerYcbcrConversionCreateInfo">VkSamplerYcbcrConversionCreateInfo</a>.</p>
</li>
<li>
<p><code>suggestedYChromaOffset</code> is a suggested Y chroma offset to use in
<a href="chap12.html#VkSamplerYcbcrConversionCreateInfo">VkSamplerYcbcrConversionCreateInfo</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the Android hardware buffer has one of the formats listed in the
<a href="#memory-external-android-hardware-buffer-formats">Format Equivalence
table</a>, then <code>format</code> <strong class="purple">must</strong> have the equivalent Vulkan format listed in
the table.
Otherwise, <code>format</code> <strong class="purple">may</strong> be <code>VK_FORMAT_UNDEFINED</code>, indicating the
Android hardware buffer <strong class="purple">can</strong> only be used with an external format.</p>
</div>
<div class="paragraph">
<p>The <code>formatFeatures</code> member <strong class="purple">must</strong> include
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_BIT</code> and at least one of
<code>VK_FORMAT_FEATURE_MIDPOINT_CHROMA_SAMPLES_BIT</code> or
<code>VK_FORMAT_FEATURE_COSITED_CHROMA_SAMPLES_BIT</code>, and <strong class="purple">should</strong> include
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_LINEAR_BIT</code> and
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_YCBCR_CONVERSION_LINEAR_FILTER_BIT</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <code>formatFeatures</code> member only indicates the features available when
using an
<a href="#memory-external-android-hardware-buffer-external-formats">external-format
image</a> created from the Android hardware buffer.
Images from Android hardware buffers with a format other than
<code>VK_FORMAT_UNDEFINED</code> are subject to the format capabilities obtained
from <a href="#vkGetPhysicalDeviceFormatProperties2">vkGetPhysicalDeviceFormatProperties2</a>, and
<a href="#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a> with appropriate parameters.
These sets of features are independent of each other, e.g. the external
format will support sampler Y’C<sub>B</sub>C<sub>R</sub> conversion even if the non-external
format does not, and writing to non-external format images is possible but
writing to external format images is not.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Android hardware buffers with the same external format <strong class="purple">must</strong> have the same
support for <code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_LINEAR_BIT</code>,
<code>VK_FORMAT_FEATURE_MIDPOINT_CHROMA_SAMPLES_BIT</code>,
<code>VK_FORMAT_FEATURE_COSITED_CHROMA_SAMPLES_BIT</code>,
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_YCBCR_CONVERSION_LINEAR_FILTER_BIT</code>,
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_YCBCR_CONVERSION_SEPARATE_RECONSTRUCTION_FILTER_BIT</code>,
and
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_YCBCR_CONVERSION_CHROMA_RECONSTRUCTION_EXPLICIT_FORCEABLE_BIT</code>.
in <code>formatFeatures</code>.
Other format features <strong class="purple">may</strong> differ between Android hardware buffers that have
the same external format.
This allows applications to use the same <a href="chap12.html#VkSamplerYcbcrConversion">VkSamplerYcbcrConversion</a>
object (and samplers and pipelines created from them) for any Android
hardware buffers that have the same external format.</p>
</div>
<div class="paragraph">
<p>If <code>format</code> is not <code>VK_FORMAT_UNDEFINED</code>, then the value of
<code>samplerYcbcrConversionComponents</code> <strong class="purple">must</strong> be valid when used as the
<code>components</code> member of <a href="chap12.html#VkSamplerYcbcrConversionCreateInfo">VkSamplerYcbcrConversionCreateInfo</a> with
that format.
If <code>format</code> is <code>VK_FORMAT_UNDEFINED</code>, all members of
<code>samplerYcbcrConversionComponents</code> <strong class="purple">must</strong> be
<code>VK_COMPONENT_SWIZZLE_IDENTITY</code>.</p>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> not always be able to determine the color model,
numerical range, or chroma offsets of the image contents, so the values in
<code>VkAndroidHardwareBufferFormatPropertiesANDROID</code> are only suggestions.
Applications <strong class="purple">should</strong> treat these values as sensible defaults to use in the
absence of more reliable information obtained through some other means.
If the underlying physical device is also usable via OpenGL ES with the
<a href="https://www.khronos.org/registry/OpenGL/extensions/OES/OES_EGL_image_external.txt">GL_OES_EGL_image_external</a>
extension, the implementation <strong class="purple">should</strong> suggest values that will produce
similar sampled values as would be obtained by sampling the same external
image via <code>samplerExternalOES</code> in OpenGL ES using equivalent sampler
parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Since
<a href="https://www.khronos.org/registry/OpenGL/extensions/OES/OES_EGL_image_external.txt">GL_OES_EGL_image_external</a>
does not require the same sampling and conversion calculations as Vulkan
does, achieving identical results between APIs <strong class="purple">may</strong> not be possible on some
implementations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAndroidHardwareBufferFormatPropertiesANDROID-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ANDROID_HARDWARE_BUFFER_FORMAT_PROPERTIES_ANDROID</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When allocating memory that <strong class="purple">may</strong> be exported to another process or Vulkan
instance, add a <a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a> structure to the
<code>pNext</code> chain of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure, specifying
the handle types that <strong class="purple">may</strong> be exported.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a> structure is defined as:</p>
</div>
<div id="VkExportMemoryAllocateInfoNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkExportMemoryAllocateInfoNV {
    VkStructureType                      sType;
    <span class="directive">const</span> <span class="directive">void</span>*                          pNext;
    VkExternalMemoryHandleTypeFlagsNV    handleTypes;
} VkExportMemoryAllocateInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>handleTypes</code> is a bitmask of
<a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a> specifying one or more memory
handle types that <strong class="purple">may</strong> be exported.
Multiple handle types <strong class="purple">may</strong> be requested for the same allocation as long
as they are compatible, as reported by
<a href="chap34.html#vkGetPhysicalDeviceExternalImageFormatPropertiesNV">vkGetPhysicalDeviceExternalImageFormatPropertiesNV</a>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportMemoryAllocateInfoNV-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_MEMORY_ALLOCATE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkExportMemoryAllocateInfoNV-handleTypes-parameter"></a> <code>handleTypes</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When <a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a>::<code>handleTypes</code> includes
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT_NV</code>, add a
<code>VkExportMemoryWin32HandleInfoNV</code> to the <code>pNext</code> chain of the
<a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a> structure to specify security attributes
and access rights for the memory object’s external handle.</p>
</div>
<div class="paragraph">
<p>The <code>VkExportMemoryWin32HandleInfoNV</code> structure is defined as:</p>
</div>
<div id="VkExportMemoryWin32HandleInfoNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkExportMemoryWin32HandleInfoNV {
    VkStructureType               sType;
    <span class="directive">const</span> <span class="directive">void</span>*                   pNext;
    <span class="directive">const</span> SECURITY_ATTRIBUTES*    pAttributes;
    DWORD                         dwAccess;
} VkExportMemoryWin32HandleInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>pAttributes</code> is a pointer to a Windows <code>SECURITY_ATTRIBUTES</code>
structure specifying security attributes of the handle.</p>
</li>
<li>
<p><code>dwAccess</code> is a <code>DWORD</code> specifying access rights of the handle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this structure is not present, or if <code>pAttributes</code> is set to <code>NULL</code>,
default security descriptor values will be used, and child processes created
by the application will not inherit the handle, as described in the MSDN
documentation for “Synchronization Object Security and Access Rights”[1].
Further, if the structure is not present, the access rights will be</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DXGI_SHARED_RESOURCE_READ | DXGI_SHARED_RESOURCE_WRITE</pre>
</div>
</div>
<div class="paragraph">
<p>[1] <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686670.aspx" class="bare">https://msdn.microsoft.com/en-us/library/windows/desktop/ms686670.aspx</a></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportMemoryWin32HandleInfoNV-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_MEMORY_WIN32_HANDLE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkExportMemoryWin32HandleInfoNV-pAttributes-parameter"></a> If <code>pAttributes</code> is not <code>NULL</code>, <code>pAttributes</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>SECURITY_ATTRIBUTES</code> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To import memory created on the same physical device but outside of the
current Vulkan instance, add a <a href="#VkImportMemoryWin32HandleInfoNV">VkImportMemoryWin32HandleInfoNV</a>
structure to the <code>pNext</code> chain of the <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a>
structure, specifying a handle to and the type of the memory.</p>
</div>
<div class="paragraph">
<p>The <code>VkImportMemoryWin32HandleInfoNV</code> structure is defined as:</p>
</div>
<div id="VkImportMemoryWin32HandleInfoNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkImportMemoryWin32HandleInfoNV {
    VkStructureType                      sType;
    <span class="directive">const</span> <span class="directive">void</span>*                          pNext;
    VkExternalMemoryHandleTypeFlagsNV    handleType;
    HANDLE                               handle;
} VkImportMemoryWin32HandleInfoNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>handleType</code> is <code>0</code> or a <a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a>
value specifying the type of memory handle in <code>handle</code>.</p>
</li>
<li>
<p><code>handle</code> is a Windows <code>HANDLE</code> referring to the memory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>handleType</code> is <code>0</code>, this structure is ignored by consumers of the
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> structure it is chained from.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoNV-handleType-01327"></a>
<code>handleType</code> <strong class="purple">must</strong> not have more than one bit set.</p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoNV-handle-01328"></a>
<code>handle</code> <strong class="purple">must</strong> be a valid handle to memory, obtained as specified by
<code>handleType</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoNV-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMPORT_MEMORY_WIN32_HANDLE_INFO_NV</code></p>
</li>
<li>
<p><a id="VUID-VkImportMemoryWin32HandleInfoNV-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <code>handleType</code> are:</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <a href="#VkImportMemoryWin32HandleInfoNV">VkImportMemoryWin32HandleInfoNV</a>::<code>handleType</code>,
specifying the type of an external memory handle, are:</p>
</div>
<div id="VkExternalMemoryHandleTypeFlagBitsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkExternalMemoryHandleTypeFlagBitsNV {
    VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT_NV = <span class="hex">0x00000001</span>,
    VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT_NV = <span class="hex">0x00000002</span>,
    VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_IMAGE_BIT_NV = <span class="hex">0x00000004</span>,
    VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_IMAGE_KMT_BIT_NV = <span class="hex">0x00000008</span>,
} VkExternalMemoryHandleTypeFlagBitsNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT_NV</code> specifies a
handle to memory returned by <a href="#vkGetMemoryWin32HandleNV">vkGetMemoryWin32HandleNV</a>.</p>
</li>
<li>
<p><code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT_NV</code> specifies a
handle to memory returned by <a href="#vkGetMemoryWin32HandleNV">vkGetMemoryWin32HandleNV</a>, or one
duplicated from such a handle using <code>DuplicateHandle()</code>.</p>
</li>
<li>
<p><code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_IMAGE_BIT_NV</code> specifies a
valid NT handle to memory returned by
<code>IDXGIResource1::<code>CreateSharedHandle</code>()</code>, or a handle duplicated
from such a handle using <code>DuplicateHandle()</code>.</p>
</li>
<li>
<p><code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_D3D11_IMAGE_KMT_BIT_NV</code> specifies a
handle to memory returned by <code>IDXGIResource::GetSharedHandle()</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkExternalMemoryHandleTypeFlagsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkExternalMemoryHandleTypeFlagsNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkExternalMemoryHandleTypeFlagsNV</code> is a bitmask type for setting a mask
of zero or more <a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve the handle corresponding to a device memory object created with
<a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a>::<code>handleTypes</code> set to include
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_BIT_NV</code> or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT_NV</code>, call:</p>
</div>
<div id="vkGetMemoryWin32HandleNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkGetMemoryWin32HandleNV(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    VkExternalMemoryHandleTypeFlagsNV           handleType,
    HANDLE*                                     pHandle);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the <a href="#VkDeviceMemory">VkDeviceMemory</a> object.</p>
</li>
<li>
<p><code>handleType</code> is a bitmask of
<a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a> containing a single bit
specifying the type of handle requested.</p>
</li>
<li>
<p><code>handle</code> points to a Windows <code>HANDLE</code> in which the handle is
returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-handleType-01326"></a>
<code>handleType</code> <strong class="purple">must</strong> be a flag specified in
<a href="#VkExportMemoryAllocateInfoNV">VkExportMemoryAllocateInfoNV</a>::<code>handleTypes</code> when allocating
<code>memory</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-handleType-parameter"></a> <code>handleType</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkExternalMemoryHandleTypeFlagBitsNV">VkExternalMemoryHandleTypeFlagBitsNV</a> values</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-handleType-requiredbitmask"></a> <code>handleType</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-pHandle-parameter"></a> <code>pHandle</code> <strong class="purple">must</strong> be a valid pointer to a <code>HANDLE</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetMemoryWin32HandleNV-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_TOO_MANY_OBJECTS</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the <code>pNext</code> chain of <a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a> includes a
<code>VkMemoryAllocateFlagsInfo</code> structure, then that structure includes
flags and a device mask controlling how many instances of the memory will be
allocated.</p>
</div>
<div class="paragraph">
<p>The <code>VkMemoryAllocateFlagsInfo</code> structure is defined as:</p>
</div>
<div id="VkMemoryAllocateFlagsInfo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMemoryAllocateFlagsInfo {
    VkStructureType          sType;
    <span class="directive">const</span> <span class="directive">void</span>*              pNext;
    VkMemoryAllocateFlags    flags;
    uint32_t                 deviceMask;
} VkMemoryAllocateFlagsInfo;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkMemoryAllocateFlagsInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkMemoryAllocateFlagsInfo VkMemoryAllocateFlagsInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="#VkMemoryAllocateFlagBits">VkMemoryAllocateFlagBits</a> controlling
the allocation.</p>
</li>
<li>
<p><code>deviceMask</code> is a mask of physical devices in the logical device,
indicating that memory <strong class="purple">must</strong> be allocated on each device in the mask, if
<code>VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT</code> is set in <code>flags</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT</code> is not set, the number of
instances allocated depends on whether
<code>VK_MEMORY_HEAP_MULTI_INSTANCE_BIT</code> is set in the memory heap.
If <code>VK_MEMORY_HEAP_MULTI_INSTANCE_BIT</code> is set, then memory is allocated
for every physical device in the logical device (as if <code>deviceMask</code> has
bits set for all device indices).
If <code>VK_MEMORY_HEAP_MULTI_INSTANCE_BIT</code> is not set, then a single
instance of memory is allocated (as if <code>deviceMask</code> is set to one).</p>
</div>
<div class="paragraph">
<p>On some implementations, allocations from a multi-instance heap <strong class="purple">may</strong> consume
memory on all physical devices even if the <code>deviceMask</code> excludes some
devices.
If <a href="chap4.html#VkPhysicalDeviceGroupProperties">VkPhysicalDeviceGroupProperties</a>::<code>subsetAllocation</code> is
<code>VK_TRUE</code>, then memory is only consumed for the devices in the device
mask.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>In practice, most allocations on a multi-instance heap will be allocated
across all physical devices.
Unicast allocation support is an optional optimization for a minority of
allocations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryAllocateFlagsInfo-deviceMask-00675"></a>
If <code>VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT</code> is set, <code>deviceMask</code>
<strong class="purple">must</strong> be a valid device mask.</p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateFlagsInfo-deviceMask-00676"></a>
If <code>VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT</code> is set, <code>deviceMask</code>
<strong class="purple">must</strong> not be zero</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryAllocateFlagsInfo-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_FLAGS_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryAllocateFlagsInfo-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkMemoryAllocateFlagBits">VkMemoryAllocateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <a href="#VkMemoryAllocateFlagsInfo">VkMemoryAllocateFlagsInfo</a>::<code>flags</code>,
controlling device memory allocation, are:</p>
</div>
<div id="VkMemoryAllocateFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkMemoryAllocateFlagBits {
    VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT = <span class="hex">0x00000001</span>,
    VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT_KHR = VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT,
} VkMemoryAllocateFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkMemoryAllocateFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkMemoryAllocateFlagBits VkMemoryAllocateFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_MEMORY_ALLOCATE_DEVICE_MASK_BIT</code> specifies that memory will be
allocated for the devices in
<a href="#VkMemoryAllocateFlagsInfo">VkMemoryAllocateFlagsInfo</a>::<code>deviceMask</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryAllocateFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryAllocateFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkMemoryAllocateFlagsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkMemoryAllocateFlags VkMemoryAllocateFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryAllocateFlags</code> is a bitmask type for setting a mask of zero or
more <a href="#VkMemoryAllocateFlagBits">VkMemoryAllocateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To free a memory object, call:</p>
</div>
<div id="vkFreeMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkFreeMemory(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    <span class="directive">const</span> VkAllocationCallbacks*                pAllocator);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the <a href="#VkDeviceMemory">VkDeviceMemory</a> object to be freed.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before freeing a memory object, an application <strong class="purple">must</strong> ensure the memory
object is no longer in use by the device—​for example by command buffers in
the <em>pending state</em>.
The memory <strong class="purple">can</strong> remain bound to images or buffers at the time the memory
object is freed, but any further use of them (on host or device) for
anything other than destroying those objects will result in undefined
behavior.
If there are still any bound images or buffers, the memory <strong class="purple">may</strong> not be
immediately released by the implementation, but <strong class="purple">must</strong> be released by the
time all bound images and buffers have been destroyed.
Once memory is released, it is returned to the heap from which it was
allocated.</p>
</div>
<div class="paragraph">
<p>How memory objects are bound to Images and Buffers is described in detail in
the <a href="chap11.html#resources-association">Resource Memory Association</a> section.</p>
</div>
<div class="paragraph">
<p>If a memory object is mapped at the time it is freed, it is implicitly
unmapped.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>As described <a href="#memory-device-unmap-does-not-flush">below</a>, host writes are
not implicitly flushed when the memory object is unmapped, but the
implementation <strong class="purple">must</strong> guarantee that writes that have not been flushed do not
affect any other memory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeMemory-memory-00677"></a>
All submitted commands that refer to <code>memory</code> (via images or
buffers) <strong class="purple">must</strong> have completed execution</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFreeMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeMemory-memory-parameter"></a> If <code>memory</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFreeMemory-pAllocator-parameter"></a> If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <code>VkAllocationCallbacks</code> structure</p>
</li>
<li>
<p><a id="VUID-vkFreeMemory-memory-parent"></a> If <code>memory</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>memory</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="memory-device-hostaccess">10.2.1. Host Access to Device Memory Objects</h4>
<div class="paragraph">
<p>Memory objects created with <a href="#vkAllocateMemory">vkAllocateMemory</a> are not directly host
accessible.</p>
</div>
<div class="paragraph">
<p>Memory objects created with the memory property
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code> are considered <em>mappable</em>.
Memory objects <strong class="purple">must</strong> be mappable in order to be successfully mapped on the
host.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To retrieve a host virtual address pointer to a region of a mappable memory
object, call:</p>
</div>
<div id="vkMapMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkMapMemory(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    VkDeviceSize                                offset,
    VkDeviceSize                                size,
    VkMemoryMapFlags                            flags,
    <span class="directive">void</span>**                                      ppData);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the <a href="#VkDeviceMemory">VkDeviceMemory</a> object to be mapped.</p>
</li>
<li>
<p><code>offset</code> is a zero-based byte offset from the beginning of the
memory object.</p>
</li>
<li>
<p><code>size</code> is the size of the memory range to map, or
<code>VK_WHOLE_SIZE</code> to map from <code>offset</code> to the end of the
allocation.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
<li>
<p><code>ppData</code> points to a pointer in which is returned a host-accessible
pointer to the beginning of the mapped range.
This pointer minus <code>offset</code> <strong class="purple">must</strong> be aligned to at least
<a href="chap34.html#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>minMemoryMapAlignment</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After a successful call to <code>vkMapMemory</code> the memory object <code>memory</code>
is considered to be currently <em>host mapped</em>.
It is an application error to call <code>vkMapMemory</code> on a memory object that
is already host mapped.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><code>vkMapMemory</code> will fail if the implementation is unable to allocate an
appropriately sized contiguous virtual address range, e.g. due to virtual
address space fragmentation or platform limits.
In such cases, <code>vkMapMemory</code> <strong class="purple">must</strong> return
<code>VK_ERROR_MEMORY_MAP_FAILED</code>.
The application <strong class="purple">can</strong> improve the likelihood of success by reducing the size
of the mapped range and/or removing unneeded mappings using
<a href="#vkUnmapMemory">vkUnmapMemory</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="memory-device-hostaccess-hazards" class="paragraph">
<p><code>vkMapMemory</code> does not check whether the device memory is currently in
use before returning the host-accessible pointer.
The application <strong class="purple">must</strong> guarantee that any previously submitted command that
writes to this range has completed before the host reads from or writes to
that range, and that any previously submitted command that reads from that
range has completed before the host writes to that region (see
<a href="chap6.html#synchronization-submission-host-writes">here</a> for details on fulfilling
such a guarantee).
If the device memory was allocated without the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> set, these guarantees <strong class="purple">must</strong> be
made for an extended range: the application <strong class="purple">must</strong> round down the start of
the range to the nearest multiple of
<a href="chap34.html#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code>, and round the end
of the range up to the nearest multiple of
<a href="chap34.html#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code>.</p>
</div>
<div class="paragraph">
<p>While a range of device memory is host mapped, the application is
responsible for synchronizing both device and host access to that memory
range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>It is important for the application developer to become meticulously
familiar with all of the mechanisms described in the chapter on
<a href="chap6.html#synchronization">Synchronization and Cache Control</a> as they are crucial
to maintaining memory access ordering.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkMapMemory-memory-00678"></a>
<code>memory</code> <strong class="purple">must</strong> not be currently host mapped</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-offset-00679"></a>
<code>offset</code> <strong class="purple">must</strong> be less than the size of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-size-00680"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-size-00681"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
less than or equal to the size of the <code>memory</code> minus <code>offset</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-00682"></a>
<code>memory</code> <strong class="purple">must</strong> have been created with a memory type that reports
<code>VK_MEMORY_PROPERTY_HOST_VISIBLE_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-00683"></a>
<code>memory</code> <strong class="purple">must</strong> not have been allocated with multiple instances.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkMapMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-flags-zerobitmask"></a> <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkMapMemory-ppData-parameter"></a> <code>ppData</code> <strong class="purple">must</strong> be a valid pointer to a pointer value</p>
</li>
<li>
<p><a id="VUID-vkMapMemory-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>memory</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_MEMORY_MAP_FAILED</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkMemoryMapFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkMemoryMapFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkMemoryMapFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Two commands are provided to enable applications to work with non-coherent
memory allocations: <code>vkFlushMappedMemoryRanges</code> and
<code>vkInvalidateMappedMemoryRanges</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If the memory object was created with the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> set,
<code>vkFlushMappedMemoryRanges</code> and <code>vkInvalidateMappedMemoryRanges</code> are
unnecessary and <strong class="purple">may</strong> have a performance cost.
However, <a href="chap6.html#synchronization-dependencies-available-and-visible">availability
and visibility operations</a> still need to be managed on the device.
See the description of <a href="chap6.html#synchronization-host-access-types">host access
types</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>While memory objects imported from a handle type of
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_ALLOCATION_BIT_EXT</code> or
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_HOST_MAPPED_FOREIGN_MEMORY_BIT_EXT</code> are
inherently mapped to host address space, they are not considered to be host
mapped device memory unless they are explicitly host mapped using
<a href="#vkMapMemory">vkMapMemory</a>.
That means flushing or invalidating host caches with respect to host
accesses performed on such memory through the original host pointer
specified at import time is the responsibility of the application and <strong class="purple">must</strong>
be performed with appropriate synchronization primitives provided by the
platform which are outside the scope of Vulkan.
<code>vkFlushMappedMemoryRanges</code> and <code>vkInvalidateMappedMemoryRanges</code>,
however, <strong class="purple">can</strong> still be used on such memory objects to synchronize host
accesses performed through the host pointer of the host mapped device memory
range returned by <a href="#vkMapMemory">vkMapMemory</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To flush ranges of non-coherent memory from the host caches, call:</p>
</div>
<div id="vkFlushMappedMemoryRanges" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkFlushMappedMemoryRanges(
    VkDevice                                    device,
    uint32_t                                    memoryRangeCount,
    <span class="directive">const</span> VkMappedMemoryRange*                  pMemoryRanges);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory ranges.</p>
</li>
<li>
<p><code>memoryRangeCount</code> is the length of the <code>pMemoryRanges</code> array.</p>
</li>
<li>
<p><code>pMemoryRanges</code> is a pointer to an array of
<a href="#VkMappedMemoryRange">VkMappedMemoryRange</a> structures describing the memory ranges to
flush.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkFlushMappedMemoryRanges</code> guarantees that host writes to the memory
ranges described by <code>pMemoryRanges</code> are made available to the host
memory domain, such that they <strong class="purple">can</strong> be made available to the device memory
domain via <a href="chap6.html#synchronization-dependencies-available-and-visible">memory
domain operations</a> using the <code>VK_ACCESS_HOST_WRITE_BIT</code>
<a href="chap6.html#synchronization-access-types">access type</a>.</p>
</div>
<div class="paragraph">
<p>Within each range described by <code>pMemoryRanges</code>, each set of
<code>nonCoherentAtomSize</code> bytes in that range is flushed if any byte in that
set has been written by the host since it was first host mapped, or the last
time it was flushed.
If <code>pMemoryRanges</code> includes sets of <code>nonCoherentAtomSize</code> bytes
where no bytes have been written by the host, those bytes <strong class="purple">must</strong> not be
flushed.</p>
</div>
<div id="memory-device-unmap-does-not-flush" class="paragraph">
<p>Unmapping non-coherent memory does not implicitly flush the host mapped
memory, and host writes that have not been flushed <strong class="purple">may</strong> not ever be visible
to the device.
However, implementations <strong class="purple">must</strong> ensure that writes that have not been flushed
do not become visible to any other memory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The above guarantee avoids a potential memory corruption in scenarios where
host writes to a mapped memory object have not been flushed before the
memory is unmapped (or freed), and the virtual address range is subsequently
reused for a different mapping (or memory allocation).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkFlushMappedMemoryRanges-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkFlushMappedMemoryRanges-pMemoryRanges-parameter"></a> <code>pMemoryRanges</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryRangeCount</code> valid <code>VkMappedMemoryRange</code> structures</p>
</li>
<li>
<p><a id="VUID-vkFlushMappedMemoryRanges-memoryRangeCount-arraylength"></a> <code>memoryRangeCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To invalidate ranges of non-coherent memory from the host caches, call:</p>
</div>
<div id="vkInvalidateMappedMemoryRanges" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++">VkResult vkInvalidateMappedMemoryRanges(
    VkDevice                                    device,
    uint32_t                                    memoryRangeCount,
    <span class="directive">const</span> VkMappedMemoryRange*                  pMemoryRanges);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory ranges.</p>
</li>
<li>
<p><code>memoryRangeCount</code> is the length of the <code>pMemoryRanges</code> array.</p>
</li>
<li>
<p><code>pMemoryRanges</code> is a pointer to an array of
<a href="#VkMappedMemoryRange">VkMappedMemoryRange</a> structures describing the memory ranges to
invalidate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkInvalidateMappedMemoryRanges</code> guarantees that device writes to the
memory ranges described by <code>pMemoryRanges</code>, which have been made
available to the host memory domain using the <code>VK_ACCESS_HOST_WRITE_BIT</code>
and <code>VK_ACCESS_HOST_READ_BIT</code> <a href="chap6.html#synchronization-access-types">access
types</a>, are made visible to the host.
If a range of non-coherent memory is written by the host and then
invalidated without first being flushed, its contents are undefined.</p>
</div>
<div class="paragraph">
<p>Within each range described by <code>pMemoryRanges</code>, each set of
<code>nonCoherentAtomSize</code> bytes in that range is invalidated if any byte in
that set has been written by the device since it was first host mapped, or
the last time it was invalidated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Mapping non-coherent memory does not implicitly invalidate the mapped
memory, and device writes that have not been invalidated <strong class="purple">must</strong> be made
visible before the host reads or overwrites them.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkInvalidateMappedMemoryRanges-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkInvalidateMappedMemoryRanges-pMemoryRanges-parameter"></a> <code>pMemoryRanges</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryRangeCount</code> valid <code>VkMappedMemoryRange</code> structures</p>
</li>
<li>
<p><a id="VUID-vkInvalidateMappedMemoryRanges-memoryRangeCount-arraylength"></a> <code>memoryRangeCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMappedMemoryRange</code> structure is defined as:</p>
</div>
<div id="VkMappedMemoryRange" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">struct</span> VkMappedMemoryRange {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    VkDeviceMemory     memory;
    VkDeviceSize       offset;
    VkDeviceSize       size;
} VkMappedMemoryRange;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to an extension-specific structure.</p>
</li>
<li>
<p><code>memory</code> is the memory object to which this range belongs.</p>
</li>
<li>
<p><code>offset</code> is the zero-based byte offset from the beginning of the
memory object.</p>
</li>
<li>
<p><code>size</code> is either the size of range, or <code>VK_WHOLE_SIZE</code> to affect
the range from <code>offset</code> to the end of the current mapping of the
allocation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMappedMemoryRange-memory-00684"></a>
<code>memory</code> <strong class="purple">must</strong> be currently host mapped</p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-00685"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>offset</code> and
<code>size</code> <strong class="purple">must</strong> specify a range contained within the currently mapped
range of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-00686"></a>
If <code>size</code> is equal to <code>VK_WHOLE_SIZE</code>, <code>offset</code> <strong class="purple">must</strong> be
within the currently mapped range of <code>memory</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-01389"></a>
If <code>size</code> is equal to <code>VK_WHOLE_SIZE</code>, the end of the current
mapping of <code>memory</code> <strong class="purple">must</strong> be a multiple of
<a href="chap34.html#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code> bytes from the
beginning of the memory object.</p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-offset-00687"></a>
<code>offset</code> <strong class="purple">must</strong> be a multiple of
<a href="chap34.html#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-size-01390"></a>
If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong>
either be a multiple of
<a href="chap34.html#VkPhysicalDeviceLimits">VkPhysicalDeviceLimits</a>::<code>nonCoherentAtomSize</code>, or <code>offset</code>
plus <code>size</code> <strong class="purple">must</strong> equal the size of <code>memory</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMappedMemoryRange-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MAPPED_MEMORY_RANGE</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMappedMemoryRange-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To unmap a memory object once host access to it is no longer needed by the
application, call:</p>
</div>
<div id="vkUnmapMemory" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkUnmapMemory(
    VkDevice                                    device,
    VkDeviceMemory                              memory);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the memory object to be unmapped.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUnmapMemory-memory-00689"></a>
<code>memory</code> <strong class="purple">must</strong> be currently host mapped</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkUnmapMemory-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkUnmapMemory-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkUnmapMemory-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>memory</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="memory-device-lazy_allocation">10.2.2. Lazily Allocated Memory</h4>
<div class="paragraph">
<p>If the memory object is allocated from a heap with the
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code> bit set, that object’s backing
memory <strong class="purple">may</strong> be provided by the implementation lazily.
The actual committed size of the memory <strong class="purple">may</strong> initially be as small as zero
(or as large as the requested size), and monotonically increases as
additional memory is needed.</p>
</div>
<div class="paragraph">
<p>A memory type with this flag set is only allowed to be bound to a
<code>VkImage</code> whose usage flags include
<code>VK_IMAGE_USAGE_TRANSIENT_ATTACHMENT_BIT</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Using lazily allocated memory objects for framebuffer attachments that are
not needed once a render pass instance has completed <strong class="purple">may</strong> allow some
implementations to never allocate memory for such attachments.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To determine the amount of lazily-allocated memory that is currently
committed for a memory object, call:</p>
</div>
<div id="vkGetDeviceMemoryCommitment" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetDeviceMemoryCommitment(
    VkDevice                                    device,
    VkDeviceMemory                              memory,
    VkDeviceSize*                               pCommittedMemoryInBytes);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>memory</code> is the memory object being queried.</p>
</li>
<li>
<p><code>pCommittedMemoryInBytes</code> is a pointer to a <code>VkDeviceSize</code>
value in which the number of bytes currently committed is returned, on
success.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The implementation <strong class="purple">may</strong> update the commitment at any time, and the value
returned by this query <strong class="purple">may</strong> be out of date.</p>
</div>
<div class="paragraph">
<p>The implementation guarantees to allocate any committed memory from the
heapIndex indicated by the memory type that the memory object was created
with.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-memory-00690"></a>
<code>memory</code> <strong class="purple">must</strong> have been created with a memory type that reports
<code>VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-memory-parameter"></a> <code>memory</code> <strong class="purple">must</strong> be a valid <code>VkDeviceMemory</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-pCommittedMemoryInBytes-parameter"></a> <code>pCommittedMemoryInBytes</code> <strong class="purple">must</strong> be a valid pointer to a <code>VkDeviceSize</code> value</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceMemoryCommitment-memory-parent"></a> <code>memory</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="memory-external-handle-types">10.2.3. External Memory Handle Types</h4>
<div class="sect4">
<h5 id="memory-external-android-hardware-buffer">Android Hardware Buffer</h5>
<div class="paragraph">
<p>Android’s NDK defines <code>AHardwareBuffer</code> objects, which represent device
memory that is shareable across processes and that <strong class="purple">can</strong> be accessed by a
variety of media APIs and the hardware used to implement them.
These Android hardware buffer objects <strong class="purple">may</strong> be imported into
<a href="#VkDeviceMemory">VkDeviceMemory</a> objects for access via Vulkan, or exported from Vulkan.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To remove an unnecessary compile-time dependency, an incomplete type
definition of <code>AHardwareBuffer</code> is provided in the Vulkan headers:</p>
</div>
<div id="AHardwareBuffer" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">struct</span> AHardwareBuffer;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The actual <code>AHardwareBuffer</code> type is defined in Android NDK headers.</p>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The NDK format, usage, and size/dimensions of an <code>AHardwareBuffer</code> object
can be obtained with the <code>AHardwareBuffer_describe</code> function.
While Android hardware buffers can be imported to or exported from Vulkan
without using that function, valid usage and implementation behavior is
defined in terms of the <code>AHardwareBuffer_Desc</code> properties it returns.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Android hardware buffer objects are reference-counted using Android NDK
functions outside of the scope of this specification.
A <a href="#VkDeviceMemory">VkDeviceMemory</a> imported from an Android hardware buffer or that <strong class="purple">can</strong>
be exported to an Android hardware buffer <strong class="purple">must</strong> acquire a reference to its
<code>AHardwareBuffer</code> object, and <strong class="purple">must</strong> release this reference when the
device memory is freed.
During the host execution of a Vulkan command that has an Android hardware
buffer as a parameter (including indirect parameters via <code>pNext</code>
chains), the application <strong class="purple">must</strong> not decrement the Android hardware buffer’s
reference count to zero.</p>
</div>
<div class="paragraph">
<p>Android hardware buffers <strong class="purple">can</strong> be mapped and unmapped for CPU access using
the NDK functions.
These lock and unlock APIs are considered to acquire and release ownership
of the Android hardware buffer, and applications <strong class="purple">must</strong> follow the rules
described in <a href="chap11.html#resources-external-sharing">External Resource Sharing</a> to
transfer ownership between the Vulkan instance and these native APIs.</p>
</div>
<div class="paragraph">
<p>Android hardware buffers <strong class="purple">can</strong> be shared with external APIs and Vulkan
instances on the same device, and also with foreign devices.
When transferring ownership of the Android hardware buffer, the external and
foreign special queue families described in
<a href="chap6.html#synchronization-queue-transfers">Queue Family Ownership Transfer</a> are not identical.
All APIs which produce or consume Android hardware buffers are considered to
use foreign devices, except OpenGL ES contexts and Vulkan logical devices
that have matching device and driver UUIDs.
Implementations <strong class="purple">may</strong> treat a transfer to or from the foreign queue family as
if it were a transfer to or from the external queue family when the Android
hardware buffer’s usage only permits it to be used on the same physical
device.</p>
</div>
<div class="sect5">
<h6 id="memory-external-android-hardware-buffer-optimal-usages">Android Hardware Buffer Optimal Usages</h6>
<div class="paragraph">
<p>Vulkan buffer and image usage flags do not correspond exactly to Android
hardware buffer usage flags.
When allocating Android hardware buffers with non-Vulkan APIs, if any
<code>AHARDWAREBUFFER_USAGE_GPU_</code>* usage bits are included, by default the
allocator <strong class="purple">must</strong> allocate the memory in such a way that it supports Vulkan
usages and creation flags in the
<a href="#memory-external-android-hardware-buffer-usage">usage equivalence table</a>
which do not have Android hardware buffer equivalents.</p>
</div>
<div class="paragraph">
<p>The <a href="chap34.html#VkAndroidHardwareBufferUsageANDROID">VkAndroidHardwareBufferUsageANDROID</a> structure <strong class="purple">can</strong> be attached to
the <code>pNext</code> chain of a <a href="chap34.html#VkImageFormatProperties2">VkImageFormatProperties2</a> instance passed to
<a href="#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a> to obtain optimal Android
hardware buffer usage flags for specific Vulkan resource creation
parameters.
Some usage flags returned by these commands are <strong class="purple">required</strong> based on the input
parameters, but additional vendor-specific usage flags
(<code>AHARDWAREBUFFER_USAGE_VENDOR_</code>*) <strong class="purple">may</strong> also be returned.
Any Android hardware buffer allocated with these vendor-specific usage flags
and imported to Vulkan <strong class="purple">must</strong> only be bound to resources created with
parameters that are a subset of the parameters used to obtain the Android
hardware buffer usage, since the memory <strong class="purple">may</strong> have been allocated in a way
incompatible with other parameters.
If an Android hardware buffer is successfully allocated with additional
non-vendor-specific usage flags in addition to the recommended usage, it
<strong class="purple">must</strong> support being used in the same ways as an Android hardware buffer
allocated with only the recommended usage, and also in ways indicated by the
additional usage.</p>
</div>
</div>
<div class="sect5">
<h6 id="memory-external-android-hardware-buffer-external-formats">Android Hardware Buffer External Formats</h6>
<div class="paragraph">
<p>Android hardware buffers <strong class="purple">may</strong> represent images using implementation-specific
formats, layouts, color models, etc., which do not have Vulkan equivalents.
Such <em>external formats</em> are commonly used by external image sources such as
video decoders or cameras.
Vulkan <strong class="purple">can</strong> import Android hardware buffers that have external formats, but
since the image contents are in an undiscoverable and possibly proprietary
representation, images with external formats <strong class="purple">must</strong> only be used as sampled
images, <strong class="purple">must</strong> only be sampled with a sampler that has Y’C<sub>B</sub>C<sub>R</sub> conversion
enabled, and <strong class="purple">must</strong> have optimal tiling.</p>
</div>
<div class="paragraph">
<p>Images that will be backed by an Android hardware buffer <strong class="purple">can</strong> use an
external format by setting <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>format</code> to
<code>VK_FORMAT_UNDEFINED</code> and including an instance of
<a href="chap11.html#VkExternalFormatANDROID">VkExternalFormatANDROID</a> in the <code>pNext</code> chain.
Images <strong class="purple">can</strong> be created with an external format even if the Android hardware
buffer has a format which has an
<a href="#memory-external-android-hardware-buffer-formats">equivalent Vulkan format</a>
to enable consistent handling of images from sources that might use either
category of format.
However, all images created with an external format are subject to the valid
usage requirements associated with external formats, even if the Android
hardware buffer’s format has a Vulkan equivalent.
The external format of an Android hardware buffer <strong class="purple">can</strong> be obtained by
passing an instance of <a href="#VkAndroidHardwareBufferFormatPropertiesANDROID">VkAndroidHardwareBufferFormatPropertiesANDROID</a>
to <a href="#vkGetAndroidHardwareBufferPropertiesANDROID">vkGetAndroidHardwareBufferPropertiesANDROID</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="memory-external-android-hardware-buffer-image-resources">Android Hardware Buffer Image Resources</h6>
<div class="paragraph">
<p>Android hardware buffers have intrinsic width, height, format, and usage
properties, so Vulkan images bound to memory imported from an Android
hardware buffer <strong class="purple">must</strong> use dedicated allocations:
<code>VkMemoryDedicatedRequirements</code>::<code>requiresDedicatedAllocation</code> <strong class="purple">must</strong>
be <code>VK_TRUE</code> for images created with
<code>VkExternalMemoryImageCreateInfo</code>::<code>handleTypes</code> that includes
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>.
When creating an image that will be bound to an imported Android hardware
buffer, the image creation parameters <strong class="purple">must</strong> be equivalent to the
<code>AHardwareBuffer</code> properties as described by the valid usage of
<a href="#VkMemoryAllocateInfo">VkMemoryAllocateInfo</a>.
Similarly, device memory allocated for a dedicated image <strong class="purple">must</strong> not be
exported to an Android hardware buffer until it has been bound to that
image, and the implementation <strong class="purple">must</strong> return an Android hardware buffer with
properties derived from the image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>width</code> and <code>height</code> members of <code>AHardwareBuffer_Desc</code>
<strong class="purple">must</strong> be the same as the <code>width</code> and <code>height</code> members of
<a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>extent</code>, respectively.</p>
</li>
<li>
<p>The <code>layers</code> member of <code>AHardwareBuffer_Desc</code> <strong class="purple">must</strong> be the same as
the <code>arrayLayers</code> member of <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>.</p>
</li>
<li>
<p>The <code>format</code> member of <code>AHardwareBuffer_Desc</code> <strong class="purple">must</strong> be equivalent
to <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>format</code> as defined by
<a href="#memory-external-android-hardware-buffer-formats">AHardwareBuffer Format
Equivalence</a>.</p>
</li>
<li>
<p>The <code>usage</code> member of <code>AHardwareBuffer_Desc</code> <strong class="purple">must</strong> include bits
corresponding to bits included in <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>usage</code>
and <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code> where such a correspondence
exists according to
<a href="#memory-external-android-hardware-buffer-usage">AHardwareBuffer Usage
Equivalence</a>.
It <strong class="purple">may</strong> also include additional usage bits, including vendor-specific
usages.
Presence of vendor usage bits <strong class="purple">may</strong> make the Android hardware buffer only
usable in ways indicated by the image creation parameters, even when
used outside Vulkan, in a similar way that allocating the Android
hardware buffer with usage returned in
<a href="chap34.html#VkAndroidHardwareBufferUsageANDROID">VkAndroidHardwareBufferUsageANDROID</a> does.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> support fewer combinations of image creation parameters
for images with Android hardware buffer external handle type than for
non-external images.
Support for a given set of parameters <strong class="purple">can</strong> be determined by passing
<a href="chap34.html#VkExternalImageFormatProperties">VkExternalImageFormatProperties</a> to
<a href="#vkGetPhysicalDeviceImageFormatProperties2">vkGetPhysicalDeviceImageFormatProperties2</a> with <code>handleType</code> set to
<code>VK_EXTERNAL_MEMORY_HANDLE_TYPE_ANDROID_HARDWARE_BUFFER_BIT_ANDROID</code>.
Any Android hardware buffer successfully allocated outside Vulkan with usage
that includes <code>AHARDWAREBUFFER_USAGE_GPU_</code>* <strong class="purple">must</strong> be supported when using
equivalent Vulkan image parameters.
If a given choice of image parameters are supported for import, they <strong class="purple">can</strong>
also be used to create an image and memory that will be exported to an
Android hardware buffer.</p>
</div>
<table id="memory-external-android-hardware-buffer-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. AHardwareBuffer Format Equivalence</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">AHardwareBuffer Format</th>
<th class="tableblock halign-left valign-top">Vulkan Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_R8G8B8A8_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_R8G8B8A8_UNORM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_R8G8B8X8_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_R8G8B8A8_UNORM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_R8G8B8_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_R8G8B8_UNORM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_R5G6B5_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_R5G6B5_UNORM_PACK16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_R16G16B16A16_FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_R16G16B16A16_SFLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_R10G10B10A2_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_A2B10G10R10_UNORM_PACK32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_D16_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_D16_UNORM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_D24_UNORM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_X8_D24_UNORM_PACK32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_D24_UNORM_S8_UINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_D24_UNORM_S8_UINT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_D32_FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_D32_SFLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_D32_FLOAT_S8_UINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_D32_SFLOAT_S8_UINT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_FORMAT_S8_UINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_FORMAT_S8_UINT</code></p></td>
</tr>
</tbody>
</table>
<table id="memory-external-android-hardware-buffer-usage" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. AHardwareBuffer Usage Equivalence</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">AHardwareBuffer Usage</th>
<th class="tableblock halign-left valign-top">Vulkan Usage or Creation Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_USAGE_GPU_SAMPLED_IMAGE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_USAGE_SAMPLED_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_USAGE_GPU_SAMPLED_IMAGE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_USAGE_GPU_COLOR_OUTPUT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_USAGE_GPU_CUBE_MAP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_CREATE_CUBE_COMPATIBLE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AHARDWAREBUFFER_USAGE_GPU_MIPMAP_COMPLETE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None <sup>2</sup></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_CREATE_MUTABLE_FORMAT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_IMAGE_CREATE_EXTENDED_USAGE_BIT</code></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">2</dt>
<dd>
<p>The <code>AHARDWAREBUFFER_USAGE_GPU_MIPMAP_COMPLETE</code> flag does not
correspond to a Vulkan image usage or creation flag.
Instead, its presence indicates that the Android hardware buffer
contains a complete mipmap chain, and its absence indicates that the
Android hardware buffer contains only a single mip level.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>When using <code>VK_IMAGE_CREATE_MUTABLE_FORMAT_BIT</code> with Android hardware
buffer images, applications <strong class="purple">should</strong> use <a href="chap11.html#VkImageFormatListCreateInfoKHR">VkImageFormatListCreateInfoKHR</a>
to inform the implementation which view formats will be used with the image.
For some common sets of format, this allows some implementations to provide
significantly better performance when accessing the image via Vulkan.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="memory-external-android-hardware-buffer-buffer-resources">Android Hardware Buffer Buffer Resources</h6>
<div class="paragraph">
<p>Android hardware buffers with a format of <code>AHARDWAREBUFFER_FORMAT_BLOB</code>
and usage that includes <code>AHARDWAREBUFFER_USAGE_GPU_DATA_BUFFER</code> <strong class="purple">can</strong> be
used as the backing store for <a href="chap11.html#VkBuffer">VkBuffer</a> objects.
Such Android hardware buffers have a size in bytes specified by their
<code>width</code>; <code>height</code> and <code>layers</code> are both <code>1</code>.</p>
</div>
<div class="paragraph">
<p>Unlike images, buffer resources backed by Android hardware buffers do not
require dedicated allocations.</p>
</div>
<div class="paragraph">
<p>Exported <code>AHardwareBuffer</code> objects that do not have dedicated images
<strong class="purple">must</strong> have a format of <code>AHARDWAREBUFFER_FORMAT_BLOB</code>, usage <strong class="purple">must</strong> include
<code>AHARDWAREBUFFER_USAGE_GPU_DATA_BUFFER</code>, <code>width</code> <strong class="purple">must</strong> equal the
device memory allocation size, and <code>height</code> and <code>layers</code> <strong class="purple">must</strong> be <code>1</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="memory-peer-memory-features">10.2.4. Peer Memory Features</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><em>Peer memory</em> is memory that is allocated for a given physical device and
then bound to a resource and accessed by a different physical device, in a
logical device that represents multiple physical devices.
Some ways of reading and writing peer memory <strong class="purple">may</strong> not be supported by a
device.</p>
</div>
<div class="paragraph">
<p>To determine how peer memory <strong class="purple">can</strong> be accessed, call:</p>
</div>
<div id="vkGetDeviceGroupPeerMemoryFeaturesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> vkGetDeviceGroupPeerMemoryFeaturesKHR(
    VkDevice                                    device,
    uint32_t                                    heapIndex,
    uint32_t                                    localDeviceIndex,
    uint32_t                                    remoteDeviceIndex,
    VkPeerMemoryFeatureFlags*                   pPeerMemoryFeatures);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the memory.</p>
</li>
<li>
<p><code>heapIndex</code> is the index of the memory heap from which the memory is
allocated.</p>
</li>
<li>
<p><code>localDeviceIndex</code> is the device index of the physical device that
performs the memory access.</p>
</li>
<li>
<p><code>remoteDeviceIndex</code> is the device index of the physical device that
the memory is allocated for.</p>
</li>
<li>
<p><code>pPeerMemoryFeatures</code> is a pointer to a bitmask of
<a href="#VkPeerMemoryFeatureFlagBits">VkPeerMemoryFeatureFlagBits</a> indicating which types of memory
accesses are supported for the combination of heap, local, and remote
devices.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceGroupPeerMemoryFeatures-heapIndex-00691"></a>
<code>heapIndex</code> <strong class="purple">must</strong> be less than <code>memoryHeapCount</code></p>
</li>
<li>
<p><a id="VUID-vkGetDeviceGroupPeerMemoryFeatures-localDeviceIndex-00692"></a>
<code>localDeviceIndex</code> <strong class="purple">must</strong> be a valid device index</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceGroupPeerMemoryFeatures-remoteDeviceIndex-00693"></a>
<code>remoteDeviceIndex</code> <strong class="purple">must</strong> be a valid device index</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceGroupPeerMemoryFeatures-localDeviceIndex-00694"></a>
<code>localDeviceIndex</code> <strong class="purple">must</strong> not equal remoteDeviceIndex</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceGroupPeerMemoryFeatures-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <code>VkDevice</code> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceGroupPeerMemoryFeatures-pPeerMemoryFeatures-parameter"></a> <code>pPeerMemoryFeatures</code> <strong class="purple">must</strong> be a valid pointer to a <a href="#VkPeerMemoryFeatureFlags">VkPeerMemoryFeatureFlags</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">may</strong> be set in the value returned for
<a href="#vkGetDeviceGroupPeerMemoryFeatures">vkGetDeviceGroupPeerMemoryFeatures</a>::<code>pPeerMemoryFeatures</code>,
indicating the supported peer memory features, are:</p>
</div>
<div id="VkPeerMemoryFeatureFlagBits" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="keyword">enum</span> VkPeerMemoryFeatureFlagBits {
    VK_PEER_MEMORY_FEATURE_COPY_SRC_BIT = <span class="hex">0x00000001</span>,
    VK_PEER_MEMORY_FEATURE_COPY_DST_BIT = <span class="hex">0x00000002</span>,
    VK_PEER_MEMORY_FEATURE_GENERIC_SRC_BIT = <span class="hex">0x00000004</span>,
    VK_PEER_MEMORY_FEATURE_GENERIC_DST_BIT = <span class="hex">0x00000008</span>,
    VK_PEER_MEMORY_FEATURE_COPY_SRC_BIT_KHR = VK_PEER_MEMORY_FEATURE_COPY_SRC_BIT,
    VK_PEER_MEMORY_FEATURE_COPY_DST_BIT_KHR = VK_PEER_MEMORY_FEATURE_COPY_DST_BIT,
    VK_PEER_MEMORY_FEATURE_GENERIC_SRC_BIT_KHR = VK_PEER_MEMORY_FEATURE_GENERIC_SRC_BIT,
    VK_PEER_MEMORY_FEATURE_GENERIC_DST_BIT_KHR = VK_PEER_MEMORY_FEATURE_GENERIC_DST_BIT,
} VkPeerMemoryFeatureFlagBits;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkPeerMemoryFeatureFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkPeerMemoryFeatureFlagBits VkPeerMemoryFeatureFlagBitsKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PEER_MEMORY_FEATURE_COPY_SRC_BIT</code> specifies that the memory <strong class="purple">can</strong>
be accessed as the source of a <code>vkCmdCopyBuffer</code>,
<code>vkCmdCopyImage</code>, <code>vkCmdCopyBufferToImage</code>, or
<code>vkCmdCopyImageToBuffer</code> command.</p>
</li>
<li>
<p><code>VK_PEER_MEMORY_FEATURE_COPY_DST_BIT</code> specifies that the memory <strong class="purple">can</strong>
be accessed as the destination of a <code>vkCmdCopyBuffer</code>,
<code>vkCmdCopyImage</code>, <code>vkCmdCopyBufferToImage</code>, or
<code>vkCmdCopyImageToBuffer</code> command.</p>
</li>
<li>
<p><code>VK_PEER_MEMORY_FEATURE_GENERIC_SRC_BIT</code> specifies that the memory
<strong class="purple">can</strong> be read as any memory access type.</p>
</li>
<li>
<p><code>VK_PEER_MEMORY_FEATURE_GENERIC_DST_BIT</code> specifies that the memory
<strong class="purple">can</strong> be written as any memory access type.
Shader atomics are considered to be writes.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The peer memory features of a memory heap also apply to any accesses that
<strong class="purple">may</strong> be performed during <a href="chap6.html#synchronization-image-layout-transitions">image
layout transitions</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>VK_PEER_MEMORY_FEATURE_COPY_DST_BIT</code> <strong class="purple">must</strong> be supported for all host
local heaps and for at least one device local heap.</p>
</div>
<div class="paragraph">
<p>If a device does not support a peer memory feature, it is still valid to use
a resource that includes both local and peer memory bindings with the
corresponding access type as long as only the local bindings are actually
accessed.
For example, an application doing split-frame rendering would use
framebuffer attachments that include both local and peer memory bindings,
but would scissor the rendering to only update local memory.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPeerMemoryFeatureFlags" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkFlags VkPeerMemoryFeatureFlags;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkPeerMemoryFeatureFlagsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> VkPeerMemoryFeatureFlags VkPeerMemoryFeatureFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPeerMemoryFeatureFlags</code> is a bitmask type for setting a mask of zero
or more <a href="#VkPeerMemoryFeatureFlagBits">VkPeerMemoryFeatureFlagBits</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div id="footer">
<div id="footer-text">
Version 1.0.93<br>
Last updated 2018-11-18 02:54:52 -0800
</div>
</div>


</body>
</html>