<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<meta name="author" content="The Khronos® Vulkan Working Group">
<title>Vulkan® 1.1.170 - A Specification (with all registered Vulkan extensions)</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fff; color: #222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: black; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #0068b0; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Noto, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Noto, sans-serif; font-weight: normal; font-style: normal; color: black; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #4d4d4d; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #264357; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Noto, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #ddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #ddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #5e93b8; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #5e93b8; }

blockquote, blockquote p { line-height: 1.6; color: #333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #ddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: #fff; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: #eee; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f8; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; background-color: transparent; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.6; color: #264357; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #5e93b8; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #ddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Noto, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: black; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #fff; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #ddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 0 solid #ddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: black; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: black; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Noto, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddd; color: #5e93b8; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: black; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px hidden #666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eee; background-color: #264357; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: black; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #5e93b8; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #5e93b8; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: #eee; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.375em -0.75em; }

ul.inline > li { margin-left: 0.75em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px #fff; -webkit-box-shadow: 0 0 0 1px #ddd; box-shadow: 0 0 0 1px #ddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #29475c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #ddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eee; }

/* From https://github.com/KhronosGroup/Vulkan-Docs/pull/901 */
a code { color: inherit; }

/* From https://github.com/KhronosGroup/Vulkan-Docs/pull/1157 */
/* Make VUID anchor handles*/
li > p > a[id^="VUID-"] { visibility: hidden; position: absolute; z-index: 1001; width: 2.2ex; margin-left: -2.2ex; display: block; text-decoration: none !important; text-align: center; font-weight: normal; }

li > p > a[id^="VUID-"]:before { content: "\00A7"; font-size: 1em; display: block; padding-top: 0em; background: #fff; }

li > p:hover > a[id^="VUID-"], li > p > a[id^="VUID-"]:hover { visibility: visible; }

li > p > a[id^="VUID-"].link { color: black; text-decoration: none; }

/* TODO: not quite sure what these two do */
li > p > a[id^="VUID-"].link:hover { color: black; }

.vuid { color: gray; font-family: monospace; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin="" even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<!--ChunkedSearchJSMarker-->
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<style>
    #loading_msg {
        width: 100%;
        margin-left: auto;
        margin-right: auto;
        margin-top: 1ex;
        margin-bottom: 1ex;
        max-width: 62.5em;
        position: relative;
        padding-left: 1.5em;
        padding-right: 1.5em;
    }
    .hidden {display: none;}
</style>
<script>
    function hideElement(e){
        e.setAttribute("hidden", "");
        e.classList.add("hidden");
    }

    function unhideElement(e){
        e.classList.remove("hidden");
        e.removeAttribute("hidden");
    }

    function hideLoadableContent(){
        unhideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) hideElement(loadable);
    }

    function unhideLoadableContent(){
        hideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) unhideElement(loadable);
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
</head>
<body class="book toc2 toc-left">
<div id="header" style="max-width: 100%;">
<h1>Vulkan<sup>®</sup> 1.1.170 - A Specification (with all registered Vulkan extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan Working Group</span><br>
<span id="revnumber">version 1.1.170,</span>
<span id="revdate">2021-02-15 05:44:47Z</span>
<br><span id="revremark">from git branch: github-main commit: 815e07c850d642d996292f5cdec25d41ecdff0d0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="chap2.html#preamble">1. Preamble</a></li>
<li><a href="chap3.html#introduction">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap3.html#introduction-conventions">2.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap4.html#fundamentals">3. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap4.html#fundamentals-host-environment">3.1. Host and Device Environment</a></li>
<li><a href="chap4.html#fundamentals-execmodel">3.2. Execution Model</a></li>
<li><a href="chap4.html#fundamentals-objectmodel-overview">3.3. Object Model</a></li>
<li><a href="chap4.html#fundamentals-abi">3.4. Application Binary Interface</a></li>
<li><a href="chap4.html#fundamentals-commandsyntax">3.5. Command Syntax and Duration</a></li>
<li><a href="chap4.html#fundamentals-threadingbehavior">3.6. Threading Behavior</a></li>
<li><a href="chap4.html#fundamentals-errors">3.7. Errors</a></li>
<li><a href="chap4.html#fundamentals-numerics">3.8. Numeric Representation and Computation</a></li>
<li><a href="chap4.html#fundamentals-fixedconv">3.9. Fixed-Point Data Conversions</a></li>
<li><a href="chap4.html#fundamentals-common-objects">3.10. Common Object Types</a></li>
</ul>
</li>
<li><a href="chap5.html#initialization">4. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap5.html#initialization-functionpointers">4.1. Command Function Pointers</a></li>
<li><a href="chap5.html#initialization-instances">4.2. Instances</a></li>
</ul>
</li>
<li><a href="chap6.html#devsandqueues">5. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap6.html#devsandqueues-physical-device-enumeration">5.1. Physical Devices</a></li>
<li><a href="chap6.html#devsandqueues-devices">5.2. Devices</a></li>
<li><a href="chap6.html#devsandqueues-queues">5.3. Queues</a></li>
</ul>
</li>
<li><a href="chap7.html#commandbuffers">6. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap7.html#commandbuffers-lifecycle">6.1. Command Buffer Lifecycle</a></li>
<li><a href="chap7.html#commandbuffers-pools">6.2. Command Pools</a></li>
<li><a href="chap7.html#commandbuffer-allocation">6.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap7.html#commandbuffers-recording">6.4. Command Buffer Recording</a></li>
<li><a href="chap7.html#commandbuffers-submission">6.5. Command Buffer Submission</a></li>
<li><a href="chap7.html#commandbuffers-submission-progress">6.6. Queue Forward Progress</a></li>
<li><a href="chap7.html#commandbuffers-secondary">6.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap7.html#commandbuffers-devicemask">6.8. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap8.html#synchronization">7. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap8.html#synchronization-dependencies">7.1. Execution and Memory Dependencies</a></li>
<li><a href="chap8.html#synchronization-implicit">7.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap8.html#synchronization-fences">7.3. Fences</a></li>
<li><a href="chap8.html#synchronization-semaphores">7.4. Semaphores</a></li>
<li><a href="chap8.html#synchronization-events">7.5. Events</a></li>
<li><a href="chap8.html#synchronization-pipeline-barriers">7.6. Pipeline Barriers</a></li>
<li><a href="chap8.html#synchronization-memory-barriers">7.7. Memory Barriers</a></li>
<li><a href="chap8.html#synchronization-wait-idle">7.8. Wait Idle Operations</a></li>
<li><a href="chap8.html#synchronization-submission-host-writes">7.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap8.html#synchronization-device-group">7.10. Synchronization and Multiple Physical Devices</a></li>
<li><a href="chap8.html#calibrated-timestamps">7.11. Calibrated timestamps</a></li>
</ul>
</li>
<li><a href="chap9.html#renderpass">8. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap9.html#renderpass-creation">8.1. Render Pass Creation</a></li>
<li><a href="chap9.html#renderpass-compatibility">8.2. Render Pass Compatibility</a></li>
<li><a href="chap9.html#_framebuffers">8.3. Framebuffers</a></li>
<li><a href="chap9.html#renderpass-commands">8.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="chap10.html#shaders">9. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap10.html#shader-modules">9.1. Shader Modules</a></li>
<li><a href="chap10.html#shaders-execution">9.2. Shader Execution</a></li>
<li><a href="chap10.html#shaders-execution-memory-ordering">9.3. Shader Memory Access Ordering</a></li>
<li><a href="chap10.html#shaders-inputs">9.4. Shader Inputs and Outputs</a></li>
<li><a href="chap10.html#shaders-task">9.5. Task Shaders</a></li>
<li><a href="chap10.html#shaders-mesh">9.6. Mesh Shaders</a></li>
<li><a href="chap10.html#shaders-vertex">9.7. Vertex Shaders</a></li>
<li><a href="chap10.html#shaders-tessellation-control">9.8. Tessellation Control Shaders</a></li>
<li><a href="chap10.html#shaders-tessellation-evaluation">9.9. Tessellation Evaluation Shaders</a></li>
<li><a href="chap10.html#shaders-geometry">9.10. Geometry Shaders</a></li>
<li><a href="chap10.html#shaders-fragment">9.11. Fragment Shaders</a></li>
<li><a href="chap10.html#shaders-compute">9.12. Compute Shaders</a></li>
<li><a href="chap10.html#shaders-ray-generation">9.13. Ray Generation Shaders</a></li>
<li><a href="chap10.html#shaders-intersection">9.14. Intersection Shaders</a></li>
<li><a href="chap10.html#shaders-any-hit">9.15. Any-Hit Shaders</a></li>
<li><a href="chap10.html#shaders-closest-hit">9.16. Closest Hit Shaders</a></li>
<li><a href="chap10.html#shaders-miss">9.17. Miss Shaders</a></li>
<li><a href="chap10.html#shaders-callable">9.18. Callable Shaders</a></li>
<li><a href="chap10.html#shaders-interpolation-decorations">9.19. Interpolation Decorations</a></li>
<li><a href="chap10.html#shaders-staticuse">9.20. Static Use</a></li>
<li><a href="chap10.html#shaders-scope">9.21. Scope</a></li>
<li><a href="chap10.html#shaders-group-operations">9.22. Group Operations</a></li>
<li><a href="chap10.html#shaders-quad-operations">9.23. Quad Group Operations</a></li>
<li><a href="chap10.html#shaders-derivative-operations">9.24. Derivative Operations</a></li>
<li><a href="chap10.html#shaders-helper-invocations">9.25. Helper Invocations</a></li>
<li><a href="chap10.html#_cooperative_matrices">9.26. Cooperative Matrices</a></li>
<li><a href="chap10.html#shaders-validation-cache">9.27. Validation Cache</a></li>
</ul>
</li>
<li><a href="chap11.html#pipelines">10. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap11.html#pipelines-compute">10.1. Compute Pipelines</a></li>
<li><a href="chap11.html#pipelines-graphics">10.2. Graphics Pipelines</a></li>
<li><a href="chap11.html#pipelines-ray-tracing">10.3. Ray Tracing Pipelines</a></li>
<li><a href="chap11.html#pipelines-destruction">10.4. Pipeline Destruction</a></li>
<li><a href="chap11.html#pipelines-multiple">10.5. Multiple Pipeline Creation</a></li>
<li><a href="chap11.html#pipelines-pipeline-derivatives">10.6. Pipeline Derivatives</a></li>
<li><a href="chap11.html#pipelines-cache">10.7. Pipeline Cache</a></li>
<li><a href="chap11.html#pipelines-specialization-constants">10.8. Specialization Constants</a></li>
<li><a href="chap11.html#pipeline-library">10.9. Pipeline Libraries</a></li>
<li><a href="chap11.html#pipelines-binding">10.10. Pipeline Binding</a></li>
<li><a href="chap11.html#pipelines-dynamic-state">10.11. Dynamic State</a></li>
<li><a href="chap11.html#pipelines-shader-information">10.12. Pipeline Shader Information</a></li>
<li><a href="chap11.html#pipelines-compiler-control">10.13. Pipeline Compiler Control</a></li>
<li><a href="chap11.html#pipelines-creation-feedback">10.14. Pipeline Creation Feedback</a></li>
</ul>
</li>
<li><a href="chap12.html#memory">11. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap12.html#memory-host">11.1. Host Memory</a></li>
<li><a href="chap12.html#memory-device">11.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap13.html#resources">12. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap13.html#resources-buffers">12.1. Buffers</a></li>
<li><a href="chap13.html#resources-buffer-views">12.2. Buffer Views</a></li>
<li><a href="chap13.html#resources-images">12.3. Images</a></li>
<li><a href="chap13.html#resources-image-layouts">12.4. Image Layouts</a></li>
<li><a href="chap13.html#resources-image-views">12.5. Image Views</a></li>
<li><a href="chap13.html#resources-acceleration-structures">12.6. Acceleration Structures</a></li>
<li><a href="chap13.html#resources-association">12.7. Resource Memory Association</a></li>
<li><a href="chap13.html#resources-sharing">12.8. Resource Sharing Mode</a></li>
<li><a href="chap13.html#resources-memory-aliasing">12.9. Memory Aliasing</a></li>
</ul>
</li>
<li><a href="chap14.html#samplers">13. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap14.html#samplers-YCbCr-conversion">13.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> conversion</a></li>
</ul>
</li>
<li><a href="chap15.html#descriptorsets">14. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap15.html#descriptorsets-types">14.1. Descriptor Types</a></li>
<li><a href="chap15.html#descriptorsets-sets">14.2. Descriptor Sets</a></li>
<li><a href="chap15.html#_physical_storage_buffer_access">14.3. Physical Storage Buffer Access</a></li>
</ul>
</li>
<li><a href="chap16.html#interfaces">15. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap16.html#interfaces-iointerfaces">15.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap16.html#interfaces-vertexinput">15.2. Vertex Input Interface</a></li>
<li><a href="chap16.html#interfaces-fragmentoutput">15.3. Fragment Output Interface</a></li>
<li><a href="chap16.html#interfaces-inputattachment">15.4. Fragment Input Attachment Interface</a></li>
<li><a href="chap16.html#interfaces-raypipeline">15.5. Ray Tracing Pipeline Interface</a></li>
<li><a href="chap16.html#interfaces-resources">15.6. Shader Resource Interface</a></li>
<li><a href="chap16.html#interfaces-builtin-variables">15.7. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap17.html#textures">16. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap17.html#_image_operations_overview">16.1. Image Operations Overview</a></li>
<li><a href="chap17.html#_conversion_formulas">16.2. Conversion Formulas</a></li>
<li><a href="chap17.html#_texel_input_operations">16.3. Texel Input Operations</a></li>
<li><a href="chap17.html#_texel_output_operations">16.4. Texel Output Operations</a></li>
<li><a href="chap17.html#textures-normalized-operations">16.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap17.html#_unnormalized_texel_coordinate_operations">16.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap17.html#textures-integer-coordinate-operations">16.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap17.html#textures-sample-operations">16.8. Image Sample Operations</a></li>
<li><a href="chap17.html#textures-footprint">16.9. Texel Footprint Evaluation</a></li>
<li><a href="chap17.html#textures-instructions">16.10. Image Operation Steps</a></li>
<li><a href="chap17.html#textures-queries">16.11. Image Query Instructions</a></li>
</ul>
</li>
<li><a href="chap18.html#fragmentdensitymapops">17. Fragment Density Map Operations</a>
<ul class="sectlevel2">
<li><a href="chap18.html#_fragment_density_map_operations_overview">17.1. Fragment Density Map Operations Overview</a></li>
<li><a href="chap18.html#fragmentdensitymap-fetch-density-value">17.2. Fetch Density Value</a></li>
<li><a href="chap18.html#fragmentdensitymap-conversion-to-fragment-area">17.3. Fragment Area Conversion</a></li>
</ul>
</li>
<li><a href="chap19.html#queries">18. Queries</a>
<ul class="sectlevel2">
<li><a href="chap19.html#queries-pools">18.1. Query Pools</a></li>
<li><a href="chap19.html#queries-operation">18.2. Query Operation</a></li>
<li><a href="chap19.html#queries-occlusion">18.3. Occlusion Queries</a></li>
<li><a href="chap19.html#queries-pipestats">18.4. Pipeline Statistics Queries</a></li>
<li><a href="chap19.html#queries-timestamps">18.5. Timestamp Queries</a></li>
<li><a href="chap19.html#queries-performance">18.6. Performance Queries</a></li>
<li><a href="chap19.html#queries-transform-feedback">18.7. Transform Feedback Queries</a></li>
<li><a href="chap19.html#queries-performance-intel">18.8. Intel performance queries</a></li>
</ul>
</li>
<li><a href="chap20.html#clears">19. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#clears-outside">19.1. Clearing Images Outside A Render Pass Instance</a></li>
<li><a href="chap20.html#clears-inside">19.2. Clearing Images Inside A Render Pass Instance</a></li>
<li><a href="chap20.html#clears-values">19.3. Clear Values</a></li>
<li><a href="chap20.html#clears-filling-buffers">19.4. Filling Buffers</a></li>
<li><a href="chap20.html#clears-updating-buffers">19.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap21.html#copies">20. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap21.html#_common_operation">20.1. Common Operation</a></li>
<li><a href="chap21.html#copies-buffers">20.2. Copying Data Between Buffers</a></li>
<li><a href="chap21.html#copies-images">20.3. Copying Data Between Images</a></li>
<li><a href="chap21.html#copies-buffers-images">20.4. Copying Data Between Buffers and Images</a></li>
<li><a href="chap21.html#copies-imagescaling">20.5. Image Copies with Scaling</a></li>
<li><a href="chap21.html#copies-resolve">20.6. Resolving Multisample Images</a></li>
<li><a href="chap21.html#copies-buffer-markers">20.7. Buffer Markers</a></li>
</ul>
</li>
<li><a href="chap22.html#drawing">21. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap22.html#drawing-primitive-topologies">21.1. Primitive Topologies</a></li>
<li><a href="chap22.html#drawing-primitive-order">21.2. Primitive Order</a></li>
<li><a href="chap22.html#drawing-primitive-shading">21.3. Programmable Primitive Shading</a></li>
<li><a href="chap22.html#drawing-conditional-rendering">21.4. Conditional Rendering</a></li>
<li><a href="chap22.html#drawing-mesh-shading">21.5. Programmable Mesh Shading</a></li>
</ul>
</li>
<li><a href="chap23.html#fxvertex">22. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap23.html#fxvertex-attrib">22.1. Vertex Attributes</a></li>
<li><a href="chap23.html#fxvertex-input">22.2. Vertex Input Description</a></li>
<li><a href="chap23.html#_vertex_attribute_divisor_in_instanced_rendering">22.3. Vertex Attribute Divisor in Instanced Rendering</a></li>
</ul>
</li>
<li><a href="chap24.html#tessellation">23. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap24.html#_tessellator">23.1. Tessellator</a></li>
<li><a href="chap24.html#_tessellator_patch_discard">23.2. Tessellator Patch Discard</a></li>
<li><a href="chap24.html#tessellation-tessellator-spacing">23.3. Tessellator Spacing</a></li>
<li><a href="chap24.html#tessellation-primitive-order">23.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap24.html#tessellation-vertex-winding-order">23.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap24.html#tessellation-triangle-tessellation">23.6. Triangle Tessellation</a></li>
<li><a href="chap24.html#tessellation-quad-tessellation">23.7. Quad Tessellation</a></li>
<li><a href="chap24.html#tessellation-isoline-tessellation">23.8. Isoline Tessellation</a></li>
<li><a href="chap24.html#tessellation-point-mode">23.9. Tessellation Point Mode</a></li>
<li><a href="chap24.html#_tessellation_pipeline_state">23.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap25.html#geometry">24. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap25.html#geometry-input">24.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap25.html#geometry-output">24.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap25.html#geometry-invocations">24.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap25.html#geometry-ordering">24.4. Geometry Shader Primitive Ordering</a></li>
<li><a href="chap25.html#geometry-passthrough">24.5. Geometry Shader Passthrough</a></li>
</ul>
</li>
<li><a href="chap26.html#mesh">25. Mesh Shading</a>
<ul class="sectlevel2">
<li><a href="chap26.html#mesh-task-input">25.1. Task Shader Input</a></li>
<li><a href="chap26.html#mesh-task-output">25.2. Task Shader Output</a></li>
<li><a href="chap26.html#mesh-generation">25.3. Mesh Generation</a></li>
<li><a href="chap26.html#mesh-input">25.4. Mesh Shader Input</a></li>
<li><a href="chap26.html#mesh-output">25.5. Mesh Shader Output Primitives</a></li>
<li><a href="chap26.html#mesh-output-perview">25.6. Mesh Shader Per-View Outputs</a></li>
<li><a href="chap26.html#mesh-ordering">25.7. Mesh Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap27.html#vertexpostproc">26. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap27.html#vertexpostproc-transform-feedback">26.1. Transform Feedback</a></li>
<li><a href="chap27.html#vertexpostproc-viewport-swizzle">26.2. Viewport Swizzle</a></li>
<li><a href="chap27.html#vertexpostproc-flatshading">26.3. Flat Shading</a></li>
<li><a href="chap27.html#vertexpostproc-clipping">26.4. Primitive Clipping</a></li>
<li><a href="chap27.html#vertexpostproc-clipping-shader-outputs">26.5. Clipping Shader Outputs</a></li>
<li><a href="chap27.html#vertexpostproc-viewportwscaling">26.6. Controlling Viewport W Scaling</a></li>
<li><a href="chap27.html#vertexpostproc-coord-transform">26.7. Coordinate Transformations</a></li>
<li><a href="chap27.html#vertexpostproc-renderpass-transform">26.8. Render Pass Transform</a></li>
<li><a href="chap27.html#vertexpostproc-viewport">26.9. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap28.html#primsrast">27. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap28.html#primsrast-discard">27.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap28.html#primsrast-stream">27.2. Controlling the Vertex Stream Used for Rasterization</a></li>
<li><a href="chap28.html#primrast-order">27.3. Rasterization Order</a></li>
<li><a href="chap28.html#primsrast-multisampling">27.4. Multisampling</a></li>
<li><a href="chap28.html#primrast-samplelocations">27.5. Custom Sample Locations</a></li>
<li><a href="chap28.html#primsrast-fragment-shading-rate">27.6. Fragment Shading Rates</a></li>
<li><a href="chap28.html#primsrast-shading-rate-image">27.7. Shading Rate Image</a></li>
<li><a href="chap28.html#primsrast-sampleshading">27.8. Sample Shading</a></li>
<li><a href="chap28.html#primsrast-barycentric">27.9. Barycentric Interpolation</a></li>
<li><a href="chap28.html#primsrast-points">27.10. Points</a></li>
<li><a href="chap28.html#primsrast-lines">27.11. Line Segments</a></li>
<li><a href="chap28.html#primsrast-polygons">27.12. Polygons</a></li>
</ul>
</li>
<li><a href="chap29.html#fragops">28. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap29.html#fragops-discard-rectangles">28.1. Discard Rectangles Test</a></li>
<li><a href="chap29.html#fragops-scissor">28.2. Scissor Test</a></li>
<li><a href="chap29.html#fragops-exclusive-scissor">28.3. Exclusive Scissor Test</a></li>
<li><a href="chap29.html#fragops-samplemask">28.4. Sample Mask Test</a></li>
<li><a href="chap29.html#fragops-covg">28.5. Multisample Coverage</a></li>
<li><a href="chap29.html#fragops-ds-state">28.6. Depth and Stencil Operations</a></li>
<li><a href="chap29.html#fragops-dbt">28.7. Depth Bounds Test</a></li>
<li><a href="chap29.html#fragops-stencil">28.8. Stencil Test</a></li>
<li><a href="chap29.html#fragops-depth">28.9. Depth Test</a></li>
<li><a href="chap29.html#fragops-rep-frag-test">28.10. Representative Fragment Test</a></li>
<li><a href="chap29.html#fragops-samplecount">28.11. Sample Counting</a></li>
<li><a href="chap29.html#fragops-coverage-to-color">28.12. Fragment Coverage To Color</a></li>
<li><a href="chap29.html#fragops-coverage-reduction">28.13. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap30.html#framebuffer">29. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap30.html#framebuffer-blending">29.1. Blending</a></li>
<li><a href="chap30.html#framebuffer-logicop">29.2. Logical Operations</a></li>
<li><a href="chap30.html#framebuffer-color-write-mask">29.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap31.html#dispatch">30. Dispatching Commands</a></li>
<li><a href="chap32.html#device-generated-commands">31. Device-Generated Commands</a>
<ul class="sectlevel2">
<li><a href="chap32.html#indirectmdslayout">31.1. Indirect Commands Layout</a></li>
<li><a href="chap32.html#_indirect_commands_generation_and_execution">31.2. Indirect Commands Generation And Execution</a></li>
</ul>
</li>
<li><a href="chap33.html#sparsememory">32. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap33.html#sparsememory-sparseresourcefeatures">32.1. Sparse Resource Features</a></li>
<li><a href="chap33.html#sparsememory-fully-resident">32.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap33.html#sparsememory-partially-resident-buffers">32.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap33.html#sparsememory-partially-resident-images">32.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap33.html#sparsememory-sparse-memory-aliasing">32.5. Sparse Memory Aliasing</a></li>
<li><a href="chap33.html#_sparse_resource_implementation_guidelines_informative">32.6. Sparse Resource Implementation Guidelines (Informative)</a></li>
<li><a href="chap33.html#sparsememory-resourceapi">32.7. Sparse Resource API</a></li>
</ul>
</li>
<li><a href="chap34.html#wsi">33. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap34.html#_wsi_platform">33.1. WSI Platform</a></li>
<li><a href="chap34.html#_wsi_surface">33.2. WSI Surface</a></li>
<li><a href="chap34.html#display">33.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap34.html#_querying_for_wsi_support">33.4. Querying for WSI Support</a></li>
<li><a href="chap34.html#_surface_queries">33.5. Surface Queries</a></li>
<li><a href="chap34.html#_full_screen_exclusive_control">33.6. Full Screen Exclusive Control</a></li>
<li><a href="chap34.html#_device_group_queries">33.7. Device Group Queries</a></li>
<li><a href="chap34.html#_display_timing_queries">33.8. Display Timing Queries</a></li>
<li><a href="chap34.html#_wsi_swapchain">33.9. WSI Swapchain</a></li>
<li><a href="chap34.html#_hdr_metadata">33.10. Hdr Metadata</a></li>
</ul>
</li>
<li><a href="chap35.html#deferred-host-operations">34. Deferred Host Operations</a>
<ul class="sectlevel2">
<li><a href="chap35.html#deferred-host-operations-requesting">34.1. Requesting Deferral</a></li>
<li><a href="chap35.html#_deferred_host_operations_api">34.2. Deferred Host Operations API</a></li>
</ul>
</li>
<li><a href="chap36.html#private-data">35. Private Data</a></li>
<li><a href="#acceleration-structure">36. Acceleration Structures</a>
<ul class="sectlevel2">
<li><a href="#acceleration-structure-def">36.1. Acceleration Structures</a></li>
<li><a href="#host-acceleration-structure">36.2. Host Acceleration Structure Operations</a></li>
</ul>
</li>
<li><a href="chap38.html#ray-traversal">37. Ray Traversal</a>
<ul class="sectlevel2">
<li><a href="chap38.html#ray-intersection-candidate-determination">37.1. Ray Intersection Candidate Determination</a></li>
<li><a href="chap38.html#ray-intersection-culling">37.2. Ray Intersection Culling</a></li>
<li><a href="chap38.html#ray-intersection-confirmation">37.3. Ray Intersection Confirmation</a></li>
<li><a href="chap38.html#ray-closest-hit-determination">37.4. Ray Closest Hit Determination</a></li>
<li><a href="chap38.html#ray-result-determination">37.5. Ray Result Determination</a></li>
</ul>
</li>
<li><a href="chap39.html#ray-tracing">38. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="chap39.html#ray-tracing-shader-call">38.1. Shader Call Instructions</a></li>
<li><a href="chap39.html#ray-tracing-commands">38.2. Ray Tracing Commands</a></li>
<li><a href="chap39.html#shader-binding-table">38.3. Shader Binding Table</a></li>
<li><a href="chap39.html#ray-tracing-pipeline-stack">38.4. Ray Tracing Pipeline Stack</a></li>
</ul>
</li>
<li><a href="chap40.html#extendingvulkan">39. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap40.html#extendingvulkan-instanceanddevicefunctionality">39.1. Instance and Device Functionality</a></li>
<li><a href="chap40.html#extendingvulkan-coreversions">39.2. Core Versions</a></li>
<li><a href="chap40.html#extendingvulkan-layers">39.3. Layers</a></li>
<li><a href="chap40.html#extendingvulkan-extensions">39.4. Extensions</a></li>
<li><a href="chap40.html#extendingvulkan-extensions-extensiondependencies">39.5. Extension Dependencies</a></li>
<li><a href="chap40.html#_compatibility_guarantees_informative">39.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap41.html#features">40. Features</a>
<ul class="sectlevel2">
<li><a href="chap41.html#features-requirements">40.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap42.html#limits">41. Limits</a>
<ul class="sectlevel2">
<li><a href="chap42.html#limits-minmax">41.1. Limit Requirements</a></li>
<li><a href="chap42.html#limits-multisample">41.2. Additional Multisampling Capabilities</a></li>
</ul>
</li>
<li><a href="chap43.html#formats">42. Formats</a>
<ul class="sectlevel2">
<li><a href="chap43.html#formats-definition">42.1. Format Definition</a></li>
<li><a href="chap43.html#formats-properties">42.2. Format Properties</a></li>
<li><a href="chap43.html#features-required-format-support">42.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap44.html#capabilities">43. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap44.html#capabilities-image">43.1. Additional Image Capabilities</a></li>
<li><a href="chap44.html#capabilities-buffer">43.2. Additional Buffer Capabilities</a></li>
<li><a href="chap44.html#capabilities-semaphore">43.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap44.html#capabilities-fence">43.4. Optional Fence Capabilities</a></li>
<li><a href="chap44.html#features-timestamp-calibration">43.5. Timestamp Calibration Capabilities</a></li>
</ul>
</li>
<li><a href="chap45.html#_debugging">44. Debugging</a>
<ul class="sectlevel2">
<li><a href="chap45.html#debugging-debug-utils">44.1. Debug Utilities</a></li>
<li><a href="chap45.html#debugging-debug-markers">44.2. Debug Markers</a></li>
<li><a href="chap45.html#debugging-debug-report-callbacks">44.3. Debug Report Callbacks</a></li>
<li><a href="chap45.html#_device_loss_debugging">44.4. Device Loss Debugging</a></li>
<li><a href="chap45.html#debugging-tooling-info">44.5. Active Tooling Information</a></li>
</ul>
</li>
<li><a href="chap46.html#spirvenv">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap46.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap46.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap46.html#spirvenv-module-validation">Validation Rules within a Module</a></li>
<li><a href="chap46.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap46.html#spirvenv-format-type-matching">Image Format and Type Matching</a></li>
<li><a href="chap46.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats And Vulkan Formats</a></li>
</ul>
</li>
<li><a href="chap47.html#memory-model">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap47.html#memory-model-agent">Agent</a></li>
<li><a href="chap47.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap47.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap47.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap47.html#memory-model-references">Reference</a></li>
<li><a href="chap47.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap47.html#shader-call-related">Shader Call Related</a></li>
<li><a href="chap47.html#shader-call-order">Shader Call Order</a></li>
<li><a href="chap47.html#memory-model-scope">Scope</a></li>
<li><a href="chap47.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap47.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap47.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap47.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap47.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap47.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap47.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap47.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap47.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap47.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap47.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap47.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap47.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap47.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap47.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap47.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap47.html#memory-model-acyclicity">Acyclicity</a></li>
<li><a href="chap47.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap47.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap47.html#memory-model-informative-descriptions">Descriptions (Informative)</a></li>
<li><a href="chap47.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
<li><a href="chap47.html#memory-model-cooperative-matrix">Cooperative Matrix Memory Access</a></li>
</ul>
</li>
<li><a href="chap48.html#_compressed_image_formats">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap48.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap48.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap48.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
<li><a href="chap48.html#appendix-compressedtex-pvrtc">PVRTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap49.html#versions">Appendix D: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap49.html#versions-1.1">Version 1.1</a></li>
</ul>
</li>
<li><a href="chap50.html#extensions">Appendix E: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap50.html#extension-appendices-list">List of Current Extensions</a></li>
<li><a href="chap50.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
<li><a href="chap50.html#deprecated-extension-appendices-list">List of Deprecated Extensions</a></li>
</ul>
</li>
<li><a href="chap51.html#boilerplate">Appendix F: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap51.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap51.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap51.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
</ul>
</li>
<li><a href="chap52.html#invariance">Appendix G: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap52.html#_repeatability">Repeatability</a></li>
<li><a href="chap52.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap52.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap52.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap53.html#lexicon">Appendix H: Lexicon</a>
<ul class="sectlevel2">
<li><a href="chap53.html#glossary">Glossary</a></li>
<li><a href="chap53.html#lexicon-common-abbreviations">Common Abbreviations</a></li>
<li><a href="chap53.html#lexicon-prefixes">Prefixes</a></li>
</ul>
</li>
<li><a href="chap54.html#credits">Appendix I: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap54.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap54.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="loading_msg" class="hidden" hidden=""><p>Loading… please wait.</p></div>
<!--ChunkedSearchboxMarker-->
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
<div id="content"><div class="sect1">
<h2 id="acceleration-structure"><a class="anchor" href="#acceleration-structure"></a>36. Acceleration Structures</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="acceleration-structure-def"><a class="anchor" href="#acceleration-structure-def"></a>36.1. Acceleration Structures</h3>
<div class="paragraph">
<p><em>Acceleration structures</em> are data structures used by the implementation to
efficiently manage scene geometry as it is <a href="chap38.html#ray-traversal">traversed during
a ray tracing query</a>.
The application is responsible for managing acceleration structure objects
(see <a href="chap13.html#resources-acceleration-structures">Acceleration Structures</a>),
including allocation, destruction, executing builds or updates, and
synchronizing resources used during ray tracing queries.</p>
</div>
<div class="paragraph">
<p>There are two types of acceleration structures, <em>top level acceleration
structures</em> and <em>bottom level acceleration structures</em>.</p>
</div>
<div id="fig-accelstruct" class="imageblock text-center">
<div class="content">
<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="122.6349mm" height="111.36717mm" viewBox="0 0 122.6349 111.36717" version="1.1" id="svg4035" inkscape:version="0.92.3 (2405546, 2018-03-11)" sodipodi:docname="accelstruct.svg">
  <defs id="defs4029">
    <marker inkscape:isstock="true" style="overflow:visible" id="marker5699" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Lend">
      <path transform="matrix(-0.8,0,0,-0.8,-10,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5697" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path4902" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-2" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-7" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-1" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-5" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-0" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-3" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
  </defs>
  <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="205.45633" inkscape:cy="48.906685" inkscape:document-units="mm" inkscape:current-layer="layer1" showgrid="false" inkscape:window-width="2560" inkscape:window-height="1538" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="0"></sodipodi:namedview>
  <metadata id="metadata4032">
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-36.531136,-66.301968)">
    <rect id="rect4037" width="117.55059" height="33.639881" x="39.498512" y="66.434525" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect id="rect4037-1" width="34.855381" height="33.760372" x="54.720116" y="143.83646" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.14462024;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect id="rect4037-1-1" width="34.855381" height="33.760372" x="120.36967" y="143.83646" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.14462024;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874" width="34.206844" height="21.355652" x="36.663692" y="109.68093" ry="6.6145835"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874-5" width="34.206844" height="21.355654" x="82.682297" y="109.68093" ry="6.6145835"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874-4" width="34.206844" height="21.355654" x="124.82664" y="109.68093" ry="6.6145835"></rect>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend)" d="m 53.861607,100.45238 v 9.07143" id="path4897" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-2)" d="m 100.35268,100.00656 v 9.07143" id="path4897-7" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-1)" d="m 141.17411,100.38454 v 9.07144" id="path4897-3" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.30833337;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-0)" d="m 137.20536,131.26903 v 12.31946" id="path4897-4" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker5699)" d="m 52.727677,131.25744 v 7.18155 h 18.898811 v 5.29166" id="path5689" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.2711173px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 100.35268,130.50149 v 7.9375 H 71.626488" id="path5743" inkscape:connector-curvature="0"></path>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="46.680061" y="85.333328" id="text5747"><tspan sodipodi:role="line" x="46.680061" y="85.333328" style="font-size:6.3499999px;stroke-width:0.26458332" id="tspan5749">Top-Level Acceleration Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:0.75;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="55.942436" y="153.21938" id="text5747-1"><tspan sodipodi:role="line" x="55.942436" y="153.21938" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5749-5">Bottom-Level</tspan><tspan sodipodi:role="line" x="55.942436" y="161.15688" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5773">Acceleration</tspan><tspan sodipodi:role="line" x="55.942436" y="169.09438" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5777">Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:0.75;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="120.77655" y="153.21938" id="text5747-1-2"><tspan sodipodi:role="line" x="120.77655" y="153.21938" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5749-5-0">Bottom-Level</tspan><tspan sodipodi:role="line" x="120.77655" y="161.15688" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5773-3">Acceleration</tspan><tspan sodipodi:role="line" x="120.77655" y="169.09438" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5777-3">Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="41.388393" y="117.02173" id="text5810"><tspan sodipodi:role="line" id="tspan5808" x="41.388393" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="41.388393" y="122.31339" style="stroke-width:0.26458332" id="tspan5812">and shading</tspan><tspan sodipodi:role="line" x="41.388393" y="127.60506" style="stroke-width:0.26458332" id="tspan5814">information</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="87.024742" y="117.02173" id="text5810-7"><tspan sodipodi:role="line" id="tspan5808-6" x="87.024742" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="87.024742" y="122.31339" style="stroke-width:0.26458332" id="tspan5812-7">and shading</tspan><tspan sodipodi:role="line" x="87.024742" y="127.60506" style="stroke-width:0.26458332" id="tspan5814-8">information</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="129.92503" y="117.02173" id="text5810-73"><tspan sodipodi:role="line" id="tspan5808-5" x="129.92503" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="129.92503" y="122.31339" style="stroke-width:0.26458332" id="tspan5812-1">and shading</tspan><tspan sodipodi:role="line" x="129.92503" y="127.60506" style="stroke-width:0.26458332" id="tspan5814-80">information</tspan></text>
  </g>
</svg>
</div>
<div class="title">Figure 24. Acceleration Structure</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Caption</div>
<div class="paragraph">
<p>The diagram shows the relationship between top and bottom level acceleration
structures.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-geometry"><a class="anchor" href="#acceleration-structure-geometry"></a>36.1.1. Geometry</h4>
<div class="paragraph">
<p><em>Geometries</em> refer to a triangle or axis-aligned bounding box.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-top-level"><a class="anchor" href="#acceleration-structure-top-level"></a>36.1.2. Top Level Acceleration Structures</h4>
<div class="paragraph">
<p>Opaque acceleration structure for an array of instances.
The descriptor or device address referencing this is the starting point for
traversal.</p>
</div>
<div class="paragraph">
<p>The top level acceleration structure takes a reference to any bottom level
acceleration structure referenced by its instances.
Those bottom level acceleration structure objects <strong class="purple">must</strong> be valid when the
top level acceleration structure is accessed.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-bottom-level"><a class="anchor" href="#acceleration-structure-bottom-level"></a>36.1.3. Bottom Level Acceleration Structures</h4>
<div class="paragraph">
<p>Opaque acceleration structure for an array of geometries.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-update"><a class="anchor" href="#acceleration-structure-update"></a>36.1.4. Acceleration Structure Update Rules</h4>
<div class="paragraph">
<p>The API defines two types of operations to produce acceleration structures
from geometry:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>build</em> operation is used to construct an acceleration structure.</p>
</li>
<li>
<p>An <em>update</em> operation is used to modify an existing acceleration
structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An update operation imposes certain constraints on the input, in exchange
for considerably faster execution.
When performing an update, the application is required to provide a full
description of the acceleration structure, but is prohibited from changing
anything other than instance definitions, transform matrices, and vertex or
AABB positions.
All other aspects of the description <strong class="purple">must</strong> exactly match the one from the
original build.</p>
</div>
<div class="paragraph">
<p>More precisely, the application <strong class="purple">must</strong> not use an update operation to do any
of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change primitives or instances from <em>active</em> to <em>inactive</em> (as defined
in <a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a>).</p>
</li>
<li>
<p>Change the index or vertex formats of triangle geometry.</p>
</li>
<li>
<p>Change triangle geometry transform pointers from null to non-null or
vice versa.</p>
</li>
<li>
<p>Change the number of geometries or instances in the structure.</p>
</li>
<li>
<p>Change the geometry flags for any geometry in the structure.</p>
</li>
<li>
<p>Change the number of vertices or primitives for any geometry in the
structure.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-inactive-prims"><a class="anchor" href="#acceleration-structure-inactive-prims"></a>36.1.5. Inactive Primitives and Instances</h4>
<div class="paragraph">
<p>Acceleration structures allow the use of particular input values to signal
<em>inactive</em> primitives or instances.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> triangle is one for which the first (X) component of each
vertex is NaN.
If any other vertex component is NaN, and the first is not, the behavior is
undefined.
If the vertex format does not have a NaN representation, then all triangles
are considered active.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> instance is one whose acceleration structure handle is
<a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> AABB is one for which the minimum X coordinate is NaN.
If any other component is NaN, and the first is not, the behavior is
undefined.</p>
</div>
<div class="paragraph">
<p>In the above definitions, &quot;NaN&quot; refers to any type of NaN.
Signaling, non-signaling, quiet, loud, or otherwise.</p>
</div>
<div class="paragraph">
<p>An inactive object is considered invisible to all rays, and <strong class="purple">should</strong> not be
represented in the acceleration structure.
Implementations <strong class="purple">should</strong> ensure that the presence of inactive objects does
not seriously degrade traversal performance.</p>
</div>
<div class="paragraph">
<p>Inactive objects are counted in the auto-generated index sequences which are
provided to shaders via <code>InstanceId</code> and <code>PrimitiveId</code> SPIR-V
decorations.
This allows objects in the scene to change freely between the active and
inactive states, without affecting the layout of any arrays which are being
indexed using the ID values.</p>
</div>
<div class="paragraph">
<p>Any transition between the active and inactive states requires a full
acceleration structure rebuild.
Applications <strong class="purple">must</strong> not perform an acceleration structure update where an
object is active in the source acceleration structure but would be inactive
in the destination, or vice versa.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-building"><a class="anchor" href="#acceleration-structure-building"></a>36.1.6. Building Acceleration Structures</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build an acceleration structure call:</p>
</div>
<div id="vkCmdBuildAccelerationStructureNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdBuildAccelerationStructureNV(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkAccelerationStructureInfoNV*        pInfo,
    VkBuffer                                    instanceData,
    VkDeviceSize                                instanceOffset,
    VkBool32                                    update,
    VkAccelerationStructureNV                   dst,
    VkAccelerationStructureNV                   src,
    VkBuffer                                    scratch,
    VkDeviceSize                                scratchOffset);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> contains the shared information for the acceleration
structure’s structure.</p>
</li>
<li>
<p><code>instanceData</code> is the buffer containing an array of
<a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures defining
acceleration structures.
This parameter <strong class="purple">must</strong> be <code>NULL</code> for bottom level acceleration structures.</p>
</li>
<li>
<p><code>instanceOffset</code> is the offset in bytes (relative to the start of
<code>instanceData</code>) at which the instance data is located.</p>
</li>
<li>
<p><code>update</code> specifies whether to update the <code>dst</code> acceleration
structure with the data in <code>src</code>.</p>
</li>
<li>
<p><code>dst</code> is a pointer to the target acceleration structure for the
build.</p>
</li>
<li>
<p><code>src</code> is a pointer to an existing acceleration structure that is to
be used to update the <code>dst</code> acceleration structure.</p>
</li>
<li>
<p><code>scratch</code> is the <a href="chap13.html#VkBuffer">VkBuffer</a> that will be used as scratch memory
for the build.</p>
</li>
<li>
<p><code>scratchOffset</code> is the offset in bytes relative to the start of
<code>scratch</code> that will be used as a scratch memory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>dst</code>, <code>src</code>, and <code>scratch</code> <strong class="purple">must</strong> be
<a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> or
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-geometryCount-02241" href="#VUID-vkCmdBuildAccelerationStructureNV-geometryCount-02241"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-geometryCount-02241</span><br>

<code>geometryCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceRayTracingPropertiesNV">VkPhysicalDeviceRayTracingPropertiesNV</a>::<code>maxGeometryCount</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-dst-02488" href="#VUID-vkCmdBuildAccelerationStructureNV-dst-02488"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-dst-02488</span><br>

<code>dst</code> <strong class="purple">must</strong> have been created with compatible
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a> where
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>type</code> and
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>flags</code> are identical,
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>instanceCount</code> and
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>geometryCount</code> for <code>dst</code>
are greater than or equal to the build size and each geometry in
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>pGeometries</code> for <code>dst</code> has
greater than or equal to the number of vertices, indices, and AABBs</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02489" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02489"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-02489</span><br>

If <code>update</code> is <code>VK_TRUE</code>, <code>src</code> <strong class="purple">must</strong> not be
<a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02490" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02490"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-02490</span><br>

If <code>update</code> is <code>VK_TRUE</code>, <code>src</code> <strong class="purple">must</strong> have been built before
with <code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_NV</code> set in
<a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02491" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02491"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-02491</span><br>

If <code>update</code> is <code>VK_FALSE</code>, the <code>size</code> member of the
<a href="chap13.html#VkMemoryRequirements">VkMemoryRequirements</a> structure returned from a call to
<a href="chap13.html#vkGetAccelerationStructureMemoryRequirementsNV">vkGetAccelerationStructureMemoryRequirementsNV</a> with
<a href="chap13.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>accelerationStructure</code>
set to <code>dst</code> and
<a href="chap13.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>type</code> set to
<code>VK_ACCELERATION_STRUCTURE_MEMORY_REQUIREMENTS_TYPE_BUILD_SCRATCH_NV</code>
<strong class="purple">must</strong> be less than or equal to the size of <code>scratch</code> minus
<code>scratchOffset</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02492" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02492"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-02492</span><br>

If <code>update</code> is <code>VK_TRUE</code>, the <code>size</code> member of the
<a href="chap13.html#VkMemoryRequirements">VkMemoryRequirements</a> structure returned from a call to
<a href="chap13.html#vkGetAccelerationStructureMemoryRequirementsNV">vkGetAccelerationStructureMemoryRequirementsNV</a> with
<a href="chap13.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>accelerationStructure</code>
set to <code>dst</code> and
<a href="chap13.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>type</code> set to
<code>VK_ACCELERATION_STRUCTURE_MEMORY_REQUIREMENTS_TYPE_UPDATE_SCRATCH_NV</code>
<strong class="purple">must</strong> be less than or equal to the size of <code>scratch</code> minus
<code>scratchOffset</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-scratch-03522" href="#VUID-vkCmdBuildAccelerationStructureNV-scratch-03522"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-scratch-03522</span><br>

<code>scratch</code> <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_RAY_TRACING_BIT_NV</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-instanceData-03523" href="#VUID-vkCmdBuildAccelerationStructureNV-instanceData-03523"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-instanceData-03523</span><br>

If <code>instanceData</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>instanceData</code>
<strong class="purple">must</strong> have been created with <code>VK_BUFFER_USAGE_RAY_TRACING_BIT_NV</code>
usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-accelerationStructureReference-03786" href="#VUID-vkCmdBuildAccelerationStructureNV-accelerationStructureReference-03786"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-accelerationStructureReference-03786</span><br>

Each
<a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>instanceData</code> <strong class="purple">must</strong> be a valid device address containing a
value obtained from <a href="chap13.html#vkGetAccelerationStructureHandleNV">vkGetAccelerationStructureHandleNV</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-03524" href="#VUID-vkCmdBuildAccelerationStructureNV-update-03524"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-03524</span><br>

If <code>update</code> is <code>VK_TRUE</code>, then objects that were previously
active <strong class="purple">must</strong> not be made inactive as per
<a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-03525" href="#VUID-vkCmdBuildAccelerationStructureNV-update-03525"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-03525</span><br>

If <code>update</code> is <code>VK_TRUE</code>, then objects that were previously
inactive <strong class="purple">must</strong> not be made active as per
<a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-03526" href="#VUID-vkCmdBuildAccelerationStructureNV-update-03526"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-update-03526</span><br>

If <code>update</code> is <code>VK_TRUE</code>, the <code>src</code> and <code>dst</code> objects
<strong class="purple">must</strong> either be the same object or not have any
<a href="chap13.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-pInfo-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap13.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-instanceData-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-instanceData-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-instanceData-parameter</span><br>
 If <code>instanceData</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>instanceData</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-dst-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-dst-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureNV">VkAccelerationStructureNV</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-src-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-src-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-src-parameter</span><br>
 If <code>src</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureNV">VkAccelerationStructureNV</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-scratch-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-scratch-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-scratch-parameter</span><br>
 <code>scratch</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-recording" href="#VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-cmdpool" href="#VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-renderpass" href="#VUID-vkCmdBuildAccelerationStructureNV-renderpass"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commonparent" href="#VUID-vkCmdBuildAccelerationStructureNV-commonparent"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructureNV-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>dst</code>, <code>instanceData</code>, <code>scratch</code>, and <code>src</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap6.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures call:</p>
</div>
<div id="vkCmdBuildAccelerationStructuresKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkCmdBuildAccelerationStructuresKHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    infoCount,
    <span class="directive">const</span> VkAccelerationStructureBuildGeometryInfoKHR* pInfos,
    <span class="directive">const</span> VkAccelerationStructureBuildRangeInfoKHR* <span class="directive">const</span>* ppBuildRangeInfos);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.
It specifies the number of the <code>pInfos</code> structures and
<code>ppBuildRangeInfos</code> pointers that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is an array of <code>infoCount</code>
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>ppBuildRangeInfos</code> is an array of <code>infoCount</code> pointers to
arrays of <a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures.
Each <code>ppBuildRangeInfos</code>[i] is an array of
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vkCmdBuildAccelerationStructuresKHR</code> command provides the ability
to initiate multiple acceleration structures builds, however there is no
ordering or synchronization implied between any of the individual
acceleration structure builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that an application <strong class="purple">cannot</strong> build a top-level acceleration
structure in the same <a href="#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a> call as the
associated bottom-level or instance acceleration structures are being built.
There also <strong class="purple">cannot</strong> be any memory aliasing between any acceleration structure
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="acceleration-structure-scratch" class="paragraph">
<p>Accesses to the acceleration structure scratch buffers as identified by the
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>→<code>scratchData</code> buffer
device addresses <strong class="purple">must</strong> be <a href="chap8.html#synchronization-dependencies">synchronized</a> with
the <code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> or
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>.
Similarly for accesses to each
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>→<code>srcAccelerationStructure</code>
and
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>→<code>dstAccelerationStructure</code>.</p>
</div>
<div class="paragraph">
<p>Accesses to other input buffers as identified by any used values of
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>→<code>vertexData</code>,
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>→<code>indexData</code>,
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>→<code>transformData</code>,
<a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>→<code>data</code>, and
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>→<code>data</code> <strong class="purple">must</strong> be
<a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_SHADER_READ_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-mode-04628" href="#VUID-vkCmdBuildAccelerationStructuresKHR-mode-04628"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-mode-04628</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-srcAccelerationStructure-04629" href="#VUID-vkCmdBuildAccelerationStructuresKHR-srcAccelerationStructure-04629"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-srcAccelerationStructure-04629</span><br>

If the <code>srcAccelerationStructure</code> member of any element of
<code>pInfos</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be a valid
<a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-04630" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-04630"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-04630</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03403" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03403"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03403</span><br>

The <code>srcAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03698" href="#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03698"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03698</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03800" href="#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03800"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03800</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03699" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03699"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03699</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03700" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03700"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03700</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03663" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03663"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03663</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>,
<a href="#acceleration-structure-inactive-prims">inactive primitives</a> in its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made active</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03664" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03664"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03664</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, active primitives
in its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made
<a href="#acceleration-structure-inactive-prims">inactive</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-None-03407" href="#VUID-vkCmdBuildAccelerationStructuresKHR-None-03407"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-None-03407</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be referenced by the <code>geometry.instances.data</code> member of
any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other
element of <code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03701" href="#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03701"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03701</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>srcAccelerationStructure</code> member of
any other element of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, which is accessed
by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03702" href="#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03702"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03702</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>dstAccelerationStructure</code> member of
any other element of <code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03703" href="#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03703"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03703</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03704" href="#VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03704"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03704</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03705" href="#VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03705"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-scratchData-03705</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>srcAccelerationStructure</code> member of any element
of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> (including the
same element), which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03706" href="#VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03706"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-dstAccelerationStructure-03706</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing any acceleration structure referenced by the
<code>geometry.instances.data</code> member of any element of <code>pGeometries</code>
or <code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03666" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03666"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03666</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03667" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03667"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03667</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> have been built before with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03668" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03668"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03668</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
members <strong class="purple">must</strong> either be the same <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a>, or
not have any <a href="chap13.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03758" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03758"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03758</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>geometryCount</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03759" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03759"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03759</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>flags</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03760" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03760"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03760</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>type</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03761" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03761"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03761</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>geometryType</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03762" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03762"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03762</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>flags</code> member
<strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03763" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03763"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03763</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.vertexFormat</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03764" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03764"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03764</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.maxVertex</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03765" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03765"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03765</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.indexType</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03766" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03766"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03766</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> member was NULL when
<code>srcAccelerationStructure</code> was last built, then it must be NULL.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03767" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03767"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03767</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> member was not NULL when
<code>srcAccelerationStructure</code> was last built, then it may not be NULL.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03768" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03768"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03768</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
then the value of each index referenced index must be the same as the
corresponding index value when <code>srcAccelerationStructure</code> was last
built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-primitiveCount-03769" href="#VUID-vkCmdBuildAccelerationStructuresKHR-primitiveCount-03769"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-primitiveCount-03769</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, its <code>primitiveCount</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-firstVertex-03770" href="#VUID-vkCmdBuildAccelerationStructuresKHR-firstVertex-03770"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-firstVertex-03770</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, if the corresponding geometry uses indices, its
<code>firstVertex</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03801" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03801"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03801</span><br>

For each element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the corresponding
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxInstanceCount</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03707" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03707"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03707</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03708" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03708"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03708</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03709" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03709"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03709</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03671" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03671"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03671</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code>
+ N - 1 <strong class="purple">must</strong> be in the buffer device address range of the same buffer,
where N is given by the <code>buildScratchSize</code> member of the
<a href="chap13.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03672" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03672"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03672</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> + N - 1 <strong class="purple">must</strong> be in the
buffer device address range of the same buffer, where N is given by the
<code>updateScratchSize</code> member of the
<a href="chap13.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-geometry-03673" href="#VUID-vkCmdBuildAccelerationStructuresKHR-geometry-03673"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-geometry-03673</span><br>

The buffers from which the buffer device addresses for all of the
<code>geometry.triangles.vertexData</code>, <code>geometry.triangles.indexData</code>,
<code>geometry.triangles.transformData</code>, <code>geometry.aabbs.data</code>, and
<code>geometry.instances.data</code> members of all
<code>pInfos</code>[i].<code>pGeometries</code> and <code>pInfos</code>[i].<code>ppGeometries</code>
<strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_ACCELERATION_STRUCTURE_BUILD_INPUT_READ_ONLY_BIT_KHR</code>
usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03674" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03674"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03674</span><br>

The buffer from which the buffer device address
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> is queried <strong class="purple">must</strong> have
been created with <code>VK_BUFFER_USAGE_STORAGE_BUFFER_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03802" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03802"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03802</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a valid device address obtained from
<a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03803" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03803"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03803</span><br>

For each element of <code>pInfos</code>, if <code>scratchData.deviceAddress</code> is
the address of a non-sparse buffer then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03710" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03710"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03710</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a multiple of
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>minAccelerationStructureScratchOffsetAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03804" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03804"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03804</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03805" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03805"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03805</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.vertexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03711" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03711"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03711</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to
the size in bytes of the smallest component of the format in
<code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03806" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03806"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03806</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03807" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03807"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03807</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
if <code>geometry.triangles.indexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03712" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03712"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03712</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and with
<code>geometry.triangles.indexType</code> not equal to
<code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to the
size in bytes of the type in <code>indexType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03808" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03808"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03808</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be a valid device address obtained from
<a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03809" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03809"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03809</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03810" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03810"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03810</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03811" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03811"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03811</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device address
obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03812" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03812"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03812</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, if
<code>geometry.aabbs.data.deviceAddress</code> is the address of a non-sparse
buffer then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03714" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03714"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03714</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03715" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03715"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03715</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_FALSE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03716" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03716"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03716</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03717" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03717"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03717</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, each element of
<code>geometry.instances.data.deviceAddress</code> in device memory <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03813" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03813"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03813</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03814" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03814"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03814</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if
<code>geometry.instances.data.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03815" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03815"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03815</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, each
<a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address containing a value obtained from
<a href="chap13.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03675" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03675"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-03675</span><br>

For each <code>pInfos</code>[i], <code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been
created with a value of
<a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>size</code> greater than or
equal to the memory size required by the build operation, as returned by
<a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with <span class="eq"><code>pBuildInfo</code>
= <code>pInfos</code>[i]</span> and with each element of the
<code>pMaxPrimitiveCounts</code> array greater than or equal to the equivalent
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> values for <code>j</code> in
<span class="eq">[0,<code>pInfos</code>[i].<code>geometryCount</code>)</span></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676" href="#VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676</span><br>

Each element of <code>ppBuildRangeInfos</code>[i] <strong class="purple">must</strong> be a valid pointer to
an array of <code>pInfos</code>[i].<code>geometryCount</code>
<code>VkAccelerationStructureBuildRangeInfoKHR</code> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-parameter" href="#VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter" href="#VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter</span><br>
 <code>ppBuildRangeInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-recording" href="#VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-cmdpool" href="#VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-renderpass" href="#VUID-vkCmdBuildAccelerationStructuresKHR-renderpass"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresKHR-infoCount-arraylength" href="#VUID-vkCmdBuildAccelerationStructuresKHR-infoCount-arraylength"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresKHR-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures with some parameters sourced on the device
call:</p>
</div>
<div id="vkCmdBuildAccelerationStructuresIndirectKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkCmdBuildAccelerationStructuresIndirectKHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    infoCount,
    <span class="directive">const</span> VkAccelerationStructureBuildGeometryInfoKHR* pInfos,
    <span class="directive">const</span> VkDeviceAddress*                      pIndirectDeviceAddresses,
    <span class="directive">const</span> uint32_t*                             pIndirectStrides,
    <span class="directive">const</span> uint32_t* <span class="directive">const</span>*                      ppMaxPrimitiveCounts);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.</p>
</li>
<li>
<p><code>pInfos</code> is an array of <code>infoCount</code>
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>pIndirectDeviceAddresses</code> is an array of <code>infoCount</code> buffer
device addresses which point to <code>pInfos</code>[i]→<code>geometryCount</code>
<a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
<li>
<p><code>pIndirectStrides</code> is an array of <code>infoCount</code> byte strides
between elements of <code>pIndirectDeviceAddresses</code>.</p>
</li>
<li>
<p><code>ppMaxPrimitiveCounts</code> is an array of <code>infoCount</code> arrays of
<code>pInfo</code>[i]→<code>geometryCount</code> values indicating the maximum number
of primitives that will be built by this command for each geometry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to acceleration structures, scratch buffers, vertex buffers, index
buffers, and instance buffers must be synchronized as with
<a href="#acceleration-structure-scratch">vkCmdBuildAccelerationStructuresKHR</a>.</p>
</div>
<div class="paragraph">
<p>Accesses to any element of <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be
<a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-mode-04628" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-mode-04628"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-mode-04628</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-srcAccelerationStructure-04629" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-srcAccelerationStructure-04629"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-srcAccelerationStructure-04629</span><br>

If the <code>srcAccelerationStructure</code> member of any element of
<code>pInfos</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be a valid
<a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-04630" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-04630"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-04630</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03403" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03403"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03403</span><br>

The <code>srcAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03698" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03698"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03698</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03800" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03800"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03800</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03699" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03699"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03699</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03700" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03700"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03700</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03663" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03663"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03663</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>,
<a href="#acceleration-structure-inactive-prims">inactive primitives</a> in its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made active</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03664" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03664"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03664</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, active primitives
in its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made
<a href="#acceleration-structure-inactive-prims">inactive</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-None-03407" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-None-03407"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-None-03407</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be referenced by the <code>geometry.instances.data</code> member of
any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other
element of <code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03701" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03701"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03701</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>srcAccelerationStructure</code> member of
any other element of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, which is accessed
by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03702" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03702"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03702</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>dstAccelerationStructure</code> member of
any other element of <code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03703" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03703"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03703</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03704" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03704"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03704</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03705" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03705"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-scratchData-03705</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>srcAccelerationStructure</code> member of any element
of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> (including the
same element), which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03706" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03706"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-dstAccelerationStructure-03706</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing any acceleration structure referenced by the
<code>geometry.instances.data</code> member of any element of <code>pGeometries</code>
or <code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03666" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03666"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03666</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03667" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03667"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03667</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> have been built before with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03668" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03668"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03668</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
members <strong class="purple">must</strong> either be the same <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a>, or
not have any <a href="chap13.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03758" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03758"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03758</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>geometryCount</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03759" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03759"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03759</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>flags</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03760" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03760"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03760</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>type</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03761" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03761"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03761</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>geometryType</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03762" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03762"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03762</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>flags</code> member
<strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03763" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03763"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03763</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.vertexFormat</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03764" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03764"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03764</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.maxVertex</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03765" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03765"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03765</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.indexType</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03766" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03766"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03766</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> member was NULL when
<code>srcAccelerationStructure</code> was last built, then it must be NULL.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03767" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03767"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03767</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> member was not NULL when
<code>srcAccelerationStructure</code> was last built, then it may not be NULL.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03768" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03768"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03768</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
then the value of each index referenced index must be the same as the
corresponding index value when <code>srcAccelerationStructure</code> was last
built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-primitiveCount-03769" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-primitiveCount-03769"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-primitiveCount-03769</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, its <code>primitiveCount</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-firstVertex-03770" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-firstVertex-03770"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-firstVertex-03770</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, if the corresponding geometry uses indices, its
<code>firstVertex</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03801" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03801"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03801</span><br>

For each element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the corresponding
<code>ppMaxPrimitiveCounts</code>[i][j] <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxInstanceCount</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03707" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03707"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03707</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03708" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03708"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03708</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03709" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03709"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03709</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03671" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03671"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03671</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code>
+ N - 1 <strong class="purple">must</strong> be in the buffer device address range of the same buffer,
where N is given by the <code>buildScratchSize</code> member of the
<a href="chap13.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03672" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03672"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03672</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.deviceAddress</code> and
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> + N - 1 <strong class="purple">must</strong> be in the
buffer device address range of the same buffer, where N is given by the
<code>updateScratchSize</code> member of the
<a href="chap13.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned from a
call to <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an identical
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure and
primitive count</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-geometry-03673" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-geometry-03673"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-geometry-03673</span><br>

The buffers from which the buffer device addresses for all of the
<code>geometry.triangles.vertexData</code>, <code>geometry.triangles.indexData</code>,
<code>geometry.triangles.transformData</code>, <code>geometry.aabbs.data</code>, and
<code>geometry.instances.data</code> members of all
<code>pInfos</code>[i].<code>pGeometries</code> and <code>pInfos</code>[i].<code>ppGeometries</code>
<strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_ACCELERATION_STRUCTURE_BUILD_INPUT_READ_ONLY_BIT_KHR</code>
usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03674" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03674"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03674</span><br>

The buffer from which the buffer device address
<code>pInfos</code>[i].<code>scratchData.deviceAddress</code> is queried <strong class="purple">must</strong> have
been created with <code>VK_BUFFER_USAGE_STORAGE_BUFFER_BIT</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03802" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03802"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03802</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a valid device address obtained from
<a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03803" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03803"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03803</span><br>

For each element of <code>pInfos</code>, if <code>scratchData.deviceAddress</code> is
the address of a non-sparse buffer then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03710" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03710"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03710</span><br>

For each element of <code>pInfos</code>, its <code>scratchData.deviceAddress</code>
member <strong class="purple">must</strong> be a multiple of
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>minAccelerationStructureScratchOffsetAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03804" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03804"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03804</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03805" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03805"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03805</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.vertexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03711" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03711"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03711</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to
the size in bytes of the smallest component of the format in
<code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03806" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03806"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03806</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03807" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03807"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03807</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
if <code>geometry.triangles.indexData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03712" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03712"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03712</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and with
<code>geometry.triangles.indexType</code> not equal to
<code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.deviceAddress</code> <strong class="purple">must</strong> be aligned to the
size in bytes of the type in <code>indexType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03808" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03808"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03808</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be a valid device address obtained from
<a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03809" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03809"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03809</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03810" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03810"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03810</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.deviceAddress</code> is not <code>0</code>, it
<strong class="purple">must</strong> be aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03811" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03811"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03811</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device address
obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03812" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03812"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03812</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, if
<code>geometry.aabbs.data.deviceAddress</code> is the address of a non-sparse
buffer then it <strong class="purple">must</strong> be bound completely and contiguously to a single
<a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03714" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03714"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03714</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>geometry.aabbs.data.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03715" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03715"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03715</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_FALSE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03716" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03716"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03716</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be
aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03717" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03717"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03717</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if <code>geometry.arrayOfPointers</code>
is <code>VK_TRUE</code>, each element of
<code>geometry.instances.data.deviceAddress</code> in device memory <strong class="purple">must</strong> be
aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03813" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03813"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03813</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid device
address obtained from <a href="#vkGetBufferDeviceAddress">vkGetBufferDeviceAddress</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03814" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03814"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03814</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, if
<code>geometry.instances.data.deviceAddress</code> is the address of a
non-sparse buffer then it <strong class="purple">must</strong> be bound completely and contiguously to
a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03815" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03815"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03815</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, each
<a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>geometry.instances.data.deviceAddress</code> <strong class="purple">must</strong> be a valid
device address containing a value obtained from
<a href="chap13.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03645" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03645"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03645</span><br>

For any element of <code>pIndirectDeviceAddresses</code>, if the buffer from
which it was queried is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03646" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03646"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03646</span><br>

For any element of <code>pIndirectDeviceAddresses</code>[i], all device
addresses between <code>pIndirectDeviceAddresses</code>[i] and
<span class="eq"><code>pIndirectDeviceAddresses</code>[i] + 
(<code>pInfos</code>[i]→geometryCount × <code>pIndirectStrides</code>[i]) - 1</span>
<strong class="purple">must</strong> be in the buffer device address range of the same buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03647" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03647"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03647</span><br>

For any element of <code>pIndirectDeviceAddresses</code>, the buffer from which
it was queried <strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_INDIRECT_BUFFER_BIT</code> bit set</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03648" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03648"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03648</span><br>

Each element of <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be a multiple of
<code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-03787" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-03787"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-03787</span><br>

Each element of <code>pIndirectStrides</code> <strong class="purple">must</strong> be a multiple of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-03649" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-03649"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-03649</span><br>

<code>commandBuffer</code> <strong class="purple">must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-accelerationStructureIndirectBuild-03650" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-accelerationStructureIndirectBuild-03650"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-accelerationStructureIndirectBuild-03650</span><br>

The <a href="chap41.html#features-accelerationStructureIndirectBuild"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureIndirectBuild</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03651" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03651"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-03651</span><br>

Each <a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structure referenced
by any element of <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03652" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03652"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-03652</span><br>

<code>pInfos</code>[i].<code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been created
with a value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>size</code>
greater than or equal to the memory size required by the build
operation, as returned by <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a>
with <span class="eq"><code>pBuildInfo</code> = <code>pInfos</code>[i]</span> and
<span class="eq"><code>pMaxPrimitiveCounts</code> = <code>ppMaxPrimitiveCounts</code>[i]</span></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-03653" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-03653"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-03653</span><br>

Each <code>ppMaxPrimitiveCounts</code>[i][j] <strong class="purple">must</strong> be greater than or equal to
the the <code>primitiveCount</code> value specified by the
<a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structure located at
<span class="eq"><code>pIndirectDeviceAddresses</code>[i] +  (<code>j</code> ×
<code>pIndirectStrides</code>[i])</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-parameter" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-parameter" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectDeviceAddresses-parameter</span><br>
 <code>pIndirectDeviceAddresses</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <code>VkDeviceAddress</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-parameter" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-pIndirectStrides-parameter</span><br>
 <code>pIndirectStrides</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-parameter" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-parameter"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-ppMaxPrimitiveCounts-parameter</span><br>
 <code>ppMaxPrimitiveCounts</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <code>uint32_t</code> values</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-recording" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-cmdpool" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-renderpass" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-renderpass"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructuresIndirectKHR-infoCount-arraylength" href="#VUID-vkCmdBuildAccelerationStructuresIndirectKHR-infoCount-arraylength"></a> <span class="vuid">VUID-vkCmdBuildAccelerationStructuresIndirectKHR-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureBuildGeometryInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkAccelerationStructureBuildGeometryInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureBuildGeometryInfoKHR {
    VkStructureType                                     sType;
    <span class="directive">const</span> <span class="directive">void</span>*                                         pNext;
    VkAccelerationStructureTypeKHR                      type;
    VkBuildAccelerationStructureFlagsKHR                flags;
    VkBuildAccelerationStructureModeKHR                 mode;
    VkAccelerationStructureKHR                          srcAccelerationStructure;
    VkAccelerationStructureKHR                          dstAccelerationStructure;
    uint32_t                                            geometryCount;
    <span class="directive">const</span> VkAccelerationStructureGeometryKHR*           pGeometries;
    <span class="directive">const</span> VkAccelerationStructureGeometryKHR* <span class="directive">const</span>*    ppGeometries;
    VkDeviceOrHostAddressKHR                            scratchData;
} VkAccelerationStructureBuildGeometryInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>type</code> is a <a href="chap13.html#VkAccelerationStructureTypeKHR">VkAccelerationStructureTypeKHR</a> value specifying
the type of acceleration structure being built.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="chap13.html#VkBuildAccelerationStructureFlagBitsKHR">VkBuildAccelerationStructureFlagBitsKHR</a> specifying additional
parameters of the acceleration structure.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value
specifying the type of operation to perform.</p>
</li>
<li>
<p><code>srcAccelerationStructure</code> points to an existing acceleration
structure that is to be used to update the <code>dst</code> acceleration
structure when <code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>.</p>
</li>
<li>
<p><code>dstAccelerationStructure</code> points to the target acceleration
structure for the build.</p>
</li>
<li>
<p><code>geometryCount</code> specifies the number of geometries that will be
built into <code>dstAccelerationStructure</code>.</p>
</li>
<li>
<p><code>pGeometries</code> is a pointer to an array of
<a href="#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures.</p>
</li>
<li>
<p><code>ppGeometries</code> is a pointer to an array of pointers to
<a href="#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures.</p>
</li>
<li>
<p><code>scratchData</code> is the device or host address to memory that will be
used as scratch memory for the build.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only one of <code>pGeometries</code> or <code>ppGeometries</code> <strong class="purple">can</strong> be a valid pointer,
the other <strong class="purple">must</strong> be <code>NULL</code>.
Each element of the non-<code>NULL</code> array describes the data used to build each
acceleration structure geometry.</p>
</div>
<div id="acceleration-structure-geometry-index" class="paragraph">
<p>The index of each element of the <code>pGeometries</code> or <code>ppGeometries</code>
members of <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> is used as the
<em>geometry index</em> during ray traversal.
The geometry index is available in ray shaders via the
<a href="chap16.html#interfaces-builtin-variables-raygeometryindex"><code>RayGeometryIndexKHR</code>
built-in</a>, and is <a href="chap39.html#shader-binding-table-hit-shader-indexing">used to
determine hit and intersection shaders executed during traversal</a>.
The geometry index is available to ray queries via the
<code>OpRayQueryGetIntersectionGeometryIndexKHR</code> instruction.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03654" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03654"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03654</span><br>

<code>type</code> <strong class="purple">must</strong> not be <code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-03788" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-03788"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-03788</span><br>

Only one of <code>pGeometries</code> or <code>ppGeometries</code> <strong class="purple">can</strong> be a valid
pointer, the other <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03789" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03789"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03789</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, the
<code>geometryType</code> member of elements of either <code>pGeometries</code> or
<code>ppGeometries</code> <strong class="purple">must</strong> be <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03790" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03790"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03790</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>,
<code>geometryCount</code> <strong class="purple">must</strong> be <code>1</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03791" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03791"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03791</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
the <code>geometryType</code> member of elements of either <code>pGeometries</code> or
<code>ppGeometries</code> <strong class="purple">must</strong> not be <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03792" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03792"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03792</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
then the <code>geometryType</code> member of each geometry in either
<code>pGeometries</code> or <code>ppGeometries</code> <strong class="purple">must</strong> be the same</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03793" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03793"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03793</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
then <code>geometryCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxGeometryCount</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03794" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03794"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03794</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
and the <code>geometryType</code> member of either <code>pGeometries</code> or
<code>ppGeometries</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the total number
of AABBs in all geometries <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxPrimitiveCount</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03795" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03795"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-03795</span><br>

If <code>type</code> is <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>
and the <code>geometryType</code> member of either <code>pGeometries</code> or
<code>ppGeometries</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the total
number of triangles in all geometries <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxPrimitiveCount</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-03796" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-03796"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-03796</span><br>

If <code>flags</code> has the
<code>VK_BUILD_ACCELERATION_STRUCTURE_PREFER_FAST_TRACE_BIT_KHR</code> bit set,
then it <strong class="purple">must</strong> not have the
<code>VK_BUILD_ACCELERATION_STRUCTURE_PREFER_FAST_BUILD_BIT_KHR</code> bit set</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_BUILD_GEOMETRY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter</span><br>
 <code>type</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureTypeKHR">VkAccelerationStructureTypeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap13.html#VkBuildAccelerationStructureFlagBitsKHR">VkBuildAccelerationStructureFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-pGeometries-parameter</span><br>
 If <code>geometryCount</code> is not <code>0</code>, and <code>pGeometries</code> is not <code>NULL</code>, <code>pGeometries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>geometryCount</code> valid <a href="#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-ppGeometries-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-ppGeometries-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-ppGeometries-parameter</span><br>
 If <code>geometryCount</code> is not <code>0</code>, and <code>ppGeometries</code> is not <code>NULL</code>, <code>ppGeometries</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>geometryCount</code> valid pointers to valid <a href="#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent"></a> <span class="vuid">VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent</span><br>
 Both of <code>dstAccelerationStructure</code>, and <code>srcAccelerationStructure</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap6.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBuildAccelerationStructureModeKHR</code> enumeration is defined as:</p>
</div>
<div id="VkBuildAccelerationStructureModeKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">enum</span> VkBuildAccelerationStructureModeKHR {
    VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR = <span class="integer">0</span>,
    VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR = <span class="integer">1</span>,
} VkBuildAccelerationStructureModeKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code> specifies that the
destination acceleration structure will be built using the specified
geometries.</p>
</li>
<li>
<p><code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> specifies that the
destination acceleration structure will be built using data in a source
acceleration structure, updated by the specified geometries.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceOrHostAddressKHR</code> union is defined as:</p>
</div>
<div id="VkDeviceOrHostAddressKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">union</span> VkDeviceOrHostAddressKHR {
    VkDeviceAddress    deviceAddress;
    <span class="directive">void</span>*              hostAddress;
} VkDeviceOrHostAddressKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceAddress</code> is a buffer device address as returned by the
<a href="chap15.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a> command.</p>
</li>
<li>
<p><code>hostAddress</code> is a host memory address.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceOrHostAddressConstKHR</code> union is defined as:</p>
</div>
<div id="VkDeviceOrHostAddressConstKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">union</span> VkDeviceOrHostAddressConstKHR {
    VkDeviceAddress    deviceAddress;
    <span class="directive">const</span> <span class="directive">void</span>*        hostAddress;
} VkDeviceOrHostAddressConstKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceAddress</code> is a buffer device address as returned by the
<a href="chap15.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a> command.</p>
</li>
<li>
<p><code>hostAddress</code> is a const host memory address.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryKHR</code> structure is defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryKHR {
    VkStructureType                           sType;
    <span class="directive">const</span> <span class="directive">void</span>*                               pNext;
    VkGeometryTypeKHR                         geometryType;
    VkAccelerationStructureGeometryDataKHR    geometry;
    VkGeometryFlagsKHR                        flags;
} VkAccelerationStructureGeometryKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>geometryType</code> describes which type of geometry this
<code>VkAccelerationStructureGeometryKHR</code> refers to.</p>
</li>
<li>
<p><code>geometry</code> is a <a href="#VkAccelerationStructureGeometryDataKHR">VkAccelerationStructureGeometryDataKHR</a> union
describing the geometry data for the relevant geometry type.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap13.html#VkGeometryFlagBitsKHR">VkGeometryFlagBitsKHR</a> values
describing additional properties of how the geometry should be built.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-03541" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-03541"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-geometryType-03541</span><br>

If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the
<code>aabbs</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-03542" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-03542"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-geometryType-03542</span><br>

If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the
<code>triangles</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-03543" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-03543"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-geometryType-03543</span><br>

If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the
<code>instances</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter</span><br>
 <code>geometryType</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkGeometryTypeKHR">VkGeometryTypeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-triangles-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-triangles-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-triangles-parameter</span><br>
 If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the <code>triangles</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter</span><br>
 If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the <code>aabbs</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-instances-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-instances-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-instances-parameter</span><br>
 If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the <code>instances</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-flags-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-flags-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap13.html#VkGeometryFlagBitsKHR">VkGeometryFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryDataKHR</code> union is defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">union</span> VkAccelerationStructureGeometryDataKHR {
    VkAccelerationStructureGeometryTrianglesDataKHR    triangles;
    VkAccelerationStructureGeometryAabbsDataKHR        aabbs;
    VkAccelerationStructureGeometryInstancesDataKHR    instances;
} VkAccelerationStructureGeometryDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>triangles</code> is a
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure.</p>
</li>
<li>
<p><code>aabbs</code> is a <a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>
struture.</p>
</li>
<li>
<p><code>instances</code> is a
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryTrianglesDataKHR</code> structure is
defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryTrianglesDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryTrianglesDataKHR {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkFormat                         vertexFormat;
    VkDeviceOrHostAddressConstKHR    vertexData;
    VkDeviceSize                     vertexStride;
    uint32_t                         maxVertex;
    VkIndexType                      indexType;
    VkDeviceOrHostAddressConstKHR    indexData;
    VkDeviceOrHostAddressConstKHR    transformData;
} VkAccelerationStructureGeometryTrianglesDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>vertexFormat</code> is the <a href="chap43.html#VkFormat">VkFormat</a> of each vertex element.</p>
</li>
<li>
<p><code>vertexData</code> is a device or host address to memory containing vertex
data for this geometry.</p>
</li>
<li>
<p><code>maxVertex</code> is the highest index of a vertex that will be addressed
by a build command using this structure.</p>
</li>
<li>
<p><code>vertexStride</code> is the stride in bytes between each vertex.</p>
</li>
<li>
<p><code>indexType</code> is the <a href="chap22.html#VkIndexType">VkIndexType</a> of each index element.</p>
</li>
<li>
<p><code>indexData</code> is a device or host address to memory containing index
data for this geometry.</p>
</li>
<li>
<p><code>transformData</code> is a device or host address to memory containing an
optional reference to a <a href="#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure defining a
transformation that should be applied to vertices in this geometry.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Unlike the stride for vertex buffers in
<a href="chap23.html#VkVertexInputBindingDescription">VkVertexInputBindingDescription</a> for graphics pipelines which must not
exceed <code>maxVertexInputBindingStride</code>, <code>vertexStride</code> for
acceleration structure geometry is instead restricted to being a 32-bit
value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03735" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03735"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03735</span><br>

<code>vertexStride</code> <strong class="purple">must</strong> be a multiple of the size in bytes of the
smallest component of <code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03819" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03819"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexStride-03819</span><br>

<code>vertexStride</code> <strong class="purple">must</strong> be less than or equal to <span class="eq">2<sup>32</sup>-1</span></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-03797" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-03797"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-03797</span><br>

<code>vertexFormat</code> <strong class="purple">must</strong> support the
<code>VK_FORMAT_FEATURE_ACCELERATION_STRUCTURE_VERTEX_BUFFER_BIT_KHR</code> in
<a href="chap43.html#VkFormatProperties">VkFormatProperties</a>::<code>bufferFeatures</code> as returned by
<a href="chap43.html#vkGetPhysicalDeviceFormatProperties2">vkGetPhysicalDeviceFormatProperties2</a></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-03798" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-03798"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-03798</span><br>

<code>indexType</code> <strong class="purple">must</strong> be <code>VK_INDEX_TYPE_UINT16</code>,
<code>VK_INDEX_TYPE_UINT32</code>, or <code>VK_INDEX_TYPE_NONE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_TRIANGLES_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter</span><br>
 <code>vertexFormat</code> <strong class="purple">must</strong> be a valid <a href="chap43.html#VkFormat">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter</span><br>
 <code>indexType</code> <strong class="purple">must</strong> be a valid <a href="chap22.html#VkIndexType">VkIndexType</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkTransformMatrixKHR</code> structure is defined as:</p>
</div>
<div id="VkTransformMatrixKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkTransformMatrixKHR {
    <span class="predefined-type">float</span>    matrix[<span class="integer">3</span>][<span class="integer">4</span>];
} VkTransformMatrixKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkTransformMatrixNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkTransformMatrixKHR VkTransformMatrixNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>matrix</code> is a 3x4 row-major affine transformation matrix.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkTransformMatrixKHR-matrix-03799" href="#VUID-VkTransformMatrixKHR-matrix-03799"></a> <span class="vuid">VUID-VkTransformMatrixKHR-matrix-03799</span><br>

The first three columns of <code>matrix</code> <strong class="purple">must</strong> define an invertible 3x3
matrix</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryAabbsDataKHR</code> structure is defined
as:</p>
</div>
<div id="VkAccelerationStructureGeometryAabbsDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryAabbsDataKHR {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkDeviceOrHostAddressConstKHR    data;
    VkDeviceSize                     stride;
} VkAccelerationStructureGeometryAabbsDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>data</code> is a device or host address to memory containing
<a href="#VkAabbPositionsKHR">VkAabbPositionsKHR</a> structures containing position data for each
axis-aligned bounding box in the geometry.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between each entry in <code>data</code>.
The stride <strong class="purple">must</strong> be a multiple of <code>8</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545</span><br>

<code>stride</code> <strong class="purple">must</strong> be a multiple of <code>8</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03820" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03820"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03820</span><br>

<code>stride</code> <strong class="purple">must</strong> be less than or equal to <span class="eq">2<sup>32</sup>-1</span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_AABBS_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The VkAabbPositionsKHR structure is defined as:</p>
</div>
<div id="VkAabbPositionsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAabbPositionsKHR {
    <span class="predefined-type">float</span>    minX;
    <span class="predefined-type">float</span>    minY;
    <span class="predefined-type">float</span>    minZ;
    <span class="predefined-type">float</span>    maxX;
    <span class="predefined-type">float</span>    maxY;
    <span class="predefined-type">float</span>    maxZ;
} VkAabbPositionsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAabbPositionsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkAabbPositionsKHR VkAabbPositionsNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>minX</code> is the x position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>minY</code> is the y position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>minZ</code> is the z position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>maxX</code> is the x position of the other opposing corner of a bounding
box.</p>
</li>
<li>
<p><code>maxY</code> is the y position of the other opposing corner of a bounding
box.</p>
</li>
<li>
<p><code>maxZ</code> is the z position of the other opposing corner of a bounding
box.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minX-03546" href="#VUID-VkAabbPositionsKHR-minX-03546"></a> <span class="vuid">VUID-VkAabbPositionsKHR-minX-03546</span><br>

<code>minX</code> <strong class="purple">must</strong> be less than or equal to <code>maxX</code></p>
</li>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minY-03547" href="#VUID-VkAabbPositionsKHR-minY-03547"></a> <span class="vuid">VUID-VkAabbPositionsKHR-minY-03547</span><br>

<code>minY</code> <strong class="purple">must</strong> be less than or equal to <code>maxY</code></p>
</li>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minZ-03548" href="#VUID-VkAabbPositionsKHR-minZ-03548"></a> <span class="vuid">VUID-VkAabbPositionsKHR-minZ-03548</span><br>

<code>minZ</code> <strong class="purple">must</strong> be less than or equal to <code>maxZ</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryInstancesDataKHR</code> structure is
defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryInstancesDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryInstancesDataKHR {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkBool32                         arrayOfPointers;
    VkDeviceOrHostAddressConstKHR    data;
} VkAccelerationStructureGeometryInstancesDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>arrayOfPointers</code> specifies whether <code>data</code> is used as an array
of addresses or just an array.</p>
</li>
<li>
<p><code>data</code> is either the address of an array of device or host addresses
referencing individual <a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>
structures if <code>arrayOfPointers</code> is <code>VK_TRUE</code>, or the address of
an array of <a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_INSTANCES_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><em>Acceleration structure instances</em> <strong class="purple">can</strong> be built into top-level acceleration
structures.
Each acceleration structure instance is a separate entry in the top-level
acceleration structure which includes all the geometry of a bottom-level
acceleration structure at a transformed location.
Multiple instances <strong class="purple">can</strong> point to the same bottom level acceleration
structure.</p>
</div>
<div class="paragraph">
<p>An acceleration structure instance is defined by the structure:</p>
</div>
<div id="VkAccelerationStructureInstanceKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureInstanceKHR {
    VkTransformMatrixKHR          transform;
    uint32_t                      instanceCustomIndex:<span class="integer">24</span>;
    uint32_t                      mask:<span class="integer">8</span>;
    uint32_t                      instanceShaderBindingTableRecordOffset:<span class="integer">24</span>;
    VkGeometryInstanceFlagsKHR    flags:<span class="integer">8</span>;
    uint64_t                      accelerationStructureReference;
} VkAccelerationStructureInstanceKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAccelerationStructureInstanceNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkAccelerationStructureInstanceKHR VkAccelerationStructureInstanceNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>transform</code> is a <a href="#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure describing a
transformation to be applied to the acceleration structure.</p>
</li>
<li>
<p><code>instanceCustomIndex</code> is a 24-bit user-specified index value
accessible to ray shaders in the <code>InstanceCustomIndexKHR</code> built-in.</p>
</li>
<li>
<p><code>mask</code> is an 8-bit visibility mask for the geometry.
The instance <strong class="purple">may</strong> only be hit if <code>rayMask &amp; instance.mask != 0</code></p>
</li>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> is a 24-bit offset used in
calculating the hit shader binding table index.</p>
</li>
<li>
<p><code>flags</code> is an 8-bit mask of <a href="#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a>
values to apply to this instance.</p>
</li>
<li>
<p><code>accelerationStructureReference</code> is either:</p>
<div class="ulist">
<ul>
<li>
<p>a device address containing the value obtained from
<a href="chap13.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a>
or
<a href="chap13.html#vkGetAccelerationStructureHandleNV">vkGetAccelerationStructureHandleNV</a>
     (used by device operations which reference acceleration structures) or,</p>
</li>
<li>
<p>a <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> object (used by host operations
which reference acceleration structures).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The C language spec does not define the ordering of bit-fields, but in
practice, this struct produces the correct layout with existing compilers.
The intended bit pattern is for the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>instanceCustomIndex</code> and <code>mask</code> occupy the same memory as if a
single <code>int32_t</code> was specified in their place</p>
<div class="ulist">
<ul>
<li>
<p><code>instanceCustomIndex</code> occupies the 24 least significant bits of
that memory</p>
</li>
<li>
<p><code>mask</code> occupies the 8 most significant bits of that memory</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> and <code>flags</code> occupy the
same memory as if a single <code>int32_t</code> was specified in their place</p>
<div class="ulist">
<ul>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> occupies the 24 least
significant bits of that memory</p>
</li>
<li>
<p><code>flags</code> occupies the 8 most significant bits of that memory</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a compiler produces code that diverges from that pattern, applications
<strong class="purple">must</strong> employ another method to set values according to the correct bit
pattern.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureInstanceKHR-flags-parameter" href="#VUID-VkAccelerationStructureInstanceKHR-flags-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureInstanceKHR-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>flags</code> in the instance modifying the behavior of
that instance are:</p>
</div>
<div id="VkGeometryInstanceFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">enum</span> VkGeometryInstanceFlagBitsKHR {
    VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR = <span class="hex">0x00000001</span>,
    VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR = <span class="hex">0x00000002</span>,
    VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR = <span class="hex">0x00000004</span>,
    VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR = <span class="hex">0x00000008</span>,
  <span class="comment">// Provided by VK_NV_ray_tracing</span>
    VK_GEOMETRY_INSTANCE_TRIANGLE_CULL_DISABLE_BIT_NV = VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR,
  <span class="comment">// Provided by VK_NV_ray_tracing</span>
    VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_NV = VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR,
  <span class="comment">// Provided by VK_NV_ray_tracing</span>
    VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_NV = VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR,
  <span class="comment">// Provided by VK_NV_ray_tracing</span>
    VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_NV = VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR,
} VkGeometryInstanceFlagBitsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkGeometryInstanceFlagBitsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkGeometryInstanceFlagBitsKHR VkGeometryInstanceFlagBitsNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR</code> disables
face culling for this instance.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR</code>
indicates that the front face of the triangle for culling purposes is
the face that is counter clockwise in object space relative to the ray
origin.
Because the facing is determined in object space, an instance transform
matrix does not change the winding, but a geometry transform does.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</code> causes this instance to
act as though <code>VK_GEOMETRY_OPAQUE_BIT_KHR</code> were specified on all
geometries referenced by this instance.
This behavior <strong class="purple">can</strong> be overridden by the SPIR-V <code>NoOpaqueKHR</code> ray
flag.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</code> causes this instance
to act as though <code>VK_GEOMETRY_OPAQUE_BIT_KHR</code> were not specified on
all geometries referenced by this instance.
This behavior <strong class="purple">can</strong> be overridden by the SPIR-V <code>OpaqueKHR</code> ray flag.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</code> and
<code>VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</code> <strong class="purple">must</strong> not be used in the
same flag.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkGeometryInstanceFlagsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> VkFlags VkGeometryInstanceFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkGeometryInstanceFlagsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkGeometryInstanceFlagsKHR VkGeometryInstanceFlagsNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkGeometryInstanceFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkAccelerationStructureBuildRangeInfoKHR</code> is defined as:</p>
</div>
<div id="VkAccelerationStructureBuildRangeInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureBuildRangeInfoKHR {
    uint32_t    primitiveCount;
    uint32_t    primitiveOffset;
    uint32_t    firstVertex;
    uint32_t    transformOffset;
} VkAccelerationStructureBuildRangeInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>primitiveCount</code> defines the number of primitives for a
corresponding acceleration structure geometry.</p>
</li>
<li>
<p><code>primitiveOffset</code> defines an offset in bytes into the memory where
primitive data is defined.</p>
</li>
<li>
<p><code>firstVertex</code> is the index of the first vertex to build from for
triangle geometry.</p>
</li>
<li>
<p><code>transformOffset</code> defines an offset in bytes into the memory where a
transform matrix is defined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The primitive count and primitive offset are interpreted differently
depending on the <a href="chap13.html#VkGeometryTypeKHR">VkGeometryTypeKHR</a> used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>primitiveCount</code> is the number of triangles to be built, where each
triangle is treated as 3 vertices.</p>
<div class="ulist">
<ul>
<li>
<p>If the geometry uses indices, <span class="eq"><code>primitiveCount</code> × 3</span>
indices are consumed from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>,
starting at an offset of <code>primitiveOffset</code>.
The value of <code>firstVertex</code> is added to the index values before
fetching vertices.</p>
</li>
<li>
<p>If the geometry does not use indices, <span class="eq"><code>primitiveCount</code> ×
3</span> vertices are consumed from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>,
starting at an offset of <span class="eq"><code>primitiveOffset</code> + 
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexStride</code>
× <code>firstVertex</code></span>.</p>
</li>
<li>
<p>A single <a href="#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure is consumed from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>,
at an offset of <code>transformOffset</code>.
This transformation matrix is used by all triangles.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>primitiveCount</code> is the number of axis-aligned bounding boxes.
<code>primitiveCount</code> <a href="#VkAabbPositionsKHR">VkAabbPositionsKHR</a> structures are consumed
from <a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code>,
starting at an offset of <code>primitiveOffset</code>.</p>
</li>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>primitiveCount</code> is the number of acceleration structures.
<code>primitiveCount</code> <a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures
are consumed from
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code>,
starting at an offset of <code>primitiveOffset</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03656" href="#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03656"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03656</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if the
geometry uses indices, the offset <code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>
<strong class="purple">must</strong> be a multiple of the element size of
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexType</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03657" href="#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03657"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03657</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if the
geometry doesn’t use indices, the offset <code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>
<strong class="purple">must</strong> be a multiple of the component size of
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexFormat</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-transformOffset-03658" href="#VUID-VkAccelerationStructureBuildRangeInfoKHR-transformOffset-03658"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-transformOffset-03658</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the offset
<code>transformOffset</code> from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>
<strong class="purple">must</strong> be a multiple of 16</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03659" href="#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03659"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03659</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the offset
<code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code> <strong class="purple">must</strong> be a
multiple of 8</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03660" href="#VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03660"></a> <span class="vuid">VUID-VkAccelerationStructureBuildRangeInfoKHR-primitiveOffset-03660</span><br>

For geometries of type <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the offset
<code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code> <strong class="purple">must</strong>
be a multiple of 16</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-copying"><a class="anchor" href="#acceleration-structure-copying"></a>36.1.7. Copying Acceleration Structures</h4>
<div class="paragraph">
<p>An additional command exists for copying acceleration structures without
updating their contents.
The acceleration structure object <strong class="purple">can</strong> be compacted in order to improve
performance.
Before copying, an application <strong class="purple">must</strong> query the size of the resulting
acceleration structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query acceleration structure size parameters call:</p>
</div>
<div id="vkCmdWriteAccelerationStructuresPropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkCmdWriteAccelerationStructuresPropertiesKHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    accelerationStructureCount,
    <span class="directive">const</span> VkAccelerationStructureKHR*           pAccelerationStructures,
    VkQueryType                                 queryType,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> is a pointer to an array of existing
previously built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap19.html#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>firstQuery</code> is the first query index within the query pool that
will contain the <code>accelerationStructureCount</code> number of results.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to any of the acceleration structures listed in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be <a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> matching
<code>queryType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494</span><br>

The queries identified by <code>queryPool</code> and <code>firstQuery</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-buffer-03736" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-buffer-03736"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-buffer-03736</span><br>

The <code>buffer</code> used to create each acceleration structure in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be bound to device memory</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-03432" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-03432"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-03432</span><br>

<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter</span><br>
 <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap19.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap19.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength</span><br>
 <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>queryPool</code>, and the elements of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap6.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query acceleration structure size parameters call:</p>
</div>
<div id="vkCmdWriteAccelerationStructuresPropertiesNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdWriteAccelerationStructuresPropertiesNV(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    accelerationStructureCount,
    <span class="directive">const</span> VkAccelerationStructureNV*            pAccelerationStructures,
    VkQueryType                                 queryType,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> is a pointer to an array of existing
previously built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap19.html#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>firstQuery</code> is the first query index within the query pool that
will contain the <code>accelerationStructureCount</code> number of results.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to any of the acceleration structures listed in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be <a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-03755" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-03755"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-03755</span><br>

<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> matching
<code>queryType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-03756" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-03756"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-03756</span><br>

The queries identified by <code>queryPool</code> and <code>firstQuery</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructure-03757" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructure-03757"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructure-03757</span><br>

<code>accelerationStructure</code> <strong class="purple">must</strong> be bound completely and contiguously
to a single <code>VkDeviceMemory</code> object via
<a href="chap13.html#vkBindAccelerationStructureMemoryNV">vkBindAccelerationStructureMemoryNV</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructures-03431" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructures-03431"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructures-03431</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_NV</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryType-03432" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryType-03432"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryType-03432</span><br>

<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_NV</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-pAccelerationStructures-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-pAccelerationStructures-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-pAccelerationStructures-parameter</span><br>
 <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap13.html#VkAccelerationStructureNV">VkAccelerationStructureNV</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryType-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryType-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap19.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-parameter"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-queryPool-parameter</span><br>
 <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap19.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-recording" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-cmdpool" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-renderpass" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-renderpass"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructureCount-arraylength" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructureCount-arraylength"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-accelerationStructureCount-arraylength</span><br>
 <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commonparent" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commonparent"></a> <span class="vuid">VUID-vkCmdWriteAccelerationStructuresPropertiesNV-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>queryPool</code>, and the elements of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap6.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdCopyAccelerationStructureNV(
    VkCommandBuffer                             commandBuffer,
    VkAccelerationStructureNV                   dst,
    VkAccelerationStructureNV                   src,
    VkCopyAccelerationStructureModeKHR          mode);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>src</code> is the source acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value
specifying additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>src</code> and <code>dst</code> <strong class="purple">must</strong> be <a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> or
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code> as appropriate.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-mode-03410" href="#VUID-vkCmdCopyAccelerationStructureNV-mode-03410"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-mode-03410</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> or
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-src-03411" href="#VUID-vkCmdCopyAccelerationStructureNV-src-03411"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-src-03411</span><br>

If <code>mode</code> is <code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code>,
<code>src</code> <strong class="purple">must</strong> have been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-buffer-03718" href="#VUID-vkCmdCopyAccelerationStructureNV-buffer-03718"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-buffer-03718</span><br>

The <code>buffer</code> used to create <code>src</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-buffer-03719" href="#VUID-vkCmdCopyAccelerationStructureNV-buffer-03719"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-buffer-03719</span><br>

The <code>buffer</code> used to create <code>dst</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-dst-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-dst-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureNV">VkAccelerationStructureNV</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-src-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-src-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureNV">VkAccelerationStructureNV</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-mode-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-mode-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-recording" href="#VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-cmdpool" href="#VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-renderpass" href="#VUID-vkCmdCopyAccelerationStructureNV-renderpass"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commonparent" href="#VUID-vkCmdCopyAccelerationStructureNV-commonparent"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureNV-commonparent</span><br>
 Each of <code>commandBuffer</code>, <code>dst</code>, and <code>src</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap6.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkCmdCopyAccelerationStructureKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCopyAccelerationStructureInfoKHR*   pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo</code>-&gt;<code>src</code> and <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be
<a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code> or
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code> as appropriate.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-buffer-03737" href="#VUID-vkCmdCopyAccelerationStructureKHR-buffer-03737"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-buffer-03737</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be bound
to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-buffer-03738" href="#VUID-vkCmdCopyAccelerationStructureKHR-buffer-03738"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-buffer-03738</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be bound
to device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter" href="#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording" href="#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool" href="#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-renderpass" href="#VUID-vkCmdCopyAccelerationStructureKHR-renderpass"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyAccelerationStructureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkCopyAccelerationStructureInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkCopyAccelerationStructureInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkAccelerationStructureKHR            src;
    VkAccelerationStructureKHR            dst;
    VkCopyAccelerationStructureModeKHR    mode;
} VkCopyAccelerationStructureInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the source acceleration structure for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value that
specifies additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-mode-03410" href="#VUID-VkCopyAccelerationStructureInfoKHR-mode-03410"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-mode-03410</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> or
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-03411" href="#VUID-VkCopyAccelerationStructureInfoKHR-src-03411"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-src-03411</span><br>

If <code>mode</code> is <code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code>,
<code>src</code> <strong class="purple">must</strong> have been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-buffer-03718" href="#VUID-VkCopyAccelerationStructureInfoKHR-buffer-03718"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-buffer-03718</span><br>

The <code>buffer</code> used to create <code>src</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-buffer-03719" href="#VUID-VkCopyAccelerationStructureInfoKHR-buffer-03719"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-buffer-03719</span><br>

The <code>buffer</code> used to create <code>dst</code> <strong class="purple">must</strong> be bound to device
memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-sType-sType" href="#VUID-VkCopyAccelerationStructureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_ACCELERATION_STRUCTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext" href="#VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-parameter" href="#VUID-VkCopyAccelerationStructureInfoKHR-src-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter" href="#VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter" href="#VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-commonparent" href="#VUID-VkCopyAccelerationStructureInfoKHR-commonparent"></a> <span class="vuid">VUID-VkCopyAccelerationStructureInfoKHR-commonparent</span><br>
 Both of <code>dst</code>, and <code>src</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap6.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>mode</code> specifying additional operations to perform
during the copy, are:</p>
</div>
<div id="VkCopyAccelerationStructureModeKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">enum</span> VkCopyAccelerationStructureModeKHR {
    VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR = <span class="integer">0</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR = <span class="integer">1</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR = <span class="integer">2</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR = <span class="integer">3</span>,
  <span class="comment">// Provided by VK_NV_ray_tracing</span>
    VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_NV = VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR,
  <span class="comment">// Provided by VK_NV_ray_tracing</span>
    VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_NV = VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR,
} VkCopyAccelerationStructureModeKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkCopyAccelerationStructureModeNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkCopyAccelerationStructureModeKHR VkCopyAccelerationStructureModeNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code> creates a direct
copy of the acceleration structure specified in <code>src</code> into the one
specified by <code>dst</code>.
The <code>dst</code> acceleration structure <strong class="purple">must</strong> have been created with the
same parameters as <code>src</code>.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> creates a more
compact version of an acceleration structure <code>src</code> into <code>dst</code>.
The acceleration structure <code>dst</code> <strong class="purple">must</strong> have been created with a size
at least as large as that returned by
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a>
or <a href="#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a>
after the build of the acceleration structure specified by <code>src</code>.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code> serializes the
acceleration structure to a semi-opaque format which can be reloaded on
a compatible implementation.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code> deserializes
the semi-opaque serialization format in the buffer to the acceleration
structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure to device memory call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureToMemoryKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkCmdCopyAccelerationStructureToMemoryKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCopyAccelerationStructureToMemoryInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is an a pointer to a
<a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be <a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_READ_BIT_KHR</code>.
Accesses to the buffer indicated by <code>pInfo</code>-&gt;<code>dst.deviceAddress</code>
<strong class="purple">must</strong> be synchronized with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline stage
and an access type of <code>VK_ACCESS_TRANSFER_WRITE_BIT</code>.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>, but writes its result to a
device address, and is executed on the device rather than the host.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> or
<a href="#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a>.</p>
</div>
<div class="paragraph">
<p>The defined header structure for the serialized data consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data matching
<code>VkPhysicalDeviceIDProperties</code>::<code>driverUUID</code></p>
</li>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data identifying the compatibility for
comparison using <a href="#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
<li>
<p>A 64-bit integer of the total size matching the value queried using
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p>A 64-bit integer of the deserialized size to be passed in to
<code>VkAccelerationStructureCreateInfoKHR</code>::<code>size</code></p>
</li>
<li>
<p>A 64-bit integer of the count of the number of acceleration structure
handles following.
This will be zero for a bottom-level acceleration structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding handles matching the values returned by
<a href="chap13.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a>
or
<a href="chap13.html#vkGetAccelerationStructureHandleNV">vkGetAccelerationStructureHandleNV</a>
are tightly packed in the buffer following the count.
The application is expected to store a mapping between those handles and the
original application-generated bottom-level acceleration structures to
provide when deserializing.
The serialized data is written to the buffer (or read from the buffer)
according to the host endianness.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03739" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03739"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03739</span><br>

<code>pInfo</code>-&gt;<code>dst.deviceAddress</code> <strong class="purple">must</strong> be a valid device address
for a buffer bound to device memory.</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03740" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03740"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03740</span><br>

<code>pInfo</code>-&gt;<code>dst.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>256</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03741" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03741"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-03741</span><br>

If the buffer pointed to by <code>pInfo</code>-&gt;<code>dst.deviceAddress</code> is
non-sparse then it <strong class="purple">must</strong> be bound completely and contiguously to a
single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be bound
to device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass"></a> <span class="vuid">VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCopyAccelerationStructureToMemoryInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkCopyAccelerationStructureToMemoryInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkAccelerationStructureKHR            src;
    VkDeviceOrHostAddressKHR              dst;
    VkCopyAccelerationStructureModeKHR    mode;
} VkCopyAccelerationStructureToMemoryInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the source acceleration structure for the copy</p>
</li>
<li>
<p><code>dst</code> is the device or host address to memory which is the target
for the copy</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value that
specifies additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561</span><br>

The memory pointed to by <code>dst</code> <strong class="purple">must</strong> be at least as large as the
serialization size of <code>src</code>, as reported by
<a href="#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a> or
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> with a query type of
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_ACCELERATION_STRUCTURE_TO_MEMORY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter</span><br>
 <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter"></a> <span class="vuid">VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy device memory to an acceleration structure call:</p>
</div>
<div id="vkCmdCopyMemoryToAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkCmdCopyMemoryToAccelerationStructureKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCopyMemoryToAccelerationStructureInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Accesses to <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be <a href="chap8.html#synchronization-dependencies">synchronized</a> with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code>
<a href="chap8.html#synchronization-pipeline-stages">pipeline stage</a> and an
<a href="chap8.html#synchronization-access-types">access type</a> of
<code>VK_ACCESS_ACCELERATION_STRUCTURE_WRITE_BIT_KHR</code>.
Accesses to the buffer indicated by <code>pInfo</code>-&gt;<code>src.deviceAddress</code>
<strong class="purple">must</strong> be synchronized with the
<code>VK_PIPELINE_STAGE_ACCELERATION_STRUCTURE_BUILD_BIT_KHR</code> pipeline stage
and an access type of <code>VK_ACCESS_TRANSFER_READ_BIT</code>.</p>
</div>
<div class="paragraph">
<p>This command can accept acceleration structures produced by either
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
<div class="paragraph">
<p>The structure provided as input to deserialize is as described in
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>, with any acceleration
structure handles filled in with the newly-queried handles to bottom level
acceleration structures created before deserialization.
These do not need to be built at deserialize time, but <strong class="purple">must</strong> be created.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03742" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03742"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03742</span><br>

<code>pInfo</code>-&gt;<code>src.deviceAddress</code> <strong class="purple">must</strong> be a valid device address
for a buffer bound to device memory.</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03743" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03743"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03743</span><br>

<code>pInfo</code>-&gt;<code>src.deviceAddress</code> <strong class="purple">must</strong> be aligned to <code>256</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03744" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03744"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03744</span><br>

If the buffer pointed to by <code>pInfo</code>-&gt;<code>src.deviceAddress</code> is
non-sparse then it <strong class="purple">must</strong> be bound completely and contiguously to a
single <a href="chap12.html#VkDeviceMemory">VkDeviceMemory</a> object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-buffer-03745" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-buffer-03745"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-buffer-03745</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be bound
to device memory</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap7.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass"></a> <span class="vuid">VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap7.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap9.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyMemoryToAccelerationStructureInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkCopyMemoryToAccelerationStructureInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkCopyMemoryToAccelerationStructureInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkDeviceOrHostAddressConstKHR         src;
    VkAccelerationStructureKHR            dst;
    VkCopyAccelerationStructureModeKHR    mode;
} VkCopyMemoryToAccelerationStructureInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>src</code> is the device or host address to memory containing the source
data for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value that
specifies additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413</span><br>

<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414</span><br>

The data in <code>src</code> <strong class="purple">must</strong> have a format compatible with the
destination physical device as returned by
<a href="#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-03746" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-03746"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-03746</span><br>

<code>dst</code> <strong class="purple">must</strong> have been created with a <code>size</code> greater than or
equal to that used to serialize the data in <code>src</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_MEMORY_TO_ACCELERATION_STRUCTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter</span><br>
 <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter"></a> <span class="vuid">VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter</span><br>
 <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To check if a serialized acceleration structure is compatible with the
current device call:</p>
</div>
<div id="vkGetDeviceAccelerationStructureCompatibilityKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="directive">void</span> vkGetDeviceAccelerationStructureCompatibilityKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkAccelerationStructureVersionInfoKHR* pVersionInfo,
    VkAccelerationStructureCompatibilityKHR*    pCompatibility);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device to check the version against.</p>
</li>
<li>
<p><code>pVersionInfo</code> points to the
<a href="#VkAccelerationStructureVersionInfoKHR">VkAccelerationStructureVersionInfoKHR</a> version information to check
against the device.</p>
</li>
<li>
<p><code>pCompatibility</code> points to the
<a href="#VkAccelerationStructureCompatibilityKHR">VkAccelerationStructureCompatibilityKHR</a> compatibility return
value.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracingPipeline-03661" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracingPipeline-03661"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracingPipeline-03661</span><br>

The <a href="chap41.html#features-rayTracingPipeline"><code>rayTracingPipeline</code></a> or
<a href="chap41.html#features-rayQuery"><code>rayQuery</code></a> feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pVersionInfo-parameter" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pVersionInfo-parameter"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pVersionInfo-parameter</span><br>
 <code>pVersionInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkAccelerationStructureVersionInfoKHR">VkAccelerationStructureVersionInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pCompatibility-parameter" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pCompatibility-parameter"></a> <span class="vuid">VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-pCompatibility-parameter</span><br>
 <code>pCompatibility</code> <strong class="purple">must</strong> be a valid pointer to a <a href="#VkAccelerationStructureCompatibilityKHR">VkAccelerationStructureCompatibilityKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureVersionInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkAccelerationStructureVersionInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureVersionInfoKHR {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    <span class="directive">const</span> uint8_t*     pVersionData;
} VkAccelerationStructureVersionInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>pVersionData</code> is a pointer to the version header of an acceleration
structure as defined in <a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><code>pVersionData</code> is a <em>pointer</em> to an array of 2*<code>VK_UUID_SIZE</code>
<code>uint8_t</code> values instead of two <code>VK_UUID_SIZE</code> arrays as the expected
use case for this member is to be pointed at the header of an previously
serialized acceleration structure (via
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>) that is loaded in memory.
Using arrays would necessitate extra memory copies of the UUIDs.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureVersionInfoKHR-sType-sType" href="#VUID-VkAccelerationStructureVersionInfoKHR-sType-sType"></a> <span class="vuid">VUID-VkAccelerationStructureVersionInfoKHR-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_VERSION_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureVersionInfoKHR-pNext-pNext" href="#VUID-VkAccelerationStructureVersionInfoKHR-pNext-pNext"></a> <span class="vuid">VUID-VkAccelerationStructureVersionInfoKHR-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureVersionInfoKHR-pVersionData-parameter" href="#VUID-VkAccelerationStructureVersionInfoKHR-pVersionData-parameter"></a> <span class="vuid">VUID-VkAccelerationStructureVersionInfoKHR-pVersionData-parameter</span><br>
 <code>pVersionData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>2</code>*<code>VK_UUID_SIZE</code> <code>uint8_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>pCompatibility</code> returned by
<a href="#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a> are:</p>
</div>
<div id="VkAccelerationStructureCompatibilityKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
<span class="keyword">typedef</span> <span class="keyword">enum</span> VkAccelerationStructureCompatibilityKHR {
    VK_ACCELERATION_STRUCTURE_COMPATIBILITY_COMPATIBLE_KHR = <span class="integer">0</span>,
    VK_ACCELERATION_STRUCTURE_COMPATIBILITY_INCOMPATIBLE_KHR = <span class="integer">1</span>,
} VkAccelerationStructureCompatibilityKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCELERATION_STRUCTURE_COMPATIBILITY_COMPATIBLE_KHR</code> when the
<code>pVersion</code> version acceleration structure is compatibile with
<code>device</code>.</p>
</li>
<li>
<p><code>VK_ACCELERATION_STRUCTURE_COMPATIBILITY_INCOMPATIBLE_KHR</code> when the
<code>pVersion</code> version acceleration structure is not compatibile with
<code>device</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="host-acceleration-structure"><a class="anchor" href="#host-acceleration-structure"></a>36.2. Host Acceleration Structure Operations</h3>
<div class="paragraph">
<p>Implementations are also required to provide host implementations of the
acceleration structure operations if the
<a href="chap41.html#features-accelerationStructureHostCommands"><code>accelerationStructureHostCommands</code></a>
feature is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a> corresponding to
<a href="#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a></p>
</li>
<li>
<p><a href="#vkCopyAccelerationStructureKHR">vkCopyAccelerationStructureKHR</a> corresponding to
<a href="#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a> corresponding to
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a></p>
</li>
<li>
<p><a href="#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a> corresponding to
<a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a> corresponding to
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These commands are functionally equivalent to their device counterparts,
except that they are executed on the host timeline, rather than being
enqueued into command buffers.</p>
</div>
<div class="paragraph">
<p>All acceleration structures used by the host commands <strong class="purple">must</strong> be bound to
host-visible memory, and all input data for acceleration structure builds
<strong class="purple">must</strong> be referenced using host addresses instead of device addresses.
Applications are not required to map acceleration structure memory when
using the host commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <a href="#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a> and
<a href="#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a> <strong class="purple">may</strong> use different algorithms, and
thus are not required to produce identical structures.
The structures produced by these two commands <strong class="purple">may</strong> exhibit different memory
footprints or traversal performance, but should strive to be similar where
possible.</p>
</div>
<div class="paragraph">
<p>Apart from these details, the host and device operations are interchangable.
For example, an application <strong class="purple">can</strong> use <a href="#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a>
to build a structure, compact it on the device using
<a href="#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a>, and serialize the result using
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures on the host, call:</p>
</div>
<div id="vkBuildAccelerationStructuresKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
VkResult vkBuildAccelerationStructuresKHR(
    VkDevice                                    device,
    VkDeferredOperationKHR                      deferredOperation,
    uint32_t                                    infoCount,
    <span class="directive">const</span> VkAccelerationStructureBuildGeometryInfoKHR* pInfos,
    <span class="directive">const</span> VkAccelerationStructureBuildRangeInfoKHR* <span class="directive">const</span>* ppBuildRangeInfos);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the <code>VkDevice</code> for which the acceleration structures
are being built.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap35.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.
It specifies the number of the <code>pInfos</code> structures and
<code>ppBuildRangeInfos</code> pointers that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>ppBuildRangeInfos</code> is an array of <code>infoCount</code> pointers to
arrays of <a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures.
Each <code>ppBuildRangeInfos</code>[i] is an array of
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdBuildAccelerationStructuresKHR">vkCmdBuildAccelerationStructuresKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>The <code>vkBuildAccelerationStructuresKHR</code> command provides the ability to
initiate multiple acceleration structures builds, however there is no
ordering or synchronization implied between any of the individual
acceleration structure builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that an application <strong class="purple">cannot</strong> build a top-level acceleration
structure in the same <a href="#vkBuildAccelerationStructuresKHR">vkBuildAccelerationStructuresKHR</a> call as the
associated bottom-level or instance acceleration structures are being built.
There also <strong class="purple">cannot</strong> be any memory aliasing between any acceleration structure
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-mode-04628" href="#VUID-vkBuildAccelerationStructuresKHR-mode-04628"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-mode-04628</span><br>

The <code>mode</code> member of each element of <code>pInfos</code> <strong class="purple">must</strong> be a valid
<a href="#VkBuildAccelerationStructureModeKHR">VkBuildAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-srcAccelerationStructure-04629" href="#VUID-vkBuildAccelerationStructuresKHR-srcAccelerationStructure-04629"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-srcAccelerationStructure-04629</span><br>

If the <code>srcAccelerationStructure</code> member of any element of
<code>pInfos</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, the
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be a valid
<a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-04630" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-04630"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-04630</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03403" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03403"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03403</span><br>

The <code>srcAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03698" href="#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03698"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03698</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be the same acceleration structure as the
<code>dstAccelerationStructure</code> member of any other element of
<code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03800" href="#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03800"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03800</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> be a valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03699" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03699"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03699</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_TOP_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03700" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03700"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03700</span><br>

For each element of <code>pInfos</code>, if its <code>type</code> member is
<code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code>, its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> have been created with a
value of <a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> equal to
either <code>VK_ACCELERATION_STRUCTURE_TYPE_BOTTOM_LEVEL_KHR</code> or
<code>VK_ACCELERATION_STRUCTURE_TYPE_GENERIC_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03663" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03663"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03663</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>,
<a href="#acceleration-structure-inactive-prims">inactive primitives</a> in its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made active</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03664" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03664"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03664</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, active primitives
in its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be made
<a href="#acceleration-structure-inactive-prims">inactive</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-None-03407" href="#VUID-vkBuildAccelerationStructuresKHR-None-03407"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-None-03407</span><br>

The <code>dstAccelerationStructure</code> member of any element of <code>pInfos</code>
<strong class="purple">must</strong> not be referenced by the <code>geometry.instances.data</code> member of
any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other
element of <code>pInfos</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03701" href="#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03701"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03701</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>srcAccelerationStructure</code> member of
any other element of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, which is accessed
by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03702" href="#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03702"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03702</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>dstAccelerationStructure</code> member of
any other element of <code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03703" href="#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03703"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03703</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> (including the same element), which is accessed by this
command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-scratchData-03704" href="#VUID-vkBuildAccelerationStructuresKHR-scratchData-03704"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-scratchData-03704</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>scratchData</code> member of any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-scratchData-03705" href="#VUID-vkBuildAccelerationStructuresKHR-scratchData-03705"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-scratchData-03705</span><br>

The range of memory backing the <code>scratchData</code> member of any element
of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not overlap the
memory backing the <code>srcAccelerationStructure</code> member of any element
of <code>pInfos</code> with a <code>mode</code> equal to
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> (including the
same element), which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03706" href="#VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03706"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-dstAccelerationStructure-03706</span><br>

The range of memory backing the <code>dstAccelerationStructure</code> member of
any element of <code>pInfos</code> that is accessed by this command <strong class="purple">must</strong> not
overlap the memory backing any acceleration structure referenced by the
<code>geometry.instances.data</code> member of any element of <code>pGeometries</code>
or <code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> in any other element of
<code>pInfos</code>, which is accessed by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03666" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03666"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03666</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> not be <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03667" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03667"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03667</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> member <strong class="purple">must</strong> have been built before with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03668" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03668"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03668</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>srcAccelerationStructure</code> and <code>dstAccelerationStructure</code>
members <strong class="purple">must</strong> either be the same <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a>, or
not have any <a href="chap13.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03758" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03758"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03758</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its
<code>geometryCount</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03759" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03759"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03759</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>flags</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03760" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03760"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03760</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, its <code>type</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03761" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03761"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03761</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>geometryType</code>
member <strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03762" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03762"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03762</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, its <code>flags</code> member
<strong class="purple">must</strong> have the same value which was specified when
<code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03763" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03763"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03763</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.vertexFormat</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03764" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03764"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03764</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.maxVertex</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03765" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03765"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03765</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, its
<code>geometry.triangles.indexType</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03766" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03766"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03766</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> member was NULL when
<code>srcAccelerationStructure</code> was last built, then it must be NULL.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03767" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03767"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03767</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if its
<code>geometry.triangles.transformData</code> member was not NULL when
<code>srcAccelerationStructure</code> was last built, then it may not be NULL.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03768" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03768"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03768</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, then for each
<code>VkAccelerationStructureGeometryKHR</code> structure referred to by its
<code>pGeometries</code> or <code>ppGeometries</code> members, if <code>geometryType</code>
is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, and
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
then the value of each index referenced index must be the same as the
corresponding index value when <code>srcAccelerationStructure</code> was last
built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-primitiveCount-03769" href="#VUID-vkBuildAccelerationStructuresKHR-primitiveCount-03769"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-primitiveCount-03769</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, its <code>primitiveCount</code> member <strong class="purple">must</strong> have the same value
which was specified when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-firstVertex-03770" href="#VUID-vkBuildAccelerationStructuresKHR-firstVertex-03770"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-firstVertex-03770</span><br>

For each <code>VkAccelerationStructureBuildRangeInfoKHR</code> referenced by
this command, if the corresponding geometry uses indices, its
<code>firstVertex</code> member <strong class="purple">must</strong> have the same value which was specified
when <code>srcAccelerationStructure</code> was last built.</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03801" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03801"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03801</span><br>

For each element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the corresponding
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap42.html#VkPhysicalDeviceAccelerationStructurePropertiesKHR">VkPhysicalDeviceAccelerationStructurePropertiesKHR</a>::<code>maxInstanceCount</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03675" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03675"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03675</span><br>

For each <code>pInfos</code>[i], <code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been
created with a value of
<a href="chap13.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>size</code> greater than or
equal to the memory size required by the build operation, as returned by
<a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with <span class="eq"><code>pBuildInfo</code>
= <code>pInfos</code>[i]</span> and with each element of the
<code>pMaxPrimitiveCounts</code> array greater than or equal to the equivalent
<code>ppBuildRangeInfos</code>[i][j].<code>primitiveCount</code> values for <code>j</code> in
<span class="eq">[0,<code>pInfos</code>[i].<code>geometryCount</code>)</span></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676" href="#VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-03676</span><br>

Each element of <code>ppBuildRangeInfos</code>[i] <strong class="purple">must</strong> be a valid pointer to
an array of <code>pInfos</code>[i].<code>geometryCount</code>
<code>VkAccelerationStructureBuildRangeInfoKHR</code> structures</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03677" href="#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03678" href="#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03722" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03722"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03722</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to host-visible
device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03723" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03723"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03723</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03724" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03724"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03724</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-accelerationStructureHostCommands-03581" href="#VUID-vkBuildAccelerationStructuresKHR-accelerationStructureHostCommands-03581"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-accelerationStructureHostCommands-03581</span><br>

The <a href="chap41.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03725" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03725"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03725</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_BUILD_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.hostAddress</code> and
<code>pInfos</code>[i].<code>scratchData.hostAddress</code> + N - 1 <strong class="purple">must</strong> be valid
host memory, where N is given by the <code>buildScratchSize</code> member of
the <a href="chap13.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned
from a call to <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an
identical <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure
and primitive count</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03726" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03726"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03726</span><br>

If <code>pInfos</code>[i].<code>mode</code> is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code>, all addresses
between <code>pInfos</code>[i].<code>scratchData.hostAddress</code> and
<code>pInfos</code>[i].<code>scratchData.hostAddress</code> + N - 1 <strong class="purple">must</strong> be valid
host memory, where N is given by the <code>updateScratchSize</code> member of
the <a href="chap13.html#VkAccelerationStructureBuildSizesInfoKHR">VkAccelerationStructureBuildSizesInfoKHR</a> structure returned
from a call to <a href="chap13.html#vkGetAccelerationStructureBuildSizesKHR">vkGetAccelerationStructureBuildSizesKHR</a> with an
identical <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure
and primitive count</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03771" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03771"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03771</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>geometry.triangles.vertexData.hostAddress</code> <strong class="purple">must</strong> be a valid host
address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03772" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03772"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03772</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.indexType</code> is not <code>VK_INDEX_TYPE_NONE_KHR</code>,
<code>geometry.triangles.indexData.hostAddress</code> <strong class="purple">must</strong> be a valid host
address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03773" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03773"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03773</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if
<code>geometry.triangles.transformData.hostAddress</code> is not <code>0</code>, it <strong class="purple">must</strong>
be a valid host address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03774" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03774"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03774</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, <code>geometry.aabbs.data.hostAddress</code>
<strong class="purple">must</strong> be a valid host address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03775" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03775"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03775</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create its
<code>dstAccelerationStructure</code> member <strong class="purple">must</strong> be bound to memory that was
not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03776" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03776"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03776</span><br>

For each element of <code>pInfos</code>, if its <code>mode</code> member is
<code>VK_BUILD_ACCELERATION_STRUCTURE_MODE_UPDATE_KHR</code> the <code>buffer</code>
used to create its <code>srcAccelerationStructure</code> member <strong class="purple">must</strong> be bound
to memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03777" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03777"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03777</span><br>

For each element of <code>pInfos</code>, the <code>buffer</code> used to create each
acceleration structure referenced by the <code>geometry.instances.data</code>
member of any element of <code>pGeometries</code> or <code>ppGeometries</code> with a
<code>geometryType</code> of <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code> <strong class="purple">must</strong> be
bound to memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03778" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03778"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03778</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>geometry.instances.data.hostAddress</code> <strong class="purple">must</strong> be a valid host address</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-03779" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-03779"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-03779</span><br>

For any element of <code>pInfos</code>[i].<code>pGeometries</code> or
<code>pInfos</code>[i].<code>ppGeometries</code> with a <code>geometryType</code> of
<code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, each
<a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>::<code>accelerationStructureReference</code>
value in <code>geometry.instances.data.hostAddress</code> must be a valid
<a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> object</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-device-parameter" href="#VUID-vkBuildAccelerationStructuresKHR-device-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parameter" href="#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-pInfos-parameter" href="#VUID-vkBuildAccelerationStructuresKHR-pInfos-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-pInfos-parameter</span><br>
 <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter" href="#VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-ppBuildRangeInfos-parameter</span><br>
 <code>ppBuildRangeInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <a href="#VkAccelerationStructureBuildRangeInfoKHR">VkAccelerationStructureBuildRangeInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-infoCount-arraylength" href="#VUID-vkBuildAccelerationStructuresKHR-infoCount-arraylength"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-infoCount-arraylength</span><br>
 <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parent" href="#VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkBuildAccelerationStructuresKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap4.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap4.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy or compact an acceleration structure on the host, call:</p>
</div>
<div id="vkCopyAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
VkResult vkCopyAccelerationStructureKHR(
    VkDevice                                    device,
    VkDeferredOperationKHR                      deferredOperation,
    <span class="directive">const</span> VkCopyAccelerationStructureInfoKHR*   pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the acceleration structures.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap35.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a> but is executed by the host.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-03677" href="#VUID-vkCopyAccelerationStructureKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-03678" href="#VUID-vkCopyAccelerationStructureKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03727" href="#VUID-vkCopyAccelerationStructureKHR-buffer-03727"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03727</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be bound
to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03728" href="#VUID-vkCopyAccelerationStructureKHR-buffer-03728"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03728</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be bound
to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-accelerationStructureHostCommands-03582" href="#VUID-vkCopyAccelerationStructureKHR-accelerationStructureHostCommands-03582"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-accelerationStructureHostCommands-03582</span><br>

The <a href="chap41.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03780" href="#VUID-vkCopyAccelerationStructureKHR-buffer-03780"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03780</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be bound
to memory that was not allocated with multiple instances</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-buffer-03781" href="#VUID-vkCopyAccelerationStructureKHR-buffer-03781"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-buffer-03781</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be bound
to memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-device-parameter" href="#VUID-vkCopyAccelerationStructureKHR-device-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-parameter" href="#VUID-vkCopyAccelerationStructureKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCopyAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-deferredOperation-parent" href="#VUID-vkCopyAccelerationStructureKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyAccelerationStructureKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap4.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap4.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy host accessible memory to an acceleration structure, call:</p>
</div>
<div id="vkCopyMemoryToAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
VkResult vkCopyMemoryToAccelerationStructureKHR(
    VkDevice                                    device,
    VkDeferredOperationKHR                      deferredOperation,
    <span class="directive">const</span> VkCopyMemoryToAccelerationStructureInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;dst</code>.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap35.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command can accept acceleration structures produced by either
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03677" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03678" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03729" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03729"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03729</span><br>

<code>pInfo</code>-&gt;<code>src.hostAddress</code> <strong class="purple">must</strong> be a valid host pointer</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03750" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03750"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-03750</span><br>

<code>pInfo</code>-&gt;<code>src.hostAddress</code> <strong class="purple">must</strong> be aligned to 16 bytes</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03730" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03730"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03730</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be bound
to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-accelerationStructureHostCommands-03583" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-accelerationStructureHostCommands-03583"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-accelerationStructureHostCommands-03583</span><br>

The <a href="chap41.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03782" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03782"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-buffer-03782</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>dst</code> <strong class="purple">must</strong> be bound
to memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parameter" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parent" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyMemoryToAccelerationStructureKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap4.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap4.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure to host accessible memory, call:</p>
</div>
<div id="vkCopyAccelerationStructureToMemoryKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
VkResult vkCopyAccelerationStructureToMemoryKHR(
    VkDevice                                    device,
    VkDeferredOperationKHR                      deferredOperation,
    <span class="directive">const</span> VkCopyAccelerationStructureToMemoryInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo</code>-&gt;<code>src</code>.</p>
</li>
<li>
<p><code>deferredOperation</code> is an optional <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> to
<a href="chap35.html#deferred-host-operations-requesting">request deferral</a> for this
command.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>, but writes its result
directly to a host pointer, and is executed on the host rather than the
device.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> or
<a href="#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03677" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03677"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03677</span><br>

If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, it <strong class="purple">must</strong> be a
valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> object</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03678" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03678"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-03678</span><br>

Any previous deferred operation that was associated with
<code>deferredOperation</code> <strong class="purple">must</strong> be complete</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03731" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03731"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03731</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be bound
to host-visible device memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03732" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03732"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03732</span><br>

<code>pInfo</code>-&gt;<code>dst.hostAddress</code> <strong class="purple">must</strong> be a valid host pointer</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03751" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03751"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-03751</span><br>

<code>pInfo</code>-&gt;<code>dst.hostAddress</code> <strong class="purple">must</strong> be aligned to 16 bytes</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-accelerationStructureHostCommands-03584" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-accelerationStructureHostCommands-03584"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-accelerationStructureHostCommands-03584</span><br>

The <a href="chap41.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03783" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03783"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-buffer-03783</span><br>

The <code>buffer</code> used to create <code>pInfo</code>-&gt;<code>src</code> <strong class="purple">must</strong> be bound
to memory that was not allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parameter" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parameter</span><br>
 If <code>deferredOperation</code> is not <a href="chap51.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>deferredOperation</code> <strong class="purple">must</strong> be a valid <a href="chap35.html#VkDeferredOperationKHR">VkDeferredOperationKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter</span><br>
 <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parent" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parent"></a> <span class="vuid">VUID-vkCopyAccelerationStructureToMemoryKHR-deferredOperation-parent</span><br>
 If <code>deferredOperation</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap4.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap4.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query acceleration structure size parameters on the host, call:</p>
</div>
<div id="vkWriteAccelerationStructuresPropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_acceleration_structure</span>
VkResult vkWriteAccelerationStructuresPropertiesKHR(
    VkDevice                                    device,
    uint32_t                                    accelerationStructureCount,
    <span class="directive">const</span> VkAccelerationStructureKHR*           pAccelerationStructures,
    VkQueryType                                 queryType,
    size_t                                      dataSize,
    <span class="directive">void</span>*                                       pData,
    size_t                                      stride);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the acceleration structures in
<code>pAccelerationStructures</code>.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> points to an array of existing previously
built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap19.html#VkQueryType">VkQueryType</a> value specifying the property to
be queried.</p>
</li>
<li>
<p><code>dataSize</code> is the size in bytes of the buffer pointed to by
<code>pData</code>.</p>
</li>
<li>
<p><code>pData</code> is a pointer to a user-allocated buffer where the results
will be written.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>pData</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> but is executed by the
host.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431</span><br>

All acceleration structures in <code>pAccelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03432" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03432"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03432</span><br>

<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then
<code>stride</code> <strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then
<code>data</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
<code>stride</code> <strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451</span><br>

If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
<code>data</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452</span><br>

<code>dataSize</code> <strong class="purple">must</strong> be greater than or equal to
<span class="eq"><code>accelerationStructureCount</code>*<code>stride</code></span></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03733" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03733"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03733</span><br>

The <code>buffer</code> used to create each acceleration structure in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be bound to host-visible device
memory</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureHostCommands-03585" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureHostCommands-03585"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureHostCommands-03585</span><br>

The <a href="chap41.html#features-accelerationStructureHostCommands"><code>VkPhysicalDeviceAccelerationStructureFeaturesKHR</code>::<code>accelerationStructureHostCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03784" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03784"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-buffer-03784</span><br>

The <code>buffer</code> used to create each acceleration structure in
<code>pAccelerationStructures</code> <strong class="purple">must</strong> be bound to memory that was not
allocated with multiple instances</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter</span><br>
 <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap13.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handles</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter</span><br>
 <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap19.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter</span><br>
 <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength</span><br>
 <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength</span><br>
 <code>dataSize</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent"></a> <span class="vuid">VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent</span><br>
 Each element of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap4.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap4.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div id="footer" style="max-width: 100%;">
<div id="footer-text">
Version 1.1.170<br>
Last updated 2021-02-01 22:51:50 -0800
</div>
</div>


</body>
</html>