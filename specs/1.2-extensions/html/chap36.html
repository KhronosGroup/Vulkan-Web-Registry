<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="The Khronos® Vulkan Working Group">
<title>Vulkan® 1.2.144 - A Specification (with all registered Vulkan extensions)</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fff; color: #222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: black; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #0068b0; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Noto, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Noto, sans-serif; font-weight: normal; font-style: normal; color: black; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #4d4d4d; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #264357; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Noto, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #ddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #ddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #5e93b8; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #5e93b8; }

blockquote, blockquote p { line-height: 1.6; color: #333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #ddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: #fff; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: #eee; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f8; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; background-color: transparent; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.6; color: #264357; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #5e93b8; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #ddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Noto, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: black; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #fff; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #ddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 0 solid #ddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: black; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: black; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Noto, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddd; color: #5e93b8; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: black; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px hidden #666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eee; background-color: #264357; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: black; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #5e93b8; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #5e93b8; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: #eee; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.375em -0.75em; }

ul.inline > li { margin-left: 0.75em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px #fff; -webkit-box-shadow: 0 0 0 1px #ddd; box-shadow: 0 0 0 1px #ddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #29475c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #ddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eee; }

/* From https://github.com/KhronosGroup/Vulkan-Docs/pull/901 */
a code { color: inherit; }

/* Make VUID anchor handles*/
li > p > a[id^="VUID-"] { visibility: hidden; position: absolute; z-index: 1001; width: 2.2ex; margin-left: -2.2ex; display: block; text-decoration: none !important; text-align: center; font-weight: normal; }
li > p > a[id^="VUID-"]:before { content: "\00A7"; font-size: 1em; display: block; padding-top: 0em; background: #fff }
li > p:hover > a[id^="VUID-"], li > p > a[id^="VUID-"]:hover { visibility: visible; }
li > p > a[id^="VUID-"].link { color: black; text-decoration: none; } /* TODO: not quite sure what these two do */
li > p > a[id^="VUID-"].link:hover { color: black; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<style>
    #loading_msg {
        width: 100%;
        margin-left: auto;
        margin-right: auto;
        margin-top: 1ex;
        margin-bottom: 1ex;
        max-width: 62.5em;
        position: relative;
        padding-left: 1.5em;
        padding-right: 1.5em;
    }
    .loadable {display: none !important;}
</style>
<script>
    function unhideLoadableContent(){
        document.getElementById("loading_msg").style.display = "none";
        var loadables = document.getElementsByClassName("loadable");
        for( var i = 0; i < loadables.length; ++i ) loadables[i].classList.remove("loadable");
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
</head>
<body class="book toc2 toc-left" style="max-width: 100%;">
<div id="header">
<h1>Vulkan<sup>®</sup> 1.2.144 - A Specification (with all registered Vulkan extensions)</h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan Working Group</span><br>
<span id="revnumber">version 1.2.144,</span>
<span id="revdate">2020-06-15 07:56:44Z</span>
<br><span id="revremark">from git branch: github-master commit: 9d84b7e4992f764224b9d64a61105123a0860967</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="chap1.html#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap1.html#introduction-conventions">1.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap2.html#fundamentals">2. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap2.html#fundamentals-host-environment">2.1. Host and Device Environment</a></li>
<li><a href="chap2.html#fundamentals-execmodel">2.2. Execution Model</a></li>
<li><a href="chap2.html#fundamentals-objectmodel-overview">2.3. Object Model</a></li>
<li><a href="chap2.html#fundamentals-abi">2.4. Application Binary Interface</a></li>
<li><a href="chap2.html#fundamentals-commandsyntax">2.5. Command Syntax and Duration</a></li>
<li><a href="chap2.html#fundamentals-threadingbehavior">2.6. Threading Behavior</a></li>
<li><a href="chap2.html#fundamentals-errors">2.7. Errors</a></li>
<li><a href="chap2.html#fundamentals-numerics">2.8. Numeric Representation and Computation</a></li>
<li><a href="chap2.html#fundamentals-fixedconv">2.9. Fixed-Point Data Conversions</a></li>
<li><a href="chap2.html#fundamentals-common-objects">2.10. Common Object Types</a></li>
</ul>
</li>
<li><a href="chap3.html#initialization">3. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap3.html#initialization-functionpointers">3.1. Command Function Pointers</a></li>
<li><a href="chap3.html#initialization-instances">3.2. Instances</a></li>
</ul>
</li>
<li><a href="chap4.html#devsandqueues">4. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap4.html#devsandqueues-physical-device-enumeration">4.1. Physical Devices</a></li>
<li><a href="chap4.html#devsandqueues-devices">4.2. Devices</a></li>
<li><a href="chap4.html#devsandqueues-queues">4.3. Queues</a></li>
</ul>
</li>
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<li><a href="chap5.html#commandbuffers">5. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap5.html#commandbuffers-lifecycle">5.1. Command Buffer Lifecycle</a></li>
<li><a href="chap5.html#commandbuffers-pools">5.2. Command Pools</a></li>
<li><a href="chap5.html#commandbuffer-allocation">5.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap5.html#commandbuffers-recording">5.4. Command Buffer Recording</a></li>
<li><a href="chap5.html#commandbuffers-submission">5.5. Command Buffer Submission</a></li>
<li><a href="chap5.html#commandbuffers-submission-progress">5.6. Queue Forward Progress</a></li>
<li><a href="chap5.html#commandbuffers-secondary">5.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap5.html#commandbuffers-devicemask">5.8. Command Buffer Device Mask</a></li>
</ul>
</li>
<li><a href="chap6.html#synchronization">6. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li><a href="chap6.html#synchronization-dependencies">6.1. Execution and Memory Dependencies</a></li>
<li><a href="chap6.html#synchronization-implicit">6.2. Implicit Synchronization Guarantees</a></li>
<li><a href="chap6.html#synchronization-fences">6.3. Fences</a></li>
<li><a href="chap6.html#synchronization-semaphores">6.4. Semaphores</a></li>
<li><a href="chap6.html#synchronization-events">6.5. Events</a></li>
<li><a href="chap6.html#synchronization-pipeline-barriers">6.6. Pipeline Barriers</a></li>
<li><a href="chap6.html#synchronization-memory-barriers">6.7. Memory Barriers</a></li>
<li><a href="chap6.html#synchronization-wait-idle">6.8. Wait Idle Operations</a></li>
<li><a href="chap6.html#synchronization-submission-host-writes">6.9. Host Write Ordering Guarantees</a></li>
<li><a href="chap6.html#synchronization-device-group">6.10. Synchronization and Multiple Physical Devices</a></li>
<li><a href="chap6.html#calibrated-timestamps">6.11. Calibrated timestamps</a></li>
</ul>
</li>
<li><a href="chap7.html#renderpass">7. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap7.html#renderpass-creation">7.1. Render Pass Creation</a></li>
<ul class="sectlevel1"><li><a href="index.html#preamble">0. Preamble</a></li></ul>
<li><a href="chap7.html#renderpass-compatibility">7.2. Render Pass Compatibility</a></li>
<li><a href="chap7.html#_framebuffers">7.3. Framebuffers</a></li>
<li><a href="chap7.html#renderpass-commands">7.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="chap8.html#shaders">8. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap8.html#shader-modules">8.1. Shader Modules</a></li>
<li><a href="chap8.html#shaders-execution">8.2. Shader Execution</a></li>
<li><a href="chap8.html#shaders-execution-memory-ordering">8.3. Shader Memory Access Ordering</a></li>
<li><a href="chap8.html#shaders-inputs">8.4. Shader Inputs and Outputs</a></li>
<li><a href="chap8.html#shaders-task">8.5. Task Shaders</a></li>
<li><a href="chap8.html#shaders-mesh">8.6. Mesh Shaders</a></li>
<li><a href="chap8.html#shaders-vertex">8.7. Vertex Shaders</a></li>
<li><a href="chap8.html#shaders-tessellation-control">8.8. Tessellation Control Shaders</a></li>
<li><a href="chap8.html#shaders-tessellation-evaluation">8.9. Tessellation Evaluation Shaders</a></li>
<li><a href="chap8.html#shaders-geometry">8.10. Geometry Shaders</a></li>
<li><a href="chap8.html#shaders-fragment">8.11. Fragment Shaders</a></li>
<li><a href="chap8.html#shaders-compute">8.12. Compute Shaders</a></li>
<li><a href="chap8.html#shaders-interpolation-decorations">8.13. Interpolation Decorations</a></li>
<li><a href="chap8.html#shaders-ray-generation">8.14. Ray Generation Shaders</a></li>
<li><a href="chap8.html#shaders-intersection">8.15. Intersection Shaders</a></li>
<li><a href="chap8.html#shaders-any-hit">8.16. Any-Hit Shaders</a></li>
<li><a href="chap8.html#shaders-closest-hit">8.17. Closest Hit Shaders</a></li>
<li><a href="chap8.html#shaders-miss">8.18. Miss Shaders</a></li>
<li><a href="chap8.html#shaders-callable">8.19. Callable Shaders</a></li>
<li><a href="chap8.html#shaders-staticuse">8.20. Static Use</a></li>
<li><a href="chap8.html#shaders-scope">8.21. Scope</a></li>
<li><a href="chap8.html#shaders-group-operations">8.22. Group Operations</a></li>
<li><a href="chap8.html#shaders-quad-operations">8.23. Quad Group Operations</a></li>
<li><a href="chap8.html#shaders-derivative-operations">8.24. Derivative Operations</a></li>
<li><a href="chap8.html#shaders-helper-invocations">8.25. Helper Invocations</a></li>
<li><a href="chap8.html#_cooperative_matrices">8.26. Cooperative Matrices</a></li>
<li><a href="chap8.html#shaders-validation-cache">8.27. Validation Cache</a></li>
</ul>
</li>
<li><a href="chap9.html#pipelines">9. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap9.html#pipelines-compute">9.1. Compute Pipelines</a></li>
<li><a href="chap9.html#pipelines-graphics">9.2. Graphics Pipelines</a></li>
<li><a href="chap9.html#pipelines-destruction">9.3. Pipeline destruction</a></li>
<li><a href="chap9.html#pipelines-multiple">9.4. Multiple Pipeline Creation</a></li>
<li><a href="chap9.html#pipelines-pipeline-derivatives">9.5. Pipeline Derivatives</a></li>
<li><a href="chap9.html#pipelines-cache">9.6. Pipeline Cache</a></li>
<li><a href="chap9.html#pipelines-specialization-constants">9.7. Specialization Constants</a></li>
<li><a href="chap9.html#pipeline-library">9.8. Pipeline Libraries</a></li>
<li><a href="chap9.html#pipelines-binding">9.9. Pipeline Binding</a></li>
<li><a href="chap9.html#pipelines-dynamic-state">9.10. Dynamic State</a></li>
<li><a href="chap9.html#pipelines-shader-information">9.11. Pipeline Shader Information</a></li>
<li><a href="chap9.html#pipelines-compiler-control">9.12. Pipeline Compiler Control</a></li>
<li><a href="chap9.html#pipelines-ray-tracing">9.13. Ray Tracing Pipeline</a></li>
<li><a href="chap9.html#pipelines-creation-feedback">9.14. Pipeline Creation Feedback</a></li>
</ul>
</li>
<li><a href="chap10.html#memory">10. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap10.html#memory-host">10.1. Host Memory</a></li>
<li><a href="chap10.html#memory-device">10.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap11.html#resources">11. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#resources-buffers">11.1. Buffers</a></li>
<li><a href="chap11.html#resources-buffer-views">11.2. Buffer Views</a></li>
<li><a href="chap11.html#resources-images">11.3. Images</a></li>
<li><a href="chap11.html#resources-image-layouts">11.4. Image Layouts</a></li>
<li><a href="chap11.html#resources-image-views">11.5. Image Views</a></li>
<li><a href="chap11.html#resources-association">11.6. Resource Memory Association</a></li>
<li><a href="chap11.html#resources-sharing">11.7. Resource Sharing Mode</a></li>
<li><a href="chap11.html#resources-memory-aliasing">11.8. Memory Aliasing</a></li>
<li><a href="chap11.html#resources-acceleration-structures">11.9. Acceleration Structures</a></li>
</ul>
</li>
<li><a href="chap12.html#samplers">12. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap12.html#samplers-YCbCr-conversion">12.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> conversion</a></li>
</ul>
</li>
<li><a href="chap13.html#descriptorsets">13. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap13.html#descriptorsets-types">13.1. Descriptor Types</a></li>
<li><a href="chap13.html#descriptorsets-sets">13.2. Descriptor Sets</a></li>
<li><a href="chap13.html#_physical_storage_buffer_access">13.3. Physical Storage Buffer Access</a></li>
</ul>
</li>
<li><a href="chap14.html#interfaces">14. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap14.html#interfaces-iointerfaces">14.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap14.html#interfaces-vertexinput">14.2. Vertex Input Interface</a></li>
<li><a href="chap14.html#interfaces-fragmentoutput">14.3. Fragment Output Interface</a></li>
<li><a href="chap14.html#interfaces-inputattachment">14.4. Fragment Input Attachment Interface</a></li>
<li><a href="chap14.html#interfaces-resources">14.5. Shader Resource Interface</a></li>
<li><a href="chap14.html#interfaces-builtin-variables">14.6. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap15.html#textures">15. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap15.html#_image_operations_overview">15.1. Image Operations Overview</a></li>
<li><a href="chap15.html#_conversion_formulas">15.2. Conversion Formulas</a></li>
<li><a href="chap15.html#_texel_input_operations">15.3. Texel Input Operations</a></li>
<li><a href="chap15.html#_texel_output_operations">15.4. Texel Output Operations</a></li>
<li><a href="chap15.html#textures-normalized-operations">15.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap15.html#_unnormalized_texel_coordinate_operations">15.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap15.html#textures-integer-coordinate-operations">15.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap15.html#textures-sample-operations">15.8. Image Sample Operations</a></li>
<li><a href="chap15.html#textures-footprint">15.9. Texel Footprint Evaluation</a></li>
<li><a href="chap15.html#textures-instructions">15.10. Image Operation Steps</a></li>
</ul>
</li>
<li><a href="chap16.html#fragmentdensitymapops">16. Fragment Density Map Operations</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_fragment_density_map_operations_overview">16.1. Fragment Density Map Operations Overview</a></li>
<li><a href="chap16.html#fragmentdensitymap-fetch-density-value">16.2. Fetch Density Value</a></li>
<li><a href="chap16.html#fragmentdensitymap-conversion-to-fragment-area">16.3. Fragment Area Conversion</a></li>
</ul>
</li>
<li><a href="chap17.html#queries">17. Queries</a>
<ul class="sectlevel2">
<li><a href="chap17.html#queries-pools">17.1. Query Pools</a></li>
<li><a href="chap17.html#queries-operation">17.2. Query Operation</a></li>
<li><a href="chap17.html#queries-occlusion">17.3. Occlusion Queries</a></li>
<li><a href="chap17.html#queries-pipestats">17.4. Pipeline Statistics Queries</a></li>
<li><a href="chap17.html#queries-timestamps">17.5. Timestamp Queries</a></li>
<li><a href="chap17.html#queries-performance">17.6. Performance Queries</a></li>
<li><a href="chap17.html#queries-transform-feedback">17.7. Transform Feedback Queries</a></li>
<li><a href="chap17.html#queries-performance-intel">17.8. Intel performance queries</a></li>
</ul>
</li>
<li><a href="chap18.html#clears">18. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#clears-outside">18.1. Clearing Images Outside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-inside">18.2. Clearing Images Inside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-values">18.3. Clear Values</a></li>
<li><a href="chap18.html#clears-filling-buffers">18.4. Filling Buffers</a></li>
<li><a href="chap18.html#clears-updating-buffers">18.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap19.html#copies">19. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#_common_operation">19.1. Common Operation</a></li>
<li><a href="chap19.html#copies-buffers">19.2. Copying Data Between Buffers</a></li>
<li><a href="chap19.html#copies-images">19.3. Copying Data Between Images</a></li>
<li><a href="chap19.html#copies-buffers-images">19.4. Copying Data Between Buffers and Images</a></li>
<li><a href="chap19.html#copies-imagescaling">19.5. Image Copies with Scaling</a></li>
<li><a href="chap19.html#copies-resolve">19.6. Resolving Multisample Images</a></li>
<li><a href="chap19.html#copies-buffer-markers">19.7. Buffer Markers</a></li>
</ul>
</li>
<li><a href="chap20.html#drawing">20. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#drawing-primitive-topologies">20.1. Primitive Topologies</a></li>
<li><a href="chap20.html#drawing-primitive-order">20.2. Primitive Order</a></li>
<li><a href="chap20.html#drawing-primitive-shading">20.3. Programmable Primitive Shading</a></li>
<li><a href="chap20.html#drawing-conditional-rendering">20.4. Conditional Rendering</a></li>
<li><a href="chap20.html#drawing-mesh-shading">20.5. Programmable Mesh Shading</a></li>
</ul>
</li>
<li><a href="chap21.html#fxvertex">21. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap21.html#fxvertex-attrib">21.1. Vertex Attributes</a></li>
<li><a href="chap21.html#fxvertex-input">21.2. Vertex Input Description</a></li>
<li><a href="chap21.html#_vertex_attribute_divisor_in_instanced_rendering">21.3. Vertex Attribute Divisor in Instanced Rendering</a></li>
<li><a href="chap21.html#fxvertex-example">21.4. Example</a></li>
</ul>
</li>
<li><a href="chap22.html#tessellation">22. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap22.html#_tessellator">22.1. Tessellator</a></li>
<li><a href="chap22.html#_tessellator_patch_discard">22.2. Tessellator Patch Discard</a></li>
<li><a href="chap22.html#tessellation-tessellator-spacing">22.3. Tessellator Spacing</a></li>
<li><a href="chap22.html#tessellation-primitive-order">22.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap22.html#tessellation-vertex-winding-order">22.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap22.html#tessellation-triangle-tessellation">22.6. Triangle Tessellation</a></li>
<li><a href="chap22.html#tessellation-quad-tessellation">22.7. Quad Tessellation</a></li>
<li><a href="chap22.html#tessellation-isoline-tessellation">22.8. Isoline Tessellation</a></li>
<li><a href="chap22.html#tessellation-point-mode">22.9. Tessellation Point Mode</a></li>
<li><a href="chap22.html#_tessellation_pipeline_state">22.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap23.html#geometry">23. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#geometry-input">23.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap23.html#geometry-output">23.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap23.html#geometry-invocations">23.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap23.html#geometry-ordering">23.4. Geometry Shader Primitive Ordering</a></li>
<li><a href="chap23.html#geometry-passthrough">23.5. Geometry Shader Passthrough</a></li>
</ul>
</li>
<li><a href="chap24.html#mesh">24. Mesh Shading</a>
<ul class="sectlevel2">
<li><a href="chap24.html#mesh-task-input">24.1. Task Shader Input</a></li>
<li><a href="chap24.html#mesh-task-output">24.2. Task Shader Output</a></li>
<li><a href="chap24.html#mesh-generation">24.3. Mesh Generation</a></li>
<li><a href="chap24.html#mesh-input">24.4. Mesh Shader Input</a></li>
<li><a href="chap24.html#mesh-output">24.5. Mesh Shader Output Primitives</a></li>
<li><a href="chap24.html#mesh-output-perview">24.6. Mesh Shader Per-View Outputs</a></li>
<li><a href="chap24.html#mesh-ordering">24.7. Mesh Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap25.html#vertexpostproc">25. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap25.html#vertexpostproc-transform-feedback">25.1. Transform Feedback</a></li>
<li><a href="chap25.html#vertexpostproc-viewport-swizzle">25.2. Viewport Swizzle</a></li>
<li><a href="chap25.html#vertexpostproc-flatshading">25.3. Flat Shading</a></li>
<li><a href="chap25.html#vertexpostproc-clipping">25.4. Primitive Clipping</a></li>
<li><a href="chap25.html#vertexpostproc-clipping-shader-outputs">25.5. Clipping Shader Outputs</a></li>
<li><a href="chap25.html#vertexpostproc-viewportwscaling">25.6. Controlling Viewport W Scaling</a></li>
<li><a href="chap25.html#vertexpostproc-coord-transform">25.7. Coordinate Transformations</a></li>
<li><a href="chap25.html#vertexpostproc-renderpass-transform">25.8. Render Pass Transform</a></li>
<li><a href="chap25.html#vertexpostproc-viewport">25.9. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap26.html#primsrast">26. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap26.html#primsrast-discard">26.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap26.html#primsrast-stream">26.2. Controlling the Vertex Stream Used for Rasterization</a></li>
<li><a href="chap26.html#primrast-order">26.3. Rasterization Order</a></li>
<li><a href="chap26.html#primsrast-multisampling">26.4. Multisampling</a></li>
<li><a href="chap26.html#primrast-samplelocations">26.5. Custom Sample Locations</a></li>
<li><a href="chap26.html#primsrast-shading-rate-image">26.6. Shading Rate Image</a></li>
<li><a href="chap26.html#primsrast-sampleshading">26.7. Sample Shading</a></li>
<li><a href="chap26.html#primsrast-barycentric">26.8. Barycentric Interpolation</a></li>
<li><a href="chap26.html#primsrast-points">26.9. Points</a></li>
<li><a href="chap26.html#primsrast-lines">26.10. Line Segments</a></li>
<li><a href="chap26.html#primsrast-polygons">26.11. Polygons</a></li>
</ul>
</li>
<li><a href="chap27.html#fragops">27. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap27.html#fragops-discard-rectangles">27.1. Discard Rectangles Test</a></li>
<li><a href="chap27.html#fragops-scissor">27.2. Scissor Test</a></li>
<li><a href="chap27.html#fragops-exclusive-scissor">27.3. Exclusive Scissor Test</a></li>
<li><a href="chap27.html#fragops-samplemask">27.4. Sample Mask Test</a></li>
<li><a href="chap27.html#fragops-covg">27.5. Multisample Coverage</a></li>
<li><a href="chap27.html#fragops-ds-state">27.6. Depth and Stencil Operations</a></li>
<li><a href="chap27.html#fragops-dbt">27.7. Depth Bounds Test</a></li>
<li><a href="chap27.html#fragops-stencil">27.8. Stencil Test</a></li>
<li><a href="chap27.html#fragops-depth">27.9. Depth Test</a></li>
<li><a href="chap27.html#fragops-rep-frag-test">27.10. Representative Fragment Test</a></li>
<li><a href="chap27.html#fragops-samplecount">27.11. Sample Counting</a></li>
<li><a href="chap27.html#fragops-coverage-to-color">27.12. Fragment Coverage To Color</a></li>
<li><a href="chap27.html#fragops-coverage-reduction">27.13. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap28.html#framebuffer">28. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap28.html#framebuffer-blending">28.1. Blending</a></li>
<li><a href="chap28.html#framebuffer-logicop">28.2. Logical Operations</a></li>
<li><a href="chap28.html#framebuffer-color-write-mask">28.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap29.html#dispatch">29. Dispatching Commands</a></li>
<li><a href="chap30.html#device-generated-commands">30. Device-Generated Commands</a>
<ul class="sectlevel2">
<li><a href="chap30.html#indirectmdslayout">30.1. Indirect Commands Layout</a></li>
<li><a href="chap30.html#_indirect_commands_generation_and_execution">30.2. Indirect Commands Generation And Execution</a></li>
</ul>
</li>
<li><a href="chap31.html#sparsememory">31. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap31.html#sparsememory-sparseresourcefeatures">31.1. Sparse Resource Features</a></li>
<li><a href="chap31.html#sparsememory-fully-resident">31.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap31.html#sparsememory-partially-resident-buffers">31.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap31.html#sparsememory-partially-resident-images">31.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap31.html#sparsememory-sparse-memory-aliasing">31.5. Sparse Memory Aliasing</a></li>
<li><a href="chap31.html#_sparse_resource_implementation_guidelines">31.6. Sparse Resource Implementation Guidelines</a></li>
<li><a href="chap31.html#sparsememory-resourceapi">31.7. Sparse Resource API</a></li>
<li><a href="chap31.html#sparsememory-examples">31.8. Examples</a></li>
</ul>
</li>
<li><a href="chap32.html#wsi">32. Window System Integration (WSI)</a>
<ul class="sectlevel2">
<li><a href="chap32.html#_wsi_platform">32.1. WSI Platform</a></li>
<li><a href="chap32.html#_wsi_surface">32.2. WSI Surface</a></li>
<li><a href="chap32.html#display">32.3. Presenting Directly to Display Devices</a></li>
<li><a href="chap32.html#_querying_for_wsi_support">32.4. Querying for WSI Support</a></li>
<li><a href="chap32.html#_surface_queries">32.5. Surface Queries</a></li>
<li><a href="chap32.html#_full_screen_exclusive_control">32.6. Full Screen Exclusive Control</a></li>
<li><a href="chap32.html#_device_group_queries">32.7. Device Group Queries</a></li>
<li><a href="chap32.html#_display_timing_queries">32.8. Display Timing Queries</a></li>
<li><a href="chap32.html#_wsi_swapchain">32.9. WSI Swapchain</a></li>
<li><a href="chap32.html#_hdr_metadata">32.10. Hdr Metadata</a></li>
</ul>
</li>
<li><a href="chap33.html#deferred-host-operations">33. Deferred Host Operations</a>
<ul class="sectlevel2">
<li><a href="chap33.html#_requesting_deferral">33.1. Requesting Deferral</a></li>
<li><a href="chap33.html#_deferred_host_operations_api">33.2. Deferred Host Operations API</a></li>
</ul>
</li>
<li><a href="chap34.html#private-data">34. Private Data</a></li>
<li><a href="chap35.html#ray-traversal">35. Ray Traversal</a>
<ul class="sectlevel2">
<li><a href="chap35.html#_ray_intersection_candidate_determination">35.1. Ray Intersection Candidate Determination</a></li>
<li><a href="chap35.html#_ray_intersection_culling">35.2. Ray Intersection Culling</a></li>
<li><a href="chap35.html#_ray_intersection_confirmation">35.3. Ray Intersection Confirmation</a></li>
<li><a href="chap35.html#_ray_closest_hit_determination">35.4. Ray Closest Hit Determination</a></li>
<li><a href="chap35.html#_ray_result_determination">35.5. Ray Result Determination</a></li>
</ul>
</li>
<li><a href="#ray-tracing">36. Ray Tracing</a>
<ul class="sectlevel2">
<li><a href="#ray-tracing-shader-call">36.1. Shader Call Instructions</a></li>
<li><a href="#ray-tracing-commands">36.2. Ray Tracing Commands</a></li>
<li><a href="#shader-binding-table">36.3. Shader Binding Table</a></li>
<li><a href="#acceleration-structure">36.4. Acceleration Structures</a></li>
<li><a href="#host-acceleration-structure">36.5. Host Acceleration Structure Operations</a></li>
</ul>
</li>
<li><a href="chap37.html#extendingvulkan">37. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap37.html#extendingvulkan-instanceanddevicefunctionality">37.1. Instance and Device Functionality</a></li>
<li><a href="chap37.html#extendingvulkan-coreversions">37.2. Core Versions</a></li>
<li><a href="chap37.html#extendingvulkan-layers">37.3. Layers</a></li>
<li><a href="chap37.html#extendingvulkan-extensions">37.4. Extensions</a></li>
<li><a href="chap37.html#extendingvulkan-extensions-extensiondependencies">37.5. Extension Dependencies</a></li>
<li><a href="chap37.html#_compatibility_guarantees_informative">37.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap38.html#features">38. Features</a>
<ul class="sectlevel2">
<li><a href="chap38.html#features-requirements">38.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap39.html#limits">39. Limits</a>
<ul class="sectlevel2">
<li><a href="chap39.html#limits-minmax">39.1. Limit Requirements</a></li>
<li><a href="chap39.html#limits-multisample">39.2. Additional Multisampling Capabilities</a></li>
</ul>
</li>
<li><a href="chap40.html#formats">40. Formats</a>
<ul class="sectlevel2">
<li><a href="chap40.html#formats-definition">40.1. Format Definition</a></li>
<li><a href="chap40.html#formats-properties">40.2. Format Properties</a></li>
<li><a href="chap40.html#features-required-format-support">40.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap41.html#capabilities">41. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap41.html#capabilities-image">41.1. Additional Image Capabilities</a></li>
<li><a href="chap41.html#capabilities-buffer">41.2. Additional Buffer Capabilities</a></li>
<li><a href="chap41.html#capabilities-semaphore">41.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap41.html#capabilities-fence">41.4. Optional Fence Capabilities</a></li>
<li><a href="chap41.html#features-timestamp-calibration">41.5. Timestamp Calibration Capabilities</a></li>
</ul>
</li>
<li><a href="chap42.html#_debugging">42. Debugging</a>
<ul class="sectlevel2">
<li><a href="chap42.html#debugging-debug-utils">42.1. Debug Utilities</a></li>
<li><a href="chap42.html#debugging-debug-markers">42.2. Debug Markers</a></li>
<li><a href="chap42.html#debugging-debug-report-callbacks">42.3. Debug Report Callbacks</a></li>
<li><a href="chap42.html#_device_loss_debugging">42.4. Device Loss Debugging</a></li>
<li><a href="chap42.html#debugging-tooling-info">42.5. Active Tooling Information</a></li>
</ul>
</li>
<li><a href="chap43.html#spirvenv">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap43.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap43.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap43.html#spirvenv-module-validation">Validation Rules within a Module</a></li>
<li><a href="chap43.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap43.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats And Vulkan Formats</a></li>
</ul>
</li>
<li><a href="chap44.html#memory-model">Appendix B: Memory Model</a>
<ul class="sectlevel2">
<li><a href="chap44.html#memory-model-agent">Agent</a></li>
<li><a href="chap44.html#memory-model-memory-location">Memory Location</a></li>
<li><a href="chap44.html#memory-model-allocation">Allocation</a></li>
<li><a href="chap44.html#memory-model-memory-operation">Memory Operation</a></li>
<li><a href="chap44.html#memory-model-references">Reference</a></li>
<li><a href="chap44.html#memory-model-program-order">Program-Order</a></li>
<li><a href="chap44.html#shader-call-related">Shader Call Related</a></li>
<li><a href="chap44.html#shader-call-order">Shader Call Order</a></li>
<li><a href="chap44.html#memory-model-scope">Scope</a></li>
<li><a href="chap44.html#memory-model-atomic-operation">Atomic Operation</a></li>
<li><a href="chap44.html#memory-model-scoped-modification-order">Scoped Modification Order</a></li>
<li><a href="chap44.html#memory-model-memory-semantics">Memory Semantics</a></li>
<li><a href="chap44.html#memory-model-release-sequence">Release Sequence</a></li>
<li><a href="chap44.html#memory-model-synchronizes-with">Synchronizes-With</a></li>
<li><a href="chap44.html#memory-model-system-synchronizes-with">System-Synchronizes-With</a></li>
<li><a href="chap44.html#memory-model-non-private">Private vs. Non-Private</a></li>
<li><a href="chap44.html#memory-model-inter-thread-happens-before">Inter-Thread-Happens-Before</a></li>
<li><a href="chap44.html#memory-model-happens-before">Happens-Before</a></li>
<li><a href="chap44.html#memory-model-availability-visibility">Availability and Visibility</a></li>
<li><a href="chap44.html#memory-model-vulkan-availability-visibility">Availability, Visibility, and Domain Operations</a></li>
<li><a href="chap44.html#memory-model-availability-visibility-semantics">Availability and Visibility Semantics</a></li>
<li><a href="chap44.html#memory-model-instruction-av-vis">Per-Instruction Availability and Visibility Semantics</a></li>
<li><a href="chap44.html#memory-model-location-ordered">Location-Ordered</a></li>
<li><a href="chap44.html#memory-model-access-data-race">Data Race</a></li>
<li><a href="chap44.html#memory-model-visible-to">Visible-To</a></li>
<li><a href="chap44.html#memory-model-acyclicity">Acyclicity</a></li>
<li><a href="chap44.html#memory-model-shader-io">Shader I/O</a></li>
<li><a href="chap44.html#memory-model-deallocation">Deallocation</a></li>
<li><a href="chap44.html#memory-model-informative-descriptions">Informative Descriptions</a></li>
<li><a href="chap44.html#memory-model-tessellation-output-ordering">Tessellation Output Ordering</a></li>
<li><a href="chap44.html#memory-model-cooperative-matrix">Cooperative Matrix Memory Access</a></li>
</ul>
</li>
<li><a href="chap45.html#_compressed_image_formats">Appendix C: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap45.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap45.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap45.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
<li><a href="chap45.html#appendix-compressedtex-pvrtc">PVRTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap46.html#versions">Appendix D: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap46.html#versions-1.2">Version 1.2</a></li>
<li><a href="chap46.html#versions-1.1">Version 1.1</a></li>
</ul>
</li>
<li><a href="chap47.html#extensions">Appendix E: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap47.html#extension-appendices-list">List of Current Extensions</a></li>
<li><a href="chap47.html#provisional-extension-appendices-list">List of Provisional Extensions</a></li>
<li><a href="chap47.html#deprecated-extension-appendices-list">List of Deprecated Extensions</a></li>
</ul>
</li>
<li><a href="chap48.html#boilerplate">Appendix F: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap48.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap48.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap48.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
</ul>
</li>
<li><a href="chap49.html#invariance">Appendix G: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap49.html#_repeatability">Repeatability</a></li>
<li><a href="chap49.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap49.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap49.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap50.html#glossary">Glossary</a></li>
<li><a href="chap51.html#_common_abbreviations">Common Abbreviations</a></li>
<li><a href="chap52.html#_prefixes">Prefixes</a></li>
<li><a href="chap53.html#credits">Appendix H: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap53.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap53.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
</div>

<div id="loading_msg"><p>Loading... please wait.</p></div>
<div id="content"><div class="sect1">
<h2 id="ray-tracing"><a class="anchor" href="#ray-tracing"></a>36. Ray Tracing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ray tracing uses a separate rendering pipeline from both the graphics and
compute pipelines (see <a href="chap9.html#pipelines-ray-tracing">Ray Tracing Pipeline</a>).</p>
</div>
<div id="fig-raypipe" class="imageblock text-center">
<div class="content">
<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="454.53473" height="183.80112" viewBox="0 0 454.53472 183.80112" version="1.1" id="svg8" sodipodi:docname="ray_tracing_execution.svg" inkscape:version="0.92.4 (5da689c313, 2019-01-14)">
  <defs id="defs2">
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-4-7" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-81-1" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-4-7-1" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-81-1-2" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-8-1-7-0" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-8-2-1-9" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-8-1-7-05" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-8-2-1-3" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-8-1-7-05-1" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-8-2-1-3-9" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-4-7-13" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-81-1-8" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Mend" orient="auto" refY="0" refX="0" id="marker9512-2-2-4-7-1-3" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path9510-2-3-81-1-2-3" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.4,0,0,-0.4,-4,0)" inkscape:connector-curvature="0"></path>
    </marker>
  </defs>
  <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="2.0000001" inkscape:cx="263.45186" inkscape:cy="204.85377" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" inkscape:snap-center="true" inkscape:snap-object-midpoints="true" inkscape:snap-text-baseline="true" inkscape:window-width="1920" inkscape:window-height="1001" inkscape:window-x="-9" inkscape:window-y="-9" inkscape:window-maximized="0" showguides="false" fit-margin-top="1" fit-margin-right="1" fit-margin-bottom="1" fit-margin-left="1" units="in" inkscape:snap-others="true" inkscape:snap-nodes="true" inkscape:object-nodes="true" height="7.5in">
    <inkscape:grid type="xygrid" id="grid817" originx="79.262856" originy="-1225.558"></inkscape:grid>
  </sodipodi:namedview>
  <metadata id="metadata5">
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-35.742392,209.97146)">
    <g id="g1684" transform="translate(76.761047,177.11848)">
      <rect y="-385.62808" x="196.64136" height="47.54937" width="98.349922" id="rect815-1-6-5-1-3-2-0" style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.92372322;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"></rect>
      <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" x="246.41849" y="-357.55588" id="text823-0-2-6-1-7-2-1"><tspan y="-357.55588" x="246.41849" id="tspan981" sodipodi:role="line">Any Hit</tspan></text>
    </g>
    <g transform="translate(-36.358826,-133.79857)" id="g988-3">
      <g id="g4763">
        <rect style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.92372322;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect815-1-6-5-1-3-2-0-7" width="98.349922" height="47.54937" x="191.76122" y="-74.711029"></rect>
        <text id="text823-0-2-6-1-7-2-1-1" y="-46.1577" x="241.06639" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan sodipodi:role="line" id="tspan8376" x="241.06639" y="-46.1577">Intersection</tspan></text>
      </g>
    </g>
    <text id="text823-0-2-6-1-7-2-1-9-1" y="-113.86218" x="438.78833" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan sodipodi:role="line" id="tspan6495" x="438.78833" y="-113.86218">Hit?</tspan></text>
    <g id="g7686" transform="translate(-211.72239,-23.523486)">
      <rect y="-184.80975" x="600.11108" height="47.54937" width="98.349922" id="rect815-1-6-5-1-3-0-9" style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.92372322;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"></rect>
      <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" x="649.0517" y="-156.07088" id="text823-0-2-6-1-7-4-9"><tspan y="-156.07088" x="649.0517" id="tspan6645" sodipodi:role="line">Closest Hit</tspan></text>
    </g>
    <g transform="translate(196.84052,-0.4705565)" id="g988-3-6">
      <g id="g4763-9">
        <rect style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.92372322;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect815-1-6-5-1-3-2-0-7-3" width="98.349922" height="47.54937" x="191.76122" y="-74.711029"></rect>
        <text id="text823-0-2-6-1-7-2-1-1-5" y="-46.144676" x="240.56183" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan sodipodi:role="line" id="tspan6647" x="240.56183" y="-46.144676">Miss</tspan></text>
      </g>
    </g>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-4-7)" d="m 439.07803,-95.453012 v 17.927004" id="path9502-8-53-6-5" inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
    <rect style="fill:none;stroke:#000000;stroke-width:1.44848073;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect3643-7-6" width="54.151859" height="54.151859" x="354.16718" y="78.002197" transform="matrix(0.90285598,-0.42994311,0.90285598,0.42994311,0,0)"></rect>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-4-7-1)" d="m 439.07803,-142.01745 v -16.38351" id="path9502-8-53-6-5-2" inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
    <text id="text823-0-2-6-1-7-2-1-5-2-2" y="-145.3622" x="431.07803" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan sodipodi:role="line" id="tspan9812-5-3" x="431.07803" y="-145.3622">Y</tspan></text>
    <text id="text823-0-2-6-1-7-2-1-5-1-3" y="-82.515198" x="431.065" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan sodipodi:role="line" id="tspan10386-33" x="431.065" y="-82.515198">N</tspan></text>
    <g id="g988-0" transform="translate(-277.43985,-72.408014)">
      <g id="g1576">
        <rect style="fill:#ffffff;fill-opacity:1;stroke:#ff0000;stroke-width:0.92372322;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect815-1-6-5-1-3-2-0-6" width="98.349922" height="47.54937" x="314.6441" y="-70.14447"></rect>
        <text id="text823-0-2-6-1-7-2-1-8" y="-50.072266" x="364.42123" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan y="-50.072266" x="364.42123" id="tspan1568" sodipodi:role="line">Ray</tspan><tspan y="-33.405598" x="364.42123" id="tspan1570" sodipodi:role="line">Generation</tspan></text>
      </g>
    </g>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.92372322;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" id="rect815-1-6-3" width="215.34993" height="47.54937" x="155.40239" y="-142.5096"></rect>
    <text id="text823-0-2-6" y="-130.43739" x="263.56888" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13.33333302px;line-height:1.25;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1.26999986;stroke-miterlimit:4;stroke-dasharray:none" xml:space="preserve"><tspan y="-130.43739" x="263.56888" id="tspan947-5" sodipodi:role="line">Acceleration</tspan><tspan id="tspan1116" y="-113.77073" x="263.56888" sodipodi:role="line">Structure</tspan><tspan id="tspan1118" y="-97.104057" x="263.56888" sodipodi:role="line">Traversal</tspan></text>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-8-1-7-0)" d="m 135.82735,-118.73491 h 17.927" id="path9502-8-53-7-5-7-6" inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-8-1-7-05)" d="M 370.25969,-118.73523 H 388.1867" id="path9502-8-53-7-5-7-0" inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-8-1-7-05-1)" d="m 254.12852,-184.73491 h 17.92701" id="path9502-8-53-7-5-7-0-2" inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-4-7-13)" d="m 323.17953,-161.4009 v 17.927" id="path9502-8-53-6-5-25" inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker9512-2-2-4-7-1-3)" d="m 204.70756,-142.77917 v -16.38351" id="path9502-8-53-6-5-2-9" inkscape:connector-curvature="0" sodipodi:nodetypes="cc" inkscape:transform-center-x="-208" inkscape:transform-center-y="18.485341"></path>
  </g>
</svg>
</div>
<div class="title">Figure 24. Ray tracing pipeline execution</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Caption</div>
<div class="paragraph">
<p>Interaction between the different shader stages in the ray tracing pipeline</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Within the ray tracing pipeline, <code>OpTraceRayKHR</code> <strong class="purple">can</strong> be called to
perform a <a href="chap35.html#ray-traversal">ray traversal</a> that invokes the various ray
tracing shader stages during its execution.
The relationship between the ray tracing pipeline object and the geometries
present in the acceleration structure traversed is passed into the ray
tracing command in a <a href="chap11.html#VkBuffer">VkBuffer</a> object known as a <em>shader binding
table</em>.
<code>OpExecuteCallableKHR</code> can also be used in ray tracing pipelines to
invoke a <a href="chap8.html#shaders-callable">callable shader</a>.</p>
</div>
<div class="paragraph">
<p>During execution, control alternates between scheduling and other
operations.
The scheduling functionality is implementation-specific and is responsible
for workload execution.
The shader stages are programmable.
<a href="chap35.html#ray-traversal"><em>Traversal</em></a>, which refers to the process of traversing
acceleration structures to find potential intersections of rays with
geometry, is fixed function.</p>
</div>
<div class="paragraph">
<p>The programmable portions of the pipeline are exposed in a single-ray
programming model, with each invocation handling one ray at a time.
Memory operations <strong class="purple">can</strong> be synchronized using standard memory barriers.
The <code>Workgroup</code> scope and variables with a storage class of
<code>Workgroup</code> <strong class="purple">must</strong> not be used in the ray tracing pipeline.</p>
</div>
<div class="sect2">
<h3 id="ray-tracing-shader-call"><a class="anchor" href="#ray-tracing-shader-call"></a>36.1. Shader Call Instructions</h3>
<div class="paragraph">
<p>A <em>shader call</em> is an instruction which <strong class="purple">may</strong> cause execution to continue
elsewhere by creating one or more invocations that execute a different
shader stage.</p>
</div>
<div class="paragraph">
<p>The shader call instructions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OpTraceRayKHR</code> which <strong class="purple">may</strong> invoke intersection, any-hit, closest hit,
or miss shaders,</p>
</li>
<li>
<p><code>OpReportIntersectionKHR</code> which <strong class="purple">may</strong> invoke any-hit shaders, and</p>
</li>
<li>
<p><code>OpExecuteCallableKHR</code> which will invoke a callable shader.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The invocations created by shader call instructions are grouped into
subgroups by the implementation.
Those subgroups <strong class="purple">may</strong> be unrelated to the subgroup of the parent invocation.</p>
</div>
<div id="ray-tracing-recursion-depth" class="paragraph">
<p>Shader call instructions <strong class="purple">can</strong> be used recursively; invoked shaders <strong class="purple">can</strong>
themselves execute shader call instructions, to a maximum depth defined by
the <a href="chap39.html#limits-maxRecursionDepth"><code>maxRecursionDepth</code></a> limit.</p>
</div>
<div class="paragraph">
<p>Shaders directly invoked from the API always have a recursion depth of 0;
each shader executed by a shader call instruction has a recursion depth one
higher than the recursion depth of the shader which invoked it.
Applications <strong class="purple">must</strong> not invoke a shader with a recursion depth greater than
the value of <code>maxRecursionDepth</code> specified in the pipeline.</p>
</div>
<div id="ray-tracing-repack" class="paragraph">
<p>An <em>invocation repack instruction</em> is a ray tracing shader call instruction
where the implementation <strong class="purple">may</strong> change the set of invocations that are
executing.
When a repack instruction is encountered, the invocation is suspended and a
new invocation begins and executes the instruction.
After executing the repack instruction (which <strong class="purple">may</strong> result in other ray
tracing shader stages executing) the new invocation ends and the original
invocation is resumed, but it <strong class="purple">may</strong> be resumed in a different subgroup or at
a different <code>SubgroupLocalInvocationId</code> within the same subgroup.
When a subset of invocations in a subgroup execute the invocation repack
instruction, those that do not execute it remain in the same subgroup at the
same <code>SubgroupLocalInvocationId</code>.</p>
</div>
<div class="paragraph">
<p>The <code>OpTraceRayKHR</code>, <code>OpReportIntersectionKHR</code>, and
<code>OpExecuteCallableKHR</code> instructions are invocation repack instructions.</p>
</div>
<div class="paragraph">
<p>The invocations that are executing before an invocation repack instruction,
after the instruction, or are created by the instruction, are
<a href="chap44.html#shader-call-related">shader-call-related</a>.</p>
</div>
<div class="paragraph">
<p>If the implementation changes the composition of subgroups, the values of
<code>SubgroupLocalInvocationId</code>,
<code>SMIDNV</code>, <code>WarpIDNV</code>,
and builtin variables that are derived from them (<code>SubgroupEqMask</code>,
<code>SubgroupGeMask</code>, <code>SubgroupGtMask</code>, <code>SubgroupLeMask</code>,
<code>SubgroupLtMask</code>) <strong class="purple">must</strong> be changed accordingly by the invocation repack
instruction.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><a href="#shaders-subgroup">Subgroup operations</a> are permitted in the programmable
ray tracing shader stages.
However, shader call instructions place a bound on where results of subgroup
instructions or subgroup-scoped instructions that execute the dynamic
instance of that instruction are potentially valid.
For example, care <strong class="purple">must</strong> be taken when using the result of a ballot operation
that was computed before an invocation repack instruction, after that repack
instruction.
The ballot <strong class="purple">may</strong> be incorrect as the set of invocations could have changed.</p>
</div>
<div class="paragraph">
<p>For clock operations, the value of a <code>Subgroup</code> scoped
<code>OpReadClockKHR</code> read before the dynamic instance of a repack instruction
<strong class="purple">should</strong> not be compared to the result of that clock instruction after the
repack instruction.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a ray tracing shader executes a dynamic instance of an invocation
repack instruction which results in another ray tracing shader being
invoked, their instructions are related by
<a href="chap44.html#shader-call-order">shader-call-order</a>.</p>
</div>
<div class="paragraph">
<p>For ray tracing invocations that are
<a href="chap44.html#shader-call-related">shader-call-related</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="chap44.html#memory-model-memory-operation">memory operations</a> on
    <code>StorageBuffer</code>, <code>Image</code>, and <code>ShaderRecordBufferKHR</code> storage
    classes <strong class="purple">can</strong> be synchronized using the
<code>ShaderCallKHR</code>
    scope.</p>
</li>
<li>
<p>the <code>CallableDataKHR</code>, <code>IncomingCallableDataKHR</code>,
<code>RayPayloadKHR</code>, <code>HitAttributeKHR</code>, and <code>IncomingRayPayloadKHR</code>
storage classes are <a href="chap44.html#memory-model-shader-io">system-synchronized</a> and
no application availability and visibility operations are required.</p>
</li>
<li>
<p>memory operations within a single invocation before and after the
invocation repack instruction are ordered by
<a href="chap44.html#memory-model-program-order">program-order</a> and do not require explicit
synchronzation.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="ray-tracing-commands"><a class="anchor" href="#ray-tracing-commands"></a>36.2. Ray Tracing Commands</h3>
<div class="paragraph">
<p><em>Ray tracing commands</em> provoke work in the ray tracing pipeline.
Ray tracing commands are recorded into a command buffer and when executed by
a queue will produce work that executes according to the currently bound ray
tracing pipeline.
A ray tracing pipeline <strong class="purple">must</strong> be bound to a command buffer before any ray
tracing commands are recorded in that command buffer.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To dispatch ray tracing use:</p>
</div>
<div id="vkCmdTraceRaysNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdTraceRaysNV(
    VkCommandBuffer                             commandBuffer,
    VkBuffer                                    raygenShaderBindingTableBuffer,
    VkDeviceSize                                raygenShaderBindingOffset,
    VkBuffer                                    missShaderBindingTableBuffer,
    VkDeviceSize                                missShaderBindingOffset,
    VkDeviceSize                                missShaderBindingStride,
    VkBuffer                                    hitShaderBindingTableBuffer,
    VkDeviceSize                                hitShaderBindingOffset,
    VkDeviceSize                                hitShaderBindingStride,
    VkBuffer                                    callableShaderBindingTableBuffer,
    VkDeviceSize                                callableShaderBindingOffset,
    VkDeviceSize                                callableShaderBindingStride,
    uint32_t                                    width,
    uint32_t                                    height,
    uint32_t                                    depth);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>raygenShaderBindingTableBuffer</code> is the buffer object that holds the
shader binding table data for the ray generation shader stage.</p>
</li>
<li>
<p><code>raygenShaderBindingOffset</code> is the offset in bytes (relative to
<code>raygenShaderBindingTableBuffer</code>) of the ray generation shader being
used for the trace.</p>
</li>
<li>
<p><code>missShaderBindingTableBuffer</code> is the buffer object that holds the
shader binding table data for the miss shader stage.</p>
</li>
<li>
<p><code>missShaderBindingOffset</code> is the offset in bytes (relative to
<code>missShaderBindingTableBuffer</code>) of the miss shader being used for
the trace.</p>
</li>
<li>
<p><code>missShaderBindingStride</code> is the size in bytes of each shader
binding table record in <code>missShaderBindingTableBuffer</code>.</p>
</li>
<li>
<p><code>hitShaderBindingTableBuffer</code> is the buffer object that holds the
shader binding table data for the hit shader stages.</p>
</li>
<li>
<p><code>hitShaderBindingOffset</code> is the offset in bytes (relative to
<code>hitShaderBindingTableBuffer</code>) of the hit shader group being used
for the trace.</p>
</li>
<li>
<p><code>hitShaderBindingStride</code> is the size in bytes of each shader binding
table record in <code>hitShaderBindingTableBuffer</code>.</p>
</li>
<li>
<p><code>callableShaderBindingTableBuffer</code> is the buffer object that holds
the shader binding table data for the callable shader stage.</p>
</li>
<li>
<p><code>callableShaderBindingOffset</code> is the offset in bytes (relative to
<code>callableShaderBindingTableBuffer</code>) of the callable shader being
used for the trace.</p>
</li>
<li>
<p><code>callableShaderBindingStride</code> is the size in bytes of each shader
binding table record in <code>callableShaderBindingTableBuffer</code>.</p>
</li>
<li>
<p><code>width</code> is the width of the ray trace query dimensions.</p>
</li>
<li>
<p><code>height</code> is height of the ray trace query dimensions.</p>
</li>
<li>
<p><code>depth</code> is depth of the ray trace query dimensions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the command is executed, a ray generation group of <span class="eq"><code>width</code>
× <code>height</code> × <code>depth</code></span> rays is assembled.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02690" href="#VUID-vkCmdTraceRaysNV-None-02690"></a>
If a <code>VkImageView</code> is sampled with <code>VK_FILTER_LINEAR</code> as a
result of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_LINEAR_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02691" href="#VUID-vkCmdTraceRaysNV-None-02691"></a>
If a <code>VkImageView</code> is accessed using atomic operations as a result
of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_STORAGE_IMAGE_ATOMIC_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02692" href="#VUID-vkCmdTraceRaysNV-None-02692"></a>
If a <code>VkImageView</code> is sampled with <code>VK_FILTER_CUBIC_EXT</code> as a
result of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_CUBIC_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-filterCubic-02694" href="#VUID-vkCmdTraceRaysNV-filterCubic-02694"></a>
Any <a href="chap11.html#VkImageView">VkImageView</a> being sampled with <code>VK_FILTER_CUBIC_EXT</code> as a
result of this command <strong class="purple">must</strong> have a <a href="chap11.html#VkImageViewType">VkImageViewType</a> and format
that supports cubic filtering, as specified by
<code>VkFilterCubicImageViewImageFormatPropertiesEXT</code>::<code>filterCubic</code>
returned by <code>vkGetPhysicalDeviceImageFormatProperties2</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-filterCubicMinmax-02695" href="#VUID-vkCmdTraceRaysNV-filterCubicMinmax-02695"></a>
Any <a href="chap11.html#VkImageView">VkImageView</a> being sampled with <code>VK_FILTER_CUBIC_EXT</code> with
a reduction mode of either <code>VK_SAMPLER_REDUCTION_MODE_MIN</code> or
<code>VK_SAMPLER_REDUCTION_MODE_MAX</code> as a result of this command <strong class="purple">must</strong>
have a <a href="chap11.html#VkImageViewType">VkImageViewType</a> and format that supports cubic filtering
together with minmax filtering, as specified by
<code>VkFilterCubicImageViewImageFormatPropertiesEXT</code>::<code>filterCubicMinmax</code>
returned by <code>vkGetPhysicalDeviceImageFormatProperties2</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-flags-02696" href="#VUID-vkCmdTraceRaysNV-flags-02696"></a>
Any <a href="chap11.html#VkImage">VkImage</a> created with a <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code>
containing <code>VK_IMAGE_CREATE_CORNER_SAMPLED_BIT_NV</code> sampled as a
result of this command <strong class="purple">must</strong> only be sampled using a
<a href="chap12.html#VkSamplerAddressMode">VkSamplerAddressMode</a> of
<code>VK_SAMPLER_ADDRESS_MODE_CLAMP_TO_EDGE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02697" href="#VUID-vkCmdTraceRaysNV-None-02697"></a>
For each set <em>n</em> that is statically used by the <code>VkPipeline</code> bound
to the pipeline bind point used by this command, a descriptor set <strong class="purple">must</strong>
have been bound to <em>n</em> at the same pipeline bind point, with a
<code>VkPipelineLayout</code> that is compatible for set <em>n</em>, with the
<code>VkPipelineLayout</code> used to create the current <code>VkPipeline</code>, as
described in <a href="chap13.html#descriptorsets-compatibility">Pipeline Layout Compatibility</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02698" href="#VUID-vkCmdTraceRaysNV-None-02698"></a>
For each push constant that is statically used by the <code>VkPipeline</code>
bound to the pipeline bind point used by this command, a push constant
value <strong class="purple">must</strong> have been set for the same pipeline bind point, with a
<code>VkPipelineLayout</code> that is compatible for push constants, with the
<code>VkPipelineLayout</code> used to create the current <code>VkPipeline</code>, as
described in <a href="chap13.html#descriptorsets-compatibility">Pipeline Layout Compatibility</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02699" href="#VUID-vkCmdTraceRaysNV-None-02699"></a>
Descriptors in each bound descriptor set, specified via
<code>vkCmdBindDescriptorSets</code>, <strong class="purple">must</strong> be valid if they are statically
used by the <code>VkPipeline</code> bound to the pipeline bind point used by
this command</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02700" href="#VUID-vkCmdTraceRaysNV-None-02700"></a>
A valid pipeline <strong class="purple">must</strong> be bound to the pipeline bind point used by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-02701" href="#VUID-vkCmdTraceRaysNV-commandBuffer-02701"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command requires any dynamic state, that state <strong class="purple">must</strong> have been set
for <code>commandBuffer</code>, and done so after any previously bound pipeline
with the corresponding state not specified as dynamic</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02859" href="#VUID-vkCmdTraceRaysNV-None-02859"></a>
There <strong class="purple">must</strong> not have been any calls to dynamic state setting commands
for any state not specified as dynamic in the <code>VkPipeline</code> object
bound to the pipeline bind point used by this command, since that
pipeline was bound</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02702" href="#VUID-vkCmdTraceRaysNV-None-02702"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used to sample from any
<code>VkImage</code> with a <code>VkImageView</code> of the type
<code>VK_IMAGE_VIEW_TYPE_3D</code>, <code>VK_IMAGE_VIEW_TYPE_CUBE</code>,
<code>VK_IMAGE_VIEW_TYPE_1D_ARRAY</code>, <code>VK_IMAGE_VIEW_TYPE_2D_ARRAY</code> or
<code>VK_IMAGE_VIEW_TYPE_CUBE_ARRAY</code>, in any shader stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02703" href="#VUID-vkCmdTraceRaysNV-None-02703"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used with any of the SPIR-V
<code>OpImageSample*</code> or <code>OpImageSparseSample*</code> instructions with
<code>ImplicitLod</code>, <code>Dref</code> or <code>Proj</code> in their name, in any shader
stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02704" href="#VUID-vkCmdTraceRaysNV-None-02704"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used with any of the SPIR-V
<code>OpImageSample*</code> or <code>OpImageSparseSample*</code> instructions that includes a
LOD bias or any offset values, in any shader stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02705" href="#VUID-vkCmdTraceRaysNV-None-02705"></a>
If the <a href="chap38.html#features-robustBufferAccess">robust buffer access</a> feature is
not enabled, and if the <code>VkPipeline</code> object bound to the pipeline
bind point used by this command accesses a uniform buffer, it <strong class="purple">must</strong> not
access values outside of the range of the buffer as specified in the
descriptor set bound to the same pipeline bind point</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-02706" href="#VUID-vkCmdTraceRaysNV-None-02706"></a>
If the <a href="chap38.html#features-robustBufferAccess">robust buffer access</a> feature is
not enabled, and if the <code>VkPipeline</code> object bound to the pipeline
bind point used by this command accesses a storage buffer, it <strong class="purple">must</strong> not
access values outside of the range of the buffer as specified in the
descriptor set bound to the same pipeline bind point</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-02707" href="#VUID-vkCmdTraceRaysNV-commandBuffer-02707"></a>
If <code>commandBuffer</code> is an unprotected command buffer, any resource
accessed by the <code>VkPipeline</code> object bound to the pipeline bind point
used by this command <strong class="purple">must</strong> not be a protected resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-None-03429" href="#VUID-vkCmdTraceRaysNV-None-03429"></a>
Any shader group handle referenced by this call <strong class="purple">must</strong> have been queried
from the currently bound ray tracing shader pipeline</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-maxRecursionDepth-03430" href="#VUID-vkCmdTraceRaysNV-maxRecursionDepth-03430"></a>
This command <strong class="purple">must</strong> not cause a shader call instruction to be executed
from a shader invocation with a <a href="#ray-tracing-recursion-depth">recursion
depth</a> greater than the value of <code>maxRecursionDepth</code> used to create
the bound ray tracing pipeline</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-02712" href="#VUID-vkCmdTraceRaysNV-commandBuffer-02712"></a>
If <code>commandBuffer</code> is a protected command buffer, any resource
written to by the <code>VkPipeline</code> object bound to the pipeline bind
point used by this command <strong class="purple">must</strong> not be an unprotected resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-02713" href="#VUID-vkCmdTraceRaysNV-commandBuffer-02713"></a>
If <code>commandBuffer</code> is a protected command buffer, pipeline stages
other than the framebuffer-space and compute stages in the
<code>VkPipeline</code> object bound to the pipeline bind point <strong class="purple">must</strong> not write
to any resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-raygenShaderBindingTableBuffer-04042" href="#VUID-vkCmdTraceRaysNV-raygenShaderBindingTableBuffer-04042"></a>
If <code>raygenShaderBindingTableBuffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-raygenShaderBindingOffset-02455" href="#VUID-vkCmdTraceRaysNV-raygenShaderBindingOffset-02455"></a>
<code>raygenShaderBindingOffset</code> <strong class="purple">must</strong> be less than the size of
<code>raygenShaderBindingTableBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-raygenShaderBindingOffset-02456" href="#VUID-vkCmdTraceRaysNV-raygenShaderBindingOffset-02456"></a>
<code>raygenShaderBindingOffset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-missShaderBindingTableBuffer-04043" href="#VUID-vkCmdTraceRaysNV-missShaderBindingTableBuffer-04043"></a>
If <code>missShaderBindingTableBuffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-missShaderBindingOffset-02457" href="#VUID-vkCmdTraceRaysNV-missShaderBindingOffset-02457"></a>
<code>missShaderBindingOffset</code> <strong class="purple">must</strong> be less than the size of
<code>missShaderBindingTableBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-missShaderBindingOffset-02458" href="#VUID-vkCmdTraceRaysNV-missShaderBindingOffset-02458"></a>
<code>missShaderBindingOffset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-hitShaderBindingTableBuffer-04044" href="#VUID-vkCmdTraceRaysNV-hitShaderBindingTableBuffer-04044"></a>
If <code>hitShaderBindingTableBuffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-hitShaderBindingOffset-02459" href="#VUID-vkCmdTraceRaysNV-hitShaderBindingOffset-02459"></a>
<code>hitShaderBindingOffset</code> <strong class="purple">must</strong> be less than the size of
<code>hitShaderBindingTableBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-hitShaderBindingOffset-02460" href="#VUID-vkCmdTraceRaysNV-hitShaderBindingOffset-02460"></a>
<code>hitShaderBindingOffset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-callableShaderBindingTableBuffer-04045" href="#VUID-vkCmdTraceRaysNV-callableShaderBindingTableBuffer-04045"></a>
If <code>callableShaderBindingTableBuffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-callableShaderBindingOffset-02461" href="#VUID-vkCmdTraceRaysNV-callableShaderBindingOffset-02461"></a>
<code>callableShaderBindingOffset</code> <strong class="purple">must</strong> be less than the size of
<code>callableShaderBindingTableBuffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-callableShaderBindingOffset-02462" href="#VUID-vkCmdTraceRaysNV-callableShaderBindingOffset-02462"></a>
<code>callableShaderBindingOffset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-missShaderBindingStride-02463" href="#VUID-vkCmdTraceRaysNV-missShaderBindingStride-02463"></a>
<code>missShaderBindingStride</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-hitShaderBindingStride-02464" href="#VUID-vkCmdTraceRaysNV-hitShaderBindingStride-02464"></a>
<code>hitShaderBindingStride</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-callableShaderBindingStride-02465" href="#VUID-vkCmdTraceRaysNV-callableShaderBindingStride-02465"></a>
<code>callableShaderBindingStride</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-missShaderBindingStride-02466" href="#VUID-vkCmdTraceRaysNV-missShaderBindingStride-02466"></a>
<code>missShaderBindingStride</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-hitShaderBindingStride-02467" href="#VUID-vkCmdTraceRaysNV-hitShaderBindingStride-02467"></a>
<code>hitShaderBindingStride</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-callableShaderBindingStride-02468" href="#VUID-vkCmdTraceRaysNV-callableShaderBindingStride-02468"></a>
<code>callableShaderBindingStride</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesNV</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-width-02469" href="#VUID-vkCmdTraceRaysNV-width-02469"></a>
<code>width</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[0]</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-height-02470" href="#VUID-vkCmdTraceRaysNV-height-02470"></a>
<code>height</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[1]</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-depth-02471" href="#VUID-vkCmdTraceRaysNV-depth-02471"></a>
<code>depth</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[2]</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-parameter" href="#VUID-vkCmdTraceRaysNV-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-raygenShaderBindingTableBuffer-parameter" href="#VUID-vkCmdTraceRaysNV-raygenShaderBindingTableBuffer-parameter"></a> <code>raygenShaderBindingTableBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-missShaderBindingTableBuffer-parameter" href="#VUID-vkCmdTraceRaysNV-missShaderBindingTableBuffer-parameter"></a> If <code>missShaderBindingTableBuffer</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>missShaderBindingTableBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-hitShaderBindingTableBuffer-parameter" href="#VUID-vkCmdTraceRaysNV-hitShaderBindingTableBuffer-parameter"></a> If <code>hitShaderBindingTableBuffer</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>hitShaderBindingTableBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-callableShaderBindingTableBuffer-parameter" href="#VUID-vkCmdTraceRaysNV-callableShaderBindingTableBuffer-parameter"></a> If <code>callableShaderBindingTableBuffer</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>callableShaderBindingTableBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-recording" href="#VUID-vkCmdTraceRaysNV-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commandBuffer-cmdpool" href="#VUID-vkCmdTraceRaysNV-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-renderpass" href="#VUID-vkCmdTraceRaysNV-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysNV-commonparent" href="#VUID-vkCmdTraceRaysNV-commonparent"></a> Each of <code>callableShaderBindingTableBuffer</code>, <code>commandBuffer</code>, <code>hitShaderBindingTableBuffer</code>, <code>missShaderBindingTableBuffer</code>, and <code>raygenShaderBindingTableBuffer</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To dispatch ray tracing use:</p>
</div>
<div id="vkCmdTraceRaysKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdTraceRaysKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pRaygenShaderBindingTable,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pMissShaderBindingTable,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pHitShaderBindingTable,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pCallableShaderBindingTable,
    uint32_t                                    width,
    uint32_t                                    height,
    uint32_t                                    depth);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pRaygenShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> that
holds the shader binding table data for the ray generation shader stage.</p>
</li>
<li>
<p><code>pMissShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> that
holds the shader binding table data for the miss shader stage.</p>
</li>
<li>
<p><code>pHitShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> that
holds the shader binding table data for the hit shader stage.</p>
</li>
<li>
<p><code>pCallableShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a>
that holds the shader binding table data for the callable shader stage.</p>
</li>
<li>
<p><code>width</code> is the width of the ray trace query dimensions.</p>
</li>
<li>
<p><code>height</code> is height of the ray trace query dimensions.</p>
</li>
<li>
<p><code>depth</code> is depth of the ray trace query dimensions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the command is executed, a ray generation group of <span class="eq"><code>width</code>
× <code>height</code> × <code>depth</code></span> rays is assembled.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02690" href="#VUID-vkCmdTraceRaysKHR-None-02690"></a>
If a <code>VkImageView</code> is sampled with <code>VK_FILTER_LINEAR</code> as a
result of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_LINEAR_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02691" href="#VUID-vkCmdTraceRaysKHR-None-02691"></a>
If a <code>VkImageView</code> is accessed using atomic operations as a result
of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_STORAGE_IMAGE_ATOMIC_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02692" href="#VUID-vkCmdTraceRaysKHR-None-02692"></a>
If a <code>VkImageView</code> is sampled with <code>VK_FILTER_CUBIC_EXT</code> as a
result of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_CUBIC_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-filterCubic-02694" href="#VUID-vkCmdTraceRaysKHR-filterCubic-02694"></a>
Any <a href="chap11.html#VkImageView">VkImageView</a> being sampled with <code>VK_FILTER_CUBIC_EXT</code> as a
result of this command <strong class="purple">must</strong> have a <a href="chap11.html#VkImageViewType">VkImageViewType</a> and format
that supports cubic filtering, as specified by
<code>VkFilterCubicImageViewImageFormatPropertiesEXT</code>::<code>filterCubic</code>
returned by <code>vkGetPhysicalDeviceImageFormatProperties2</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-filterCubicMinmax-02695" href="#VUID-vkCmdTraceRaysKHR-filterCubicMinmax-02695"></a>
Any <a href="chap11.html#VkImageView">VkImageView</a> being sampled with <code>VK_FILTER_CUBIC_EXT</code> with
a reduction mode of either <code>VK_SAMPLER_REDUCTION_MODE_MIN</code> or
<code>VK_SAMPLER_REDUCTION_MODE_MAX</code> as a result of this command <strong class="purple">must</strong>
have a <a href="chap11.html#VkImageViewType">VkImageViewType</a> and format that supports cubic filtering
together with minmax filtering, as specified by
<code>VkFilterCubicImageViewImageFormatPropertiesEXT</code>::<code>filterCubicMinmax</code>
returned by <code>vkGetPhysicalDeviceImageFormatProperties2</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-02696" href="#VUID-vkCmdTraceRaysKHR-flags-02696"></a>
Any <a href="chap11.html#VkImage">VkImage</a> created with a <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code>
containing <code>VK_IMAGE_CREATE_CORNER_SAMPLED_BIT_NV</code> sampled as a
result of this command <strong class="purple">must</strong> only be sampled using a
<a href="chap12.html#VkSamplerAddressMode">VkSamplerAddressMode</a> of
<code>VK_SAMPLER_ADDRESS_MODE_CLAMP_TO_EDGE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02697" href="#VUID-vkCmdTraceRaysKHR-None-02697"></a>
For each set <em>n</em> that is statically used by the <code>VkPipeline</code> bound
to the pipeline bind point used by this command, a descriptor set <strong class="purple">must</strong>
have been bound to <em>n</em> at the same pipeline bind point, with a
<code>VkPipelineLayout</code> that is compatible for set <em>n</em>, with the
<code>VkPipelineLayout</code> used to create the current <code>VkPipeline</code>, as
described in <a href="chap13.html#descriptorsets-compatibility">Pipeline Layout Compatibility</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02698" href="#VUID-vkCmdTraceRaysKHR-None-02698"></a>
For each push constant that is statically used by the <code>VkPipeline</code>
bound to the pipeline bind point used by this command, a push constant
value <strong class="purple">must</strong> have been set for the same pipeline bind point, with a
<code>VkPipelineLayout</code> that is compatible for push constants, with the
<code>VkPipelineLayout</code> used to create the current <code>VkPipeline</code>, as
described in <a href="chap13.html#descriptorsets-compatibility">Pipeline Layout Compatibility</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02699" href="#VUID-vkCmdTraceRaysKHR-None-02699"></a>
Descriptors in each bound descriptor set, specified via
<code>vkCmdBindDescriptorSets</code>, <strong class="purple">must</strong> be valid if they are statically
used by the <code>VkPipeline</code> bound to the pipeline bind point used by
this command</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02700" href="#VUID-vkCmdTraceRaysKHR-None-02700"></a>
A valid pipeline <strong class="purple">must</strong> be bound to the pipeline bind point used by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-02701" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-02701"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command requires any dynamic state, that state <strong class="purple">must</strong> have been set
for <code>commandBuffer</code>, and done so after any previously bound pipeline
with the corresponding state not specified as dynamic</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02859" href="#VUID-vkCmdTraceRaysKHR-None-02859"></a>
There <strong class="purple">must</strong> not have been any calls to dynamic state setting commands
for any state not specified as dynamic in the <code>VkPipeline</code> object
bound to the pipeline bind point used by this command, since that
pipeline was bound</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02702" href="#VUID-vkCmdTraceRaysKHR-None-02702"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used to sample from any
<code>VkImage</code> with a <code>VkImageView</code> of the type
<code>VK_IMAGE_VIEW_TYPE_3D</code>, <code>VK_IMAGE_VIEW_TYPE_CUBE</code>,
<code>VK_IMAGE_VIEW_TYPE_1D_ARRAY</code>, <code>VK_IMAGE_VIEW_TYPE_2D_ARRAY</code> or
<code>VK_IMAGE_VIEW_TYPE_CUBE_ARRAY</code>, in any shader stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02703" href="#VUID-vkCmdTraceRaysKHR-None-02703"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used with any of the SPIR-V
<code>OpImageSample*</code> or <code>OpImageSparseSample*</code> instructions with
<code>ImplicitLod</code>, <code>Dref</code> or <code>Proj</code> in their name, in any shader
stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02704" href="#VUID-vkCmdTraceRaysKHR-None-02704"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used with any of the SPIR-V
<code>OpImageSample*</code> or <code>OpImageSparseSample*</code> instructions that includes a
LOD bias or any offset values, in any shader stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02705" href="#VUID-vkCmdTraceRaysKHR-None-02705"></a>
If the <a href="chap38.html#features-robustBufferAccess">robust buffer access</a> feature is
not enabled, and if the <code>VkPipeline</code> object bound to the pipeline
bind point used by this command accesses a uniform buffer, it <strong class="purple">must</strong> not
access values outside of the range of the buffer as specified in the
descriptor set bound to the same pipeline bind point</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-02706" href="#VUID-vkCmdTraceRaysKHR-None-02706"></a>
If the <a href="chap38.html#features-robustBufferAccess">robust buffer access</a> feature is
not enabled, and if the <code>VkPipeline</code> object bound to the pipeline
bind point used by this command accesses a storage buffer, it <strong class="purple">must</strong> not
access values outside of the range of the buffer as specified in the
descriptor set bound to the same pipeline bind point</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-02707" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-02707"></a>
If <code>commandBuffer</code> is an unprotected command buffer, any resource
accessed by the <code>VkPipeline</code> object bound to the pipeline bind point
used by this command <strong class="purple">must</strong> not be a protected resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-None-03429" href="#VUID-vkCmdTraceRaysKHR-None-03429"></a>
Any shader group handle referenced by this call <strong class="purple">must</strong> have been queried
from the currently bound ray tracing shader pipeline</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-maxRecursionDepth-03430" href="#VUID-vkCmdTraceRaysKHR-maxRecursionDepth-03430"></a>
This command <strong class="purple">must</strong> not cause a shader call instruction to be executed
from a shader invocation with a <a href="#ray-tracing-recursion-depth">recursion
depth</a> greater than the value of <code>maxRecursionDepth</code> used to create
the bound ray tracing pipeline</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pRayGenShaderBindingTable-04019" href="#VUID-vkCmdTraceRaysKHR-pRayGenShaderBindingTable-04019"></a>
If <code>pRayGenShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong>
be bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04020" href="#VUID-vkCmdTraceRaysKHR-offset-04020"></a>
The <code>offset</code> member of <code>pRayGenShaderBindingTable</code> <strong class="purple">must</strong> be less
than the size of the <code>pRayGenShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pRayGenShaderBindingTable-04021" href="#VUID-vkCmdTraceRaysKHR-pRayGenShaderBindingTable-04021"></a>
<code>pRayGenShaderBindingTable-&gt;offset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pRayGenShaderBindingTable-04022" href="#VUID-vkCmdTraceRaysKHR-pRayGenShaderBindingTable-04022"></a>
<span class="eq"><code>pRayGenShaderBindingTable-&gt;offset</code> + 
<code>pRayGenShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to
the size of <code>pRayGenShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-size-04023" href="#VUID-vkCmdTraceRaysKHR-size-04023"></a>
The <code>size</code> member of <code>pRayGenShaderBindingTable</code> <strong class="purple">must</strong> be equal
to its <code>stride</code> member</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pMissShaderBindingTable-04024" href="#VUID-vkCmdTraceRaysKHR-pMissShaderBindingTable-04024"></a>
If <code>pMissShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04025" href="#VUID-vkCmdTraceRaysKHR-offset-04025"></a>
The <code>offset</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be less
than the size of <code>pMissShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04026" href="#VUID-vkCmdTraceRaysKHR-offset-04026"></a>
The <code>offset</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pMissShaderBindingTable-04027" href="#VUID-vkCmdTraceRaysKHR-pMissShaderBindingTable-04027"></a>
<span class="eq"><code>pMissShaderBindingTable-&gt;offset</code> + 
<code>pMissShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to the
size of <code>pMissShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-stride-04028" href="#VUID-vkCmdTraceRaysKHR-stride-04028"></a>
The <code>stride</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-stride-04029" href="#VUID-vkCmdTraceRaysKHR-stride-04029"></a>
The <code>stride</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be less
than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pHitShaderBindingTable-04030" href="#VUID-vkCmdTraceRaysKHR-pHitShaderBindingTable-04030"></a>
If <code>pHitShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04031" href="#VUID-vkCmdTraceRaysKHR-offset-04031"></a>
The <code>offset</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be less
than the size of <code>pHitShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04032" href="#VUID-vkCmdTraceRaysKHR-offset-04032"></a>
The <code>offset</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pHitShaderBindingTable-04033" href="#VUID-vkCmdTraceRaysKHR-pHitShaderBindingTable-04033"></a>
<span class="eq"><code>pHitShaderBindingTable-&gt;offset</code> + 
<code>pHitShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to the
size of <code>pHitShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-stride-04034" href="#VUID-vkCmdTraceRaysKHR-stride-04034"></a>
The <code>stride</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-stride-04035" href="#VUID-vkCmdTraceRaysKHR-stride-04035"></a>
The <code>stride</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be less
than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pCallableShaderBindingTable-04036" href="#VUID-vkCmdTraceRaysKHR-pCallableShaderBindingTable-04036"></a>
If <code>pCallableShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong>
be bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04037" href="#VUID-vkCmdTraceRaysKHR-offset-04037"></a>
The <code>offset</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be
less than the size of <code>pCallableShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-offset-04038" href="#VUID-vkCmdTraceRaysKHR-offset-04038"></a>
The <code>offset</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pCallableShaderBindingTable-04039" href="#VUID-vkCmdTraceRaysKHR-pCallableShaderBindingTable-04039"></a>
<span class="eq"><code>pCallableShaderBindingTable-&gt;offset</code> + 
<code>pCallableShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to
the size of <code>pCallableShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-stride-04040" href="#VUID-vkCmdTraceRaysKHR-stride-04040"></a>
The <code>stride</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-stride-04041" href="#VUID-vkCmdTraceRaysKHR-stride-04041"></a>
The <code>stride</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be
less than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03508" href="#VUID-vkCmdTraceRaysKHR-flags-03508"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_ANY_HIT_SHADERS_BIT_KHR</code>,
the <code>buffer</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03509" href="#VUID-vkCmdTraceRaysKHR-flags-03509"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_CLOSEST_HIT_SHADERS_BIT_KHR</code>,
the <code>buffer</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03510" href="#VUID-vkCmdTraceRaysKHR-flags-03510"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_INTERSECTION_SHADERS_BIT_KHR</code>,
the <code>buffer</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03511" href="#VUID-vkCmdTraceRaysKHR-flags-03511"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_MISS_SHADERS_BIT_KHR</code>, the
shader group handle identified by <code>pMissShaderBindingTable</code> <strong class="purple">must</strong>
contain a valid miss shader</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03512" href="#VUID-vkCmdTraceRaysKHR-flags-03512"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_ANY_HIT_SHADERS_BIT_KHR</code>,
entries in <code>pHitShaderBindingTable</code> accessed as a result of this
command in order to execute an any hit shader <strong class="purple">must</strong> not be set to zero</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03513" href="#VUID-vkCmdTraceRaysKHR-flags-03513"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_CLOSEST_HIT_SHADERS_BIT_KHR</code>,
entries in <code>pHitShaderBindingTable</code> accessed as a result of this
command in order to execute a closest hit shader <strong class="purple">must</strong> not be set to
zero</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-flags-03514" href="#VUID-vkCmdTraceRaysKHR-flags-03514"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_INTERSECTION_SHADERS_BIT_KHR</code>,
entries in <code>pHitShaderBindingTable</code> accessed as a result of this
command in order to execute an intersection shader <strong class="purple">must</strong> not be set to
zero</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-02712" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-02712"></a>
If <code>commandBuffer</code> is a protected command buffer, any resource
written to by the <code>VkPipeline</code> object bound to the pipeline bind
point used by this command <strong class="purple">must</strong> not be an unprotected resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-02713" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-02713"></a>
If <code>commandBuffer</code> is a protected command buffer, pipeline stages
other than the framebuffer-space and compute stages in the
<code>VkPipeline</code> object bound to the pipeline bind point <strong class="purple">must</strong> not write
to any resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-width-03505" href="#VUID-vkCmdTraceRaysKHR-width-03505"></a>
<code>width</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[0]</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-height-03506" href="#VUID-vkCmdTraceRaysKHR-height-03506"></a>
<code>height</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[1]</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-depth-03507" href="#VUID-vkCmdTraceRaysKHR-depth-03507"></a>
<code>depth</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[2]</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-parameter" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pRaygenShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysKHR-pRaygenShaderBindingTable-parameter"></a> <code>pRaygenShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pMissShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysKHR-pMissShaderBindingTable-parameter"></a> <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pHitShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysKHR-pHitShaderBindingTable-parameter"></a> <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-pCallableShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysKHR-pCallableShaderBindingTable-parameter"></a> <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-recording" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-commandBuffer-cmdpool" href="#VUID-vkCmdTraceRaysKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysKHR-renderpass" href="#VUID-vkCmdTraceRaysKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkStridedBufferRegionKHR</code> structure is defined as:</p>
</div>
<div id="VkStridedBufferRegionKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkStridedBufferRegionKHR {
    VkBuffer        buffer;
    VkDeviceSize    offset;
    VkDeviceSize    stride;
    VkDeviceSize    size;
} VkStridedBufferRegionKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>buffer</code> is the buffer containing this region.</p>
</li>
<li>
<p><code>offset</code> is the byte offset in <code>buffer</code> at which the region
starts.</p>
</li>
<li>
<p><code>stride</code> is the byte stride between consecutive elements.</p>
</li>
<li>
<p><code>size</code> is the size in bytes of the region starting at <code>offset</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkStridedBufferRegionKHR-buffer-03515" href="#VUID-VkStridedBufferRegionKHR-buffer-03515"></a>
If <code>buffer</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>size</code> plus
<code>offset</code> <strong class="purple">must</strong> be less than or equal to the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkStridedBufferRegionKHR-buffer-03516" href="#VUID-VkStridedBufferRegionKHR-buffer-03516"></a>
If <code>buffer</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>stride</code> <strong class="purple">must</strong> be less
than the size of <code>buffer</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkStridedBufferRegionKHR-buffer-parameter" href="#VUID-VkStridedBufferRegionKHR-buffer-parameter"></a> If <code>buffer</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>buffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To dispatch ray tracing, with some parameters sourced on the device, use:</p>
</div>
<div id="vkCmdTraceRaysIndirectKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdTraceRaysIndirectKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pRaygenShaderBindingTable,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pMissShaderBindingTable,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pHitShaderBindingTable,
    <span class="directive">const</span> VkStridedBufferRegionKHR*             pCallableShaderBindingTable,
    VkBuffer                                    buffer,
    VkDeviceSize                                offset);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pRaygenShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> that
holds the shader binding table data for the ray generation shader stage.</p>
</li>
<li>
<p><code>pMissShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> that
holds the shader binding table data for the miss shader stage.</p>
</li>
<li>
<p><code>pHitShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> that
holds the shader binding table data for the hit shader stage.</p>
</li>
<li>
<p><code>pCallableShaderBindingTable</code> is a <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a>
that holds the shader binding table data for the callable shader stage.</p>
</li>
<li>
<p><code>buffer</code> is the buffer containing the trace ray parameters.</p>
</li>
<li>
<p><code>offset</code> is the byte offset into <code>buffer</code> where parameters
begin.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkCmdTraceRaysIndirectKHR</code> behaves similarly to <a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a>
except that the ray trace query dimensions are read by the device from
<code>buffer</code> during execution.
The parameters of trace ray are encoded in the
<a href="#VkTraceRaysIndirectCommandKHR">VkTraceRaysIndirectCommandKHR</a> structure located at <code>offset</code> bytes
in <code>buffer</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02690" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02690"></a>
If a <code>VkImageView</code> is sampled with <code>VK_FILTER_LINEAR</code> as a
result of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_LINEAR_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02691" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02691"></a>
If a <code>VkImageView</code> is accessed using atomic operations as a result
of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_STORAGE_IMAGE_ATOMIC_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02692" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02692"></a>
If a <code>VkImageView</code> is sampled with <code>VK_FILTER_CUBIC_EXT</code> as a
result of this command, then the image view’s
<a href="chap11.html#resources-image-view-format-features">format features</a> <strong class="purple">must</strong> contain
<code>VK_FORMAT_FEATURE_SAMPLED_IMAGE_FILTER_CUBIC_BIT_EXT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-filterCubic-02694" href="#VUID-vkCmdTraceRaysIndirectKHR-filterCubic-02694"></a>
Any <a href="chap11.html#VkImageView">VkImageView</a> being sampled with <code>VK_FILTER_CUBIC_EXT</code> as a
result of this command <strong class="purple">must</strong> have a <a href="chap11.html#VkImageViewType">VkImageViewType</a> and format
that supports cubic filtering, as specified by
<code>VkFilterCubicImageViewImageFormatPropertiesEXT</code>::<code>filterCubic</code>
returned by <code>vkGetPhysicalDeviceImageFormatProperties2</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-filterCubicMinmax-02695" href="#VUID-vkCmdTraceRaysIndirectKHR-filterCubicMinmax-02695"></a>
Any <a href="chap11.html#VkImageView">VkImageView</a> being sampled with <code>VK_FILTER_CUBIC_EXT</code> with
a reduction mode of either <code>VK_SAMPLER_REDUCTION_MODE_MIN</code> or
<code>VK_SAMPLER_REDUCTION_MODE_MAX</code> as a result of this command <strong class="purple">must</strong>
have a <a href="chap11.html#VkImageViewType">VkImageViewType</a> and format that supports cubic filtering
together with minmax filtering, as specified by
<code>VkFilterCubicImageViewImageFormatPropertiesEXT</code>::<code>filterCubicMinmax</code>
returned by <code>vkGetPhysicalDeviceImageFormatProperties2</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-02696" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-02696"></a>
Any <a href="chap11.html#VkImage">VkImage</a> created with a <a href="chap11.html#VkImageCreateInfo">VkImageCreateInfo</a>::<code>flags</code>
containing <code>VK_IMAGE_CREATE_CORNER_SAMPLED_BIT_NV</code> sampled as a
result of this command <strong class="purple">must</strong> only be sampled using a
<a href="chap12.html#VkSamplerAddressMode">VkSamplerAddressMode</a> of
<code>VK_SAMPLER_ADDRESS_MODE_CLAMP_TO_EDGE</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02697" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02697"></a>
For each set <em>n</em> that is statically used by the <code>VkPipeline</code> bound
to the pipeline bind point used by this command, a descriptor set <strong class="purple">must</strong>
have been bound to <em>n</em> at the same pipeline bind point, with a
<code>VkPipelineLayout</code> that is compatible for set <em>n</em>, with the
<code>VkPipelineLayout</code> used to create the current <code>VkPipeline</code>, as
described in <a href="chap13.html#descriptorsets-compatibility">Pipeline Layout Compatibility</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02698" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02698"></a>
For each push constant that is statically used by the <code>VkPipeline</code>
bound to the pipeline bind point used by this command, a push constant
value <strong class="purple">must</strong> have been set for the same pipeline bind point, with a
<code>VkPipelineLayout</code> that is compatible for push constants, with the
<code>VkPipelineLayout</code> used to create the current <code>VkPipeline</code>, as
described in <a href="chap13.html#descriptorsets-compatibility">Pipeline Layout Compatibility</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02699" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02699"></a>
Descriptors in each bound descriptor set, specified via
<code>vkCmdBindDescriptorSets</code>, <strong class="purple">must</strong> be valid if they are statically
used by the <code>VkPipeline</code> bound to the pipeline bind point used by
this command</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02700" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02700"></a>
A valid pipeline <strong class="purple">must</strong> be bound to the pipeline bind point used by this
command</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-02701" href="#VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-02701"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command requires any dynamic state, that state <strong class="purple">must</strong> have been set
for <code>commandBuffer</code>, and done so after any previously bound pipeline
with the corresponding state not specified as dynamic</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02859" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02859"></a>
There <strong class="purple">must</strong> not have been any calls to dynamic state setting commands
for any state not specified as dynamic in the <code>VkPipeline</code> object
bound to the pipeline bind point used by this command, since that
pipeline was bound</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02702" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02702"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used to sample from any
<code>VkImage</code> with a <code>VkImageView</code> of the type
<code>VK_IMAGE_VIEW_TYPE_3D</code>, <code>VK_IMAGE_VIEW_TYPE_CUBE</code>,
<code>VK_IMAGE_VIEW_TYPE_1D_ARRAY</code>, <code>VK_IMAGE_VIEW_TYPE_2D_ARRAY</code> or
<code>VK_IMAGE_VIEW_TYPE_CUBE_ARRAY</code>, in any shader stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02703" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02703"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used with any of the SPIR-V
<code>OpImageSample*</code> or <code>OpImageSparseSample*</code> instructions with
<code>ImplicitLod</code>, <code>Dref</code> or <code>Proj</code> in their name, in any shader
stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02704" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02704"></a>
If the <code>VkPipeline</code> object bound to the pipeline bind point used by
this command accesses a <code>VkSampler</code> object that uses unnormalized
coordinates, that sampler <strong class="purple">must</strong> not be used with any of the SPIR-V
<code>OpImageSample*</code> or <code>OpImageSparseSample*</code> instructions that includes a
LOD bias or any offset values, in any shader stage</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02705" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02705"></a>
If the <a href="chap38.html#features-robustBufferAccess">robust buffer access</a> feature is
not enabled, and if the <code>VkPipeline</code> object bound to the pipeline
bind point used by this command accesses a uniform buffer, it <strong class="purple">must</strong> not
access values outside of the range of the buffer as specified in the
descriptor set bound to the same pipeline bind point</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-02706" href="#VUID-vkCmdTraceRaysIndirectKHR-None-02706"></a>
If the <a href="chap38.html#features-robustBufferAccess">robust buffer access</a> feature is
not enabled, and if the <code>VkPipeline</code> object bound to the pipeline
bind point used by this command accesses a storage buffer, it <strong class="purple">must</strong> not
access values outside of the range of the buffer as specified in the
descriptor set bound to the same pipeline bind point</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-02707" href="#VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-02707"></a>
If <code>commandBuffer</code> is an unprotected command buffer, any resource
accessed by the <code>VkPipeline</code> object bound to the pipeline bind point
used by this command <strong class="purple">must</strong> not be a protected resource</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-None-03429" href="#VUID-vkCmdTraceRaysIndirectKHR-None-03429"></a>
Any shader group handle referenced by this call <strong class="purple">must</strong> have been queried
from the currently bound ray tracing shader pipeline</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-maxRecursionDepth-03430" href="#VUID-vkCmdTraceRaysIndirectKHR-maxRecursionDepth-03430"></a>
This command <strong class="purple">must</strong> not cause a shader call instruction to be executed
from a shader invocation with a <a href="#ray-tracing-recursion-depth">recursion
depth</a> greater than the value of <code>maxRecursionDepth</code> used to create
the bound ray tracing pipeline</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pRayGenShaderBindingTable-04019" href="#VUID-vkCmdTraceRaysIndirectKHR-pRayGenShaderBindingTable-04019"></a>
If <code>pRayGenShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong>
be bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04020" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04020"></a>
The <code>offset</code> member of <code>pRayGenShaderBindingTable</code> <strong class="purple">must</strong> be less
than the size of the <code>pRayGenShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pRayGenShaderBindingTable-04021" href="#VUID-vkCmdTraceRaysIndirectKHR-pRayGenShaderBindingTable-04021"></a>
<code>pRayGenShaderBindingTable-&gt;offset</code> <strong class="purple">must</strong> be a multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pRayGenShaderBindingTable-04022" href="#VUID-vkCmdTraceRaysIndirectKHR-pRayGenShaderBindingTable-04022"></a>
<span class="eq"><code>pRayGenShaderBindingTable-&gt;offset</code> + 
<code>pRayGenShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to
the size of <code>pRayGenShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-size-04023" href="#VUID-vkCmdTraceRaysIndirectKHR-size-04023"></a>
The <code>size</code> member of <code>pRayGenShaderBindingTable</code> <strong class="purple">must</strong> be equal
to its <code>stride</code> member</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pMissShaderBindingTable-04024" href="#VUID-vkCmdTraceRaysIndirectKHR-pMissShaderBindingTable-04024"></a>
If <code>pMissShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04025" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04025"></a>
The <code>offset</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be less
than the size of <code>pMissShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04026" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04026"></a>
The <code>offset</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pMissShaderBindingTable-04027" href="#VUID-vkCmdTraceRaysIndirectKHR-pMissShaderBindingTable-04027"></a>
<span class="eq"><code>pMissShaderBindingTable-&gt;offset</code> + 
<code>pMissShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to the
size of <code>pMissShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-stride-04028" href="#VUID-vkCmdTraceRaysIndirectKHR-stride-04028"></a>
The <code>stride</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-stride-04029" href="#VUID-vkCmdTraceRaysIndirectKHR-stride-04029"></a>
The <code>stride</code> member of <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be less
than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pHitShaderBindingTable-04030" href="#VUID-vkCmdTraceRaysIndirectKHR-pHitShaderBindingTable-04030"></a>
If <code>pHitShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong> be
bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04031" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04031"></a>
The <code>offset</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be less
than the size of <code>pHitShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04032" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04032"></a>
The <code>offset</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pHitShaderBindingTable-04033" href="#VUID-vkCmdTraceRaysIndirectKHR-pHitShaderBindingTable-04033"></a>
<span class="eq"><code>pHitShaderBindingTable-&gt;offset</code> + 
<code>pHitShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to the
size of <code>pHitShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-stride-04034" href="#VUID-vkCmdTraceRaysIndirectKHR-stride-04034"></a>
The <code>stride</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-stride-04035" href="#VUID-vkCmdTraceRaysIndirectKHR-stride-04035"></a>
The <code>stride</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be less
than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pCallableShaderBindingTable-04036" href="#VUID-vkCmdTraceRaysIndirectKHR-pCallableShaderBindingTable-04036"></a>
If <code>pCallableShaderBindingTable-&gt;buffer</code> is non-sparse then it <strong class="purple">must</strong>
be bound completely and contiguously to a single <code>VkDeviceMemory</code>
object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04037" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04037"></a>
The <code>offset</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be
less than the size of <code>pCallableShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-04038" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-04038"></a>
The <code>offset</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupBaseAlignment</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pCallableShaderBindingTable-04039" href="#VUID-vkCmdTraceRaysIndirectKHR-pCallableShaderBindingTable-04039"></a>
<span class="eq"><code>pCallableShaderBindingTable-&gt;offset</code> + 
<code>pCallableShaderBindingTable-&gt;size</code></span> <strong class="purple">must</strong> be less than or equal to
the size of <code>pCallableShaderBindingTable-&gt;buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-stride-04040" href="#VUID-vkCmdTraceRaysIndirectKHR-stride-04040"></a>
The <code>stride</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be a
multiple of
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>shaderGroupHandleSize</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-stride-04041" href="#VUID-vkCmdTraceRaysIndirectKHR-stride-04041"></a>
The <code>stride</code> member of <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be
less than or equal to
<code>VkPhysicalDeviceRayTracingPropertiesKHR</code>::<code>maxShaderGroupStride</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03508" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03508"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_ANY_HIT_SHADERS_BIT_KHR</code>,
the <code>buffer</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03509" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03509"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_CLOSEST_HIT_SHADERS_BIT_KHR</code>,
the <code>buffer</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03510" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03510"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_INTERSECTION_SHADERS_BIT_KHR</code>,
the <code>buffer</code> member of <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03511" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03511"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_MISS_SHADERS_BIT_KHR</code>, the
shader group handle identified by <code>pMissShaderBindingTable</code> <strong class="purple">must</strong>
contain a valid miss shader</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03512" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03512"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_ANY_HIT_SHADERS_BIT_KHR</code>,
entries in <code>pHitShaderBindingTable</code> accessed as a result of this
command in order to execute an any hit shader <strong class="purple">must</strong> not be set to zero</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03513" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03513"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_CLOSEST_HIT_SHADERS_BIT_KHR</code>,
entries in <code>pHitShaderBindingTable</code> accessed as a result of this
command in order to execute a closest hit shader <strong class="purple">must</strong> not be set to
zero</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-flags-03514" href="#VUID-vkCmdTraceRaysIndirectKHR-flags-03514"></a>
If the currently bound ray tracing pipeline was created with <code>flags</code>
that included
<code>VK_PIPELINE_CREATE_RAY_TRACING_NO_NULL_INTERSECTION_SHADERS_BIT_KHR</code>,
entries in <code>pHitShaderBindingTable</code> accessed as a result of this
command in order to execute an intersection shader <strong class="purple">must</strong> not be set to
zero</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-buffer-02708" href="#VUID-vkCmdTraceRaysIndirectKHR-buffer-02708"></a>
If <code>buffer</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-buffer-02709" href="#VUID-vkCmdTraceRaysIndirectKHR-buffer-02709"></a>
<code>buffer</code> <strong class="purple">must</strong> have been created with the
<code>VK_BUFFER_USAGE_INDIRECT_BUFFER_BIT</code> bit set</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-02710" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-02710"></a>
<code>offset</code> <strong class="purple">must</strong> be a multiple of <code>4</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-02711" href="#VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-02711"></a>
<code>commandBuffer</code> <strong class="purple">must</strong> not be a protected command buffer</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-offset-03517" href="#VUID-vkCmdTraceRaysIndirectKHR-offset-03517"></a>
<span class="eq">(<code>offset</code> + 
<code>sizeof</code>(<code>VkTraceRaysIndirectCommandKHR</code>))</span> <strong class="purple">must</strong> be less than or
equal to the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-rayTracingIndirectTraceRays-03518" href="#VUID-vkCmdTraceRaysIndirectKHR-rayTracingIndirectTraceRays-03518"></a>
the <a href="chap38.html#features-raytracing-indirecttraceray"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingIndirectTraceRays</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-parameter" href="#VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pRaygenShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysIndirectKHR-pRaygenShaderBindingTable-parameter"></a> <code>pRaygenShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pMissShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysIndirectKHR-pMissShaderBindingTable-parameter"></a> <code>pMissShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pHitShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysIndirectKHR-pHitShaderBindingTable-parameter"></a> <code>pHitShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-pCallableShaderBindingTable-parameter" href="#VUID-vkCmdTraceRaysIndirectKHR-pCallableShaderBindingTable-parameter"></a> <code>pCallableShaderBindingTable</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkStridedBufferRegionKHR">VkStridedBufferRegionKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-buffer-parameter" href="#VUID-vkCmdTraceRaysIndirectKHR-buffer-parameter"></a> <code>buffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-recording" href="#VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-cmdpool" href="#VUID-vkCmdTraceRaysIndirectKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-renderpass" href="#VUID-vkCmdTraceRaysIndirectKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdTraceRaysIndirectKHR-commonparent" href="#VUID-vkCmdTraceRaysIndirectKHR-commonparent"></a> Both of <code>buffer</code>, and <code>commandBuffer</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkTraceRaysIndirectCommandKHR</code> structure is defined as:</p>
</div>
<div id="VkTraceRaysIndirectCommandKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkTraceRaysIndirectCommandKHR {
    uint32_t    width;
    uint32_t    height;
    uint32_t    depth;
} VkTraceRaysIndirectCommandKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>width</code> is the width of the ray trace query dimensions.</p>
</li>
<li>
<p><code>height</code> is height of the ray trace query dimensions.</p>
</li>
<li>
<p><code>depth</code> is depth of the ray trace query dimensions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The members of <code>VkTraceRaysIndirectCommandKHR</code> have the same meaning as
the similarly named parameters of <a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkTraceRaysIndirectCommandKHR-width-03519" href="#VUID-VkTraceRaysIndirectCommandKHR-width-03519"></a>
<code>width</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[0]</p>
</li>
<li>
<p><a id="VUID-VkTraceRaysIndirectCommandKHR-height-03520" href="#VUID-VkTraceRaysIndirectCommandKHR-height-03520"></a>
<code>height</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[1]</p>
</li>
<li>
<p><a id="VUID-VkTraceRaysIndirectCommandKHR-depth-03521" href="#VUID-VkTraceRaysIndirectCommandKHR-depth-03521"></a>
<code>depth</code> <strong class="purple">must</strong> be less than or equal to
<code>VkPhysicalDeviceLimits</code>::<code>maxComputeWorkGroupCount</code>[2]</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shader-binding-table"><a class="anchor" href="#shader-binding-table"></a>36.3. Shader Binding Table</h3>
<div class="paragraph">
<p>A <em>shader binding table</em> is a resource which establishes the relationship
between the ray tracing pipeline and the acceleration structures that were
built for the ray tracing query.
It indicates the shaders that operate on each geometry in an acceleration
structure.
In addition, it contains the resources accessed by each shader, including
indices of textures and constants.
The application allocates and manages <em>shader binding tables</em> as
<a href="chap11.html#VkBuffer">VkBuffer</a> objects.</p>
</div>
<div class="paragraph">
<p>Each entry in the shader binding table consists of
<code>shaderGroupHandleSize</code> bytes of data as queried by
<a href="chap9.html#vkGetRayTracingShaderGroupHandlesKHR">vkGetRayTracingShaderGroupHandlesKHR</a> to refer to the shader that it
invokes.
The remainder of the data specified by the stride is application-visible
data that can be referenced by a <code>ShaderRecordBufferKHR</code> block in the
shader.</p>
</div>
<div class="paragraph">
<p>The shader binding tables to use in a ray tracing query are passed to
<a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a>.
Shader binding tables are read-only in shaders that are executing on the ray
tracing pipeline.</p>
</div>
<div class="sect3">
<h4 id="shader-binding-table-indexing-rules"><a class="anchor" href="#shader-binding-table-indexing-rules"></a>36.3.1. Indexing Rules</h4>
<div class="paragraph">
<p>In order to execute the correct shaders and access the correct resources
during a ray tracing dispatch, the implementation <strong class="purple">must</strong> be able to locate
shader binding table entries at various stages of execution.
This is accomplished by defining a set of indexing rules that compute shader
binding table record positions relative to the buffer’s base address in
memory.
The application <strong class="purple">must</strong> organize the contents of the shader binding table’s
memory in a way that application of the indexing rules will lead to correct
records.</p>
</div>
<div class="sect4">
<h5 id="_ray_generation_shaders"><a class="anchor" href="#_ray_generation_shaders"></a>Ray Generation Shaders</h5>
<div class="paragraph">
<p>Only one ray generation shader is executed per ray tracing dispatch.
Its location is passed into <a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a> using the
<code>pRaygenShaderBindingTable-&gt;buffer</code> and
<code>pRaygenShaderBindingTable-&gt;offset</code> parameters — there is no indexing.
<code>pRaygenShaderBindingTable-&gt;stride</code> is unused.</p>
</div>
<div class="paragraph">
<p>For <a href="#vkCmdTraceRaysNV">vkCmdTraceRaysNV</a>, the offset and stride come from direct
parameters, so the buffer and offset come from
<code>raygenShaderBindingBuffer</code> and <code>raygenShaderBindingOffset</code></p>
</div>
<div class="paragraph">
<p>All data accessed <strong class="purple">must</strong> be less than <code>pRaygenShaderBindingTable-&gt;size</code>
bytes from the base offset.</p>
</div>
</div>
<div class="sect4">
<h5 id="_hit_shaders"><a class="anchor" href="#_hit_shaders"></a>Hit Shaders</h5>
<div class="paragraph">
<p>The base for the computation of intersection, any-hit and closest hit shader
locations is the <code>instanceShaderBindingTableRecordOffset</code> value stored
with each instance of a top-level acceleration structure.
This value determines the beginning of the shader binding table records for
a given instance.
Each geometry in the instance <strong class="purple">must</strong> map to at least one hit program record.</p>
</div>
<div class="paragraph">
<p>In the following rule, <em>geometryIndex</em> refers to the location of the
geometry within the instance.
This index is available to ray shaders via the <code>RayGeometryIndexKHR</code>
built-in.</p>
</div>
<div class="paragraph">
<p>The <code>sbtRecordStride</code> and <code>sbtRecordOffset</code> values are passed in as
parameters to
<code>traceNV</code>()
 or
<code>traceRayEXT</code>()
calls made in the shaders.
See Section 8.19 (Ray Tracing Functions) of the OpenGL Shading Language
Specification for more details.
In SPIR-V, these correspond to the <code>SBTOffset</code> and <code>SBTStride</code>
parameters to the <code>OpTraceRayKHR</code> instruction.</p>
</div>
<div class="paragraph">
<p>The result of this computation is then added to
<code>pHitShaderBindingTable-&gt;offset</code>
or <code>hitShaderBindingOffset</code>
, a base offset passed to <a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a>
or <a href="#vkCmdTraceRaysNV">vkCmdTraceRaysNV</a> respectively
.</p>
</div>
<div class="paragraph">
<p>The complete rule to compute a hit shader binding table record address in
the <code>pHitShaderBindingTable-&gt;buffer</code> is:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>pHitShaderBindingTable-&gt;offset</code> + 
<code>pHitShaderBindingTable-&gt;stride</code> × (
<code>instanceShaderBindingTableRecordOffset</code> + 
<em>geometryIndex</em> × <code>sbtRecordStride</code> + 
<code>sbtRecordOffset</code> )</span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All data accessed <strong class="purple">must</strong> be less than <code>pHitShaderBindingTable-&gt;size</code>
bytes from the base offset.</p>
</div>
<div class="paragraph">
<p>For <a href="#vkCmdTraceRaysNV">vkCmdTraceRaysNV</a>, the offset and stride come from direct
parameters, so the full rule is equivalently:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>hitShaderBindingOffset</code> + 
<code>hitShaderBindingStride</code> × (
<code>instanceShaderBindingTableRecordOffset</code> + 
<em>geometryIndex</em> × <code>sbtRecordStride</code> + 
<code>sbtRecordOffset</code> )</span></p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_miss_shaders"><a class="anchor" href="#_miss_shaders"></a>Miss Shaders</h5>
<div class="paragraph">
<p>A miss shader is executed whenever a ray query fails to find an intersection
for the given scene geometry.
Multiple miss shaders <strong class="purple">may</strong> be executed throughout a ray tracing dispatch.</p>
</div>
<div class="paragraph">
<p>The base for the computation of miss shader locations is
<code>pMissShaderBindingTable-&gt;offset</code>, a base offset passed into
<a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a>.</p>
</div>
<div class="paragraph">
<p>The <code>missIndex</code> value is passed in as a parameter to
<code>traceNV</code>()
 or
<code>traceRayEXT</code>()
calls made in the shaders.
See Section 8.19 (Ray Tracing Functions) of the OpenGL Shading Language
Specification for more details.
In SPIR-V, this corresponds to the <code>MissIndex</code> parameter to the
<code>OpTraceRayKHR</code> instruction.</p>
</div>
<div class="paragraph">
<p>The complete rule to compute a miss shader binding table record address in
the <code>pMissShaderBindingTable-&gt;buffer</code> is:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>pMissShaderBindingTable-&gt;offset</code> + 
<code>pMissShaderBindingTable-&gt;stride</code> × <code>missIndex</code></span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All data accessed <strong class="purple">must</strong> be less than <code>pMissShaderBindingTable-&gt;size</code>
bytes from the base offset.</p>
</div>
<div class="paragraph">
<p>For <a href="#vkCmdTraceRaysNV">vkCmdTraceRaysNV</a>, the offset and stride come from direct
parameters, so the full rule is equivalently:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>missShaderBindingOffset</code> + 
<code>missShaderBindingStride</code> × <code>missIndex</code></span></p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_callable_shaders"><a class="anchor" href="#_callable_shaders"></a>Callable Shaders</h5>
<div class="paragraph">
<p>A callable shader is executed when requested by a ray tracing shader.
Multiple callable shaders <strong class="purple">may</strong> be executed throughout a ray tracing
dispatch.</p>
</div>
<div class="paragraph">
<p>The base for the computation of callable shader locations is
<code>pCallableShaderBindingTable-&gt;offset</code>, a base offset passed into
<a href="#vkCmdTraceRaysKHR">vkCmdTraceRaysKHR</a>.</p>
</div>
<div class="paragraph">
<p>The <code>sbtRecordIndex</code> value is passed in as a parameter to
<code>executeCallableNV</code>()
 or
<code>executeCallableEXT</code>()
calls made in the shaders.
See Section 8.19 (Ray Tracing Functions) of the OpenGL Shading Language
Specification for more details.
In SPIR-V, this corresponds to the <code>SBTIndex</code> parameter to the
<code>OpExecuteCallableKHR</code> instruction.</p>
</div>
<div class="paragraph">
<p>The complete rule to compute a callable shader binding table record address
in the <code>pCallableShaderBindingTable-&gt;buffer</code> is:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>pCallableShaderBindingTable-&gt;offset</code> + 
<code>pCallableShaderBindingTable-&gt;stride</code> ×
<code>sbtRecordIndex</code></span></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All data accessed <strong class="purple">must</strong> be less than <code>pCallableShaderBindingTable-&gt;size</code>
bytes from the base offset.</p>
</div>
<div class="paragraph">
<p>For <a href="#vkCmdTraceRaysNV">vkCmdTraceRaysNV</a>, the offset and stride come from direct
parameters, so the full rule is equivalently:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p><span class="eq"><code>callableShaderBindingOffset</code> + 
<code>callableShaderBindingStride</code> × <code>sbtRecordIndex</code></span></p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="acceleration-structure"><a class="anchor" href="#acceleration-structure"></a>36.4. Acceleration Structures</h3>
<div class="paragraph">
<p><em>Acceleration structures</em> are data structures used by the implementation to
efficiently manage scene geometry as it is <a href="chap35.html#ray-traversal">traversed during
a ray tracing query</a>.
The application is responsible for managing acceleration structure objects
(see <a href="chap11.html#resources-acceleration-structures">Acceleration Structures</a>),
including allocation, destruction, executing builds or updates, and
synchronizing resources used during ray tracing queries.</p>
</div>
<div class="paragraph">
<p>There are two types of acceleration structures, <em>top level acceleration
structures</em> and <em>bottom level acceleration structures</em>.</p>
</div>
<div id="fig-accelstruct" class="imageblock text-center">
<div class="content">
<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="122.6349mm" height="111.36717mm" viewBox="0 0 122.6349 111.36717" version="1.1" id="svg4035" inkscape:version="0.92.3 (2405546, 2018-03-11)" sodipodi:docname="accelstruct.svg">
  <defs id="defs4029">
    <marker inkscape:isstock="true" style="overflow:visible" id="marker5699" refX="0" refY="0" orient="auto" inkscape:stockid="Arrow1Lend">
      <path transform="matrix(-0.8,0,0,-0.8,-10,0)" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" d="M 0,0 5,-5 -12.5,0 5,5 Z" id="path5697" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend" style="overflow:visible" inkscape:isstock="true" inkscape:collect="always">
      <path id="path4902" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)" inkscape:connector-curvature="0"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-2" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-7" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-1" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-5" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
    <marker inkscape:stockid="Arrow1Lend" orient="auto" refY="0" refX="0" id="Arrow1Lend-0" style="overflow:visible" inkscape:isstock="true">
      <path inkscape:connector-curvature="0" id="path4902-3" d="M 0,0 5,-5 -12.5,0 5,5 Z" style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:1.00000003pt;stroke-opacity:1" transform="matrix(-0.8,0,0,-0.8,-10,0)"></path>
    </marker>
  </defs>
  <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="205.45633" inkscape:cy="48.906685" inkscape:document-units="mm" inkscape:current-layer="layer1" showgrid="false" inkscape:window-width="2560" inkscape:window-height="1538" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="0"></sodipodi:namedview>
  <metadata id="metadata4032">
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-36.531136,-66.301968)">
    <rect id="rect4037" width="117.55059" height="33.639881" x="39.498512" y="66.434525" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect id="rect4037-1" width="34.855381" height="33.760372" x="54.720116" y="143.83646" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.14462024;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect id="rect4037-1-1" width="34.855381" height="33.760372" x="120.36967" y="143.83646" style="fill:#cecece;fill-opacity:1;stroke:#000000;stroke-width:0.14462024;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874" width="34.206844" height="21.355652" x="36.663692" y="109.68093" ry="6.6145835"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874-5" width="34.206844" height="21.355654" x="82.682297" y="109.68093" ry="6.6145835"></rect>
    <rect style="fill:#ffffff;fill-opacity:1;stroke:#000000;stroke-width:0.26511249;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect4874-4" width="34.206844" height="21.355654" x="124.82664" y="109.68093" ry="6.6145835"></rect>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend)" d="m 53.861607,100.45238 v 9.07143" id="path4897" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-2)" d="m 100.35268,100.00656 v 9.07143" id="path4897-7" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-1)" d="m 141.17411,100.38454 v 9.07144" id="path4897-3" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.30833337;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Arrow1Lend-0)" d="m 137.20536,131.26903 v 12.31946" id="path4897-4" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.26458332px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#marker5699)" d="m 52.727677,131.25744 v 7.18155 h 18.898811 v 5.29166" id="path5689" inkscape:connector-curvature="0"></path>
    <path style="fill:none;stroke:#000000;stroke-width:0.2711173px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 100.35268,130.50149 v 7.9375 H 71.626488" id="path5743" inkscape:connector-curvature="0"></path>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="46.680061" y="85.333328" id="text5747"><tspan sodipodi:role="line" x="46.680061" y="85.333328" style="font-size:6.3499999px;stroke-width:0.26458332" id="tspan5749">Top-Level Acceleration Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:0.75;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="55.942436" y="153.21938" id="text5747-1"><tspan sodipodi:role="line" x="55.942436" y="153.21938" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5749-5">Bottom-Level</tspan><tspan sodipodi:role="line" x="55.942436" y="161.15688" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5773">Acceleration</tspan><tspan sodipodi:role="line" x="55.942436" y="169.09438" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5777">Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:10.58333302px;line-height:0.75;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="120.77655" y="153.21938" id="text5747-1-2"><tspan sodipodi:role="line" x="120.77655" y="153.21938" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5749-5-0">Bottom-Level</tspan><tspan sodipodi:role="line" x="120.77655" y="161.15688" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5773-3">Acceleration</tspan><tspan sodipodi:role="line" x="120.77655" y="169.09438" style="font-size:4.93888903px;line-height:0px;stroke-width:0.26458332" id="tspan5777-3">Structure</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="41.388393" y="117.02173" id="text5810"><tspan sodipodi:role="line" id="tspan5808" x="41.388393" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="41.388393" y="122.31339" style="stroke-width:0.26458332" id="tspan5812">and shading</tspan><tspan sodipodi:role="line" x="41.388393" y="127.60506" style="stroke-width:0.26458332" id="tspan5814">information</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="87.024742" y="117.02173" id="text5810-7"><tspan sodipodi:role="line" id="tspan5808-6" x="87.024742" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="87.024742" y="122.31339" style="stroke-width:0.26458332" id="tspan5812-7">and shading</tspan><tspan sodipodi:role="line" x="87.024742" y="127.60506" style="stroke-width:0.26458332" id="tspan5814-8">information</tspan></text>
    <text xml:space="preserve" style="font-style:normal;font-weight:normal;font-size:4.23333311px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" x="129.92503" y="117.02173" id="text5810-73"><tspan sodipodi:role="line" id="tspan5808-5" x="129.92503" y="117.02173" style="stroke-width:0.26458332">Transform</tspan><tspan sodipodi:role="line" x="129.92503" y="122.31339" style="stroke-width:0.26458332" id="tspan5812-1">and shading</tspan><tspan sodipodi:role="line" x="129.92503" y="127.60506" style="stroke-width:0.26458332" id="tspan5814-80">information</tspan></text>
  </g>
</svg>
</div>
<div class="title">Figure 25. Acceleration Structure</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Caption</div>
<div class="paragraph">
<p>The diagram shows the relationship between top and bottom level acceleration
structures.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-geometry"><a class="anchor" href="#acceleration-structure-geometry"></a>36.4.1. Geometry</h4>
<div class="paragraph">
<p><em>Geometries</em> refer to a triangle or axis-aligned bounding box.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-inactive-prims"><a class="anchor" href="#acceleration-structure-inactive-prims"></a>36.4.2. Inactive Primitives and Instances</h4>
<div class="paragraph">
<p>Acceleration structures allow the use of particular input values to signal
<em>inactive</em> primitives or instances.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> triangle is one for which the first (X) component of each
vertex is NaN.
If any other vertex component is NaN, and the first is not, the behavior is
undefined.
If the vertex format does not have a NaN representation, then all triangles
are considered active.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> instance is one whose acceleration structure handle is
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>.</p>
</div>
<div class="paragraph">
<p>An <em>inactive</em> AABB is one for which the minimum X coordinate is NaN.
If any other component is NaN, and the first is not, the behavior is
undefined.</p>
</div>
<div class="paragraph">
<p>In the above definitions, &quot;NaN&quot; refers to any type of NaN.
Signaling, non-signaling, quiet, loud, or otherwise.</p>
</div>
<div class="paragraph">
<p>An inactive object is considered invisible to all rays, and <strong class="purple">should</strong> not be
represented in the acceleration structure.
Implementations <strong class="purple">should</strong> ensure that the presence of inactive objects does
not seriously degrade ray tracing performance.</p>
</div>
<div class="paragraph">
<p>Inactive objects are counted in the auto-generated index sequences which are
provided to shaders via <code>InstanceId</code> and <code>PrimitiveId</code> SPIR-V
decorations.
This allows objects in the scene to change freely between the active and
inactive states, without affecting the layout of any arrays which are being
indexed using the ID values.</p>
</div>
<div class="paragraph">
<p>Any transition between the active and inactive states requires a full
acceleration structure rebuild.
An update is not sufficient.
If an inactive object is made active by an update operation (or vice versa),
the results are undefined.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-top-level"><a class="anchor" href="#acceleration-structure-top-level"></a>36.4.3. Top Level Acceleration Structures</h4>
<div class="paragraph">
<p>Opaque acceleration structure for an array of instances.
The descriptor referencing this is the starting point for tracing</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-bottom-level"><a class="anchor" href="#acceleration-structure-bottom-level"></a>36.4.4. Bottom Level Acceleration Structures</h4>
<div class="paragraph">
<p>Opaque acceleration structure for an array of geometries.</p>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-building"><a class="anchor" href="#acceleration-structure-building"></a>36.4.5. Building Acceleration Structures</h4>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build an acceleration structure call:</p>
</div>
<div id="vkCmdBuildAccelerationStructureNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdBuildAccelerationStructureNV(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkAccelerationStructureInfoNV*        pInfo,
    VkBuffer                                    instanceData,
    VkDeviceSize                                instanceOffset,
    VkBool32                                    update,
    VkAccelerationStructureKHR                  dst,
    VkAccelerationStructureKHR                  src,
    VkBuffer                                    scratch,
    VkDeviceSize                                scratchOffset);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> contains the shared information for the acceleration
structure’s structure.</p>
</li>
<li>
<p><code>instanceData</code> is the buffer containing an array of
<a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures defining
acceleration structures.
This parameter <strong class="purple">must</strong> be <code>NULL</code> for bottom level acceleration structures.</p>
</li>
<li>
<p><code>instanceOffset</code> is the offset in bytes (relative to the start of
<code>instanceData</code>) at which the instance data is located.</p>
</li>
<li>
<p><code>update</code> specifies whether to update the <code>dst</code> acceleration
structure with the data in <code>src</code>.</p>
</li>
<li>
<p><code>dst</code> is a pointer to the target acceleration structure for the
build.</p>
</li>
<li>
<p><code>src</code> is a pointer to an existing acceleration structure that is to
be used to update the <code>dst</code> acceleration structure.</p>
</li>
<li>
<p><code>scratch</code> is the <a href="chap11.html#VkBuffer">VkBuffer</a> that will be used as scratch memory
for the build.</p>
</li>
<li>
<p><code>scratchOffset</code> is the offset in bytes relative to the start of
<code>scratch</code> that will be used as a scratch memory.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-geometryCount-02241" href="#VUID-vkCmdBuildAccelerationStructureNV-geometryCount-02241"></a>
<code>geometryCount</code> <strong class="purple">must</strong> be less than or equal to
<a href="chap39.html#VkPhysicalDeviceRayTracingPropertiesNV">VkPhysicalDeviceRayTracingPropertiesNV</a>::<code>maxGeometryCount</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-dst-02488" href="#VUID-vkCmdBuildAccelerationStructureNV-dst-02488"></a>
<code>dst</code> <strong class="purple">must</strong> have been created with compatible
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a> where
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>type</code> and
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>flags</code> are identical,
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>instanceCount</code> and
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>geometryCount</code> for <code>dst</code>
are greater than or equal to the build size and each geometry in
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>pGeometries</code> for <code>dst</code> has
greater than or equal to the number of vertices, indices, and AABBs</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02489" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02489"></a>
If <code>update</code> is <code>VK_TRUE</code>, <code>src</code> <strong class="purple">must</strong> not be
<a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02490" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02490"></a>
If <code>update</code> is <code>VK_TRUE</code>, <code>src</code> <strong class="purple">must</strong> have been built before
with <code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_NV</code> set in
<a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02491" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02491"></a>
If <code>update</code> is <code>VK_FALSE</code>, the <code>size</code> member of the
<a href="chap11.html#VkMemoryRequirements">VkMemoryRequirements</a> structure returned from a call to
<a href="chap11.html#vkGetAccelerationStructureMemoryRequirementsNV">vkGetAccelerationStructureMemoryRequirementsNV</a> with
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>accelerationStructure</code>
set to <code>dst</code> and
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>type</code> set to
<code>VK_ACCELERATION_STRUCTURE_MEMORY_REQUIREMENTS_TYPE_BUILD_SCRATCH_NV</code>
<strong class="purple">must</strong> be less than or equal to the size of <code>scratch</code> minus
<code>scratchOffset</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-02492" href="#VUID-vkCmdBuildAccelerationStructureNV-update-02492"></a>
If <code>update</code> is <code>VK_TRUE</code>, the <code>size</code> member of the
<a href="chap11.html#VkMemoryRequirements">VkMemoryRequirements</a> structure returned from a call to
<a href="chap11.html#vkGetAccelerationStructureMemoryRequirementsNV">vkGetAccelerationStructureMemoryRequirementsNV</a> with
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>accelerationStructure</code>
set to <code>dst</code> and
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoNV">VkAccelerationStructureMemoryRequirementsInfoNV</a>::<code>type</code> set to
<code>VK_ACCELERATION_STRUCTURE_MEMORY_REQUIREMENTS_TYPE_UPDATE_SCRATCH_NV</code>
<strong class="purple">must</strong> be less than or equal to the size of <code>scratch</code> minus
<code>scratchOffset</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-scratch-03522" href="#VUID-vkCmdBuildAccelerationStructureNV-scratch-03522"></a>
<code>scratch</code> <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_RAY_TRACING_BIT_NV</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-instanceData-03523" href="#VUID-vkCmdBuildAccelerationStructureNV-instanceData-03523"></a>
If <code>instanceData</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>instanceData</code>
<strong class="purple">must</strong> have been created with <code>VK_BUFFER_USAGE_RAY_TRACING_BIT_NV</code>
usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-03524" href="#VUID-vkCmdBuildAccelerationStructureNV-update-03524"></a>
If <code>update</code> is <code>VK_TRUE</code>, then objects that were previously
active <strong class="purple">must</strong> not be made inactive as per
<a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-03525" href="#VUID-vkCmdBuildAccelerationStructureNV-update-03525"></a>
If <code>update</code> is <code>VK_TRUE</code>, then objects that were previously
inactive <strong class="purple">must</strong> not be made active as per
<a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-update-03526" href="#VUID-vkCmdBuildAccelerationStructureNV-update-03526"></a>
If <code>update</code> is <code>VK_TRUE</code>, the <code>src</code> and <code>dst</code> objects
<strong class="purple">must</strong> either be the same object or not have any
<a href="chap11.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-pInfo-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAccelerationStructureInfoNV">VkAccelerationStructureInfoNV</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-instanceData-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-instanceData-parameter"></a> If <code>instanceData</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>instanceData</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-dst-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-dst-parameter"></a> <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-src-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-src-parameter"></a> If <code>src</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-scratch-parameter" href="#VUID-vkCmdBuildAccelerationStructureNV-scratch-parameter"></a> <code>scratch</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-recording" href="#VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-cmdpool" href="#VUID-vkCmdBuildAccelerationStructureNV-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-renderpass" href="#VUID-vkCmdBuildAccelerationStructureNV-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureNV-commonparent" href="#VUID-vkCmdBuildAccelerationStructureNV-commonparent"></a> Each of <code>commandBuffer</code>, <code>dst</code>, <code>instanceData</code>, <code>scratch</code>, and <code>src</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures call:</p>
</div>
<div id="vkCmdBuildAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdBuildAccelerationStructureKHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    infoCount,
    <span class="directive">const</span> VkAccelerationStructureBuildGeometryInfoKHR* pInfos,
    <span class="directive">const</span> VkAccelerationStructureBuildOffsetInfoKHR* <span class="directive">const</span>* ppOffsetInfos);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.
It specifies the number of the <code>pInfos</code> structures and
<code>ppOffsetInfos</code> pointers that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is an array of <code>infoCount</code>
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>ppOffsetInfos</code> is an array of <code>infoCount</code> pointers to arrays of
<a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures.
Each <code>ppOffsetInfos</code>[i] is an array of
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vkCmdBuildAccelerationStructureKHR</code> command provides the ability to
initiate multiple acceleration structures builds, however there is no
ordering or synchronization implied between any of the individual
acceleration structure builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that an application <strong class="purple">cannot</strong> build a top-level acceleration
structure in the same <a href="#vkCmdBuildAccelerationStructureKHR">vkCmdBuildAccelerationStructureKHR</a> call as the
associated bottom-level or instance acceleration structures are being built.
There also <strong class="purple">cannot</strong> be any memory aliasing between any acceleration structure
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pOffsetInfos-03402" href="#VUID-vkCmdBuildAccelerationStructureKHR-pOffsetInfos-03402"></a>
Each element of <code>ppOffsetInfos</code>[i] <strong class="purple">must</strong> be a valid pointer to an
array of <code>pInfos</code>[i].<code>geometryCount</code>
<code>VkAccelerationStructureBuildOffsetInfoKHR</code> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03403" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03403"></a>
Each <code>pInfos</code>[i].<code>srcAccelerationStructure</code> <strong class="purple">must</strong> not refer to
the same acceleration structure as any
<code>pInfos</code>[i].<code>dstAccelerationStructure</code> that is provided to the
same build command unless it is identical for an update</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03404" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03404"></a>
For each <code>pInfos</code>[i], <code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been
created with compatible <a href="chap11.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a> where
<a href="chap11.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> and
<a href="chap11.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>flags</code> are identical to
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>type</code> and
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code>
respectively,
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>geometryCount</code>
for <code>dstAccelerationStructure</code> are greater than or equal to the
build size, and each geometry in
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>ppGeometries</code>
for <code>dstAccelerationStructure</code> has greater than or equal to the
number of vertices, indices, and AABBs,
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>
is both 0 or both non-zero, and all other parameters are the same</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03405" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03405"></a>
For each <code>pInfos</code>[i], if <code>update</code> is <code>VK_TRUE</code>, then objects
that were previously active for that acceleration structure <strong class="purple">must</strong> not be
made inactive as per <a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03406" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03406"></a>
For each <code>pInfos</code>[i], if <code>update</code> is <code>VK_TRUE</code>, then objects
that were previously inactive for that acceleration structure <strong class="purple">must</strong> not
be made active as per <a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-None-03407" href="#VUID-vkCmdBuildAccelerationStructureKHR-None-03407"></a>
Any acceleration structure instance in any top level build in this
command <strong class="purple">must</strong> not reference any bottom level acceleration structure
built by this command</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03408" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03408"></a>
There <strong class="purple">must</strong> not be any <a href="chap11.html#resources-memory-aliasing">memory aliasing</a>
between the scratch memories that are provided in all the
<code>pInfos</code>[i].<code>scratchData</code> memories for the acceleration
structure builds</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-None-03409" href="#VUID-vkCmdBuildAccelerationStructureKHR-None-03409"></a>
There <strong class="purple">must</strong> not be any <a href="chap11.html#resources-memory-aliasing">memory aliasing</a>
between memory bound to any top level, bottom level, or instance
acceleration structure accessed by this command</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-update-03527" href="#VUID-vkCmdBuildAccelerationStructureKHR-update-03527"></a>
If <code>update</code> is <code>VK_FALSE</code>, all addresses between
<code>pInfos</code>[i].<code>scratchData</code> and <code>pInfos</code>[i].<code>scratchData</code>
+ N - 1 <strong class="purple">must</strong> be in the buffer device address range of the same buffer,
where N is given by the <code>size</code> member of the
<a href="chap11.html#VkMemoryRequirements">VkMemoryRequirements</a> structure returned from a call to
<a href="chap11.html#vkGetAccelerationStructureMemoryRequirementsKHR">vkGetAccelerationStructureMemoryRequirementsKHR</a> with
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoKHR">VkAccelerationStructureMemoryRequirementsInfoKHR</a>::<code>accelerationStructure</code>
set to <code>pInfos</code>[i].<code>dstAccelerationStructure</code> and
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoKHR">VkAccelerationStructureMemoryRequirementsInfoKHR</a>::<code>type</code> set
to
<code>VK_ACCELERATION_STRUCTURE_MEMORY_REQUIREMENTS_TYPE_BUILD_SCRATCH_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-update-03528" href="#VUID-vkCmdBuildAccelerationStructureKHR-update-03528"></a>
If <code>update</code> is <code>VK_TRUE</code>, all addresses between
<code>pInfos</code>[i].<code>scratchData</code> and <code>pInfos</code>[i].<code>scratchData</code>
+ N - 1 <strong class="purple">must</strong> be in the buffer device address range of the same buffer,
where N is given by the <code>size</code> member of the
<a href="chap11.html#VkMemoryRequirements">VkMemoryRequirements</a> structure returned from a call to
<a href="chap11.html#vkGetAccelerationStructureMemoryRequirementsKHR">vkGetAccelerationStructureMemoryRequirementsKHR</a> with
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoKHR">VkAccelerationStructureMemoryRequirementsInfoKHR</a>::<code>accelerationStructure</code>
set to <code>pInfos</code>[i].<code>dstAccelerationStructure</code> and
<a href="chap11.html#VkAccelerationStructureMemoryRequirementsInfoKHR">VkAccelerationStructureMemoryRequirementsInfoKHR</a>::<code>type</code> set
to
<code>VK_ACCELERATION_STRUCTURE_MEMORY_REQUIREMENTS_TYPE_UPDATE_SCRATCH_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03529" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-03529"></a>
The buffer from which the buffer device address
<code>pInfos</code>[i].<code>scratchData</code> is queried <strong class="purple">must</strong> have been created
with <code>VK_BUFFER_USAGE_RAY_TRACING_BIT_KHR</code> usage flag</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-None-04046" href="#VUID-vkCmdBuildAccelerationStructureKHR-None-04046"></a>
All <a href="#VkDeviceOrHostAddressKHR">VkDeviceOrHostAddressKHR</a> or
<a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> referenced by this command <strong class="purple">must</strong>
contain valid device addresses for a buffer bound to device memory.
If the buffer is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single VkDeviceMemory object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-None-03531" href="#VUID-vkCmdBuildAccelerationStructureKHR-None-03531"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pNext-03532" href="#VUID-vkCmdBuildAccelerationStructureKHR-pNext-03532"></a>
The <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure <strong class="purple">must</strong> not be included in
the <code>pNext</code> chain of any of the provided
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-commandBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructureKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-pInfos-parameter" href="#VUID-vkCmdBuildAccelerationStructureKHR-pInfos-parameter"></a> <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-ppOffsetInfos-parameter" href="#VUID-vkCmdBuildAccelerationStructureKHR-ppOffsetInfos-parameter"></a> <code>ppOffsetInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-commandBuffer-recording" href="#VUID-vkCmdBuildAccelerationStructureKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-commandBuffer-cmdpool" href="#VUID-vkCmdBuildAccelerationStructureKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-renderpass" href="#VUID-vkCmdBuildAccelerationStructureKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureKHR-infoCount-arraylength" href="#VUID-vkCmdBuildAccelerationStructureKHR-infoCount-arraylength"></a> <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build an acceleration structure with some parameters sourced on the
device call:</p>
</div>
<div id="vkCmdBuildAccelerationStructureIndirectKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdBuildAccelerationStructureIndirectKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkAccelerationStructureBuildGeometryInfoKHR* pInfo,
    VkBuffer                                    indirectBuffer,
    VkDeviceSize                                indirectOffset,
    uint32_t                                    indirectStride);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure defining the
geometry used to build the acceleration structure.</p>
</li>
<li>
<p><code>indirectBuffer</code> is the <a href="chap11.html#VkBuffer">VkBuffer</a> containing
<code>pInfo-&gt;geometryCount</code>
<a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfo</code>.</p>
</li>
<li>
<p><code>indirectOffset</code> is the byte offset into <code>indirectBuffer</code> where
offset parameters begin.</p>
</li>
<li>
<p><code>stride</code> is the byte stride between successive sets of offset
parameters.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-None-04047" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-None-04047"></a>
All <a href="#VkDeviceOrHostAddressKHR">VkDeviceOrHostAddressKHR</a> or
<a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> referenced by this command <strong class="purple">must</strong>
contain valid device addresses for a buffer bound to device memory.
If the buffer is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single VkDeviceMemory object</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-None-03534" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-None-03534"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-rayTracingIndirectAccelerationStructureBuild-03535" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-rayTracingIndirectAccelerationStructureBuild-03535"></a>
The <a href="chap38.html#features-raytracing-indirectasbuild"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingIndirectAccelerationStructureBuild</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-pNext-03536" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-pNext-03536"></a>
The <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure <strong class="purple">must</strong> not be included in
the <code>pNext</code> chain of any of the provided
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-commandBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-pInfo-parameter" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-indirectBuffer-parameter" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-indirectBuffer-parameter"></a> <code>indirectBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkBuffer">VkBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-commandBuffer-recording" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-commandBuffer-cmdpool" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-renderpass" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdBuildAccelerationStructureIndirectKHR-commonparent" href="#VUID-vkCmdBuildAccelerationStructureIndirectKHR-commonparent"></a> Both of <code>commandBuffer</code>, and <code>indirectBuffer</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureBuildGeometryInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkAccelerationStructureBuildGeometryInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureBuildGeometryInfoKHR {
    VkStructureType                                     sType;
    <span class="directive">const</span> <span class="directive">void</span>*                                         pNext;
    VkAccelerationStructureTypeKHR                      type;
    VkBuildAccelerationStructureFlagsKHR                flags;
    VkBool32                                            update;
    VkAccelerationStructureKHR                          srcAccelerationStructure;
    VkAccelerationStructureKHR                          dstAccelerationStructure;
    VkBool32                                            geometryArrayOfPointers;
    uint32_t                                            geometryCount;
    <span class="directive">const</span> VkAccelerationStructureGeometryKHR* <span class="directive">const</span>*    ppGeometries;
    VkDeviceOrHostAddressKHR                            scratchData;
} VkAccelerationStructureBuildGeometryInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>type</code> is a <a href="chap11.html#VkAccelerationStructureTypeKHR">VkAccelerationStructureTypeKHR</a> value specifying
the type of acceleration structure being built.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of
<a href="chap11.html#VkBuildAccelerationStructureFlagBitsKHR">VkBuildAccelerationStructureFlagBitsKHR</a> specifying additional
parameters of the acceleration structure.</p>
</li>
<li>
<p><code>update</code> specifies whether to update <code>dstAccelerationStructure</code>
with the data in <code>srcAccelerationStructure</code> or not.</p>
</li>
<li>
<p><code>srcAccelerationStructure</code> points to an existing acceleration
structure that is to be used to update the <code>dst</code> acceleration
structure when <code>update</code> is <code>VK_TRUE</code>.</p>
</li>
<li>
<p><code>dstAccelerationStructure</code> points to the target acceleration
structure for the build.</p>
</li>
<li>
<p><code>geometryArrayOfPointers</code> specifies whether <code>ppGeometries</code> is
used as a pointer to an array of pointers or a pointer to a pointer to
an array.</p>
</li>
<li>
<p><code>geometryCount</code> specifies the number of geometries that will be
built into <code>dstAccelerationStructure</code>.</p>
</li>
<li>
<p><code>ppGeometries</code> is either a pointer to an array of pointers to
<a href="#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a> structures if
<code>geometryArrayOfPointers</code> is <code>VK_TRUE</code>, or a pointer to a
pointer to an array of <a href="#VkAccelerationStructureGeometryKHR">VkAccelerationStructureGeometryKHR</a>
structures if it is <code>VK_FALSE</code>.
Each element of the array describes the data used to build each
acceleration structure geometry.</p>
</li>
<li>
<p><code>scratchData</code> is the device or host address to memory that will be
used as scratch memory for the build.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Elements of <code>ppGeometries</code> are accessed as follows, based on
<code>geometryArrayOfPointers</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="keyword">if</span> (geometryArrayOfPointers) {
    use *(ppGeometries[i]);
} <span class="keyword">else</span> {
    use (*ppGeometries)[i];
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-update-03537" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-update-03537"></a>
If <code>update</code> is <code>VK_TRUE</code>, <code>srcAccelerationStructure</code> <strong class="purple">must</strong>
not be <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-update-03538" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-update-03538"></a>
If <code>update</code> is <code>VK_TRUE</code>, <code>srcAccelerationStructure</code> <strong class="purple">must</strong>
have been built before with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_UPDATE_BIT_KHR</code> set in
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-scratchData-03539" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-scratchData-03539"></a>
<code>scratchData</code> <strong class="purple">must</strong> have been created with
<code>VK_BUFFER_USAGE_RAY_TRACING_BIT_KHR</code> usage flag</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-update-03540" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-update-03540"></a>
If <code>update</code> is <code>VK_TRUE</code>, the <code>srcAccelerationStructure</code> and
<code>dstAccelerationStructure</code> objects <strong class="purple">must</strong> either be the same object
or not have any <a href="chap11.html#resources-memory-aliasing">memory aliasing</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_BUILD_GEOMETRY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-unique" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-sType-unique"></a> The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-type-parameter"></a> <code>type</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureTypeKHR">VkAccelerationStructureTypeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap11.html#VkBuildAccelerationStructureFlagBitsKHR">VkBuildAccelerationStructureFlagBitsKHR</a> values</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-srcAccelerationStructure-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-srcAccelerationStructure-parameter"></a> If <code>srcAccelerationStructure</code> is not <a href="chap48.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>srcAccelerationStructure</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-dstAccelerationStructure-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-dstAccelerationStructure-parameter"></a> <code>dstAccelerationStructure</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-scratchData-parameter" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-scratchData-parameter"></a> <code>scratchData</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressKHR">VkDeviceOrHostAddressKHR</a> union</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent" href="#VUID-VkAccelerationStructureBuildGeometryInfoKHR-commonparent"></a> Both of <code>dstAccelerationStructure</code>, and <code>srcAccelerationStructure</code> that are valid handles of non-ignored parameters <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceOrHostAddressKHR</code> union is defined as:</p>
</div>
<div id="VkDeviceOrHostAddressKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">union</span> VkDeviceOrHostAddressKHR {
    VkDeviceAddress    deviceAddress;
    <span class="directive">void</span>*              hostAddress;
} VkDeviceOrHostAddressKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceAddress</code> is a buffer device address as returned by the
<a href="chap13.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a> command.</p>
</li>
<li>
<p><code>hostAddress</code> is a host memory address.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkDeviceOrHostAddressConstKHR</code> union is defined as:</p>
</div>
<div id="VkDeviceOrHostAddressConstKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">union</span> VkDeviceOrHostAddressConstKHR {
    VkDeviceAddress    deviceAddress;
    <span class="directive">const</span> <span class="directive">void</span>*        hostAddress;
} VkDeviceOrHostAddressConstKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceAddress</code> is a buffer device address as returned by the
<a href="chap13.html#vkGetBufferDeviceAddressKHR">vkGetBufferDeviceAddressKHR</a> command.</p>
</li>
<li>
<p><code>hostAddress</code> is a const host memory address.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryKHR</code> structure is defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryKHR {
    VkStructureType                           sType;
    <span class="directive">const</span> <span class="directive">void</span>*                               pNext;
    VkGeometryTypeKHR                         geometryType;
    VkAccelerationStructureGeometryDataKHR    geometry;
    VkGeometryFlagsKHR                        flags;
} VkAccelerationStructureGeometryKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>geometryType</code> describes which type of geometry this
<code>VkAccelerationStructureGeometryKHR</code> refers to.</p>
</li>
<li>
<p><code>geometry</code> is a <a href="#VkAccelerationStructureGeometryDataKHR">VkAccelerationStructureGeometryDataKHR</a> union
describing the geometry data for the relevant geometry type.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap11.html#VkGeometryFlagBitsKHR">VkGeometryFlagBitsKHR</a> values
describing additional properties of how the geometry should be built.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-03541" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-03541"></a>
If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the
<code>aabbs</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-03542" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-03542"></a>
If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the
<code>triangles</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-03543" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-03543"></a>
If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the
<code>instances</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-geometryType-parameter"></a> <code>geometryType</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkGeometryTypeKHR">VkGeometryTypeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-triangles-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-triangles-parameter"></a> If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the <code>triangles</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-aabbs-parameter"></a> If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the <code>aabbs</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-instances-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-instances-parameter"></a> If <code>geometryType</code> is <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the <code>instances</code> member of <code>geometry</code> <strong class="purple">must</strong> be a valid <a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryKHR-flags-parameter" href="#VUID-VkAccelerationStructureGeometryKHR-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap11.html#VkGeometryFlagBitsKHR">VkGeometryFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryDataKHR</code> union is defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">union</span> VkAccelerationStructureGeometryDataKHR {
    VkAccelerationStructureGeometryTrianglesDataKHR    triangles;
    VkAccelerationStructureGeometryAabbsDataKHR        aabbs;
    VkAccelerationStructureGeometryInstancesDataKHR    instances;
} VkAccelerationStructureGeometryDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>triangles</code> is a
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a> structure.</p>
</li>
<li>
<p><code>aabbs</code> is a <a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>
struture.</p>
</li>
<li>
<p><code>instances</code> is a
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a> structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryTrianglesDataKHR</code> structure is
defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryTrianglesDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryTrianglesDataKHR {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkFormat                         vertexFormat;
    VkDeviceOrHostAddressConstKHR    vertexData;
    VkDeviceSize                     vertexStride;
    VkIndexType                      indexType;
    VkDeviceOrHostAddressConstKHR    indexData;
    VkDeviceOrHostAddressConstKHR    transformData;
} VkAccelerationStructureGeometryTrianglesDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>vertexFormat</code> is the <a href="chap40.html#VkFormat">VkFormat</a> of each vertex element.</p>
</li>
<li>
<p><code>vertexData</code> is a device or host address to memory containing vertex
data for this geometry.</p>
</li>
<li>
<p><code>vertexStride</code> is the stride in bytes between each vertex.</p>
</li>
<li>
<p><code>indexType</code> is the <a href="chap20.html#VkIndexType">VkIndexType</a> of each index element.</p>
</li>
<li>
<p><code>indexData</code> is the device or host address to memory containing index
data for this geometry.</p>
</li>
<li>
<p><code>transformData</code> is a device or host address to memory containing an
optional reference to a <a href="#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure defining a
transformation that should be applied to vertices in this geometry.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>

</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_TRIANGLES_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexFormat-parameter"></a> <code>vertexFormat</code> <strong class="purple">must</strong> be a valid <a href="chap40.html#VkFormat">VkFormat</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexData-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-vertexData-parameter"></a> <code>vertexData</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> union</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexType-parameter"></a> <code>indexType</code> <strong class="purple">must</strong> be a valid <a href="chap20.html#VkIndexType">VkIndexType</a> value</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexData-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-indexData-parameter"></a> If <code>indexData</code> is not <code>0</code>, <code>indexData</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> union</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryTrianglesDataKHR-transformData-parameter" href="#VUID-VkAccelerationStructureGeometryTrianglesDataKHR-transformData-parameter"></a> If <code>transformData</code> is not <code>0</code>, <code>transformData</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> union</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkTransformMatrixKHR</code> structure is defined as:</p>
</div>
<div id="VkTransformMatrixKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkTransformMatrixKHR {
    <span class="predefined-type">float</span>    matrix[<span class="integer">3</span>][<span class="integer">4</span>];
} VkTransformMatrixKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkTransformMatrixNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkTransformMatrixKHR VkTransformMatrixNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>matrix</code> is a 3x4 row-major affine transformation matrix.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryAabbsDataKHR</code> structure is defined
as:</p>
</div>
<div id="VkAccelerationStructureGeometryAabbsDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryAabbsDataKHR {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkDeviceOrHostAddressConstKHR    data;
    VkDeviceSize                     stride;
} VkAccelerationStructureGeometryAabbsDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>data</code> is a device or host address to memory containing
<a href="#VkAabbPositionsKHR">VkAabbPositionsKHR</a> structures containing position data for each
axis-aligned bounding box in the geometry.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between each entry in <code>data</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-data-03544" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-data-03544"></a>
<code>data</code> <strong class="purple">must</strong> be aligned to <code>8</code> bytes</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-stride-03545"></a>
<code>stride</code> <strong class="purple">must</strong> be a multiple of <code>8</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_AABBS_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryAabbsDataKHR-data-parameter" href="#VUID-VkAccelerationStructureGeometryAabbsDataKHR-data-parameter"></a> <code>data</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> union</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>An axis-aligned bounding box positions are defined by the structure:</p>
</div>
<div id="VkAabbPositionsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAabbPositionsKHR {
    <span class="predefined-type">float</span>    minX;
    <span class="predefined-type">float</span>    minY;
    <span class="predefined-type">float</span>    minZ;
    <span class="predefined-type">float</span>    maxX;
    <span class="predefined-type">float</span>    maxY;
    <span class="predefined-type">float</span>    maxZ;
} VkAabbPositionsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAabbPositionsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkAabbPositionsKHR VkAabbPositionsNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>minX</code> is the x position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>minY</code> is the y position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>minZ</code> is the z position of one opposing corner of a bounding box.</p>
</li>
<li>
<p><code>maxX</code> is the x position of the other opposing corner of a bounding
box.</p>
</li>
<li>
<p><code>maxY</code> is the y position of the other opposing corner of a bounding
box.</p>
</li>
<li>
<p><code>maxZ</code> is the z position of the other opposing corner of a bounding
box.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minX-03546" href="#VUID-VkAabbPositionsKHR-minX-03546"></a>
<code>minX</code> <strong class="purple">must</strong> be less than or equal to <code>maxX</code></p>
</li>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minY-03547" href="#VUID-VkAabbPositionsKHR-minY-03547"></a>
<code>minY</code> <strong class="purple">must</strong> be less than or equal to <code>maxY</code></p>
</li>
<li>
<p><a id="VUID-VkAabbPositionsKHR-minZ-03548" href="#VUID-VkAabbPositionsKHR-minZ-03548"></a>
<code>minZ</code> <strong class="purple">must</strong> be less than or equal to <code>maxZ</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureGeometryInstancesDataKHR</code> structure is
defined as:</p>
</div>
<div id="VkAccelerationStructureGeometryInstancesDataKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureGeometryInstancesDataKHR {
    VkStructureType                  sType;
    <span class="directive">const</span> <span class="directive">void</span>*                      pNext;
    VkBool32                         arrayOfPointers;
    VkDeviceOrHostAddressConstKHR    data;
} VkAccelerationStructureGeometryInstancesDataKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>arrayOfPointers</code> specifies whether <code>data</code> is used as an array
of addresses or just an array.</p>
</li>
<li>
<p><code>data</code> is either the address of an array of device or host addresses
referencing individual <a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a>
structures if <code>arrayOfPointers</code> is <code>VK_TRUE</code>, or the address of
an array of <a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-data-03549" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-data-03549"></a>
<code>data</code> <strong class="purple">must</strong> be aligned to <code>16</code> bytes</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-arrayOfPointers-03550" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-arrayOfPointers-03550"></a>
If <code>arrayOfPointers</code> is true, each pointer <strong class="purple">must</strong> be aligned to <code>16</code>
bytes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_GEOMETRY_INSTANCES_DATA_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureGeometryInstancesDataKHR-data-parameter" href="#VUID-VkAccelerationStructureGeometryInstancesDataKHR-data-parameter"></a> <code>data</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> union</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><em>Acceleration structure instances</em> <strong class="purple">can</strong> be built into top-level acceleration
structures.
Each acceleration structure instance is a separate entry in the top-level
acceleration structure which includes all the geometry of a bottom-level
acceleration structure at a transformed location.
Multiple instances <strong class="purple">can</strong> point to the same bottom level acceleration
structure.</p>
</div>
<div class="paragraph">
<p>An acceleration structure instance is defined by the structure:</p>
</div>
<div id="VkAccelerationStructureInstanceKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureInstanceKHR {
    VkTransformMatrixKHR          transform;
    uint32_t                      instanceCustomIndex:<span class="integer">24</span>;
    uint32_t                      mask:<span class="integer">8</span>;
    uint32_t                      instanceShaderBindingTableRecordOffset:<span class="integer">24</span>;
    VkGeometryInstanceFlagsKHR    flags:<span class="integer">8</span>;
    uint64_t                      accelerationStructureReference;
} VkAccelerationStructureInstanceKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkAccelerationStructureInstanceNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkAccelerationStructureInstanceKHR VkAccelerationStructureInstanceNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>transform</code> is a <a href="#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure describing a
transformation to be applied to the acceleration structure.</p>
</li>
<li>
<p><code>instanceCustomIndex</code> a 24-bit user-specified index value accessible
to ray shaders in the <code>InstanceCustomIndexKHR</code> built-in.</p>
</li>
<li>
<p><code>mask</code> is an 8-bit visibility mask for the geometry.
The instance <strong class="purple">may</strong> only be hit if <code>rayMask &amp; instance.mask != 0</code></p>
</li>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> is a 24-bit offset used in
calculating the hit shader binding table index.</p>
</li>
<li>
<p><code>flags</code> is an 8-bit mask of <a href="#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a>
values to apply to this instance.</p>
</li>
<li>
<p><code>accelerationStructureReference</code> is either:</p>
<div class="ulist">
<ul>
<li>
<p>a device address containing the value obtained from
<a href="chap11.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a>
or
<a href="chap11.html#vkGetAccelerationStructureHandleNV">vkGetAccelerationStructureHandleNV</a>
     (used by device operations which reference acceleration structures) or,</p>
</li>
<li>
<p>a <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> object (used by host operations
which reference acceleration structures).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The C language spec does not define the ordering of bit-fields, but in
practice, this struct produces the correct layout with existing compilers.
The intended bit pattern is for the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>instanceCustomIndex</code> and <code>mask</code> occupy the same memory as if a
single <code>int32_t</code> was specified in their place</p>
<div class="ulist">
<ul>
<li>
<p><code>instanceCustomIndex</code> occupies the 24 least significant bits of
that memory</p>
</li>
<li>
<p><code>mask</code> occupies the 8 most significant bits of that memory</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> and <code>flags</code> occupy the
same memory as if a single <code>int32_t</code> was specified in their place</p>
<div class="ulist">
<ul>
<li>
<p><code>instanceShaderBindingTableRecordOffset</code> occupies the 24 least
significant bits of that memory</p>
</li>
<li>
<p><code>flags</code> occupies the 8 most significant bits of that memory</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a compiler produces code that diverges from that pattern, applications
<strong class="purple">must</strong> employ another method to set values according to the correct bit
pattern.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>

</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureInstanceKHR-flags-parameter" href="#VUID-VkAccelerationStructureInstanceKHR-flags-parameter"></a> <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>flags</code> in the instance modifying the behavior of
that instance are:,</p>
</div>
<div id="VkGeometryInstanceFlagBitsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">enum</span> VkGeometryInstanceFlagBitsKHR {
    VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR = <span class="hex">0x00000001</span>,
    VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR = <span class="hex">0x00000002</span>,
    VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR = <span class="hex">0x00000004</span>,
    VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR = <span class="hex">0x00000008</span>,
    VK_GEOMETRY_INSTANCE_TRIANGLE_CULL_DISABLE_BIT_NV = VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR,
    VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_NV = VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR,
    VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_NV = VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR,
    VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_NV = VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR,
} VkGeometryInstanceFlagBitsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkGeometryInstanceFlagBitsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkGeometryInstanceFlagBitsKHR VkGeometryInstanceFlagBitsNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_GEOMETRY_INSTANCE_TRIANGLE_FACING_CULL_DISABLE_BIT_KHR</code> disables
face culling for this instance.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_TRIANGLE_FRONT_COUNTERCLOCKWISE_BIT_KHR</code>
indicates that the front face of the triangle for culling purposes is
the face that is counter clockwise in object space relative to the ray
origin.
Because the facing is determined in object space, an instance transform
matrix does not change the winding, but a geometry transform does.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</code> causes this instance to
act as though <code>VK_GEOMETRY_OPAQUE_BIT_KHR</code> were specified on all
geometries referenced by this instance.
This behavior <strong class="purple">can</strong> be overridden by the SPIR-V <code>NoOpaqueKHR</code> ray
flag.</p>
</li>
<li>
<p><code>VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</code> causes this instance
to act as though <code>VK_GEOMETRY_OPAQUE_BIT_KHR</code> were not specified on
all geometries referenced by this instance.
This behavior <strong class="purple">can</strong> be overridden by the SPIR-V <code>OpaqueKHR</code> ray flag.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>VK_GEOMETRY_INSTANCE_FORCE_NO_OPAQUE_BIT_KHR</code> and
<code>VK_GEOMETRY_INSTANCE_FORCE_OPAQUE_BIT_KHR</code> <strong class="purple">must</strong> not be used in the
same flag.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkGeometryInstanceFlagsKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> VkFlags VkGeometryInstanceFlagsKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkGeometryInstanceFlagsNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkGeometryInstanceFlagsKHR VkGeometryInstanceFlagsNV;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkGeometryInstanceFlagsKHR</code> is a bitmask type for setting a mask of
zero or more <a href="#VkGeometryInstanceFlagBitsKHR">VkGeometryInstanceFlagBitsKHR</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VkAccelerationStructureBuildOffsetInfoKHR</code> is defined as:</p>
</div>
<div id="VkAccelerationStructureBuildOffsetInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureBuildOffsetInfoKHR {
    uint32_t    primitiveCount;
    uint32_t    primitiveOffset;
    uint32_t    firstVertex;
    uint32_t    transformOffset;
} VkAccelerationStructureBuildOffsetInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>primitiveCount</code> defines the number of primitives for a
corresponding acceleration structure geometry.</p>
</li>
<li>
<p><code>primitiveOffset</code> defines an offset in bytes into the memory where
primitive data is defined.</p>
</li>
<li>
<p><code>firstVertex</code> is the index of the first vertex to build from for
triangle geometry.</p>
</li>
<li>
<p><code>transformOffset</code> defines an offset in bytes into the memory where a
transform matrix is defined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The primitive count and primitive offset are interpreted differently
depending on the <a href="chap11.html#VkGeometryTypeKHR">VkGeometryTypeKHR</a> used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>,
<code>primitiveCount</code> is the number of triangles to be built, where each
triangle is treated as 3 vertices.</p>
<div class="ulist">
<ul>
<li>
<p>If the geometry uses indices, <span class="eq"><code>primitiveCount</code> × 3</span>
indices are consumed from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>,
starting at an offset of <code>primitiveOffset</code>.
The value of <code>firstVertex</code> is added to the index values before
fetching vertices.</p>
</li>
<li>
<p>If the geometry does not use indices, <span class="eq"><code>primitiveCount</code> ×
3</span> vertices are consumed from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>,
starting at an offset of <span class="eq"><code>primitiveOffset</code> + 
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexStride</code>
× <code>firstVertex</code></span>.</p>
</li>
<li>
<p>A single <a href="#VkTransformMatrixKHR">VkTransformMatrixKHR</a> structure is consumed from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>,
at an offset of <code>transformOffset</code>.
This transformation matrix is used by all triangles.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>,
<code>primitiveCount</code> is the number of axis-aligned bounding boxes.
<code>primitiveCount</code> <a href="#VkAabbPositionsKHR">VkAabbPositionsKHR</a> structures are consumed
from <a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code>,
starting at an offset of <code>primitiveOffset</code>.</p>
</li>
<li>
<p>For geometries of type <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>,
<code>primitiveCount</code> is the number of acceleration structures.
<code>primitiveCount</code> <a href="#VkAccelerationStructureInstanceKHR">VkAccelerationStructureInstanceKHR</a> structures
are consumed from
<a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code>,
starting at an offset of <code>primitiveOffset</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03551" href="#VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03551"></a>
For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if the
geometry uses indices, the offset <code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexData</code>
<strong class="purple">must</strong> be a multiple of the element size of
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>indexType</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03552" href="#VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03552"></a>
For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, if the
geometry doesn’t use indices, the offset <code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexData</code>
<strong class="purple">must</strong> be a multiple of the component size of
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>vertexType</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildOffsetInfoKHR-transformOffset-03553" href="#VUID-VkAccelerationStructureBuildOffsetInfoKHR-transformOffset-03553"></a>
For geometries of type <code>VK_GEOMETRY_TYPE_TRIANGLES_KHR</code>, the offset
<code>transformOffset</code> from
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>
<strong class="purple">must</strong> be a multiple of 16</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03554" href="#VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03554"></a>
For geometries of type <code>VK_GEOMETRY_TYPE_AABBS_KHR</code>, the offset
<code>primitiveOffset</code> from
<a href="#VkAccelerationStructureGeometryAabbsDataKHR">VkAccelerationStructureGeometryAabbsDataKHR</a>::<code>data</code> <strong class="purple">must</strong> be a
multiple of 8</p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03555" href="#VUID-VkAccelerationStructureBuildOffsetInfoKHR-primitiveOffset-03555"></a>
  For geometries of type <code>VK_GEOMETRY_TYPE_INSTANCES_KHR</code>, the offset
  <code>primitiveOffset</code> from
  <a href="#VkAccelerationStructureGeometryInstancesDataKHR">VkAccelerationStructureGeometryInstancesDataKHR</a>::<code>data</code> <strong class="purple">must</strong>
  be a multiple of 16
// TODO - Almost certainly should be more here</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="acceleration-structure-copying"><a class="anchor" href="#acceleration-structure-copying"></a>36.4.6. Copying Acceleration Structures</h4>
<div class="paragraph">
<p>An additional command exists for copying acceleration structures without
updating their contents.
The acceleration structure object <strong class="purple">can</strong> be compacted in order to improve
performance.
Before copying, an application <strong class="purple">must</strong> query the size of the resulting
acceleration structure.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query acceleration structure size parameters call:</p>
</div>
<div id="vkCmdWriteAccelerationStructuresPropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdWriteAccelerationStructuresPropertiesKHR(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    accelerationStructureCount,
    <span class="directive">const</span> VkAccelerationStructureKHR*           pAccelerationStructures,
    VkQueryType                                 queryType,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent command</p>
</div>
<div id="vkCmdWriteAccelerationStructuresPropertiesNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdWriteAccelerationStructuresPropertiesNV(
    VkCommandBuffer                             commandBuffer,
    uint32_t                                    accelerationStructureCount,
    <span class="directive">const</span> VkAccelerationStructureKHR*           pAccelerationStructures,
    VkQueryType                                 queryType,
    VkQueryPool                                 queryPool,
    uint32_t                                    firstQuery);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> is a pointer to an array of existing
previously built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the type of
queries managed by the pool.</p>
</li>
<li>
<p><code>queryPool</code> is the query pool that will manage the results of the
query.</p>
</li>
<li>
<p><code>firstQuery</code> is the first query index within the query pool that
will contain the <code>accelerationStructureCount</code> number of results.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02493"></a>
<code>queryPool</code> <strong class="purple">must</strong> have been created with a <code>queryType</code> matching
<code>queryType</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-02494"></a>
The queries identified by <code>queryPool</code> and <code>firstQuery</code> <strong class="purple">must</strong> be
<em>unavailable</em></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431"></a>
All acceleration structures in <code>accelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-03432" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-03432"></a>
<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter"></a> <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryType-parameter"></a> <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-queryPool-parameter"></a> <code>queryPool</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryPool">VkQueryPool</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength"></a> <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent" href="#VUID-vkCmdWriteAccelerationStructuresPropertiesKHR-commonparent"></a> Each of <code>commandBuffer</code>, <code>queryPool</code>, and the elements of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="directive">void</span> vkCmdCopyAccelerationStructureNV(
    VkCommandBuffer                             commandBuffer,
    VkAccelerationStructureKHR                  dst,
    VkAccelerationStructureKHR                  src,
    VkCopyAccelerationStructureModeKHR          mode);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>dst</code> is a pointer to the target acceleration structure for the
copy.</p>
</li>
<li>
<p><code>src</code> is a pointer to the source acceleration structure for the
copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value
specifying additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-mode-03410" href="#VUID-vkCmdCopyAccelerationStructureNV-mode-03410"></a>
<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> or
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-src-03411" href="#VUID-vkCmdCopyAccelerationStructureNV-src-03411"></a>
<code>src</code> <strong class="purple">must</strong> have been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>mode</code> is <code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-dst-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-dst-parameter"></a> <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-src-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-src-parameter"></a> <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-mode-parameter" href="#VUID-vkCmdCopyAccelerationStructureNV-mode-parameter"></a> <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-recording" href="#VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-cmdpool" href="#VUID-vkCmdCopyAccelerationStructureNV-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-renderpass" href="#VUID-vkCmdCopyAccelerationStructureNV-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureNV-commonparent" href="#VUID-vkCmdCopyAccelerationStructureNV-commonparent"></a> Each of <code>commandBuffer</code>, <code>dst</code>, and <code>src</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdCopyAccelerationStructureKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCopyAccelerationStructureInfoKHR*   pInfo);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-None-03556" href="#VUID-vkCmdCopyAccelerationStructureKHR-None-03556"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-pNext-03557" href="#VUID-vkCmdCopyAccelerationStructureKHR-pNext-03557"></a>
The <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure <strong class="purple">must</strong> not be included in
the <code>pNext</code> chain of the <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter" href="#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCmdCopyAccelerationStructureKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording" href="#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool" href="#VUID-vkCmdCopyAccelerationStructureKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureKHR-renderpass" href="#VUID-vkCmdCopyAccelerationStructureKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyAccelerationStructureInfoKHR</code> structure is defined as:</p>
</div>
<div id="VkCopyAccelerationStructureInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkCopyAccelerationStructureInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkAccelerationStructureKHR            src;
    VkAccelerationStructureKHR            dst;
    VkCopyAccelerationStructureModeKHR    mode;
} VkCopyAccelerationStructureInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>src</code> is the source acceleration structure for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value that
specifies additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-mode-03410" href="#VUID-VkCopyAccelerationStructureInfoKHR-mode-03410"></a>
<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> or
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-03411" href="#VUID-VkCopyAccelerationStructureInfoKHR-src-03411"></a>
<code>src</code> <strong class="purple">must</strong> have been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>mode</code> is <code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-sType-sType" href="#VUID-VkCopyAccelerationStructureInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_ACCELERATION_STRUCTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext" href="#VUID-VkCopyAccelerationStructureInfoKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-sType-unique" href="#VUID-VkCopyAccelerationStructureInfoKHR-sType-unique"></a> The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-src-parameter" href="#VUID-VkCopyAccelerationStructureInfoKHR-src-parameter"></a> <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter" href="#VUID-VkCopyAccelerationStructureInfoKHR-dst-parameter"></a> <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter" href="#VUID-VkCopyAccelerationStructureInfoKHR-mode-parameter"></a> <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureInfoKHR-commonparent" href="#VUID-VkCopyAccelerationStructureInfoKHR-commonparent"></a> Both of <code>dst</code>, and <code>src</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap4.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Possible values of <code>mode</code> specifying additional operations to perform
during the copy, are:</p>
</div>
<div id="VkCopyAccelerationStructureModeKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">enum</span> VkCopyAccelerationStructureModeKHR {
    VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR = <span class="integer">0</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR = <span class="integer">1</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR = <span class="integer">2</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR = <span class="integer">3</span>,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_NV = VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR,
    VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_NV = VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR,
} VkCopyAccelerationStructureModeKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the equivalent</p>
</div>
<div id="VkCopyAccelerationStructureModeNV" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_NV_ray_tracing</span>
<span class="keyword">typedef</span> VkCopyAccelerationStructureModeKHR VkCopyAccelerationStructureModeNV;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_CLONE_KHR</code> creates a direct
copy of the acceleration structure specified in <code>src</code> into the one
specified by <code>dst</code>.
The <code>dst</code> acceleration structure <strong class="purple">must</strong> have been created with the
same parameters as <code>src</code>.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_COMPACT_KHR</code> creates a more
compact version of an acceleration structure <code>src</code> into <code>dst</code>.
The acceleration structure <code>dst</code> <strong class="purple">must</strong> have been created with a
<code>compactedSize</code> corresponding to the one returned by
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> after the build of
the acceleration structure specified by <code>src</code>.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code> serializes the
acceleration structure to a semi-opaque format which can be reloaded on
a compatible implementation.</p>
</li>
<li>
<p><code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code> deserializes
the semi-opaque serialization format in the buffer to the acceleration
structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy an acceleration structure to device memory call:</p>
</div>
<div id="vkCmdCopyAccelerationStructureToMemoryKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdCopyAccelerationStructureToMemoryKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCopyAccelerationStructureToMemoryInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>, but writes its result to a
device address, and is executed on the device rather than the host.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> or
<a href="#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is an a pointer to a
<a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The defined header structure for the serialized data consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data matching
<code>VkPhysicalDeviceIDProperties</code>::<code>driverUUID</code></p>
</li>
<li>
<p><code>VK_UUID_SIZE</code> bytes of data identifying the compatibility for
comparison using <a href="#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
<li>
<p>A 64-bit integer of the total size matching the value queried using
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
<li>
<p>A 64-bit integer of the deserialized size to be passed in to
<code>VkAccelerationStructureCreateInfoKHR</code>::<code>compactedSize</code></p>
</li>
<li>
<p>A 64-bit integer of the count of the number of acceleration structure
handles following.
This will be zero for a bottom-level acceleration structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The corresponding handles matching the values returned by
<a href="chap11.html#vkGetAccelerationStructureDeviceAddressKHR">vkGetAccelerationStructureDeviceAddressKHR</a>
or
<a href="chap11.html#vkGetAccelerationStructureHandleNV">vkGetAccelerationStructureHandleNV</a>
are tightly packed in the buffer following the count.
The application is expected to store a mapping between those handles and the
original application-generated bottom-level acceleration structures to
provide when deserializing.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-04048" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-04048"></a>
All <code>VkDeviceOrHostAddressConstKHR</code> referenced by this command <strong class="purple">must</strong>
contain valid device addresses for a buffer bound to device memory.
If the buffer is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single VkDeviceMemory object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-None-03559"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pNext-03560" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pNext-03560"></a>
The <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure <strong class="purple">must</strong> not be included in
the <code>pNext</code> chain of the
<a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-mode-03412" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-mode-03412"></a>
<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass" href="#VUID-vkCmdCopyAccelerationStructureToMemoryKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkCopyAccelerationStructureToMemoryInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkCopyAccelerationStructureToMemoryInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkAccelerationStructureKHR            src;
    VkDeviceOrHostAddressKHR              dst;
    VkCopyAccelerationStructureModeKHR    mode;
} VkCopyAccelerationStructureToMemoryInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>src</code> is the source acceleration structure for the copy</p>
</li>
<li>
<p><code>dst</code> is the device or host address to memory which is the target
for the copy</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value that
specifies additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-03561"></a>
The memory pointed to by <code>dst</code> <strong class="purple">must</strong> be at least as large as the
serialization size of <code>src</code>, as reported by
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-03412"></a>
<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_SERIALIZE_KHR</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_ACCELERATION_STRUCTURE_TO_MEMORY_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-unique" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-sType-unique"></a> The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-src-parameter"></a> <code>src</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-parameter" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-dst-parameter"></a> <code>dst</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressKHR">VkDeviceOrHostAddressKHR</a> union</p>
</li>
<li>
<p><a id="VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter" href="#VUID-VkCopyAccelerationStructureToMemoryInfoKHR-mode-parameter"></a> <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy device memory to an acceleration structure call:</p>
</div>
<div id="vkCmdCopyMemoryToAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="directive">void</span> vkCmdCopyMemoryToAccelerationStructureKHR(
    VkCommandBuffer                             commandBuffer,
    <span class="directive">const</span> VkCopyMemoryToAccelerationStructureInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command can accept acceleration structures produced by either
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command will be
recorded.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The structure provided as input to deserialize is as described in
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>, with any acceleration
structure handles filled in with the newly-queried handles to bottom level
acceleration structures created before deserialization.
These do not need to be built at deserialize time, but <strong class="purple">must</strong> be created.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-None-04049" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-None-04049"></a>
All <code>VkDeviceOrHostAddressKHR</code> referenced by this command <strong class="purple">must</strong>
contain valid device addresses for a buffer bound to device memory.
If the buffer is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single VkDeviceMemory object</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-None-03563" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-None-03563"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to device memory</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pNext-03564" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pNext-03564"></a>
The <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure <strong class="purple">must</strong> not be included in
the <code>pNext</code> chain of the
<a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-mode-03413" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-mode-03413"></a>
<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03414" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-03414"></a>
The data in <code>pInfo-&gt;src</code> <strong class="purple">must</strong> have a format compatible with the
destination physical device as returned by
<a href="#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-parameter"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-recording"></a> <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap5.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-commandBuffer-cmdpool"></a> The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass" href="#VUID-vkCmdCopyMemoryToAccelerationStructureKHR-renderpass"></a> This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap7.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap4.html#VkQueueFlagBits">Supported Queue Types</a></th>
<th class="tableblock halign-left valign-top"><a href="#synchronization-pipeline-stages-types">Pipeline Type</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkCopyMemoryToAccelerationStructureInfoKHR</code> structure is defined
as:</p>
</div>
<div id="VkCopyMemoryToAccelerationStructureInfoKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkCopyMemoryToAccelerationStructureInfoKHR {
    VkStructureType                       sType;
    <span class="directive">const</span> <span class="directive">void</span>*                           pNext;
    VkDeviceOrHostAddressConstKHR         src;
    VkAccelerationStructureKHR            dst;
    VkCopyAccelerationStructureModeKHR    mode;
} VkCopyMemoryToAccelerationStructureInfoKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>src</code> is the device or host address to memory containing the source
data for the copy.</p>
</li>
<li>
<p><code>dst</code> is the target acceleration structure for the copy.</p>
</li>
<li>
<p><code>mode</code> is a <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value that
specifies additional operations to perform during the copy.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-03413"></a>
<code>mode</code> <strong class="purple">must</strong> be
<code>VK_COPY_ACCELERATION_STRUCTURE_MODE_DESERIALIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pInfo-03414"></a>
The data in <code>pInfo-&gt;src</code> <strong class="purple">must</strong> have a format compatible with the
destination physical device as returned by
<a href="#vkGetDeviceAccelerationStructureCompatibilityKHR">vkGetDeviceAccelerationStructureCompatibilityKHR</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_COPY_MEMORY_TO_ACCELERATION_STRUCTURE_INFO_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a></p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-unique" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-sType-unique"></a> The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-src-parameter" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-src-parameter"></a> <code>src</code> <strong class="purple">must</strong> be a valid <a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> union</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-dst-parameter"></a> <code>dst</code> <strong class="purple">must</strong> be a valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handle</p>
</li>
<li>
<p><a id="VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter" href="#VUID-VkCopyMemoryToAccelerationStructureInfoKHR-mode-parameter"></a> <code>mode</code> <strong class="purple">must</strong> be a valid <a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a> value</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To check if a serialized acceleration structure is compatible with the
current device call:</p>
</div>
<div id="vkGetDeviceAccelerationStructureCompatibilityKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
VkResult vkGetDeviceAccelerationStructureCompatibilityKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkAccelerationStructureVersionKHR*    version);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device to check the version against.</p>
</li>
<li>
<p><code>version</code> points to the <a href="#VkAccelerationStructureVersionKHR">VkAccelerationStructureVersionKHR</a>
version information to check against the device.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This possible return values for
<code>vkGetDeviceAccelerationStructureCompatibilityKHR</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code> is returned if an acceleration structure serialized
with <code>version</code> as the version information is compatible with
<code>device</code>.</p>
</li>
<li>
<p><code>VK_ERROR_INCOMPATIBLE_VERSION_KHR</code> is returned if an acceleration
structure serialized with <code>version</code> as the version information is
not compatible with <code>device</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracing-03565" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-rayTracing-03565"></a>
The <a href="chap38.html#features-raytracing"><code>rayTracing</code></a> or <a href="chap38.html#features-rayQuery"><code>rayQuery</code></a> feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap4.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-version-parameter" href="#VUID-vkGetDeviceAccelerationStructureCompatibilityKHR-version-parameter"></a> <code>version</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkAccelerationStructureVersionKHR">VkAccelerationStructureVersionKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_INCOMPATIBLE_VERSION_KHR</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkAccelerationStructureVersionKHR</code> structure is defined as:</p>
</div>
<div id="VkAccelerationStructureVersionKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
<span class="keyword">typedef</span> <span class="keyword">struct</span> VkAccelerationStructureVersionKHR {
    VkStructureType    sType;
    <span class="directive">const</span> <span class="directive">void</span>*        pNext;
    <span class="directive">const</span> uint8_t*     versionData;
} VkAccelerationStructureVersionKHR;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>versionData</code> is a pointer to the version header as defined in
<a href="#VkCopyAccelerationStructureModeKHR">VkCopyAccelerationStructureModeKHR</a></p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>

</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkAccelerationStructureVersionKHR-sType-sType" href="#VUID-VkAccelerationStructureVersionKHR-sType-sType"></a> <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_VERSION_KHR</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureVersionKHR-pNext-pNext" href="#VUID-VkAccelerationStructureVersionKHR-pNext-pNext"></a> <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkAccelerationStructureVersionKHR-versionData-parameter" href="#VUID-VkAccelerationStructureVersionKHR-versionData-parameter"></a> <code>versionData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>2</code>*VK_UUID_SIZE <code>uint8_t</code> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="host-acceleration-structure"><a class="anchor" href="#host-acceleration-structure"></a>36.5. Host Acceleration Structure Operations</h3>
<div class="paragraph">
<p>Implementations are also required to provide host implementations of the
acceleration structure operations if the
<a href="chap38.html#feature-raytracing-hostascmds"><code>rayTracingHostAccelerationStructureCommands</code></a>
feature is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#vkBuildAccelerationStructureKHR">vkBuildAccelerationStructureKHR</a> corresponding to
<a href="#vkCmdBuildAccelerationStructureKHR">vkCmdBuildAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="#vkCopyAccelerationStructureKHR">vkCopyAccelerationStructureKHR</a> corresponding to
<a href="#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a> corresponding to
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a></p>
</li>
<li>
<p><a href="#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a> corresponding to
<a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a></p>
</li>
<li>
<p><a href="#vkWriteAccelerationStructuresPropertiesKHR">vkWriteAccelerationStructuresPropertiesKHR</a> corresponding to
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These commands are functionally equivalent to their device counterparts,
except that they are executed on the host timeline, rather than being
enqueued into command buffers.</p>
</div>
<div class="paragraph">
<p>All acceleration structures used by the host commands <strong class="purple">must</strong> be bound to
host-visible memory, and all input data for acceleration structure builds
<strong class="purple">must</strong> be referenced using host addresses instead of device addresses.
Applications are not required to map acceleration structure memory when
using the host commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>The <a href="#vkBuildAccelerationStructureKHR">vkBuildAccelerationStructureKHR</a> and
<a href="#vkCmdBuildAccelerationStructureKHR">vkCmdBuildAccelerationStructureKHR</a> <strong class="purple">may</strong> use different algorithms, and
thus are not required to produce identical structures.
The structures produced by these two commands <strong class="purple">may</strong> exhibit different memory
footprints or traversal performance, but should strive to be similar where
possible.</p>
</div>
<div class="paragraph">
<p>Apart from these details, the host and device operations are interchangable.
For example, an application <strong class="purple">can</strong> use <a href="#vkBuildAccelerationStructureKHR">vkBuildAccelerationStructureKHR</a>
to build a structure, compact it on the device using
<a href="#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a>, and serialize the result using
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To build acceleration structures on the host, call:</p>
</div>
<div id="vkBuildAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
VkResult vkBuildAccelerationStructureKHR(
    VkDevice                                    device,
    uint32_t                                    infoCount,
    <span class="directive">const</span> VkAccelerationStructureBuildGeometryInfoKHR* pInfos,
    <span class="directive">const</span> VkAccelerationStructureBuildOffsetInfoKHR* <span class="directive">const</span>* ppOffsetInfos);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdBuildAccelerationStructureKHR">vkCmdBuildAccelerationStructureKHR</a> but executed by the host.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the <code>VkDevice</code> for which the acceleration structures
are being built.</p>
</li>
<li>
<p><code>infoCount</code> is the number of acceleration structures to build.
It specifies the number of the <code>pInfos</code> structures and
<code>ppOffsetInfos</code> pointers that <strong class="purple">must</strong> be provided.</p>
</li>
<li>
<p><code>pInfos</code> is a pointer to an array of <code>infoCount</code>
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures defining
the geometry used to build each acceleration structure.</p>
</li>
<li>
<p><code>ppOffsetInfos</code> is an array of <code>infoCount</code> pointers to arrays of
<a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures.
Each <code>ppOffsetInfos</code>[i] is an array of
<code>pInfos</code>[i].<code>geometryCount</code>
<a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures defining
dynamic offsets to the addresses where geometry data is stored, as
defined by <code>pInfos</code>[i].</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>vkBuildAccelerationStructureKHR</code> command provides the ability to
initiate multiple acceleration structures builds, however there is no
ordering or synchronization implied between any of the individual
acceleration structure builds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>This means that an application <strong class="purple">cannot</strong> build a top-level acceleration
structure in the same <a href="#vkBuildAccelerationStructureKHR">vkBuildAccelerationStructureKHR</a> call as the
associated bottom-level or instance acceleration structures are being built.
There also <strong class="purple">cannot</strong> be any memory aliasing between any acceleration structure
memories or scratch memories being used by any of the builds.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure is included in the
<code>pNext</code> chain of any <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>
structure, the operation of this command is <em>deferred</em>, as defined in the
<a href="chap33.html#deferred-host-operations">Deferred Host Operations</a> chapter.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pOffsetInfos-03402" href="#VUID-vkBuildAccelerationStructureKHR-pOffsetInfos-03402"></a>
Each element of <code>ppOffsetInfos</code>[i] <strong class="purple">must</strong> be a valid pointer to an
array of <code>pInfos</code>[i].<code>geometryCount</code>
<code>VkAccelerationStructureBuildOffsetInfoKHR</code> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pInfos-03403" href="#VUID-vkBuildAccelerationStructureKHR-pInfos-03403"></a>
Each <code>pInfos</code>[i].<code>srcAccelerationStructure</code> <strong class="purple">must</strong> not refer to
the same acceleration structure as any
<code>pInfos</code>[i].<code>dstAccelerationStructure</code> that is provided to the
same build command unless it is identical for an update</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pInfos-03404" href="#VUID-vkBuildAccelerationStructureKHR-pInfos-03404"></a>
For each <code>pInfos</code>[i], <code>dstAccelerationStructure</code> <strong class="purple">must</strong> have been
created with compatible <a href="chap11.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a> where
<a href="chap11.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>type</code> and
<a href="chap11.html#VkAccelerationStructureCreateInfoKHR">VkAccelerationStructureCreateInfoKHR</a>::<code>flags</code> are identical to
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>type</code> and
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>flags</code>
respectively,
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>geometryCount</code>
for <code>dstAccelerationStructure</code> are greater than or equal to the
build size, and each geometry in
<a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a>::<code>ppGeometries</code>
for <code>dstAccelerationStructure</code> has greater than or equal to the
number of vertices, indices, and AABBs,
<a href="#VkAccelerationStructureGeometryTrianglesDataKHR">VkAccelerationStructureGeometryTrianglesDataKHR</a>::<code>transformData</code>
is both 0 or both non-zero, and all other parameters are the same</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pInfos-03405" href="#VUID-vkBuildAccelerationStructureKHR-pInfos-03405"></a>
For each <code>pInfos</code>[i], if <code>update</code> is <code>VK_TRUE</code>, then objects
that were previously active for that acceleration structure <strong class="purple">must</strong> not be
made inactive as per <a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pInfos-03406" href="#VUID-vkBuildAccelerationStructureKHR-pInfos-03406"></a>
For each <code>pInfos</code>[i], if <code>update</code> is <code>VK_TRUE</code>, then objects
that were previously inactive for that acceleration structure <strong class="purple">must</strong> not
be made active as per <a href="#acceleration-structure-inactive-prims">Inactive Primitives and Instances</a></p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-None-03407" href="#VUID-vkBuildAccelerationStructureKHR-None-03407"></a>
Any acceleration structure instance in any top level build in this
command <strong class="purple">must</strong> not reference any bottom level acceleration structure
built by this command</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pInfos-03408" href="#VUID-vkBuildAccelerationStructureKHR-pInfos-03408"></a>
There <strong class="purple">must</strong> not be any <a href="chap11.html#resources-memory-aliasing">memory aliasing</a>
between the scratch memories that are provided in all the
<code>pInfos</code>[i].<code>scratchData</code> memories for the acceleration
structure builds</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-None-03409" href="#VUID-vkBuildAccelerationStructureKHR-None-03409"></a>
There <strong class="purple">must</strong> not be any <a href="chap11.html#resources-memory-aliasing">memory aliasing</a>
between memory bound to any top level, bottom level, or instance
acceleration structure accessed by this command</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-None-03437" href="#VUID-vkBuildAccelerationStructureKHR-None-03437"></a>
All <a href="#VkDeviceOrHostAddressKHR">VkDeviceOrHostAddressKHR</a> or
<a href="#VkDeviceOrHostAddressConstKHR">VkDeviceOrHostAddressConstKHR</a> referenced by this command <strong class="purple">must</strong>
contain valid host addresses</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-None-03438" href="#VUID-vkBuildAccelerationStructureKHR-None-03438"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to host-visible memory</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-rayTracingHostAccelerationStructureCommands-03439" href="#VUID-vkBuildAccelerationStructureKHR-rayTracingHostAccelerationStructureCommands-03439"></a>
The <a href="chap38.html#feature-raytracing-hostascmds"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingHostAccelerationStructureCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-device-parameter" href="#VUID-vkBuildAccelerationStructureKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap4.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-pInfos-parameter" href="#VUID-vkBuildAccelerationStructureKHR-pInfos-parameter"></a> <code>pInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> valid <a href="#VkAccelerationStructureBuildGeometryInfoKHR">VkAccelerationStructureBuildGeometryInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-ppOffsetInfos-parameter" href="#VUID-vkBuildAccelerationStructureKHR-ppOffsetInfos-parameter"></a> <code>ppOffsetInfos</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>infoCount</code> <a href="#VkAccelerationStructureBuildOffsetInfoKHR">VkAccelerationStructureBuildOffsetInfoKHR</a> structures</p>
</li>
<li>
<p><a id="VUID-vkBuildAccelerationStructureKHR-infoCount-arraylength" href="#VUID-vkBuildAccelerationStructureKHR-infoCount-arraylength"></a> <code>infoCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To copy or compact an acceleration structure on the host, call:</p>
</div>
<div id="vkCopyAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
VkResult vkCopyAccelerationStructureKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkCopyAccelerationStructureInfoKHR*   pInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdCopyAccelerationStructureKHR">vkCmdCopyAccelerationStructureKHR</a> but executed by the host.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the acceleration structures.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a>
structure defining the copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure is included in the
<code>pNext</code> chain of the <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure,
the operation of this command is <em>deferred</em>, as defined in the
<a href="chap33.html#deferred-host-operations">Deferred Host Operations</a> chapter.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-None-03440" href="#VUID-vkCopyAccelerationStructureKHR-None-03440"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to host-visible memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-rayTracingHostAccelerationStructureCommands-03441" href="#VUID-vkCopyAccelerationStructureKHR-rayTracingHostAccelerationStructureCommands-03441"></a>
the <a href="chap38.html#feature-raytracing-hostascmds"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingHostAccelerationStructureCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-device-parameter" href="#VUID-vkCopyAccelerationStructureKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap4.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCopyAccelerationStructureKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureInfoKHR">VkCopyAccelerationStructureInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="vkCopyMemoryToAccelerationStructureKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
VkResult vkCopyMemoryToAccelerationStructureKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkCopyMemoryToAccelerationStructureInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> but is executed by the host.</p>
</div>
<div class="paragraph">
<p>This command can accept acceleration structures produced by either
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> or
<a href="#vkCopyAccelerationStructureToMemoryKHR">vkCopyAccelerationStructureToMemoryKHR</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;dst</code>.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure is included in the
<code>pNext</code> chain of the <a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a>
structure, the operation of this command is <em>deferred</em>, as defined in the
<a href="chap33.html#deferred-host-operations">Deferred Host Operations</a> chapter.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-None-03442" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-None-03442"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to host-visible memory</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-None-03443" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-None-03443"></a>
All <code>VkDeviceOrHostAddressConstKHR</code> referenced by this command <strong class="purple">must</strong>
contain valid host pointers</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-rayTracingHostAccelerationStructureCommands-03444" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-rayTracingHostAccelerationStructureCommands-03444"></a>
the <a href="chap38.html#feature-raytracing-hostascmds"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingHostAccelerationStructureCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap4.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter" href="#VUID-vkCopyMemoryToAccelerationStructureKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyMemoryToAccelerationStructureInfoKHR">VkCopyMemoryToAccelerationStructureInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="vkCopyAccelerationStructureToMemoryKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
VkResult vkCopyAccelerationStructureToMemoryKHR(
    VkDevice                                    device,
    <span class="directive">const</span> VkCopyAccelerationStructureToMemoryInfoKHR* pInfo);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a> but executed by the host.</p>
</div>
<div class="paragraph">
<p>This command produces the same results as
<a href="#vkCmdCopyAccelerationStructureToMemoryKHR">vkCmdCopyAccelerationStructureToMemoryKHR</a>, but writes its result
directly to a host pointer, and is executed on the host rather than the
device.
The output <strong class="purple">may</strong> not necessarily be bit-for-bit identical, but it can be
equally used by either <a href="#vkCmdCopyMemoryToAccelerationStructureKHR">vkCmdCopyMemoryToAccelerationStructureKHR</a> or
<a href="#vkCopyMemoryToAccelerationStructureKHR">vkCopyMemoryToAccelerationStructureKHR</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns <code>pInfo-&gt;src</code>.</p>
</li>
<li>
<p><code>pInfo</code> is a pointer to a
<a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure defining the
copy operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="chap33.html#VkDeferredOperationInfoKHR">VkDeferredOperationInfoKHR</a> structure is included in the
<code>pNext</code> chain of the <a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a>
structure, the operation of this command is <em>deferred</em>, as defined in the
<a href="chap33.html#deferred-host-operations">Deferred Host Operations</a> chapter.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-None-03445" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-None-03445"></a>
All <code>VkAccelerationStructureKHR</code> objects referenced by this command
<strong class="purple">must</strong> be bound to host-visible memory</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-None-03446" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-None-03446"></a>
All <code>VkDeviceOrHostAddressKHR</code> referenced by this command <strong class="purple">must</strong>
contain valid host pointers</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-rayTracingHostAccelerationStructureCommands-03447" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-rayTracingHostAccelerationStructureCommands-03447"></a>
the <a href="chap38.html#feature-raytracing-hostascmds"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingHostAccelerationStructureCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap4.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter" href="#VUID-vkCopyAccelerationStructureToMemoryKHR-pInfo-parameter"></a> <code>pInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="#VkCopyAccelerationStructureToMemoryInfoKHR">VkCopyAccelerationStructureToMemoryInfoKHR</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_OPERATION_DEFERRED_KHR</code></p>
</li>
<li>
<p><code>VK_OPERATION_NOT_DEFERRED_KHR</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="vkWriteAccelerationStructuresPropertiesKHR" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="comment">// Provided by VK_KHR_ray_tracing</span>
VkResult vkWriteAccelerationStructuresPropertiesKHR(
    VkDevice                                    device,
    uint32_t                                    accelerationStructureCount,
    <span class="directive">const</span> VkAccelerationStructureKHR*           pAccelerationStructures,
    VkQueryType                                 queryType,
    size_t                                      dataSize,
    <span class="directive">void</span>*                                       pData,
    size_t                                      stride);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command fulfills the same task as
<a href="#vkCmdWriteAccelerationStructuresPropertiesKHR">vkCmdWriteAccelerationStructuresPropertiesKHR</a> but executed by the
host.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the device which owns the acceleration structures in
<code>pAccelerationStructures</code>.</p>
</li>
<li>
<p><code>accelerationStructureCount</code> is the count of acceleration structures
for which to query the property.</p>
</li>
<li>
<p><code>pAccelerationStructures</code> points to an array of existing previously
built acceleration structures.</p>
</li>
<li>
<p><code>queryType</code> is a <a href="chap17.html#VkQueryType">VkQueryType</a> value specifying the property to
be queried.</p>
</li>
<li>
<p><code>dataSize</code> is the size in bytes of the buffer pointed to by
<code>pData</code>.</p>
</li>
<li>
<p><code>pData</code> is a pointer to a user-allocated buffer where the results
will be written.</p>
</li>
<li>
<p><code>stride</code> is the stride in bytes between results for individual
queries within <code>pData</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03448"></a>
If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then
<code>stride</code> <strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03449"></a>
If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code>, then
<code>data</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03450"></a>
If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
<code>stride</code> <strong class="purple">must</strong> be a multiple of the size of <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03451"></a>
If <code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code>, then
<code>data</code> <strong class="purple">must</strong> point to a <code>VkDeviceSize</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-03452"></a>
<code>dataSize</code> <strong class="purple">must</strong> be greater than or equal to
<span class="eq"><code>accelerationStructureCount</code>*<code>stride</code></span></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-03453" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-03453"></a>
The acceleration structures referenced by <code>pAccelerationStructures</code>
<strong class="purple">must</strong> be bound to host-visible memory</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructures-03431"></a>
All acceleration structures in <code>accelerationStructures</code> <strong class="purple">must</strong> have
been built with
<code>VK_BUILD_ACCELERATION_STRUCTURE_ALLOW_COMPACTION_BIT_KHR</code> if
<code>queryType</code> is
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03432" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-03432"></a>
<code>queryType</code> <strong class="purple">must</strong> be
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_COMPACTED_SIZE_KHR</code> or
<code>VK_QUERY_TYPE_ACCELERATION_STRUCTURE_SERIALIZATION_SIZE_KHR</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-rayTracingHostAccelerationStructureCommands-03454" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-rayTracingHostAccelerationStructureCommands-03454"></a>
the <a href="chap38.html#feature-raytracing-hostascmds"><code>VkPhysicalDeviceRayTracingFeaturesKHR</code>::<code>rayTracingHostAccelerationStructureCommands</code></a>
feature <strong class="purple">must</strong> be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-device-parameter"></a> <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap4.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parameter"></a> <code>pAccelerationStructures</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>accelerationStructureCount</code> valid <a href="chap11.html#VkAccelerationStructureKHR">VkAccelerationStructureKHR</a> handles</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-queryType-parameter"></a> <code>queryType</code> <strong class="purple">must</strong> be a valid <a href="chap17.html#VkQueryType">VkQueryType</a> value</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pData-parameter"></a> <code>pData</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>dataSize</code> bytes</p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-accelerationStructureCount-arraylength"></a> <code>accelerationStructureCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-dataSize-arraylength"></a> <code>dataSize</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent" href="#VUID-vkWriteAccelerationStructuresPropertiesKHR-pAccelerationStructures-parent"></a> Each element of <code>pAccelerationStructures</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap2.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap2.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div id="footer">
<div id="footer-text">
Version 1.2.144<br>
Last updated 2020-06-08 03:48:42 -0700
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>


</body>
</html>