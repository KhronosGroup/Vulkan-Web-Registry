<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="The Khronos® Vulkan Working Group">
<title>Vulkan® 1.1.205 - A Specification</title>
<link rel="stylesheet" href="style0.css" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="style1.css" type="text/css">
<link rel="stylesheet" href="style2.css" type="text/css">

<!-- dragged in by font-awesome css included by asciidoctor, but preloaded in this extension for convenience -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as="font" type="font/woff2" crossorigin="">

<!-- Note: Chrome needs crossorigin="" even for same-origin fonts -->
<link rel="preload" href="../katex/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="preload" href="../katex/fonts/KaTeX_Typewriter-Regular.woff2" as="font" type="font/woff2" crossorigin=""><link rel="stylesheet" href="../katex/katex.min.css">
<!--ChunkedSearchJSMarker-->
<link href="chunked.css?4" rel="stylesheet">
<script>var searchindexurl = 'search.index.js?4' + (document.title.replace(/[^0-9.]/g, ''));</script>
<script src="chunked.js?4"></script>
<link rel="stylesheet" href="style3.css" type="text/css">
<script>
    function hideElement(e){
        e.setAttribute("hidden", "");
        e.classList.add("hidden");
    }

    function unhideElement(e){
        e.classList.remove("hidden");
        e.removeAttribute("hidden");
    }

    function hideLoadableContent(){
        unhideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) hideElement(loadable);
    }

    function unhideLoadableContent(){
        hideElement( document.getElementById("loading_msg") );
        for( var loadable of document.getElementsByClassName("loadable") ) unhideElement(loadable);
    }

    window.addEventListener("load", unhideLoadableContent);
</script>
<link rel="stylesheet" href="asciidoctor-chunker.css" type="text/css"></head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Vulkan<sup>®</sup> 1.1.205 - A Specification </h1>
<div class="details">
<span id="author" class="author">The Khronos<sup>®</sup> Vulkan Working Group</span><br>
<span id="revnumber">version 1.1.205,</span>
<span id="revdate">2022-02-04 11:32:43Z</span>
<br><span id="revremark">from git branch: github-main commit: 9e4c847a9e93cccd5f46e173c3ccf752b89c35df</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="index.html">Titlepage</a></li><li><a href="chap1.html">1. Preamble</a></li>
<li><a href="chap2.html">2. Introduction</a>
<ul class="sectlevel2">
<li><a href="chap2.html#introduction-conventions">2.1. Document Conventions</a></li>
</ul>
</li>
<li><a href="chap3.html">3. Fundamentals</a>
<ul class="sectlevel2">
<li><a href="chap3.html#fundamentals-host-environment">3.1. Host and Device Environment</a></li>
<li><a href="chap3.html#fundamentals-execmodel">3.2. Execution Model</a></li>
<li><a href="chap3.html#fundamentals-objectmodel-overview">3.3. Object Model</a></li>
<li><a href="chap3.html#fundamentals-abi">3.4. Application Binary Interface</a></li>
<li><a href="chap3.html#fundamentals-commandsyntax">3.5. Command Syntax and Duration</a></li>
<li><a href="chap3.html#fundamentals-threadingbehavior">3.6. Threading Behavior</a></li>
<li><a href="chap3.html#fundamentals-validusage">3.7. Valid Usage</a></li>
<li><a href="chap3.html#fundamentals-returncodes">3.8. <code>VkResult</code> Return Codes</a></li>
<li><a href="chap3.html#fundamentals-numerics">3.9. Numeric Representation and Computation</a></li>
<li><a href="chap3.html#fundamentals-fixedconv">3.10. Fixed-Point Data Conversions</a></li>
<li><a href="chap3.html#fundamentals-common-objects">3.11. Common Object Types</a></li>
<li><a href="chap3.html#fundamentals-api-name-aliases">3.12. API Name Aliases</a></li>
</ul>
</li>
<li><a href="chap4.html">4. Initialization</a>
<ul class="sectlevel2">
<li><a href="chap4.html#initialization-functionpointers">4.1. Command Function Pointers</a></li>
<li><a href="chap4.html#initialization-instances">4.2. Instances</a></li>
</ul>
</li>
<li><a href="chap5.html">5. Devices and Queues</a>
<ul class="sectlevel2">
<li><a href="chap5.html#devsandqueues-physical-device-enumeration">5.1. Physical Devices</a></li>
<li><a href="chap5.html#devsandqueues-devices">5.2. Devices</a></li>
<li><a href="chap5.html#devsandqueues-queues">5.3. Queues</a></li>
</ul>
</li>
<li><a href="chap6.html">6. Command Buffers</a>
<ul class="sectlevel2">
<li><a href="chap6.html#commandbuffers-lifecycle">6.1. Command Buffer Lifecycle</a></li>
<li><a href="chap6.html#commandbuffers-pools">6.2. Command Pools</a></li>
<li><a href="chap6.html#commandbuffer-allocation">6.3. Command Buffer Allocation and Management</a></li>
<li><a href="chap6.html#commandbuffers-recording">6.4. Command Buffer Recording</a></li>
<li><a href="chap6.html#commandbuffers-submission">6.5. Command Buffer Submission</a></li>
<li><a href="chap6.html#commandbuffers-submission-progress">6.6. Queue Forward Progress</a></li>
<li><a href="chap6.html#commandbuffers-secondary">6.7. Secondary Command Buffer Execution</a></li>
<li><a href="chap6.html#commandbuffers-devicemask">6.8. Command Buffer Device Mask</a></li>
</ul>
</li>
<li class="current"><a href="chap7.html">7. Synchronization and Cache Control</a>
<ul class="sectlevel2">
<li class="current"><a href="chap7.html#synchronization-dependencies">7.1. Execution and Memory Dependencies</a></li>
<li class="current"><a href="chap7.html#synchronization-implicit">7.2. Implicit Synchronization Guarantees</a></li>
<li class="current"><a href="chap7.html#synchronization-fences">7.3. Fences</a></li>
<li class="current"><a href="chap7.html#synchronization-semaphores">7.4. Semaphores</a></li>
<li class="current"><a href="chap7.html#synchronization-events">7.5. Events</a></li>
<li class="current"><a href="chap7.html#synchronization-pipeline-barriers">7.6. Pipeline Barriers</a></li>
<li class="current"><a href="chap7.html#synchronization-memory-barriers">7.7. Memory Barriers</a></li>
<li class="current"><a href="chap7.html#synchronization-wait-idle">7.8. Wait Idle Operations</a></li>
<li class="current"><a href="chap7.html#synchronization-submission-host-writes">7.9. Host Write Ordering Guarantees</a></li>
<li class="current"><a href="chap7.html#synchronization-device-group">7.10. Synchronization and Multiple Physical Devices</a></li>
</ul>
</li>
<li><a href="chap8.html">8. Render Pass</a>
<ul class="sectlevel2">
<li><a href="chap8.html#renderpass-creation">8.1. Render Pass Creation</a></li>
<li><a href="chap8.html#renderpass-compatibility">8.2. Render Pass Compatibility</a></li>
<li><a href="chap8.html#_framebuffers">8.3. Framebuffers</a></li>
<li><a href="chap8.html#renderpass-commands">8.4. Render Pass Commands</a></li>
</ul>
</li>
<li><a href="chap9.html">9. Shaders</a>
<ul class="sectlevel2">
<li><a href="chap9.html#shader-modules">9.1. Shader Modules</a></li>
<li><a href="chap9.html#shaders-execution">9.2. Shader Execution</a></li>
<li><a href="chap9.html#shaders-execution-memory-ordering">9.3. Shader Memory Access Ordering</a></li>
<li><a href="chap9.html#shaders-inputs">9.4. Shader Inputs and Outputs</a></li>
<li><a href="chap9.html#shaders-vertex">9.5. Vertex Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-control">9.6. Tessellation Control Shaders</a></li>
<li><a href="chap9.html#shaders-tessellation-evaluation">9.7. Tessellation Evaluation Shaders</a></li>
<li><a href="chap9.html#shaders-geometry">9.8. Geometry Shaders</a></li>
<li><a href="chap9.html#shaders-fragment">9.9. Fragment Shaders</a></li>
<li><a href="chap9.html#shaders-compute">9.10. Compute Shaders</a></li>
<li><a href="chap9.html#shaders-interpolation-decorations">9.11. Interpolation Decorations</a></li>
<li><a href="chap9.html#shaders-staticuse">9.12. Static Use</a></li>
<li><a href="chap9.html#shaders-scope">9.13. Scope</a></li>
<li><a href="chap9.html#shaders-group-operations">9.14. Group Operations</a></li>
<li><a href="chap9.html#shaders-quad-operations">9.15. Quad Group Operations</a></li>
<li><a href="chap9.html#shaders-derivative-operations">9.16. Derivative Operations</a></li>
<li><a href="chap9.html#shaders-helper-invocations">9.17. Helper Invocations</a></li>
</ul>
</li>
<li><a href="chap10.html">10. Pipelines</a>
<ul class="sectlevel2">
<li><a href="chap10.html#pipelines-compute">10.1. Compute Pipelines</a></li>
<li><a href="chap10.html#pipelines-graphics">10.2. Graphics Pipelines</a></li>
<li><a href="chap10.html#pipelines-destruction">10.3. Pipeline Destruction</a></li>
<li><a href="chap10.html#pipelines-multiple">10.4. Multiple Pipeline Creation</a></li>
<li><a href="chap10.html#pipelines-pipeline-derivatives">10.5. Pipeline Derivatives</a></li>
<li><a href="chap10.html#pipelines-cache">10.6. Pipeline Cache</a></li>
<li><a href="chap10.html#pipelines-specialization-constants">10.7. Specialization Constants</a></li>
<li><a href="chap10.html#pipelines-binding">10.8. Pipeline Binding</a></li>
<li><a href="chap10.html#pipelines-dynamic-state">10.9. Dynamic State</a></li>
</ul>
</li>
<li><a href="chap11.html">11. Memory Allocation</a>
<ul class="sectlevel2">
<li><a href="chap11.html#memory-host">11.1. Host Memory</a></li>
<li><a href="chap11.html#memory-device">11.2. Device Memory</a></li>
</ul>
</li>
<li><a href="chap12.html">12. Resource Creation</a>
<ul class="sectlevel2">
<li><a href="chap12.html#resources-buffers">12.1. Buffers</a></li>
<li><a href="chap12.html#resources-buffer-views">12.2. Buffer Views</a></li>
<li><a href="chap12.html#resources-images">12.3. Images</a></li>
<li><a href="chap12.html#resources-image-layouts">12.4. Image Layouts</a></li>
<li><a href="chap12.html#resources-image-views">12.5. Image Views</a></li>
<li><a href="chap12.html#resources-association">12.6. Resource Memory Association</a></li>
<li><a href="chap12.html#resources-sharing">12.7. Resource Sharing Mode</a></li>
<li><a href="chap12.html#resources-memory-aliasing">12.8. Memory Aliasing</a></li>
</ul>
</li>
<li><a href="chap13.html">13. Samplers</a>
<ul class="sectlevel2">
<li><a href="chap13.html#samplers-YCbCr-conversion">13.1. Sampler Y′C<sub>B</sub>C<sub>R</sub> conversion</a></li>
</ul>
</li>
<li><a href="chap14.html">14. Resource Descriptors</a>
<ul class="sectlevel2">
<li><a href="chap14.html#descriptorsets-types">14.1. Descriptor Types</a></li>
<li><a href="chap14.html#descriptorsets-sets">14.2. Descriptor Sets</a></li>
</ul>
</li>
<li><a href="chap15.html">15. Shader Interfaces</a>
<ul class="sectlevel2">
<li><a href="chap15.html#interfaces-iointerfaces">15.1. Shader Input and Output Interfaces</a></li>
<li><a href="chap15.html#interfaces-vertexinput">15.2. Vertex Input Interface</a></li>
<li><a href="chap15.html#interfaces-fragmentoutput">15.3. Fragment Output Interface</a></li>
<li><a href="chap15.html#interfaces-inputattachment">15.4. Fragment Input Attachment Interface</a></li>
<li><a href="chap15.html#interfaces-resources">15.5. Shader Resource Interface</a></li>
<li><a href="chap15.html#interfaces-builtin-variables">15.6. Built-In Variables</a></li>
</ul>
</li>
<li><a href="chap16.html">16. Image Operations</a>
<ul class="sectlevel2">
<li><a href="chap16.html#_image_operations_overview">16.1. Image Operations Overview</a></li>
<li><a href="chap16.html#_conversion_formulas">16.2. Conversion Formulas</a></li>
<li><a href="chap16.html#_texel_input_operations">16.3. Texel Input Operations</a></li>
<li><a href="chap16.html#_texel_output_operations">16.4. Texel Output Operations</a></li>
<li><a href="chap16.html#textures-normalized-operations">16.5. Normalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#_unnormalized_texel_coordinate_operations">16.6. Unnormalized Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-integer-coordinate-operations">16.7. Integer Texel Coordinate Operations</a></li>
<li><a href="chap16.html#textures-sample-operations">16.8. Image Sample Operations</a></li>
<li><a href="chap16.html#textures-instructions">16.9. Image Operation Steps</a></li>
<li><a href="chap16.html#textures-queries">16.10. Image Query Instructions</a></li>
</ul>
</li>
<li><a href="chap17.html">17. Queries</a>
<ul class="sectlevel2">
<li><a href="chap17.html#queries-pools">17.1. Query Pools</a></li>
<li><a href="chap17.html#queries-operation">17.2. Query Operation</a></li>
<li><a href="chap17.html#queries-occlusion">17.3. Occlusion Queries</a></li>
<li><a href="chap17.html#queries-pipestats">17.4. Pipeline Statistics Queries</a></li>
<li><a href="chap17.html#queries-timestamps">17.5. Timestamp Queries</a></li>
</ul>
</li>
<li><a href="chap18.html">18. Clear Commands</a>
<ul class="sectlevel2">
<li><a href="chap18.html#clears-outside">18.1. Clearing Images Outside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-inside">18.2. Clearing Images Inside A Render Pass Instance</a></li>
<li><a href="chap18.html#clears-values">18.3. Clear Values</a></li>
<li><a href="chap18.html#clears-filling-buffers">18.4. Filling Buffers</a></li>
<li><a href="chap18.html#clears-updating-buffers">18.5. Updating Buffers</a></li>
</ul>
</li>
<li><a href="chap19.html">19. Copy Commands</a>
<ul class="sectlevel2">
<li><a href="chap19.html#_common_operation">19.1. Common Operation</a></li>
<li><a href="chap19.html#copies-buffers">19.2. Copying Data Between Buffers</a></li>
<li><a href="chap19.html#copies-images">19.3. Copying Data Between Images</a></li>
<li><a href="chap19.html#copies-buffers-images">19.4. Copying Data Between Buffers and Images</a></li>
<li><a href="chap19.html#copies-imagescaling">19.5. Image Copies with Scaling</a></li>
<li><a href="chap19.html#copies-resolve">19.6. Resolving Multisample Images</a></li>
</ul>
</li>
<li><a href="chap20.html">20. Drawing Commands</a>
<ul class="sectlevel2">
<li><a href="chap20.html#drawing-primitive-topologies">20.1. Primitive Topologies</a></li>
<li><a href="chap20.html#drawing-primitive-order">20.2. Primitive Order</a></li>
<li><a href="chap20.html#drawing-primitive-shading">20.3. Programmable Primitive Shading</a></li>
</ul>
</li>
<li><a href="chap21.html">21. Fixed-Function Vertex Processing</a>
<ul class="sectlevel2">
<li><a href="chap21.html#fxvertex-attrib">21.1. Vertex Attributes</a></li>
<li><a href="chap21.html#fxvertex-input">21.2. Vertex Input Description</a></li>
<li><a href="chap21.html#fxvertex-input-address-calculation">21.3. Vertex Input Address Calculation</a></li>
</ul>
</li>
<li><a href="chap22.html">22. Tessellation</a>
<ul class="sectlevel2">
<li><a href="chap22.html#_tessellator">22.1. Tessellator</a></li>
<li><a href="chap22.html#_tessellator_patch_discard">22.2. Tessellator Patch Discard</a></li>
<li><a href="chap22.html#tessellation-tessellator-spacing">22.3. Tessellator Spacing</a></li>
<li><a href="chap22.html#tessellation-primitive-order">22.4. Tessellation Primitive Ordering</a></li>
<li><a href="chap22.html#tessellation-vertex-winding-order">22.5. Tessellator Vertex Winding Order</a></li>
<li><a href="chap22.html#tessellation-triangle-tessellation">22.6. Triangle Tessellation</a></li>
<li><a href="chap22.html#tessellation-quad-tessellation">22.7. Quad Tessellation</a></li>
<li><a href="chap22.html#tessellation-isoline-tessellation">22.8. Isoline Tessellation</a></li>
<li><a href="chap22.html#tessellation-point-mode">22.9. Tessellation Point Mode</a></li>
<li><a href="chap22.html#_tessellation_pipeline_state">22.10. Tessellation Pipeline State</a></li>
</ul>
</li>
<li><a href="chap23.html">23. Geometry Shading</a>
<ul class="sectlevel2">
<li><a href="chap23.html#geometry-input">23.1. Geometry Shader Input Primitives</a></li>
<li><a href="chap23.html#geometry-output">23.2. Geometry Shader Output Primitives</a></li>
<li><a href="chap23.html#geometry-invocations">23.3. Multiple Invocations of Geometry Shaders</a></li>
<li><a href="chap23.html#geometry-ordering">23.4. Geometry Shader Primitive Ordering</a></li>
</ul>
</li>
<li><a href="chap24.html">24. Fixed-Function Vertex Post-Processing</a>
<ul class="sectlevel2">
<li><a href="chap24.html#vertexpostproc-flatshading">24.1. Flat Shading</a></li>
<li><a href="chap24.html#vertexpostproc-clipping">24.2. Primitive Clipping</a></li>
<li><a href="chap24.html#vertexpostproc-clipping-shader-outputs">24.3. Clipping Shader Outputs</a></li>
<li><a href="chap24.html#vertexpostproc-coord-transform">24.4. Coordinate Transformations</a></li>
<li><a href="chap24.html#vertexpostproc-viewport">24.5. Controlling the Viewport</a></li>
</ul>
</li>
<li><a href="chap25.html">25. Rasterization</a>
<ul class="sectlevel2">
<li><a href="chap25.html#primsrast-discard">25.1. Discarding Primitives Before Rasterization</a></li>
<li><a href="chap25.html#primsrast-order">25.2. Rasterization Order</a></li>
<li><a href="chap25.html#primsrast-multisampling">25.3. Multisampling</a></li>
<li><a href="chap25.html#primsrast-sampleshading">25.4. Sample Shading</a></li>
<li><a href="chap25.html#primsrast-points">25.5. Points</a></li>
<li><a href="chap25.html#primsrast-lines">25.6. Line Segments</a></li>
<li><a href="chap25.html#primsrast-polygons">25.7. Polygons</a></li>
</ul>
</li>
<li><a href="chap26.html">26. Fragment Operations</a>
<ul class="sectlevel2">
<li><a href="chap26.html#fragops-scissor">26.1. Scissor Test</a></li>
<li><a href="chap26.html#fragops-samplemask">26.2. Sample Mask Test</a></li>
<li><a href="chap26.html#fragops-shader">26.3. Fragment Shading</a></li>
<li><a href="chap26.html#fragops-covg">26.4. Multisample Coverage</a></li>
<li><a href="chap26.html#fragops-ds-state">26.5. Depth and Stencil Operations</a></li>
<li><a href="chap26.html#fragops-dbt">26.6. Depth Bounds Test</a></li>
<li><a href="chap26.html#fragops-stencil">26.7. Stencil Test</a></li>
<li><a href="chap26.html#fragops-depth">26.8. Depth Test</a></li>
<li><a href="chap26.html#fragops-samplecount">26.9. Sample Counting</a></li>
<li><a href="chap26.html#fragops-coverage-reduction">26.10. Coverage Reduction</a></li>
</ul>
</li>
<li><a href="chap27.html">27. The Framebuffer</a>
<ul class="sectlevel2">
<li><a href="chap27.html#framebuffer-blending">27.1. Blending</a></li>
<li><a href="chap27.html#framebuffer-logicop">27.2. Logical Operations</a></li>
<li><a href="chap27.html#framebuffer-color-write-mask">27.3. Color Write Mask</a></li>
</ul>
</li>
<li><a href="chap28.html">28. Dispatching Commands</a></li>
<li><a href="chap29.html">29. Sparse Resources</a>
<ul class="sectlevel2">
<li><a href="chap29.html#sparsememory-sparseresourcefeatures">29.1. Sparse Resource Features</a></li>
<li><a href="chap29.html#sparsememory-fully-resident">29.2. Sparse Buffers and Fully-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-buffers">29.3. Sparse Partially-Resident Buffers</a></li>
<li><a href="chap29.html#sparsememory-partially-resident-images">29.4. Sparse Partially-Resident Images</a></li>
<li><a href="chap29.html#sparsememory-sparse-memory-aliasing">29.5. Sparse Memory Aliasing</a></li>
<li><a href="chap29.html#_sparse_resource_implementation_guidelines_informative">29.6. Sparse Resource Implementation Guidelines (Informative)</a></li>
<li><a href="chap29.html#sparsememory-resourceapi">29.7. Sparse Resource API</a></li>
</ul>
</li>
<li><a href="chap30.html">30. Extending Vulkan</a>
<ul class="sectlevel2">
<li><a href="chap30.html#extendingvulkan-instanceanddevicefunctionality">30.1. Instance and Device Functionality</a></li>
<li><a href="chap30.html#extendingvulkan-coreversions">30.2. Core Versions</a></li>
<li><a href="chap30.html#extendingvulkan-layers">30.3. Layers</a></li>
<li><a href="chap30.html#extendingvulkan-extensions">30.4. Extensions</a></li>
<li><a href="chap30.html#extendingvulkan-extensions-extensiondependencies">30.5. Extension Dependencies</a></li>
<li><a href="chap30.html#_compatibility_guarantees_informative">30.6. Compatibility Guarantees (Informative)</a></li>
</ul>
</li>
<li><a href="chap31.html">31. Features</a>
<ul class="sectlevel2">
<li><a href="chap31.html#features-requirements">31.1. Feature Requirements</a></li>
</ul>
</li>
<li><a href="chap32.html">32. Limits</a>
<ul class="sectlevel2">
<li><a href="chap32.html#limits-minmax">32.1. Limit Requirements</a></li>
</ul>
</li>
<li><a href="chap33.html">33. Formats</a>
<ul class="sectlevel2">
<li><a href="chap33.html#formats-definition">33.1. Format Definition</a></li>
<li><a href="chap33.html#formats-properties">33.2. Format Properties</a></li>
<li><a href="chap33.html#features-required-format-support">33.3. Required Format Support</a></li>
</ul>
</li>
<li><a href="chap34.html">34. Additional Capabilities</a>
<ul class="sectlevel2">
<li><a href="chap34.html#capabilities-image">34.1. Additional Image Capabilities</a></li>
<li><a href="chap34.html#capabilities-buffer">34.2. Additional Buffer Capabilities</a></li>
<li><a href="chap34.html#capabilities-semaphore">34.3. Optional Semaphore Capabilities</a></li>
<li><a href="chap34.html#capabilities-fence">34.4. Optional Fence Capabilities</a></li>
</ul>
</li>
<li><a href="chap35.html">35. Debugging</a></li>
<li><a href="chap36.html">Appendix A: Vulkan Environment for SPIR-V</a>
<ul class="sectlevel2">
<li><a href="chap36.html#_versions_and_formats">Versions and Formats</a></li>
<li><a href="chap36.html#spirvenv-capabilities">Capabilities</a></li>
<li><a href="chap36.html#spirvenv-module-validation">Validation Rules within a Module</a></li>
<li><a href="chap36.html#spirvenv-precision-operation">Precision and Operation of SPIR-V Instructions</a></li>
<li><a href="chap36.html#spirvenv-image-signedness">Signedness of SPIR-V Image Accesses</a></li>
<li><a href="chap36.html#spirvenv-format-type-matching">Image Format and Type Matching</a></li>
<li><a href="chap36.html#spirvenv-image-formats">Compatibility Between SPIR-V Image Formats And Vulkan Formats</a></li>
</ul>
</li>
<li><a href="chap37.html">Appendix B: Compressed Image Formats</a>
<ul class="sectlevel2">
<li><a href="chap37.html#appendix-compressedtex-bc">Block-Compressed Image Formats</a></li>
<li><a href="chap37.html#appendix-compressedtex-etc2">ETC Compressed Image Formats</a></li>
<li><a href="chap37.html#appendix-compressedtex-astc">ASTC Compressed Image Formats</a></li>
</ul>
</li>
<li><a href="chap38.html">Appendix C: Core Revisions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap38.html#versions-1.1">Version 1.1</a></li>
<li><a href="chap38.html#versions-1.0">Version 1.0</a></li>
</ul>
</li>
<li><a href="chap39.html">Appendix D: Layers &amp; Extensions (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap39.html#extension-appendices-list">List of Extensions</a></li>
</ul>
</li>
<li><a href="chap40.html">Appendix E: API Boilerplate</a>
<ul class="sectlevel2">
<li><a href="chap40.html#boilerplate-headers">Vulkan Header Files</a></li>
<li><a href="chap40.html#boilerplate-wsi-header">Window System-Specific Header Control (Informative)</a></li>
<li><a href="chap40.html#boilerplate-provisional-header">Provisional Extension Header Control (Informative)</a></li>
</ul>
</li>
<li><a href="chap41.html">Appendix F: Invariance</a>
<ul class="sectlevel2">
<li><a href="chap41.html#_repeatability">Repeatability</a></li>
<li><a href="chap41.html#_multi_pass_algorithms">Multi-pass Algorithms</a></li>
<li><a href="chap41.html#_invariance_rules">Invariance Rules</a></li>
<li><a href="chap41.html#_tessellation_invariance">Tessellation Invariance</a></li>
</ul>
</li>
<li><a href="chap42.html">Appendix G: Lexicon</a>
<ul class="sectlevel2">
<li><a href="chap42.html#glossary">Glossary</a></li>
<li><a href="chap42.html#lexicon-common-abbreviations">Common Abbreviations</a></li>
<li><a href="chap42.html#lexicon-prefixes">Prefixes</a></li>
</ul>
</li>
<li><a href="chap43.html">Appendix H: Credits (Informative)</a>
<ul class="sectlevel2">
<li><a href="chap43.html#_working_group_contributors_to_vulkan">Working Group Contributors to Vulkan</a></li>
<li><a href="chap43.html#_other_credits">Other Credits</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="loading_msg" class="hidden" hidden=""><p>Loading… please wait.</p></div>
<!--ChunkedSearchboxMarker-->
<div class="searchbox"><label for="searchbox">Search: </label><input id="searchbox" type="text" disabled="disabled" value="Loading Search Data"><div id="resultsdiv"><ol id="results"></ol></div></div>
<div id="content" class="loadable"><div class="sect1">
<h2 id="synchronization"><a class="anchor" href="chap7.html"></a>7. Synchronization and Cache Control</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Synchronization of access to resources is primarily the responsibility of
the application in Vulkan.
The order of execution of commands with respect to the host and other
commands on the device has few implicit guarantees, and needs to be
explicitly specified.
Memory caches and other optimizations are also explicitly managed, requiring
that the flow of data through the system is largely under application
control.</p>
</div>
<div class="paragraph">
<p>Whilst some implicit guarantees exist between commands, five explicit
synchronization mechanisms are exposed by Vulkan:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap7.html#synchronization-fences">Fences</a></dt>
<dd>
<p>Fences <strong class="purple">can</strong> be used to communicate to the host that execution of some
task on the device has completed.</p>
</dd>
<dt class="hdlist1"><a href="chap7.html#synchronization-semaphores">Semaphores</a></dt>
<dd>
<p>Semaphores <strong class="purple">can</strong> be used to control resource access across multiple
queues.</p>
</dd>
<dt class="hdlist1"><a href="chap7.html#synchronization-events">Events</a></dt>
<dd>
<p>Events provide a fine-grained synchronization primitive which <strong class="purple">can</strong> be
signaled either within a command buffer or by the host, and <strong class="purple">can</strong> be
waited upon within a command buffer or queried on the host.</p>
</dd>
<dt class="hdlist1"><a href="chap7.html#synchronization-pipeline-barriers">Pipeline Barriers</a></dt>
<dd>
<p>Pipeline barriers also provide synchronization control within a command
buffer, but at a single point, rather than with separate signal and wait
operations.</p>
</dd>
<dt class="hdlist1"><a href="chap8.html">Render Passes</a></dt>
<dd>
<p>Render passes provide a useful synchronization framework for most
rendering tasks, built upon the concepts in this chapter.
Many cases that would otherwise need an application to use other
synchronization primitives <strong class="purple">can</strong> be expressed more efficiently as part of
a render pass.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="synchronization-dependencies"><a class="anchor" href="chap7.html#synchronization-dependencies"></a>7.1. Execution and Memory Dependencies</h3>
<div class="paragraph">
<p>An <em>operation</em> is an arbitrary amount of work to be executed on the host, a
device, or an external entity such as a presentation engine.
Synchronization commands introduce explicit <em>execution dependencies</em>, and
<em>memory dependencies</em> between two sets of operations defined by the
command’s two <em>synchronization scopes</em>.</p>
</div>
<div id="synchronization-dependencies-scopes" class="paragraph">
<p>The synchronization scopes define which other operations a synchronization
command is able to create execution dependencies with.
Any type of operation that is not in a synchronization command’s
synchronization scopes will not be included in the resulting dependency.
For example, for many synchronization commands, the synchronization scopes
<strong class="purple">can</strong> be limited to just operations executing in specific
<a href="chap7.html#synchronization-pipeline-stages">pipeline stages</a>, which allows other
pipeline stages to be excluded from a dependency.
Other scoping options are possible, depending on the particular command.</p>
</div>
<div id="synchronization-dependencies-execution" class="paragraph">
<p>An <em>execution dependency</em> is a guarantee that for two sets of operations,
the first set <strong class="purple">must</strong> <em>happen-before</em> the second set.
If an operation happens-before another operation, then the first operation
<strong class="purple">must</strong> complete before the second operation is initiated.
More precisely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>A</strong> and <strong>B</strong> be separate sets of operations.</p>
</li>
<li>
<p>Let <strong>S</strong> be a synchronization command.</p>
</li>
<li>
<p>Let <strong>A<sub>S</sub></strong> and <strong>B<sub>S</sub></strong> be the synchronization scopes of <strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>A'</strong> be the intersection of sets <strong>A</strong> and <strong>A<sub>S</sub></strong>.</p>
</li>
<li>
<p>Let <strong>B'</strong> be the intersection of sets <strong>B</strong> and <strong>B<sub>S</sub></strong>.</p>
</li>
<li>
<p>Submitting <strong>A</strong>, <strong>S</strong> and <strong>B</strong> for execution, in that order, will result in
execution dependency <strong>E</strong> between <strong>A'</strong> and <strong>B'</strong>.</p>
</li>
<li>
<p>Execution dependency <strong>E</strong> guarantees that <strong>A'</strong> happens-before <strong>B'</strong>.</p>
</li>
</ul>
</div>
<div id="synchronization-dependencies-chains" class="paragraph">
<p>An <em>execution dependency chain</em> is a sequence of execution dependencies that
form a happens-before relation between the first dependency’s <strong>A'</strong> and the
final dependency’s <strong>B'</strong>.
For each consecutive pair of execution dependencies, a chain exists if the
intersection of <strong>B<sub>S</sub></strong> in the first dependency and <strong>A<sub>S</sub></strong> in the second
dependency is not an empty set.
The formation of a single execution dependency from an execution dependency
chain can be described by substituting the following in the description of
execution dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>S</strong> be a set of synchronization commands that generate an execution
dependency chain.</p>
</li>
<li>
<p>Let <strong>A<sub>S</sub></strong> be the first synchronization scope of the first command in
<strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>B<sub>S</sub></strong> be the second synchronization scope of the last command in
<strong>S</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Execution dependencies alone are not sufficient to guarantee that values
resulting from writes in one set of operations <strong class="purple">can</strong> be read from another set
of operations.</p>
</div>
<div id="synchronization-dependencies-available-and-visible" class="paragraph">
<p>Three additional types of operations are used to control memory access.
<em>Availability operations</em> cause the values generated by specified memory
write accesses to become <em>available</em> to a memory domain for future access.
Any available value remains available until a subsequent write to the same
memory location occurs (whether it is made available or not) or the memory
is freed.
<em>Memory domain operations</em> cause writes that are available to a source
memory domain to become available to a destination memory domain (an example
of this is making writes available to the host domain available to the
device domain).
<em>Visibility operations</em> cause values available to a memory domain to become
<em>visible</em> to specified memory accesses.</p>
</div>
<div id="synchronization-dependencies-memory" class="paragraph">
<p>A <em>memory dependency</em> is an execution dependency which includes availability
and visibility operations such that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first set of operations happens-before the availability operation.</p>
</li>
<li>
<p>The availability operation happens-before the visibility operation.</p>
</li>
<li>
<p>The visibility operation happens-before the second set of operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once written values are made visible to a particular type of memory access,
they <strong class="purple">can</strong> be read or written by that type of memory access.
Most synchronization commands in Vulkan define a memory dependency.</p>
</div>
<div id="synchronization-dependencies-access-scopes" class="paragraph">
<p>The specific memory accesses that are made available and visible are defined
by the <em>access scopes</em> of a memory dependency.
Any type of access that is in a memory dependency’s first access scope and
occurs in <strong>A'</strong> is made available.
Any type of access that is in a memory dependency’s second access scope and
occurs in <strong>B'</strong> has any available writes made visible to it.
Any type of operation that is not in a synchronization command’s access
scopes will not be included in the resulting dependency.</p>
</div>
<div class="paragraph">
<p>A memory dependency enforces availability and visibility of memory accesses
and execution order between two sets of operations.
Adding to the description of <a href="chap7.html#synchronization-dependencies-chains">execution dependency chains</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Let <strong>a</strong> be the set of memory accesses performed by <strong>A'</strong>.</p>
</li>
<li>
<p>Let <strong>b</strong> be the set of memory accesses performed by <strong>B'</strong>.</p>
</li>
<li>
<p>Let <strong>a<sub>S</sub></strong> be the first access scope of the first command in <strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>b<sub>S</sub></strong> be the second access scope of the last command in <strong>S</strong>.</p>
</li>
<li>
<p>Let <strong>a'</strong> be the intersection of sets <strong>a</strong> and <strong>a<sub>S</sub></strong>.</p>
</li>
<li>
<p>Let <strong>b'</strong> be the intersection of sets <strong>b</strong> and <strong>b<sub>S</sub></strong>.</p>
</li>
<li>
<p>Submitting <strong>A</strong>, <strong>S</strong> and <strong>B</strong> for execution, in that order, will result in
a memory dependency <strong>m</strong> between <strong>A'</strong> and <strong>B'</strong>.</p>
</li>
<li>
<p>Memory dependency <strong>m</strong> guarantees that:</p>
<div class="ulist">
<ul>
<li>
<p>Memory writes in <strong>a'</strong> are made available.</p>
</li>
<li>
<p>Available memory writes, including those from <strong>a'</strong>, are made visible to
<strong>b'</strong>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Execution and memory dependencies are used to solve data hazards, i.e. to
ensure that read and write operations occur in a well-defined order.
Write-after-read hazards can be solved with just an execution dependency,
but read-after-write and write-after-write hazards need appropriate memory
dependencies to be included between them.
If an application does not include dependencies to solve these hazards, the
results and execution orders of memory accesses are undefined.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="synchronization-image-layout-transitions"><a class="anchor" href="chap7.html#synchronization-image-layout-transitions"></a>7.1.1. Image Layout Transitions</h4>
<div class="paragraph">
<p>Image subresources <strong class="purple">can</strong> be transitioned from one <a href="chap12.html#resources-image-layouts">layout</a> to another as part of a <a href="chap7.html#synchronization-dependencies-memory">memory dependency</a> (e.g. by using an
<a href="chap7.html#synchronization-image-memory-barriers">image memory barrier</a>).
When a layout transition is specified in a memory dependency, it
happens-after the availability operations in the memory dependency, and
happens-before the visibility operations.
Image layout transitions <strong class="purple">may</strong> perform read and write accesses on all memory
bound to the image subresource range, so applications <strong class="purple">must</strong> ensure that all
memory writes have been made
<a href="chap7.html#synchronization-dependencies-available-and-visible">available</a> before a
layout transition is executed.
Available memory is automatically made visible to a layout transition, and
writes performed by a layout transition are automatically made available.</p>
</div>
<div class="paragraph">
<p>Layout transitions always apply to a particular image subresource range, and
specify both an old layout and new layout.
The old layout <strong class="purple">must</strong> either be <code>VK_IMAGE_LAYOUT_UNDEFINED</code>, or match the
current layout of the image subresource range.
If the old layout matches the current layout of the image subresource range,
the transition preserves the contents of that range.
If the old layout is <code>VK_IMAGE_LAYOUT_UNDEFINED</code>, the contents of that
range <strong class="purple">may</strong> be discarded.</p>
</div>
<div class="paragraph">
<p>As image layout transitions <strong class="purple">may</strong> perform read and write accesses on the
memory bound to the image, if the image subresource affected by the layout
transition is bound to peer memory for any device in the current device mask
then the memory heap the bound memory comes from <strong class="purple">must</strong> support the
<code>VK_PEER_MEMORY_FEATURE_GENERIC_SRC_BIT</code> and
<code>VK_PEER_MEMORY_FEATURE_GENERIC_DST_BIT</code> capabilities as returned by
<a href="chap11.html#vkGetDeviceGroupPeerMemoryFeatures">vkGetDeviceGroupPeerMemoryFeatures</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications <strong class="purple">must</strong> ensure that layout transitions happen-after all
operations accessing the image with the old layout, and happen-before any
operations that will access the image with the new layout.
Layout transitions are potentially read/write operations, so not defining
appropriate memory dependencies to guarantee this will result in a data
race.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Image layout transitions interact with <a href="chap12.html#resources-memory-aliasing">memory
aliasing</a>.</p>
</div>
<div id="synchronization-image-barrier-layout-transition-order" class="paragraph">
<p>Layout transitions that are performed via image memory barriers execute in
their entirety in <a href="chap7.html#synchronization-submission-order">submission order</a>,
relative to other image layout transitions submitted to the same queue,
including those performed by <a href="chap8.html">render passes</a>.
In effect there is an implicit execution dependency from each such layout
transition to all layout transitions previously submitted to the same queue.</p>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-pipeline-stages"><a class="anchor" href="chap7.html#synchronization-pipeline-stages"></a>7.1.2. Pipeline Stages</h4>
<div class="paragraph">
<p>The work performed by an <a href="chap3.html#fundamentals-queueoperation-command-types">action
or synchronization command</a> consists of multiple operations, which are
performed as a sequence of logically independent steps known as <em>pipeline
stages</em>.
The exact pipeline stages executed depend on the particular command that is
used, and current command buffer state when the command was recorded.
<a href="chap20.html">Drawing commands</a>, <a href="chap28.html">dispatching commands</a>,
<a href="chap19.html">copy commands</a>, <a href="chap18.html">clear commands</a>, and <a href="chap7.html">synchronization commands</a> all execute in different sets of
<a href="chap7.html#VkPipelineStageFlagBits">pipeline stages</a>.
<a href="chap7.html">Synchronization commands</a> do not execute in a defined
pipeline stage.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Operations performed by synchronization commands (e.g.
<a href="chap7.html#synchronization-dependencies-available-and-visible">availability and
visibility operations</a>) are not executed by a defined pipeline stage.
However other commands can still synchronize with them by using the
<a href="chap7.html#synchronization-dependencies-scopes">synchronization scopes</a> to create a
<a href="chap7.html#synchronization-dependencies-chains">dependency chain</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Execution of operations across pipeline stages <strong class="purple">must</strong> adhere to
<a href="chap7.html#synchronization-implicit">implicit ordering guarantees</a>, particularly
including <a href="chap7.html#synchronization-pipeline-stages-order">pipeline stage order</a>.
Otherwise, execution across pipeline stages <strong class="purple">may</strong> overlap or execute out of
order with regards to other stages, unless otherwise enforced by an
execution dependency.</p>
</div>
<div class="paragraph">
<p>Several of the synchronization commands include pipeline stage parameters,
restricting the <a href="chap7.html#synchronization-dependencies-scopes">synchronization
scopes</a> for that command to just those stages.
This allows fine grained control over the exact execution dependencies and
accesses performed by action commands.
Implementations <strong class="purple">should</strong> use these pipeline stages to avoid unnecessary
stalls or cache flushing.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in a <a href="chap7.html#VkPipelineStageFlags">VkPipelineStageFlags</a> mask, specifying
stages of execution, are:</p>
</div>
<div id="VkPipelineStageFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkPipelineStageFlagBits</span> <span class="p">{</span>
    <span class="n">VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</span> <span class="o">=</span> <span class="mh">0x00000400</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</span> <span class="o">=</span> <span class="mh">0x00000800</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_TRANSFER_BIT</span> <span class="o">=</span> <span class="mh">0x00001000</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</span> <span class="o">=</span> <span class="mh">0x00002000</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_HOST_BIT</span> <span class="o">=</span> <span class="mh">0x00004000</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</span> <span class="o">=</span> <span class="mh">0x00008000</span><span class="p">,</span>
    <span class="n">VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkPipelineStageFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code> specifies the stage of the
pipeline where <code>VkDrawIndirect*</code> / <code>VkDispatchIndirect*</code> /
<code>VkTraceRaysIndirect*</code> data structures are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code> specifies the stage of the
pipeline where vertex and index buffers are consumed.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code> specifies the vertex shader
stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> specifies the
tessellation control shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code> specifies the
tessellation evaluation shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code> specifies the geometry
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> specifies the fragment
shader stage.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where early fragment tests (depth and stencil tests before
fragment shading) are performed.
This stage also includes <a href="chap8.html#renderpass-load-store-ops">subpass load
operations</a> for framebuffer attachments with a depth/stencil format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> specifies the stage of
the pipeline where late fragment tests (depth and stencil tests after
fragment shading) are performed.
This stage also includes <a href="chap8.html#renderpass-load-store-ops">subpass store
operations</a> for framebuffer attachments with a depth/stencil format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> specifies the stage
of the pipeline after blending where the final color values are output
from the pipeline.
This stage also includes <a href="chap8.html#renderpass-load-store-ops">subpass load and
store operations</a> and multisample resolve operations for framebuffer
attachments with a color
format.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code> specifies the execution of a
compute shader.</p>
</li>
<li>
<p><a id="synchronization-pipeline-stages-transfer"></a>
<code>VK_PIPELINE_STAGE_TRANSFER_BIT</code> specifies the following commands:</p>
<div class="ulist">
<ul>
<li>
<p>All <a href="chap19.html">copy commands</a>, including <a href="chap17.html#vkCmdCopyQueryPoolResults">vkCmdCopyQueryPoolResults</a></p>
</li>
<li>
<p><a href="chap19.html#vkCmdBlitImage">vkCmdBlitImage</a></p>
</li>
<li>
<p><a href="chap19.html#vkCmdResolveImage">vkCmdResolveImage</a></p>
</li>
<li>
<p>All <a href="chap18.html">clear commands</a>, with the exception of
<a href="chap18.html#vkCmdClearAttachments">vkCmdClearAttachments</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_HOST_BIT</code> specifies a pseudo-stage indicating
execution on the host of reads/writes of device memory.
This stage is not invoked by any commands recorded in a command buffer.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</code> specifies the execution of all
graphics pipeline stages, and is equivalent to the logical OR of:</p>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> specifies all operations
performed by all commands supported on the queue it is used with.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code> is equivalent to
<code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> with <a href="chap7.html#VkAccessFlags">VkAccessFlags</a> set to
<code>0</code> when specified in the second synchronization scope, but specifies no
stage of execution when specified in the first scope.</p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code> is equivalent to
<code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code> with <a href="chap7.html#VkAccessFlags">VkAccessFlags</a> set to
<code>0</code> when specified in the first synchronization scope, but specifies no
stage of execution when specified in the second scope.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkPipelineStageFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkPipelineStageFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkPipelineStageFlags</code> is a bitmask type for setting a mask of zero or
more <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>.</p>
</div>
</div>
</div>
<div id="synchronization-pipeline-stages-masks" class="paragraph">
<p>If a synchronization command includes a source stage mask, its first
<a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a> only includes
execution of the pipeline stages specified in that mask, and its first
<a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> only includes
memory accesses performed by pipeline stages specified in that mask.</p>
</div>
<div class="paragraph">
<p>If a synchronization command includes a destination stage mask, its second
<a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a> only includes
execution of the pipeline stages specified in that mask, and its second
<a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> only includes
memory access performed by pipeline stages specified in that mask.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Including a particular pipeline stage in the first
<a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a> of a command
implicitly includes <a href="chap7.html#synchronization-pipeline-stages-order">logically
earlier</a> pipeline stages in the synchronization scope.
Similarly, the second <a href="chap7.html#synchronization-dependencies-scopes">synchronization
scope</a> includes <a href="chap7.html#synchronization-pipeline-stages-order">logically later</a>
pipeline stages.</p>
</div>
<div class="paragraph">
<p>However, note that <a href="chap7.html#synchronization-dependencies-access-scopes">access
scopes</a> are not affected in this way - only the precise stages specified
are considered part of each access scope.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Certain pipeline stages are only available on queues that support a
particular set of operations.
The following table lists, for each pipeline stage flag, which queue
capability flag <strong class="purple">must</strong> be supported by the queue.
When multiple flags are enumerated in the second column of the table, it
means that the pipeline stage is supported on the queue if it supports any
of the listed capability flags.
For further details on queue capabilities see
<a href="chap5.html#devsandqueues-physical-device-enumeration">Physical Device Enumeration</a>
and <a href="chap5.html#devsandqueues-queues">Queues</a>.</p>
</div>
<table id="synchronization-pipeline-stages-supported" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Supported pipeline stage flags</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pipeline stage flag</th>
<th class="tableblock halign-left valign-top">Required queue capability flag</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TOP_OF_PIPE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code> or <code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_COMPUTE_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code>, <code>VK_QUEUE_COMPUTE_BIT</code> or <code>VK_QUEUE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_BOTTOM_OF_PIPE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_HOST_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_ALL_GRAPHICS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_QUEUE_GRAPHICS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None required</p></td>
</tr>
</tbody>
</table>
<div id="synchronization-pipeline-stages-order" class="paragraph">
<p>Pipeline stages that execute as a result of a command logically complete
execution in a specific order, such that completion of a logically later
pipeline stage <strong class="purple">must</strong> not happen-before completion of a logically earlier
stage.
This means that including any stage in the source stage mask for a
particular synchronization command also implies that any logically earlier
stages are included in <strong>A<sub>S</sub></strong> for that command.</p>
</div>
<div class="paragraph">
<p>Similarly, initiation of a logically earlier pipeline stage <strong class="purple">must</strong> not
happen-after initiation of a logically later pipeline stage.
Including any given stage in the destination stage mask for a particular
synchronization command also implies that any logically later stages are
included in <strong>B<sub>S</sub></strong> for that command.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Implementations <strong class="purple">may</strong> not support synchronization at every pipeline stage for
every synchronization operation.
If a pipeline stage that an implementation does not support synchronization
for appears in a source stage mask, it <strong class="purple">may</strong> substitute any logically later
stage in its place for the first synchronization scope.
If a pipeline stage that an implementation does not support synchronization
for appears in a destination stage mask, it <strong class="purple">may</strong> substitute any logically
earlier stage in its place for the second synchronization scope.</p>
</div>
<div class="paragraph">
<p>For example, if an implementation is unable to signal an event immediately
after vertex shader execution is complete, it <strong class="purple">may</strong> instead signal the event
after color attachment output has completed.</p>
</div>
<div class="paragraph">
<p>If an implementation makes such a substitution, it <strong class="purple">must</strong> not affect the
semantics of execution or memory dependencies or image and buffer memory
barriers.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><a id="synchronization-pipeline-stages-types"></a><a id="synchronization-pipeline-graphics"></a>
<a href="chap10.html#pipelines-graphics">Graphics pipelines</a> are executable on queues
supporting <code>VK_QUEUE_GRAPHICS_BIT</code>.
Stages executed by graphics pipelines <strong class="purple">can</strong> only be specified in commands
recorded for queues supporting <code>VK_QUEUE_GRAPHICS_BIT</code>.</p>
</div>
<div class="paragraph">
<p>The graphics
pipeline executes the following stages, with the logical ordering of the
stages matching the order specified here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the compute pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the transfer pipeline, the following stages occur in this order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For host operations, only one pipeline stage occurs, so no order is
guaranteed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-access-types"><a class="anchor" href="chap7.html#synchronization-access-types"></a>7.1.3. Access Types</h4>
<div class="paragraph">
<p>Memory in Vulkan <strong class="purple">can</strong> be accessed from within shader invocations and via
some fixed-function stages of the pipeline.
The <em>access type</em> is a function of the <a href="chap14.html">descriptor type</a>
used, or how a fixed-function stage accesses memory.</p>
</div>
<div id="synchronization-access-masks" class="paragraph">
<p>Some synchronization commands take sets of access types as parameters to
define the <a href="chap7.html#synchronization-dependencies-access-scopes">access scopes</a> of
a memory dependency.
If a synchronization command includes a <em>source access mask</em>, its first
<a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> only includes
accesses via the access types specified in that mask.
Similarly, if a synchronization command includes a <em>destination access
mask</em>, its second <a href="chap7.html#synchronization-dependencies-access-scopes">access
scope</a> only includes accesses via the access types specified in that mask.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in the <code>srcAccessMask</code> and <code>dstAccessMask</code>
members of <a href="chap8.html#VkSubpassDependency">VkSubpassDependency</a>,
<a href="chap7.html#VkMemoryBarrier">VkMemoryBarrier</a>, <a href="chap7.html#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a>, and
<a href="chap7.html#VkImageMemoryBarrier">VkImageMemoryBarrier</a>, specifying access behavior, are:</p>
</div>
<div id="VkAccessFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkAccessFlagBits</span> <span class="p">{</span>
    <span class="n">VK_ACCESS_INDIRECT_COMMAND_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
    <span class="n">VK_ACCESS_INDEX_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
    <span class="n">VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
    <span class="n">VK_ACCESS_UNIFORM_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
    <span class="n">VK_ACCESS_INPUT_ATTACHMENT_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
    <span class="n">VK_ACCESS_SHADER_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
    <span class="n">VK_ACCESS_SHADER_WRITE_BIT</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
    <span class="n">VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000080</span><span class="p">,</span>
    <span class="n">VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
    <span class="n">VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
    <span class="n">VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</span> <span class="o">=</span> <span class="mh">0x00000400</span><span class="p">,</span>
    <span class="n">VK_ACCESS_TRANSFER_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00000800</span><span class="p">,</span>
    <span class="n">VK_ACCESS_TRANSFER_WRITE_BIT</span> <span class="o">=</span> <span class="mh">0x00001000</span><span class="p">,</span>
    <span class="n">VK_ACCESS_HOST_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00002000</span><span class="p">,</span>
    <span class="n">VK_ACCESS_HOST_WRITE_BIT</span> <span class="o">=</span> <span class="mh">0x00004000</span><span class="p">,</span>
    <span class="n">VK_ACCESS_MEMORY_READ_BIT</span> <span class="o">=</span> <span class="mh">0x00008000</span><span class="p">,</span>
    <span class="n">VK_ACCESS_MEMORY_WRITE_BIT</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkAccessFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_ACCESS_MEMORY_READ_BIT</code> specifies all read accesses.
It is always valid in any access mask, and is treated as equivalent to
setting all <code>READ</code> access flags that are valid where it is used.</p>
</li>
<li>
<p><code>VK_ACCESS_MEMORY_WRITE_BIT</code> specifies all write accesses.
It is always valid in any access mask, and is treated as equivalent to
setting all <code>WRITE</code> access flags that are valid where it is used.</p>
</li>
<li>
<p><code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code> specifies read access to
indirect command data read as part of an indirect
drawing or dispatching command.
Such access occurs in the <code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_INDEX_READ_BIT</code> specifies read access to an index buffer
as part of an indexed drawing command, bound by
<a href="chap20.html#vkCmdBindIndexBuffer">vkCmdBindIndexBuffer</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT</code> specifies read access to a
vertex buffer as part of a drawing command, bound by
<a href="chap21.html#vkCmdBindVertexBuffers">vkCmdBindVertexBuffers</a>.
Such access occurs in the <code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code>
pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_UNIFORM_READ_BIT</code> specifies read access to a
<a href="chap14.html#descriptorsets-uniformbuffer">uniform buffer</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_INPUT_ATTACHMENT_READ_BIT</code> specifies read access to an
<a href="chap8.html">input attachment</a> within a render pass during
fragment shading.
Such access occurs in the
<code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADER_READ_BIT</code> specifies read access to a
<a href="chap14.html#descriptorsets-uniformbuffer">uniform buffer</a>,
<a href="chap14.html#descriptorsets-uniformtexelbuffer">uniform texel buffer</a>,
<a href="chap14.html#descriptorsets-sampledimage">sampled image</a>,
<a href="chap14.html#descriptorsets-storagebuffer">storage buffer</a>,
<a href="chap14.html#descriptorsets-storagetexelbuffer">storage texel buffer</a>, or
<a href="chap14.html#descriptorsets-storageimage">storage image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_SHADER_WRITE_BIT</code> specifies write access to a
<a href="chap14.html#descriptorsets-storagebuffer">storage buffer</a>,
<a href="chap14.html#descriptorsets-storagetexelbuffer">storage texel buffer</a>, or
<a href="chap14.html#descriptorsets-storageimage">storage image</a> in any shader pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code> specifies read access to a
<a href="chap8.html">color attachment</a>, such as via <a href="chap27.html#framebuffer-blending">blending</a>, <a href="chap27.html#framebuffer-logicop">logic operations</a>, or via certain
<a href="chap8.html#renderpass-load-store-ops">subpass load operations</a>.</p>
</li>
<li>
<p><code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code> specifies write access to a
<a href="chap8.html">color or resolve attachment</a>
during a <a href="chap8.html">render pass</a> or via certain
<a href="chap8.html#renderpass-load-store-ops">subpass load and store operations</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code> pipeline stage.</p>
</li>
<li>
<p><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code> specifies read access
to a <a href="chap8.html">depth/stencil attachment</a>, via <a href="chap26.html#fragops-ds-state">depth or stencil operations</a> or via certain
<a href="chap8.html#renderpass-load-store-ops">subpass load operations</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> or
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages.</p>
</li>
<li>
<p><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code> specifies write
access to a <a href="chap8.html">depth/stencil attachment</a>, via
<a href="chap26.html#fragops-ds-state">depth or stencil operations</a> or via certain
<a href="chap8.html#renderpass-load-store-ops">subpass load and store operations</a>.
Such access occurs in the
<code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code> or
<code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code> pipeline stages.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFER_READ_BIT</code> specifies read access to an image or
buffer in a <a href="chap19.html">copy</a> operation.</p>
</li>
<li>
<p><code>VK_ACCESS_TRANSFER_WRITE_BIT</code> specifies write access to an image or
buffer in a <a href="chap18.html">clear</a> or <a href="chap19.html">copy</a> operation.</p>
</li>
<li>
<p><code>VK_ACCESS_HOST_READ_BIT</code> specifies read access by a host operation.
Accesses of this type are not performed through a resource, but directly
on memory.
Such access occurs in the <code>VK_PIPELINE_STAGE_HOST_BIT</code> pipeline
stage.</p>
</li>
<li>
<p><code>VK_ACCESS_HOST_WRITE_BIT</code> specifies write access by a host
operation.
Accesses of this type are not performed through a resource, but directly
on memory.
Such access occurs in the <code>VK_PIPELINE_STAGE_HOST_BIT</code> pipeline
stage.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain access types are only performed by a subset of pipeline stages.
Any synchronization command that takes both stage masks and access masks
uses both to define the <a href="chap7.html#synchronization-dependencies-access-scopes">access
scopes</a> - only the specified access types performed by the specified stages
are included in the access scope.
An application <strong class="purple">must</strong> not specify an access flag in a synchronization command
if it does not include a pipeline stage in the corresponding stage mask that
is able to perform accesses of that type.
The following table lists, for each access flag, which pipeline stages <strong class="purple">can</strong>
perform that type of access.</p>
</div>
<table id="synchronization-access-types-supported" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Supported access types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access flag</th>
<th class="tableblock halign-left valign-top">Supported pipeline stages</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_INDIRECT_COMMAND_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_DRAW_INDIRECT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_INDEX_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_VERTEX_ATTRIBUTE_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_INPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_UNIFORM_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>, or <code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_SHADER_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>, or <code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_SHADER_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_VERTEX_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code>, <code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code>, or <code>VK_PIPELINE_STAGE_COMPUTE_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_INPUT_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_COLOR_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_COLOR_ATTACHMENT_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code>, or <code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_DEPTH_STENCIL_ATTACHMENT_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code>, or <code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_TRANSFER_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_TRANSFER_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_TRANSFER_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_HOST_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_HOST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_HOST_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_PIPELINE_STAGE_HOST_BIT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_MEMORY_READ_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ACCESS_MEMORY_WRITE_BIT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkAccessFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkAccessFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkAccessFlags</code> is a bitmask type for setting a mask of zero or more
<a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a>.</p>
</div>
</div>
</div>
<div id="synchronization-host-access-types" class="paragraph">
<p>If a memory object does not have the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> property, then
<a href="chap11.html#vkFlushMappedMemoryRanges">vkFlushMappedMemoryRanges</a> <strong class="purple">must</strong> be called in order to guarantee that
writes to the memory object from the host are made available to the host
domain, where they <strong class="purple">can</strong> be further made available to the device domain via a
domain operation.
Similarly, <a href="chap11.html#vkInvalidateMappedMemoryRanges">vkInvalidateMappedMemoryRanges</a> <strong class="purple">must</strong> be called to guarantee
that writes which are available to the host domain are made visible to host
operations.</p>
</div>
<div class="paragraph">
<p>If the memory object does have the
<code>VK_MEMORY_PROPERTY_HOST_COHERENT_BIT</code> property flag, writes to the
memory object from the host are automatically made available to the host
domain.
Similarly, writes made available to the host domain are automatically made
visible to the host.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><a href="chap5.html#devsandqueues-submission">Queue submission commands</a> automatically
perform a <a href="chap7.html#synchronization-submission-host-writes">domain operation from
host to device</a> for all writes performed before the command executes, so in
most cases an explicit memory barrier is not needed for this case.
In the few circumstances where a submit does not occur between the host
write and the device read access, writes <strong class="purple">can</strong> be made available by using an
explicit memory barrier.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-framebuffer-regions"><a class="anchor" href="chap7.html#synchronization-framebuffer-regions"></a>7.1.4. Framebuffer Region Dependencies</h4>
<div class="paragraph">
<p><a href="chap7.html#synchronization-pipeline-stages">Pipeline stages</a> that operate on, or
with respect to, the framebuffer are collectively the <em>framebuffer-space</em>
pipeline stages.
These stages are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_PIPELINE_STAGE_FRAGMENT_SHADER_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_EARLY_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_LATE_FRAGMENT_TESTS_BIT</code></p>
</li>
<li>
<p><code>VK_PIPELINE_STAGE_COLOR_ATTACHMENT_OUTPUT_BIT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For these pipeline stages, an execution or memory dependency from the first
set of operations to the second set <strong class="purple">can</strong> either be a single
<em>framebuffer-global</em> dependency, or split into multiple <em>framebuffer-local</em>
dependencies.
A dependency with non-framebuffer-space pipeline stages is neither
framebuffer-global nor framebuffer-local.</p>
</div>
<div class="paragraph">
<p>A <em>framebuffer region</em> is a set of sample (x, y, layer, sample) coordinates
that is a subset of the entire framebuffer.</p>
</div>
<div class="paragraph">
<p>Both <a href="chap7.html#synchronization-dependencies-scopes">synchronization scopes</a> of a
framebuffer-local dependency include only the operations performed within
corresponding framebuffer regions (as defined below).
No ordering guarantees are made between different framebuffer regions for a
framebuffer-local dependency.</p>
</div>
<div class="paragraph">
<p>Both <a href="chap7.html#synchronization-dependencies-scopes">synchronization scopes</a> of a
framebuffer-global dependency include operations on all framebuffer-regions.</p>
</div>
<div class="paragraph">
<p>If the first synchronization scope includes operations on pixels/fragments
with N samples and the second synchronization scope includes operations on
pixels/fragments with M samples, where N does not equal M, then a
framebuffer region containing all samples at a given (x, y, layer)
coordinate in the first synchronization scope corresponds to a region
containing all samples at the same coordinate in the second synchronization
scope.
In other words, it is a pixel granularity dependency.
If N equals M,
then a framebuffer region containing a single (x, y, layer, sample)
coordinate in the first synchronization scope corresponds to a region
containing the same sample at the same coordinate in the second
synchronization scope.
In other words, it is a sample granularity dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Since fragment shader invocations are not specified to run in any particular
groupings, the size of a framebuffer region is implementation-dependent, not
known to the application, and <strong class="purple">must</strong> be assumed to be no larger than
specified above.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Practically, the pixel vs sample granularity dependency means that if an
input attachment has a different number of samples than the pipeline’s
<code>rasterizationSamples</code>, then a fragment <strong class="purple">can</strong> access any sample in the
input attachment’s pixel even if it only uses framebuffer-local
dependencies.
If the input attachment has the same number of samples, then the fragment
<strong class="purple">can</strong> only access the covered samples in its input <code>SampleMask</code> (i.e. the
fragment operations happen-after a framebuffer-local dependency for each
sample the fragment covers).
To access samples that are not covered,
a framebuffer-global dependency is required.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter, and
specifies the <code>VK_DEPENDENCY_BY_REGION_BIT</code> flag, then it defines
framebuffer-local dependencies for the framebuffer-space pipeline stages in
that synchronization command, for all framebuffer regions.
If no <code>dependencyFlags</code> parameter is included, or the
<code>VK_DEPENDENCY_BY_REGION_BIT</code> flag is not specified, then a
framebuffer-global dependency is specified for those stages.
The <code>VK_DEPENDENCY_BY_REGION_BIT</code> flag does not affect the dependencies
between non-framebuffer-space pipeline stages, nor does it affect the
dependencies between framebuffer-space and non-framebuffer-space pipeline
stages.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Framebuffer-local dependencies are more efficient for most architectures;
particularly tile-based architectures - which can keep framebuffer-regions
entirely in on-chip registers and thus avoid external bandwidth across such
a dependency.
Including a framebuffer-global dependency in your rendering will usually
force all implementations to flush data to memory, or to a higher level
cache, breaking any potential locality optimizations.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-view-local-dependencies"><a class="anchor" href="chap7.html#synchronization-view-local-dependencies"></a>7.1.5. View-Local Dependencies</h4>
<div class="paragraph">
<p>In a render pass instance that has <a href="chap8.html#renderpass-multiview">multiview</a>
enabled, dependencies <strong class="purple">can</strong> be either view-local or view-global.</p>
</div>
<div class="paragraph">
<p>A view-local dependency only includes operations from a single
<a href="chap8.html#renderpass-multiview-view-local">source view</a> from the source subpass in
the first synchronization scope, and only includes operations from a single
<a href="chap8.html#renderpass-multiview-view-local">destination view</a> from the destination
subpass in the second synchronization scope.
A view-global dependency includes all views in the view mask of the source
and destination subpasses in the corresponding synchronization scopes.</p>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter and
specifies the <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> flag, then it defines
view-local dependencies for that synchronization command, for all views.
If no <code>dependencyFlags</code> parameter is included or the
<code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> flag is not specified, then a view-global
dependency is specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-device-local-dependencies"><a class="anchor" href="chap7.html#synchronization-device-local-dependencies"></a>7.1.6. Device-Local Dependencies</h4>
<div class="paragraph">
<p>Dependencies <strong class="purple">can</strong> be either device-local or non-device-local.
A device-local dependency acts as multiple separate dependencies, one for
each physical device that executes the synchronization command, where each
dependency only includes operations from that physical device in both
synchronization scopes.
A non-device-local dependency is a single dependency where both
synchronization scopes include operations from all physical devices that
participate in the synchronization command.
For subpass dependencies, all physical devices in the
<a href="chap8.html#VkDeviceGroupRenderPassBeginInfo">VkDeviceGroupRenderPassBeginInfo</a>::<code>deviceMask</code> participate in the
dependency, and for pipeline barriers all physical devices that are set in
the command buffer’s current device mask participate in the dependency.</p>
</div>
<div class="paragraph">
<p>If a synchronization command includes a <code>dependencyFlags</code> parameter and
specifies the <code>VK_DEPENDENCY_DEVICE_GROUP_BIT</code> flag, then it defines a
non-device-local dependency for that synchronization command.
If no <code>dependencyFlags</code> parameter is included or the
<code>VK_DEPENDENCY_DEVICE_GROUP_BIT</code> flag is not specified, then it defines
device-local dependencies for that synchronization command, for all
participating physical devices.</p>
</div>
<div class="paragraph">
<p>Semaphore and event dependencies are device-local and only execute on the
one physical device that performs the dependency.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-implicit"><a class="anchor" href="chap7.html#synchronization-implicit"></a>7.2. Implicit Synchronization Guarantees</h3>
<div class="paragraph">
<p>A small number of implicit ordering guarantees are provided by Vulkan,
ensuring that the order in which commands are submitted is meaningful, and
avoiding unnecessary complexity in common operations.</p>
</div>
<div id="synchronization-submission-order" class="paragraph">
<p><em>Submission order</em> is a fundamental ordering in Vulkan, giving meaning to
the order in which <a href="chap3.html#fundamentals-queueoperation-command-types">action and
synchronization commands</a> are recorded and submitted to a single queue.
Explicit and implicit ordering guarantees between commands in Vulkan all
work on the premise that this ordering is meaningful.
This order does not itself define any execution or memory dependencies;
synchronization commands and other orderings within the API use this
ordering to define their scopes.</p>
</div>
<div class="paragraph">
<p>Submission order for any given set of commands is based on the order in
which they were recorded to command buffers and then submitted.
This order is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The initial order is determined by the order in which
<a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>
commands are executed on the host, for a single queue, from first to
last.</p>
</li>
<li>
<p>The order in which <a href="chap6.html#VkSubmitInfo">VkSubmitInfo</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>,
from lowest index to highest.</p>
</li>
<li>
<p>The order in which command buffers are specified in the
<code>pCommandBuffers</code> member of <a href="chap6.html#VkSubmitInfo">VkSubmitInfo</a>
from lowest index to highest.</p>
</li>
<li>
<p>The order in which commands were recorded to a command buffer on the
host, from first to last:</p>
<div class="ulist">
<ul>
<li>
<p>For commands recorded outside a render pass, this includes all other
commands recorded outside a render pass, including
<a href="chap8.html#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a> and <a href="chap8.html#vkCmdEndRenderPass">vkCmdEndRenderPass</a> commands; it
does not directly include commands inside a render pass.</p>
</li>
<li>
<p>For commands recorded inside a render pass, this includes all other
     commands recorded inside the same subpass, including the
     <a href="chap8.html#vkCmdBeginRenderPass">vkCmdBeginRenderPass</a> and <a href="chap8.html#vkCmdEndRenderPass">vkCmdEndRenderPass</a> commands that
     delimit the same render pass instance; it does not include commands
     recorded to other subpasses.
<a href="chap3.html#fundamentals-queueoperation-command-types">State commands</a> do not execute
any operations on the device, instead they set the state of the command
buffer when they execute on the host, in the order that they are recorded.
<a href="chap3.html#fundamentals-queueoperation-command-types">Action commands</a> consume the
current state of the command buffer when they are recorded, and will execute
state changes on the device as required to match the recorded state.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="chap17.html#queries-order">Query commands</a>, <a href="chap20.html#drawing-primitive-order">the order of
primitives passing through the graphics pipeline</a> and
<a href="chap7.html#synchronization-image-barrier-layout-transition-order">image layout
transitions as part of an image memory barrier</a> provide additional
guarantees based on submission order.</p>
</div>
<div class="paragraph">
<p>Execution of <a href="chap7.html#synchronization-pipeline-stages-order">pipeline stages</a>
within a given command also has a loose ordering, dependent only on a single
command.</p>
</div>
<div id="synchronization-signal-operation-order" class="paragraph">
<p><em>Signal operation order</em> is a fundamental ordering in Vulkan, giving meaning
to the order in which semaphore and fence signal operations occur when
submitted to a single queue.
The signal operation order for queue operations is determined as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The initial order is determined by the order in which
<a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>
commands are executed on the host, for a single queue, from first to
last.</p>
</li>
<li>
<p>The order in which <a href="chap6.html#VkSubmitInfo">VkSubmitInfo</a> structures are specified in the
<code>pSubmits</code> parameter of <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>,
from lowest index to highest.</p>
</li>
<li>
<p>The fence signal operation defined by the <code>fence</code> parameter of a
<a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>,
or <a href="chap29.html#vkQueueBindSparse">vkQueueBindSparse</a> command is ordered after all semaphore signal
operations defined by that command.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Semaphore signal operations defined by a single <a href="chap6.html#VkSubmitInfo">VkSubmitInfo</a>,
or <a href="chap29.html#VkBindSparseInfo">VkBindSparseInfo</a> structure are unordered with respect to other
semaphore signal operations defined within the same structure.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-fences"><a class="anchor" href="chap7.html#synchronization-fences"></a>7.3. Fences</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Fences are a synchronization primitive that <strong class="purple">can</strong> be used to insert a
dependency from a queue to the host.
Fences have two states - signaled and unsignaled.
A fence <strong class="purple">can</strong> be signaled as part of the execution of a
<a href="chap5.html#devsandqueues-submission">queue submission</a> command.
Fences <strong class="purple">can</strong> be unsignaled on the host with <a href="chap7.html#vkResetFences">vkResetFences</a>.
Fences <strong class="purple">can</strong> be waited on by the host with the <a href="chap7.html#vkWaitForFences">vkWaitForFences</a> command,
and the current state <strong class="purple">can</strong> be queried with <a href="chap7.html#vkGetFenceStatus">vkGetFenceStatus</a>.</p>
</div>
<div id="synchronization-fences-payloads" class="paragraph">
<p>The internal data of a fence <strong class="purple">may</strong> include a reference to any resources and
pending work associated with signal or unsignal operations performed on that
fence object, collectively referred to as the fence’s <em>payload</em>.
Mechanisms to import and export that internal data to and from fences are
provided <a href="chap7.html#VkExportFenceCreateInfo">below</a>.
These mechanisms indirectly enable applications to share fence state between
two or more fences and other synchronization primitives across process and
API boundaries.</p>
</div>
<div class="paragraph">
<p>Fences are represented by <code>VkFence</code> handles:</p>
</div>
<div id="VkFence" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VK_DEFINE_NON_DISPATCHABLE_HANDLE</span><span class="p">(</span><span class="n">VkFence</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence, call:</p>
</div>
<div id="vkCreateFence" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkCreateFence</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkFenceCreateInfo</span><span class="o">*</span>                    <span class="n">pCreateInfo</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">,</span>
    <span class="n">VkFence</span><span class="o">*</span>                                    <span class="n">pFence</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the fence.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="chap7.html#VkFenceCreateInfo">VkFenceCreateInfo</a> structure
containing information about how the fence is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pFence</code> is a pointer to a handle in which the resulting fence
object is returned.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateFence-device-parameter" href="chap7.html#VUID-vkCreateFence-device-parameter"></a> <span class="vuid">VUID-vkCreateFence-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pCreateInfo-parameter" href="chap7.html#VUID-vkCreateFence-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateFence-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap7.html#VkFenceCreateInfo">VkFenceCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pAllocator-parameter" href="chap7.html#VUID-vkCreateFence-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateFence-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateFence-pFence-parameter" href="chap7.html#VUID-vkCreateFence-pFence-parameter"></a> <span class="vuid">VUID-vkCreateFence-pFence-parameter</span><br>
 <code>pFence</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap7.html#VkFence">VkFence</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkFenceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkFenceCreateInfo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkFenceCreateInfo</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkFenceCreateFlags</span>    <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkFenceCreateInfo</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap7.html#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a> specifying the
initial state and behavior of the fence.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkFenceCreateInfo-sType-sType" href="chap7.html#VUID-VkFenceCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkFenceCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_FENCE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-pNext-pNext" href="chap7.html#VUID-VkFenceCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkFenceCreateInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap7.html#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a></p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-sType-unique" href="chap7.html#VUID-VkFenceCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkFenceCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkFenceCreateInfo-flags-parameter" href="chap7.html#VUID-VkFenceCreateInfo-flags-parameter"></a> <span class="vuid">VUID-VkFenceCreateInfo-flags-parameter</span><br>
 <code>flags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceCreateFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkFenceCreateFlagBits</span> <span class="p">{</span>
    <span class="n">VK_FENCE_CREATE_SIGNALED_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkFenceCreateFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_FENCE_CREATE_SIGNALED_BIT</code> specifies that the fence object is
created in the signaled state.
Otherwise, it is created in the unsignaled state.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkFenceCreateFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkFenceCreateFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkFenceCreateFlags</code> is a bitmask type for setting a mask of zero or
more <a href="chap7.html#VkFenceCreateFlagBits">VkFenceCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a fence whose payload <strong class="purple">can</strong> be exported to external handles, add a
<a href="chap7.html#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a> structure to the <code>pNext</code> chain of the
<a href="chap7.html#VkFenceCreateInfo">VkFenceCreateInfo</a> structure.
The <code>VkExportFenceCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkExportFenceCreateInfo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkExportFenceCreateInfo</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                   <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                       <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkExternalFenceHandleTypeFlags</span>    <span class="n">handleTypes</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkExportFenceCreateInfo</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>handleTypes</code> is a bitmask of
<a href="chap34.html#VkExternalFenceHandleTypeFlagBits">VkExternalFenceHandleTypeFlagBits</a> specifying one or more fence
handle types the application <strong class="purple">can</strong> export from the resulting fence.
The application <strong class="purple">can</strong> request multiple handle types for the same fence.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportFenceCreateInfo-handleTypes-01446" href="chap7.html#VUID-VkExportFenceCreateInfo-handleTypes-01446"></a> <span class="vuid">VUID-VkExportFenceCreateInfo-handleTypes-01446</span><br>

The bits in <code>handleTypes</code> <strong class="purple">must</strong> be supported and compatible, as
reported by <a href="chap34.html#VkExternalFenceProperties">VkExternalFenceProperties</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportFenceCreateInfo-sType-sType" href="chap7.html#VUID-VkExportFenceCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkExportFenceCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_FENCE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkExportFenceCreateInfo-handleTypes-parameter" href="chap7.html#VUID-VkExportFenceCreateInfo-handleTypes-parameter"></a> <span class="vuid">VUID-VkExportFenceCreateInfo-handleTypes-parameter</span><br>
 <code>handleTypes</code> <strong class="purple">must</strong> be a valid combination of <a href="chap34.html#VkExternalFenceHandleTypeFlagBits">VkExternalFenceHandleTypeFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a fence, call:</p>
</div>
<div id="vkDestroyFence" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkDestroyFence</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkFence</span>                                     <span class="n">fence</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the fence.</p>
</li>
<li>
<p><code>fence</code> is the handle of the fence to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFence-fence-01120" href="chap7.html#VUID-vkDestroyFence-fence-01120"></a> <span class="vuid">VUID-vkDestroyFence-fence-01120</span><br>

All <a href="chap5.html#devsandqueues-submission">queue submission</a> commands that refer
to <code>fence</code> <strong class="purple">must</strong> have completed execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-01121" href="chap7.html#VUID-vkDestroyFence-fence-01121"></a> <span class="vuid">VUID-vkDestroyFence-fence-01121</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>fence</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-01122" href="chap7.html#VUID-vkDestroyFence-fence-01122"></a> <span class="vuid">VUID-vkDestroyFence-fence-01122</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>fence</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyFence-device-parameter" href="chap7.html#VUID-vkDestroyFence-device-parameter"></a> <span class="vuid">VUID-vkDestroyFence-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-parameter" href="chap7.html#VUID-vkDestroyFence-fence-parameter"></a> <span class="vuid">VUID-vkDestroyFence-fence-parameter</span><br>
 If <code>fence</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>fence</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-pAllocator-parameter" href="chap7.html#VUID-vkDestroyFence-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyFence-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyFence-fence-parent" href="chap7.html#VUID-vkDestroyFence-fence-parent"></a> <span class="vuid">VUID-vkDestroyFence-fence-parent</span><br>
 If <code>fence</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>fence</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the status of a fence from the host, call:</p>
</div>
<div id="vkGetFenceStatus" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkGetFenceStatus</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkFence</span>                                     <span class="n">fence</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fence.</p>
</li>
<li>
<p><code>fence</code> is the handle of the fence to query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon success, <code>vkGetFenceStatus</code> returns the status of the fence object,
with the following return codes:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 5. Fence Object Status Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_SUCCESS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fence specified by <code>fence</code> is signaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_NOT_READY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fence specified by <code>fence</code> is unsignaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_ERROR_DEVICE_LOST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The device has been lost.  See <a href="chap5.html#devsandqueues-lost-device">Lost Device</a>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a <a href="chap5.html#devsandqueues-submission">queue submission</a> command is pending
execution, then the value returned by this command <strong class="purple">may</strong> immediately be out
of date.</p>
</div>
<div class="paragraph">
<p>If the device has been lost (see <a href="chap5.html#devsandqueues-lost-device">Lost Device</a>),
<code>vkGetFenceStatus</code> <strong class="purple">may</strong> return any of the above status codes.
If the device has been lost and <code>vkGetFenceStatus</code> is called repeatedly,
it will eventually return either <code>VK_SUCCESS</code> or
<code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetFenceStatus-device-parameter" href="chap7.html#VUID-vkGetFenceStatus-device-parameter"></a> <span class="vuid">VUID-vkGetFenceStatus-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceStatus-fence-parameter" href="chap7.html#VUID-vkGetFenceStatus-fence-parameter"></a> <span class="vuid">VUID-vkGetFenceStatus-fence-parameter</span><br>
 <code>fence</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkFence">VkFence</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetFenceStatus-fence-parent" href="chap7.html#VUID-vkGetFenceStatus-fence-parent"></a> <span class="vuid">VUID-vkGetFenceStatus-fence-parent</span><br>
 <code>fence</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_NOT_READY</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-unsignaling" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of fences to unsignaled from the host, call:</p>
</div>
<div id="vkResetFences" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkResetFences</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">fenceCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkFence</span><span class="o">*</span>                              <span class="n">pFences</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fences.</p>
</li>
<li>
<p><code>fenceCount</code> is the number of fences to reset.</p>
</li>
<li>
<p><code>pFences</code> is a pointer to an array of fence handles to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any member of <code>pFences</code> currently has its
<a href="chap7.html#synchronization-fences-importing">payload imported</a> with temporary
permanence, that fence’s prior permanent payload is first restored.
The remaining operations described therefore operate on the restored
payload.</p>
</div>
<div class="paragraph">
<p>When <a href="chap7.html#vkResetFences">vkResetFences</a> is executed on the host, it defines a <em>fence
unsignal operation</em> for each fence, which resets the fence to the unsignaled
state.</p>
</div>
<div class="paragraph">
<p>If any member of <code>pFences</code> is already in the unsignaled state when
<a href="chap7.html#vkResetFences">vkResetFences</a> is executed, then <a href="chap7.html#vkResetFences">vkResetFences</a> has no effect on
that fence.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetFences-pFences-01123" href="chap7.html#VUID-vkResetFences-pFences-01123"></a> <span class="vuid">VUID-vkResetFences-pFences-01123</span><br>

Each element of <code>pFences</code> <strong class="purple">must</strong> not be currently associated with any
queue command that has not yet completed execution on that queue</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetFences-device-parameter" href="chap7.html#VUID-vkResetFences-device-parameter"></a> <span class="vuid">VUID-vkResetFences-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetFences-pFences-parameter" href="chap7.html#VUID-vkResetFences-pFences-parameter"></a> <span class="vuid">VUID-vkResetFences-pFences-parameter</span><br>
 <code>pFences</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>fenceCount</code> valid <a href="chap7.html#VkFence">VkFence</a> handles</p>
</li>
<li>
<p><a id="VUID-vkResetFences-fenceCount-arraylength" href="chap7.html#VUID-vkResetFences-fenceCount-arraylength"></a> <span class="vuid">VUID-vkResetFences-fenceCount-arraylength</span><br>
 <code>fenceCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkResetFences-pFences-parent" href="chap7.html#VUID-vkResetFences-pFences-parent"></a> <span class="vuid">VUID-vkResetFences-pFences-parent</span><br>
 Each element of <code>pFences</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to each member of <code>pFences</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-signaling" class="paragraph">
<p>When a fence is submitted to a queue as part of a
<a href="chap5.html#devsandqueues-submission">queue submission</a> command, it defines a memory
dependency on the batches that were submitted as part of that command, and
defines a <em>fence signal operation</em> which sets the fence to the signaled
state.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes every batch submitted in the same <a href="chap5.html#devsandqueues-submission">queue
submission</a> command.
Fence signal operations that are defined by <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a> additionally
include in the first synchronization scope all commands that occur earlier
in <a href="chap7.html#synchronization-submission-order">submission order</a>.
Fence signal operations that are defined by <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a> or
<a href="chap29.html#vkQueueBindSparse">vkQueueBindSparse</a> additionally include in the first synchronization
scope any semaphore and fence signal operations that occur earlier in
<a href="chap7.html#synchronization-signal-operation-order">signal operation order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
only includes the fence signal operation.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more fences to enter the signaled state on the host,
call:</p>
</div>
<div id="vkWaitForFences" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkWaitForFences</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">fenceCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkFence</span><span class="o">*</span>                              <span class="n">pFences</span><span class="p">,</span>
    <span class="n">VkBool32</span>                                    <span class="n">waitAll</span><span class="p">,</span>
    <span class="kt">uint64_t</span>                                    <span class="n">timeout</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the fences.</p>
</li>
<li>
<p><code>fenceCount</code> is the number of fences to wait on.</p>
</li>
<li>
<p><code>pFences</code> is a pointer to an array of <code>fenceCount</code> fence
handles.</p>
</li>
<li>
<p><code>waitAll</code> is the condition that <strong class="purple">must</strong> be satisfied to successfully
unblock the wait.
If <code>waitAll</code> is <code>VK_TRUE</code>, then the condition is that all fences
in <code>pFences</code> are signaled.
Otherwise, the condition is that at least one fence in <code>pFences</code> is
signaled.</p>
</li>
<li>
<p><code>timeout</code> is the timeout period in units of nanoseconds.
<code>timeout</code> is adjusted to the closest value allowed by the
implementation-dependent timeout accuracy, which <strong class="purple">may</strong> be substantially
longer than one nanosecond, and <strong class="purple">may</strong> be longer than the requested
period.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the condition is satisfied when <code>vkWaitForFences</code> is called, then
<code>vkWaitForFences</code> returns immediately.
If the condition is not satisfied at the time <code>vkWaitForFences</code> is
called, then <code>vkWaitForFences</code> will block and wait until the condition
is satisfied or the <code>timeout</code> has expired, whichever is sooner.</p>
</div>
<div class="paragraph">
<p>If <code>timeout</code> is zero, then <code>vkWaitForFences</code> does not wait, but
simply returns the current state of the fences.
<code>VK_TIMEOUT</code> will be returned in this case if the condition is not
satisfied, even though no actual wait was performed.</p>
</div>
<div class="paragraph">
<p>If the condition is satisfied before the <code>timeout</code> has expired,
<code>vkWaitForFences</code> returns <code>VK_SUCCESS</code>.
Otherwise, <code>vkWaitForFences</code> returns <code>VK_TIMEOUT</code> after the
<code>timeout</code> has expired.</p>
</div>
<div class="paragraph">
<p>If device loss occurs (see <a href="chap5.html#devsandqueues-lost-device">Lost Device</a>) before
the timeout has expired, <code>vkWaitForFences</code> <strong class="purple">must</strong> return in finite time
with either <code>VK_SUCCESS</code> or <code>VK_ERROR_DEVICE_LOST</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>While we guarantee that <code>vkWaitForFences</code> <strong class="purple">must</strong> return in finite time,
no guarantees are made that it returns immediately upon device loss.
However, the client can reasonably expect that the delay will be on the
order of seconds and that calling <code>vkWaitForFences</code> will not result in a
permanently (or seemingly permanently) dead process.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkWaitForFences-device-parameter" href="chap7.html#VUID-vkWaitForFences-device-parameter"></a> <span class="vuid">VUID-vkWaitForFences-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-pFences-parameter" href="chap7.html#VUID-vkWaitForFences-pFences-parameter"></a> <span class="vuid">VUID-vkWaitForFences-pFences-parameter</span><br>
 <code>pFences</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>fenceCount</code> valid <a href="chap7.html#VkFence">VkFence</a> handles</p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-fenceCount-arraylength" href="chap7.html#VUID-vkWaitForFences-fenceCount-arraylength"></a> <span class="vuid">VUID-vkWaitForFences-fenceCount-arraylength</span><br>
 <code>fenceCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkWaitForFences-pFences-parent" href="chap7.html#VUID-vkWaitForFences-pFences-parent"></a> <span class="vuid">VUID-vkWaitForFences-pFences-parent</span><br>
 Each element of <code>pFences</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
<li>
<p><code>VK_TIMEOUT</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-fences-waiting" class="paragraph">
<p>An execution dependency is defined by waiting for a fence to become
signaled, either via <a href="chap7.html#vkWaitForFences">vkWaitForFences</a> or by polling on
<a href="chap7.html#vkGetFenceStatus">vkGetFenceStatus</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the fence signal operation.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes the host operations of <a href="chap7.html#vkWaitForFences">vkWaitForFences</a> or
<a href="chap7.html#vkGetFenceStatus">vkGetFenceStatus</a> indicating that the fence has become signaled.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Signaling a fence and waiting on the host does not guarantee that the
results of memory accesses will be visible to the host, as the access scope
of a memory dependency defined by a fence only includes device access.
A <a href="chap7.html#synchronization-memory-barriers">memory barrier</a> or other memory
dependency <strong class="purple">must</strong> be used to guarantee this.
See the description of <a href="chap7.html#synchronization-host-access-types">host access
types</a> for more information.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="synchronization-fences-importing"><a class="anchor" href="chap7.html#synchronization-fences-importing"></a>7.3.1. Importing Fence Payloads</h4>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> import a fence payload into an existing fence using an
external fence handle.
The effects of the import operation will be either temporary or permanent,
as specified by the application.
If the import is temporary, the fence will be <em>restored</em> to its permanent
state the next time that fence is passed to <a href="chap7.html#vkResetFences">vkResetFences</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Restoring a fence to its prior permanent payload is a distinct operation
from resetting a fence payload.
See <a href="chap7.html#vkResetFences">vkResetFences</a> for more detail.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Performing a subsequent temporary import on a fence before resetting it has
no effect on this requirement; the next unsignal of the fence <strong class="purple">must</strong> still
restore its last permanent state.
A permanent payload import behaves as if the target fence was destroyed, and
a new fence was created with the same handle but the imported payload.
Because importing a fence payload temporarily or permanently detaches the
existing payload from a fence, similar usage restrictions to those applied
to <code>vkDestroyFence</code> are applied to any command that imports a fence
payload.
Which of these import types is used is referred to as the import operation’s
<em>permanence</em>.
Each handle type supports either one or both types of permanence.</p>
</div>
<div class="paragraph">
<p>The implementation <strong class="purple">must</strong> perform the import operation by either referencing
or copying the payload referred to by the specified external fence handle,
depending on the handle’s type.
The import method used is referred to as the handle type’s <em>transference</em>.
When using handle types with reference transference, importing a payload to
a fence adds the fence to the set of all fences sharing that payload.
This set includes the fence from which the payload was exported.
Fence signaling, waiting, and resetting operations performed on any fence in
the set <strong class="purple">must</strong> behave as if the set were a single fence.
Importing a payload using handle types with copy transference creates a
duplicate copy of the payload at the time of import, but makes no further
reference to it.
Fence signaling, waiting, and resetting operations performed on the target
of copy imports <strong class="purple">must</strong> not affect any other fence or payload.</p>
</div>
<div class="paragraph">
<p>Export operations have the same transference as the specified handle type’s
import operations.
Additionally, exporting a fence payload to a handle with copy transference
has the same side effects on the source fence’s payload as executing a fence
reset operation.
If the fence was using a temporarily imported payload, the fence’s prior
permanent payload will be restored.</p>
</div>
<div class="paragraph">
<p><a href="chap3.html#fundamentals-threadingbehavior">External synchronization</a> allows
implementations to modify an object’s internal state, i.e. payload, without
internal synchronization.
However, for fences sharing a payload across processes, satisfying the
external synchronization requirements of <code>VkFence</code> parameters as if all
fences in the set were the same object is sometimes infeasible.
Satisfying valid usage constraints on the state of a fence would similarly
require impractical coordination or levels of trust between processes.
Therefore, these constraints only apply to a specific fence handle, not to
its payload.
For distinct fence objects which share a payload:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If multiple commands which queue a signal operation, or which unsignal a
fence, are called concurrently, behavior will be as if the commands were
called in an arbitrary sequential order.</p>
</li>
<li>
<p>If a queue submission command is called with a fence that is sharing a
payload, and the payload is already associated with another queue
command that has not yet completed execution, either one or both of the
commands will cause the fence to become signaled when they complete
execution.</p>
</li>
<li>
<p>If a fence payload is reset while it is associated with a queue command
that has not yet completed execution, the payload will become
unsignaled, but <strong class="purple">may</strong> become signaled again when the command completes
execution.</p>
</li>
<li>
<p>In the preceding cases, any of the devices associated with the fences
sharing the payload <strong class="purple">may</strong> be lost, or any of the queue submission or
fence reset commands <strong class="purple">may</strong> return <code>VK_ERROR_INITIALIZATION_FAILED</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other than these non-deterministic results, behavior is well defined.
In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The implementation <strong class="purple">must</strong> not crash or enter an internally inconsistent
state where future valid Vulkan commands might cause undefined results,</p>
</li>
<li>
<p>Timeouts on future wait commands on fences sharing the payload <strong class="purple">must</strong> be
effective.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>These rules allow processes to synchronize access to shared memory without
trusting each other.
However, such processes must still be cautious not to use the shared fence
for more than synchronizing access to the shared memory.
For example, a process should not use a fence with shared payload to tell
when commands it submitted to a queue have completed and objects used by
those commands may be destroyed, since the other process can accidentally or
maliciously cause the fence to signal before the commands actually complete.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When a fence is using an imported payload, its
<a href="chap7.html#VkExportFenceCreateInfo">VkExportFenceCreateInfo</a>::<code>handleTypes</code> value is specified when
creating the fence from which the payload was exported, rather than
specified when creating the fence.
Additionally,
<a href="chap34.html#VkExternalFenceProperties">VkExternalFenceProperties</a>::<code>exportFromImportedHandleTypes</code>
restricts which handle types <strong class="purple">can</strong> be exported from such a fence based on the
specific handle type used to import the current payload.</p>
</div>
<div class="paragraph">
<p>When importing a fence payload, it is the responsibility of the application
to ensure the external handles meet all valid usage requirements.
However, implementations <strong class="purple">must</strong> perform sufficient validation of external
handles to ensure that the operation results in a valid fence which will not
cause program termination, device loss, queue stalls, host thread stalls, or
corruption of other resources when used as allowed according to its import
parameters.
If the external handle provided does not meet these requirements, the
implementation <strong class="purple">must</strong> fail the fence payload import operation with the error
code <code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-semaphores"><a class="anchor" href="chap7.html#synchronization-semaphores"></a>7.4. Semaphores</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Semaphores are a synchronization primitive that <strong class="purple">can</strong> be used to insert a
dependency
between queue operations.
Semaphores have two states - signaled and unsignaled.
A semaphore <strong class="purple">can</strong> be signaled after execution of a queue operation is
completed, and a queue operation <strong class="purple">can</strong> wait for a semaphore to become
signaled before it begins execution.</p>
</div>
<div id="synchronization-semaphores-payloads" class="paragraph">
<p>The internal data of a semaphore <strong class="purple">may</strong> include a reference to any resources
and pending work associated with signal or unsignal operations performed on
that semaphore object, collectively referred to as the semaphore’s
<em>payload</em>.
Mechanisms to import and export that internal data to and from semaphores
are provided <a href="chap7.html#VkExportSemaphoreCreateInfo">below</a>.
These mechanisms indirectly enable applications to share semaphore state
between two or more semaphores and other synchronization primitives across
process and API boundaries.</p>
</div>
<div class="paragraph">
<p>Semaphores are represented by <code>VkSemaphore</code> handles:</p>
</div>
<div id="VkSemaphore" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VK_DEFINE_NON_DISPATCHABLE_HANDLE</span><span class="p">(</span><span class="n">VkSemaphore</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a semaphore, call:</p>
</div>
<div id="vkCreateSemaphore" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkCreateSemaphore</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkSemaphoreCreateInfo</span><span class="o">*</span>                <span class="n">pCreateInfo</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">,</span>
    <span class="n">VkSemaphore</span><span class="o">*</span>                                <span class="n">pSemaphore</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the semaphore.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="chap7.html#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a>
structure containing information about how the semaphore is to be
created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pSemaphore</code> is a pointer to a handle in which the resulting
semaphore object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This command creates a <em>binary semaphore</em> that has a boolean payload
indicating whether the semaphore is currently signaled or unsignaled.
When created, the semaphore is in the unsignaled state.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateSemaphore-device-parameter" href="chap7.html#VUID-vkCreateSemaphore-device-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pCreateInfo-parameter" href="chap7.html#VUID-vkCreateSemaphore-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap7.html#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pAllocator-parameter" href="chap7.html#VUID-vkCreateSemaphore-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateSemaphore-pSemaphore-parameter" href="chap7.html#VUID-vkCreateSemaphore-pSemaphore-parameter"></a> <span class="vuid">VUID-vkCreateSemaphore-pSemaphore-parameter</span><br>
 <code>pSemaphore</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap7.html#VkSemaphore">VkSemaphore</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkSemaphoreCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkSemaphoreCreateInfo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkSemaphoreCreateInfo</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>           <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>               <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkSemaphoreCreateFlags</span>    <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkSemaphoreCreateInfo</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is reserved for future use.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-sType-sType" href="chap7.html#VUID-VkSemaphoreCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_SEMAPHORE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-pNext-pNext" href="chap7.html#VUID-VkSemaphoreCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code> or a pointer to a valid instance of <a href="chap7.html#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a></p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-sType-unique" href="chap7.html#VUID-VkSemaphoreCreateInfo-sType-unique"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-sType-unique</span><br>
 The <code>sType</code> value of each struct in the <code>pNext</code> chain <strong class="purple">must</strong> be unique</p>
</li>
<li>
<p><a id="VUID-VkSemaphoreCreateInfo-flags-zerobitmask" href="chap7.html#VUID-VkSemaphoreCreateInfo-flags-zerobitmask"></a> <span class="vuid">VUID-VkSemaphoreCreateInfo-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkSemaphoreCreateFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkSemaphoreCreateFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkSemaphoreCreateFlags</code> is a bitmask type for setting a mask, but is
currently reserved for future use.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create a semaphore whose payload <strong class="purple">can</strong> be exported to external handles,
add a <a href="chap7.html#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a> structure to the <code>pNext</code> chain
of the <a href="chap7.html#VkSemaphoreCreateInfo">VkSemaphoreCreateInfo</a> structure.
The <code>VkExportSemaphoreCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkExportSemaphoreCreateInfo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_1</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkExportSemaphoreCreateInfo</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>                       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkExternalSemaphoreHandleTypeFlags</span>    <span class="n">handleTypes</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkExportSemaphoreCreateInfo</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>handleTypes</code> is a bitmask of
<a href="chap34.html#VkExternalSemaphoreHandleTypeFlagBits">VkExternalSemaphoreHandleTypeFlagBits</a> specifying one or more
semaphore handle types the application <strong class="purple">can</strong> export from the resulting
semaphore.
The application <strong class="purple">can</strong> request multiple handle types for the same
semaphore.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportSemaphoreCreateInfo-handleTypes-01124" href="chap7.html#VUID-VkExportSemaphoreCreateInfo-handleTypes-01124"></a> <span class="vuid">VUID-VkExportSemaphoreCreateInfo-handleTypes-01124</span><br>

The bits in <code>handleTypes</code> <strong class="purple">must</strong> be supported and compatible, as
reported by <a href="chap34.html#VkExternalSemaphoreProperties">VkExternalSemaphoreProperties</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkExportSemaphoreCreateInfo-sType-sType" href="chap7.html#VUID-VkExportSemaphoreCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkExportSemaphoreCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EXPORT_SEMAPHORE_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkExportSemaphoreCreateInfo-handleTypes-parameter" href="chap7.html#VUID-VkExportSemaphoreCreateInfo-handleTypes-parameter"></a> <span class="vuid">VUID-VkExportSemaphoreCreateInfo-handleTypes-parameter</span><br>
 <code>handleTypes</code> <strong class="purple">must</strong> be a valid combination of <a href="chap34.html#VkExternalSemaphoreHandleTypeFlagBits">VkExternalSemaphoreHandleTypeFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy a semaphore, call:</p>
</div>
<div id="vkDestroySemaphore" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkDestroySemaphore</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkSemaphore</span>                                 <span class="n">semaphore</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the semaphore.</p>
</li>
<li>
<p><code>semaphore</code> is the handle of the semaphore to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01137" href="chap7.html#VUID-vkDestroySemaphore-semaphore-01137"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-01137</span><br>

All submitted batches that refer to <code>semaphore</code> <strong class="purple">must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01138" href="chap7.html#VUID-vkDestroySemaphore-semaphore-01138"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-01138</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>semaphore</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-01139" href="chap7.html#VUID-vkDestroySemaphore-semaphore-01139"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-01139</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>semaphore</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroySemaphore-device-parameter" href="chap7.html#VUID-vkDestroySemaphore-device-parameter"></a> <span class="vuid">VUID-vkDestroySemaphore-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-parameter" href="chap7.html#VUID-vkDestroySemaphore-semaphore-parameter"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-parameter</span><br>
 If <code>semaphore</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>semaphore</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkSemaphore">VkSemaphore</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-pAllocator-parameter" href="chap7.html#VUID-vkDestroySemaphore-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroySemaphore-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroySemaphore-semaphore-parent" href="chap7.html#VUID-vkDestroySemaphore-semaphore-parent"></a> <span class="vuid">VUID-vkDestroySemaphore-semaphore-parent</span><br>
 If <code>semaphore</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>semaphore</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-signaling"><a class="anchor" href="chap7.html#synchronization-semaphores-signaling"></a>7.4.1. Semaphore Signaling</h4>
<div class="paragraph">
<p>When a batch is submitted to a queue via a <a href="chap5.html#devsandqueues-submission">queue
submission</a>, and it includes semaphores to be signaled, it defines a memory
dependency on the batch, and defines <em>semaphore signal operations</em> which set
the semaphores to the signaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes every command submitted in the same batch.
Semaphore signal operations that are defined by <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>
additionally include all commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
Semaphore signal operations that are defined by <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a> or
<a href="chap29.html#vkQueueBindSparse">vkQueueBindSparse</a> additionally include in the first synchronization
scope any semaphore and fence signal operations that occur earlier in
<a href="chap7.html#synchronization-signal-operation-order">signal operation order</a>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the semaphore signal operation.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-waiting"><a class="anchor" href="chap7.html#synchronization-semaphores-waiting"></a>7.4.2. Semaphore Waiting</h4>
<div class="paragraph">
<p>When a batch is submitted to a queue via a <a href="chap5.html#devsandqueues-submission">queue
submission</a>, and it includes semaphores to be waited on, it defines a
memory dependency between prior semaphore signal operations and the batch,
and defines <em>semaphore wait operations</em>.</p>
</div>
<div class="paragraph">
<p>Such semaphore wait operations set the semaphores
to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope includes all semaphore signal operations
that operate on semaphores waited on in the same batch, and that
happen-before the wait completes.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes every command submitted in the same batch.
In the case of <a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>, the second synchronization scope is
limited to operations on the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by the corresponding element of <code>pWaitDstStageMask</code>.
Also, in the case of
<a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a>, the second synchronization scope additionally includes
all commands that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
empty.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
<div class="paragraph">
<p>The semaphore wait operation happens-after the first set of operations in
the execution dependency, and happens-before the second set of operations in
the execution dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Unlike
fences or events, the act of waiting for a binary semaphore also unsignals
that semaphore.
Applications <strong class="purple">must</strong> ensure that between two such wait operations, the
semaphore is signaled again, with execution dependencies used to ensure
these occur in order.
Binary semaphore waits and signals should thus occur in discrete 1:1 pairs.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-waiting-state"><a class="anchor" href="chap7.html#synchronization-semaphores-waiting-state"></a>7.4.3. Semaphore State Requirements For Wait Operations</h4>
<div class="paragraph">
<p>Before waiting on a semaphore, the application <strong class="purple">must</strong> ensure the semaphore is
in a valid state for a wait operation.
Specifically, when a <a href="chap7.html#synchronization-semaphores-waiting">semaphore wait
operation</a> is submitted to a queue:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A binary semaphore <strong class="purple">must</strong> be signaled, or have an associated
<a href="chap7.html#synchronization-semaphores-signaling">semaphore signal operation</a> that
is pending execution.</p>
</li>
<li>
<p>Any <a href="chap7.html#synchronization-semaphores-signaling">semaphore signal operations</a>
on which the pending binary semaphore signal operation depends <strong class="purple">must</strong>
also be completed or pending execution.</p>
</li>
<li>
<p>There <strong class="purple">must</strong> be no other queue waiting on the same binary semaphore when
the operation executes.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-semaphores-importing"><a class="anchor" href="chap7.html#synchronization-semaphores-importing"></a>7.4.4. Importing Semaphore Payloads</h4>
<div class="paragraph">
<p>Applications <strong class="purple">can</strong> import a semaphore payload into an existing semaphore
using an external semaphore handle.
The effects of the import operation will be either temporary or permanent,
as specified by the application.
If the import is temporary, the implementation <strong class="purple">must</strong> restore the semaphore
to its prior permanent state after submitting the next semaphore wait
operation.
Performing a subsequent temporary import on a semaphore before performing a
semaphore wait has no effect on this requirement; the next wait submitted on
the semaphore <strong class="purple">must</strong> still restore its last permanent state.
A permanent payload import behaves as if the target semaphore was destroyed,
and a new semaphore was created with the same handle but the imported
payload.
Because importing a semaphore payload temporarily or permanently detaches
the existing payload from a semaphore, similar usage restrictions to those
applied to <code>vkDestroySemaphore</code> are applied to any command that imports
a semaphore payload.
Which of these import types is used is referred to as the import operation’s
<em>permanence</em>.
Each handle type supports either one or both types of permanence.</p>
</div>
<div class="paragraph">
<p>The implementation <strong class="purple">must</strong> perform the import operation by either referencing
or copying the payload referred to by the specified external semaphore
handle, depending on the handle’s type.
The import method used is referred to as the handle type’s <em>transference</em>.
When using handle types with reference transference, importing a payload to
a semaphore adds the semaphore to the set of all semaphores sharing that
payload.
This set includes the semaphore from which the payload was exported.
Semaphore signaling and waiting operations performed on any semaphore in the
set <strong class="purple">must</strong> behave as if the set were a single semaphore.
Importing a payload using handle types with copy transference creates a
duplicate copy of the payload at the time of import, but makes no further
reference to it.
Semaphore signaling and waiting operations performed on the target of copy
imports <strong class="purple">must</strong> not affect any other semaphore or payload.</p>
</div>
<div class="paragraph">
<p>Export operations have the same transference as the specified handle type’s
import operations.
Additionally, exporting a semaphore payload to a handle with copy
transference has the same side effects on the source semaphore’s payload as
executing a semaphore wait operation.
If the semaphore was using a temporarily imported payload, the semaphore’s
prior permanent payload will be restored.</p>
</div>
<div class="paragraph">
<p><a href="chap3.html#fundamentals-threadingbehavior">External synchronization</a> allows
implementations to modify an object’s internal state, i.e. payload, without
internal synchronization.
However, for semaphores sharing a payload across processes, satisfying the
external synchronization requirements of <code>VkSemaphore</code> parameters as if
all semaphores in the set were the same object is sometimes infeasible.
Satisfying the <a href="chap7.html#synchronization-semaphores-waiting-state">wait operation
state requirements</a> would similarly require impractical coordination or
levels of trust between processes.
Therefore, these constraints only apply to a specific semaphore handle, not
to its payload.
For distinct semaphore objects which share a payload, if the semaphores are
passed to separate queue submission commands concurrently, behavior will be
as if the commands were called in an arbitrary sequential order.
If the <a href="chap7.html#synchronization-semaphores-waiting-state">wait operation state
requirements</a> are violated for the shared payload by a queue submission
command, or if a signal operation is queued for a shared payload that is
already signaled or has a pending signal operation, effects <strong class="purple">must</strong> be limited
to one or more of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Returning <code>VK_ERROR_INITIALIZATION_FAILED</code> from the command which
resulted in the violation.</p>
</li>
<li>
<p>Losing the logical device on which the violation occurred immediately or
at a future time, resulting in a <code>VK_ERROR_DEVICE_LOST</code> error from
subsequent commands, including the one causing the violation.</p>
</li>
<li>
<p>Continuing execution of the violating command or operation as if the
semaphore wait completed successfully after an implementation-dependent
timeout.
In this case, the state of the payload becomes undefined, and future
operations on semaphores sharing the payload will be subject to these
same rules.
The semaphore <strong class="purple">must</strong> be destroyed or have its payload replaced by an
import operation to again have a well-defined state.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>These rules allow processes to synchronize access to shared memory without
trusting each other.
However, such processes must still be cautious not to use the shared
semaphore for more than synchronizing access to the shared memory.
For example, a process should not use a shared semaphore as part of an
execution dependency chain that, when complete, leads to objects being
destroyed, if it does not trust other processes sharing the semaphore
payload.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>When a semaphore is using an imported payload, its
<a href="chap7.html#VkExportSemaphoreCreateInfo">VkExportSemaphoreCreateInfo</a>::<code>handleTypes</code> value is specified when
creating the semaphore from which the payload was exported, rather than
specified when creating the semaphore.
Additionally,
<a href="chap34.html#VkExternalSemaphoreProperties">VkExternalSemaphoreProperties</a>::<code>exportFromImportedHandleTypes</code>
restricts which handle types <strong class="purple">can</strong> be exported from such a semaphore based on
the specific handle type used to import the current payload.</p>
</div>
<div class="paragraph">
<p>When importing a semaphore payload, it is the responsibility of the
application to ensure the external handles meet all valid usage
requirements.
However, implementations <strong class="purple">must</strong> perform sufficient validation of external
handles to ensure that the operation results in a valid semaphore which will
not cause program termination, device loss, queue stalls, or corruption of
other resources when used as allowed according to its import parameters, and
excepting those side effects allowed for violations of the
<a href="chap7.html#synchronization-semaphores-waiting-state">valid semaphore state for wait
operations</a> rules.
If the external handle provided does not meet these requirements, the
implementation <strong class="purple">must</strong> fail the semaphore payload import operation with the
error code <code>VK_ERROR_INVALID_EXTERNAL_HANDLE</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-events"><a class="anchor" href="chap7.html#synchronization-events"></a>7.5. Events</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Events are a synchronization primitive that <strong class="purple">can</strong> be used to insert a
fine-grained dependency between commands submitted to the same queue, or
between the host and a queue.
Events <strong class="purple">must</strong> not be used to insert a dependency between commands submitted
to different queues.
Events have two states - signaled and unsignaled.
An application <strong class="purple">can</strong> signal or unsignal an event either on the host or on the
device.
A device <strong class="purple">can</strong> be made to wait for an event to become signaled before
executing further operations.
No command exists to wait for an event to become signaled on the host, but
the current state of an event <strong class="purple">can</strong> be queried.</p>
</div>
<div class="paragraph">
<p>Events are represented by <code>VkEvent</code> handles:</p>
</div>
<div id="VkEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VK_DEFINE_NON_DISPATCHABLE_HANDLE</span><span class="p">(</span><span class="n">VkEvent</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To create an event, call:</p>
</div>
<div id="vkCreateEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkCreateEvent</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkEventCreateInfo</span><span class="o">*</span>                    <span class="n">pCreateInfo</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">,</span>
    <span class="n">VkEvent</span><span class="o">*</span>                                    <span class="n">pEvent</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that creates the event.</p>
</li>
<li>
<p><code>pCreateInfo</code> is a pointer to a <a href="chap7.html#VkEventCreateInfo">VkEventCreateInfo</a> structure
containing information about how the event is to be created.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
<li>
<p><code>pEvent</code> is a pointer to a handle in which the resulting event
object is returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When created, the event object is in the unsignaled state.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCreateEvent-device-parameter" href="chap7.html#VUID-vkCreateEvent-device-parameter"></a> <span class="vuid">VUID-vkCreateEvent-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pCreateInfo-parameter" href="chap7.html#VUID-vkCreateEvent-pCreateInfo-parameter"></a> <span class="vuid">VUID-vkCreateEvent-pCreateInfo-parameter</span><br>
 <code>pCreateInfo</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap7.html#VkEventCreateInfo">VkEventCreateInfo</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pAllocator-parameter" href="chap7.html#VUID-vkCreateEvent-pAllocator-parameter"></a> <span class="vuid">VUID-vkCreateEvent-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkCreateEvent-pEvent-parameter" href="chap7.html#VUID-vkCreateEvent-pEvent-parameter"></a> <span class="vuid">VUID-vkCreateEvent-pEvent-parameter</span><br>
 <code>pEvent</code> <strong class="purple">must</strong> be a valid pointer to a <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkEventCreateInfo</code> structure is defined as:</p>
</div>
<div id="VkEventCreateInfo" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkEventCreateInfo</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>       <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>           <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkEventCreateFlags</span>    <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkEventCreateInfo</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>flags</code> is a bitmask of <a href="chap7.html#VkEventCreateFlagBits">VkEventCreateFlagBits</a> defining
additional creation parameters.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkEventCreateInfo-sType-sType" href="chap7.html#VUID-VkEventCreateInfo-sType-sType"></a> <span class="vuid">VUID-VkEventCreateInfo-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_EVENT_CREATE_INFO</code></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-pNext-pNext" href="chap7.html#VUID-VkEventCreateInfo-pNext-pNext"></a> <span class="vuid">VUID-VkEventCreateInfo-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkEventCreateInfo-flags-zerobitmask" href="chap7.html#VUID-VkEventCreateInfo-flags-zerobitmask"></a> <span class="vuid">VUID-VkEventCreateInfo-flags-zerobitmask</span><br>
 <code>flags</code> <strong class="purple">must</strong> be <code>0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkEventCreateFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkEventCreateFlagBits</span> <span class="p">{</span>
<span class="p">}</span> <span class="n">VkEventCreateFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All values for this enum are defined by extensions.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkEventCreateFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkEventCreateFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkEventCreateFlags</code> is a bitmask type for setting a mask of
<a href="chap7.html#VkEventCreateFlagBits">VkEventCreateFlagBits</a>.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To destroy an event, call:</p>
</div>
<div id="vkDestroyEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkDestroyEvent</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkEvent</span>                                     <span class="n">event</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkAllocationCallbacks</span><span class="o">*</span>                <span class="n">pAllocator</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that destroys the event.</p>
</li>
<li>
<p><code>event</code> is the handle of the event to destroy.</p>
</li>
<li>
<p><code>pAllocator</code> controls host memory allocation as described in the
<a href="chap11.html#memory-allocation">Memory Allocation</a> chapter.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyEvent-event-01145" href="chap7.html#VUID-vkDestroyEvent-event-01145"></a> <span class="vuid">VUID-vkDestroyEvent-event-01145</span><br>

All submitted commands that refer to <code>event</code> <strong class="purple">must</strong> have completed
execution</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-01146" href="chap7.html#VUID-vkDestroyEvent-event-01146"></a> <span class="vuid">VUID-vkDestroyEvent-event-01146</span><br>

If <code>VkAllocationCallbacks</code> were provided when <code>event</code> was
created, a compatible set of callbacks <strong class="purple">must</strong> be provided here</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-01147" href="chap7.html#VUID-vkDestroyEvent-event-01147"></a> <span class="vuid">VUID-vkDestroyEvent-event-01147</span><br>

If no <code>VkAllocationCallbacks</code> were provided when <code>event</code> was
created, <code>pAllocator</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDestroyEvent-device-parameter" href="chap7.html#VUID-vkDestroyEvent-device-parameter"></a> <span class="vuid">VUID-vkDestroyEvent-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-parameter" href="chap7.html#VUID-vkDestroyEvent-event-parameter"></a> <span class="vuid">VUID-vkDestroyEvent-event-parameter</span><br>
 If <code>event</code> is not <a href="chap40.html#VK_NULL_HANDLE">VK_NULL_HANDLE</a>, <code>event</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-pAllocator-parameter" href="chap7.html#VUID-vkDestroyEvent-pAllocator-parameter"></a> <span class="vuid">VUID-vkDestroyEvent-pAllocator-parameter</span><br>
 If <code>pAllocator</code> is not <code>NULL</code>, <code>pAllocator</code> <strong class="purple">must</strong> be a valid pointer to a valid <a href="chap11.html#VkAllocationCallbacks">VkAllocationCallbacks</a> structure</p>
</li>
<li>
<p><a id="VUID-vkDestroyEvent-event-parent" href="chap7.html#VUID-vkDestroyEvent-event-parent"></a> <span class="vuid">VUID-vkDestroyEvent-event-parent</span><br>
 If <code>event</code> is a valid handle, it <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To query the state of an event from the host, call:</p>
</div>
<div id="vkGetEventStatus" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkGetEventStatus</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkEvent</span>                                     <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the handle of the event to query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon success, <code>vkGetEventStatus</code> returns the state of the event object
with the following return codes:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 6. Event Object Status Codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EVENT_SET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event specified by <code>event</code> is signaled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VK_EVENT_RESET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The event specified by <code>event</code> is unsignaled.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a <code>vkCmdSetEvent</code> or <code>vkCmdResetEvent</code> command is in a command
buffer that is in the <a href="chap6.html#commandbuffers-lifecycle">pending state</a>, then the
value returned by this command <strong class="purple">may</strong> immediately be out of date.</p>
</div>
<div class="paragraph">
<p>The state of an event <strong class="purple">can</strong> be updated by the host.
The state of the event is immediately changed, and subsequent calls to
<code>vkGetEventStatus</code> will return the new state.
If an event is already in the requested state, then updating it to the same
state has no effect.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkGetEventStatus-device-parameter" href="chap7.html#VUID-vkGetEventStatus-device-parameter"></a> <span class="vuid">VUID-vkGetEventStatus-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEventStatus-event-parameter" href="chap7.html#VUID-vkGetEventStatus-event-parameter"></a> <span class="vuid">VUID-vkGetEventStatus-event-parameter</span><br>
 <code>event</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkGetEventStatus-event-parent" href="chap7.html#VUID-vkGetEventStatus-event-parent"></a> <span class="vuid">VUID-vkGetEventStatus-event-parent</span><br>
 <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_EVENT_SET</code></p>
</li>
<li>
<p><code>VK_EVENT_RESET</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-events-signaling-host" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to signaled from the host, call:</p>
</div>
<div id="vkSetEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkSetEvent</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkEvent</span>                                     <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the event to set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="chap7.html#vkSetEvent">vkSetEvent</a> is executed on the host, it defines an <em>event signal
operation</em> which sets the event to the signaled state.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the signaled state when <a href="chap7.html#vkSetEvent">vkSetEvent</a> is
executed, then <a href="chap7.html#vkSetEvent">vkSetEvent</a> has no effect, and no event signal operation
occurs.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkSetEvent-device-parameter" href="chap7.html#VUID-vkSetEvent-device-parameter"></a> <span class="vuid">VUID-vkSetEvent-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkSetEvent-event-parameter" href="chap7.html#VUID-vkSetEvent-event-parameter"></a> <span class="vuid">VUID-vkSetEvent-event-parameter</span><br>
 <code>event</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkSetEvent-event-parent" href="chap7.html#VUID-vkSetEvent-event-parent"></a> <span class="vuid">VUID-vkSetEvent-event-parent</span><br>
 <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="synchronization-events-unsignaling-host" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to unsignaled from the host, call:</p>
</div>
<div id="vkResetEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkResetEvent</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">,</span>
    <span class="n">VkEvent</span>                                     <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device that owns the event.</p>
</li>
<li>
<p><code>event</code> is the event to reset.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="chap7.html#vkResetEvent">vkResetEvent</a> is executed on the host, it defines an <em>event
unsignal operation</em> which resets the event to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the unsignaled state when <a href="chap7.html#vkResetEvent">vkResetEvent</a> is
executed, then <a href="chap7.html#vkResetEvent">vkResetEvent</a> has no effect, and no event unsignal
operation occurs.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetEvent-event-03821" href="chap7.html#VUID-vkResetEvent-event-03821"></a> <span class="vuid">VUID-vkResetEvent-event-03821</span><br>

There <strong class="purple">must</strong> be an execution dependency between <code>vkResetEvent</code> and
the execution of any <a href="chap7.html#vkCmdWaitEvents">vkCmdWaitEvents</a> that includes <code>event</code> in
its <code>pEvents</code> parameter</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkResetEvent-device-parameter" href="chap7.html#VUID-vkResetEvent-device-parameter"></a> <span class="vuid">VUID-vkResetEvent-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-parameter" href="chap7.html#VUID-vkResetEvent-event-parameter"></a> <span class="vuid">VUID-vkResetEvent-event-parameter</span><br>
 <code>event</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkResetEvent-event-parent" href="chap7.html#VUID-vkResetEvent-event-parent"></a> <span class="vuid">VUID-vkResetEvent-event-parent</span><br>
 <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from <code>device</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>event</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The state of an event <strong class="purple">can</strong> also be updated on the device by commands
inserted in command buffers.</p>
</div>
<div id="synchronization-events-signaling-device" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to signaled from a device, call:</p>
</div>
<div id="vkCmdSetEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdSetEvent</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkEvent</span>                                     <span class="n">event</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags</span>                        <span class="n">stageMask</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be signaled.</p>
</li>
<li>
<p><code>stageMask</code> specifies the <a href="chap7.html#synchronization-pipeline-stages">source
stage mask</a> used to determine the first
<a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a> is submitted to a queue, it defines an execution
dependency on commands that were submitted before it, and defines an event
signal operation which sets the event to the signaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations on the pipeline stages
determined by the <a href="chap7.html#synchronization-pipeline-stages-masks">source stage
mask</a> specified by <code>stageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the event signal operation.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the signaled state when <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a> is
executed on the device, then <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a> has no effect, no event
signal operation occurs, and no execution dependency is generated.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04090" href="chap7.html#VUID-vkCmdSetEvent-stageMask-04090"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04090</span><br>

If the <a href="chap31.html#features-geometryShader">geometry shaders</a> feature is not
enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04091" href="chap7.html#VUID-vkCmdSetEvent-stageMask-04091"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04091</span><br>

If the <a href="chap31.html#features-tessellationShader">tessellation shaders</a> feature is
not enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-04996" href="chap7.html#VUID-vkCmdSetEvent-stageMask-04996"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-04996</span><br>

<code>stageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-06457" href="chap7.html#VUID-vkCmdSetEvent-stageMask-06457"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-06457</span><br>

Any pipeline stage included in <code>stageMask</code> <strong class="purple">must</strong> be supported by the
capabilities of the queue family specified by the <code>queueFamilyIndex</code>
member of the <a href="chap6.html#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a> structure that was used to
create the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated
from, as specified in the <a href="chap7.html#synchronization-pipeline-stages-supported">table of supported pipeline stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-01149" href="chap7.html#VUID-vkCmdSetEvent-stageMask-01149"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-01149</span><br>

<code>stageMask</code> <strong class="purple">must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-01152" href="chap7.html#VUID-vkCmdSetEvent-commandBuffer-01152"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-01152</span><br>

<code>commandBuffer</code>’s current device mask <strong class="purple">must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-parameter" href="chap7.html#VUID-vkCmdSetEvent-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-event-parameter" href="chap7.html#VUID-vkCmdSetEvent-event-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent-event-parameter</span><br>
 <code>event</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-stageMask-parameter" href="chap7.html#VUID-vkCmdSetEvent-stageMask-parameter"></a> <span class="vuid">VUID-vkCmdSetEvent-stageMask-parameter</span><br>
 <code>stageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-recording" href="chap7.html#VUID-vkCmdSetEvent-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commandBuffer-cmdpool" href="chap7.html#VUID-vkCmdSetEvent-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdSetEvent-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-renderpass" href="chap7.html#VUID-vkCmdSetEvent-renderpass"></a> <span class="vuid">VUID-vkCmdSetEvent-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdSetEvent-commonparent" href="chap7.html#VUID-vkCmdSetEvent-commonparent"></a> <span class="vuid">VUID-vkCmdSetEvent-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="synchronization-events-unsignaling-device" class="openblock">
<div class="content">
<div class="paragraph">
<p>To set the state of an event to unsignaled from a device, call:</p>
</div>
<div id="vkCmdResetEvent" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdResetEvent</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkEvent</span>                                     <span class="n">event</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags</span>                        <span class="n">stageMask</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>event</code> is the event that will be unsignaled.</p>
</li>
<li>
<p><code>stageMask</code> is a bitmask of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> specifying
the <a href="chap7.html#synchronization-pipeline-stages">source stage mask</a> used to
determine when the <code>event</code> is unsignaled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="chap7.html#vkCmdResetEvent">vkCmdResetEvent</a> is submitted to a queue, it defines an execution
dependency on commands that were submitted before it, and defines an event
unsignal operation which resets the event to the unsignaled state.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
The synchronization scope is limited to operations on the pipeline stages
determined by the <a href="chap7.html#synchronization-pipeline-stages-masks">source stage
mask</a> specified by <code>stageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes only the event unsignal operation.</p>
</div>
<div class="paragraph">
<p>If <code>event</code> is already in the unsignaled state when <a href="chap7.html#vkCmdResetEvent">vkCmdResetEvent</a>
is executed on the device, then <a href="chap7.html#vkCmdResetEvent">vkCmdResetEvent</a> has no effect, no
event unsignal operation occurs, and no execution dependency is generated.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04090" href="chap7.html#VUID-vkCmdResetEvent-stageMask-04090"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04090</span><br>

If the <a href="chap31.html#features-geometryShader">geometry shaders</a> feature is not
enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04091" href="chap7.html#VUID-vkCmdResetEvent-stageMask-04091"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04091</span><br>

If the <a href="chap31.html#features-tessellationShader">tessellation shaders</a> feature is
not enabled, <code>stageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-04996" href="chap7.html#VUID-vkCmdResetEvent-stageMask-04996"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-04996</span><br>

<code>stageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-06458" href="chap7.html#VUID-vkCmdResetEvent-stageMask-06458"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-06458</span><br>

Any pipeline stage included in <code>stageMask</code> <strong class="purple">must</strong> be supported by the
capabilities of the queue family specified by the <code>queueFamilyIndex</code>
member of the <a href="chap6.html#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a> structure that was used to
create the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated
from, as specified in the <a href="chap7.html#synchronization-pipeline-stages-supported">table of supported pipeline stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-01153" href="chap7.html#VUID-vkCmdResetEvent-stageMask-01153"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-01153</span><br>

<code>stageMask</code> <strong class="purple">must</strong> not include <code>VK_PIPELINE_STAGE_HOST_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-03834" href="chap7.html#VUID-vkCmdResetEvent-event-03834"></a> <span class="vuid">VUID-vkCmdResetEvent-event-03834</span><br>

There <strong class="purple">must</strong> be an execution dependency between <code>vkCmdResetEvent</code> and
the execution of any <a href="chap7.html#vkCmdWaitEvents">vkCmdWaitEvents</a> that includes <code>event</code> in
its <code>pEvents</code> parameter</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-01157" href="chap7.html#VUID-vkCmdResetEvent-commandBuffer-01157"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-01157</span><br>

<code>commandBuffer</code>’s current device mask <strong class="purple">must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-parameter" href="chap7.html#VUID-vkCmdResetEvent-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-event-parameter" href="chap7.html#VUID-vkCmdResetEvent-event-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent-event-parameter</span><br>
 <code>event</code> <strong class="purple">must</strong> be a valid <a href="chap7.html#VkEvent">VkEvent</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-stageMask-parameter" href="chap7.html#VUID-vkCmdResetEvent-stageMask-parameter"></a> <span class="vuid">VUID-vkCmdResetEvent-stageMask-parameter</span><br>
 <code>stageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-recording" href="chap7.html#VUID-vkCmdResetEvent-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commandBuffer-cmdpool" href="chap7.html#VUID-vkCmdResetEvent-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdResetEvent-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-renderpass" href="chap7.html#VUID-vkCmdResetEvent-renderpass"></a> <span class="vuid">VUID-vkCmdResetEvent-renderpass</span><br>
 This command <strong class="purple">must</strong> only be called outside of a render pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdResetEvent-commonparent" href="chap7.html#VUID-vkCmdResetEvent-commonparent"></a> <span class="vuid">VUID-vkCmdResetEvent-commonparent</span><br>
 Both of <code>commandBuffer</code>, and <code>event</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outside</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait for one or more events to enter the signaled state on a device,
call:</p>
</div>
<div id="vkCmdWaitEvents" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdWaitEvents</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">eventCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkEvent</span><span class="o">*</span>                              <span class="n">pEvents</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags</span>                        <span class="n">srcStageMask</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags</span>                        <span class="n">dstStageMask</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">memoryBarrierCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMemoryBarrier</span><span class="o">*</span>                      <span class="n">pMemoryBarriers</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">bufferMemoryBarrierCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkBufferMemoryBarrier</span><span class="o">*</span>                <span class="n">pBufferMemoryBarriers</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">imageMemoryBarrierCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkImageMemoryBarrier</span><span class="o">*</span>                 <span class="n">pImageMemoryBarriers</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>eventCount</code> is the length of the <code>pEvents</code> array.</p>
</li>
<li>
<p><code>pEvents</code> is a pointer to an array of event object handles to wait
on.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="chap7.html#synchronization-pipeline-stages">source stage mask</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="chap7.html#synchronization-pipeline-stages">destination stage
mask</a>.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="chap7.html#VkMemoryBarrier">VkMemoryBarrier</a>
structures.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="chap7.html#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="chap7.html#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>vkCmdWaitEvents</code> is submitted to a queue, it defines a memory
dependency between prior event signal operations on the same queue or the
host, and subsequent commands.
<code>vkCmdWaitEvents</code> <strong class="purple">must</strong> not be used to wait on event signal operations
occurring on other queues.</p>
</div>
<div class="paragraph">
<p>The first synchronization scope only includes event signal operations that
operate on members of <code>pEvents</code>, and the operations that happened-before
the event signal operations.
Event signal operations performed by <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a> that occur earlier
in <a href="chap7.html#synchronization-submission-order">submission order</a> are included in the
first synchronization scope, if the <a href="chap7.html#synchronization-pipeline-stages-order">logically latest</a> pipeline stage in their <code>stageMask</code> parameter is
<a href="chap7.html#synchronization-pipeline-stages-order">logically earlier</a> than or equal
to the <a href="chap7.html#synchronization-pipeline-stages-order">logically latest</a> pipeline
stage in <code>srcStageMask</code>.
Event signal operations performed by <a href="chap7.html#vkSetEvent">vkSetEvent</a> are only included in
the first synchronization scope if <code>VK_PIPELINE_STAGE_HOST_BIT</code> is
included in <code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
The second synchronization scope is limited to operations on the pipeline
stages determined by the <a href="chap7.html#synchronization-pipeline-stages-masks">destination stage mask</a> specified by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
Within that, the first access scope only includes the first access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="chap7.html#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the first access scope includes no
accesses.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
Within that, the second access scope only includes the second access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="chap7.html#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the second access scope includes
no accesses.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p><a href="chap7.html#vkCmdWaitEvents">vkCmdWaitEvents</a> is used with <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a> to define a memory
dependency between two sets of action commands, roughly in the same way as
pipeline barriers, but split into two commands such that work between the
two <strong class="purple">may</strong> execute unhindered.</p>
</div>
<div class="paragraph">
<p>Unlike <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a>, a <a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> <strong class="purple">cannot</strong> be performed using
<a href="chap7.html#vkCmdWaitEvents">vkCmdWaitEvents</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Applications should be careful to avoid race conditions when using events.
There is no direct ordering guarantee between <a href="chap7.html#vkCmdWaitEvents">vkCmdWaitEvents</a> and
<a href="chap7.html#vkCmdResetEvent">vkCmdResetEvent</a>, or <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a>.
Another execution dependency (e.g. a pipeline barrier or semaphore with
<code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code>) is needed to prevent such a race
condition.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04090" href="chap7.html#VUID-vkCmdWaitEvents-srcStageMask-04090"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04090</span><br>

If the <a href="chap31.html#features-geometryShader">geometry shaders</a> feature is not
enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04091" href="chap7.html#VUID-vkCmdWaitEvents-srcStageMask-04091"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04091</span><br>

If the <a href="chap31.html#features-tessellationShader">tessellation shaders</a> feature is
not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-04996" href="chap7.html#VUID-vkCmdWaitEvents-srcStageMask-04996"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-04996</span><br>

<code>srcStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04090" href="chap7.html#VUID-vkCmdWaitEvents-dstStageMask-04090"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04090</span><br>

If the <a href="chap31.html#features-geometryShader">geometry shaders</a> feature is not
enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04091" href="chap7.html#VUID-vkCmdWaitEvents-dstStageMask-04091"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04091</span><br>

If the <a href="chap31.html#features-tessellationShader">tessellation shaders</a> feature is
not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-04996" href="chap7.html#VUID-vkCmdWaitEvents-dstStageMask-04996"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-04996</span><br>

<code>dstStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcAccessMask-02815" href="chap7.html#VUID-vkCmdWaitEvents-srcAccessMask-02815"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcAccessMask-02815</span><br>

The <code>srcAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong class="purple">must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstAccessMask-02816" href="chap7.html#VUID-vkCmdWaitEvents-dstAccessMask-02816"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstAccessMask-02816</span><br>

The <code>dstAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong class="purple">must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02817" href="chap7.html#VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02817"></a> <span class="vuid">VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02817</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02818" href="chap7.html#VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02818"></a> <span class="vuid">VUID-vkCmdWaitEvents-pBufferMemoryBarriers-02818</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-02819" href="chap7.html#VUID-vkCmdWaitEvents-pImageMemoryBarriers-02819"></a> <span class="vuid">VUID-vkCmdWaitEvents-pImageMemoryBarriers-02819</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-02820" href="chap7.html#VUID-vkCmdWaitEvents-pImageMemoryBarriers-02820"></a> <span class="vuid">VUID-vkCmdWaitEvents-pImageMemoryBarriers-02820</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-06459" href="chap7.html#VUID-vkCmdWaitEvents-srcStageMask-06459"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-06459</span><br>

Any pipeline stage included in <code>srcStageMask</code> <strong class="purple">must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="chap6.html#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="chap7.html#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-06460" href="chap7.html#VUID-vkCmdWaitEvents-dstStageMask-06460"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-06460</span><br>

Any pipeline stage included in <code>dstStageMask</code> <strong class="purple">must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="chap6.html#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="chap7.html#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-01158" href="chap7.html#VUID-vkCmdWaitEvents-srcStageMask-01158"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-01158</span><br>

<code>srcStageMask</code> <strong class="purple">must</strong> be the bitwise OR of the <code>stageMask</code>
parameter used in previous calls to <code>vkCmdSetEvent</code> with any of the
elements of <code>pEvents</code> and <code>VK_PIPELINE_STAGE_HOST_BIT</code> if any of
the elements of <code>pEvents</code> was set using <code>vkSetEvent</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pEvents-01163" href="chap7.html#VUID-vkCmdWaitEvents-pEvents-01163"></a> <span class="vuid">VUID-vkCmdWaitEvents-pEvents-01163</span><br>

If <code>pEvents</code> includes one or more events that will be signaled by
<code>vkSetEvent</code> after <code>commandBuffer</code> has been submitted to a
queue, then <code>vkCmdWaitEvents</code> <strong class="purple">must</strong> not be called inside a render
pass instance</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcQueueFamilyIndex-02803" href="chap7.html#VUID-vkCmdWaitEvents-srcQueueFamilyIndex-02803"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcQueueFamilyIndex-02803</span><br>

The <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members of
any element of <code>pBufferMemoryBarriers</code> or <code>pImageMemoryBarriers</code>
<strong class="purple">must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-01167" href="chap7.html#VUID-vkCmdWaitEvents-commandBuffer-01167"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-01167</span><br>

<code>commandBuffer</code>’s current device mask <strong class="purple">must</strong> include exactly one
physical device</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-parameter" href="chap7.html#VUID-vkCmdWaitEvents-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pEvents-parameter" href="chap7.html#VUID-vkCmdWaitEvents-pEvents-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pEvents-parameter</span><br>
 <code>pEvents</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>eventCount</code> valid <a href="chap7.html#VkEvent">VkEvent</a> handles</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-srcStageMask-parameter" href="chap7.html#VUID-vkCmdWaitEvents-srcStageMask-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-dstStageMask-parameter" href="chap7.html#VUID-vkCmdWaitEvents-dstStageMask-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pMemoryBarriers-parameter" href="chap7.html#VUID-vkCmdWaitEvents-pMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pMemoryBarriers-parameter</span><br>
 If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <a href="chap7.html#VkMemoryBarrier">VkMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter" href="chap7.html#VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pBufferMemoryBarriers-parameter</span><br>
 If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <a href="chap7.html#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter" href="chap7.html#VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdWaitEvents-pImageMemoryBarriers-parameter</span><br>
 If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <a href="chap7.html#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-recording" href="chap7.html#VUID-vkCmdWaitEvents-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commandBuffer-cmdpool" href="chap7.html#VUID-vkCmdWaitEvents-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdWaitEvents-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support graphics, or compute operations</p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-eventCount-arraylength" href="chap7.html#VUID-vkCmdWaitEvents-eventCount-arraylength"></a> <span class="vuid">VUID-vkCmdWaitEvents-eventCount-arraylength</span><br>
 <code>eventCount</code> <strong class="purple">must</strong> be greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-vkCmdWaitEvents-commonparent" href="chap7.html#VUID-vkCmdWaitEvents-commonparent"></a> <span class="vuid">VUID-vkCmdWaitEvents-commonparent</span><br>
 Both of <code>commandBuffer</code>, and the elements of <code>pEvents</code> <strong class="purple">must</strong> have been created, allocated, or retrieved from the same <a href="chap5.html#VkDevice">VkDevice</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphics<br>
Compute</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-pipeline-barriers"><a class="anchor" href="chap7.html#synchronization-pipeline-barriers"></a>7.6. Pipeline Barriers</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To record a pipeline barrier, call:</p>
</div>
<div id="vkCmdPipelineBarrier" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="kt">void</span> <span class="nf">vkCmdPipelineBarrier</span><span class="p">(</span>
    <span class="n">VkCommandBuffer</span>                             <span class="n">commandBuffer</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags</span>                        <span class="n">srcStageMask</span><span class="p">,</span>
    <span class="n">VkPipelineStageFlags</span>                        <span class="n">dstStageMask</span><span class="p">,</span>
    <span class="n">VkDependencyFlags</span>                           <span class="n">dependencyFlags</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">memoryBarrierCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkMemoryBarrier</span><span class="o">*</span>                      <span class="n">pMemoryBarriers</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">bufferMemoryBarrierCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkBufferMemoryBarrier</span><span class="o">*</span>                <span class="n">pBufferMemoryBarriers</span><span class="p">,</span>
    <span class="kt">uint32_t</span>                                    <span class="n">imageMemoryBarrierCount</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">VkImageMemoryBarrier</span><span class="o">*</span>                 <span class="n">pImageMemoryBarriers</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>commandBuffer</code> is the command buffer into which the command is
recorded.</p>
</li>
<li>
<p><code>srcStageMask</code> is a bitmask of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="chap7.html#synchronization-pipeline-stages-masks">source stages</a>.</p>
</li>
<li>
<p><code>dstStageMask</code> is a bitmask of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a>
specifying the <a href="chap7.html#synchronization-pipeline-stages-masks">destination
stages</a>.</p>
</li>
<li>
<p><code>dependencyFlags</code> is a bitmask of <a href="chap7.html#VkDependencyFlagBits">VkDependencyFlagBits</a>
specifying how execution and memory dependencies are formed.</p>
</li>
<li>
<p><code>memoryBarrierCount</code> is the length of the <code>pMemoryBarriers</code>
array.</p>
</li>
<li>
<p><code>pMemoryBarriers</code> is a pointer to an array of <a href="chap7.html#VkMemoryBarrier">VkMemoryBarrier</a>
structures.</p>
</li>
<li>
<p><code>bufferMemoryBarrierCount</code> is the length of the
<code>pBufferMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pBufferMemoryBarriers</code> is a pointer to an array of
<a href="chap7.html#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures.</p>
</li>
<li>
<p><code>imageMemoryBarrierCount</code> is the length of the
<code>pImageMemoryBarriers</code> array.</p>
</li>
<li>
<p><code>pImageMemoryBarriers</code> is a pointer to an array of
<a href="chap7.html#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> is submitted to a queue, it defines a memory
dependency between commands that were submitted before it, and those
submitted after it.</p>
</div>
<div class="paragraph">
<p>If <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded outside a render pass instance,
the first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
If <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded inside a render pass instance,
the first synchronization scope includes only commands that occur earlier in
<a href="chap7.html#synchronization-submission-order">submission order</a> within the same
subpass.
In either case, the first synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.</p>
</div>
<div class="paragraph">
<p>If <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded outside a render pass instance,
the second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.
If <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> was recorded inside a render pass instance,
the second synchronization scope includes only commands that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a> within the same
subpass.
In either case, the second synchronization scope is limited to operations on
the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">source stage mask</a> specified by
<code>srcStageMask</code>.
Within that, the first access scope only includes the first access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="chap7.html#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the first access scope includes no
accesses.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to accesses in the pipeline stages determined by the
<a href="chap7.html#synchronization-pipeline-stages-masks">destination stage mask</a> specified
by <code>dstStageMask</code>.
Within that, the second access scope only includes the second access scopes
defined by elements of the <code>pMemoryBarriers</code>,
<code>pBufferMemoryBarriers</code> and <code>pImageMemoryBarriers</code> arrays, which
each define a set of <a href="chap7.html#synchronization-memory-barriers">memory barriers</a>.
If no memory barriers are specified, then the second access scope includes
no accesses.</p>
</div>
<div class="paragraph">
<p>If <code>dependencyFlags</code> includes <code>VK_DEPENDENCY_BY_REGION_BIT</code>, then
any dependency between <a href="chap7.html#synchronization-framebuffer-regions">framebuffer-space</a> pipeline stages is
<a href="chap7.html#synchronization-framebuffer-regions">framebuffer-local</a> - otherwise it is
<a href="chap7.html#synchronization-framebuffer-regions">framebuffer-global</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04090" href="chap7.html#VUID-vkCmdPipelineBarrier-srcStageMask-04090"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04090</span><br>

If the <a href="chap31.html#features-geometryShader">geometry shaders</a> feature is not
enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04091" href="chap7.html#VUID-vkCmdPipelineBarrier-srcStageMask-04091"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04091</span><br>

If the <a href="chap31.html#features-tessellationShader">tessellation shaders</a> feature is
not enabled, <code>srcStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-04996" href="chap7.html#VUID-vkCmdPipelineBarrier-srcStageMask-04996"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-04996</span><br>

<code>srcStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04090" href="chap7.html#VUID-vkCmdPipelineBarrier-dstStageMask-04090"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04090</span><br>

If the <a href="chap31.html#features-geometryShader">geometry shaders</a> feature is not
enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_GEOMETRY_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04091" href="chap7.html#VUID-vkCmdPipelineBarrier-dstStageMask-04091"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04091</span><br>

If the <a href="chap31.html#features-tessellationShader">tessellation shaders</a> feature is
not enabled, <code>dstStageMask</code> <strong class="purple">must</strong> not contain
<code>VK_PIPELINE_STAGE_TESSELLATION_CONTROL_SHADER_BIT</code> or
<code>VK_PIPELINE_STAGE_TESSELLATION_EVALUATION_SHADER_BIT</code></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-04996" href="chap7.html#VUID-vkCmdPipelineBarrier-dstStageMask-04996"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-04996</span><br>

<code>dstStageMask</code> <strong class="purple">must</strong> not be <code>0</code></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcAccessMask-02815" href="chap7.html#VUID-vkCmdPipelineBarrier-srcAccessMask-02815"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcAccessMask-02815</span><br>

The <code>srcAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong class="purple">must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>srcStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstAccessMask-02816" href="chap7.html#VUID-vkCmdPipelineBarrier-dstAccessMask-02816"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstAccessMask-02816</span><br>

The <code>dstAccessMask</code> member of each element of <code>pMemoryBarriers</code>
<strong class="purple">must</strong> only include access flags that are supported by one or more of the
pipeline stages in <code>dstStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02817" href="chap7.html#VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02817"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02817</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02818" href="chap7.html#VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02818"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-02818</span><br>

For any element of <code>pBufferMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02819" href="chap7.html#VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02819"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02819</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>srcQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>srcAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>srcStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02820" href="chap7.html#VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02820"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-02820</span><br>

For any element of <code>pImageMemoryBarriers</code>, if its
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members are
equal, or if its <code>dstQueueFamilyIndex</code> is the queue family index
that was used to create the command pool that <code>commandBuffer</code> was
allocated from, then its <code>dstAccessMask</code> member <strong class="purple">must</strong> only contain
access flags that are supported by one or more of the pipeline stages in
<code>dstStageMask</code>, as specified in the
<a href="chap7.html#synchronization-access-types-supported">table of supported access
types</a></p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pDependencies-02285" href="chap7.html#VUID-vkCmdPipelineBarrier-pDependencies-02285"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pDependencies-02285</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the render
pass <strong class="purple">must</strong> have been created with at least one <a href="chap8.html#VkSubpassDependency">VkSubpassDependency</a>
instance in <code>VkRenderPassCreateInfo</code>::<code>pDependencies</code> that
expresses a dependency from the current subpass to itself, with
<a href="chap7.html#synchronization-dependencies-scopes">synchronization scopes</a> and
<a href="chap7.html#synchronization-dependencies-access-scopes">access scopes</a> that are
all supersets of the scopes defined in this command</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178" href="chap7.html#VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-bufferMemoryBarrierCount-01178</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, it <strong class="purple">must</strong> not
include any buffer memory barriers</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-image-04073" href="chap7.html#VUID-vkCmdPipelineBarrier-image-04073"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-image-04073</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the
<code>image</code> member of any image memory barrier included in this command
<strong class="purple">must</strong> be an attachment used in the current subpass both as an input
attachment, and as either a color or depth/stencil attachment</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-oldLayout-01181" href="chap7.html#VUID-vkCmdPipelineBarrier-oldLayout-01181"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-oldLayout-01181</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the
<code>oldLayout</code> and <code>newLayout</code> members of any image memory barrier
included in this command <strong class="purple">must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182" href="chap7.html#VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcQueueFamilyIndex-01182</span><br>

If <code>vkCmdPipelineBarrier</code> is called within a render pass instance, the
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> members of any
image memory barrier included in this command <strong class="purple">must</strong> be equal</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dependencyFlags-01186" href="chap7.html#VUID-vkCmdPipelineBarrier-dependencyFlags-01186"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dependencyFlags-01186</span><br>

If <code>vkCmdPipelineBarrier</code> is called outside of a render pass instance,
<code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> <strong class="purple">must</strong> not be included in the
dependency flags</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-06461" href="chap7.html#VUID-vkCmdPipelineBarrier-srcStageMask-06461"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-06461</span><br>

Any pipeline stage included in <code>srcStageMask</code> <strong class="purple">must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="chap6.html#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="chap7.html#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-06462" href="chap7.html#VUID-vkCmdPipelineBarrier-dstStageMask-06462"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-06462</span><br>

Any pipeline stage included in <code>dstStageMask</code> <strong class="purple">must</strong> be supported by
the capabilities of the queue family specified by the
<code>queueFamilyIndex</code> member of the <a href="chap6.html#VkCommandPoolCreateInfo">VkCommandPoolCreateInfo</a>
structure that was used to create the <code>VkCommandPool</code> that
<code>commandBuffer</code> was allocated from, as specified in the
<a href="chap7.html#synchronization-pipeline-stages-supported">table of supported pipeline
stages</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-commandBuffer-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-commandBuffer-parameter</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be a valid <a href="chap6.html#VkCommandBuffer">VkCommandBuffer</a> handle</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-srcStageMask-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-srcStageMask-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-srcStageMask-parameter</span><br>
 <code>srcStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dstStageMask-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-dstStageMask-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dstStageMask-parameter</span><br>
 <code>dstStageMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkPipelineStageFlagBits">VkPipelineStageFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-dependencyFlags-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-dependencyFlags-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-dependencyFlags-parameter</span><br>
 <code>dependencyFlags</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkDependencyFlagBits">VkDependencyFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pMemoryBarriers-parameter</span><br>
 If <code>memoryBarrierCount</code> is not <code>0</code>, <code>pMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>memoryBarrierCount</code> valid <a href="chap7.html#VkMemoryBarrier">VkMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pBufferMemoryBarriers-parameter</span><br>
 If <code>bufferMemoryBarrierCount</code> is not <code>0</code>, <code>pBufferMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>bufferMemoryBarrierCount</code> valid <a href="chap7.html#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter" href="chap7.html#VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-pImageMemoryBarriers-parameter</span><br>
 If <code>imageMemoryBarrierCount</code> is not <code>0</code>, <code>pImageMemoryBarriers</code> <strong class="purple">must</strong> be a valid pointer to an array of <code>imageMemoryBarrierCount</code> valid <a href="chap7.html#VkImageMemoryBarrier">VkImageMemoryBarrier</a> structures</p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-recording" href="chap7.html#VUID-vkCmdPipelineBarrier-commandBuffer-recording"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-commandBuffer-recording</span><br>
 <code>commandBuffer</code> <strong class="purple">must</strong> be in the <a href="chap6.html#commandbuffers-lifecycle">recording state</a></p>
</li>
<li>
<p><a id="VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool" href="chap7.html#VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool"></a> <span class="vuid">VUID-vkCmdPipelineBarrier-commandBuffer-cmdpool</span><br>
 The <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> support transfer, graphics, or compute operations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>commandBuffer</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
<li>
<p>Host access to the <code>VkCommandPool</code> that <code>commandBuffer</code> was allocated from <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary<br>
Secondary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Transfer<br>
Graphics<br>
Compute</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Bits which <strong class="purple">can</strong> be set in <code>vkCmdPipelineBarrier</code>::<code>dependencyFlags</code>,
specifying how execution and memory dependencies are formed, are:</p>
</div>
<div id="VkDependencyFlagBits" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">VkDependencyFlagBits</span> <span class="p">{</span>
    <span class="n">VK_DEPENDENCY_BY_REGION_BIT</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
  <span class="c1">// Provided by VK_VERSION_1_1</span>
    <span class="n">VK_DEPENDENCY_DEVICE_GROUP_BIT</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
  <span class="c1">// Provided by VK_VERSION_1_1</span>
    <span class="n">VK_DEPENDENCY_VIEW_LOCAL_BIT</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
<span class="p">}</span> <span class="n">VkDependencyFlagBits</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_DEPENDENCY_BY_REGION_BIT</code> specifies that dependencies will be
<a href="chap7.html#synchronization-framebuffer-regions">framebuffer-local</a>.</p>
</li>
<li>
<p><code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code> specifies that a
<a href="chap7.html#synchronization-pipeline-barriers-subpass-self-dependencies">subpass
has more than one view</a>.</p>
</li>
<li>
<p><code>VK_DEPENDENCY_DEVICE_GROUP_BIT</code> specifies that dependencies are
<a href="chap7.html#synchronization-device-local-dependencies">non-device-local</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="VkDependencyFlags" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="n">VkFlags</span> <span class="n">VkDependencyFlags</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VkDependencyFlags</code> is a bitmask type for setting a mask of zero or more
<a href="chap7.html#VkDependencyFlagBits">VkDependencyFlagBits</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-pipeline-barriers-subpass-self-dependencies"><a class="anchor" href="chap7.html#synchronization-pipeline-barriers-subpass-self-dependencies"></a>7.6.1. Subpass Self-dependency</h4>
<div class="paragraph">
<p>If <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a>
is called inside a render pass instance, the following restrictions apply.
For a given subpass to allow a pipeline barrier, the render pass <strong class="purple">must</strong>
declare a <em>self-dependency</em> from that subpass to itself.
That is, there <strong class="purple">must</strong> exist a subpass dependency with <code>srcSubpass</code> and
<code>dstSubpass</code> both equal to that subpass index.
More than one self-dependency <strong class="purple">can</strong> be declared for each subpass.</p>
</div>
<div class="paragraph">
<p>Self-dependencies <strong class="purple">must</strong> only include pipeline stage bits that are graphics
stages.
If any of the stages in <code>srcStageMask</code> are
<a href="chap7.html#synchronization-framebuffer-regions">framebuffer-space stages</a>,
<code>dstStageMask</code> <strong class="purple">must</strong> only contain
<a href="chap7.html#synchronization-framebuffer-regions">framebuffer-space stages</a>.
This means that pseudo-stages like <code>VK_PIPELINE_STAGE_ALL_COMMANDS_BIT</code>
which include the execution of both framebuffer-space stages and
non-framebuffer-space stages <strong class="purple">must</strong> not be used.</p>
</div>
<div class="paragraph">
<p>If the source and destination stage masks both include framebuffer-space
stages, then <code>dependencyFlags</code> <strong class="purple">must</strong> include
<code>VK_DEPENDENCY_BY_REGION_BIT</code>.
If the subpass has more than one view, then <code>dependencyFlags</code> <strong class="purple">must</strong>
include <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code>.</p>
</div>
<div class="paragraph">
<p>Each of the <a href="chap7.html#synchronization-dependencies-scopes">synchronization scopes</a>
and <a href="chap7.html#synchronization-dependencies-access-scopes">access scopes</a> of a
<a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a> command inside a render pass instance <strong class="purple">must</strong> be a
subset of the scopes of one of the self-dependencies for the current
subpass.</p>
</div>
<div class="paragraph">
<p>If the self-dependency has <code>VK_DEPENDENCY_BY_REGION_BIT</code>
or <code>VK_DEPENDENCY_VIEW_LOCAL_BIT</code>
set, then so <strong class="purple">must</strong> the pipeline barrier.
Pipeline barriers within a render pass instance <strong class="purple">must</strong> not include buffer
memory barriers.
Image memory barriers <strong class="purple">must</strong> only specify image subresources that are used as
attachments within the subpass, and <strong class="purple">must</strong> not define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a> or
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-memory-barriers"><a class="anchor" href="chap7.html#synchronization-memory-barriers"></a>7.7. Memory Barriers</h3>
<div class="paragraph">
<p><em>Memory barriers</em> are used to explicitly control access to buffer and image
subresource ranges.
Memory barriers are used to <a href="chap7.html#synchronization-queue-transfers">transfer
ownership between queue families</a>,
<a href="chap7.html#synchronization-image-layout-transitions">change image layouts</a>, and
define <a href="chap7.html#synchronization-dependencies-available-and-visible">availability
and visibility operations</a>.
They explicitly define the <a href="chap7.html#synchronization-access-types">access types</a>
and buffer and image subresource ranges that are included in the
<a href="chap7.html#synchronization-dependencies-access-scopes">access scopes</a> of a memory
dependency that is created by a synchronization command that includes them.</p>
</div>
<div class="sect3">
<h4 id="synchronization-global-memory-barriers"><a class="anchor" href="chap7.html#synchronization-global-memory-barriers"></a>7.7.1. Global Memory Barriers</h4>
<div class="paragraph">
<p>Global memory barriers apply to memory accesses involving all memory objects
that exist at the time of its execution.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkMemoryBarrier" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkMemoryBarrier</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAccessFlags</span>      <span class="n">srcAccessMask</span><span class="p">;</span>
    <span class="n">VkAccessFlags</span>      <span class="n">dstAccessMask</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkMemoryBarrier</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="chap7.html#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="chap7.html#synchronization-access-masks">destination access mask</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to access types in the <a href="chap7.html#synchronization-access-masks">source access
mask</a> specified by <code>srcAccessMask</code>.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to access types in the <a href="chap7.html#synchronization-access-masks">destination
access mask</a> specified by <code>dstAccessMask</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkMemoryBarrier-sType-sType" href="chap7.html#VUID-VkMemoryBarrier-sType-sType"></a> <span class="vuid">VUID-VkMemoryBarrier-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-pNext-pNext" href="chap7.html#VUID-VkMemoryBarrier-pNext-pNext"></a> <span class="vuid">VUID-VkMemoryBarrier-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-srcAccessMask-parameter" href="chap7.html#VUID-VkMemoryBarrier-srcAccessMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier-srcAccessMask-parameter</span><br>
 <code>srcAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
<li>
<p><a id="VUID-VkMemoryBarrier-dstAccessMask-parameter" href="chap7.html#VUID-VkMemoryBarrier-dstAccessMask-parameter"></a> <span class="vuid">VUID-VkMemoryBarrier-dstAccessMask-parameter</span><br>
 <code>dstAccessMask</code> <strong class="purple">must</strong> be a valid combination of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> values</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-buffer-memory-barriers"><a class="anchor" href="chap7.html#synchronization-buffer-memory-barriers"></a>7.7.2. Buffer Memory Barriers</h4>
<div class="paragraph">
<p>Buffer memory barriers only apply to memory accesses involving a specific
buffer range.
That is, a memory dependency formed from a buffer memory barrier is
<a href="chap7.html#synchronization-dependencies-access-scopes">scoped</a> to access via the
specified buffer range.
Buffer memory barriers <strong class="purple">can</strong> also be used to define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> for the
specified buffer range.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkBufferMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkBufferMemoryBarrier" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkBufferMemoryBarrier</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>    <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>        <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAccessFlags</span>      <span class="n">srcAccessMask</span><span class="p">;</span>
    <span class="n">VkAccessFlags</span>      <span class="n">dstAccessMask</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">srcQueueFamilyIndex</span><span class="p">;</span>
    <span class="kt">uint32_t</span>           <span class="n">dstQueueFamilyIndex</span><span class="p">;</span>
    <span class="n">VkBuffer</span>           <span class="n">buffer</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>       <span class="n">offset</span><span class="p">;</span>
    <span class="n">VkDeviceSize</span>       <span class="n">size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkBufferMemoryBarrier</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="chap7.html#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="chap7.html#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>buffer</code> is a handle to the buffer whose backing memory is affected
by the barrier.</p>
</li>
<li>
<p><code>offset</code> is an offset in bytes into the backing memory for
<code>buffer</code>; this is relative to the base offset as bound to the buffer
(see <a href="chap12.html#vkBindBufferMemory">vkBindBufferMemory</a>).</p>
</li>
<li>
<p><code>size</code> is a size in bytes of the affected area of backing memory for
<code>buffer</code>, or <code>VK_WHOLE_SIZE</code> to use the range from <code>offset</code>
to the end of the buffer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified buffer range, via access
types in the <a href="chap7.html#synchronization-access-masks">source access mask</a> specified
by <code>srcAccessMask</code>.
If <code>srcAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code>, memory
writes performed by that access type are also made visible, as that access
type is not performed through a resource.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified buffer range, via access
types in the <a href="chap7.html#synchronization-access-masks">destination access mask</a>
specified by <code>dstAccessMask</code>.
If <code>dstAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code> or
<code>VK_ACCESS_HOST_READ_BIT</code>, available memory writes are also made visible
to accesses of those types, as those access types are not performed through
a resource.</p>
</div>
<div class="paragraph">
<p>If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, and
<code>srcQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="chap7.html#synchronization-queue-transfers-release">queue
family release operation</a> for the specified buffer range, and the second
access scope includes no access, as if <code>dstAccessMask</code> was <code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstQueueFamilyIndex</code> is not equal to <code>srcQueueFamilyIndex</code>, and
<code>dstQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="chap7.html#synchronization-queue-transfers-acquire">queue
family acquire operation</a> for the specified buffer range, and the first
access scope includes no access, as if <code>srcAccessMask</code> was <code>0</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-offset-01187" href="chap7.html#VUID-VkBufferMemoryBarrier-offset-01187"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-offset-01187</span><br>

<code>offset</code> <strong class="purple">must</strong> be less than the size of <code>buffer</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-size-01188" href="chap7.html#VUID-VkBufferMemoryBarrier-size-01188"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-size-01188</span><br>

If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
greater than <code>0</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-size-01189" href="chap7.html#VUID-VkBufferMemoryBarrier-size-01189"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-size-01189</span><br>

If <code>size</code> is not equal to <code>VK_WHOLE_SIZE</code>, <code>size</code> <strong class="purple">must</strong> be
less than or equal to than the size of <code>buffer</code> minus <code>offset</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-01931" href="chap7.html#VUID-VkBufferMemoryBarrier-buffer-01931"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-01931</span><br>

If <code>buffer</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-04087" href="chap7.html#VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-04087"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-srcQueueFamilyIndex-04087</span><br>

If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>,
at least one <strong class="purple">must</strong> not be a special queue family reserved for external
memory ownership transfers, as described in
<a href="chap7.html#synchronization-queue-transfers">Queue Family Ownership Transfer</a></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-04088" href="chap7.html#VUID-VkBufferMemoryBarrier-buffer-04088"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-04088</span><br>

If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, and one of
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> is one of the
special queue family values reserved for external memory transfers, the
other <strong class="purple">must</strong> be <code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-04089" href="chap7.html#VUID-VkBufferMemoryBarrier-buffer-04089"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-04089</span><br>

If <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> both be valid queue families, or one of
the special queue family values reserved for external memory transfers,
as described in <a href="chap7.html#synchronization-queue-transfers">Queue Family Ownership Transfer</a></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-synchronization2-03853" href="chap7.html#VUID-VkBufferMemoryBarrier-synchronization2-03853"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-synchronization2-03853</span><br>

If the <a href="undefined"><code>synchronization2</code> feature</a> is
not enabled, and <code>buffer</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, at least one of
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-sType-sType" href="chap7.html#VUID-VkBufferMemoryBarrier-sType-sType"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_BUFFER_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-pNext-pNext" href="chap7.html#VUID-VkBufferMemoryBarrier-pNext-pNext"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkBufferMemoryBarrier-buffer-parameter" href="chap7.html#VUID-VkBufferMemoryBarrier-buffer-parameter"></a> <span class="vuid">VUID-VkBufferMemoryBarrier-buffer-parameter</span><br>
 <code>buffer</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkBuffer">VkBuffer</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>VK_WHOLE_SIZE</code> is a special value indicating that the entire remaining
length of a buffer following a given <code>offset</code> should be used.
It <strong class="purple">can</strong> be specified for <a href="chap7.html#VkBufferMemoryBarrier">VkBufferMemoryBarrier</a>::<code>size</code> and other
structures.</p>
</div>
<div id="VK_WHOLE_SIZE" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="cp">#define VK_WHOLE_SIZE                     (~0ULL)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-image-memory-barriers"><a class="anchor" href="chap7.html#synchronization-image-memory-barriers"></a>7.7.3. Image Memory Barriers</h4>
<div class="paragraph">
<p>Image memory barriers only apply to memory accesses involving a specific
image subresource range.
That is, a memory dependency formed from an image memory barrier is
<a href="chap7.html#synchronization-dependencies-access-scopes">scoped</a> to access via the
specified image subresource range.
Image memory barriers <strong class="purple">can</strong> also be used to define
<a href="chap7.html#synchronization-image-layout-transitions">image layout transitions</a> or a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> for the
specified image subresource range.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <code>VkImageMemoryBarrier</code> structure is defined as:</p>
</div>
<div id="VkImageMemoryBarrier" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">VkImageMemoryBarrier</span> <span class="p">{</span>
    <span class="n">VkStructureType</span>            <span class="n">sType</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                <span class="n">pNext</span><span class="p">;</span>
    <span class="n">VkAccessFlags</span>              <span class="n">srcAccessMask</span><span class="p">;</span>
    <span class="n">VkAccessFlags</span>              <span class="n">dstAccessMask</span><span class="p">;</span>
    <span class="n">VkImageLayout</span>              <span class="n">oldLayout</span><span class="p">;</span>
    <span class="n">VkImageLayout</span>              <span class="n">newLayout</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                   <span class="n">srcQueueFamilyIndex</span><span class="p">;</span>
    <span class="kt">uint32_t</span>                   <span class="n">dstQueueFamilyIndex</span><span class="p">;</span>
    <span class="n">VkImage</span>                    <span class="n">image</span><span class="p">;</span>
    <span class="n">VkImageSubresourceRange</span>    <span class="n">subresourceRange</span><span class="p">;</span>
<span class="p">}</span> <span class="n">VkImageMemoryBarrier</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sType</code> is the type of this structure.</p>
</li>
<li>
<p><code>pNext</code> is <code>NULL</code> or a pointer to a structure extending this
structure.</p>
</li>
<li>
<p><code>srcAccessMask</code> is a bitmask of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="chap7.html#synchronization-access-masks">source access mask</a>.</p>
</li>
<li>
<p><code>dstAccessMask</code> is a bitmask of <a href="chap7.html#VkAccessFlagBits">VkAccessFlagBits</a> specifying a
<a href="chap7.html#synchronization-access-masks">destination access mask</a>.</p>
</li>
<li>
<p><code>oldLayout</code> is the old layout in an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>newLayout</code> is the new layout in an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>.</p>
</li>
<li>
<p><code>srcQueueFamilyIndex</code> is the source queue family for a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>dstQueueFamilyIndex</code> is the destination queue family for a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a>.</p>
</li>
<li>
<p><code>image</code> is a handle to the image affected by this barrier.</p>
</li>
<li>
<p><code>subresourceRange</code> describes the <a href="chap12.html#resources-image-views">image
subresource range</a> within <code>image</code> that is affected by this barrier.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified image subresource range,
via access types in the <a href="chap7.html#synchronization-access-masks">source access mask</a>
specified by <code>srcAccessMask</code>.
If <code>srcAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code>, memory
writes performed by that access type are also made visible, as that access
type is not performed through a resource.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a> is
limited to access to memory through the specified image subresource range,
via access types in the <a href="chap7.html#synchronization-access-masks">destination access
mask</a> specified by <code>dstAccessMask</code>.
If <code>dstAccessMask</code> includes <code>VK_ACCESS_HOST_WRITE_BIT</code> or
<code>VK_ACCESS_HOST_READ_BIT</code>, available memory writes are also made visible
to accesses of those types, as those access types are not performed through
a resource.</p>
</div>
<div class="paragraph">
<p>If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>, and
<code>srcQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="chap7.html#synchronization-queue-transfers-release">queue
family release operation</a> for the specified image subresource range, and
the second access scope includes no access, as if <code>dstAccessMask</code> was
<code>0</code>.</p>
</div>
<div class="paragraph">
<p>If <code>dstQueueFamilyIndex</code> is not equal to <code>srcQueueFamilyIndex</code>, and
<code>dstQueueFamilyIndex</code> is equal to the current queue family, then the
memory barrier defines a <a href="chap7.html#synchronization-queue-transfers-acquire">queue
family acquire operation</a> for the specified image subresource range, and
the first access scope includes no access, as if <code>srcAccessMask</code> was
<code>0</code>.</p>
</div>
<div class="paragraph">
<p><code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a> for
the specified image subresource range.</p>
</div>
<div class="paragraph">
<p>If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>, then
including <code>VK_IMAGE_ASPECT_COLOR_BIT</code> in the <code>aspectMask</code> member of
<code>subresourceRange</code> is equivalent to including
<code>VK_IMAGE_ASPECT_PLANE_0_BIT</code>, <code>VK_IMAGE_ASPECT_PLANE_1_BIT</code>, and
(for three-plane formats only) <code>VK_IMAGE_ASPECT_PLANE_2_BIT</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01486" href="chap7.html#VUID-VkImageMemoryBarrier-subresourceRange-01486"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01486</span><br>

<code>subresourceRange.baseMipLevel</code> <strong class="purple">must</strong> be less than the
<code>mipLevels</code> specified in <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01724" href="chap7.html#VUID-VkImageMemoryBarrier-subresourceRange-01724"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01724</span><br>

If <code>subresourceRange.levelCount</code> is not
<code>VK_REMAINING_MIP_LEVELS</code>, <span class="eq"><code>subresourceRange.baseMipLevel</code>
+  <code>subresourceRange.levelCount</code></span> <strong class="purple">must</strong> be less than or equal to
the <code>mipLevels</code> specified in <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a> when
<code>image</code> was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01488" href="chap7.html#VUID-VkImageMemoryBarrier-subresourceRange-01488"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01488</span><br>

<code>subresourceRange.baseArrayLayer</code> <strong class="purple">must</strong> be less than the
<code>arrayLayers</code> specified in <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-01725" href="chap7.html#VUID-VkImageMemoryBarrier-subresourceRange-01725"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-01725</span><br>

If <code>subresourceRange.layerCount</code> is not
<code>VK_REMAINING_ARRAY_LAYERS</code>,
<span class="eq"><code>subresourceRange.baseArrayLayer</code> + 
<code>subresourceRange.layerCount</code></span> <strong class="purple">must</strong> be less than or equal to the
<code>arrayLayers</code> specified in <a href="chap12.html#VkImageCreateInfo">VkImageCreateInfo</a> when <code>image</code>
was created</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01932" href="chap7.html#VUID-VkImageMemoryBarrier-image-01932"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01932</span><br>

If <code>image</code> is non-sparse then it <strong class="purple">must</strong> be bound completely and
contiguously to a single <code>VkDeviceMemory</code> object</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01208" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01208"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01208</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_COLOR_ATTACHMENT_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong>
have been created with <code>VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01209" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01209"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01209</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_ATTACHMENT_OPTIMAL</code> then <code>image</code>
<strong class="purple">must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01210" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01210"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01210</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_STENCIL_READ_ONLY_OPTIMAL</code> then <code>image</code>
<strong class="purple">must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01211" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01211"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01211</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_SHADER_READ_ONLY_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong>
have been created with <code>VK_IMAGE_USAGE_SAMPLED_BIT</code> or
<code>VK_IMAGE_USAGE_INPUT_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01212" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01212"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01212</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_SRC_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01213" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01213"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01213</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL</code> then <code>image</code> <strong class="purple">must</strong> have
been created with <code>VK_IMAGE_USAGE_TRANSFER_DST_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01197" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01197"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01197</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
<code>oldLayout</code> <strong class="purple">must</strong> be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or the current
layout of the image subresources affected by the barrier</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-newLayout-01198" href="chap7.html#VUID-VkImageMemoryBarrier-newLayout-01198"></a> <span class="vuid">VUID-VkImageMemoryBarrier-newLayout-01198</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
<code>newLayout</code> <strong class="purple">must</strong> not be <code>VK_IMAGE_LAYOUT_UNDEFINED</code> or
<code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01658" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01658"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01658</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_READ_ONLY_STENCIL_ATTACHMENT_OPTIMAL</code> then
<code>image</code> <strong class="purple">must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-01659" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-01659"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-01659</span><br>

If <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> define a
<a href="chap7.html#synchronization-queue-transfers">queue family ownership transfer</a> or
<code>oldLayout</code> and <code>newLayout</code> define an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a>,
and <code>oldLayout</code> or <code>newLayout</code> is
<code>VK_IMAGE_LAYOUT_DEPTH_ATTACHMENT_STENCIL_READ_ONLY_OPTIMAL</code> then
<code>image</code> <strong class="purple">must</strong> have been created with
<code>VK_IMAGE_USAGE_DEPTH_STENCIL_ATTACHMENT_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01671" href="chap7.html#VUID-VkImageMemoryBarrier-image-01671"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01671</span><br>

If <code>image</code> has a single-plane color format or is not <em>disjoint</em>,
then the <code>aspectMask</code> member of <code>subresourceRange</code> <strong class="purple">must</strong> be
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01672" href="chap7.html#VUID-VkImageMemoryBarrier-image-01672"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01672</span><br>

If <code>image</code> has a multi-planar format and the image is <em>disjoint</em>,
then the <code>aspectMask</code> member of <code>subresourceRange</code> <strong class="purple">must</strong> include
either at least one of <code>VK_IMAGE_ASPECT_PLANE_0_BIT</code>,
<code>VK_IMAGE_ASPECT_PLANE_1_BIT</code>, and
<code>VK_IMAGE_ASPECT_PLANE_2_BIT</code>; or <strong class="purple">must</strong> include
<code>VK_IMAGE_ASPECT_COLOR_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01673" href="chap7.html#VUID-VkImageMemoryBarrier-image-01673"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01673</span><br>

If <code>image</code> has a multi-planar format with only two planes, then the
<code>aspectMask</code> member of <code>subresourceRange</code> <strong class="purple">must</strong> not include
<code>VK_IMAGE_ASPECT_PLANE_2_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-01207" href="chap7.html#VUID-VkImageMemoryBarrier-image-01207"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-01207</span><br>

If <code>image</code> has a depth/stencil format with both depth and stencil
components, then the <code>aspectMask</code> member of <code>subresourceRange</code>
<strong class="purple">must</strong> include both <code>VK_IMAGE_ASPECT_DEPTH_BIT</code> and
<code>VK_IMAGE_ASPECT_STENCIL_BIT</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04070" href="chap7.html#VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04070"></a> <span class="vuid">VUID-VkImageMemoryBarrier-srcQueueFamilyIndex-04070</span><br>

If <code>srcQueueFamilyIndex</code> is not equal to <code>dstQueueFamilyIndex</code>,
at least one <strong class="purple">must</strong> not be a special queue family reserved for external
memory ownership transfers, as described in
<a href="chap7.html#synchronization-queue-transfers">Queue Family Ownership Transfer</a></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-04071" href="chap7.html#VUID-VkImageMemoryBarrier-image-04071"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-04071</span><br>

If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, and one of
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> is one of the
special queue family values reserved for external memory transfers, the
other <strong class="purple">must</strong> be <code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-04072" href="chap7.html#VUID-VkImageMemoryBarrier-image-04072"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-04072</span><br>

If <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_EXCLUSIVE</code>, and <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> are not equal, <code>srcQueueFamilyIndex</code> and
<code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> both be valid queue families, or one of
the special queue family values reserved for external memory transfers,
as described in <a href="chap7.html#synchronization-queue-transfers">Queue Family Ownership Transfer</a></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-synchronization2-03857" href="chap7.html#VUID-VkImageMemoryBarrier-synchronization2-03857"></a> <span class="vuid">VUID-VkImageMemoryBarrier-synchronization2-03857</span><br>

If the <a href="undefined"><code>synchronization2</code> feature</a> is
not enabled, and <code>image</code> was created with a sharing mode of
<code>VK_SHARING_MODE_CONCURRENT</code>, at least one of
<code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> <strong class="purple">must</strong> be
<code>VK_QUEUE_FAMILY_IGNORED</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-VkImageMemoryBarrier-sType-sType" href="chap7.html#VUID-VkImageMemoryBarrier-sType-sType"></a> <span class="vuid">VUID-VkImageMemoryBarrier-sType-sType</span><br>
 <code>sType</code> <strong class="purple">must</strong> be <code>VK_STRUCTURE_TYPE_IMAGE_MEMORY_BARRIER</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-pNext-pNext" href="chap7.html#VUID-VkImageMemoryBarrier-pNext-pNext"></a> <span class="vuid">VUID-VkImageMemoryBarrier-pNext-pNext</span><br>
 <code>pNext</code> <strong class="purple">must</strong> be <code>NULL</code></p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-oldLayout-parameter" href="chap7.html#VUID-VkImageMemoryBarrier-oldLayout-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-oldLayout-parameter</span><br>
 <code>oldLayout</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkImageLayout">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-newLayout-parameter" href="chap7.html#VUID-VkImageMemoryBarrier-newLayout-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-newLayout-parameter</span><br>
 <code>newLayout</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkImageLayout">VkImageLayout</a> value</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-image-parameter" href="chap7.html#VUID-VkImageMemoryBarrier-image-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-image-parameter</span><br>
 <code>image</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkImage">VkImage</a> handle</p>
</li>
<li>
<p><a id="VUID-VkImageMemoryBarrier-subresourceRange-parameter" href="chap7.html#VUID-VkImageMemoryBarrier-subresourceRange-parameter"></a> <span class="vuid">VUID-VkImageMemoryBarrier-subresourceRange-parameter</span><br>
 <code>subresourceRange</code> <strong class="purple">must</strong> be a valid <a href="chap12.html#VkImageSubresourceRange">VkImageSubresourceRange</a> structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="synchronization-queue-transfers"><a class="anchor" href="chap7.html#synchronization-queue-transfers"></a>7.7.4. Queue Family Ownership Transfer</h4>
<div class="paragraph">
<p>Resources created with a <a href="chap12.html#VkSharingMode">VkSharingMode</a> of
<code>VK_SHARING_MODE_EXCLUSIVE</code> <strong class="purple">must</strong> have their ownership explicitly
transferred from one queue family to another in order to access their
content in a well-defined manner on a queue in a different queue family.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The special queue family index <code>VK_QUEUE_FAMILY_IGNORED</code> indicates that
a queue family parameter or member is ignored.</p>
</div>
<div id="VK_QUEUE_FAMILY_IGNORED" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="cp">#define VK_QUEUE_FAMILY_IGNORED           (~0U)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Resources shared with external APIs or instances using external memory <strong class="purple">must</strong>
also explicitly manage ownership transfers between local and external queues
(or equivalent constructs in external APIs) regardless of the
<a href="chap12.html#VkSharingMode">VkSharingMode</a> specified when creating them.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The special queue family index <code>VK_QUEUE_FAMILY_EXTERNAL</code> represents any
queue external to the resource’s current Vulkan instance, as long as the
queue uses the same underlying
device group or
physical device, and the same driver version as the resource’s
<a href="chap5.html#VkDevice">VkDevice</a>, as indicated by
<a href="chap5.html#VkPhysicalDeviceIDProperties">VkPhysicalDeviceIDProperties</a>::<code>deviceUUID</code> and
<a href="chap5.html#VkPhysicalDeviceIDProperties">VkPhysicalDeviceIDProperties</a>::<code>driverUUID</code>.</p>
</div>
<div id="VK_QUEUE_FAMILY_EXTERNAL" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="cp">#define VK_QUEUE_FAMILY_EXTERNAL          (~1U)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If memory dependencies are correctly expressed between uses of such a
resource between two queues in different families, but no ownership transfer
is defined, the contents of that resource are undefined for any read
accesses performed by the second queue family.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>If an application does not need the contents of a resource to remain valid
when transferring from one queue family to another, then the ownership
transfer <strong class="purple">should</strong> be skipped.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>A queue family ownership transfer consists of two distinct parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Release exclusive ownership from the source queue family</p>
</li>
<li>
<p>Acquire exclusive ownership for the destination queue family</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An application <strong class="purple">must</strong> ensure that these operations occur in the correct order
by defining an execution dependency between them, e.g. using a semaphore.</p>
</div>
<div class="paragraph">
<p><a id="synchronization-queue-transfers-release"></a> A <em>release operation</em> is used to
release exclusive ownership of a range of a buffer or image subresource
range.
A release operation is defined by executing a
<a href="chap7.html#synchronization-buffer-memory-barriers">buffer memory barrier</a> (for a
buffer range) or an <a href="chap7.html#synchronization-image-memory-barriers">image memory
barrier</a> (for an image subresource range) using a pipeline barrier command,
on a queue from the source queue family.
The <code>srcQueueFamilyIndex</code> parameter of the barrier <strong class="purple">must</strong> be set to the
source queue family index, and the <code>dstQueueFamilyIndex</code> parameter to
the destination queue family index.
<code>dstAccessMask</code> is ignored for such a barrier, such that no visibility
operation is executed - the value of this mask does not affect the validity
of the barrier.
The release operation happens-after the availability operation, and
happens-before operations specified in the second synchronization scope of
the calling command.</p>
</div>
<div class="paragraph">
<p><a id="synchronization-queue-transfers-acquire"></a> An <em>acquire operation</em> is used
to acquire exclusive ownership of a range of a buffer or image subresource
range.
An acquire operation is defined by executing a
<a href="chap7.html#synchronization-buffer-memory-barriers">buffer memory barrier</a> (for a
buffer range) or an <a href="chap7.html#synchronization-image-memory-barriers">image memory
barrier</a> (for an image subresource range) using a pipeline barrier command,
on a queue from the destination queue family.
The buffer range or image subresource range specified in an acquire
operation <strong class="purple">must</strong> match exactly that of a previous release operation.
The <code>srcQueueFamilyIndex</code> parameter of the barrier <strong class="purple">must</strong> be set to the
source queue family index, and the <code>dstQueueFamilyIndex</code> parameter to
the destination queue family index.
<code>srcAccessMask</code> is ignored for such a barrier, such that no availability
operation is executed - the value of this mask does not affect the validity
of the barrier.
The acquire operation happens-after operations in the first synchronization
scope of the calling command, and happens-before the visibility operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Whilst it is not invalid to provide destination or source access masks for
memory barriers used for release or acquire operations, respectively, they
have no practical effect.
Access after a release operation has undefined results, and so visibility
for those accesses has no practical effect.
Similarly, write access before an acquire operation will produce undefined
results for future access, so availability of those writes has no practical
use.
In an earlier version of the specification, these were required to match on
both sides - but this was subsequently relaxed.
These masks <strong class="purple">should</strong> be set to 0.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>If the transfer is via an image memory barrier, and an
<a href="chap7.html#synchronization-image-layout-transitions">image layout transition</a> is
desired, then the values of <code>oldLayout</code> and <code>newLayout</code> in the
<em>release operation</em>'s memory barrier <strong class="purple">must</strong> be equal to values of
<code>oldLayout</code> and <code>newLayout</code> in the <em>acquire operation</em>'s memory
barrier.
Although the image layout transition is submitted twice, it will only be
executed once.
A layout transition specified in this way happens-after the <em>release
operation</em> and happens-before the <em>acquire operation</em>.</p>
</div>
<div class="paragraph">
<p>If the values of <code>srcQueueFamilyIndex</code> and <code>dstQueueFamilyIndex</code> are
equal, no ownership transfer is performed, and the barrier operates as if
they were both set to <code>VK_QUEUE_FAMILY_IGNORED</code>.</p>
</div>
<div class="paragraph">
<p>Queue family ownership transfers <strong class="purple">may</strong> perform read and write accesses on all
memory bound to the image subresource or buffer range, so applications <strong class="purple">must</strong>
ensure that all memory writes have been made
<a href="chap7.html#synchronization-dependencies-available-and-visible">available</a> before a
queue family ownership transfer is executed.
Available memory is automatically made visible to queue family release and
acquire operations, and writes performed by those operations are
automatically made available.</p>
</div>
<div class="paragraph">
<p>Once a queue family has acquired ownership of a buffer range or image
subresource range of a <code>VK_SHARING_MODE_EXCLUSIVE</code> resource, its
contents are undefined to other queue families unless ownership is
transferred.
The contents of any portion of another resource which aliases memory that is
bound to the transferred buffer or image subresource range are undefined
after a release or acquire operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>Because <a href="chap7.html#synchronization-events">events</a> <strong class="purple">cannot</strong> be used directly for
inter-queue synchronization, and because <a href="chap7.html#vkCmdSetEvent">vkCmdSetEvent</a> does not have
the queue family index or memory barrier parameters needed by a <em>release
operation</em>, the release and acquire operations of a queue family ownership
transfer <strong class="purple">can</strong> only be performed using <a href="chap7.html#vkCmdPipelineBarrier">vkCmdPipelineBarrier</a>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-wait-idle"><a class="anchor" href="chap7.html#synchronization-wait-idle"></a>7.8. Wait Idle Operations</h3>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait on the host for the completion of outstanding queue operations for a
given queue, call:</p>
</div>
<div id="vkQueueWaitIdle" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkQueueWaitIdle</span><span class="p">(</span>
    <span class="n">VkQueue</span>                                     <span class="n">queue</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>queue</code> is the queue on which to wait.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkQueueWaitIdle</code> is equivalent to having submitted a valid fence to
every previously executed <a href="chap5.html#devsandqueues-submission">queue submission
command</a> that accepts a fence, then waiting for all of those fences to
signal using <a href="chap7.html#vkWaitForFences">vkWaitForFences</a> with an infinite timeout and
<code>waitAll</code> set to <code>VK_TRUE</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkQueueWaitIdle-queue-parameter" href="chap7.html#VUID-vkQueueWaitIdle-queue-parameter"></a> <span class="vuid">VUID-vkQueueWaitIdle-queue-parameter</span><br>
 <code>queue</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkQueue">VkQueue</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to <code>queue</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Command Properties</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><a href="chap6.html#VkCommandBufferLevel">Command Buffer Levels</a></th>
<th class="tableblock halign-left valign-top"><a href="chap8.html#vkCmdBeginRenderPass">Render Pass Scope</a></th>
<th class="tableblock halign-left valign-top"><a href="chap5.html#VkQueueFlagBits">Supported Queue Types</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>To wait on the host for the completion of outstanding queue operations for
all queues on a given logical device, call:</p>
</div>
<div id="vkDeviceWaitIdle" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="c1">// Provided by VK_VERSION_1_0</span>
<span class="n">VkResult</span> <span class="nf">vkDeviceWaitIdle</span><span class="p">(</span>
    <span class="n">VkDevice</span>                                    <span class="n">device</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>device</code> is the logical device to idle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>vkDeviceWaitIdle</code> is equivalent to calling <code>vkQueueWaitIdle</code> for
all queues owned by <code>device</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Valid Usage (Implicit)</div>
<div class="ulist">
<ul>
<li>
<p><a id="VUID-vkDeviceWaitIdle-device-parameter" href="chap7.html#VUID-vkDeviceWaitIdle-device-parameter"></a> <span class="vuid">VUID-vkDeviceWaitIdle-device-parameter</span><br>
 <code>device</code> <strong class="purple">must</strong> be a valid <a href="chap5.html#VkDevice">VkDevice</a> handle</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Host Synchronization</div>
<div class="ulist">
<ul>
<li>
<p>Host access to all <code>VkQueue</code> objects created from <code>device</code> <strong class="purple">must</strong> be externally synchronized</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Return Codes</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="chap3.html#fundamentals-successcodes">Success</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_SUCCESS</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a href="chap3.html#fundamentals-errorcodes">Failure</a></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>VK_ERROR_OUT_OF_HOST_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_OUT_OF_DEVICE_MEMORY</code></p>
</li>
<li>
<p><code>VK_ERROR_DEVICE_LOST</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-submission-host-writes"><a class="anchor" href="chap7.html#synchronization-submission-host-writes"></a>7.9. Host Write Ordering Guarantees</h3>
<div class="paragraph">
<p>When batches of command buffers are submitted to a queue via a
<a href="chap5.html#devsandqueues-submission">queue submission command</a>, it defines a memory
dependency with prior host operations, and execution of command buffers
submitted to the queue.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a> is
defined by the host execution model, but includes execution of
<a href="chap6.html#vkQueueSubmit">vkQueueSubmit</a> on the host and anything that happened-before it.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-scopes">synchronization scope</a>
includes all commands submitted in the same <a href="chap5.html#devsandqueues-submission">queue submission</a>, and all commands that occur later in
<a href="chap7.html#synchronization-submission-order">submission order</a>.</p>
</div>
<div class="paragraph">
<p>The first <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a>
includes all host writes to mappable device memory that are available to the
host memory domain.</p>
</div>
<div class="paragraph">
<p>The second <a href="chap7.html#synchronization-dependencies-access-scopes">access scope</a>
includes all memory access performed by the device.</p>
</div>
</div>
<div class="sect2">
<h3 id="synchronization-device-group"><a class="anchor" href="chap7.html#synchronization-device-group"></a>7.10. Synchronization and Multiple Physical Devices</h3>
<div class="paragraph">
<p>If a logical device includes more than one physical device, then fences,
semaphores, and events all still have a single instance of the signaled
state.</p>
</div>
<div class="paragraph">
<p>A fence becomes signaled when all physical devices complete the necessary
queue operations.</p>
</div>
<div class="paragraph">
<p>Semaphore wait and signal operations all include a device index that is the
sole physical device that performs the operation.
These indices are provided in the <a href="chap6.html#VkDeviceGroupSubmitInfo">VkDeviceGroupSubmitInfo</a> and
<a href="chap29.html#VkDeviceGroupBindSparseInfo">VkDeviceGroupBindSparseInfo</a> structures.
Semaphores are not exclusively owned by any physical device.
For example, a semaphore can be signaled by one physical device and then
waited on by a different physical device.</p>
</div>
<div class="paragraph">
<p>An event <strong class="purple">can</strong> only be waited on by the same physical device that signaled it
(or the host).</p>
</div>
</div>
</div>
</div></div>

<nav>
  <a rel="prev" href="chap6.html" class="nav nav-prev" title="Previous page" aria-label="Previous page" aria-keyshortcuts="Left">
        <i class="fa fa-angle-left"></i>
     </a>
  <a rel="next" href="chap8.html" class="nav nav-next" title="Next page" aria-label="Next page" aria-keyshortcuts="Right">
        <i class="fa fa-angle-right"></i>
     </a>
  <div style="clear: both"></div>
</nav>
<div id="footer">
<div id="footer-text">
Version 1.1.205<br>
Last updated 2022-01-21 21:58:54 -0800
</div>
</div>



</body>
  <script>
  function isInViewport(ele) {
    const rect = ele.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
    );
  }
  function yPosition (ele) {
    const rect = ele.getBoundingClientRect();
    return (rect.top - 20); // 20px above
  }
  let curr = document.getElementsByClassName('current');
  if (!isInViewport(curr[curr.length - 1])) {
    document.getElementById('toc').scrollTo({
      top: yPosition(curr[0]),
      left: 0,
      behavior: 'smooth'
    });
  }

  /* For page navigation */
  function gotoPage(selector) {
    const button = document.querySelector(selector);
    if (button)
      window.location.href = button.href;
  }
  document.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowRight':
        e.preventDefault();
        gotoPage('.nav-next');
        break;
      case 'ArrowLeft':
        e.preventDefault();
        gotoPage('.nav-prev');
        break;
    }
  });
  </script>
  </html>